function _re(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const c in i)if(c!=="default"&&!(c in e)){const d=Object.getOwnPropertyDescriptor(i,c);d&&Object.defineProperty(e,c,d.get?d:{enumerable:!0,get:()=>i[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function n(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(c){if(c.ep)return;c.ep=!0;const d=n(c);fetch(c.href,d)}})();var TT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var EM={exports:{}},Wb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pF;function vre(){if(pF)return Wb;pF=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(i,c,d){var m=null;if(d!==void 0&&(m=""+d),c.key!==void 0&&(m=""+c.key),"key"in c){d={};for(var a in c)a!=="key"&&(d[a]=c[a])}else d=c;return c=d.ref,{$$typeof:e,type:i,key:m,ref:c!==void 0?c:null,props:d}}return Wb.Fragment=t,Wb.jsx=n,Wb.jsxs=n,Wb}var mF;function xre(){return mF||(mF=1,EM.exports=vre()),EM.exports}var D=xre(),AM={exports:{}},qi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gF;function bre(){if(gF)return qi;gF=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),m=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),P=Symbol.iterator;function N(qe){return qe===null||typeof qe!="object"?null:(qe=P&&qe[P]||qe["@@iterator"],typeof qe=="function"?qe:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,q={};function V(qe,vt,nt){this.props=qe,this.context=vt,this.refs=q,this.updater=nt||$}V.prototype.isReactComponent={},V.prototype.setState=function(qe,vt){if(typeof qe!="object"&&typeof qe!="function"&&qe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,qe,vt,"setState")},V.prototype.forceUpdate=function(qe){this.updater.enqueueForceUpdate(this,qe,"forceUpdate")};function J(){}J.prototype=V.prototype;function ee(qe,vt,nt){this.props=qe,this.context=vt,this.refs=q,this.updater=nt||$}var re=ee.prototype=new J;re.constructor=ee,G(re,V.prototype),re.isPureReactComponent=!0;var fe=Array.isArray,ne={H:null,A:null,T:null,S:null,V:null},ce=Object.prototype.hasOwnProperty;function me(qe,vt,nt,gt,Ut,$t){return nt=$t.ref,{$$typeof:e,type:qe,key:vt,ref:nt!==void 0?nt:null,props:$t}}function ve(qe,vt){return me(qe.type,vt,void 0,void 0,void 0,qe.props)}function De(qe){return typeof qe=="object"&&qe!==null&&qe.$$typeof===e}function Ye(qe){var vt={"=":"=0",":":"=2"};return"$"+qe.replace(/[=:]/g,function(nt){return vt[nt]})}var ze=/\/+/g;function tt(qe,vt){return typeof qe=="object"&&qe!==null&&qe.key!=null?Ye(""+qe.key):vt.toString(36)}function at(){}function ct(qe){switch(qe.status){case"fulfilled":return qe.value;case"rejected":throw qe.reason;default:switch(typeof qe.status=="string"?qe.then(at,at):(qe.status="pending",qe.then(function(vt){qe.status==="pending"&&(qe.status="fulfilled",qe.value=vt)},function(vt){qe.status==="pending"&&(qe.status="rejected",qe.reason=vt)})),qe.status){case"fulfilled":return qe.value;case"rejected":throw qe.reason}}throw qe}function ht(qe,vt,nt,gt,Ut){var $t=typeof qe;($t==="undefined"||$t==="boolean")&&(qe=null);var qt=!1;if(qe===null)qt=!0;else switch($t){case"bigint":case"string":case"number":qt=!0;break;case"object":switch(qe.$$typeof){case e:case t:qt=!0;break;case M:return qt=qe._init,ht(qt(qe._payload),vt,nt,gt,Ut)}}if(qt)return Ut=Ut(qe),qt=gt===""?"."+tt(qe,0):gt,fe(Ut)?(nt="",qt!=null&&(nt=qt.replace(ze,"$&/")+"/"),ht(Ut,vt,nt,"",function(en){return en})):Ut!=null&&(De(Ut)&&(Ut=ve(Ut,nt+(Ut.key==null||qe&&qe.key===Ut.key?"":(""+Ut.key).replace(ze,"$&/")+"/")+qt)),vt.push(Ut)),1;qt=0;var Ht=gt===""?".":gt+":";if(fe(qe))for(var mn=0;mn<qe.length;mn++)gt=qe[mn],$t=Ht+tt(gt,mn),qt+=ht(gt,vt,nt,$t,Ut);else if(mn=N(qe),typeof mn=="function")for(qe=mn.call(qe),mn=0;!(gt=qe.next()).done;)gt=gt.value,$t=Ht+tt(gt,mn++),qt+=ht(gt,vt,nt,$t,Ut);else if($t==="object"){if(typeof qe.then=="function")return ht(ct(qe),vt,nt,gt,Ut);throw vt=String(qe),Error("Objects are not valid as a React child (found: "+(vt==="[object Object]"?"object with keys {"+Object.keys(qe).join(", ")+"}":vt)+"). If you meant to render a collection of children, use an array instead.")}return qt}function Ie(qe,vt,nt){if(qe==null)return qe;var gt=[],Ut=0;return ht(qe,gt,"","",function($t){return vt.call(nt,$t,Ut++)}),gt}function rt(qe){if(qe._status===-1){var vt=qe._result;vt=vt(),vt.then(function(nt){(qe._status===0||qe._status===-1)&&(qe._status=1,qe._result=nt)},function(nt){(qe._status===0||qe._status===-1)&&(qe._status=2,qe._result=nt)}),qe._status===-1&&(qe._status=0,qe._result=vt)}if(qe._status===1)return qe._result.default;throw qe._result}var Qe=typeof reportError=="function"?reportError:function(qe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var vt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof qe=="object"&&qe!==null&&typeof qe.message=="string"?String(qe.message):String(qe),error:qe});if(!window.dispatchEvent(vt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",qe);return}console.error(qe)};function St(){}return qi.Children={map:Ie,forEach:function(qe,vt,nt){Ie(qe,function(){vt.apply(this,arguments)},nt)},count:function(qe){var vt=0;return Ie(qe,function(){vt++}),vt},toArray:function(qe){return Ie(qe,function(vt){return vt})||[]},only:function(qe){if(!De(qe))throw Error("React.Children.only expected to receive a single React element child.");return qe}},qi.Component=V,qi.Fragment=n,qi.Profiler=c,qi.PureComponent=ee,qi.StrictMode=i,qi.Suspense=w,qi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ne,qi.__COMPILER_RUNTIME={__proto__:null,c:function(qe){return ne.H.useMemoCache(qe)}},qi.cache=function(qe){return function(){return qe.apply(null,arguments)}},qi.cloneElement=function(qe,vt,nt){if(qe==null)throw Error("The argument must be a React element, but you passed "+qe+".");var gt=G({},qe.props),Ut=qe.key,$t=void 0;if(vt!=null)for(qt in vt.ref!==void 0&&($t=void 0),vt.key!==void 0&&(Ut=""+vt.key),vt)!ce.call(vt,qt)||qt==="key"||qt==="__self"||qt==="__source"||qt==="ref"&&vt.ref===void 0||(gt[qt]=vt[qt]);var qt=arguments.length-2;if(qt===1)gt.children=nt;else if(1<qt){for(var Ht=Array(qt),mn=0;mn<qt;mn++)Ht[mn]=arguments[mn+2];gt.children=Ht}return me(qe.type,Ut,void 0,void 0,$t,gt)},qi.createContext=function(qe){return qe={$$typeof:m,_currentValue:qe,_currentValue2:qe,_threadCount:0,Provider:null,Consumer:null},qe.Provider=qe,qe.Consumer={$$typeof:d,_context:qe},qe},qi.createElement=function(qe,vt,nt){var gt,Ut={},$t=null;if(vt!=null)for(gt in vt.key!==void 0&&($t=""+vt.key),vt)ce.call(vt,gt)&&gt!=="key"&&gt!=="__self"&&gt!=="__source"&&(Ut[gt]=vt[gt]);var qt=arguments.length-2;if(qt===1)Ut.children=nt;else if(1<qt){for(var Ht=Array(qt),mn=0;mn<qt;mn++)Ht[mn]=arguments[mn+2];Ut.children=Ht}if(qe&&qe.defaultProps)for(gt in qt=qe.defaultProps,qt)Ut[gt]===void 0&&(Ut[gt]=qt[gt]);return me(qe,$t,void 0,void 0,null,Ut)},qi.createRef=function(){return{current:null}},qi.forwardRef=function(qe){return{$$typeof:a,render:qe}},qi.isValidElement=De,qi.lazy=function(qe){return{$$typeof:M,_payload:{_status:-1,_result:qe},_init:rt}},qi.memo=function(qe,vt){return{$$typeof:S,type:qe,compare:vt===void 0?null:vt}},qi.startTransition=function(qe){var vt=ne.T,nt={};ne.T=nt;try{var gt=qe(),Ut=ne.S;Ut!==null&&Ut(nt,gt),typeof gt=="object"&&gt!==null&&typeof gt.then=="function"&&gt.then(St,Qe)}catch($t){Qe($t)}finally{ne.T=vt}},qi.unstable_useCacheRefresh=function(){return ne.H.useCacheRefresh()},qi.use=function(qe){return ne.H.use(qe)},qi.useActionState=function(qe,vt,nt){return ne.H.useActionState(qe,vt,nt)},qi.useCallback=function(qe,vt){return ne.H.useCallback(qe,vt)},qi.useContext=function(qe){return ne.H.useContext(qe)},qi.useDebugValue=function(){},qi.useDeferredValue=function(qe,vt){return ne.H.useDeferredValue(qe,vt)},qi.useEffect=function(qe,vt,nt){var gt=ne.H;if(typeof nt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return gt.useEffect(qe,vt)},qi.useId=function(){return ne.H.useId()},qi.useImperativeHandle=function(qe,vt,nt){return ne.H.useImperativeHandle(qe,vt,nt)},qi.useInsertionEffect=function(qe,vt){return ne.H.useInsertionEffect(qe,vt)},qi.useLayoutEffect=function(qe,vt){return ne.H.useLayoutEffect(qe,vt)},qi.useMemo=function(qe,vt){return ne.H.useMemo(qe,vt)},qi.useOptimistic=function(qe,vt){return ne.H.useOptimistic(qe,vt)},qi.useReducer=function(qe,vt,nt){return ne.H.useReducer(qe,vt,nt)},qi.useRef=function(qe){return ne.H.useRef(qe)},qi.useState=function(qe){return ne.H.useState(qe)},qi.useSyncExternalStore=function(qe,vt,nt){return ne.H.useSyncExternalStore(qe,vt,nt)},qi.useTransition=function(){return ne.H.useTransition()},qi.version="19.1.1",qi}var yF;function HA(){return yF||(yF=1,AM.exports=bre()),AM.exports}var K=HA();const Ce=Wa(K),gG=_re({__proto__:null,default:Ce},[K]);var CM={exports:{}},Xb={},MM={exports:{}},PM={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _F;function wre(){return _F||(_F=1,(function(e){function t(Ie,rt){var Qe=Ie.length;Ie.push(rt);e:for(;0<Qe;){var St=Qe-1>>>1,qe=Ie[St];if(0<c(qe,rt))Ie[St]=rt,Ie[Qe]=qe,Qe=St;else break e}}function n(Ie){return Ie.length===0?null:Ie[0]}function i(Ie){if(Ie.length===0)return null;var rt=Ie[0],Qe=Ie.pop();if(Qe!==rt){Ie[0]=Qe;e:for(var St=0,qe=Ie.length,vt=qe>>>1;St<vt;){var nt=2*(St+1)-1,gt=Ie[nt],Ut=nt+1,$t=Ie[Ut];if(0>c(gt,Qe))Ut<qe&&0>c($t,gt)?(Ie[St]=$t,Ie[Ut]=Qe,St=Ut):(Ie[St]=gt,Ie[nt]=Qe,St=nt);else if(Ut<qe&&0>c($t,Qe))Ie[St]=$t,Ie[Ut]=Qe,St=Ut;else break e}}return rt}function c(Ie,rt){var Qe=Ie.sortIndex-rt.sortIndex;return Qe!==0?Qe:Ie.id-rt.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var m=Date,a=m.now();e.unstable_now=function(){return m.now()-a}}var w=[],S=[],M=1,P=null,N=3,$=!1,G=!1,q=!1,V=!1,J=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;function fe(Ie){for(var rt=n(S);rt!==null;){if(rt.callback===null)i(S);else if(rt.startTime<=Ie)i(S),rt.sortIndex=rt.expirationTime,t(w,rt);else break;rt=n(S)}}function ne(Ie){if(q=!1,fe(Ie),!G)if(n(w)!==null)G=!0,ce||(ce=!0,tt());else{var rt=n(S);rt!==null&&ht(ne,rt.startTime-Ie)}}var ce=!1,me=-1,ve=5,De=-1;function Ye(){return V?!0:!(e.unstable_now()-De<ve)}function ze(){if(V=!1,ce){var Ie=e.unstable_now();De=Ie;var rt=!0;try{e:{G=!1,q&&(q=!1,ee(me),me=-1),$=!0;var Qe=N;try{t:{for(fe(Ie),P=n(w);P!==null&&!(P.expirationTime>Ie&&Ye());){var St=P.callback;if(typeof St=="function"){P.callback=null,N=P.priorityLevel;var qe=St(P.expirationTime<=Ie);if(Ie=e.unstable_now(),typeof qe=="function"){P.callback=qe,fe(Ie),rt=!0;break t}P===n(w)&&i(w),fe(Ie)}else i(w);P=n(w)}if(P!==null)rt=!0;else{var vt=n(S);vt!==null&&ht(ne,vt.startTime-Ie),rt=!1}}break e}finally{P=null,N=Qe,$=!1}rt=void 0}}finally{rt?tt():ce=!1}}}var tt;if(typeof re=="function")tt=function(){re(ze)};else if(typeof MessageChannel<"u"){var at=new MessageChannel,ct=at.port2;at.port1.onmessage=ze,tt=function(){ct.postMessage(null)}}else tt=function(){J(ze,0)};function ht(Ie,rt){me=J(function(){Ie(e.unstable_now())},rt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ie){Ie.callback=null},e.unstable_forceFrameRate=function(Ie){0>Ie||125<Ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ve=0<Ie?Math.floor(1e3/Ie):5},e.unstable_getCurrentPriorityLevel=function(){return N},e.unstable_next=function(Ie){switch(N){case 1:case 2:case 3:var rt=3;break;default:rt=N}var Qe=N;N=rt;try{return Ie()}finally{N=Qe}},e.unstable_requestPaint=function(){V=!0},e.unstable_runWithPriority=function(Ie,rt){switch(Ie){case 1:case 2:case 3:case 4:case 5:break;default:Ie=3}var Qe=N;N=Ie;try{return rt()}finally{N=Qe}},e.unstable_scheduleCallback=function(Ie,rt,Qe){var St=e.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?St+Qe:St):Qe=St,Ie){case 1:var qe=-1;break;case 2:qe=250;break;case 5:qe=1073741823;break;case 4:qe=1e4;break;default:qe=5e3}return qe=Qe+qe,Ie={id:M++,callback:rt,priorityLevel:Ie,startTime:Qe,expirationTime:qe,sortIndex:-1},Qe>St?(Ie.sortIndex=Qe,t(S,Ie),n(w)===null&&Ie===n(S)&&(q?(ee(me),me=-1):q=!0,ht(ne,Qe-St))):(Ie.sortIndex=qe,t(w,Ie),G||$||(G=!0,ce||(ce=!0,tt()))),Ie},e.unstable_shouldYield=Ye,e.unstable_wrapCallback=function(Ie){var rt=N;return function(){var Qe=N;N=rt;try{return Ie.apply(this,arguments)}finally{N=Qe}}}})(PM)),PM}var vF;function Sre(){return vF||(vF=1,MM.exports=wre()),MM.exports}var OM={exports:{}},ac={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xF;function Tre(){if(xF)return ac;xF=1;var e=HA();function t(w){var S="https://react.dev/errors/"+w;if(1<arguments.length){S+="?args[]="+encodeURIComponent(arguments[1]);for(var M=2;M<arguments.length;M++)S+="&args[]="+encodeURIComponent(arguments[M])}return"Minified React error #"+w+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},c=Symbol.for("react.portal");function d(w,S,M){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:P==null?null:""+P,children:w,containerInfo:S,implementation:M}}var m=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(w,S){if(w==="font")return"";if(typeof S=="string")return S==="use-credentials"?S:""}return ac.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ac.createPortal=function(w,S){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S||S.nodeType!==1&&S.nodeType!==9&&S.nodeType!==11)throw Error(t(299));return d(w,S,null,M)},ac.flushSync=function(w){var S=m.T,M=i.p;try{if(m.T=null,i.p=2,w)return w()}finally{m.T=S,i.p=M,i.d.f()}},ac.preconnect=function(w,S){typeof w=="string"&&(S?(S=S.crossOrigin,S=typeof S=="string"?S==="use-credentials"?S:"":void 0):S=null,i.d.C(w,S))},ac.prefetchDNS=function(w){typeof w=="string"&&i.d.D(w)},ac.preinit=function(w,S){if(typeof w=="string"&&S&&typeof S.as=="string"){var M=S.as,P=a(M,S.crossOrigin),N=typeof S.integrity=="string"?S.integrity:void 0,$=typeof S.fetchPriority=="string"?S.fetchPriority:void 0;M==="style"?i.d.S(w,typeof S.precedence=="string"?S.precedence:void 0,{crossOrigin:P,integrity:N,fetchPriority:$}):M==="script"&&i.d.X(w,{crossOrigin:P,integrity:N,fetchPriority:$,nonce:typeof S.nonce=="string"?S.nonce:void 0})}},ac.preinitModule=function(w,S){if(typeof w=="string")if(typeof S=="object"&&S!==null){if(S.as==null||S.as==="script"){var M=a(S.as,S.crossOrigin);i.d.M(w,{crossOrigin:M,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0})}}else S==null&&i.d.M(w)},ac.preload=function(w,S){if(typeof w=="string"&&typeof S=="object"&&S!==null&&typeof S.as=="string"){var M=S.as,P=a(M,S.crossOrigin);i.d.L(w,M,{crossOrigin:P,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0,type:typeof S.type=="string"?S.type:void 0,fetchPriority:typeof S.fetchPriority=="string"?S.fetchPriority:void 0,referrerPolicy:typeof S.referrerPolicy=="string"?S.referrerPolicy:void 0,imageSrcSet:typeof S.imageSrcSet=="string"?S.imageSrcSet:void 0,imageSizes:typeof S.imageSizes=="string"?S.imageSizes:void 0,media:typeof S.media=="string"?S.media:void 0})}},ac.preloadModule=function(w,S){if(typeof w=="string")if(S){var M=a(S.as,S.crossOrigin);i.d.m(w,{as:typeof S.as=="string"&&S.as!=="script"?S.as:void 0,crossOrigin:M,integrity:typeof S.integrity=="string"?S.integrity:void 0})}else i.d.m(w)},ac.requestFormReset=function(w){i.d.r(w)},ac.unstable_batchedUpdates=function(w,S){return w(S)},ac.useFormState=function(w,S,M){return m.H.useFormState(w,S,M)},ac.useFormStatus=function(){return m.H.useHostTransitionStatus()},ac.version="19.1.1",ac}var bF;function yG(){if(bF)return OM.exports;bF=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),OM.exports=Tre(),OM.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wF;function Ere(){if(wF)return Xb;wF=1;var e=Sre(),t=HA(),n=yG();function i(f){var v="https://react.dev/errors/"+f;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)v+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function d(f){var v=f,A=f;if(f.alternate)for(;v.return;)v=v.return;else{f=v;do v=f,(v.flags&4098)!==0&&(A=v.return),f=v.return;while(f)}return v.tag===3?A:null}function m(f){if(f.tag===13){var v=f.memoizedState;if(v===null&&(f=f.alternate,f!==null&&(v=f.memoizedState)),v!==null)return v.dehydrated}return null}function a(f){if(d(f)!==f)throw Error(i(188))}function w(f){var v=f.alternate;if(!v){if(v=d(f),v===null)throw Error(i(188));return v!==f?null:f}for(var A=f,k=v;;){var H=A.return;if(H===null)break;var te=H.alternate;if(te===null){if(k=H.return,k!==null){A=k;continue}break}if(H.child===te.child){for(te=H.child;te;){if(te===A)return a(H),f;if(te===k)return a(H),v;te=te.sibling}throw Error(i(188))}if(A.return!==k.return)A=H,k=te;else{for(var Se=!1,Be=H.child;Be;){if(Be===A){Se=!0,A=H,k=te;break}if(Be===k){Se=!0,k=H,A=te;break}Be=Be.sibling}if(!Se){for(Be=te.child;Be;){if(Be===A){Se=!0,A=te,k=H;break}if(Be===k){Se=!0,k=te,A=H;break}Be=Be.sibling}if(!Se)throw Error(i(189))}}if(A.alternate!==k)throw Error(i(190))}if(A.tag!==3)throw Error(i(188));return A.stateNode.current===A?f:v}function S(f){var v=f.tag;if(v===5||v===26||v===27||v===6)return f;for(f=f.child;f!==null;){if(v=S(f),v!==null)return v;f=f.sibling}return null}var M=Object.assign,P=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),J=Symbol.for("react.provider"),ee=Symbol.for("react.consumer"),re=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),De=Symbol.for("react.activity"),Ye=Symbol.for("react.memo_cache_sentinel"),ze=Symbol.iterator;function tt(f){return f===null||typeof f!="object"?null:(f=ze&&f[ze]||f["@@iterator"],typeof f=="function"?f:null)}var at=Symbol.for("react.client.reference");function ct(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===at?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case G:return"Fragment";case V:return"Profiler";case q:return"StrictMode";case ne:return"Suspense";case ce:return"SuspenseList";case De:return"Activity"}if(typeof f=="object")switch(f.$$typeof){case $:return"Portal";case re:return(f.displayName||"Context")+".Provider";case ee:return(f._context.displayName||"Context")+".Consumer";case fe:var v=f.render;return f=f.displayName,f||(f=v.displayName||v.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case me:return v=f.displayName||null,v!==null?v:ct(f.type)||"Memo";case ve:v=f._payload,f=f._init;try{return ct(f(v))}catch{}}return null}var ht=Array.isArray,Ie=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rt=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Qe={pending:!1,data:null,method:null,action:null},St=[],qe=-1;function vt(f){return{current:f}}function nt(f){0>qe||(f.current=St[qe],St[qe]=null,qe--)}function gt(f,v){qe++,St[qe]=f.current,f.current=v}var Ut=vt(null),$t=vt(null),qt=vt(null),Ht=vt(null);function mn(f,v){switch(gt(qt,v),gt($t,f),gt(Ut,null),v.nodeType){case 9:case 11:f=(f=v.documentElement)&&(f=f.namespaceURI)?AS(f):0;break;default:if(f=v.tagName,v=v.namespaceURI)v=AS(v),f=Rv(v,f);else switch(f){case"svg":f=1;break;case"math":f=2;break;default:f=0}}nt(Ut),gt(Ut,f)}function en(){nt(Ut),nt($t),nt(qt)}function En(f){f.memoizedState!==null&&gt(Ht,f);var v=Ut.current,A=Rv(v,f.type);v!==A&&(gt($t,f),gt(Ut,A))}function Xn(f){$t.current===f&&(nt(Ut),nt($t)),Ht.current===f&&(nt(Ht),ym._currentValue=Qe)}var cn=Object.prototype.hasOwnProperty,Jr=e.unstable_scheduleCallback,mr=e.unstable_cancelCallback,Cr=e.unstable_shouldYield,li=e.unstable_requestPaint,hi=e.unstable_now,so=e.unstable_getCurrentPriorityLevel,ra=e.unstable_ImmediatePriority,xt=e.unstable_UserBlockingPriority,Bt=e.unstable_NormalPriority,tn=e.unstable_LowPriority,$n=e.unstable_IdlePriority,qn=e.log,An=e.unstable_setDisableYieldValue,tr=null,Ir=null;function mi(f){if(typeof qn=="function"&&An(f),Ir&&typeof Ir.setStrictMode=="function")try{Ir.setStrictMode(tr,f)}catch{}}var Mi=Math.clz32?Math.clz32:Ua,_o=Math.log,oa=Math.LN2;function Ua(f){return f>>>=0,f===0?32:31-(_o(f)/oa|0)|0}var lo=256,eo=4194304;function co(f){var v=f&42;if(v!==0)return v;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function vo(f,v,A){var k=f.pendingLanes;if(k===0)return 0;var H=0,te=f.suspendedLanes,Se=f.pingedLanes;f=f.warmLanes;var Be=k&134217727;return Be!==0?(k=Be&~te,k!==0?H=co(k):(Se&=Be,Se!==0?H=co(Se):A||(A=Be&~f,A!==0&&(H=co(A))))):(Be=k&~te,Be!==0?H=co(Be):Se!==0?H=co(Se):A||(A=k&~f,A!==0&&(H=co(A)))),H===0?0:v!==0&&v!==H&&(v&te)===0&&(te=H&-H,A=v&-v,te>=A||te===32&&(A&4194048)!==0)?v:H}function ss(f,v){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&v)===0}function ir(f,v){switch(f){case 1:case 2:case 4:case 8:case 64:return v+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xi(){var f=lo;return lo<<=1,(lo&4194048)===0&&(lo=256),f}function ci(){var f=eo;return eo<<=1,(eo&62914560)===0&&(eo=4194304),f}function Ra(f){for(var v=[],A=0;31>A;A++)v.push(f);return v}function ya(f,v){f.pendingLanes|=v,v!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function Tl(f,v,A,k,H,te){var Se=f.pendingLanes;f.pendingLanes=A,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=A,f.entangledLanes&=A,f.errorRecoveryDisabledLanes&=A,f.shellSuspendCounter=0;var Be=f.entanglements,bt=f.expirationTimes,Gt=f.hiddenUpdates;for(A=Se&~A;0<A;){var Sn=31-Mi(A),In=1<<Sn;Be[Sn]=0,bt[Sn]=-1;var sn=Gt[Sn];if(sn!==null)for(Gt[Sn]=null,Sn=0;Sn<sn.length;Sn++){var dn=sn[Sn];dn!==null&&(dn.lane&=-536870913)}A&=~In}k!==0&&dr(f,k,0),te!==0&&H===0&&f.tag!==0&&(f.suspendedLanes|=te&~(Se&~v))}function dr(f,v,A){f.pendingLanes|=v,f.suspendedLanes&=~v;var k=31-Mi(v);f.entangledLanes|=v,f.entanglements[k]=f.entanglements[k]|1073741824|A&4194090}function kt(f,v){var A=f.entangledLanes|=v;for(f=f.entanglements;A;){var k=31-Mi(A),H=1<<k;H&v|f[k]&v&&(f[k]|=v),A&=~H}}function Dr(f){switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=128;break;case 268435456:f=134217728;break;default:f=0}return f}function to(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function Hs(){var f=rt.p;return f!==0?f:(f=window.event,f===void 0?32:_b(f.type))}function hr(f,v){var A=rt.p;try{return rt.p=f,v()}finally{rt.p=A}}var ot=Math.random().toString(36).slice(2),he="__reactFiber$"+ot,ye="__reactProps$"+ot,Ae="__reactContainer$"+ot,He="__reactEvents$"+ot,Pe="__reactListeners$"+ot,Ke="__reactHandles$"+ot,wt="__reactResources$"+ot,et="__reactMarker$"+ot;function yt(f){delete f[he],delete f[ye],delete f[He],delete f[Pe],delete f[Ke]}function Zt(f){var v=f[he];if(v)return v;for(var A=f.parentNode;A;){if(v=A[Ae]||A[he]){if(A=v.alternate,v.child!==null||A!==null&&A.child!==null)for(f=Nv(f);f!==null;){if(A=f[he])return A;f=Nv(f)}return v}f=A,A=f.parentNode}return null}function zt(f){if(f=f[he]||f[Ae]){var v=f.tag;if(v===5||v===6||v===13||v===26||v===27||v===3)return f}return null}function Fn(f){var v=f.tag;if(v===5||v===26||v===27||v===6)return f.stateNode;throw Error(i(33))}function Yn(f){var v=f[wt];return v||(v=f[wt]={hoistableStyles:new Map,hoistableScripts:new Map}),v}function Hn(f){f[et]=!0}var Mr=new Set,gr={};function Sr(f,v){gi(f,v),gi(f+"Capture",v)}function gi(f,v){for(gr[f]=v,f=0;f<v.length;f++)Mr.add(v[f])}var jr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),da={},Ia={};function $a(f){return cn.call(Ia,f)?!0:cn.call(da,f)?!1:jr.test(f)?Ia[f]=!0:(da[f]=!0,!1)}function yi(f,v,A){if($a(v))if(A===null)f.removeAttribute(v);else{switch(typeof A){case"undefined":case"function":case"symbol":f.removeAttribute(v);return;case"boolean":var k=v.toLowerCase().slice(0,5);if(k!=="data-"&&k!=="aria-"){f.removeAttribute(v);return}}f.setAttribute(v,""+A)}}function Qr(f,v,A){if(A===null)f.removeAttribute(v);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(v);return}f.setAttribute(v,""+A)}}function Ri(f,v,A,k){if(k===null)f.removeAttribute(A);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(A);return}f.setAttributeNS(v,A,""+k)}}var Gi,bi;function Da(f){if(Gi===void 0)try{throw Error()}catch(A){var v=A.stack.trim().match(/\n( *(at )?)/);Gi=v&&v[1]||"",bi=-1<A.stack.indexOf(`
    at`)?" (<anonymous>)":-1<A.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gi+f+bi}var Xa=!1;function uo(f,v){if(!f||Xa)return"";Xa=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var k={DetermineComponentFrameRoot:function(){try{if(v){var In=function(){throw Error()};if(Object.defineProperty(In.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(In,[])}catch(dn){var sn=dn}Reflect.construct(f,[],In)}else{try{In.call()}catch(dn){sn=dn}f.call(In.prototype)}}else{try{throw Error()}catch(dn){sn=dn}(In=f())&&typeof In.catch=="function"&&In.catch(function(){})}}catch(dn){if(dn&&sn&&typeof dn.stack=="string")return[dn.stack,sn.stack]}return[null,null]}};k.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var H=Object.getOwnPropertyDescriptor(k.DetermineComponentFrameRoot,"name");H&&H.configurable&&Object.defineProperty(k.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var te=k.DetermineComponentFrameRoot(),Se=te[0],Be=te[1];if(Se&&Be){var bt=Se.split(`
`),Gt=Be.split(`
`);for(H=k=0;k<bt.length&&!bt[k].includes("DetermineComponentFrameRoot");)k++;for(;H<Gt.length&&!Gt[H].includes("DetermineComponentFrameRoot");)H++;if(k===bt.length||H===Gt.length)for(k=bt.length-1,H=Gt.length-1;1<=k&&0<=H&&bt[k]!==Gt[H];)H--;for(;1<=k&&0<=H;k--,H--)if(bt[k]!==Gt[H]){if(k!==1||H!==1)do if(k--,H--,0>H||bt[k]!==Gt[H]){var Sn=`
`+bt[k].replace(" at new "," at ");return f.displayName&&Sn.includes("<anonymous>")&&(Sn=Sn.replace("<anonymous>",f.displayName)),Sn}while(1<=k&&0<=H);break}}}finally{Xa=!1,Error.prepareStackTrace=A}return(A=f?f.displayName||f.name:"")?Da(A):""}function td(f){switch(f.tag){case 26:case 27:case 5:return Da(f.type);case 16:return Da("Lazy");case 13:return Da("Suspense");case 19:return Da("SuspenseList");case 0:case 15:return uo(f.type,!1);case 11:return uo(f.type.render,!1);case 1:return uo(f.type,!0);case 31:return Da("Activity");default:return""}}function xo(f){try{var v="";do v+=td(f),f=f.return;while(f);return v}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function Ro(f){switch(typeof f){case"bigint":case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function nd(f){var v=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function fu(f){var v=nd(f)?"checked":"value",A=Object.getOwnPropertyDescriptor(f.constructor.prototype,v),k=""+f[v];if(!f.hasOwnProperty(v)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var H=A.get,te=A.set;return Object.defineProperty(f,v,{configurable:!0,get:function(){return H.call(this)},set:function(Se){k=""+Se,te.call(this,Se)}}),Object.defineProperty(f,v,{enumerable:A.enumerable}),{getValue:function(){return k},setValue:function(Se){k=""+Se},stopTracking:function(){f._valueTracker=null,delete f[v]}}}}function Lc(f){f._valueTracker||(f._valueTracker=fu(f))}function rd(f){if(!f)return!1;var v=f._valueTracker;if(!v)return!0;var A=v.getValue(),k="";return f&&(k=nd(f)?f.checked?"true":"false":f.value),f=k,f!==A?(v.setValue(f),!0):!1}function Nc(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}var jl=/[\n"\\]/g;function bo(f){return f.replace(jl,function(v){return"\\"+v.charCodeAt(0).toString(16)+" "})}function sh(f,v,A,k,H,te,Se,Be){f.name="",Se!=null&&typeof Se!="function"&&typeof Se!="symbol"&&typeof Se!="boolean"?f.type=Se:f.removeAttribute("type"),v!=null?Se==="number"?(v===0&&f.value===""||f.value!=v)&&(f.value=""+Ro(v)):f.value!==""+Ro(v)&&(f.value=""+Ro(v)):Se!=="submit"&&Se!=="reset"||f.removeAttribute("value"),v!=null?ms(f,Se,Ro(v)):A!=null?ms(f,Se,Ro(A)):k!=null&&f.removeAttribute("value"),H==null&&te!=null&&(f.defaultChecked=!!te),H!=null&&(f.checked=H&&typeof H!="function"&&typeof H!="symbol"),Be!=null&&typeof Be!="function"&&typeof Be!="symbol"&&typeof Be!="boolean"?f.name=""+Ro(Be):f.removeAttribute("name")}function ls(f,v,A,k,H,te,Se,Be){if(te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"&&(f.type=te),v!=null||A!=null){if(!(te!=="submit"&&te!=="reset"||v!=null))return;A=A!=null?""+Ro(A):"",v=v!=null?""+Ro(v):A,Be||v===f.value||(f.value=v),f.defaultValue=v}k=k??H,k=typeof k!="function"&&typeof k!="symbol"&&!!k,f.checked=Be?f.checked:!!k,f.defaultChecked=!!k,Se!=null&&typeof Se!="function"&&typeof Se!="symbol"&&typeof Se!="boolean"&&(f.name=Se)}function ms(f,v,A){v==="number"&&Nc(f.ownerDocument)===f||f.defaultValue===""+A||(f.defaultValue=""+A)}function Xo(f,v,A,k){if(f=f.options,v){v={};for(var H=0;H<A.length;H++)v["$"+A[H]]=!0;for(A=0;A<f.length;A++)H=v.hasOwnProperty("$"+f[A].value),f[A].selected!==H&&(f[A].selected=H),H&&k&&(f[A].defaultSelected=!0)}else{for(A=""+Ro(A),v=null,H=0;H<f.length;H++){if(f[H].value===A){f[H].selected=!0,k&&(f[H].defaultSelected=!0);return}v!==null||f[H].disabled||(v=f[H])}v!==null&&(v.selected=!0)}}function Bl(f,v,A){if(v!=null&&(v=""+Ro(v),v!==f.value&&(f.value=v),A==null)){f.defaultValue!==v&&(f.defaultValue=v);return}f.defaultValue=A!=null?""+Ro(A):""}function cl(f,v,A,k){if(v==null){if(k!=null){if(A!=null)throw Error(i(92));if(ht(k)){if(1<k.length)throw Error(i(93));k=k[0]}A=k}A==null&&(A=""),v=A}A=Ro(v),f.defaultValue=A,k=f.textContent,k===A&&k!==""&&k!==null&&(f.value=k)}function Cs(f,v){if(v){var A=f.firstChild;if(A&&A===f.lastChild&&A.nodeType===3){A.nodeValue=v;return}}f.textContent=v}var id=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function El(f,v,A){var k=v.indexOf("--")===0;A==null||typeof A=="boolean"||A===""?k?f.setProperty(v,""):v==="float"?f.cssFloat="":f[v]="":k?f.setProperty(v,A):typeof A!="number"||A===0||id.has(v)?v==="float"?f.cssFloat=A:f[v]=(""+A).trim():f[v]=A+"px"}function zc(f,v,A){if(v!=null&&typeof v!="object")throw Error(i(62));if(f=f.style,A!=null){for(var k in A)!A.hasOwnProperty(k)||v!=null&&v.hasOwnProperty(k)||(k.indexOf("--")===0?f.setProperty(k,""):k==="float"?f.cssFloat="":f[k]="");for(var H in v)k=v[H],v.hasOwnProperty(H)&&A[H]!==k&&El(f,H,k)}else for(var te in v)v.hasOwnProperty(te)&&El(f,te,v[te])}function gs(f){if(f.indexOf("-")===-1)return!1;switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ch(f){return Sp.test(""+f)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":f}var Zo=null;function Fl(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Vl=null,ul=null;function Tp(f){var v=zt(f);if(v&&(f=v.stateNode)){var A=f[ye]||null;e:switch(f=v.stateNode,v.type){case"input":if(sh(f,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name),v=A.name,A.type==="radio"&&v!=null){for(A=f;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll('input[name="'+bo(""+v)+'"][type="radio"]'),v=0;v<A.length;v++){var k=A[v];if(k!==f&&k.form===f.form){var H=k[ye]||null;if(!H)throw Error(i(90));sh(k,H.value,H.defaultValue,H.defaultValue,H.checked,H.defaultChecked,H.type,H.name)}}for(v=0;v<A.length;v++)k=A[v],k.form===f.form&&rd(k)}break e;case"textarea":Bl(f,A.value,A.defaultValue);break e;case"select":v=A.value,v!=null&&Xo(f,!!A.multiple,v,!1)}}}var af=!1;function uh(f,v,A){if(af)return f(v,A);af=!0;try{var k=f(v);return k}finally{if(af=!1,(Vl!==null||ul!==null)&&(ma(),Vl&&(v=Vl,f=ul,ul=Vl=null,Tp(v),f)))for(v=0;v<f.length;v++)Tp(f[v])}}function Fr(f,v){var A=f.stateNode;if(A===null)return null;var k=A[ye]||null;if(k===null)return null;A=k[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(f=f.type,k=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!k;break e;default:f=!1}if(f)return null;if(A&&typeof A!="function")throw Error(i(231,v,typeof A));return A}var hl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jc=!1;if(hl)try{var pc={};Object.defineProperty(pc,"passive",{get:function(){jc=!0}}),window.addEventListener("test",pc,pc),window.removeEventListener("test",pc,pc)}catch{jc=!1}var Bc=null,pu=null,Al=null;function mc(){if(Al)return Al;var f,v=pu,A=v.length,k,H="value"in Bc?Bc.value:Bc.textContent,te=H.length;for(f=0;f<A&&v[f]===H[f];f++);var Se=A-f;for(k=1;k<=Se&&v[A-k]===H[te-k];k++);return Al=H.slice(f,1<k?1-k:void 0)}function Fc(f){var v=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&v===13&&(f=13)):f=v,f===10&&(f=13),32<=f||f===13?f:0}function di(){return!0}function mu(){return!1}function jo(f){function v(A,k,H,te,Se){this._reactName=A,this._targetInst=H,this.type=k,this.nativeEvent=te,this.target=Se,this.currentTarget=null;for(var Be in f)f.hasOwnProperty(Be)&&(A=f[Be],this[Be]=A?A(te):te[Be]);return this.isDefaultPrevented=(te.defaultPrevented!=null?te.defaultPrevented:te.returnValue===!1)?di:mu,this.isPropagationStopped=mu,this}return M(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=di)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=di)},persist:function(){},isPersistent:di}),v}var dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ul=jo(dl),gu=M({},dl,{view:0,detail:0}),ad=jo(gu),Vc,Cl,Yo,hh=M({},gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ld,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Yo&&(Yo&&f.type==="mousemove"?(Vc=f.screenX-Yo.screenX,Cl=f.screenY-Yo.screenY):Cl=Vc=0,Yo=f),Vc)},movementY:function(f){return"movementY"in f?f.movementY:Cl}}),Ep=jo(hh),yu=M({},hh,{dataTransfer:0}),Ms=jo(yu),Km=M({},gu,{relatedTarget:0}),dh=jo(Km),Ap=M({},dl,{animationName:0,elapsedTime:0,pseudoElement:0}),pi=jo(Ap),od=M({},dl,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),fh=jo(od),Jm=M({},dl,{data:0}),Gn=jo(Jm),Qm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_u={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gs(f){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(f):(f=_u[f])?!!v[f]:!1}function ld(){return Gs}var ph=M({},gu,{key:function(f){if(f.key){var v=Qm[f.key]||f.key;if(v!=="Unidentified")return v}return f.type==="keypress"?(f=Fc(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?sd[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ld,charCode:function(f){return f.type==="keypress"?Fc(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?Fc(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),Vn=jo(ph),fi=M({},hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xr=jo(fi),cs=M({},gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ld}),gc=jo(cs),ge=M({},dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),ie=jo(ge),_e=M({},hh,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Xe=jo(_e),lt=M({},dl,{newState:0,oldState:0}),fn=jo(lt),Qn=[9,13,27,32],fr=hl&&"CompositionEvent"in window,Vr=null;hl&&"documentMode"in document&&(Vr=document.documentMode);var Bi=hl&&"TextEvent"in window&&!Vr,Zi=hl&&(!fr||Vr&&8<Vr&&11>=Vr),za=" ",Uc=!1;function Ko(f,v){switch(f){case"keyup":return Qn.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ml(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var wo=!1;function $c(f,v){switch(f){case"compositionend":return Ml(v);case"keypress":return v.which!==32?null:(Uc=!0,za);case"textInput":return f=v.data,f===za&&Uc?null:f;default:return null}}function yr(f,v){if(wo)return f==="compositionend"||!fr&&Ko(f,v)?(f=mc(),Al=pu=Bc=null,wo=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return Zi&&v.locale!=="ko"?null:v.data;default:return null}}var Tn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ws(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v==="input"?!!Tn[f.type]:v==="textarea"}function er(f,v,A,k){Vl?ul?ul.push(k):ul=[k]:Vl=k,v=$f(v,"onChange"),0<v.length&&(A=new Ul("onChange","change",null,A,k),f.push({event:A,listeners:v}))}var fa=null,$l=null;function Wn(f){tb(f,0)}function Pl(f){var v=Fn(f);if(rd(v))return f}function yc(f,v){if(f==="change")return v}var ql=!1;if(hl){var of;if(hl){var Ps="oninput"in document;if(!Ps){var Jo=document.createElement("div");Jo.setAttribute("oninput","return;"),Ps=typeof Jo.oninput=="function"}of=Ps}else of=!1;ql=of&&(!document.documentMode||9<document.documentMode)}function mh(){fa&&(fa.detachEvent("onpropertychange",no),$l=fa=null)}function no(f){if(f.propertyName==="value"&&Pl($l)){var v=[];er(v,$l,f,Fl(f)),uh(Wn,v)}}function Cy(f,v,A){f==="focusin"?(mh(),fa=v,$l=A,fa.attachEvent("onpropertychange",no)):f==="focusout"&&mh()}function qc(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Pl($l)}function ys(f,v){if(f==="click")return Pl(v)}function Cp(f,v){if(f==="input"||f==="change")return Pl(v)}function U0(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var Ol=typeof Object.is=="function"?Object.is:U0;function Hl(f,v){if(Ol(f,v))return!0;if(typeof f!="object"||f===null||typeof v!="object"||v===null)return!1;var A=Object.keys(f),k=Object.keys(v);if(A.length!==k.length)return!1;for(k=0;k<A.length;k++){var H=A[k];if(!cn.call(v,H)||!Ol(f[H],v[H]))return!1}return!0}function cd(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function gh(f,v){var A=cd(f);f=0;for(var k;A;){if(A.nodeType===3){if(k=f+A.textContent.length,f<=v&&k>=v)return{node:A,offset:v-f};f=k}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=cd(A)}}function ud(f,v){return f&&v?f===v?!0:f&&f.nodeType===3?!1:v&&v.nodeType===3?ud(f,v.parentNode):"contains"in f?f.contains(v):f.compareDocumentPosition?!!(f.compareDocumentPosition(v)&16):!1:!1}function My(f){f=f!=null&&f.ownerDocument!=null&&f.ownerDocument.defaultView!=null?f.ownerDocument.defaultView:window;for(var v=Nc(f.document);v instanceof f.HTMLIFrameElement;){try{var A=typeof v.contentWindow.location.href=="string"}catch{A=!1}if(A)f=v.contentWindow;else break;v=Nc(f.document)}return v}function sf(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v&&(v==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||v==="textarea"||f.contentEditable==="true")}var Py=hl&&"documentMode"in document&&11>=document.documentMode,Rl=null,Oy=null,lf=null,Ry=!1;function Iy(f,v,A){var k=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;Ry||Rl==null||Rl!==Nc(k)||(k=Rl,"selectionStart"in k&&sf(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),lf&&Hl(lf,k)||(lf=k,k=$f(Oy,"onSelect"),0<k.length&&(v=new Ul("onSelect","select",null,v,A),f.push({event:v,listeners:k}),v.target=Rl)))}function yh(f,v){var A={};return A[f.toLowerCase()]=v.toLowerCase(),A["Webkit"+f]="webkit"+v,A["Moz"+f]="moz"+v,A}var _h={animationend:yh("Animation","AnimationEnd"),animationiteration:yh("Animation","AnimationIteration"),animationstart:yh("Animation","AnimationStart"),transitionrun:yh("Transition","TransitionRun"),transitionstart:yh("Transition","TransitionStart"),transitioncancel:yh("Transition","TransitionCancel"),transitionend:yh("Transition","TransitionEnd")},Hc={},Dy={};hl&&(Dy=document.createElement("div").style,"AnimationEvent"in window||(delete _h.animationend.animation,delete _h.animationiteration.animation,delete _h.animationstart.animation),"TransitionEvent"in window||delete _h.transitionend.transition);function vh(f){if(Hc[f])return Hc[f];if(!_h[f])return f;var v=_h[f],A;for(A in v)if(v.hasOwnProperty(A)&&A in Dy)return Hc[f]=v[A];return f}var Mp=vh("animationend"),vu=vh("animationiteration"),cf=vh("animationstart"),Gl=vh("transitionrun"),ky=vh("transitionstart"),uf=vh("transitioncancel"),hd=vh("transitionend"),eg=new Map,hf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hf.push("scrollEnd");function ho(f,v){eg.set(f,v),Sr(v,[f])}var Pp=new WeakMap;function nn(f,v){if(typeof f=="object"&&f!==null){var A=Pp.get(f);return A!==void 0?A:(v={value:f,source:v,stack:xo(v)},Pp.set(f,v),v)}return{value:f,source:v,stack:xo(v)}}var fl=[],xu=0,df=0;function xh(){for(var f=xu,v=df=xu=0;v<f;){var A=fl[v];fl[v++]=null;var k=fl[v];fl[v++]=null;var H=fl[v];fl[v++]=null;var te=fl[v];if(fl[v++]=null,k!==null&&H!==null){var Se=k.pending;Se===null?H.next=H:(H.next=Se.next,Se.next=H),k.pending=H}te!==0&&wu(A,H,te)}}function Gc(f,v,A,k){fl[xu++]=f,fl[xu++]=v,fl[xu++]=A,fl[xu++]=k,df|=k,f.lanes|=k,f=f.alternate,f!==null&&(f.lanes|=k)}function pl(f,v,A,k){return Gc(f,v,A,k),bh(f)}function bu(f,v){return Gc(f,null,null,v),bh(f)}function wu(f,v,A){f.lanes|=A;var k=f.alternate;k!==null&&(k.lanes|=A);for(var H=!1,te=f.return;te!==null;)te.childLanes|=A,k=te.alternate,k!==null&&(k.childLanes|=A),te.tag===22&&(f=te.stateNode,f===null||f._visibility&1||(H=!0)),f=te,te=te.return;return f.tag===3?(te=f.stateNode,H&&v!==null&&(H=31-Mi(A),f=te.hiddenUpdates,k=f[H],k===null?f[H]=[v]:k.push(v),v.lane=A|536870912),te):null}function bh(f){if(50<wa)throw wa=0,Co=null,Error(i(185));for(var v=f.return;v!==null;)f=v,v=f.return;return f.tag===3?f.stateNode:null}var Os={};function Wr(f,v,A,k){this.tag=f,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Il(f,v,A,k){return new Wr(f,v,A,k)}function Op(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Su(f,v){var A=f.alternate;return A===null?(A=Il(f.tag,v,f.key,f.mode),A.elementType=f.elementType,A.type=f.type,A.stateNode=f.stateNode,A.alternate=f,f.alternate=A):(A.pendingProps=v,A.type=f.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=f.flags&65011712,A.childLanes=f.childLanes,A.lanes=f.lanes,A.child=f.child,A.memoizedProps=f.memoizedProps,A.memoizedState=f.memoizedState,A.updateQueue=f.updateQueue,v=f.dependencies,A.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},A.sibling=f.sibling,A.index=f.index,A.ref=f.ref,A.refCleanup=f.refCleanup,A}function tg(f,v){f.flags&=65011714;var A=f.alternate;return A===null?(f.childLanes=0,f.lanes=v,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=A.childLanes,f.lanes=A.lanes,f.child=A.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=A.memoizedProps,f.memoizedState=A.memoizedState,f.updateQueue=A.updateQueue,f.type=A.type,v=A.dependencies,f.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),f}function Rp(f,v,A,k,H,te){var Se=0;if(k=f,typeof f=="function")Op(f)&&(Se=1);else if(typeof f=="string")Se=BS(f,A,Ut.current)?26:f==="html"||f==="head"||f==="body"?27:5;else e:switch(f){case De:return f=Il(31,A,v,H),f.elementType=De,f.lanes=te,f;case G:return Ii(A.children,H,te,v);case q:Se=8,H|=24;break;case V:return f=Il(12,A,v,H|2),f.elementType=V,f.lanes=te,f;case ne:return f=Il(13,A,v,H),f.elementType=ne,f.lanes=te,f;case ce:return f=Il(19,A,v,H),f.elementType=ce,f.lanes=te,f;default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case J:case re:Se=10;break e;case ee:Se=9;break e;case fe:Se=11;break e;case me:Se=14;break e;case ve:Se=16,k=null;break e}Se=29,A=Error(i(130,f===null?"null":typeof f,"")),k=null}return v=Il(Se,A,v,H),v.elementType=f,v.type=k,v.lanes=te,v}function Ii(f,v,A,k){return f=Il(7,f,k,v),f.lanes=A,f}function Ly(f,v,A){return f=Il(6,f,null,v),f.lanes=A,f}function Ny(f,v,A){return v=Il(4,f.children!==null?f.children:[],f.key,v),v.lanes=A,v.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},v}var ff=[],pf=0,Ip=null,ng=0,Xs=[],Wl=0,wh=null,_c=1,Xl="";function Tu(f,v){ff[pf++]=ng,ff[pf++]=Ip,Ip=f,ng=v}function Sh(f,v,A){Xs[Wl++]=_c,Xs[Wl++]=Xl,Xs[Wl++]=wh,wh=f;var k=_c;f=Xl;var H=32-Mi(k)-1;k&=~(1<<H),A+=1;var te=32-Mi(v)+H;if(30<te){var Se=H-H%5;te=(k&(1<<Se)-1).toString(32),k>>=Se,H-=Se,_c=1<<32-Mi(v)+H|A<<H|k,Xl=te+f}else _c=1<<te|A<<H|k,Xl=f}function Th(f){f.return!==null&&(Tu(f,1),Sh(f,1,0))}function mf(f){for(;f===Ip;)Ip=ff[--pf],ff[pf]=null,ng=ff[--pf],ff[pf]=null;for(;f===wh;)wh=Xs[--Wl],Xs[Wl]=null,Xl=Xs[--Wl],Xs[Wl]=null,_c=Xs[--Wl],Xs[Wl]=null}var us=null,ja=null,pa=!1,Eu=null,vc=!1,Eh=Error(i(519));function Wc(f){var v=Error(i(418,""));throw gf(nn(v,f)),Eh}function Dp(f){var v=f.stateNode,A=f.type,k=f.memoizedProps;switch(v[he]=f,v[ye]=k,A){case"dialog":Wi("cancel",v),Wi("close",v);break;case"iframe":case"object":case"embed":Wi("load",v);break;case"video":case"audio":for(A=0;A<Dg.length;A++)Wi(Dg[A],v);break;case"source":Wi("error",v);break;case"img":case"image":case"link":Wi("error",v),Wi("load",v);break;case"details":Wi("toggle",v);break;case"input":Wi("invalid",v),ls(v,k.value,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name,!0),Lc(v);break;case"select":Wi("invalid",v);break;case"textarea":Wi("invalid",v),cl(v,k.value,k.defaultValue,k.children),Lc(v)}A=k.children,typeof A!="string"&&typeof A!="number"&&typeof A!="bigint"||v.textContent===""+A||k.suppressHydrationWarning===!0||nb(v.textContent,A)?(k.popover!=null&&(Wi("beforetoggle",v),Wi("toggle",v)),k.onScroll!=null&&Wi("scroll",v),k.onScrollEnd!=null&&Wi("scrollend",v),k.onClick!=null&&(v.onclick=Bh),v=!0):v=!1,v||Wc(f)}function rg(f){for(us=f.return;us;)switch(us.tag){case 5:case 13:vc=!1;return;case 27:case 3:vc=!0;return;default:us=us.return}}function Ah(f){if(f!==us)return!1;if(!pa)return rg(f),pa=!0,!1;var v=f.tag,A;if((A=v!==3&&v!==27)&&((A=v===5)&&(A=f.type,A=!(A!=="form"&&A!=="button")||ob(f.type,f.memoizedProps)),A=!A),A&&ja&&Wc(f),rg(f),v===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));e:{for(f=f.nextSibling,v=0;f;){if(f.nodeType===8)if(A=f.data,A==="/$"){if(v===0){ja=Hu(f.nextSibling);break e}v--}else A!=="$"&&A!=="$!"&&A!=="$?"||v++;f=f.nextSibling}ja=null}}else v===27?(v=ja,qu(f.type)?(f=Lv,Lv=null,ja=f):ja=v):ja=us?Hu(f.stateNode.nextSibling):null;return!0}function Au(){ja=us=null,pa=!1}function zy(){var f=Eu;return f!==null&&(lr===null?lr=f:lr.push.apply(lr,f),Eu=null),f}function gf(f){Eu===null?Eu=[f]:Eu.push(f)}var ig=vt(null),Zl=null,Xc=null;function Zc(f,v,A){gt(ig,v._currentValue),v._currentValue=A}function Cu(f){f._currentValue=ig.current,nt(ig)}function ag(f,v,A){for(;f!==null;){var k=f.alternate;if((f.childLanes&v)!==v?(f.childLanes|=v,k!==null&&(k.childLanes|=v)):k!==null&&(k.childLanes&v)!==v&&(k.childLanes|=v),f===A)break;f=f.return}}function kp(f,v,A,k){var H=f.child;for(H!==null&&(H.return=f);H!==null;){var te=H.dependencies;if(te!==null){var Se=H.child;te=te.firstContext;e:for(;te!==null;){var Be=te;te=H;for(var bt=0;bt<v.length;bt++)if(Be.context===v[bt]){te.lanes|=A,Be=te.alternate,Be!==null&&(Be.lanes|=A),ag(te.return,A,f),k||(Se=null);break e}te=Be.next}}else if(H.tag===18){if(Se=H.return,Se===null)throw Error(i(341));Se.lanes|=A,te=Se.alternate,te!==null&&(te.lanes|=A),ag(Se,A,f),Se=null}else Se=H.child;if(Se!==null)Se.return=H;else for(Se=H;Se!==null;){if(Se===f){Se=null;break}if(H=Se.sibling,H!==null){H.return=Se.return,Se=H;break}Se=Se.return}H=Se}}function dd(f,v,A,k){f=null;for(var H=v,te=!1;H!==null;){if(!te){if((H.flags&524288)!==0)te=!0;else if((H.flags&262144)!==0)break}if(H.tag===10){var Se=H.alternate;if(Se===null)throw Error(i(387));if(Se=Se.memoizedProps,Se!==null){var Be=H.type;Ol(H.pendingProps.value,Se.value)||(f!==null?f.push(Be):f=[Be])}}else if(H===Ht.current){if(Se=H.alternate,Se===null)throw Error(i(387));Se.memoizedState.memoizedState!==H.memoizedState.memoizedState&&(f!==null?f.push(ym):f=[ym])}H=H.return}f!==null&&kp(v,f,A,k),v.flags|=262144}function yf(f){for(f=f.firstContext;f!==null;){if(!Ol(f.context._currentValue,f.memoizedValue))return!0;f=f.next}return!1}function Yc(f){Zl=f,Xc=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function hs(f){return jy(Zl,f)}function Kc(f,v){return Zl===null&&Yc(f),jy(f,v)}function jy(f,v){var A=v._currentValue;if(v={context:v,memoizedValue:A,next:null},Xc===null){if(f===null)throw Error(i(308));Xc=v,f.dependencies={lanes:0,firstContext:v},f.flags|=524288}else Xc=Xc.next=v;return A}var _f=typeof AbortController<"u"?AbortController:function(){var f=[],v=this.signal={aborted:!1,addEventListener:function(A,k){f.push(k)}};this.abort=function(){v.aborted=!0,f.forEach(function(A){return A()})}},Lp=e.unstable_scheduleCallback,og=e.unstable_NormalPriority,sa={$$typeof:re,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Np(){return{controller:new _f,data:new Map,refCount:0}}function Ch(f){f.refCount--,f.refCount===0&&Lp(og,function(){f.controller.abort()})}var Mu=null,vf=0,Mh=0,Ph=null;function sg(f,v){if(Mu===null){var A=Mu=[];vf=0,Mh=K0(),Ph={status:"pending",value:void 0,then:function(k){A.push(k)}}}return vf++,v.then(zp,zp),v}function zp(){if(--vf===0&&Mu!==null){Ph!==null&&(Ph.status="fulfilled");var f=Mu;Mu=null,Mh=0,Ph=null;for(var v=0;v<f.length;v++)(0,f[v])()}}function lg(f,v){var A=[],k={status:"pending",value:null,reason:null,then:function(H){A.push(H)}};return f.then(function(){k.status="fulfilled",k.value=v;for(var H=0;H<A.length;H++)(0,A[H])(v)},function(H){for(k.status="rejected",k.reason=H,H=0;H<A.length;H++)(0,A[H])(void 0)}),k}var Oh=Ie.S;Ie.S=function(f,v){typeof v=="object"&&v!==null&&typeof v.then=="function"&&sg(f,v),Oh!==null&&Oh(f,v)};var Pu=vt(null);function jp(){var f=Pu.current;return f!==null?f:Nt.pooledCache}function Bp(f,v){v===null?gt(Pu,Pu.current):gt(Pu,v.pool)}function fd(){var f=jp();return f===null?null:{parent:sa._currentValue,pool:f}}var xf=Error(i(460)),By=Error(i(474)),cg=Error(i(542)),Fy={then:function(){}};function pv(f){return f=f.status,f==="fulfilled"||f==="rejected"}function pd(){}function ug(f,v,A){switch(A=f[A],A===void 0?f.push(v):A!==v&&(v.then(pd,pd),v=A),v.status){case"fulfilled":return v.value;case"rejected":throw f=v.reason,gd(f),f;default:if(typeof v.status=="string")v.then(pd,pd);else{if(f=Nt,f!==null&&100<f.shellSuspendCounter)throw Error(i(482));f=v,f.status="pending",f.then(function(k){if(v.status==="pending"){var H=v;H.status="fulfilled",H.value=k}},function(k){if(v.status==="pending"){var H=v;H.status="rejected",H.reason=k}})}switch(v.status){case"fulfilled":return v.value;case"rejected":throw f=v.reason,gd(f),f}throw md=v,xf}}var md=null;function Vy(){if(md===null)throw Error(i(459));var f=md;return md=null,f}function gd(f){if(f===xf||f===cg)throw Error(i(483))}var Jc=!1;function hg(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function dg(f,v){f=f.updateQueue,v.updateQueue===f&&(v.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function xc(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function Zs(f,v,A){var k=f.updateQueue;if(k===null)return null;if(k=k.shared,(It&2)!==0){var H=k.pending;return H===null?v.next=v:(v.next=H.next,H.next=v),k.pending=v,v=bh(f),wu(f,null,A),v}return Gc(f,k,v,A),bh(f)}function yd(f,v,A){if(v=v.updateQueue,v!==null&&(v=v.shared,(A&4194048)!==0)){var k=v.lanes;k&=f.pendingLanes,A|=k,v.lanes=A,kt(f,A)}}function Qc(f,v){var A=f.updateQueue,k=f.alternate;if(k!==null&&(k=k.updateQueue,A===k)){var H=null,te=null;if(A=A.firstBaseUpdate,A!==null){do{var Se={lane:A.lane,tag:A.tag,payload:A.payload,callback:null,next:null};te===null?H=te=Se:te=te.next=Se,A=A.next}while(A!==null);te===null?H=te=v:te=te.next=v}else H=te=v;A={baseState:k.baseState,firstBaseUpdate:H,lastBaseUpdate:te,shared:k.shared,callbacks:k.callbacks},f.updateQueue=A;return}f=A.lastBaseUpdate,f===null?A.firstBaseUpdate=v:f.next=v,A.lastBaseUpdate=v}var eu=!1;function Rh(){if(eu){var f=Ph;if(f!==null)throw f}}function bf(f,v,A,k){eu=!1;var H=f.updateQueue;Jc=!1;var te=H.firstBaseUpdate,Se=H.lastBaseUpdate,Be=H.shared.pending;if(Be!==null){H.shared.pending=null;var bt=Be,Gt=bt.next;bt.next=null,Se===null?te=Gt:Se.next=Gt,Se=bt;var Sn=f.alternate;Sn!==null&&(Sn=Sn.updateQueue,Be=Sn.lastBaseUpdate,Be!==Se&&(Be===null?Sn.firstBaseUpdate=Gt:Be.next=Gt,Sn.lastBaseUpdate=bt))}if(te!==null){var In=H.baseState;Se=0,Sn=Gt=bt=null,Be=te;do{var sn=Be.lane&-536870913,dn=sn!==Be.lane;if(dn?(Ft&sn)===sn:(k&sn)===sn){sn!==0&&sn===Mh&&(eu=!0),Sn!==null&&(Sn=Sn.next={lane:0,tag:Be.tag,payload:Be.payload,callback:null,next:null});e:{var _i=f,Kr=Be;sn=v;var La=A;switch(Kr.tag){case 1:if(_i=Kr.payload,typeof _i=="function"){In=_i.call(La,In,sn);break e}In=_i;break e;case 3:_i.flags=_i.flags&-65537|128;case 0:if(_i=Kr.payload,sn=typeof _i=="function"?_i.call(La,In,sn):_i,sn==null)break e;In=M({},In,sn);break e;case 2:Jc=!0}}sn=Be.callback,sn!==null&&(f.flags|=64,dn&&(f.flags|=8192),dn=H.callbacks,dn===null?H.callbacks=[sn]:dn.push(sn))}else dn={lane:sn,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},Sn===null?(Gt=Sn=dn,bt=In):Sn=Sn.next=dn,Se|=sn;if(Be=Be.next,Be===null){if(Be=H.shared.pending,Be===null)break;dn=Be,Be=dn.next,dn.next=null,H.lastBaseUpdate=dn,H.shared.pending=null}}while(!0);Sn===null&&(bt=In),H.baseState=bt,H.firstBaseUpdate=Gt,H.lastBaseUpdate=Sn,te===null&&(H.shared.lanes=0),pr|=Se,f.lanes=Se,f.memoizedState=In}}function Uy(f,v){if(typeof f!="function")throw Error(i(191,f));f.call(v)}function Fp(f,v){var A=f.callbacks;if(A!==null)for(f.callbacks=null,f=0;f<A.length;f++)Uy(A[f],v)}var Ou=vt(null),Vp=vt(0);function fg(f,v){f=Kn,gt(Vp,f),gt(Ou,v),Kn=f|v.baseLanes}function Ru(){gt(Vp,Kn),gt(Ou,Ou.current)}function Up(){Kn=Vp.current,nt(Ou),nt(Vp)}var Iu=0,Di=null,Yi=null,So=null,wf=!1,Yl=!1,tu=!1,bc=0,_d=0,Kl=null,$p=0;function fo(){throw Error(i(321))}function pg(f,v){if(v===null)return!1;for(var A=0;A<v.length&&A<f.length;A++)if(!Ol(f[A],v[A]))return!1;return!0}function qp(f,v,A,k,H,te){return Iu=te,Di=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,Ie.H=f===null||f.memoizedState===null?kh:bg,tu=!1,te=A(k,H),tu=!1,Yl&&(te=Sf(v,A,k,H)),Du(f),te}function Du(f){Ie.H=Nu;var v=Yi!==null&&Yi.next!==null;if(Iu=0,So=Yi=Di=null,wf=!1,_d=0,Kl=null,v)throw Error(i(300));f===null||To||(f=f.dependencies,f!==null&&yf(f)&&(To=!0))}function Sf(f,v,A,k){Di=f;var H=0;do{if(Yl&&(Kl=null),_d=0,Yl=!1,25<=H)throw Error(i(301));if(H+=1,So=Yi=null,f.updateQueue!=null){var te=f.updateQueue;te.lastEffect=null,te.events=null,te.stores=null,te.memoCache!=null&&(te.memoCache.index=0)}Ie.H=Ky,te=v(A,k)}while(Yl);return te}function Rn(){var f=Ie.H,v=f.useState()[0];return v=typeof v.then=="function"?Gp(v):v,f=f.useState()[0],(Yi!==null?Yi.memoizedState:null)!==f&&(Di.flags|=1024),v}function Tf(){var f=bc!==0;return bc=0,f}function vd(f,v,A){v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~A}function wc(f){if(wf){for(f=f.memoizedState;f!==null;){var v=f.queue;v!==null&&(v.pending=null),f=f.next}wf=!1}Iu=0,So=Yi=Di=null,Yl=!1,_d=bc=0,Kl=null}function ka(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return So===null?Di.memoizedState=So=f:So=So.next=f,So}function jn(){if(Yi===null){var f=Di.alternate;f=f!==null?f.memoizedState:null}else f=Yi.next;var v=So===null?Di.memoizedState:So.next;if(v!==null)So=v,Yi=f;else{if(f===null)throw Di.alternate===null?Error(i(467)):Error(i(310));Yi=f,f={memoizedState:Yi.memoizedState,baseState:Yi.baseState,baseQueue:Yi.baseQueue,queue:Yi.queue,next:null},So===null?Di.memoizedState=So=f:So=So.next=f}return So}function Hp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gp(f){var v=_d;return _d+=1,Kl===null&&(Kl=[]),f=ug(Kl,f,v),v=Di,(So===null?v.memoizedState:So.next)===null&&(v=v.alternate,Ie.H=v===null||v.memoizedState===null?kh:bg),f}function mg(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return Gp(f);if(f.$$typeof===re)return hs(f)}throw Error(i(438,String(f)))}function Ef(f){var v=null,A=Di.updateQueue;if(A!==null&&(v=A.memoCache),v==null){var k=Di.alternate;k!==null&&(k=k.updateQueue,k!==null&&(k=k.memoCache,k!=null&&(v={data:k.data.map(function(H){return H.slice()}),index:0})))}if(v==null&&(v={data:[],index:0}),A===null&&(A=Hp(),Di.updateQueue=A),A.memoCache=v,A=v.data[v.index],A===void 0)for(A=v.data[v.index]=Array(f),k=0;k<f;k++)A[k]=Ye;return v.index++,A}function Jl(f,v){return typeof v=="function"?v(f):v}function Wp(f){var v=jn();return Af(v,Yi,f)}function Af(f,v,A){var k=f.queue;if(k===null)throw Error(i(311));k.lastRenderedReducer=A;var H=f.baseQueue,te=k.pending;if(te!==null){if(H!==null){var Se=H.next;H.next=te.next,te.next=Se}v.baseQueue=H=te,k.pending=null}if(te=f.baseState,H===null)f.memoizedState=te;else{v=H.next;var Be=Se=null,bt=null,Gt=v,Sn=!1;do{var In=Gt.lane&-536870913;if(In!==Gt.lane?(Ft&In)===In:(Iu&In)===In){var sn=Gt.revertLane;if(sn===0)bt!==null&&(bt=bt.next={lane:0,revertLane:0,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null}),In===Mh&&(Sn=!0);else if((Iu&sn)===sn){Gt=Gt.next,sn===Mh&&(Sn=!0);continue}else In={lane:0,revertLane:Gt.revertLane,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null},bt===null?(Be=bt=In,Se=te):bt=bt.next=In,Di.lanes|=sn,pr|=sn;In=Gt.action,tu&&A(te,In),te=Gt.hasEagerState?Gt.eagerState:A(te,In)}else sn={lane:In,revertLane:Gt.revertLane,action:Gt.action,hasEagerState:Gt.hasEagerState,eagerState:Gt.eagerState,next:null},bt===null?(Be=bt=sn,Se=te):bt=bt.next=sn,Di.lanes|=In,pr|=In;Gt=Gt.next}while(Gt!==null&&Gt!==v);if(bt===null?Se=te:bt.next=Be,!Ol(te,f.memoizedState)&&(To=!0,Sn&&(A=Ph,A!==null)))throw A;f.memoizedState=te,f.baseState=Se,f.baseQueue=bt,k.lastRenderedState=te}return H===null&&(k.lanes=0),[f.memoizedState,k.dispatch]}function $y(f){var v=jn(),A=v.queue;if(A===null)throw Error(i(311));A.lastRenderedReducer=f;var k=A.dispatch,H=A.pending,te=v.memoizedState;if(H!==null){A.pending=null;var Se=H=H.next;do te=f(te,Se.action),Se=Se.next;while(Se!==H);Ol(te,v.memoizedState)||(To=!0),v.memoizedState=te,v.baseQueue===null&&(v.baseState=te),A.lastRenderedState=te}return[te,k]}function mv(f,v,A){var k=Di,H=jn(),te=pa;if(te){if(A===void 0)throw Error(i(407));A=A()}else A=v();var Se=!Ol((Yi||H).memoizedState,A);Se&&(H.memoizedState=A,To=!0),H=H.queue;var Be=_s.bind(null,k,H,f);if(st(2048,8,Be,[f]),H.getSnapshot!==v||Se||So!==null&&So.memoizedState.tag&1){if(k.flags|=2048,Jt(9,wn(),gg.bind(null,k,H,A,v),null),Nt===null)throw Error(i(349));te||(Iu&124)!==0||Ys(k,v,A)}return A}function Ys(f,v,A){f.flags|=16384,f={getSnapshot:v,value:A},v=Di.updateQueue,v===null?(v=Hp(),Di.updateQueue=v,v.stores=[f]):(A=v.stores,A===null?v.stores=[f]:A.push(f))}function gg(f,v,A,k){v.value=A,v.getSnapshot=k,ku(v)&&qy(f)}function _s(f,v,A){return A(function(){ku(v)&&qy(f)})}function ku(f){var v=f.getSnapshot;f=f.value;try{var A=v();return!Ol(f,A)}catch{return!0}}function qy(f){var v=bu(f,2);v!==null&&qa(v,f,2)}function Xp(f){var v=ka();if(typeof f=="function"){var A=f;if(f=A(),tu){mi(!0);try{A()}finally{mi(!1)}}}return v.memoizedState=v.baseState=f,v.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:f},v}function yg(f,v,A,k){return f.baseState=A,Af(f,Yi,typeof k=="function"?k:Jl)}function Hy(f,v,A,k,H){if(If(f))throw Error(i(485));if(f=v.action,f!==null){var te={payload:H,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Se){te.listeners.push(Se)}};Ie.T!==null?A(!0):te.isTransition=!1,k(te),A=v.pending,A===null?(te.next=v.pending=te,Gy(v,te)):(te.next=A.next,v.pending=A.next=te)}}function Gy(f,v){var A=v.action,k=v.payload,H=f.state;if(v.isTransition){var te=Ie.T,Se={};Ie.T=Se;try{var Be=A(H,k),bt=Ie.S;bt!==null&&bt(Se,Be),Sc(f,v,Be)}catch(Gt){xd(f,v,Gt)}finally{Ie.T=te}}else try{te=A(H,k),Sc(f,v,te)}catch(Gt){xd(f,v,Gt)}}function Sc(f,v,A){A!==null&&typeof A=="object"&&typeof A.then=="function"?A.then(function(k){Ei(f,v,k)},function(k){return xd(f,v,k)}):Ei(f,v,A)}function Ei(f,v,A){v.status="fulfilled",v.value=A,Zp(v),f.state=A,v=f.pending,v!==null&&(A=v.next,A===v?f.pending=null:(A=A.next,v.next=A,Gy(f,A)))}function xd(f,v,A){var k=f.pending;if(f.pending=null,k!==null){k=k.next;do v.status="rejected",v.reason=A,Zp(v),v=v.next;while(v!==k)}f.action=null}function Zp(f){f=f.listeners;for(var v=0;v<f.length;v++)(0,f[v])()}function Cf(f,v){return v}function Wy(f,v){if(pa){var A=Nt.formState;if(A!==null){e:{var k=Di;if(pa){if(ja){t:{for(var H=ja,te=vc;H.nodeType!==8;){if(!te){H=null;break t}if(H=Hu(H.nextSibling),H===null){H=null;break t}}te=H.data,H=te==="F!"||te==="F"?H:null}if(H){ja=Hu(H.nextSibling),k=H.data==="F!";break e}}Wc(k)}k=!1}k&&(v=A[0])}}return A=ka(),A.memoizedState=A.baseState=v,k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cf,lastRenderedState:v},A.queue=k,A=Rf.bind(null,Di,k),k.dispatch=A,k=Xp(!1),te=Ur.bind(null,Di,!1,k.queue),k=ka(),H={state:v,dispatch:null,action:f,pending:null},k.queue=H,A=Hy.bind(null,Di,H,te,A),H.dispatch=A,k.memoizedState=f,[v,A,!1]}function Xy(f){var v=jn();return Lu(v,Yi,f)}function Lu(f,v,A){if(v=Af(f,v,Cf)[0],f=Wp(Jl)[0],typeof v=="object"&&v!==null&&typeof v.then=="function")try{var k=Gp(v)}catch(Se){throw Se===xf?cg:Se}else k=v;v=jn();var H=v.queue,te=H.dispatch;return A!==v.memoizedState&&(Di.flags|=2048,Jt(9,wn(),bd.bind(null,H,A),null)),[k,te,f]}function bd(f,v){f.action=v}function Ql(f){var v=jn(),A=Yi;if(A!==null)return Lu(v,A,f);jn(),v=v.memoizedState,A=jn();var k=A.queue.dispatch;return A.memoizedState=f,[v,k,!1]}function Jt(f,v,A,k){return f={tag:f,create:A,deps:k,inst:v,next:null},v=Di.updateQueue,v===null&&(v=Hp(),Di.updateQueue=v),A=v.lastEffect,A===null?v.lastEffect=f.next=f:(k=A.next,A.next=f,f.next=k,v.lastEffect=f),f}function wn(){return{destroy:void 0,resource:void 0}}function wd(){return jn().memoizedState}function la(f,v,A,k){var H=ka();k=k===void 0?null:k,Di.flags|=f,H.memoizedState=Jt(1|v,wn(),A,k)}function st(f,v,A,k){var H=jn();k=k===void 0?null:k;var te=H.memoizedState.inst;Yi!==null&&k!==null&&pg(k,Yi.memoizedState.deps)?H.memoizedState=Jt(v,te,A,k):(Di.flags|=f,H.memoizedState=Jt(1|v,te,A,k))}function Zy(f,v){la(8390656,8,f,v)}function Mf(f,v){st(2048,8,f,v)}function Pf(f,v){return st(4,2,f,v)}function Sd(f,v){return st(4,4,f,v)}function _g(f,v){if(typeof v=="function"){f=f();var A=v(f);return function(){typeof A=="function"?A():v(null)}}if(v!=null)return f=f(),v.current=f,function(){v.current=null}}function Yp(f,v,A){A=A!=null?A.concat([f]):null,st(4,4,_g.bind(null,v,f),A)}function Ih(){}function Tc(f,v){var A=jn();v=v===void 0?null:v;var k=A.memoizedState;return v!==null&&pg(v,k[1])?k[0]:(A.memoizedState=[f,v],f)}function gv(f,v){var A=jn();v=v===void 0?null:v;var k=A.memoizedState;if(v!==null&&pg(v,k[1]))return k[0];if(k=f(),tu){mi(!0);try{f()}finally{mi(!1)}}return A.memoizedState=[k,v],k}function Kp(f,v,A){return A===void 0||(Iu&1073741824)!==0?f.memoizedState=v:(f.memoizedState=A,f=bs(),Di.lanes|=f,pr|=f,A)}function Jp(f,v,A,k){return Ol(A,v)?A:Ou.current!==null?(f=Kp(f,A,k),Ol(f,v)||(To=!0),f):(Iu&42)===0?(To=!0,f.memoizedState=A):(f=bs(),Di.lanes|=f,pr|=f,v)}function vg(f,v,A,k,H){var te=rt.p;rt.p=te!==0&&8>te?te:8;var Se=Ie.T,Be={};Ie.T=Be,Ur(f,!1,v,A);try{var bt=H(),Gt=Ie.S;if(Gt!==null&&Gt(Be,bt),bt!==null&&typeof bt=="object"&&typeof bt.then=="function"){var Sn=lg(bt,k);ki(f,v,Sn,po(f))}else ki(f,v,k,po(f))}catch(In){ki(f,v,{then:function(){},status:"rejected",reason:In},po())}finally{rt.p=te,Ie.T=Se}}function yv(){}function xg(f,v,A,k){if(f.tag!==5)throw Error(i(476));var H=Qp(f).queue;vg(f,H,v,Qe,A===null?yv:function(){return Of(f),A(k)})}function Qp(f){var v=f.memoizedState;if(v!==null)return v;v={memoizedState:Qe,baseState:Qe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:Qe},next:null};var A={};return v.next={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jl,lastRenderedState:A},next:null},f.memoizedState=v,f=f.alternate,f!==null&&(f.memoizedState=v),v}function Of(f){var v=Qp(f).next.queue;ki(f,v,{},po())}function Dh(){return hs(ym)}function Yy(){return jn().memoizedState}function _v(){return jn().memoizedState}function vs(f){for(var v=f.return;v!==null;){switch(v.tag){case 24:case 3:var A=po();f=xc(A);var k=Zs(v,f,A);k!==null&&(qa(k,v,A),yd(k,v,A)),v={cache:Np()},f.payload=v;return}v=v.return}}function $0(f,v,A){var k=po();A={lane:k,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null},If(f)?Rs(v,A):(A=pl(f,v,A,k),A!==null&&(qa(A,f,k),Td(A,v,k)))}function Rf(f,v,A){var k=po();ki(f,v,A,k)}function ki(f,v,A,k){var H={lane:k,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null};if(If(f))Rs(v,H);else{var te=f.alternate;if(f.lanes===0&&(te===null||te.lanes===0)&&(te=v.lastRenderedReducer,te!==null))try{var Se=v.lastRenderedState,Be=te(Se,A);if(H.hasEagerState=!0,H.eagerState=Be,Ol(Be,Se))return Gc(f,v,H,0),Nt===null&&xh(),!1}catch{}finally{}if(A=pl(f,v,H,k),A!==null)return qa(A,f,k),Td(A,v,k),!0}return!1}function Ur(f,v,A,k){if(k={lane:2,revertLane:K0(),action:k,hasEagerState:!1,eagerState:null,next:null},If(f)){if(v)throw Error(i(479))}else v=pl(f,A,k,2),v!==null&&qa(v,f,2)}function If(f){var v=f.alternate;return f===Di||v!==null&&v===Di}function Rs(f,v){Yl=wf=!0;var A=f.pending;A===null?v.next=v:(v.next=A.next,A.next=v),f.pending=v}function Td(f,v,A){if((A&4194048)!==0){var k=v.lanes;k&=f.pendingLanes,A|=k,v.lanes=A,kt(f,A)}}var Nu={readContext:hs,use:mg,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useLayoutEffect:fo,useInsertionEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useSyncExternalStore:fo,useId:fo,useHostTransitionStatus:fo,useFormState:fo,useActionState:fo,useOptimistic:fo,useMemoCache:fo,useCacheRefresh:fo},kh={readContext:hs,use:mg,useCallback:function(f,v){return ka().memoizedState=[f,v===void 0?null:v],f},useContext:hs,useEffect:Zy,useImperativeHandle:function(f,v,A){A=A!=null?A.concat([f]):null,la(4194308,4,_g.bind(null,v,f),A)},useLayoutEffect:function(f,v){return la(4194308,4,f,v)},useInsertionEffect:function(f,v){la(4,2,f,v)},useMemo:function(f,v){var A=ka();v=v===void 0?null:v;var k=f();if(tu){mi(!0);try{f()}finally{mi(!1)}}return A.memoizedState=[k,v],k},useReducer:function(f,v,A){var k=ka();if(A!==void 0){var H=A(v);if(tu){mi(!0);try{A(v)}finally{mi(!1)}}}else H=v;return k.memoizedState=k.baseState=H,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:H},k.queue=f,f=f.dispatch=$0.bind(null,Di,f),[k.memoizedState,f]},useRef:function(f){var v=ka();return f={current:f},v.memoizedState=f},useState:function(f){f=Xp(f);var v=f.queue,A=Rf.bind(null,Di,v);return v.dispatch=A,[f.memoizedState,A]},useDebugValue:Ih,useDeferredValue:function(f,v){var A=ka();return Kp(A,f,v)},useTransition:function(){var f=Xp(!1);return f=vg.bind(null,Di,f.queue,!0,!1),ka().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,v,A){var k=Di,H=ka();if(pa){if(A===void 0)throw Error(i(407));A=A()}else{if(A=v(),Nt===null)throw Error(i(349));(Ft&124)!==0||Ys(k,v,A)}H.memoizedState=A;var te={value:A,getSnapshot:v};return H.queue=te,Zy(_s.bind(null,k,te,f),[f]),k.flags|=2048,Jt(9,wn(),gg.bind(null,k,te,A,v),null),A},useId:function(){var f=ka(),v=Nt.identifierPrefix;if(pa){var A=Xl,k=_c;A=(k&~(1<<32-Mi(k)-1)).toString(32)+A,v=""+v+"R"+A,A=bc++,0<A&&(v+="H"+A.toString(32)),v+=""}else A=$p++,v=""+v+"r"+A.toString(32)+"";return f.memoizedState=v},useHostTransitionStatus:Dh,useFormState:Wy,useActionState:Wy,useOptimistic:function(f){var v=ka();v.memoizedState=v.baseState=f;var A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return v.queue=A,v=Ur.bind(null,Di,!0,A),A.dispatch=v,[f,v]},useMemoCache:Ef,useCacheRefresh:function(){return ka().memoizedState=vs.bind(null,Di)}},bg={readContext:hs,use:mg,useCallback:Tc,useContext:hs,useEffect:Mf,useImperativeHandle:Yp,useInsertionEffect:Pf,useLayoutEffect:Sd,useMemo:gv,useReducer:Wp,useRef:wd,useState:function(){return Wp(Jl)},useDebugValue:Ih,useDeferredValue:function(f,v){var A=jn();return Jp(A,Yi.memoizedState,f,v)},useTransition:function(){var f=Wp(Jl)[0],v=jn().memoizedState;return[typeof f=="boolean"?f:Gp(f),v]},useSyncExternalStore:mv,useId:Yy,useHostTransitionStatus:Dh,useFormState:Xy,useActionState:Xy,useOptimistic:function(f,v){var A=jn();return yg(A,Yi,f,v)},useMemoCache:Ef,useCacheRefresh:_v},Ky={readContext:hs,use:mg,useCallback:Tc,useContext:hs,useEffect:Mf,useImperativeHandle:Yp,useInsertionEffect:Pf,useLayoutEffect:Sd,useMemo:gv,useReducer:$y,useRef:wd,useState:function(){return $y(Jl)},useDebugValue:Ih,useDeferredValue:function(f,v){var A=jn();return Yi===null?Kp(A,f,v):Jp(A,Yi.memoizedState,f,v)},useTransition:function(){var f=$y(Jl)[0],v=jn().memoizedState;return[typeof f=="boolean"?f:Gp(f),v]},useSyncExternalStore:mv,useId:Yy,useHostTransitionStatus:Dh,useFormState:Ql,useActionState:Ql,useOptimistic:function(f,v){var A=jn();return Yi!==null?yg(A,Yi,f,v):(A.baseState=f,[f,A.queue.dispatch])},useMemoCache:Ef,useCacheRefresh:_v},zu=null,Lh=0;function Is(f){var v=Lh;return Lh+=1,zu===null&&(zu=[]),ug(zu,f,v)}function ec(f,v){v=v.props.ref,f.ref=v!==void 0?v:null}function ju(f,v){throw v.$$typeof===P?Error(i(525)):(f=Object.prototype.toString.call(v),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":f)))}function em(f){var v=f._init;return v(f._payload)}function tm(f){function v(jt,Ot){if(f){var Wt=jt.deletions;Wt===null?(jt.deletions=[Ot],jt.flags|=16):Wt.push(Ot)}}function A(jt,Ot){if(!f)return null;for(;Ot!==null;)v(jt,Ot),Ot=Ot.sibling;return null}function k(jt){for(var Ot=new Map;jt!==null;)jt.key!==null?Ot.set(jt.key,jt):Ot.set(jt.index,jt),jt=jt.sibling;return Ot}function H(jt,Ot){return jt=Su(jt,Ot),jt.index=0,jt.sibling=null,jt}function te(jt,Ot,Wt){return jt.index=Wt,f?(Wt=jt.alternate,Wt!==null?(Wt=Wt.index,Wt<Ot?(jt.flags|=67108866,Ot):Wt):(jt.flags|=67108866,Ot)):(jt.flags|=1048576,Ot)}function Se(jt){return f&&jt.alternate===null&&(jt.flags|=67108866),jt}function Be(jt,Ot,Wt,Pn){return Ot===null||Ot.tag!==6?(Ot=Ly(Wt,jt.mode,Pn),Ot.return=jt,Ot):(Ot=H(Ot,Wt),Ot.return=jt,Ot)}function bt(jt,Ot,Wt,Pn){var _r=Wt.type;return _r===G?Sn(jt,Ot,Wt.props.children,Pn,Wt.key):Ot!==null&&(Ot.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===ve&&em(_r)===Ot.type)?(Ot=H(Ot,Wt.props),ec(Ot,Wt),Ot.return=jt,Ot):(Ot=Rp(Wt.type,Wt.key,Wt.props,null,jt.mode,Pn),ec(Ot,Wt),Ot.return=jt,Ot)}function Gt(jt,Ot,Wt,Pn){return Ot===null||Ot.tag!==4||Ot.stateNode.containerInfo!==Wt.containerInfo||Ot.stateNode.implementation!==Wt.implementation?(Ot=Ny(Wt,jt.mode,Pn),Ot.return=jt,Ot):(Ot=H(Ot,Wt.children||[]),Ot.return=jt,Ot)}function Sn(jt,Ot,Wt,Pn,_r){return Ot===null||Ot.tag!==7?(Ot=Ii(Wt,jt.mode,Pn,_r),Ot.return=jt,Ot):(Ot=H(Ot,Wt),Ot.return=jt,Ot)}function In(jt,Ot,Wt){if(typeof Ot=="string"&&Ot!==""||typeof Ot=="number"||typeof Ot=="bigint")return Ot=Ly(""+Ot,jt.mode,Wt),Ot.return=jt,Ot;if(typeof Ot=="object"&&Ot!==null){switch(Ot.$$typeof){case N:return Wt=Rp(Ot.type,Ot.key,Ot.props,null,jt.mode,Wt),ec(Wt,Ot),Wt.return=jt,Wt;case $:return Ot=Ny(Ot,jt.mode,Wt),Ot.return=jt,Ot;case ve:var Pn=Ot._init;return Ot=Pn(Ot._payload),In(jt,Ot,Wt)}if(ht(Ot)||tt(Ot))return Ot=Ii(Ot,jt.mode,Wt,null),Ot.return=jt,Ot;if(typeof Ot.then=="function")return In(jt,Is(Ot),Wt);if(Ot.$$typeof===re)return In(jt,Kc(jt,Ot),Wt);ju(jt,Ot)}return null}function sn(jt,Ot,Wt,Pn){var _r=Ot!==null?Ot.key:null;if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number"||typeof Wt=="bigint")return _r!==null?null:Be(jt,Ot,""+Wt,Pn);if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case N:return Wt.key===_r?bt(jt,Ot,Wt,Pn):null;case $:return Wt.key===_r?Gt(jt,Ot,Wt,Pn):null;case ve:return _r=Wt._init,Wt=_r(Wt._payload),sn(jt,Ot,Wt,Pn)}if(ht(Wt)||tt(Wt))return _r!==null?null:Sn(jt,Ot,Wt,Pn,null);if(typeof Wt.then=="function")return sn(jt,Ot,Is(Wt),Pn);if(Wt.$$typeof===re)return sn(jt,Ot,Kc(jt,Wt),Pn);ju(jt,Wt)}return null}function dn(jt,Ot,Wt,Pn,_r){if(typeof Pn=="string"&&Pn!==""||typeof Pn=="number"||typeof Pn=="bigint")return jt=jt.get(Wt)||null,Be(Ot,jt,""+Pn,_r);if(typeof Pn=="object"&&Pn!==null){switch(Pn.$$typeof){case N:return jt=jt.get(Pn.key===null?Wt:Pn.key)||null,bt(Ot,jt,Pn,_r);case $:return jt=jt.get(Pn.key===null?Wt:Pn.key)||null,Gt(Ot,jt,Pn,_r);case ve:var Vi=Pn._init;return Pn=Vi(Pn._payload),dn(jt,Ot,Wt,Pn,_r)}if(ht(Pn)||tt(Pn))return jt=jt.get(Wt)||null,Sn(Ot,jt,Pn,_r,null);if(typeof Pn.then=="function")return dn(jt,Ot,Wt,Is(Pn),_r);if(Pn.$$typeof===re)return dn(jt,Ot,Wt,Kc(Ot,Pn),_r);ju(Ot,Pn)}return null}function _i(jt,Ot,Wt,Pn){for(var _r=null,Vi=null,Br=Ot,ui=Ot=0,ws=null;Br!==null&&ui<Wt.length;ui++){Br.index>ui?(ws=Br,Br=null):ws=Br.sibling;var Ea=sn(jt,Br,Wt[ui],Pn);if(Ea===null){Br===null&&(Br=ws);break}f&&Br&&Ea.alternate===null&&v(jt,Br),Ot=te(Ea,Ot,ui),Vi===null?_r=Ea:Vi.sibling=Ea,Vi=Ea,Br=ws}if(ui===Wt.length)return A(jt,Br),pa&&Tu(jt,ui),_r;if(Br===null){for(;ui<Wt.length;ui++)Br=In(jt,Wt[ui],Pn),Br!==null&&(Ot=te(Br,Ot,ui),Vi===null?_r=Br:Vi.sibling=Br,Vi=Br);return pa&&Tu(jt,ui),_r}for(Br=k(Br);ui<Wt.length;ui++)ws=dn(Br,jt,ui,Wt[ui],Pn),ws!==null&&(f&&ws.alternate!==null&&Br.delete(ws.key===null?ui:ws.key),Ot=te(ws,Ot,ui),Vi===null?_r=ws:Vi.sibling=ws,Vi=ws);return f&&Br.forEach(function(Xu){return v(jt,Xu)}),pa&&Tu(jt,ui),_r}function Kr(jt,Ot,Wt,Pn){if(Wt==null)throw Error(i(151));for(var _r=null,Vi=null,Br=Ot,ui=Ot=0,ws=null,Ea=Wt.next();Br!==null&&!Ea.done;ui++,Ea=Wt.next()){Br.index>ui?(ws=Br,Br=null):ws=Br.sibling;var Xu=sn(jt,Br,Ea.value,Pn);if(Xu===null){Br===null&&(Br=ws);break}f&&Br&&Xu.alternate===null&&v(jt,Br),Ot=te(Xu,Ot,ui),Vi===null?_r=Xu:Vi.sibling=Xu,Vi=Xu,Br=ws}if(Ea.done)return A(jt,Br),pa&&Tu(jt,ui),_r;if(Br===null){for(;!Ea.done;ui++,Ea=Wt.next())Ea=In(jt,Ea.value,Pn),Ea!==null&&(Ot=te(Ea,Ot,ui),Vi===null?_r=Ea:Vi.sibling=Ea,Vi=Ea);return pa&&Tu(jt,ui),_r}for(Br=k(Br);!Ea.done;ui++,Ea=Wt.next())Ea=dn(Br,jt,ui,Ea.value,Pn),Ea!==null&&(f&&Ea.alternate!==null&&Br.delete(Ea.key===null?ui:Ea.key),Ot=te(Ea,Ot,ui),Vi===null?_r=Ea:Vi.sibling=Ea,Vi=Ea);return f&&Br.forEach(function(DC){return v(jt,DC)}),pa&&Tu(jt,ui),_r}function La(jt,Ot,Wt,Pn){if(typeof Wt=="object"&&Wt!==null&&Wt.type===G&&Wt.key===null&&(Wt=Wt.props.children),typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case N:e:{for(var _r=Wt.key;Ot!==null;){if(Ot.key===_r){if(_r=Wt.type,_r===G){if(Ot.tag===7){A(jt,Ot.sibling),Pn=H(Ot,Wt.props.children),Pn.return=jt,jt=Pn;break e}}else if(Ot.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===ve&&em(_r)===Ot.type){A(jt,Ot.sibling),Pn=H(Ot,Wt.props),ec(Pn,Wt),Pn.return=jt,jt=Pn;break e}A(jt,Ot);break}else v(jt,Ot);Ot=Ot.sibling}Wt.type===G?(Pn=Ii(Wt.props.children,jt.mode,Pn,Wt.key),Pn.return=jt,jt=Pn):(Pn=Rp(Wt.type,Wt.key,Wt.props,null,jt.mode,Pn),ec(Pn,Wt),Pn.return=jt,jt=Pn)}return Se(jt);case $:e:{for(_r=Wt.key;Ot!==null;){if(Ot.key===_r)if(Ot.tag===4&&Ot.stateNode.containerInfo===Wt.containerInfo&&Ot.stateNode.implementation===Wt.implementation){A(jt,Ot.sibling),Pn=H(Ot,Wt.children||[]),Pn.return=jt,jt=Pn;break e}else{A(jt,Ot);break}else v(jt,Ot);Ot=Ot.sibling}Pn=Ny(Wt,jt.mode,Pn),Pn.return=jt,jt=Pn}return Se(jt);case ve:return _r=Wt._init,Wt=_r(Wt._payload),La(jt,Ot,Wt,Pn)}if(ht(Wt))return _i(jt,Ot,Wt,Pn);if(tt(Wt)){if(_r=tt(Wt),typeof _r!="function")throw Error(i(150));return Wt=_r.call(Wt),Kr(jt,Ot,Wt,Pn)}if(typeof Wt.then=="function")return La(jt,Ot,Is(Wt),Pn);if(Wt.$$typeof===re)return La(jt,Ot,Kc(jt,Wt),Pn);ju(jt,Wt)}return typeof Wt=="string"&&Wt!==""||typeof Wt=="number"||typeof Wt=="bigint"?(Wt=""+Wt,Ot!==null&&Ot.tag===6?(A(jt,Ot.sibling),Pn=H(Ot,Wt),Pn.return=jt,jt=Pn):(A(jt,Ot),Pn=Ly(Wt,jt.mode,Pn),Pn.return=jt,jt=Pn),Se(jt)):A(jt,Ot)}return function(jt,Ot,Wt,Pn){try{Lh=0;var _r=La(jt,Ot,Wt,Pn);return zu=null,_r}catch(Br){if(Br===xf||Br===cg)throw Br;var Vi=Il(29,Br,null,jt.mode);return Vi.lanes=Pn,Vi.return=jt,Vi}finally{}}}var Ec=tm(!0),Bu=tm(!1),ml=vt(null),Qo=null;function nu(f){var v=f.alternate;gt(Zr,Zr.current&1),gt(ml,f),Qo===null&&(v===null||Ou.current!==null||v.memoizedState!==null)&&(Qo=f)}function nm(f){if(f.tag===22){if(gt(Zr,Zr.current),gt(ml,f),Qo===null){var v=f.alternate;v!==null&&v.memoizedState!==null&&(Qo=f)}}else Dl()}function Dl(){gt(Zr,Zr.current),gt(ml,ml.current)}function gl(f){nt(ml),Qo===f&&(Qo=null),nt(Zr)}var Zr=vt(0);function Fu(f){for(var v=f;v!==null;){if(v.tag===13){var A=v.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||p_(A)))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if((v.flags&128)!==0)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}function rm(f,v,A,k){v=f.memoizedState,A=A(k,v),A=A==null?v:M({},v,A),f.memoizedState=A,f.lanes===0&&(f.updateQueue.baseState=A)}var im={enqueueSetState:function(f,v,A){f=f._reactInternals;var k=po(),H=xc(k);H.payload=v,A!=null&&(H.callback=A),v=Zs(f,H,k),v!==null&&(qa(v,f,k),yd(v,f,k))},enqueueReplaceState:function(f,v,A){f=f._reactInternals;var k=po(),H=xc(k);H.tag=1,H.payload=v,A!=null&&(H.callback=A),v=Zs(f,H,k),v!==null&&(qa(v,f,k),yd(v,f,k))},enqueueForceUpdate:function(f,v){f=f._reactInternals;var A=po(),k=xc(A);k.tag=2,v!=null&&(k.callback=v),v=Zs(f,k,A),v!==null&&(qa(v,f,A),yd(v,f,A))}};function Nh(f,v,A,k,H,te,Se){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(k,te,Se):v.prototype&&v.prototype.isPureReactComponent?!Hl(A,k)||!Hl(H,te):!0}function wg(f,v,A,k){f=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(A,k),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(A,k),v.state!==f&&im.enqueueReplaceState(v,v.state,null)}function Ac(f,v){var A=v;if("ref"in v){A={};for(var k in v)k!=="ref"&&(A[k]=v[k])}if(f=f.defaultProps){A===v&&(A=M({},A));for(var H in f)A[H]===void 0&&(A[H]=f[H])}return A}var Df=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var v=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(v))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)};function Vu(f){Df(f)}function Sg(f){console.error(f)}function Tg(f){Df(f)}function Ed(f,v){try{var A=f.onUncaughtError;A(v.value,{componentStack:v.stack})}catch(k){setTimeout(function(){throw k})}}function Ad(f,v,A){try{var k=f.onCaughtError;k(A.value,{componentStack:A.stack,errorBoundary:v.tag===1?v.stateNode:null})}catch(H){setTimeout(function(){throw H})}}function am(f,v,A){return A=xc(A),A.tag=3,A.payload={element:null},A.callback=function(){Ed(f,v)},A}function om(f){return f=xc(f),f.tag=3,f}function Eg(f,v,A,k){var H=A.type.getDerivedStateFromError;if(typeof H=="function"){var te=k.value;f.payload=function(){return H(te)},f.callback=function(){Ad(v,A,k)}}var Se=A.stateNode;Se!==null&&typeof Se.componentDidCatch=="function"&&(f.callback=function(){Ad(v,A,k),typeof H!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var Be=k.stack;this.componentDidCatch(k.value,{componentStack:Be!==null?Be:""})})}function vv(f,v,A,k,H){if(A.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){if(v=A.alternate,v!==null&&dd(v,A,H,!0),A=ml.current,A!==null){switch(A.tag){case 13:return Qo===null?Js():A.alternate===null&&Zn===0&&(Zn=3),A.flags&=-257,A.flags|=65536,A.lanes=H,k===Fy?A.flags|=16384:(v=A.updateQueue,v===null?A.updateQueue=new Set([k]):v.add(k),iu(f,k,H)),!1;case 22:return A.flags|=65536,k===Fy?A.flags|=16384:(v=A.updateQueue,v===null?(v={transitions:null,markerInstances:null,retryQueue:new Set([k])},A.updateQueue=v):(A=v.retryQueue,A===null?v.retryQueue=new Set([k]):A.add(k)),iu(f,k,H)),!1}throw Error(i(435,A.tag))}return iu(f,k,H),Js(),!1}if(pa)return v=ml.current,v!==null?((v.flags&65536)===0&&(v.flags|=256),v.flags|=65536,v.lanes=H,k!==Eh&&(f=Error(i(422),{cause:k}),gf(nn(f,A)))):(k!==Eh&&(v=Error(i(423),{cause:k}),gf(nn(v,A))),f=f.current.alternate,f.flags|=65536,H&=-H,f.lanes|=H,k=nn(k,A),H=am(f.stateNode,k,H),Qc(f,H),Zn!==4&&(Zn=2)),!1;var te=Error(i(520),{cause:k});if(te=nn(te,A),wi===null?wi=[te]:wi.push(te),Zn!==4&&(Zn=2),v===null)return!0;k=nn(k,A),A=v;do{switch(A.tag){case 3:return A.flags|=65536,f=H&-H,A.lanes|=f,f=am(A.stateNode,k,f),Qc(A,f),!1;case 1:if(v=A.type,te=A.stateNode,(A.flags&128)===0&&(typeof v.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(oi===null||!oi.has(te))))return A.flags|=65536,H&=-H,A.lanes|=H,H=om(H),Eg(H,f,A,k),Qc(A,H),!1}A=A.return}while(A!==null);return!1}var sm=Error(i(461)),To=!1;function es(f,v,A,k){v.child=f===null?Bu(v,null,A,k):Ec(v,f.child,A,k)}function Jy(f,v,A,k,H){A=A.render;var te=v.ref;if("ref"in k){var Se={};for(var Be in k)Be!=="ref"&&(Se[Be]=k[Be])}else Se=k;return Yc(v),k=qp(f,v,A,Se,te,H),Be=Tf(),f!==null&&!To?(vd(f,v,H),Bo(f,v,H)):(pa&&Be&&Th(v),v.flags|=1,es(f,v,k,H),v.child)}function Ag(f,v,A,k,H){if(f===null){var te=A.type;return typeof te=="function"&&!Op(te)&&te.defaultProps===void 0&&A.compare===null?(v.tag=15,v.type=te,Qy(f,v,te,k,H)):(f=Rp(A.type,null,k,v,v.mode,H),f.ref=v.ref,f.return=v,v.child=f)}if(te=f.child,!Lf(f,H)){var Se=te.memoizedProps;if(A=A.compare,A=A!==null?A:Hl,A(Se,k)&&f.ref===v.ref)return Bo(f,v,H)}return v.flags|=1,f=Su(te,k),f.ref=v.ref,f.return=v,v.child=f}function Qy(f,v,A,k,H){if(f!==null){var te=f.memoizedProps;if(Hl(te,k)&&f.ref===v.ref)if(To=!1,v.pendingProps=k=te,Lf(f,H))(f.flags&131072)!==0&&(To=!0);else return v.lanes=f.lanes,Bo(f,v,H)}return Cg(f,v,A,k,H)}function lm(f,v,A){var k=v.pendingProps,H=k.children,te=f!==null?f.memoizedState:null;if(k.mode==="hidden"){if((v.flags&128)!==0){if(k=te!==null?te.baseLanes|A:A,f!==null){for(H=v.child=f.child,te=0;H!==null;)te=te|H.lanes|H.childLanes,H=H.sibling;v.childLanes=te&~k}else v.childLanes=0,v.child=null;return e_(f,v,k,A)}if((A&536870912)!==0)v.memoizedState={baseLanes:0,cachePool:null},f!==null&&Bp(v,te!==null?te.cachePool:null),te!==null?fg(v,te):Ru(),nm(v);else return v.lanes=v.childLanes=536870912,e_(f,v,te!==null?te.baseLanes|A:A,A)}else te!==null?(Bp(v,te.cachePool),fg(v,te),Dl(),v.memoizedState=null):(f!==null&&Bp(v,null),Ru(),Dl());return es(f,v,H,A),v.child}function e_(f,v,A,k){var H=jp();return H=H===null?null:{parent:sa._currentValue,pool:H},v.memoizedState={baseLanes:A,cachePool:H},f!==null&&Bp(v,null),Ru(),nm(v),f!==null&&dd(f,v,k,!0),null}function cm(f,v){var A=v.ref;if(A===null)f!==null&&f.ref!==null&&(v.flags|=4194816);else{if(typeof A!="function"&&typeof A!="object")throw Error(i(284));(f===null||f.ref!==A)&&(v.flags|=4194816)}}function Cg(f,v,A,k,H){return Yc(v),A=qp(f,v,A,k,void 0,H),k=Tf(),f!==null&&!To?(vd(f,v,H),Bo(f,v,H)):(pa&&k&&Th(v),v.flags|=1,es(f,v,A,H),v.child)}function t_(f,v,A,k,H,te){return Yc(v),v.updateQueue=null,A=Sf(v,k,A,H),Du(f),k=Tf(),f!==null&&!To?(vd(f,v,te),Bo(f,v,te)):(pa&&k&&Th(v),v.flags|=1,es(f,v,A,te),v.child)}function n_(f,v,A,k,H){if(Yc(v),v.stateNode===null){var te=Os,Se=A.contextType;typeof Se=="object"&&Se!==null&&(te=hs(Se)),te=new A(k,te),v.memoizedState=te.state!==null&&te.state!==void 0?te.state:null,te.updater=im,v.stateNode=te,te._reactInternals=v,te=v.stateNode,te.props=k,te.state=v.memoizedState,te.refs={},hg(v),Se=A.contextType,te.context=typeof Se=="object"&&Se!==null?hs(Se):Os,te.state=v.memoizedState,Se=A.getDerivedStateFromProps,typeof Se=="function"&&(rm(v,A,Se,k),te.state=v.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof te.getSnapshotBeforeUpdate=="function"||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(Se=te.state,typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount(),Se!==te.state&&im.enqueueReplaceState(te,te.state,null),bf(v,k,te,H),Rh(),te.state=v.memoizedState),typeof te.componentDidMount=="function"&&(v.flags|=4194308),k=!0}else if(f===null){te=v.stateNode;var Be=v.memoizedProps,bt=Ac(A,Be);te.props=bt;var Gt=te.context,Sn=A.contextType;Se=Os,typeof Sn=="object"&&Sn!==null&&(Se=hs(Sn));var In=A.getDerivedStateFromProps;Sn=typeof In=="function"||typeof te.getSnapshotBeforeUpdate=="function",Be=v.pendingProps!==Be,Sn||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(Be||Gt!==Se)&&wg(v,te,k,Se),Jc=!1;var sn=v.memoizedState;te.state=sn,bf(v,k,te,H),Rh(),Gt=v.memoizedState,Be||sn!==Gt||Jc?(typeof In=="function"&&(rm(v,A,In,k),Gt=v.memoizedState),(bt=Jc||Nh(v,A,bt,k,sn,Gt,Se))?(Sn||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount()),typeof te.componentDidMount=="function"&&(v.flags|=4194308)):(typeof te.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=k,v.memoizedState=Gt),te.props=k,te.state=Gt,te.context=Se,k=bt):(typeof te.componentDidMount=="function"&&(v.flags|=4194308),k=!1)}else{te=v.stateNode,dg(f,v),Se=v.memoizedProps,Sn=Ac(A,Se),te.props=Sn,In=v.pendingProps,sn=te.context,Gt=A.contextType,bt=Os,typeof Gt=="object"&&Gt!==null&&(bt=hs(Gt)),Be=A.getDerivedStateFromProps,(Gt=typeof Be=="function"||typeof te.getSnapshotBeforeUpdate=="function")||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(Se!==In||sn!==bt)&&wg(v,te,k,bt),Jc=!1,sn=v.memoizedState,te.state=sn,bf(v,k,te,H),Rh();var dn=v.memoizedState;Se!==In||sn!==dn||Jc||f!==null&&f.dependencies!==null&&yf(f.dependencies)?(typeof Be=="function"&&(rm(v,A,Be,k),dn=v.memoizedState),(Sn=Jc||Nh(v,A,Sn,k,sn,dn,bt)||f!==null&&f.dependencies!==null&&yf(f.dependencies))?(Gt||typeof te.UNSAFE_componentWillUpdate!="function"&&typeof te.componentWillUpdate!="function"||(typeof te.componentWillUpdate=="function"&&te.componentWillUpdate(k,dn,bt),typeof te.UNSAFE_componentWillUpdate=="function"&&te.UNSAFE_componentWillUpdate(k,dn,bt)),typeof te.componentDidUpdate=="function"&&(v.flags|=4),typeof te.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof te.componentDidUpdate!="function"||Se===f.memoizedProps&&sn===f.memoizedState||(v.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||Se===f.memoizedProps&&sn===f.memoizedState||(v.flags|=1024),v.memoizedProps=k,v.memoizedState=dn),te.props=k,te.state=dn,te.context=bt,k=Sn):(typeof te.componentDidUpdate!="function"||Se===f.memoizedProps&&sn===f.memoizedState||(v.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||Se===f.memoizedProps&&sn===f.memoizedState||(v.flags|=1024),k=!1)}return te=k,cm(f,v),k=(v.flags&128)!==0,te||k?(te=v.stateNode,A=k&&typeof A.getDerivedStateFromError!="function"?null:te.render(),v.flags|=1,f!==null&&k?(v.child=Ec(v,f.child,null,H),v.child=Ec(v,null,A,H)):es(f,v,A,H),v.memoizedState=te.state,f=v.child):f=Bo(f,v,H),f}function xv(f,v,A,k){return Au(),v.flags|=256,es(f,v,A,k),v.child}var r_={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ki(f){return{baseLanes:f,cachePool:fd()}}function Mg(f,v,A){return f=f!==null?f.childLanes&~A:0,v&&(f|=kr),f}function bv(f,v,A){var k=v.pendingProps,H=!1,te=(v.flags&128)!==0,Se;if((Se=te)||(Se=f!==null&&f.memoizedState===null?!1:(Zr.current&2)!==0),Se&&(H=!0,v.flags&=-129),Se=(v.flags&32)!==0,v.flags&=-33,f===null){if(pa){if(H?nu(v):Dl(),pa){var Be=ja,bt;if(bt=Be){e:{for(bt=Be,Be=vc;bt.nodeType!==8;){if(!Be){Be=null;break e}if(bt=Hu(bt.nextSibling),bt===null){Be=null;break e}}Be=bt}Be!==null?(v.memoizedState={dehydrated:Be,treeContext:wh!==null?{id:_c,overflow:Xl}:null,retryLane:536870912,hydrationErrors:null},bt=Il(18,null,null,0),bt.stateNode=Be,bt.return=v,v.child=bt,us=v,ja=null,bt=!0):bt=!1}bt||Wc(v)}if(Be=v.memoizedState,Be!==null&&(Be=Be.dehydrated,Be!==null))return p_(Be)?v.lanes=32:v.lanes=536870912,null;gl(v)}return Be=k.children,k=k.fallback,H?(Dl(),H=v.mode,Be=Pg({mode:"hidden",children:Be},H),k=Ii(k,H,A,null),Be.return=v,k.return=v,Be.sibling=k,v.child=Be,H=v.child,H.memoizedState=Ki(A),H.childLanes=Mg(f,Se,A),v.memoizedState=r_,k):(nu(v),um(v,Be))}if(bt=f.memoizedState,bt!==null&&(Be=bt.dehydrated,Be!==null)){if(te)v.flags&256?(nu(v),v.flags&=-257,v=Cd(f,v,A)):v.memoizedState!==null?(Dl(),v.child=f.child,v.flags|=128,v=null):(Dl(),H=k.fallback,Be=v.mode,k=Pg({mode:"visible",children:k.children},Be),H=Ii(H,Be,A,null),H.flags|=2,k.return=v,H.return=v,k.sibling=H,v.child=k,Ec(v,f.child,null,A),k=v.child,k.memoizedState=Ki(A),k.childLanes=Mg(f,Se,A),v.memoizedState=r_,v=H);else if(nu(v),p_(Be)){if(Se=Be.nextSibling&&Be.nextSibling.dataset,Se)var Gt=Se.dgst;Se=Gt,k=Error(i(419)),k.stack="",k.digest=Se,gf({value:k,source:null,stack:null}),v=Cd(f,v,A)}else if(To||dd(f,v,A,!1),Se=(A&f.childLanes)!==0,To||Se){if(Se=Nt,Se!==null&&(k=A&-A,k=(k&42)!==0?1:Dr(k),k=(k&(Se.suspendedLanes|A))!==0?0:k,k!==0&&k!==bt.retryLane))throw bt.retryLane=k,bu(f,k),qa(Se,f,k),sm;Be.data==="$?"||Js(),v=Cd(f,v,A)}else Be.data==="$?"?(v.flags|=192,v.child=f.child,v=null):(f=bt.treeContext,ja=Hu(Be.nextSibling),us=v,pa=!0,Eu=null,vc=!1,f!==null&&(Xs[Wl++]=_c,Xs[Wl++]=Xl,Xs[Wl++]=wh,_c=f.id,Xl=f.overflow,wh=v),v=um(v,k.children),v.flags|=4096);return v}return H?(Dl(),H=k.fallback,Be=v.mode,bt=f.child,Gt=bt.sibling,k=Su(bt,{mode:"hidden",children:k.children}),k.subtreeFlags=bt.subtreeFlags&65011712,Gt!==null?H=Su(Gt,H):(H=Ii(H,Be,A,null),H.flags|=2),H.return=v,k.return=v,k.sibling=H,v.child=k,k=H,H=v.child,Be=f.child.memoizedState,Be===null?Be=Ki(A):(bt=Be.cachePool,bt!==null?(Gt=sa._currentValue,bt=bt.parent!==Gt?{parent:Gt,pool:Gt}:bt):bt=fd(),Be={baseLanes:Be.baseLanes|A,cachePool:bt}),H.memoizedState=Be,H.childLanes=Mg(f,Se,A),v.memoizedState=r_,k):(nu(v),A=f.child,f=A.sibling,A=Su(A,{mode:"visible",children:k.children}),A.return=v,A.sibling=null,f!==null&&(Se=v.deletions,Se===null?(v.deletions=[f],v.flags|=16):Se.push(f)),v.child=A,v.memoizedState=null,A)}function um(f,v){return v=Pg({mode:"visible",children:v},f.mode),v.return=f,f.child=v}function Pg(f,v){return f=Il(22,f,null,v),f.lanes=0,f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},f}function Cd(f,v,A){return Ec(v,f.child,null,A),f=um(v,v.pendingProps.children),f.flags|=2,v.memoizedState=null,f}function kf(f,v,A){f.lanes|=v;var k=f.alternate;k!==null&&(k.lanes|=v),ag(f.return,v,A)}function hm(f,v,A,k,H){var te=f.memoizedState;te===null?f.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:k,tail:A,tailMode:H}:(te.isBackwards=v,te.rendering=null,te.renderingStartTime=0,te.last=k,te.tail=A,te.tailMode=H)}function dm(f,v,A){var k=v.pendingProps,H=k.revealOrder,te=k.tail;if(es(f,v,k.children,A),k=Zr.current,(k&2)!==0)k=k&1|2,v.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=v.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&kf(f,A,v);else if(f.tag===19)kf(f,A,v);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===v)break e;for(;f.sibling===null;){if(f.return===null||f.return===v)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}k&=1}switch(gt(Zr,k),H){case"forwards":for(A=v.child,H=null;A!==null;)f=A.alternate,f!==null&&Fu(f)===null&&(H=A),A=A.sibling;A=H,A===null?(H=v.child,v.child=null):(H=A.sibling,A.sibling=null),hm(v,!1,H,A,te);break;case"backwards":for(A=null,H=v.child,v.child=null;H!==null;){if(f=H.alternate,f!==null&&Fu(f)===null){v.child=H;break}f=H.sibling,H.sibling=A,A=H,H=f}hm(v,!0,A,null,te);break;case"together":hm(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function Bo(f,v,A){if(f!==null&&(v.dependencies=f.dependencies),pr|=v.lanes,(A&v.childLanes)===0)if(f!==null){if(dd(f,v,A,!1),(A&v.childLanes)===0)return null}else return null;if(f!==null&&v.child!==f.child)throw Error(i(153));if(v.child!==null){for(f=v.child,A=Su(f,f.pendingProps),v.child=A,A.return=v;f.sibling!==null;)f=f.sibling,A=A.sibling=Su(f,f.pendingProps),A.return=v;A.sibling=null}return v.child}function Lf(f,v){return(f.lanes&v)!==0?!0:(f=f.dependencies,!!(f!==null&&yf(f)))}function Ba(f,v,A){switch(v.tag){case 3:mn(v,v.stateNode.containerInfo),Zc(v,sa,f.memoizedState.cache),Au();break;case 27:case 5:En(v);break;case 4:mn(v,v.stateNode.containerInfo);break;case 10:Zc(v,v.type,v.memoizedProps.value);break;case 13:var k=v.memoizedState;if(k!==null)return k.dehydrated!==null?(nu(v),v.flags|=128,null):(A&v.child.childLanes)!==0?bv(f,v,A):(nu(v),f=Bo(f,v,A),f!==null?f.sibling:null);nu(v);break;case 19:var H=(f.flags&128)!==0;if(k=(A&v.childLanes)!==0,k||(dd(f,v,A,!1),k=(A&v.childLanes)!==0),H){if(k)return dm(f,v,A);v.flags|=128}if(H=v.memoizedState,H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),gt(Zr,Zr.current),k)break;return null;case 22:case 23:return v.lanes=0,lm(f,v,A);case 24:Zc(v,sa,f.memoizedState.cache)}return Bo(f,v,A)}function Cc(f,v,A){if(f!==null)if(f.memoizedProps!==v.pendingProps)To=!0;else{if(!Lf(f,A)&&(v.flags&128)===0)return To=!1,Ba(f,v,A);To=(f.flags&131072)!==0}else To=!1,pa&&(v.flags&1048576)!==0&&Sh(v,ng,v.index);switch(v.lanes=0,v.tag){case 16:e:{f=v.pendingProps;var k=v.elementType,H=k._init;if(k=H(k._payload),v.type=k,typeof k=="function")Op(k)?(f=Ac(k,f),v.tag=1,v=n_(null,v,k,f,A)):(v.tag=0,v=Cg(null,v,k,f,A));else{if(k!=null){if(H=k.$$typeof,H===fe){v.tag=11,v=Jy(null,v,k,f,A);break e}else if(H===me){v.tag=14,v=Ag(null,v,k,f,A);break e}}throw v=ct(k)||k,Error(i(306,v,""))}}return v;case 0:return Cg(f,v,v.type,v.pendingProps,A);case 1:return k=v.type,H=Ac(k,v.pendingProps),n_(f,v,k,H,A);case 3:e:{if(mn(v,v.stateNode.containerInfo),f===null)throw Error(i(387));k=v.pendingProps;var te=v.memoizedState;H=te.element,dg(f,v),bf(v,k,null,A);var Se=v.memoizedState;if(k=Se.cache,Zc(v,sa,k),k!==te.cache&&kp(v,[sa],A,!0),Rh(),k=Se.element,te.isDehydrated)if(te={element:k,isDehydrated:!1,cache:Se.cache},v.updateQueue.baseState=te,v.memoizedState=te,v.flags&256){v=xv(f,v,k,A);break e}else if(k!==H){H=nn(Error(i(424)),v),gf(H),v=xv(f,v,k,A);break e}else{switch(f=v.stateNode.containerInfo,f.nodeType){case 9:f=f.body;break;default:f=f.nodeName==="HTML"?f.ownerDocument.body:f}for(ja=Hu(f.firstChild),us=v,pa=!0,Eu=null,vc=!0,A=Bu(v,null,k,A),v.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling}else{if(Au(),k===H){v=Bo(f,v,A);break e}es(f,v,k,A)}v=v.child}return v;case 26:return cm(f,v),f===null?(A=ub(v.type,null,v.pendingProps,null))?v.memoizedState=A:pa||(A=v.type,f=v.pendingProps,k=Ov(qt.current).createElement(A),k[he]=v,k[ye]=f,Qs(k,A,f),Hn(k),v.stateNode=k):v.memoizedState=ub(v.type,f.memoizedProps,v.pendingProps,f.memoizedState),null;case 27:return En(v),f===null&&pa&&(k=v.stateNode=zv(v.type,v.pendingProps,qt.current),us=v,vc=!0,H=ja,qu(v.type)?(Lv=H,ja=Hu(k.firstChild)):ja=H),es(f,v,v.pendingProps.children,A),cm(f,v),f===null&&(v.flags|=4194304),v.child;case 5:return f===null&&pa&&((H=k=ja)&&(k=PS(k,v.type,v.pendingProps,vc),k!==null?(v.stateNode=k,us=v,ja=Hu(k.firstChild),vc=!1,H=!0):H=!1),H||Wc(v)),En(v),H=v.type,te=v.pendingProps,Se=f!==null?f.memoizedProps:null,k=te.children,ob(H,te)?k=null:Se!==null&&ob(H,Se)&&(v.flags|=32),v.memoizedState!==null&&(H=qp(f,v,Rn,null,null,A),ym._currentValue=H),cm(f,v),es(f,v,k,A),v.child;case 6:return f===null&&pa&&((f=A=ja)&&(A=f_(A,v.pendingProps,vc),A!==null?(v.stateNode=A,us=v,ja=null,f=!0):f=!1),f||Wc(v)),null;case 13:return bv(f,v,A);case 4:return mn(v,v.stateNode.containerInfo),k=v.pendingProps,f===null?v.child=Ec(v,null,k,A):es(f,v,k,A),v.child;case 11:return Jy(f,v,v.type,v.pendingProps,A);case 7:return es(f,v,v.pendingProps,A),v.child;case 8:return es(f,v,v.pendingProps.children,A),v.child;case 12:return es(f,v,v.pendingProps.children,A),v.child;case 10:return k=v.pendingProps,Zc(v,v.type,k.value),es(f,v,k.children,A),v.child;case 9:return H=v.type._context,k=v.pendingProps.children,Yc(v),H=hs(H),k=k(H),v.flags|=1,es(f,v,k,A),v.child;case 14:return Ag(f,v,v.type,v.pendingProps,A);case 15:return Qy(f,v,v.type,v.pendingProps,A);case 19:return dm(f,v,A);case 31:return k=v.pendingProps,A=v.mode,k={mode:k.mode,children:k.children},f===null?(A=Pg(k,A),A.ref=v.ref,v.child=A,A.return=v,v=A):(A=Su(f.child,k),A.ref=v.ref,v.child=A,A.return=v,v=A),v;case 22:return lm(f,v,A);case 24:return Yc(v),k=hs(sa),f===null?(H=jp(),H===null&&(H=Nt,te=Np(),H.pooledCache=te,te.refCount++,te!==null&&(H.pooledCacheLanes|=A),H=te),v.memoizedState={parent:k,cache:H},hg(v),Zc(v,sa,H)):((f.lanes&A)!==0&&(dg(f,v),bf(v,null,null,A),Rh()),H=f.memoizedState,te=v.memoizedState,H.parent!==k?(H={parent:k,cache:k},v.memoizedState=H,v.lanes===0&&(v.memoizedState=v.updateQueue.baseState=H),Zc(v,sa,k)):(k=te.cache,Zc(v,sa,k),k!==H.cache&&kp(v,[sa],A,!0))),es(f,v,v.pendingProps.children,A),v.child;case 29:throw v.pendingProps}throw Error(i(156,v.tag))}function yl(f){f.flags|=4}function Nf(f,v){if(v.type!=="stylesheet"||(v.state.loading&4)!==0)f.flags&=-16777217;else if(f.flags|=16777216,!y_(v)){if(v=ml.current,v!==null&&((Ft&4194048)===Ft?Qo!==null:(Ft&62914560)!==Ft&&(Ft&536870912)===0||v!==Qo))throw md=Fy,By;f.flags|=8192}}function zf(f,v){v!==null&&(f.flags|=4),f.flags&16384&&(v=f.tag!==22?ci():536870912,f.lanes|=v,Yr|=v)}function jf(f,v){if(!pa)switch(f.tailMode){case"hidden":v=f.tail;for(var A=null;v!==null;)v.alternate!==null&&(A=v),v=v.sibling;A===null?f.tail=null:A.sibling=null;break;case"collapsed":A=f.tail;for(var k=null;A!==null;)A.alternate!==null&&(k=A),A=A.sibling;k===null?v||f.tail===null?f.tail=null:f.tail.sibling=null:k.sibling=null}}function Fa(f){var v=f.alternate!==null&&f.alternate.child===f.child,A=0,k=0;if(v)for(var H=f.child;H!==null;)A|=H.lanes|H.childLanes,k|=H.subtreeFlags&65011712,k|=H.flags&65011712,H.return=f,H=H.sibling;else for(H=f.child;H!==null;)A|=H.lanes|H.childLanes,k|=H.subtreeFlags,k|=H.flags,H.return=f,H=H.sibling;return f.subtreeFlags|=k,f.childLanes=A,v}function q0(f,v,A){var k=v.pendingProps;switch(mf(v),v.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fa(v),null;case 1:return Fa(v),null;case 3:return A=v.stateNode,k=null,f!==null&&(k=f.memoizedState.cache),v.memoizedState.cache!==k&&(v.flags|=2048),Cu(sa),en(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(f===null||f.child===null)&&(Ah(v)?yl(v):f===null||f.memoizedState.isDehydrated&&(v.flags&256)===0||(v.flags|=1024,zy())),Fa(v),null;case 26:return A=v.memoizedState,f===null?(yl(v),A!==null?(Fa(v),Nf(v,A)):(Fa(v),v.flags&=-16777217)):A?A!==f.memoizedState?(yl(v),Fa(v),Nf(v,A)):(Fa(v),v.flags&=-16777217):(f.memoizedProps!==k&&yl(v),Fa(v),v.flags&=-16777217),null;case 27:Xn(v),A=qt.current;var H=v.type;if(f!==null&&v.stateNode!=null)f.memoizedProps!==k&&yl(v);else{if(!k){if(v.stateNode===null)throw Error(i(166));return Fa(v),null}f=Ut.current,Ah(v)?Dp(v):(f=zv(H,k,A),v.stateNode=f,yl(v))}return Fa(v),null;case 5:if(Xn(v),A=v.type,f!==null&&v.stateNode!=null)f.memoizedProps!==k&&yl(v);else{if(!k){if(v.stateNode===null)throw Error(i(166));return Fa(v),null}if(f=Ut.current,Ah(v))Dp(v);else{switch(H=Ov(qt.current),f){case 1:f=H.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:f=H.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":f=H.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":f=H.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":f=H.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof k.is=="string"?H.createElement("select",{is:k.is}):H.createElement("select"),k.multiple?f.multiple=!0:k.size&&(f.size=k.size);break;default:f=typeof k.is=="string"?H.createElement(A,{is:k.is}):H.createElement(A)}}f[he]=v,f[ye]=k;e:for(H=v.child;H!==null;){if(H.tag===5||H.tag===6)f.appendChild(H.stateNode);else if(H.tag!==4&&H.tag!==27&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===v)break e;for(;H.sibling===null;){if(H.return===null||H.return===v)break e;H=H.return}H.sibling.return=H.return,H=H.sibling}v.stateNode=f;e:switch(Qs(f,A,k),A){case"button":case"input":case"select":case"textarea":f=!!k.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&yl(v)}}return Fa(v),v.flags&=-16777217,null;case 6:if(f&&v.stateNode!=null)f.memoizedProps!==k&&yl(v);else{if(typeof k!="string"&&v.stateNode===null)throw Error(i(166));if(f=qt.current,Ah(v)){if(f=v.stateNode,A=v.memoizedProps,k=null,H=us,H!==null)switch(H.tag){case 27:case 5:k=H.memoizedProps}f[he]=v,f=!!(f.nodeValue===A||k!==null&&k.suppressHydrationWarning===!0||nb(f.nodeValue,A)),f||Wc(v)}else f=Ov(f).createTextNode(k),f[he]=v,v.stateNode=f}return Fa(v),null;case 13:if(k=v.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(H=Ah(v),k!==null&&k.dehydrated!==null){if(f===null){if(!H)throw Error(i(318));if(H=v.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(i(317));H[he]=v}else Au(),(v.flags&128)===0&&(v.memoizedState=null),v.flags|=4;Fa(v),H=!1}else H=zy(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=H),H=!0;if(!H)return v.flags&256?(gl(v),v):(gl(v),null)}if(gl(v),(v.flags&128)!==0)return v.lanes=A,v;if(A=k!==null,f=f!==null&&f.memoizedState!==null,A){k=v.child,H=null,k.alternate!==null&&k.alternate.memoizedState!==null&&k.alternate.memoizedState.cachePool!==null&&(H=k.alternate.memoizedState.cachePool.pool);var te=null;k.memoizedState!==null&&k.memoizedState.cachePool!==null&&(te=k.memoizedState.cachePool.pool),te!==H&&(k.flags|=2048)}return A!==f&&A&&(v.child.flags|=8192),zf(v,v.updateQueue),Fa(v),null;case 4:return en(),f===null&&h_(v.stateNode.containerInfo),Fa(v),null;case 10:return Cu(v.type),Fa(v),null;case 19:if(nt(Zr),H=v.memoizedState,H===null)return Fa(v),null;if(k=(v.flags&128)!==0,te=H.rendering,te===null)if(k)jf(H,!1);else{if(Zn!==0||f!==null&&(f.flags&128)!==0)for(f=v.child;f!==null;){if(te=Fu(f),te!==null){for(v.flags|=128,jf(H,!1),f=te.updateQueue,v.updateQueue=f,zf(v,f),v.subtreeFlags=0,f=A,A=v.child;A!==null;)tg(A,f),A=A.sibling;return gt(Zr,Zr.current&1|2),v.child}f=f.sibling}H.tail!==null&&hi()>ai&&(v.flags|=128,k=!0,jf(H,!1),v.lanes=4194304)}else{if(!k)if(f=Fu(te),f!==null){if(v.flags|=128,k=!0,f=f.updateQueue,v.updateQueue=f,zf(v,f),jf(H,!0),H.tail===null&&H.tailMode==="hidden"&&!te.alternate&&!pa)return Fa(v),null}else 2*hi()-H.renderingStartTime>ai&&A!==536870912&&(v.flags|=128,k=!0,jf(H,!1),v.lanes=4194304);H.isBackwards?(te.sibling=v.child,v.child=te):(f=H.last,f!==null?f.sibling=te:v.child=te,H.last=te)}return H.tail!==null?(v=H.tail,H.rendering=v,H.tail=v.sibling,H.renderingStartTime=hi(),v.sibling=null,f=Zr.current,gt(Zr,k?f&1|2:f&1),v):(Fa(v),null);case 22:case 23:return gl(v),Up(),k=v.memoizedState!==null,f!==null?f.memoizedState!==null!==k&&(v.flags|=8192):k&&(v.flags|=8192),k?(A&536870912)!==0&&(v.flags&128)===0&&(Fa(v),v.subtreeFlags&6&&(v.flags|=8192)):Fa(v),A=v.updateQueue,A!==null&&zf(v,A.retryQueue),A=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),k=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(k=v.memoizedState.cachePool.pool),k!==A&&(v.flags|=2048),f!==null&&nt(Pu),null;case 24:return A=null,f!==null&&(A=f.memoizedState.cache),v.memoizedState.cache!==A&&(v.flags|=2048),Cu(sa),Fa(v),null;case 25:return null;case 30:return null}throw Error(i(156,v.tag))}function wv(f,v){switch(mf(v),v.tag){case 1:return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 3:return Cu(sa),en(),f=v.flags,(f&65536)!==0&&(f&128)===0?(v.flags=f&-65537|128,v):null;case 26:case 27:case 5:return Xn(v),null;case 13:if(gl(v),f=v.memoizedState,f!==null&&f.dehydrated!==null){if(v.alternate===null)throw Error(i(340));Au()}return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 19:return nt(Zr),null;case 4:return en(),null;case 10:return Cu(v.type),null;case 22:case 23:return gl(v),Up(),f!==null&&nt(Pu),f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 24:return Cu(sa),null;case 25:return null;default:return null}}function Og(f,v){switch(mf(v),v.tag){case 3:Cu(sa),en();break;case 26:case 27:case 5:Xn(v);break;case 4:en();break;case 13:gl(v);break;case 19:nt(Zr);break;case 10:Cu(v.type);break;case 22:case 23:gl(v),Up(),f!==null&&nt(Pu);break;case 24:Cu(sa)}}function Md(f,v){try{var A=v.updateQueue,k=A!==null?A.lastEffect:null;if(k!==null){var H=k.next;A=H;do{if((A.tag&f)===f){k=void 0;var te=A.create,Se=A.inst;k=te(),Se.destroy=k}A=A.next}while(A!==H)}}catch(Be){Va(v,v.return,Be)}}function tc(f,v,A){try{var k=v.updateQueue,H=k!==null?k.lastEffect:null;if(H!==null){var te=H.next;k=te;do{if((k.tag&f)===f){var Se=k.inst,Be=Se.destroy;if(Be!==void 0){Se.destroy=void 0,H=v;var bt=A,Gt=Be;try{Gt()}catch(Sn){Va(H,bt,Sn)}}}k=k.next}while(k!==te)}}catch(Sn){Va(v,v.return,Sn)}}function Pd(f){var v=f.updateQueue;if(v!==null){var A=f.stateNode;try{Fp(v,A)}catch(k){Va(f,f.return,k)}}}function ru(f,v,A){A.props=Ac(f.type,f.memoizedProps),A.state=f.memoizedState;try{A.componentWillUnmount()}catch(k){Va(f,v,k)}}function Ds(f,v){try{var A=f.ref;if(A!==null){switch(f.tag){case 26:case 27:case 5:var k=f.stateNode;break;case 30:k=f.stateNode;break;default:k=f.stateNode}typeof A=="function"?f.refCleanup=A(k):A.current=k}}catch(H){Va(f,v,H)}}function Eo(f,v){var A=f.ref,k=f.refCleanup;if(A!==null)if(typeof k=="function")try{k()}catch(H){Va(f,v,H)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof A=="function")try{A(null)}catch(H){Va(f,v,H)}else A.current=null}function xs(f){var v=f.type,A=f.memoizedProps,k=f.stateNode;try{e:switch(v){case"button":case"input":case"select":case"textarea":A.autoFocus&&k.focus();break e;case"img":A.src?k.src=A.src:A.srcSet&&(k.srcset=A.srcSet)}}catch(H){Va(f,f.return,H)}}function Ks(f,v,A){try{var k=f.stateNode;OC(k,f.type,A,v),k[ye]=v}catch(H){Va(f,f.return,H)}}function Sv(f){return f.tag===5||f.tag===3||f.tag===26||f.tag===27&&qu(f.type)||f.tag===4}function i_(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Sv(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.tag===27&&qu(f.type)||f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function a_(f,v,A){var k=f.tag;if(k===5||k===6)f=f.stateNode,v?(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A).insertBefore(f,v):(v=A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,v.appendChild(f),A=A._reactRootContainer,A!=null||v.onclick!==null||(v.onclick=Bh));else if(k!==4&&(k===27&&qu(f.type)&&(A=f.stateNode,v=null),f=f.child,f!==null))for(a_(f,v,A),f=f.sibling;f!==null;)a_(f,v,A),f=f.sibling}function Rg(f,v,A){var k=f.tag;if(k===5||k===6)f=f.stateNode,v?A.insertBefore(f,v):A.appendChild(f);else if(k!==4&&(k===27&&qu(f.type)&&(A=f.stateNode),f=f.child,f!==null))for(Rg(f,v,A),f=f.sibling;f!==null;)Rg(f,v,A),f=f.sibling}function o_(f){var v=f.stateNode,A=f.memoizedProps;try{for(var k=f.type,H=v.attributes;H.length;)v.removeAttributeNode(H[0]);Qs(v,k,A),v[he]=f,v[ye]=A}catch(te){Va(f,f.return,te)}}var Za=!1,Ao=!1,g=!1,o=typeof WeakSet=="function"?WeakSet:Set,u=null;function y(f,v){if(f=f.containerInfo,ib=__,f=My(f),sf(f)){if("selectionStart"in f)var A={start:f.selectionStart,end:f.selectionEnd};else e:{A=(A=f.ownerDocument)&&A.defaultView||window;var k=A.getSelection&&A.getSelection();if(k&&k.rangeCount!==0){A=k.anchorNode;var H=k.anchorOffset,te=k.focusNode;k=k.focusOffset;try{A.nodeType,te.nodeType}catch{A=null;break e}var Se=0,Be=-1,bt=-1,Gt=0,Sn=0,In=f,sn=null;t:for(;;){for(var dn;In!==A||H!==0&&In.nodeType!==3||(Be=Se+H),In!==te||k!==0&&In.nodeType!==3||(bt=Se+k),In.nodeType===3&&(Se+=In.nodeValue.length),(dn=In.firstChild)!==null;)sn=In,In=dn;for(;;){if(In===f)break t;if(sn===A&&++Gt===H&&(Be=Se),sn===te&&++Sn===k&&(bt=Se),(dn=In.nextSibling)!==null)break;In=sn,sn=In.parentNode}In=dn}A=Be===-1||bt===-1?null:{start:Be,end:bt}}else A=null}A=A||{start:0,end:0}}else A=null;for(ab={focusedElem:f,selectionRange:A},__=!1,u=v;u!==null;)if(v=u,f=v.child,(v.subtreeFlags&1024)!==0&&f!==null)f.return=v,u=f;else for(;u!==null;){switch(v=u,te=v.alternate,f=v.flags,v.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&te!==null){f=void 0,A=v,H=te.memoizedProps,te=te.memoizedState,k=A.stateNode;try{var _i=Ac(A.type,H,A.elementType===A.type);f=k.getSnapshotBeforeUpdate(_i,te),k.__reactInternalSnapshotBeforeUpdate=f}catch(Kr){Va(A,A.return,Kr)}}break;case 3:if((f&1024)!==0){if(f=v.stateNode.containerInfo,A=f.nodeType,A===9)kv(f);else if(A===1)switch(f.nodeName){case"HEAD":case"HTML":case"BODY":kv(f);break;default:f.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(i(163))}if(f=v.sibling,f!==null){f.return=v.return,u=f;break}u=v.return}}function b(f,v,A){var k=A.flags;switch(A.tag){case 0:case 11:case 15:xe(f,A),k&4&&Md(5,A);break;case 1:if(xe(f,A),k&4)if(f=A.stateNode,v===null)try{f.componentDidMount()}catch(Se){Va(A,A.return,Se)}else{var H=Ac(A.type,v.memoizedProps);v=v.memoizedState;try{f.componentDidUpdate(H,v,f.__reactInternalSnapshotBeforeUpdate)}catch(Se){Va(A,A.return,Se)}}k&64&&Pd(A),k&512&&Ds(A,A.return);break;case 3:if(xe(f,A),k&64&&(f=A.updateQueue,f!==null)){if(v=null,A.child!==null)switch(A.child.tag){case 27:case 5:v=A.child.stateNode;break;case 1:v=A.child.stateNode}try{Fp(f,v)}catch(Se){Va(A,A.return,Se)}}break;case 27:v===null&&k&4&&o_(A);case 26:case 5:xe(f,A),v===null&&k&4&&xs(A),k&512&&Ds(A,A.return);break;case 12:xe(f,A);break;case 13:xe(f,A),k&4&&U(f,A),k&64&&(f=A.memoizedState,f!==null&&(f=f.dehydrated,f!==null&&(A=bS.bind(null,A),m_(f,A))));break;case 22:if(k=A.memoizedState!==null||Za,!k){v=v!==null&&v.memoizedState!==null||Ao,H=Za;var te=Ao;Za=k,(Ao=v)&&!te?Me(f,A,(A.subtreeFlags&8772)!==0):xe(f,A),Za=H,Ao=te}break;case 30:break;default:xe(f,A)}}function T(f){var v=f.alternate;v!==null&&(f.alternate=null,T(v)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(v=f.stateNode,v!==null&&yt(v)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}var C=null,I=!1;function L(f,v,A){for(A=A.child;A!==null;)F(f,v,A),A=A.sibling}function F(f,v,A){if(Ir&&typeof Ir.onCommitFiberUnmount=="function")try{Ir.onCommitFiberUnmount(tr,A)}catch{}switch(A.tag){case 26:Ao||Eo(A,v),L(f,v,A),A.memoizedState?A.memoizedState.count--:A.stateNode&&(A=A.stateNode,A.parentNode.removeChild(A));break;case 27:Ao||Eo(A,v);var k=C,H=I;qu(A.type)&&(C=A.stateNode,I=!1),L(f,v,A),zg(A.stateNode),C=k,I=H;break;case 5:Ao||Eo(A,v);case 6:if(k=C,H=I,C=null,L(f,v,A),C=k,I=H,C!==null)if(I)try{(C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C).removeChild(A.stateNode)}catch(te){Va(A,v,te)}else try{C.removeChild(A.stateNode)}catch(te){Va(A,v,te)}break;case 18:C!==null&&(I?(f=C,Ng(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,A.stateNode),Wu(f)):Ng(C,A.stateNode));break;case 4:k=C,H=I,C=A.stateNode.containerInfo,I=!0,L(f,v,A),C=k,I=H;break;case 0:case 11:case 14:case 15:Ao||tc(2,A,v),Ao||tc(4,A,v),L(f,v,A);break;case 1:Ao||(Eo(A,v),k=A.stateNode,typeof k.componentWillUnmount=="function"&&ru(A,v,k)),L(f,v,A);break;case 21:L(f,v,A);break;case 22:Ao=(k=Ao)||A.memoizedState!==null,L(f,v,A),Ao=k;break;default:L(f,v,A)}}function U(f,v){if(v.memoizedState===null&&(f=v.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{Wu(f)}catch(A){Va(v,v.return,A)}}function Y(f){switch(f.tag){case 13:case 19:var v=f.stateNode;return v===null&&(v=f.stateNode=new o),v;case 22:return f=f.stateNode,v=f._retryCache,v===null&&(v=f._retryCache=new o),v;default:throw Error(i(435,f.tag))}}function W(f,v){var A=Y(f);v.forEach(function(k){var H=Ev.bind(null,f,k);A.has(k)||(A.add(k),k.then(H,H))})}function Q(f,v){var A=v.deletions;if(A!==null)for(var k=0;k<A.length;k++){var H=A[k],te=f,Se=v,Be=Se;e:for(;Be!==null;){switch(Be.tag){case 27:if(qu(Be.type)){C=Be.stateNode,I=!1;break e}break;case 5:C=Be.stateNode,I=!1;break e;case 3:case 4:C=Be.stateNode.containerInfo,I=!0;break e}Be=Be.return}if(C===null)throw Error(i(160));F(te,Se,H),C=null,I=!1,te=H.alternate,te!==null&&(te.return=null),H.return=null}if(v.subtreeFlags&13878)for(v=v.child;v!==null;)oe(v,f),v=v.sibling}var le=null;function oe(f,v){var A=f.alternate,k=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:Q(v,f),ue(f),k&4&&(tc(3,f,f.return),Md(3,f),tc(5,f,f.return));break;case 1:Q(v,f),ue(f),k&512&&(Ao||A===null||Eo(A,A.return)),k&64&&Za&&(f=f.updateQueue,f!==null&&(k=f.callbacks,k!==null&&(A=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=A===null?k:A.concat(k))));break;case 26:var H=le;if(Q(v,f),ue(f),k&512&&(Ao||A===null||Eo(A,A.return)),k&4){var te=A!==null?A.memoizedState:null;if(k=f.memoizedState,A===null)if(k===null)if(f.stateNode===null){e:{k=f.type,A=f.memoizedProps,H=H.ownerDocument||H;t:switch(k){case"title":te=H.getElementsByTagName("title")[0],(!te||te[et]||te[he]||te.namespaceURI==="http://www.w3.org/2000/svg"||te.hasAttribute("itemprop"))&&(te=H.createElement(k),H.head.insertBefore(te,H.querySelector("head > title"))),Qs(te,k,A),te[he]=f,Hn(te),k=te;break e;case"link":var Se=Bg("link","href",H).get(k+(A.href||""));if(Se){for(var Be=0;Be<Se.length;Be++)if(te=Se[Be],te.getAttribute("href")===(A.href==null||A.href===""?null:A.href)&&te.getAttribute("rel")===(A.rel==null?null:A.rel)&&te.getAttribute("title")===(A.title==null?null:A.title)&&te.getAttribute("crossorigin")===(A.crossOrigin==null?null:A.crossOrigin)){Se.splice(Be,1);break t}}te=H.createElement(k),Qs(te,k,A),H.head.appendChild(te);break;case"meta":if(Se=Bg("meta","content",H).get(k+(A.content||""))){for(Be=0;Be<Se.length;Be++)if(te=Se[Be],te.getAttribute("content")===(A.content==null?null:""+A.content)&&te.getAttribute("name")===(A.name==null?null:A.name)&&te.getAttribute("property")===(A.property==null?null:A.property)&&te.getAttribute("http-equiv")===(A.httpEquiv==null?null:A.httpEquiv)&&te.getAttribute("charset")===(A.charSet==null?null:A.charSet)){Se.splice(Be,1);break t}}te=H.createElement(k),Qs(te,k,A),H.head.appendChild(te);break;default:throw Error(i(468,k))}te[he]=f,Hn(te),k=te}f.stateNode=k}else fb(H,f.type,f.stateNode);else f.stateNode=jS(H,k,f.memoizedProps);else te!==k?(te===null?A.stateNode!==null&&(A=A.stateNode,A.parentNode.removeChild(A)):te.count--,k===null?fb(H,f.type,f.stateNode):jS(H,k,f.memoizedProps)):k===null&&f.stateNode!==null&&Ks(f,f.memoizedProps,A.memoizedProps)}break;case 27:Q(v,f),ue(f),k&512&&(Ao||A===null||Eo(A,A.return)),A!==null&&k&4&&Ks(f,f.memoizedProps,A.memoizedProps);break;case 5:if(Q(v,f),ue(f),k&512&&(Ao||A===null||Eo(A,A.return)),f.flags&32){H=f.stateNode;try{Cs(H,"")}catch(dn){Va(f,f.return,dn)}}k&4&&f.stateNode!=null&&(H=f.memoizedProps,Ks(f,H,A!==null?A.memoizedProps:H)),k&1024&&(g=!0);break;case 6:if(Q(v,f),ue(f),k&4){if(f.stateNode===null)throw Error(i(162));k=f.memoizedProps,A=f.stateNode;try{A.nodeValue=k}catch(dn){Va(f,f.return,dn)}}break;case 3:if(Bv=null,H=le,le=Ns(v.containerInfo),Q(v,f),le=H,ue(f),k&4&&A!==null&&A.memoizedState.isDehydrated)try{Wu(v.containerInfo)}catch(dn){Va(f,f.return,dn)}g&&(g=!1,de(f));break;case 4:k=le,le=Ns(f.stateNode.containerInfo),Q(v,f),ue(f),le=k;break;case 12:Q(v,f),ue(f);break;case 13:Q(v,f),ue(f),f.child.flags&8192&&f.memoizedState!==null!=(A!==null&&A.memoizedState!==null)&&(ri=hi()),k&4&&(k=f.updateQueue,k!==null&&(f.updateQueue=null,W(f,k)));break;case 22:H=f.memoizedState!==null;var bt=A!==null&&A.memoizedState!==null,Gt=Za,Sn=Ao;if(Za=Gt||H,Ao=Sn||bt,Q(v,f),Ao=Sn,Za=Gt,ue(f),k&8192)e:for(v=f.stateNode,v._visibility=H?v._visibility&-2:v._visibility|1,H&&(A===null||bt||Za||Ao||Te(f)),A=null,v=f;;){if(v.tag===5||v.tag===26){if(A===null){bt=A=v;try{if(te=bt.stateNode,H)Se=te.style,typeof Se.setProperty=="function"?Se.setProperty("display","none","important"):Se.display="none";else{Be=bt.stateNode;var In=bt.memoizedProps.style,sn=In!=null&&In.hasOwnProperty("display")?In.display:null;Be.style.display=sn==null||typeof sn=="boolean"?"":(""+sn).trim()}}catch(dn){Va(bt,bt.return,dn)}}}else if(v.tag===6){if(A===null){bt=v;try{bt.stateNode.nodeValue=H?"":bt.memoizedProps}catch(dn){Va(bt,bt.return,dn)}}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===f)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break e;for(;v.sibling===null;){if(v.return===null||v.return===f)break e;A===v&&(A=null),v=v.return}A===v&&(A=null),v.sibling.return=v.return,v=v.sibling}k&4&&(k=f.updateQueue,k!==null&&(A=k.retryQueue,A!==null&&(k.retryQueue=null,W(f,A))));break;case 19:Q(v,f),ue(f),k&4&&(k=f.updateQueue,k!==null&&(f.updateQueue=null,W(f,k)));break;case 30:break;case 21:break;default:Q(v,f),ue(f)}}function ue(f){var v=f.flags;if(v&2){try{for(var A,k=f.return;k!==null;){if(Sv(k)){A=k;break}k=k.return}if(A==null)throw Error(i(160));switch(A.tag){case 27:var H=A.stateNode,te=i_(f);Rg(f,te,H);break;case 5:var Se=A.stateNode;A.flags&32&&(Cs(Se,""),A.flags&=-33);var Be=i_(f);Rg(f,Be,Se);break;case 3:case 4:var bt=A.stateNode.containerInfo,Gt=i_(f);a_(f,Gt,bt);break;default:throw Error(i(161))}}catch(Sn){Va(f,f.return,Sn)}f.flags&=-3}v&4096&&(f.flags&=-4097)}function de(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var v=f;de(v),v.tag===5&&v.flags&1024&&v.stateNode.reset(),f=f.sibling}}function xe(f,v){if(v.subtreeFlags&8772)for(v=v.child;v!==null;)b(f,v.alternate,v),v=v.sibling}function Te(f){for(f=f.child;f!==null;){var v=f;switch(v.tag){case 0:case 11:case 14:case 15:tc(4,v,v.return),Te(v);break;case 1:Eo(v,v.return);var A=v.stateNode;typeof A.componentWillUnmount=="function"&&ru(v,v.return,A),Te(v);break;case 27:zg(v.stateNode);case 26:case 5:Eo(v,v.return),Te(v);break;case 22:v.memoizedState===null&&Te(v);break;case 30:Te(v);break;default:Te(v)}f=f.sibling}}function Me(f,v,A){for(A=A&&(v.subtreeFlags&8772)!==0,v=v.child;v!==null;){var k=v.alternate,H=f,te=v,Se=te.flags;switch(te.tag){case 0:case 11:case 15:Me(H,te,A),Md(4,te);break;case 1:if(Me(H,te,A),k=te,H=k.stateNode,typeof H.componentDidMount=="function")try{H.componentDidMount()}catch(Gt){Va(k,k.return,Gt)}if(k=te,H=k.updateQueue,H!==null){var Be=k.stateNode;try{var bt=H.shared.hiddenCallbacks;if(bt!==null)for(H.shared.hiddenCallbacks=null,H=0;H<bt.length;H++)Uy(bt[H],Be)}catch(Gt){Va(k,k.return,Gt)}}A&&Se&64&&Pd(te),Ds(te,te.return);break;case 27:o_(te);case 26:case 5:Me(H,te,A),A&&k===null&&Se&4&&xs(te),Ds(te,te.return);break;case 12:Me(H,te,A);break;case 13:Me(H,te,A),A&&Se&4&&U(H,te);break;case 22:te.memoizedState===null&&Me(H,te,A),Ds(te,te.return);break;case 30:break;default:Me(H,te,A)}v=v.sibling}}function ke(f,v){var A=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(A=f.memoizedState.cachePool.pool),f=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(f=v.memoizedState.cachePool.pool),f!==A&&(f!=null&&f.refCount++,A!=null&&Ch(A))}function Fe(f,v){f=null,v.alternate!==null&&(f=v.alternate.memoizedState.cache),v=v.memoizedState.cache,v!==f&&(v.refCount++,f!=null&&Ch(f))}function Ve(f,v,A,k){if(v.subtreeFlags&10256)for(v=v.child;v!==null;)Le(f,v,A,k),v=v.sibling}function Le(f,v,A,k){var H=v.flags;switch(v.tag){case 0:case 11:case 15:Ve(f,v,A,k),H&2048&&Md(9,v);break;case 1:Ve(f,v,A,k);break;case 3:Ve(f,v,A,k),H&2048&&(f=null,v.alternate!==null&&(f=v.alternate.memoizedState.cache),v=v.memoizedState.cache,v!==f&&(v.refCount++,f!=null&&Ch(f)));break;case 12:if(H&2048){Ve(f,v,A,k),f=v.stateNode;try{var te=v.memoizedProps,Se=te.id,Be=te.onPostCommit;typeof Be=="function"&&Be(Se,v.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(bt){Va(v,v.return,bt)}}else Ve(f,v,A,k);break;case 13:Ve(f,v,A,k);break;case 23:break;case 22:te=v.stateNode,Se=v.alternate,v.memoizedState!==null?te._visibility&2?Ve(f,v,A,k):je(f,v):te._visibility&2?Ve(f,v,A,k):(te._visibility|=2,Ne(f,v,A,k,(v.subtreeFlags&10256)!==0)),H&2048&&ke(Se,v);break;case 24:Ve(f,v,A,k),H&2048&&Fe(v.alternate,v);break;default:Ve(f,v,A,k)}}function Ne(f,v,A,k,H){for(H=H&&(v.subtreeFlags&10256)!==0,v=v.child;v!==null;){var te=f,Se=v,Be=A,bt=k,Gt=Se.flags;switch(Se.tag){case 0:case 11:case 15:Ne(te,Se,Be,bt,H),Md(8,Se);break;case 23:break;case 22:var Sn=Se.stateNode;Se.memoizedState!==null?Sn._visibility&2?Ne(te,Se,Be,bt,H):je(te,Se):(Sn._visibility|=2,Ne(te,Se,Be,bt,H)),H&&Gt&2048&&ke(Se.alternate,Se);break;case 24:Ne(te,Se,Be,bt,H),H&&Gt&2048&&Fe(Se.alternate,Se);break;default:Ne(te,Se,Be,bt,H)}v=v.sibling}}function je(f,v){if(v.subtreeFlags&10256)for(v=v.child;v!==null;){var A=f,k=v,H=k.flags;switch(k.tag){case 22:je(A,k),H&2048&&ke(k.alternate,k);break;case 24:je(A,k),H&2048&&Fe(k.alternate,k);break;default:je(A,k)}v=v.sibling}}var dt=8192;function Ze(f){if(f.subtreeFlags&dt)for(f=f.child;f!==null;)Pt(f),f=f.sibling}function Pt(f){switch(f.tag){case 26:Ze(f),f.flags&dt&&f.memoizedState!==null&&Fv(le,f.memoizedState,f.memoizedProps);break;case 5:Ze(f);break;case 3:case 4:var v=le;le=Ns(f.stateNode.containerInfo),Ze(f),le=v;break;case 22:f.memoizedState===null&&(v=f.alternate,v!==null&&v.memoizedState!==null?(v=dt,dt=16777216,Ze(f),dt=v):Ze(f));break;default:Ze(f)}}function _t(f){var v=f.alternate;if(v!==null&&(f=v.child,f!==null)){v.child=null;do v=f.sibling,f.sibling=null,f=v;while(f!==null)}}function Lt(f){var v=f.deletions;if((f.flags&16)!==0){if(v!==null)for(var A=0;A<v.length;A++){var k=v[A];u=k,We(k,f)}_t(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)rn(f),f=f.sibling}function rn(f){switch(f.tag){case 0:case 11:case 15:Lt(f),f.flags&2048&&tc(9,f,f.return);break;case 3:Lt(f);break;case 12:Lt(f);break;case 22:var v=f.stateNode;f.memoizedState!==null&&v._visibility&2&&(f.return===null||f.return.tag!==13)?(v._visibility&=-3,ft(f)):Lt(f);break;default:Lt(f)}}function ft(f){var v=f.deletions;if((f.flags&16)!==0){if(v!==null)for(var A=0;A<v.length;A++){var k=v[A];u=k,We(k,f)}_t(f)}for(f=f.child;f!==null;){switch(v=f,v.tag){case 0:case 11:case 15:tc(8,v,v.return),ft(v);break;case 22:A=v.stateNode,A._visibility&2&&(A._visibility&=-3,ft(v));break;default:ft(v)}f=f.sibling}}function We(f,v){for(;u!==null;){var A=u;switch(A.tag){case 0:case 11:case 15:tc(8,A,v);break;case 23:case 22:if(A.memoizedState!==null&&A.memoizedState.cachePool!==null){var k=A.memoizedState.cachePool.pool;k!=null&&k.refCount++}break;case 24:Ch(A.memoizedState.cache)}if(k=A.child,k!==null)k.return=A,u=k;else e:for(A=f;u!==null;){k=u;var H=k.sibling,te=k.return;if(T(k),k===A){u=null;break e}if(H!==null){H.return=te,u=H;break e}u=te}}}var Tt={getCacheForType:function(f){var v=hs(sa),A=v.data.get(f);return A===void 0&&(A=f(),v.data.set(f,A)),A}},mt=typeof WeakMap=="function"?WeakMap:Map,It=0,Nt=null,Rt=null,Ft=0,gn=0,Dn=null,xn=!1,zn=!1,Bn=!1,Kn=0,Zn=0,pr=0,$r=0,sr=0,kr=0,Yr=0,wi=null,lr=null,ei=!1,ri=0,ai=1/0,br=null,oi=null,Tr=0,Li=null,qr=null,ti=0,Ai=0,Ca=null,Ma=null,wa=0,Co=null;function po(){if((It&2)!==0&&Ft!==0)return Ft&-Ft;if(Ie.T!==null){var f=Mh;return f!==0?f:K0()}return Hs()}function bs(){kr===0&&(kr=(Ft&536870912)===0||pa?xi():536870912);var f=ml.current;return f!==null&&(f.flags|=32),kr}function qa(f,v,A){(f===Nt&&(gn===2||gn===9)||f.cancelPendingCommit!==null)&&(Si(f,0),Ya(f,Ft,kr,!1)),ya(f,A),((It&2)===0||f!==Nt)&&(f===Nt&&((It&2)===0&&($r|=A),Zn===4&&Ya(f,Ft,kr,!1)),$u(f))}function ts(f,v,A){if((It&6)!==0)throw Error(i(327));var k=!A&&(v&124)===0&&(v&f.expiredLanes)===0||ss(f,v),H=k?Bf(f,v):Uu(f,v,!0),te=k;do{if(H===0){zn&&!k&&Ya(f,v,0,!1);break}else{if(A=f.current.alternate,te&&!nc(A)){H=Uu(f,v,!1),te=!1;continue}if(H===2){if(te=v,f.errorRecoveryDisabledLanes&te)var Se=0;else Se=f.pendingLanes&-536870913,Se=Se!==0?Se:Se&536870912?536870912:0;if(Se!==0){v=Se;e:{var Be=f;H=wi;var bt=Be.current.memoizedState.isDehydrated;if(bt&&(Si(Be,Se).flags|=256),Se=Uu(Be,Se,!1),Se!==2){if(Bn&&!bt){Be.errorRecoveryDisabledLanes|=te,$r|=te,H=4;break e}te=lr,lr=H,te!==null&&(lr===null?lr=te:lr.push.apply(lr,te))}H=Se}if(te=!1,H!==2)continue}}if(H===1){Si(f,0),Ya(f,v,0,!0);break}e:{switch(k=f,te=H,te){case 0:case 1:throw Error(i(345));case 4:if((v&4194048)!==v)break;case 6:Ya(k,v,kr,!xn);break e;case 2:lr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((v&62914560)===v&&(H=ri+300-hi(),10<H)){if(Ya(k,v,kr,!xn),vo(k,0,!0)!==0)break e;k.timeoutHandle=CS(_l.bind(null,k,A,lr,br,ei,v,kr,$r,Yr,xn,te,2,-0,0),H);break e}_l(k,A,lr,br,ei,v,kr,$r,Yr,xn,te,0,-0,0)}}break}while(!0);$u(f)}function _l(f,v,A,k,H,te,Se,Be,bt,Gt,Sn,In,sn,dn){if(f.timeoutHandle=-1,In=v.subtreeFlags,(In&8192||(In&16785408)===16785408)&&(Fg={stylesheets:null,count:0,unsuspend:pb},Pt(v),In=FS(),In!==null)){f.cancelPendingCommit=In(_S.bind(null,f,v,te,A,k,H,Se,Be,bt,Sn,1,sn,dn)),Ya(f,te,Se,!Gt);return}_S(f,v,te,A,k,H,Se,Be,bt)}function nc(f){for(var v=f;;){var A=v.tag;if((A===0||A===11||A===15)&&v.flags&16384&&(A=v.updateQueue,A!==null&&(A=A.stores,A!==null)))for(var k=0;k<A.length;k++){var H=A[k],te=H.getSnapshot;H=H.value;try{if(!Ol(te(),H))return!1}catch{return!1}}if(A=v.child,v.subtreeFlags&16384&&A!==null)A.return=v,v=A;else{if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function Ya(f,v,A,k){v&=~sr,v&=~$r,f.suspendedLanes|=v,f.pingedLanes&=~v,k&&(f.warmLanes|=v),k=f.expirationTimes;for(var H=v;0<H;){var te=31-Mi(H),Se=1<<te;k[te]=-1,H&=~Se}A!==0&&dr(f,A,v)}function ma(){return(It&6)===0?(Ig(0),!1):!0}function ca(){if(Rt!==null){if(gn===0)var f=Rt.return;else f=Rt,Xc=Zl=null,wc(f),zu=null,Lh=0,f=Rt;for(;f!==null;)Og(f.alternate,f),f=f.return;Rt=null}}function Si(f,v){var A=f.timeoutHandle;A!==-1&&(f.timeoutHandle=-1,Do(A)),A=f.cancelPendingCommit,A!==null&&(f.cancelPendingCommit=null,A()),ca(),Nt=f,Rt=A=Su(f.current,null),Ft=v,gn=0,Dn=null,xn=!1,zn=ss(f,v),Bn=!1,Yr=kr=sr=$r=pr=Zn=0,lr=wi=null,ei=!1,(v&8)!==0&&(v|=v&32);var k=f.entangledLanes;if(k!==0)for(f=f.entanglements,k&=v;0<k;){var H=31-Mi(k),te=1<<H;v|=f[H],k&=~te}return Kn=v,xh(),A}function Ka(f,v){Di=null,Ie.H=Nu,v===xf||v===cg?(v=Vy(),gn=3):v===By?(v=Vy(),gn=4):gn=v===sm?8:v!==null&&typeof v=="object"&&typeof v.then=="function"?6:1,Dn=v,Rt===null&&(Zn=1,Ed(f,nn(v,f.current)))}function Io(){var f=Ie.H;return Ie.H=Nu,f===null?Nu:f}function Sa(){var f=Ie.A;return Ie.A=Tt,f}function Js(){Zn=4,xn||(Ft&4194048)!==Ft&&ml.current!==null||(zn=!0),(pr&134217727)===0&&($r&134217727)===0||Nt===null||Ya(Nt,Ft,kr,!1)}function Uu(f,v,A){var k=It;It|=2;var H=Io(),te=Sa();(Nt!==f||Ft!==v)&&(br=null,Si(f,v)),v=!1;var Se=Zn;e:do try{if(gn!==0&&Rt!==null){var Be=Rt,bt=Dn;switch(gn){case 8:ca(),Se=6;break e;case 3:case 2:case 9:case 6:ml.current===null&&(v=!0);var Gt=gn;if(gn=0,Dn=null,Pa(f,Be,bt,Gt),A&&zn){Se=0;break e}break;default:Gt=gn,gn=0,Dn=null,Pa(f,Be,bt,Gt)}}zh(),Se=Zn;break}catch(Sn){Ka(f,Sn)}while(!0);return v&&f.shellSuspendCounter++,Xc=Zl=null,It=k,Ie.H=H,Ie.A=te,Rt===null&&(Nt=null,Ft=0,xh()),Se}function zh(){for(;Rt!==null;)vl(Rt)}function Bf(f,v){var A=It;It|=2;var k=Io(),H=Sa();Nt!==f||Ft!==v?(br=null,ai=hi()+500,Si(f,v)):zn=ss(f,v);e:do try{if(gn!==0&&Rt!==null){v=Rt;var te=Dn;t:switch(gn){case 1:gn=0,Dn=null,Pa(f,v,te,1);break;case 2:case 9:if(pv(te)){gn=0,Dn=null,Mc(v);break}v=function(){gn!==2&&gn!==9||Nt!==f||(gn=7),$u(f)},te.then(v,v);break e;case 3:gn=7;break e;case 4:gn=5;break e;case 7:pv(te)?(gn=0,Dn=null,Mc(v)):(gn=0,Dn=null,Pa(f,v,te,7));break;case 5:var Se=null;switch(Rt.tag){case 26:Se=Rt.memoizedState;case 5:case 27:var Be=Rt;if(!Se||y_(Se)){gn=0,Dn=null;var bt=Be.sibling;if(bt!==null)Rt=bt;else{var Gt=Be.return;Gt!==null?(Rt=Gt,ks(Gt)):Rt=null}break t}}gn=0,Dn=null,Pa(f,v,te,5);break;case 6:gn=0,Dn=null,Pa(f,v,te,6);break;case 8:ca(),Zn=6;break e;default:throw Error(i(462))}}Ff();break}catch(Sn){Ka(f,Sn)}while(!0);return Xc=Zl=null,Ie.H=k,Ie.A=H,It=A,Rt!==null?0:(Nt=null,Ft=0,xh(),Zn)}function Ff(){for(;Rt!==null&&!Cr();)vl(Rt)}function vl(f){var v=Cc(f.alternate,f,Kn);f.memoizedProps=f.pendingProps,v===null?ks(f):Rt=v}function Mc(f){var v=f,A=v.alternate;switch(v.tag){case 15:case 0:v=t_(A,v,v.pendingProps,v.type,void 0,Ft);break;case 11:v=t_(A,v,v.pendingProps,v.type.render,v.ref,Ft);break;case 5:wc(v);default:Og(A,v),v=Rt=tg(v,Kn),v=Cc(A,v,Kn)}f.memoizedProps=f.pendingProps,v===null?ks(f):Rt=v}function Pa(f,v,A,k){Xc=Zl=null,wc(v),zu=null,Lh=0;var H=v.return;try{if(vv(f,H,v,A,Ft)){Zn=1,Ed(f,nn(A,f.current)),Rt=null;return}}catch(te){if(H!==null)throw Rt=H,te;Zn=1,Ed(f,nn(A,f.current)),Rt=null;return}v.flags&32768?(pa||k===1?f=!0:zn||(Ft&536870912)!==0?f=!1:(xn=f=!0,(k===2||k===9||k===3||k===6)&&(k=ml.current,k!==null&&k.tag===13&&(k.flags|=16384))),jh(v,f)):ks(v)}function ks(f){var v=f;do{if((v.flags&32768)!==0){jh(v,xn);return}f=v.return;var A=q0(v.alternate,v,Kn);if(A!==null){Rt=A;return}if(v=v.sibling,v!==null){Rt=v;return}Rt=v=f}while(v!==null);Zn===0&&(Zn=5)}function jh(f,v){do{var A=wv(f.alternate,f);if(A!==null){A.flags&=32767,Rt=A;return}if(A=f.return,A!==null&&(A.flags|=32768,A.subtreeFlags=0,A.deletions=null),!v&&(f=f.sibling,f!==null)){Rt=f;return}Rt=f=A}while(f!==null);Zn=6,Rt=null}function _S(f,v,A,k,H,te,Se,Be,bt){f.cancelPendingCommit=null;do Tv();while(Tr!==0);if((It&6)!==0)throw Error(i(327));if(v!==null){if(v===f.current)throw Error(i(177));if(te=v.lanes|v.childLanes,te|=df,Tl(f,A,te,Se,Be,bt),f===Nt&&(Rt=Nt=null,Ft=0),qr=v,Li=f,ti=A,Ai=te,Ca=H,Ma=k,(v.subtreeFlags&10256)!==0||(v.flags&10256)!==0?(f.callbackNode=null,f.callbackPriority=0,X0(Bt,function(){return G0(),null})):(f.callbackNode=null,f.callbackPriority=0),k=(v.flags&13878)!==0,(v.subtreeFlags&13878)!==0||k){k=Ie.T,Ie.T=null,H=rt.p,rt.p=2,Se=It,It|=4;try{y(f,v,A)}finally{It=Se,rt.p=H,Ie.T=k}}Tr=1,s_(),vS(),H0()}}function s_(){if(Tr===1){Tr=0;var f=Li,v=qr,A=(v.flags&13878)!==0;if((v.subtreeFlags&13878)!==0||A){A=Ie.T,Ie.T=null;var k=rt.p;rt.p=2;var H=It;It|=4;try{oe(v,f);var te=ab,Se=My(f.containerInfo),Be=te.focusedElem,bt=te.selectionRange;if(Se!==Be&&Be&&Be.ownerDocument&&ud(Be.ownerDocument.documentElement,Be)){if(bt!==null&&sf(Be)){var Gt=bt.start,Sn=bt.end;if(Sn===void 0&&(Sn=Gt),"selectionStart"in Be)Be.selectionStart=Gt,Be.selectionEnd=Math.min(Sn,Be.value.length);else{var In=Be.ownerDocument||document,sn=In&&In.defaultView||window;if(sn.getSelection){var dn=sn.getSelection(),_i=Be.textContent.length,Kr=Math.min(bt.start,_i),La=bt.end===void 0?Kr:Math.min(bt.end,_i);!dn.extend&&Kr>La&&(Se=La,La=Kr,Kr=Se);var jt=gh(Be,Kr),Ot=gh(Be,La);if(jt&&Ot&&(dn.rangeCount!==1||dn.anchorNode!==jt.node||dn.anchorOffset!==jt.offset||dn.focusNode!==Ot.node||dn.focusOffset!==Ot.offset)){var Wt=In.createRange();Wt.setStart(jt.node,jt.offset),dn.removeAllRanges(),Kr>La?(dn.addRange(Wt),dn.extend(Ot.node,Ot.offset)):(Wt.setEnd(Ot.node,Ot.offset),dn.addRange(Wt))}}}}for(In=[],dn=Be;dn=dn.parentNode;)dn.nodeType===1&&In.push({element:dn,left:dn.scrollLeft,top:dn.scrollTop});for(typeof Be.focus=="function"&&Be.focus(),Be=0;Be<In.length;Be++){var Pn=In[Be];Pn.element.scrollLeft=Pn.left,Pn.element.scrollTop=Pn.top}}__=!!ib,ab=ib=null}finally{It=H,rt.p=k,Ie.T=A}}f.current=v,Tr=2}}function vS(){if(Tr===2){Tr=0;var f=Li,v=qr,A=(v.flags&8772)!==0;if((v.subtreeFlags&8772)!==0||A){A=Ie.T,Ie.T=null;var k=rt.p;rt.p=2;var H=It;It|=4;try{b(f,v.alternate,v)}finally{It=H,rt.p=k,Ie.T=A}}Tr=3}}function H0(){if(Tr===4||Tr===3){Tr=0,li();var f=Li,v=qr,A=ti,k=Ma;(v.subtreeFlags&10256)!==0||(v.flags&10256)!==0?Tr=5:(Tr=0,qr=Li=null,l_(f,f.pendingLanes));var H=f.pendingLanes;if(H===0&&(oi=null),to(A),v=v.stateNode,Ir&&typeof Ir.onCommitFiberRoot=="function")try{Ir.onCommitFiberRoot(tr,v,void 0,(v.current.flags&128)===128)}catch{}if(k!==null){v=Ie.T,H=rt.p,rt.p=2,Ie.T=null;try{for(var te=f.onRecoverableError,Se=0;Se<k.length;Se++){var Be=k[Se];te(Be.value,{componentStack:Be.stack})}}finally{Ie.T=v,rt.p=H}}(ti&3)!==0&&Tv(),$u(f),H=f.pendingLanes,(A&4194090)!==0&&(H&42)!==0?f===Co?wa++:(wa=0,Co=f):wa=0,Ig(0)}}function l_(f,v){(f.pooledCacheLanes&=v)===0&&(v=f.pooledCache,v!=null&&(f.pooledCache=null,Ch(v)))}function Tv(f){return s_(),vS(),H0(),G0()}function G0(){if(Tr!==5)return!1;var f=Li,v=Ai;Ai=0;var A=to(ti),k=Ie.T,H=rt.p;try{rt.p=32>A?32:A,Ie.T=null,A=Ca,Ca=null;var te=Li,Se=ti;if(Tr=0,qr=Li=null,ti=0,(It&6)!==0)throw Error(i(331));var Be=It;if(It|=4,rn(te.current),Le(te,te.current,Se,A),It=Be,Ig(0,!1),Ir&&typeof Ir.onPostCommitFiberRoot=="function")try{Ir.onPostCommitFiberRoot(tr,te)}catch{}return!0}finally{rt.p=H,Ie.T=k,l_(f,v)}}function xS(f,v,A){v=nn(A,v),v=am(f.stateNode,v,2),f=Zs(f,v,2),f!==null&&(ya(f,2),$u(f))}function Va(f,v,A){if(f.tag===3)xS(f,f,A);else for(;v!==null;){if(v.tag===3){xS(v,f,A);break}else if(v.tag===1){var k=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(oi===null||!oi.has(k))){f=nn(A,f),A=om(2),k=Zs(v,A,2),k!==null&&(Eg(A,k,v,f),ya(k,2),$u(k));break}}v=v.return}}function iu(f,v,A){var k=f.pingCache;if(k===null){k=f.pingCache=new mt;var H=new Set;k.set(v,H)}else H=k.get(v),H===void 0&&(H=new Set,k.set(v,H));H.has(A)||(Bn=!0,H.add(A),f=Od.bind(null,f,v,A),v.then(f,f))}function Od(f,v,A){var k=f.pingCache;k!==null&&k.delete(v),f.pingedLanes|=f.suspendedLanes&A,f.warmLanes&=~A,Nt===f&&(Ft&A)===A&&(Zn===4||Zn===3&&(Ft&62914560)===Ft&&300>hi()-ri?(It&2)===0&&Si(f,0):sr|=A,Yr===Ft&&(Yr=0)),$u(f)}function W0(f,v){v===0&&(v=ci()),f=bu(f,v),f!==null&&(ya(f,v),$u(f))}function bS(f){var v=f.memoizedState,A=0;v!==null&&(A=v.retryLane),W0(f,A)}function Ev(f,v){var A=0;switch(f.tag){case 13:var k=f.stateNode,H=f.memoizedState;H!==null&&(A=H.retryLane);break;case 19:k=f.stateNode;break;case 22:k=f.stateNode._retryCache;break;default:throw Error(i(314))}k!==null&&k.delete(v),W0(f,A)}function X0(f,v){return Jr(f,v)}var Vf=null,Rd=null,Av=!1,fm=!1,c_=!1,Id=0;function $u(f){f!==Rd&&f.next===null&&(Rd===null?Vf=Rd=f:Rd=Rd.next=f),fm=!0,Av||(Av=!0,EC())}function Ig(f,v){if(!c_&&fm){c_=!0;do for(var A=!1,k=Vf;k!==null;){if(f!==0){var H=k.pendingLanes;if(H===0)var te=0;else{var Se=k.suspendedLanes,Be=k.pingedLanes;te=(1<<31-Mi(42|f)+1)-1,te&=H&~(Se&~Be),te=te&201326741?te&201326741|1:te?te|2:0}te!==0&&(A=!0,wS(k,te))}else te=Ft,te=vo(k,k===Nt?te:0,k.cancelPendingCommit!==null||k.timeoutHandle!==-1),(te&3)===0||ss(k,te)||(A=!0,wS(k,te));k=k.next}while(A);c_=!1}}function Uf(){Z0()}function Z0(){fm=Av=!1;var f=0;Id!==0&&(d_()&&(f=Id),Id=0);for(var v=hi(),A=null,k=Vf;k!==null;){var H=k.next,te=Cv(k,v);te===0?(k.next=null,A===null?Vf=H:A.next=H,H===null&&(Rd=A)):(A=k,(f!==0||(te&3)!==0)&&(fm=!0)),k=H}Ig(f)}function Cv(f,v){for(var A=f.suspendedLanes,k=f.pingedLanes,H=f.expirationTimes,te=f.pendingLanes&-62914561;0<te;){var Se=31-Mi(te),Be=1<<Se,bt=H[Se];bt===-1?((Be&A)===0||(Be&k)!==0)&&(H[Se]=ir(Be,v)):bt<=v&&(f.expiredLanes|=Be),te&=~Be}if(v=Nt,A=Ft,A=vo(f,f===v?A:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),k=f.callbackNode,A===0||f===v&&(gn===2||gn===9)||f.cancelPendingCommit!==null)return k!==null&&k!==null&&mr(k),f.callbackNode=null,f.callbackPriority=0;if((A&3)===0||ss(f,A)){if(v=A&-A,v===f.callbackPriority)return v;switch(k!==null&&mr(k),to(A)){case 2:case 8:A=xt;break;case 32:A=Bt;break;case 268435456:A=$n;break;default:A=Bt}return k=Y0.bind(null,f),A=Jr(A,k),f.callbackPriority=v,f.callbackNode=A,v}return k!==null&&k!==null&&mr(k),f.callbackPriority=2,f.callbackNode=null,2}function Y0(f,v){if(Tr!==0&&Tr!==5)return f.callbackNode=null,f.callbackPriority=0,null;var A=f.callbackNode;if(Tv()&&f.callbackNode!==A)return null;var k=Ft;return k=vo(f,f===Nt?k:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),k===0?null:(ts(f,k,v),Cv(f,hi()),f.callbackNode!=null&&f.callbackNode===A?Y0.bind(null,f):null)}function wS(f,v){if(Tv())return null;ts(f,v,!0)}function EC(){MS(function(){(It&6)!==0?Jr(ra,Uf):Z0()})}function K0(){return Id===0&&(Id=xi()),Id}function J0(f){return f==null||typeof f=="symbol"||typeof f=="boolean"?null:typeof f=="function"?f:ch(""+f)}function Q0(f,v){var A=v.ownerDocument.createElement("input");return A.name=v.name,A.value=v.value,f.id&&A.setAttribute("form",f.id),v.parentNode.insertBefore(A,v),f=new FormData(f),A.parentNode.removeChild(A),f}function AC(f,v,A,k,H){if(v==="submit"&&A&&A.stateNode===H){var te=J0((H[ye]||null).action),Se=k.submitter;Se&&(v=(v=Se[ye]||null)?J0(v.formAction):Se.getAttribute("formAction"),v!==null&&(te=v,Se=null));var Be=new Ul("action","action",null,k,H);f.push({event:Be,listeners:[{instance:null,listener:function(){if(k.defaultPrevented){if(Id!==0){var bt=Se?Q0(H,Se):new FormData(H);xg(A,{pending:!0,data:bt,method:H.method,action:te},null,bt)}}else typeof te=="function"&&(Be.preventDefault(),bt=Se?Q0(H,Se):new FormData(H),xg(A,{pending:!0,data:bt,method:H.method,action:te},te,bt))},currentTarget:H}]})}}for(var Mv=0;Mv<hf.length;Mv++){var eb=hf[Mv],CC=eb.toLowerCase(),SS=eb[0].toUpperCase()+eb.slice(1);ho(CC,"on"+SS)}ho(Mp,"onAnimationEnd"),ho(vu,"onAnimationIteration"),ho(cf,"onAnimationStart"),ho("dblclick","onDoubleClick"),ho("focusin","onFocus"),ho("focusout","onBlur"),ho(Gl,"onTransitionRun"),ho(ky,"onTransitionStart"),ho(uf,"onTransitionCancel"),ho(hd,"onTransitionEnd"),gi("onMouseEnter",["mouseout","mouseover"]),gi("onMouseLeave",["mouseout","mouseover"]),gi("onPointerEnter",["pointerout","pointerover"]),gi("onPointerLeave",["pointerout","pointerover"]),Sr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Sr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Sr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Sr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Sr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Sr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Dg));function tb(f,v){v=(v&4)!==0;for(var A=0;A<f.length;A++){var k=f[A],H=k.event;k=k.listeners;e:{var te=void 0;if(v)for(var Se=k.length-1;0<=Se;Se--){var Be=k[Se],bt=Be.instance,Gt=Be.currentTarget;if(Be=Be.listener,bt!==te&&H.isPropagationStopped())break e;te=Be,H.currentTarget=Gt;try{te(H)}catch(Sn){Df(Sn)}H.currentTarget=null,te=bt}else for(Se=0;Se<k.length;Se++){if(Be=k[Se],bt=Be.instance,Gt=Be.currentTarget,Be=Be.listener,bt!==te&&H.isPropagationStopped())break e;te=Be,H.currentTarget=Gt;try{te(H)}catch(Sn){Df(Sn)}H.currentTarget=null,te=bt}}}}function Wi(f,v){var A=v[He];A===void 0&&(A=v[He]=new Set);var k=f+"__bubble";A.has(k)||(Dd(v,f,2,!1),A.add(k))}function Pv(f,v,A){var k=0;v&&(k|=4),Dd(A,f,k,v)}var u_="_reactListening"+Math.random().toString(36).slice(2);function h_(f){if(!f[u_]){f[u_]=!0,Mr.forEach(function(A){A!=="selectionchange"&&(TS.has(A)||Pv(A,!1,f),Pv(A,!0,f))});var v=f.nodeType===9?f:f.ownerDocument;v===null||v[u_]||(v[u_]=!0,Pv("selectionchange",!1,v))}}function Dd(f,v,A,k){switch(_b(v)){case 2:var H=Hf;break;case 8:H=v_;break;default:H=_m}A=H.bind(null,v,A,f),H=void 0,!jc||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(H=!0),k?H!==void 0?f.addEventListener(v,A,{capture:!0,passive:H}):f.addEventListener(v,A,!0):H!==void 0?f.addEventListener(v,A,{passive:H}):f.addEventListener(v,A,!1)}function Fo(f,v,A,k,H){var te=k;if((v&1)===0&&(v&2)===0&&k!==null)e:for(;;){if(k===null)return;var Se=k.tag;if(Se===3||Se===4){var Be=k.stateNode.containerInfo;if(Be===H)break;if(Se===4)for(Se=k.return;Se!==null;){var bt=Se.tag;if((bt===3||bt===4)&&Se.stateNode.containerInfo===H)return;Se=Se.return}for(;Be!==null;){if(Se=Zt(Be),Se===null)return;if(bt=Se.tag,bt===5||bt===6||bt===26||bt===27){k=te=Se;continue e}Be=Be.parentNode}}k=k.return}uh(function(){var Gt=te,Sn=Fl(A),In=[];e:{var sn=eg.get(f);if(sn!==void 0){var dn=Ul,_i=f;switch(f){case"keypress":if(Fc(A)===0)break e;case"keydown":case"keyup":dn=Vn;break;case"focusin":_i="focus",dn=dh;break;case"focusout":_i="blur",dn=dh;break;case"beforeblur":case"afterblur":dn=dh;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dn=Ep;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dn=Ms;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dn=gc;break;case Mp:case vu:case cf:dn=pi;break;case hd:dn=ie;break;case"scroll":case"scrollend":dn=ad;break;case"wheel":dn=Xe;break;case"copy":case"cut":case"paste":dn=fh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dn=xr;break;case"toggle":case"beforetoggle":dn=fn}var Kr=(v&4)!==0,La=!Kr&&(f==="scroll"||f==="scrollend"),jt=Kr?sn!==null?sn+"Capture":null:sn;Kr=[];for(var Ot=Gt,Wt;Ot!==null;){var Pn=Ot;if(Wt=Pn.stateNode,Pn=Pn.tag,Pn!==5&&Pn!==26&&Pn!==27||Wt===null||jt===null||(Pn=Fr(Ot,jt),Pn!=null&&Kr.push(kg(Ot,Pn,Wt))),La)break;Ot=Ot.return}0<Kr.length&&(sn=new dn(sn,_i,null,A,Sn),In.push({event:sn,listeners:Kr}))}}if((v&7)===0){e:{if(sn=f==="mouseover"||f==="pointerover",dn=f==="mouseout"||f==="pointerout",sn&&A!==Zo&&(_i=A.relatedTarget||A.fromElement)&&(Zt(_i)||_i[Ae]))break e;if((dn||sn)&&(sn=Sn.window===Sn?Sn:(sn=Sn.ownerDocument)?sn.defaultView||sn.parentWindow:window,dn?(_i=A.relatedTarget||A.toElement,dn=Gt,_i=_i?Zt(_i):null,_i!==null&&(La=d(_i),Kr=_i.tag,_i!==La||Kr!==5&&Kr!==27&&Kr!==6)&&(_i=null)):(dn=null,_i=Gt),dn!==_i)){if(Kr=Ep,Pn="onMouseLeave",jt="onMouseEnter",Ot="mouse",(f==="pointerout"||f==="pointerover")&&(Kr=xr,Pn="onPointerLeave",jt="onPointerEnter",Ot="pointer"),La=dn==null?sn:Fn(dn),Wt=_i==null?sn:Fn(_i),sn=new Kr(Pn,Ot+"leave",dn,A,Sn),sn.target=La,sn.relatedTarget=Wt,Pn=null,Zt(Sn)===Gt&&(Kr=new Kr(jt,Ot+"enter",_i,A,Sn),Kr.target=Wt,Kr.relatedTarget=La,Pn=Kr),La=Pn,dn&&_i)t:{for(Kr=dn,jt=_i,Ot=0,Wt=Kr;Wt;Wt=Lg(Wt))Ot++;for(Wt=0,Pn=jt;Pn;Pn=Lg(Pn))Wt++;for(;0<Ot-Wt;)Kr=Lg(Kr),Ot--;for(;0<Wt-Ot;)jt=Lg(jt),Wt--;for(;Ot--;){if(Kr===jt||jt!==null&&Kr===jt.alternate)break t;Kr=Lg(Kr),jt=Lg(jt)}Kr=null}else Kr=null;dn!==null&&ES(In,sn,dn,Kr,!1),_i!==null&&La!==null&&ES(In,La,_i,Kr,!0)}}e:{if(sn=Gt?Fn(Gt):window,dn=sn.nodeName&&sn.nodeName.toLowerCase(),dn==="select"||dn==="input"&&sn.type==="file")var _r=yc;else if(Ws(sn))if(ql)_r=Cp;else{_r=qc;var Vi=Cy}else dn=sn.nodeName,!dn||dn.toLowerCase()!=="input"||sn.type!=="checkbox"&&sn.type!=="radio"?Gt&&gs(Gt.elementType)&&(_r=yc):_r=ys;if(_r&&(_r=_r(f,Gt))){er(In,_r,A,Sn);break e}Vi&&Vi(f,sn,Gt),f==="focusout"&&Gt&&sn.type==="number"&&Gt.memoizedProps.value!=null&&ms(sn,"number",sn.value)}switch(Vi=Gt?Fn(Gt):window,f){case"focusin":(Ws(Vi)||Vi.contentEditable==="true")&&(Rl=Vi,Oy=Gt,lf=null);break;case"focusout":lf=Oy=Rl=null;break;case"mousedown":Ry=!0;break;case"contextmenu":case"mouseup":case"dragend":Ry=!1,Iy(In,A,Sn);break;case"selectionchange":if(Py)break;case"keydown":case"keyup":Iy(In,A,Sn)}var Br;if(fr)e:{switch(f){case"compositionstart":var ui="onCompositionStart";break e;case"compositionend":ui="onCompositionEnd";break e;case"compositionupdate":ui="onCompositionUpdate";break e}ui=void 0}else wo?Ko(f,A)&&(ui="onCompositionEnd"):f==="keydown"&&A.keyCode===229&&(ui="onCompositionStart");ui&&(Zi&&A.locale!=="ko"&&(wo||ui!=="onCompositionStart"?ui==="onCompositionEnd"&&wo&&(Br=mc()):(Bc=Sn,pu="value"in Bc?Bc.value:Bc.textContent,wo=!0)),Vi=$f(Gt,ui),0<Vi.length&&(ui=new Gn(ui,f,null,A,Sn),In.push({event:ui,listeners:Vi}),Br?ui.data=Br:(Br=Ml(A),Br!==null&&(ui.data=Br)))),(Br=Bi?$c(f,A):yr(f,A))&&(ui=$f(Gt,"onBeforeInput"),0<ui.length&&(Vi=new Gn("onBeforeInput","beforeinput",null,A,Sn),In.push({event:Vi,listeners:ui}),Vi.data=Br)),AC(In,f,Gt,A,Sn)}tb(In,v)})}function kg(f,v,A){return{instance:f,listener:v,currentTarget:A}}function $f(f,v){for(var A=v+"Capture",k=[];f!==null;){var H=f,te=H.stateNode;if(H=H.tag,H!==5&&H!==26&&H!==27||te===null||(H=Fr(f,A),H!=null&&k.unshift(kg(f,H,te)),H=Fr(f,v),H!=null&&k.push(kg(f,H,te))),f.tag===3)return k;f=f.return}return[]}function Lg(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5&&f.tag!==27);return f||null}function ES(f,v,A,k,H){for(var te=v._reactName,Se=[];A!==null&&A!==k;){var Be=A,bt=Be.alternate,Gt=Be.stateNode;if(Be=Be.tag,bt!==null&&bt===k)break;Be!==5&&Be!==26&&Be!==27||Gt===null||(bt=Gt,H?(Gt=Fr(A,te),Gt!=null&&Se.unshift(kg(A,Gt,bt))):H||(Gt=Fr(A,te),Gt!=null&&Se.push(kg(A,Gt,bt)))),A=A.return}Se.length!==0&&f.push({event:v,listeners:Se})}var MC=/\r\n?/g,PC=/\u0000|\uFFFD/g;function pm(f){return(typeof f=="string"?f:""+f).replace(MC,`
`).replace(PC,"")}function nb(f,v){return v=pm(v),pm(f)===v}function Bh(){}function Ta(f,v,A,k,H,te){switch(A){case"children":typeof k=="string"?v==="body"||v==="textarea"&&k===""||Cs(f,k):(typeof k=="number"||typeof k=="bigint")&&v!=="body"&&Cs(f,""+k);break;case"className":Qr(f,"class",k);break;case"tabIndex":Qr(f,"tabindex",k);break;case"dir":case"role":case"viewBox":case"width":case"height":Qr(f,A,k);break;case"style":zc(f,k,te);break;case"data":if(v!=="object"){Qr(f,"data",k);break}case"src":case"href":if(k===""&&(v!=="a"||A!=="href")){f.removeAttribute(A);break}if(k==null||typeof k=="function"||typeof k=="symbol"||typeof k=="boolean"){f.removeAttribute(A);break}k=ch(""+k),f.setAttribute(A,k);break;case"action":case"formAction":if(typeof k=="function"){f.setAttribute(A,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof te=="function"&&(A==="formAction"?(v!=="input"&&Ta(f,v,"name",H.name,H,null),Ta(f,v,"formEncType",H.formEncType,H,null),Ta(f,v,"formMethod",H.formMethod,H,null),Ta(f,v,"formTarget",H.formTarget,H,null)):(Ta(f,v,"encType",H.encType,H,null),Ta(f,v,"method",H.method,H,null),Ta(f,v,"target",H.target,H,null)));if(k==null||typeof k=="symbol"||typeof k=="boolean"){f.removeAttribute(A);break}k=ch(""+k),f.setAttribute(A,k);break;case"onClick":k!=null&&(f.onclick=Bh);break;case"onScroll":k!=null&&Wi("scroll",f);break;case"onScrollEnd":k!=null&&Wi("scrollend",f);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(i(61));if(A=k.__html,A!=null){if(H.children!=null)throw Error(i(60));f.innerHTML=A}}break;case"multiple":f.multiple=k&&typeof k!="function"&&typeof k!="symbol";break;case"muted":f.muted=k&&typeof k!="function"&&typeof k!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(k==null||typeof k=="function"||typeof k=="boolean"||typeof k=="symbol"){f.removeAttribute("xlink:href");break}A=ch(""+k),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",A);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":k!=null&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(A,""+k):f.removeAttribute(A);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":k&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(A,""):f.removeAttribute(A);break;case"capture":case"download":k===!0?f.setAttribute(A,""):k!==!1&&k!=null&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(A,k):f.removeAttribute(A);break;case"cols":case"rows":case"size":case"span":k!=null&&typeof k!="function"&&typeof k!="symbol"&&!isNaN(k)&&1<=k?f.setAttribute(A,k):f.removeAttribute(A);break;case"rowSpan":case"start":k==null||typeof k=="function"||typeof k=="symbol"||isNaN(k)?f.removeAttribute(A):f.setAttribute(A,k);break;case"popover":Wi("beforetoggle",f),Wi("toggle",f),yi(f,"popover",k);break;case"xlinkActuate":Ri(f,"http://www.w3.org/1999/xlink","xlink:actuate",k);break;case"xlinkArcrole":Ri(f,"http://www.w3.org/1999/xlink","xlink:arcrole",k);break;case"xlinkRole":Ri(f,"http://www.w3.org/1999/xlink","xlink:role",k);break;case"xlinkShow":Ri(f,"http://www.w3.org/1999/xlink","xlink:show",k);break;case"xlinkTitle":Ri(f,"http://www.w3.org/1999/xlink","xlink:title",k);break;case"xlinkType":Ri(f,"http://www.w3.org/1999/xlink","xlink:type",k);break;case"xmlBase":Ri(f,"http://www.w3.org/XML/1998/namespace","xml:base",k);break;case"xmlLang":Ri(f,"http://www.w3.org/XML/1998/namespace","xml:lang",k);break;case"xmlSpace":Ri(f,"http://www.w3.org/XML/1998/namespace","xml:space",k);break;case"is":yi(f,"is",k);break;case"innerText":case"textContent":break;default:(!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(A=lh.get(A)||A,yi(f,A,k))}}function rb(f,v,A,k,H,te){switch(A){case"style":zc(f,k,te);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(i(61));if(A=k.__html,A!=null){if(H.children!=null)throw Error(i(60));f.innerHTML=A}}break;case"children":typeof k=="string"?Cs(f,k):(typeof k=="number"||typeof k=="bigint")&&Cs(f,""+k);break;case"onScroll":k!=null&&Wi("scroll",f);break;case"onScrollEnd":k!=null&&Wi("scrollend",f);break;case"onClick":k!=null&&(f.onclick=Bh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gr.hasOwnProperty(A))e:{if(A[0]==="o"&&A[1]==="n"&&(H=A.endsWith("Capture"),v=A.slice(2,H?A.length-7:void 0),te=f[ye]||null,te=te!=null?te[A]:null,typeof te=="function"&&f.removeEventListener(v,te,H),typeof k=="function")){typeof te!="function"&&te!==null&&(A in f?f[A]=null:f.hasAttribute(A)&&f.removeAttribute(A)),f.addEventListener(v,k,H);break e}A in f?f[A]=k:k===!0?f.setAttribute(A,""):yi(f,A,k)}}}function Qs(f,v,A){switch(v){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wi("error",f),Wi("load",f);var k=!1,H=!1,te;for(te in A)if(A.hasOwnProperty(te)){var Se=A[te];if(Se!=null)switch(te){case"src":k=!0;break;case"srcSet":H=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,v));default:Ta(f,v,te,Se,A,null)}}H&&Ta(f,v,"srcSet",A.srcSet,A,null),k&&Ta(f,v,"src",A.src,A,null);return;case"input":Wi("invalid",f);var Be=te=Se=H=null,bt=null,Gt=null;for(k in A)if(A.hasOwnProperty(k)){var Sn=A[k];if(Sn!=null)switch(k){case"name":H=Sn;break;case"type":Se=Sn;break;case"checked":bt=Sn;break;case"defaultChecked":Gt=Sn;break;case"value":te=Sn;break;case"defaultValue":Be=Sn;break;case"children":case"dangerouslySetInnerHTML":if(Sn!=null)throw Error(i(137,v));break;default:Ta(f,v,k,Sn,A,null)}}ls(f,te,Be,bt,Gt,Se,H,!1),Lc(f);return;case"select":Wi("invalid",f),k=Se=te=null;for(H in A)if(A.hasOwnProperty(H)&&(Be=A[H],Be!=null))switch(H){case"value":te=Be;break;case"defaultValue":Se=Be;break;case"multiple":k=Be;default:Ta(f,v,H,Be,A,null)}v=te,A=Se,f.multiple=!!k,v!=null?Xo(f,!!k,v,!1):A!=null&&Xo(f,!!k,A,!0);return;case"textarea":Wi("invalid",f),te=H=k=null;for(Se in A)if(A.hasOwnProperty(Se)&&(Be=A[Se],Be!=null))switch(Se){case"value":k=Be;break;case"defaultValue":H=Be;break;case"children":te=Be;break;case"dangerouslySetInnerHTML":if(Be!=null)throw Error(i(91));break;default:Ta(f,v,Se,Be,A,null)}cl(f,k,H,te),Lc(f);return;case"option":for(bt in A)if(A.hasOwnProperty(bt)&&(k=A[bt],k!=null))switch(bt){case"selected":f.selected=k&&typeof k!="function"&&typeof k!="symbol";break;default:Ta(f,v,bt,k,A,null)}return;case"dialog":Wi("beforetoggle",f),Wi("toggle",f),Wi("cancel",f),Wi("close",f);break;case"iframe":case"object":Wi("load",f);break;case"video":case"audio":for(k=0;k<Dg.length;k++)Wi(Dg[k],f);break;case"image":Wi("error",f),Wi("load",f);break;case"details":Wi("toggle",f);break;case"embed":case"source":case"link":Wi("error",f),Wi("load",f);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Gt in A)if(A.hasOwnProperty(Gt)&&(k=A[Gt],k!=null))switch(Gt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,v));default:Ta(f,v,Gt,k,A,null)}return;default:if(gs(v)){for(Sn in A)A.hasOwnProperty(Sn)&&(k=A[Sn],k!==void 0&&rb(f,v,Sn,k,A,void 0));return}}for(Be in A)A.hasOwnProperty(Be)&&(k=A[Be],k!=null&&Ta(f,v,Be,k,A,null))}function OC(f,v,A,k){switch(v){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var H=null,te=null,Se=null,Be=null,bt=null,Gt=null,Sn=null;for(dn in A){var In=A[dn];if(A.hasOwnProperty(dn)&&In!=null)switch(dn){case"checked":break;case"value":break;case"defaultValue":bt=In;default:k.hasOwnProperty(dn)||Ta(f,v,dn,null,k,In)}}for(var sn in k){var dn=k[sn];if(In=A[sn],k.hasOwnProperty(sn)&&(dn!=null||In!=null))switch(sn){case"type":te=dn;break;case"name":H=dn;break;case"checked":Gt=dn;break;case"defaultChecked":Sn=dn;break;case"value":Se=dn;break;case"defaultValue":Be=dn;break;case"children":case"dangerouslySetInnerHTML":if(dn!=null)throw Error(i(137,v));break;default:dn!==In&&Ta(f,v,sn,dn,k,In)}}sh(f,Se,Be,bt,Gt,Sn,te,H);return;case"select":dn=Se=Be=sn=null;for(te in A)if(bt=A[te],A.hasOwnProperty(te)&&bt!=null)switch(te){case"value":break;case"multiple":dn=bt;default:k.hasOwnProperty(te)||Ta(f,v,te,null,k,bt)}for(H in k)if(te=k[H],bt=A[H],k.hasOwnProperty(H)&&(te!=null||bt!=null))switch(H){case"value":sn=te;break;case"defaultValue":Be=te;break;case"multiple":Se=te;default:te!==bt&&Ta(f,v,H,te,k,bt)}v=Be,A=Se,k=dn,sn!=null?Xo(f,!!A,sn,!1):!!k!=!!A&&(v!=null?Xo(f,!!A,v,!0):Xo(f,!!A,A?[]:"",!1));return;case"textarea":dn=sn=null;for(Be in A)if(H=A[Be],A.hasOwnProperty(Be)&&H!=null&&!k.hasOwnProperty(Be))switch(Be){case"value":break;case"children":break;default:Ta(f,v,Be,null,k,H)}for(Se in k)if(H=k[Se],te=A[Se],k.hasOwnProperty(Se)&&(H!=null||te!=null))switch(Se){case"value":sn=H;break;case"defaultValue":dn=H;break;case"children":break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(91));break;default:H!==te&&Ta(f,v,Se,H,k,te)}Bl(f,sn,dn);return;case"option":for(var _i in A)if(sn=A[_i],A.hasOwnProperty(_i)&&sn!=null&&!k.hasOwnProperty(_i))switch(_i){case"selected":f.selected=!1;break;default:Ta(f,v,_i,null,k,sn)}for(bt in k)if(sn=k[bt],dn=A[bt],k.hasOwnProperty(bt)&&sn!==dn&&(sn!=null||dn!=null))switch(bt){case"selected":f.selected=sn&&typeof sn!="function"&&typeof sn!="symbol";break;default:Ta(f,v,bt,sn,k,dn)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Kr in A)sn=A[Kr],A.hasOwnProperty(Kr)&&sn!=null&&!k.hasOwnProperty(Kr)&&Ta(f,v,Kr,null,k,sn);for(Gt in k)if(sn=k[Gt],dn=A[Gt],k.hasOwnProperty(Gt)&&sn!==dn&&(sn!=null||dn!=null))switch(Gt){case"children":case"dangerouslySetInnerHTML":if(sn!=null)throw Error(i(137,v));break;default:Ta(f,v,Gt,sn,k,dn)}return;default:if(gs(v)){for(var La in A)sn=A[La],A.hasOwnProperty(La)&&sn!==void 0&&!k.hasOwnProperty(La)&&rb(f,v,La,void 0,k,sn);for(Sn in k)sn=k[Sn],dn=A[Sn],!k.hasOwnProperty(Sn)||sn===dn||sn===void 0&&dn===void 0||rb(f,v,Sn,sn,k,dn);return}}for(var jt in A)sn=A[jt],A.hasOwnProperty(jt)&&sn!=null&&!k.hasOwnProperty(jt)&&Ta(f,v,jt,null,k,sn);for(In in k)sn=k[In],dn=A[In],!k.hasOwnProperty(In)||sn===dn||sn==null&&dn==null||Ta(f,v,In,sn,k,dn)}var ib=null,ab=null;function Ov(f){return f.nodeType===9?f:f.ownerDocument}function AS(f){switch(f){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Rv(f,v){if(f===0)switch(v){case"svg":return 1;case"math":return 2;default:return 0}return f===1&&v==="foreignObject"?0:f}function ob(f,v){return f==="textarea"||f==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.children=="bigint"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var Iv=null;function d_(){var f=window.event;return f&&f.type==="popstate"?f===Iv?!1:(Iv=f,!0):(Iv=null,!1)}var CS=typeof setTimeout=="function"?setTimeout:void 0,Do=typeof clearTimeout=="function"?clearTimeout:void 0,mm=typeof Promise=="function"?Promise:void 0,MS=typeof queueMicrotask=="function"?queueMicrotask:typeof mm<"u"?function(f){return mm.resolve(null).then(f).catch(Dv)}:CS;function Dv(f){setTimeout(function(){throw f})}function qu(f){return f==="head"}function Ng(f,v){var A=v,k=0,H=0;do{var te=A.nextSibling;if(f.removeChild(A),te&&te.nodeType===8)if(A=te.data,A==="/$"){if(0<k&&8>k){A=k;var Se=f.ownerDocument;if(A&1&&zg(Se.documentElement),A&2&&zg(Se.body),A&4)for(A=Se.head,zg(A),Se=A.firstChild;Se;){var Be=Se.nextSibling,bt=Se.nodeName;Se[et]||bt==="SCRIPT"||bt==="STYLE"||bt==="LINK"&&Se.rel.toLowerCase()==="stylesheet"||A.removeChild(Se),Se=Be}}if(H===0){f.removeChild(te),Wu(v);return}H--}else A==="$"||A==="$?"||A==="$!"?H++:k=A.charCodeAt(0)-48;else k=0;A=te}while(A);Wu(v)}function kv(f){var v=f.firstChild;for(v&&v.nodeType===10&&(v=v.nextSibling);v;){var A=v;switch(v=v.nextSibling,A.nodeName){case"HTML":case"HEAD":case"BODY":kv(A),yt(A);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(A.rel.toLowerCase()==="stylesheet")continue}f.removeChild(A)}}function PS(f,v,A,k){for(;f.nodeType===1;){var H=A;if(f.nodeName.toLowerCase()!==v.toLowerCase()){if(!k&&(f.nodeName!=="INPUT"||f.type!=="hidden"))break}else if(k){if(!f[et])switch(v){case"meta":if(!f.hasAttribute("itemprop"))break;return f;case"link":if(te=f.getAttribute("rel"),te==="stylesheet"&&f.hasAttribute("data-precedence"))break;if(te!==H.rel||f.getAttribute("href")!==(H.href==null||H.href===""?null:H.href)||f.getAttribute("crossorigin")!==(H.crossOrigin==null?null:H.crossOrigin)||f.getAttribute("title")!==(H.title==null?null:H.title))break;return f;case"style":if(f.hasAttribute("data-precedence"))break;return f;case"script":if(te=f.getAttribute("src"),(te!==(H.src==null?null:H.src)||f.getAttribute("type")!==(H.type==null?null:H.type)||f.getAttribute("crossorigin")!==(H.crossOrigin==null?null:H.crossOrigin))&&te&&f.hasAttribute("async")&&!f.hasAttribute("itemprop"))break;return f;default:return f}}else if(v==="input"&&f.type==="hidden"){var te=H.name==null?null:""+H.name;if(H.type==="hidden"&&f.getAttribute("name")===te)return f}else return f;if(f=Hu(f.nextSibling),f===null)break}return null}function f_(f,v,A){if(v==="")return null;for(;f.nodeType!==3;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!A||(f=Hu(f.nextSibling),f===null))return null;return f}function p_(f){return f.data==="$!"||f.data==="$?"&&f.ownerDocument.readyState==="complete"}function m_(f,v){var A=f.ownerDocument;if(f.data!=="$?"||A.readyState==="complete")v();else{var k=function(){v(),A.removeEventListener("DOMContentLoaded",k)};A.addEventListener("DOMContentLoaded",k),f._reactRetry=k}}function Hu(f){for(;f!=null;f=f.nextSibling){var v=f.nodeType;if(v===1||v===3)break;if(v===8){if(v=f.data,v==="$"||v==="$!"||v==="$?"||v==="F!"||v==="F")break;if(v==="/$")return null}}return f}var Lv=null;function Nv(f){f=f.previousSibling;for(var v=0;f;){if(f.nodeType===8){var A=f.data;if(A==="$"||A==="$!"||A==="$?"){if(v===0)return f;v--}else A==="/$"&&v++}f=f.previousSibling}return null}function zv(f,v,A){switch(v=Ov(A),f){case"html":if(f=v.documentElement,!f)throw Error(i(452));return f;case"head":if(f=v.head,!f)throw Error(i(453));return f;case"body":if(f=v.body,!f)throw Error(i(454));return f;default:throw Error(i(451))}}function zg(f){for(var v=f.attributes;v.length;)f.removeAttributeNode(v[0]);yt(f)}var Ls=new Map,OS=new Set;function Ns(f){return typeof f.getRootNode=="function"?f.getRootNode():f.nodeType===9?f:f.ownerDocument}var Fh=rt.d;rt.d={f:RS,r:IS,D:RC,C:sb,L:kS,m:lb,X:LS,S:cb,M:NS};function RS(){var f=Fh.f(),v=ma();return f||v}function IS(f){var v=zt(f);v!==null&&v.tag===5&&v.type==="form"?Of(v):Fh.r(f)}var kd=typeof document>"u"?null:document;function DS(f,v,A){var k=kd;if(k&&typeof v=="string"&&v){var H=bo(v);H='link[rel="'+f+'"][href="'+H+'"]',typeof A=="string"&&(H+='[crossorigin="'+A+'"]'),OS.has(H)||(OS.add(H),f={rel:f,crossOrigin:A,href:v},k.querySelector(H)===null&&(v=k.createElement("link"),Qs(v,"link",f),Hn(v),k.head.appendChild(v)))}}function RC(f){Fh.D(f),DS("dns-prefetch",f,null)}function sb(f,v){Fh.C(f,v),DS("preconnect",f,v)}function kS(f,v,A){Fh.L(f,v,A);var k=kd;if(k&&f&&v){var H='link[rel="preload"][as="'+bo(v)+'"]';v==="image"&&A&&A.imageSrcSet?(H+='[imagesrcset="'+bo(A.imageSrcSet)+'"]',typeof A.imageSizes=="string"&&(H+='[imagesizes="'+bo(A.imageSizes)+'"]')):H+='[href="'+bo(f)+'"]';var te=H;switch(v){case"style":te=gm(f);break;case"script":te=jg(f)}Ls.has(te)||(f=M({rel:"preload",href:v==="image"&&A&&A.imageSrcSet?void 0:f,as:v},A),Ls.set(te,f),k.querySelector(H)!==null||v==="style"&&k.querySelector(qf(te))||v==="script"&&k.querySelector(g_(te))||(v=k.createElement("link"),Qs(v,"link",f),Hn(v),k.head.appendChild(v)))}}function lb(f,v){Fh.m(f,v);var A=kd;if(A&&f){var k=v&&typeof v.as=="string"?v.as:"script",H='link[rel="modulepreload"][as="'+bo(k)+'"][href="'+bo(f)+'"]',te=H;switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":te=jg(f)}if(!Ls.has(te)&&(f=M({rel:"modulepreload",href:f},v),Ls.set(te,f),A.querySelector(H)===null)){switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(A.querySelector(g_(te)))return}k=A.createElement("link"),Qs(k,"link",f),Hn(k),A.head.appendChild(k)}}}function cb(f,v,A){Fh.S(f,v,A);var k=kd;if(k&&f){var H=Yn(k).hoistableStyles,te=gm(f);v=v||"default";var Se=H.get(te);if(!Se){var Be={loading:0,preload:null};if(Se=k.querySelector(qf(te)))Be.loading=5;else{f=M({rel:"stylesheet",href:f,"data-precedence":v},A),(A=Ls.get(te))&&hb(f,A);var bt=Se=k.createElement("link");Hn(bt),Qs(bt,"link",f),bt._p=new Promise(function(Gt,Sn){bt.onload=Gt,bt.onerror=Sn}),bt.addEventListener("load",function(){Be.loading|=1}),bt.addEventListener("error",function(){Be.loading|=2}),Be.loading|=4,jv(Se,v,k)}Se={type:"stylesheet",instance:Se,count:1,state:Be},H.set(te,Se)}}}function LS(f,v){Fh.X(f,v);var A=kd;if(A&&f){var k=Yn(A).hoistableScripts,H=jg(f),te=k.get(H);te||(te=A.querySelector(g_(H)),te||(f=M({src:f,async:!0},v),(v=Ls.get(H))&&db(f,v),te=A.createElement("script"),Hn(te),Qs(te,"link",f),A.head.appendChild(te)),te={type:"script",instance:te,count:1,state:null},k.set(H,te))}}function NS(f,v){Fh.M(f,v);var A=kd;if(A&&f){var k=Yn(A).hoistableScripts,H=jg(f),te=k.get(H);te||(te=A.querySelector(g_(H)),te||(f=M({src:f,async:!0,type:"module"},v),(v=Ls.get(H))&&db(f,v),te=A.createElement("script"),Hn(te),Qs(te,"link",f),A.head.appendChild(te)),te={type:"script",instance:te,count:1,state:null},k.set(H,te))}}function ub(f,v,A,k){var H=(H=qt.current)?Ns(H):null;if(!H)throw Error(i(446));switch(f){case"meta":case"title":return null;case"style":return typeof A.precedence=="string"&&typeof A.href=="string"?(v=gm(A.href),A=Yn(H).hoistableStyles,k=A.get(v),k||(k={type:"style",instance:null,count:0,state:null},A.set(v,k)),k):{type:"void",instance:null,count:0,state:null};case"link":if(A.rel==="stylesheet"&&typeof A.href=="string"&&typeof A.precedence=="string"){f=gm(A.href);var te=Yn(H).hoistableStyles,Se=te.get(f);if(Se||(H=H.ownerDocument||H,Se={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},te.set(f,Se),(te=H.querySelector(qf(f)))&&!te._p&&(Se.instance=te,Se.state.loading=5),Ls.has(f)||(A={rel:"preload",as:"style",href:A.href,crossOrigin:A.crossOrigin,integrity:A.integrity,media:A.media,hrefLang:A.hrefLang,referrerPolicy:A.referrerPolicy},Ls.set(f,A),te||zS(H,f,A,Se.state))),v&&k===null)throw Error(i(528,""));return Se}if(v&&k!==null)throw Error(i(529,""));return null;case"script":return v=A.async,A=A.src,typeof A=="string"&&v&&typeof v!="function"&&typeof v!="symbol"?(v=jg(A),A=Yn(H).hoistableScripts,k=A.get(v),k||(k={type:"script",instance:null,count:0,state:null},A.set(v,k)),k):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,f))}}function gm(f){return'href="'+bo(f)+'"'}function qf(f){return'link[rel="stylesheet"]['+f+"]"}function Gu(f){return M({},f,{"data-precedence":f.precedence,precedence:null})}function zS(f,v,A,k){f.querySelector('link[rel="preload"][as="style"]['+v+"]")?k.loading=1:(v=f.createElement("link"),k.preload=v,v.addEventListener("load",function(){return k.loading|=1}),v.addEventListener("error",function(){return k.loading|=2}),Qs(v,"link",A),Hn(v),f.head.appendChild(v))}function jg(f){return'[src="'+bo(f)+'"]'}function g_(f){return"script[async]"+f}function jS(f,v,A){if(v.count++,v.instance===null)switch(v.type){case"style":var k=f.querySelector('style[data-href~="'+bo(A.href)+'"]');if(k)return v.instance=k,Hn(k),k;var H=M({},A,{"data-href":A.href,"data-precedence":A.precedence,href:null,precedence:null});return k=(f.ownerDocument||f).createElement("style"),Hn(k),Qs(k,"style",H),jv(k,A.precedence,f),v.instance=k;case"stylesheet":H=gm(A.href);var te=f.querySelector(qf(H));if(te)return v.state.loading|=4,v.instance=te,Hn(te),te;k=Gu(A),(H=Ls.get(H))&&hb(k,H),te=(f.ownerDocument||f).createElement("link"),Hn(te);var Se=te;return Se._p=new Promise(function(Be,bt){Se.onload=Be,Se.onerror=bt}),Qs(te,"link",k),v.state.loading|=4,jv(te,A.precedence,f),v.instance=te;case"script":return te=jg(A.src),(H=f.querySelector(g_(te)))?(v.instance=H,Hn(H),H):(k=A,(H=Ls.get(te))&&(k=M({},A),db(k,H)),f=f.ownerDocument||f,H=f.createElement("script"),Hn(H),Qs(H,"link",k),f.head.appendChild(H),v.instance=H);case"void":return null;default:throw Error(i(443,v.type))}else v.type==="stylesheet"&&(v.state.loading&4)===0&&(k=v.instance,v.state.loading|=4,jv(k,A.precedence,f));return v.instance}function jv(f,v,A){for(var k=A.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),H=k.length?k[k.length-1]:null,te=H,Se=0;Se<k.length;Se++){var Be=k[Se];if(Be.dataset.precedence===v)te=Be;else if(te!==H)break}te?te.parentNode.insertBefore(f,te.nextSibling):(v=A.nodeType===9?A.head:A,v.insertBefore(f,v.firstChild))}function hb(f,v){f.crossOrigin==null&&(f.crossOrigin=v.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=v.referrerPolicy),f.title==null&&(f.title=v.title)}function db(f,v){f.crossOrigin==null&&(f.crossOrigin=v.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=v.referrerPolicy),f.integrity==null&&(f.integrity=v.integrity)}var Bv=null;function Bg(f,v,A){if(Bv===null){var k=new Map,H=Bv=new Map;H.set(A,k)}else H=Bv,k=H.get(A),k||(k=new Map,H.set(A,k));if(k.has(f))return k;for(k.set(f,null),A=A.getElementsByTagName(f),H=0;H<A.length;H++){var te=A[H];if(!(te[et]||te[he]||f==="link"&&te.getAttribute("rel")==="stylesheet")&&te.namespaceURI!=="http://www.w3.org/2000/svg"){var Se=te.getAttribute(v)||"";Se=f+Se;var Be=k.get(Se);Be?Be.push(te):k.set(Se,[te])}}return k}function fb(f,v,A){f=f.ownerDocument||f,f.head.insertBefore(A,v==="title"?f.querySelector("head > title"):null)}function BS(f,v,A){if(A===1||v.itemProp!=null)return!1;switch(f){case"meta":case"title":return!0;case"style":if(typeof v.precedence!="string"||typeof v.href!="string"||v.href==="")break;return!0;case"link":if(typeof v.rel!="string"||typeof v.href!="string"||v.href===""||v.onLoad||v.onError)break;switch(v.rel){case"stylesheet":return f=v.disabled,typeof v.precedence=="string"&&f==null;default:return!0}case"script":if(v.async&&typeof v.async!="function"&&typeof v.async!="symbol"&&!v.onLoad&&!v.onError&&v.src&&typeof v.src=="string")return!0}return!1}function y_(f){return!(f.type==="stylesheet"&&(f.state.loading&3)===0)}var Fg=null;function pb(){}function Fv(f,v,A){if(Fg===null)throw Error(i(475));var k=Fg;if(v.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(v.state.loading&4)===0){if(v.instance===null){var H=gm(A.href),te=f.querySelector(qf(H));if(te){f=te._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(k.count++,k=Vv.bind(k),f.then(k,k)),v.state.loading|=4,v.instance=te,Hn(te);return}te=f.ownerDocument||f,A=Gu(A),(H=Ls.get(H))&&hb(A,H),te=te.createElement("link"),Hn(te);var Se=te;Se._p=new Promise(function(Be,bt){Se.onload=Be,Se.onerror=bt}),Qs(te,"link",A),v.instance=te}k.stylesheets===null&&(k.stylesheets=new Map),k.stylesheets.set(v,f),(f=v.state.preload)&&(v.state.loading&3)===0&&(k.count++,v=Vv.bind(k),f.addEventListener("load",v),f.addEventListener("error",v))}}function FS(){if(Fg===null)throw Error(i(475));var f=Fg;return f.stylesheets&&f.count===0&&Uv(f,f.stylesheets),0<f.count?function(v){var A=setTimeout(function(){if(f.stylesheets&&Uv(f,f.stylesheets),f.unsuspend){var k=f.unsuspend;f.unsuspend=null,k()}},6e4);return f.unsuspend=v,function(){f.unsuspend=null,clearTimeout(A)}}:null}function Vv(){if(this.count--,this.count===0){if(this.stylesheets)Uv(this,this.stylesheets);else if(this.unsuspend){var f=this.unsuspend;this.unsuspend=null,f()}}}var Vg=null;function Uv(f,v){f.stylesheets=null,f.unsuspend!==null&&(f.count++,Vg=new Map,v.forEach(VS,f),Vg=null,Vv.call(f))}function VS(f,v){if(!(v.state.loading&4)){var A=Vg.get(f);if(A)var k=A.get(null);else{A=new Map,Vg.set(f,A);for(var H=f.querySelectorAll("link[data-precedence],style[data-precedence]"),te=0;te<H.length;te++){var Se=H[te];(Se.nodeName==="LINK"||Se.getAttribute("media")!=="not all")&&(A.set(Se.dataset.precedence,Se),k=Se)}k&&A.set(null,k)}H=v.instance,Se=H.getAttribute("data-precedence"),te=A.get(Se)||k,te===k&&A.set(null,H),A.set(Se,H),this.count++,k=Vv.bind(this),H.addEventListener("load",k),H.addEventListener("error",k),te?te.parentNode.insertBefore(H,te.nextSibling):(f=f.nodeType===9?f.head:f,f.insertBefore(H,f.firstChild)),v.state.loading|=4}}var ym={$$typeof:re,Provider:null,Consumer:null,_currentValue:Qe,_currentValue2:Qe,_threadCount:0};function mb(f,v,A,k,H,te,Se,Be){this.tag=1,this.containerInfo=f,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ra(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ra(0),this.hiddenUpdates=Ra(null),this.identifierPrefix=k,this.onUncaughtError=H,this.onCaughtError=te,this.onRecoverableError=Se,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Be,this.incompleteTransitions=new Map}function gb(f,v,A,k,H,te,Se,Be,bt,Gt,Sn,In){return f=new mb(f,v,A,Se,Be,bt,Gt,In),v=1,te===!0&&(v|=24),te=Il(3,null,null,v),f.current=te,te.stateNode=f,v=Np(),v.refCount++,f.pooledCache=v,v.refCount++,te.memoizedState={element:k,isDehydrated:A,cache:v},hg(te),f}function $v(f){return f?(f=Os,f):Os}function US(f,v,A,k,H,te){H=$v(H),k.context===null?k.context=H:k.pendingContext=H,k=xc(v),k.payload={element:A},te=te===void 0?null:te,te!==null&&(k.callback=te),A=Zs(f,k,v),A!==null&&(qa(A,f,v),yd(A,f,v))}function $S(f,v){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var A=f.retryLane;f.retryLane=A!==0&&A<v?A:v}}function yb(f,v){$S(f,v),(f=f.alternate)&&$S(f,v)}function qS(f){if(f.tag===13){var v=bu(f,67108864);v!==null&&qa(v,f,67108864),yb(f,67108864)}}var __=!0;function Hf(f,v,A,k){var H=Ie.T;Ie.T=null;var te=rt.p;try{rt.p=2,_m(f,v,A,k)}finally{rt.p=te,Ie.T=H}}function v_(f,v,A,k){var H=Ie.T;Ie.T=null;var te=rt.p;try{rt.p=8,_m(f,v,A,k)}finally{rt.p=te,Ie.T=H}}function _m(f,v,A,k){if(__){var H=Ug(k);if(H===null)Fo(f,v,k,Gf,A),vb(f,k);else if(HS(H,f,v,A,k))k.stopPropagation();else if(vb(f,k),v&4&&-1<IC.indexOf(f)){for(;H!==null;){var te=zt(H);if(te!==null)switch(te.tag){case 3:if(te=te.stateNode,te.current.memoizedState.isDehydrated){var Se=co(te.pendingLanes);if(Se!==0){var Be=te;for(Be.pendingLanes|=2,Be.entangledLanes|=2;Se;){var bt=1<<31-Mi(Se);Be.entanglements[1]|=bt,Se&=~bt}$u(te),(It&6)===0&&(ai=hi()+500,Ig(0))}}break;case 13:Be=bu(te,2),Be!==null&&qa(Be,te,2),ma(),yb(te,2)}if(te=Ug(k),te===null&&Fo(f,v,k,Gf,A),te===H)break;H=te}H!==null&&k.stopPropagation()}else Fo(f,v,k,null,A)}}function Ug(f){return f=Fl(f),qv(f)}var Gf=null;function qv(f){if(Gf=null,f=Zt(f),f!==null){var v=d(f);if(v===null)f=null;else{var A=v.tag;if(A===13){if(f=m(v),f!==null)return f;f=null}else if(A===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;f=null}else v!==f&&(f=null)}}return Gf=f,null}function _b(f){switch(f){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(so()){case ra:return 2;case xt:return 8;case Bt:case tn:return 32;case $n:return 268435456;default:return 32}default:return 32}}var Hv=!1,Ld=null,Wf=null,Xf=null,vm=new Map,Zf=new Map,Nd=[],IC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vb(f,v){switch(f){case"focusin":case"focusout":Ld=null;break;case"dragenter":case"dragleave":Wf=null;break;case"mouseover":case"mouseout":Xf=null;break;case"pointerover":case"pointerout":vm.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zf.delete(v.pointerId)}}function xm(f,v,A,k,H,te){return f===null||f.nativeEvent!==te?(f={blockedOn:v,domEventName:A,eventSystemFlags:k,nativeEvent:te,targetContainers:[H]},v!==null&&(v=zt(v),v!==null&&qS(v)),f):(f.eventSystemFlags|=k,v=f.targetContainers,H!==null&&v.indexOf(H)===-1&&v.push(H),f)}function HS(f,v,A,k,H){switch(v){case"focusin":return Ld=xm(Ld,f,v,A,k,H),!0;case"dragenter":return Wf=xm(Wf,f,v,A,k,H),!0;case"mouseover":return Xf=xm(Xf,f,v,A,k,H),!0;case"pointerover":var te=H.pointerId;return vm.set(te,xm(vm.get(te)||null,f,v,A,k,H)),!0;case"gotpointercapture":return te=H.pointerId,Zf.set(te,xm(Zf.get(te)||null,f,v,A,k,H)),!0}return!1}function xb(f){var v=Zt(f.target);if(v!==null){var A=d(v);if(A!==null){if(v=A.tag,v===13){if(v=m(A),v!==null){f.blockedOn=v,hr(f.priority,function(){if(A.tag===13){var k=po();k=Dr(k);var H=bu(A,k);H!==null&&qa(H,A,k),yb(A,k)}});return}}else if(v===3&&A.stateNode.current.memoizedState.isDehydrated){f.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}f.blockedOn=null}function x_(f){if(f.blockedOn!==null)return!1;for(var v=f.targetContainers;0<v.length;){var A=Ug(f.nativeEvent);if(A===null){A=f.nativeEvent;var k=new A.constructor(A.type,A);Zo=k,A.target.dispatchEvent(k),Zo=null}else return v=zt(A),v!==null&&qS(v),f.blockedOn=A,!1;v.shift()}return!0}function bb(f,v,A){x_(f)&&A.delete(v)}function GS(){Hv=!1,Ld!==null&&x_(Ld)&&(Ld=null),Wf!==null&&x_(Wf)&&(Wf=null),Xf!==null&&x_(Xf)&&(Xf=null),vm.forEach(bb),Zf.forEach(bb)}function Gv(f,v){f.blockedOn===v&&(f.blockedOn=null,Hv||(Hv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,GS)))}var b_=null;function wb(f){b_!==f&&(b_=f,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){b_===f&&(b_=null);for(var v=0;v<f.length;v+=3){var A=f[v],k=f[v+1],H=f[v+2];if(typeof k!="function"){if(qv(k||A)===null)continue;break}var te=zt(A);te!==null&&(f.splice(v,3),v-=3,xg(te,{pending:!0,data:H,method:A.method,action:k},k,H))}}))}function Wu(f){function v(bt){return Gv(bt,f)}Ld!==null&&Gv(Ld,f),Wf!==null&&Gv(Wf,f),Xf!==null&&Gv(Xf,f),vm.forEach(v),Zf.forEach(v);for(var A=0;A<Nd.length;A++){var k=Nd[A];k.blockedOn===f&&(k.blockedOn=null)}for(;0<Nd.length&&(A=Nd[0],A.blockedOn===null);)xb(A),A.blockedOn===null&&Nd.shift();if(A=(f.ownerDocument||f).$$reactFormReplay,A!=null)for(k=0;k<A.length;k+=3){var H=A[k],te=A[k+1],Se=H[ye]||null;if(typeof te=="function")Se||wb(A);else if(Se){var Be=null;if(te&&te.hasAttribute("formAction")){if(H=te,Se=te[ye]||null)Be=Se.formAction;else if(qv(H)!==null)continue}else Be=Se.action;typeof Be=="function"?A[k+1]=Be:(A.splice(k,3),k-=3),wb(A)}}}function Wv(f){this._internalRoot=f}w_.prototype.render=Wv.prototype.render=function(f){var v=this._internalRoot;if(v===null)throw Error(i(409));var A=v.current,k=po();US(A,k,f,v,null,null)},w_.prototype.unmount=Wv.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var v=f.containerInfo;US(f.current,2,null,f,null,null),ma(),v[Ae]=null}};function w_(f){this._internalRoot=f}w_.prototype.unstable_scheduleHydration=function(f){if(f){var v=Hs();f={blockedOn:null,target:f,priority:v};for(var A=0;A<Nd.length&&v!==0&&v<Nd[A].priority;A++);Nd.splice(A,0,f),A===0&&xb(f)}};var Sb=t.version;if(Sb!=="19.1.1")throw Error(i(527,Sb,"19.1.1"));rt.findDOMNode=function(f){var v=f._reactInternals;if(v===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=w(v),f=f!==null?S(f):null,f=f===null?null:f.stateNode,f};var Xv={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Ie,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zv.isDisabled&&Zv.supportsFiber)try{tr=Zv.inject(Xv),Ir=Zv}catch{}}return Xb.createRoot=function(f,v){if(!c(f))throw Error(i(299));var A=!1,k="",H=Vu,te=Sg,Se=Tg,Be=null;return v!=null&&(v.unstable_strictMode===!0&&(A=!0),v.identifierPrefix!==void 0&&(k=v.identifierPrefix),v.onUncaughtError!==void 0&&(H=v.onUncaughtError),v.onCaughtError!==void 0&&(te=v.onCaughtError),v.onRecoverableError!==void 0&&(Se=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(Be=v.unstable_transitionCallbacks)),v=gb(f,1,!1,null,null,A,k,H,te,Se,Be,null),f[Ae]=v.current,h_(f),new Wv(v)},Xb.hydrateRoot=function(f,v,A){if(!c(f))throw Error(i(299));var k=!1,H="",te=Vu,Se=Sg,Be=Tg,bt=null,Gt=null;return A!=null&&(A.unstable_strictMode===!0&&(k=!0),A.identifierPrefix!==void 0&&(H=A.identifierPrefix),A.onUncaughtError!==void 0&&(te=A.onUncaughtError),A.onCaughtError!==void 0&&(Se=A.onCaughtError),A.onRecoverableError!==void 0&&(Be=A.onRecoverableError),A.unstable_transitionCallbacks!==void 0&&(bt=A.unstable_transitionCallbacks),A.formState!==void 0&&(Gt=A.formState)),v=gb(f,1,!0,v,A??null,k,H,te,Se,Be,bt,Gt),v.context=$v(null),A=v.current,k=po(),k=Dr(k),H=xc(k),H.callback=null,Zs(A,H,k),A=k,v.current.lanes=A,ya(v,A),$u(v),f[Ae]=v.current,h_(f),new w_(v)},Xb.version="19.1.1",Xb}var SF;function Are(){if(SF)return CM.exports;SF=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),CM.exports=Ere(),CM.exports}var Cre=Are();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var TF="popstate";function Mre(e={}){function t(i,c){let{pathname:d,search:m,hash:a}=i.location;return OD("",{pathname:d,search:m,hash:a},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function n(i,c){return typeof c=="string"?c:Dw(c)}return Ore(t,n,null,e)}function os(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function pp(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Pre(){return Math.random().toString(36).substring(2,10)}function EF(e,t){return{usr:e.state,key:e.key,idx:t}}function OD(e,t,n=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?m0(t):t,state:n,key:t&&t.key||i||Pre()}}function Dw({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function m0(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function Ore(e,t,n,i={}){let{window:c=document.defaultView,v5Compat:d=!1}=i,m=c.history,a="POP",w=null,S=M();S==null&&(S=0,m.replaceState({...m.state,idx:S},""));function M(){return(m.state||{idx:null}).idx}function P(){a="POP";let V=M(),J=V==null?null:V-S;S=V,w&&w({action:a,location:q.location,delta:J})}function N(V,J){a="PUSH";let ee=OD(q.location,V,J);S=M()+1;let re=EF(ee,S),fe=q.createHref(ee);try{m.pushState(re,"",fe)}catch(ne){if(ne instanceof DOMException&&ne.name==="DataCloneError")throw ne;c.location.assign(fe)}d&&w&&w({action:a,location:q.location,delta:1})}function $(V,J){a="REPLACE";let ee=OD(q.location,V,J);S=M();let re=EF(ee,S),fe=q.createHref(ee);m.replaceState(re,"",fe),d&&w&&w({action:a,location:q.location,delta:0})}function G(V){return Rre(V)}let q={get action(){return a},get location(){return e(c,m)},listen(V){if(w)throw new Error("A history only accepts one active listener");return c.addEventListener(TF,P),w=V,()=>{c.removeEventListener(TF,P),w=null}},createHref(V){return t(c,V)},createURL:G,encodeLocation(V){let J=G(V);return{pathname:J.pathname,search:J.search,hash:J.hash}},push:N,replace:$,go(V){return m.go(V)}};return q}function Rre(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),os(n,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:Dw(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function _G(e,t,n="/"){return Ire(e,t,n,!1)}function Ire(e,t,n,i){let c=typeof t=="string"?m0(t):t,d=Nm(c.pathname||"/",n);if(d==null)return null;let m=vG(e);Dre(m);let a=null;for(let w=0;a==null&&w<m.length;++w){let S=qre(d);a=Ure(m[w],S,i)}return a}function vG(e,t=[],n=[],i="",c=!1){let d=(m,a,w=c,S)=>{let M={relativePath:S===void 0?m.path||"":S,caseSensitive:m.caseSensitive===!0,childrenIndex:a,route:m};if(M.relativePath.startsWith("/")){if(!M.relativePath.startsWith(i)&&w)return;os(M.relativePath.startsWith(i),`Absolute route path "${M.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),M.relativePath=M.relativePath.slice(i.length)}let P=Im([i,M.relativePath]),N=n.concat(M);m.children&&m.children.length>0&&(os(m.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${P}".`),vG(m.children,t,N,P,w)),!(m.path==null&&!m.index)&&t.push({path:P,score:Fre(P,m.index),routesMeta:N})};return e.forEach((m,a)=>{if(m.path===""||!m.path?.includes("?"))d(m,a);else for(let w of xG(m.path))d(m,a,!0,w)}),t}function xG(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,c=n.endsWith("?"),d=n.replace(/\?$/,"");if(i.length===0)return c?[d,""]:[d];let m=xG(i.join("/")),a=[];return a.push(...m.map(w=>w===""?d:[d,w].join("/"))),c&&a.push(...m),a.map(w=>e.startsWith("/")&&w===""?"/":w)}function Dre(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Vre(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var kre=/^:[\w-]+$/,Lre=3,Nre=2,zre=1,jre=10,Bre=-2,AF=e=>e==="*";function Fre(e,t){let n=e.split("/"),i=n.length;return n.some(AF)&&(i+=Bre),t&&(i+=Nre),n.filter(c=>!AF(c)).reduce((c,d)=>c+(kre.test(d)?Lre:d===""?zre:jre),i)}function Vre(e,t){return e.length===t.length&&e.slice(0,-1).every((i,c)=>i===t[c])?e[e.length-1]-t[t.length-1]:0}function Ure(e,t,n=!1){let{routesMeta:i}=e,c={},d="/",m=[];for(let a=0;a<i.length;++a){let w=i[a],S=a===i.length-1,M=d==="/"?t:t.slice(d.length)||"/",P=pE({path:w.relativePath,caseSensitive:w.caseSensitive,end:S},M),N=w.route;if(!P&&S&&n&&!i[i.length-1].route.index&&(P=pE({path:w.relativePath,caseSensitive:w.caseSensitive,end:!1},M)),!P)return null;Object.assign(c,P.params),m.push({params:c,pathname:Im([d,P.pathname]),pathnameBase:Xre(Im([d,P.pathnameBase])),route:N}),P.pathnameBase!=="/"&&(d=Im([d,P.pathnameBase]))}return m}function pE(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=$re(e.path,e.caseSensitive,e.end),c=t.match(n);if(!c)return null;let d=c[0],m=d.replace(/(.)\/+$/,"$1"),a=c.slice(1);return{params:i.reduce((S,{paramName:M,isOptional:P},N)=>{if(M==="*"){let G=a[N]||"";m=d.slice(0,d.length-G.length).replace(/(.)\/+$/,"$1")}const $=a[N];return P&&!$?S[M]=void 0:S[M]=($||"").replace(/%2F/g,"/"),S},{}),pathname:d,pathnameBase:m,pattern:e}}function $re(e,t=!1,n=!0){pp(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,a,w)=>(i.push({paramName:a,isOptional:w!=null}),w?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,t?void 0:"i"),i]}function qre(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return pp(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Nm(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function Hre(e,t="/"){let{pathname:n,search:i="",hash:c=""}=typeof e=="string"?m0(e):e;return{pathname:n?n.startsWith("/")?n:Gre(n,t):t,search:Zre(i),hash:Yre(c)}}function Gre(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?n.length>1&&n.pop():c!=="."&&n.push(c)}),n.length>1?n.join("/"):"/"}function RM(e,t,n,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Wre(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function bG(e){let t=Wre(e);return t.map((n,i)=>i===t.length-1?n.pathname:n.pathnameBase)}function wG(e,t,n,i=!1){let c;typeof e=="string"?c=m0(e):(c={...e},os(!c.pathname||!c.pathname.includes("?"),RM("?","pathname","search",c)),os(!c.pathname||!c.pathname.includes("#"),RM("#","pathname","hash",c)),os(!c.search||!c.search.includes("#"),RM("#","search","hash",c)));let d=e===""||c.pathname==="",m=d?"/":c.pathname,a;if(m==null)a=n;else{let P=t.length-1;if(!i&&m.startsWith("..")){let N=m.split("/");for(;N[0]==="..";)N.shift(),P-=1;c.pathname=N.join("/")}a=P>=0?t[P]:"/"}let w=Hre(c,a),S=m&&m!=="/"&&m.endsWith("/"),M=(d||m===".")&&n.endsWith("/");return!w.pathname.endsWith("/")&&(S||M)&&(w.pathname+="/"),w}var Im=e=>e.join("/").replace(/\/\/+/g,"/"),Xre=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zre=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Yre=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Kre(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var SG=["POST","PUT","PATCH","DELETE"];new Set(SG);var Jre=["GET",...SG];new Set(Jre);var g0=K.createContext(null);g0.displayName="DataRouter";var GA=K.createContext(null);GA.displayName="DataRouterState";K.createContext(!1);var TG=K.createContext({isTransitioning:!1});TG.displayName="ViewTransition";var Qre=K.createContext(new Map);Qre.displayName="Fetchers";var eie=K.createContext(null);eie.displayName="Await";var vp=K.createContext(null);vp.displayName="Navigation";var O1=K.createContext(null);O1.displayName="Location";var Qd=K.createContext({outlet:null,matches:[],isDataRoute:!1});Qd.displayName="Route";var WL=K.createContext(null);WL.displayName="RouteError";function tie(e,{relative:t}={}){os(R1(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=K.useContext(vp),{hash:c,pathname:d,search:m}=D1(e,{relative:t}),a=d;return n!=="/"&&(a=d==="/"?n:Im([n,d])),i.createHref({pathname:a,search:m,hash:c})}function R1(){return K.useContext(O1)!=null}function my(){return os(R1(),"useLocation() may be used only in the context of a <Router> component."),K.useContext(O1).location}var EG="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function AG(e){K.useContext(vp).static||K.useLayoutEffect(e)}function I1(){let{isDataRoute:e}=K.useContext(Qd);return e?gie():nie()}function nie(){os(R1(),"useNavigate() may be used only in the context of a <Router> component.");let e=K.useContext(g0),{basename:t,navigator:n}=K.useContext(vp),{matches:i}=K.useContext(Qd),{pathname:c}=my(),d=JSON.stringify(bG(i)),m=K.useRef(!1);return AG(()=>{m.current=!0}),K.useCallback((w,S={})=>{if(pp(m.current,EG),!m.current)return;if(typeof w=="number"){n.go(w);return}let M=wG(w,JSON.parse(d),c,S.relative==="path");e==null&&t!=="/"&&(M.pathname=M.pathname==="/"?t:Im([t,M.pathname])),(S.replace?n.replace:n.push)(M,S.state,S)},[t,n,d,c,e])}var CG=K.createContext(null);function rie(){return K.useContext(CG)}function iie(e){let t=K.useContext(Qd).outlet;return t&&K.createElement(CG.Provider,{value:e},t)}function WA(){let{matches:e}=K.useContext(Qd),t=e[e.length-1];return t?t.params:{}}function D1(e,{relative:t}={}){let{matches:n}=K.useContext(Qd),{pathname:i}=my(),c=JSON.stringify(bG(n));return K.useMemo(()=>wG(e,JSON.parse(c),i,t==="path"),[e,c,i,t])}function aie(e,t){return MG(e,t)}function MG(e,t,n,i,c){os(R1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=K.useContext(vp),{matches:m}=K.useContext(Qd),a=m[m.length-1],w=a?a.params:{},S=a?a.pathname:"/",M=a?a.pathnameBase:"/",P=a&&a.route;{let ee=P&&P.path||"";PG(S,!P||ee.endsWith("*")||ee.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${S}" (under <Route path="${ee}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ee}"> to <Route path="${ee==="/"?"*":`${ee}/*`}">.`)}let N=my(),$;if(t){let ee=typeof t=="string"?m0(t):t;os(M==="/"||ee.pathname?.startsWith(M),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${M}" but pathname "${ee.pathname}" was given in the \`location\` prop.`),$=ee}else $=N;let G=$.pathname||"/",q=G;if(M!=="/"){let ee=M.replace(/^\//,"").split("/");q="/"+G.replace(/^\//,"").split("/").slice(ee.length).join("/")}let V=_G(e,{pathname:q});pp(P||V!=null,`No routes matched location "${$.pathname}${$.search}${$.hash}" `),pp(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${$.pathname}${$.search}${$.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let J=uie(V&&V.map(ee=>Object.assign({},ee,{params:Object.assign({},w,ee.params),pathname:Im([M,d.encodeLocation?d.encodeLocation(ee.pathname).pathname:ee.pathname]),pathnameBase:ee.pathnameBase==="/"?M:Im([M,d.encodeLocation?d.encodeLocation(ee.pathnameBase).pathname:ee.pathnameBase])})),m,n,i,c);return t&&J?K.createElement(O1.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...$},navigationType:"POP"}},J):J}function oie(){let e=mie(),t=Kre(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:i},d={padding:"2px 4px",backgroundColor:i},m=null;return console.error("Error handled by React Router default ErrorBoundary:",e),m=K.createElement(K.Fragment,null,K.createElement("p",null," Hey developer "),K.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",K.createElement("code",{style:d},"ErrorBoundary")," or"," ",K.createElement("code",{style:d},"errorElement")," prop on your route.")),K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},t),n?K.createElement("pre",{style:c},n):null,m)}var sie=K.createElement(oie,null),lie=class extends K.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?K.createElement(Qd.Provider,{value:this.props.routeContext},K.createElement(WL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function cie({routeContext:e,match:t,children:n}){let i=K.useContext(g0);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),K.createElement(Qd.Provider,{value:e},n)}function uie(e,t=[],n=null,i=null,c=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let d=e,m=n?.errors;if(m!=null){let S=d.findIndex(M=>M.route.id&&m?.[M.route.id]!==void 0);os(S>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(m).join(",")}`),d=d.slice(0,Math.min(d.length,S+1))}let a=!1,w=-1;if(n)for(let S=0;S<d.length;S++){let M=d[S];if((M.route.HydrateFallback||M.route.hydrateFallbackElement)&&(w=S),M.route.id){let{loaderData:P,errors:N}=n,$=M.route.loader&&!P.hasOwnProperty(M.route.id)&&(!N||N[M.route.id]===void 0);if(M.route.lazy||$){a=!0,w>=0?d=d.slice(0,w+1):d=[d[0]];break}}}return d.reduceRight((S,M,P)=>{let N,$=!1,G=null,q=null;n&&(N=m&&M.route.id?m[M.route.id]:void 0,G=M.route.errorElement||sie,a&&(w<0&&P===0?(PG("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,q=null):w===P&&($=!0,q=M.route.hydrateFallbackElement||null)));let V=t.concat(d.slice(0,P+1)),J=()=>{let ee;return N?ee=G:$?ee=q:M.route.Component?ee=K.createElement(M.route.Component,null):M.route.element?ee=M.route.element:ee=S,K.createElement(cie,{match:M,routeContext:{outlet:S,matches:V,isDataRoute:n!=null},children:ee})};return n&&(M.route.ErrorBoundary||M.route.errorElement||P===0)?K.createElement(lie,{location:n.location,revalidation:n.revalidation,component:G,error:N,children:J(),routeContext:{outlet:null,matches:V,isDataRoute:!0},unstable_onError:i}):J()},null)}function XL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hie(e){let t=K.useContext(g0);return os(t,XL(e)),t}function die(e){let t=K.useContext(GA);return os(t,XL(e)),t}function fie(e){let t=K.useContext(Qd);return os(t,XL(e)),t}function ZL(e){let t=fie(e),n=t.matches[t.matches.length-1];return os(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function pie(){return ZL("useRouteId")}function mie(){let e=K.useContext(WL),t=die("useRouteError"),n=ZL("useRouteError");return e!==void 0?e:t.errors?.[n]}function gie(){let{router:e}=hie("useNavigate"),t=ZL("useNavigate"),n=K.useRef(!1);return AG(()=>{n.current=!0}),K.useCallback(async(c,d={})=>{pp(n.current,EG),n.current&&(typeof c=="number"?e.navigate(c):await e.navigate(c,{fromRouteId:t,...d}))},[e,t])}var CF={};function PG(e,t,n){!t&&!CF[e]&&(CF[e]=!0,pp(!1,n))}K.memo(yie);function yie({routes:e,future:t,state:n,unstable_onError:i}){return MG(e,void 0,n,i,t)}function OG(e){return iie(e.context)}function Bs(e){os(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _ie({basename:e="/",children:t=null,location:n,navigationType:i="POP",navigator:c,static:d=!1}){os(!R1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=e.replace(/^\/*/,"/"),a=K.useMemo(()=>({basename:m,navigator:c,static:d,future:{}}),[m,c,d]);typeof n=="string"&&(n=m0(n));let{pathname:w="/",search:S="",hash:M="",state:P=null,key:N="default"}=n,$=K.useMemo(()=>{let G=Nm(w,m);return G==null?null:{location:{pathname:G,search:S,hash:M,state:P,key:N},navigationType:i}},[m,w,S,M,P,N,i]);return pp($!=null,`<Router basename="${m}"> is not able to match the URL "${w}${S}${M}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:K.createElement(vp.Provider,{value:a},K.createElement(O1.Provider,{children:t,value:$}))}function vie({children:e,location:t}){return aie(RD(e),t)}function RD(e,t=[]){let n=[];return K.Children.forEach(e,(i,c)=>{if(!K.isValidElement(i))return;let d=[...t,c];if(i.type===K.Fragment){n.push.apply(n,RD(i.props.children,d));return}os(i.type===Bs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),os(!i.props.index||!i.props.children,"An index route cannot have child routes.");let m={id:i.props.id||d.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(m.children=RD(i.props.children,d)),n.push(m)}),n}var eE="get",tE="application/x-www-form-urlencoded";function XA(e){return e!=null&&typeof e.tagName=="string"}function xie(e){return XA(e)&&e.tagName.toLowerCase()==="button"}function bie(e){return XA(e)&&e.tagName.toLowerCase()==="form"}function wie(e){return XA(e)&&e.tagName.toLowerCase()==="input"}function Sie(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Tie(e,t){return e.button===0&&(!t||t==="_self")&&!Sie(e)}var ET=null;function Eie(){if(ET===null)try{new FormData(document.createElement("form"),0),ET=!1}catch{ET=!0}return ET}var Aie=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function IM(e){return e!=null&&!Aie.has(e)?(pp(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${tE}"`),null):e}function Cie(e,t){let n,i,c,d,m;if(bie(e)){let a=e.getAttribute("action");i=a?Nm(a,t):null,n=e.getAttribute("method")||eE,c=IM(e.getAttribute("enctype"))||tE,d=new FormData(e)}else if(xie(e)||wie(e)&&(e.type==="submit"||e.type==="image")){let a=e.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let w=e.getAttribute("formaction")||a.getAttribute("action");if(i=w?Nm(w,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||eE,c=IM(e.getAttribute("formenctype"))||IM(a.getAttribute("enctype"))||tE,d=new FormData(a,e),!Eie()){let{name:S,type:M,value:P}=e;if(M==="image"){let N=S?`${S}.`:"";d.append(`${N}x`,"0"),d.append(`${N}y`,"0")}else S&&d.append(S,P)}}else{if(XA(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=eE,i=null,c=tE,m=e}return d&&c==="text/plain"&&(m=d,d=void 0),{action:i,method:n.toLowerCase(),encType:c,formData:d,body:m}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function YL(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Mie(e,t,n){let i=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return i.pathname==="/"?i.pathname=`_root.${n}`:t&&Nm(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function Pie(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Oie(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Rie(e,t,n){let i=await Promise.all(e.map(async c=>{let d=t.routes[c.route.id];if(d){let m=await Pie(d,n);return m.links?m.links():[]}return[]}));return Lie(i.flat(1).filter(Oie).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function MF(e,t,n,i,c,d){let m=(w,S)=>n[S]?w.route.id!==n[S].route.id:!0,a=(w,S)=>n[S].pathname!==w.pathname||n[S].route.path?.endsWith("*")&&n[S].params["*"]!==w.params["*"];return d==="assets"?t.filter((w,S)=>m(w,S)||a(w,S)):d==="data"?t.filter((w,S)=>{let M=i.routes[w.route.id];if(!M||!M.hasLoader)return!1;if(m(w,S)||a(w,S))return!0;if(w.route.shouldRevalidate){let P=w.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:w.params,defaultShouldRevalidate:!0});if(typeof P=="boolean")return P}return!0}):[]}function Iie(e,t,{includeHydrateFallback:n}={}){return Die(e.map(i=>{let c=t.routes[i.route.id];if(!c)return[];let d=[c.module];return c.clientActionModule&&(d=d.concat(c.clientActionModule)),c.clientLoaderModule&&(d=d.concat(c.clientLoaderModule)),n&&c.hydrateFallbackModule&&(d=d.concat(c.hydrateFallbackModule)),c.imports&&(d=d.concat(c.imports)),d}).flat(1))}function Die(e){return[...new Set(e)]}function kie(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}function Lie(e,t){let n=new Set;return new Set(t),e.reduce((i,c)=>{let d=JSON.stringify(kie(c));return n.has(d)||(n.add(d),i.push({key:d,link:c})),i},[])}function RG(){let e=K.useContext(g0);return YL(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Nie(){let e=K.useContext(GA);return YL(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var KL=K.createContext(void 0);KL.displayName="FrameworkContext";function IG(){let e=K.useContext(KL);return YL(e,"You must render this element inside a <HydratedRouter> element"),e}function zie(e,t){let n=K.useContext(KL),[i,c]=K.useState(!1),[d,m]=K.useState(!1),{onFocus:a,onBlur:w,onMouseEnter:S,onMouseLeave:M,onTouchStart:P}=t,N=K.useRef(null);K.useEffect(()=>{if(e==="render"&&m(!0),e==="viewport"){let q=J=>{J.forEach(ee=>{m(ee.isIntersecting)})},V=new IntersectionObserver(q,{threshold:.5});return N.current&&V.observe(N.current),()=>{V.disconnect()}}},[e]),K.useEffect(()=>{if(i){let q=setTimeout(()=>{m(!0)},100);return()=>{clearTimeout(q)}}},[i]);let $=()=>{c(!0)},G=()=>{c(!1),m(!1)};return n?e!=="intent"?[d,N,{}]:[d,N,{onFocus:Zb(a,$),onBlur:Zb(w,G),onMouseEnter:Zb(S,$),onMouseLeave:Zb(M,G),onTouchStart:Zb(P,$)}]:[!1,N,{}]}function Zb(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function jie({page:e,...t}){let{router:n}=RG(),i=K.useMemo(()=>_G(n.routes,e,n.basename),[n.routes,e,n.basename]);return i?K.createElement(Fie,{page:e,matches:i,...t}):null}function Bie(e){let{manifest:t,routeModules:n}=IG(),[i,c]=K.useState([]);return K.useEffect(()=>{let d=!1;return Rie(e,t,n).then(m=>{d||c(m)}),()=>{d=!0}},[e,t,n]),i}function Fie({page:e,matches:t,...n}){let i=my(),{manifest:c,routeModules:d}=IG(),{basename:m}=RG(),{loaderData:a,matches:w}=Nie(),S=K.useMemo(()=>MF(e,t,w,c,i,"data"),[e,t,w,c,i]),M=K.useMemo(()=>MF(e,t,w,c,i,"assets"),[e,t,w,c,i]),P=K.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let G=new Set,q=!1;if(t.forEach(J=>{let ee=c.routes[J.route.id];!ee||!ee.hasLoader||(!S.some(re=>re.route.id===J.route.id)&&J.route.id in a&&d[J.route.id]?.shouldRevalidate||ee.hasClientLoader?q=!0:G.add(J.route.id))}),G.size===0)return[];let V=Mie(e,m,"data");return q&&G.size>0&&V.searchParams.set("_routes",t.filter(J=>G.has(J.route.id)).map(J=>J.route.id).join(",")),[V.pathname+V.search]},[m,a,i,c,S,t,e,d]),N=K.useMemo(()=>Iie(M,c),[M,c]),$=Bie(M);return K.createElement(K.Fragment,null,P.map(G=>K.createElement("link",{key:G,rel:"prefetch",as:"fetch",href:G,...n})),N.map(G=>K.createElement("link",{key:G,rel:"modulepreload",href:G,...n})),$.map(({key:G,link:q})=>K.createElement("link",{key:G,nonce:n.nonce,...q})))}function Vie(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var DG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{DG&&(window.__reactRouterVersion="7.8.2")}catch{}function Uie({basename:e,children:t,window:n}){let i=K.useRef();i.current==null&&(i.current=Mre({window:n,v5Compat:!0}));let c=i.current,[d,m]=K.useState({action:c.action,location:c.location}),a=K.useCallback(w=>{K.startTransition(()=>m(w))},[m]);return K.useLayoutEffect(()=>c.listen(a),[c,a]),K.createElement(_ie,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c})}var kG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fc=K.forwardRef(function({onClick:t,discover:n="render",prefetch:i="none",relative:c,reloadDocument:d,replace:m,state:a,target:w,to:S,preventScrollReset:M,viewTransition:P,...N},$){let{basename:G}=K.useContext(vp),q=typeof S=="string"&&kG.test(S),V,J=!1;if(typeof S=="string"&&q&&(V=S,DG))try{let De=new URL(window.location.href),Ye=S.startsWith("//")?new URL(De.protocol+S):new URL(S),ze=Nm(Ye.pathname,G);Ye.origin===De.origin&&ze!=null?S=ze+Ye.search+Ye.hash:J=!0}catch{pp(!1,`<Link to="${S}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ee=tie(S,{relative:c}),[re,fe,ne]=zie(i,N),ce=Gie(S,{replace:m,state:a,target:w,preventScrollReset:M,relative:c,viewTransition:P});function me(De){t&&t(De),De.defaultPrevented||ce(De)}let ve=K.createElement("a",{...N,...ne,href:V||ee,onClick:J||d?t:me,ref:Vie($,fe),target:w,"data-discover":!q&&n==="render"?"true":void 0});return re&&!q?K.createElement(K.Fragment,null,ve,K.createElement(jie,{page:ee})):ve});fc.displayName="Link";var $ie=K.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:i="",end:c=!1,style:d,to:m,viewTransition:a,children:w,...S},M){let P=D1(m,{relative:S.relative}),N=my(),$=K.useContext(GA),{navigator:G,basename:q}=K.useContext(vp),V=$!=null&&Kie(P)&&a===!0,J=G.encodeLocation?G.encodeLocation(P).pathname:P.pathname,ee=N.pathname,re=$&&$.navigation&&$.navigation.location?$.navigation.location.pathname:null;n||(ee=ee.toLowerCase(),re=re?re.toLowerCase():null,J=J.toLowerCase()),re&&q&&(re=Nm(re,q)||re);const fe=J!=="/"&&J.endsWith("/")?J.length-1:J.length;let ne=ee===J||!c&&ee.startsWith(J)&&ee.charAt(fe)==="/",ce=re!=null&&(re===J||!c&&re.startsWith(J)&&re.charAt(J.length)==="/"),me={isActive:ne,isPending:ce,isTransitioning:V},ve=ne?t:void 0,De;typeof i=="function"?De=i(me):De=[i,ne?"active":null,ce?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let Ye=typeof d=="function"?d(me):d;return K.createElement(fc,{...S,"aria-current":ve,className:De,ref:M,style:Ye,to:m,viewTransition:a},typeof w=="function"?w(me):w)});$ie.displayName="NavLink";var qie=K.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:i,replace:c,state:d,method:m=eE,action:a,onSubmit:w,relative:S,preventScrollReset:M,viewTransition:P,...N},$)=>{let G=Zie(),q=Yie(a,{relative:S}),V=m.toLowerCase()==="get"?"get":"post",J=typeof a=="string"&&kG.test(a),ee=re=>{if(w&&w(re),re.defaultPrevented)return;re.preventDefault();let fe=re.nativeEvent.submitter,ne=fe?.getAttribute("formmethod")||m;G(fe||re.currentTarget,{fetcherKey:t,method:ne,navigate:n,replace:c,state:d,relative:S,preventScrollReset:M,viewTransition:P})};return K.createElement("form",{ref:$,method:V,action:q,onSubmit:i?w:ee,...N,"data-discover":!J&&e==="render"?"true":void 0})});qie.displayName="Form";function Hie(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LG(e){let t=K.useContext(g0);return os(t,Hie(e)),t}function Gie(e,{target:t,replace:n,state:i,preventScrollReset:c,relative:d,viewTransition:m}={}){let a=I1(),w=my(),S=D1(e,{relative:d});return K.useCallback(M=>{if(Tie(M,t)){M.preventDefault();let P=n!==void 0?n:Dw(w)===Dw(S);a(e,{replace:P,state:i,preventScrollReset:c,relative:d,viewTransition:m})}},[w,a,S,n,i,t,e,c,d,m])}var Wie=0,Xie=()=>`__${String(++Wie)}__`;function Zie(){let{router:e}=LG("useSubmit"),{basename:t}=K.useContext(vp),n=pie();return K.useCallback(async(i,c={})=>{let{action:d,method:m,encType:a,formData:w,body:S}=Cie(i,t);if(c.navigate===!1){let M=c.fetcherKey||Xie();await e.fetch(M,n,c.action||d,{preventScrollReset:c.preventScrollReset,formData:w,body:S,formMethod:c.method||m,formEncType:c.encType||a,flushSync:c.flushSync})}else await e.navigate(c.action||d,{preventScrollReset:c.preventScrollReset,formData:w,body:S,formMethod:c.method||m,formEncType:c.encType||a,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[e,t,n])}function Yie(e,{relative:t}={}){let{basename:n}=K.useContext(vp),i=K.useContext(Qd);os(i,"useFormAction must be used inside a RouteContext");let[c]=i.matches.slice(-1),d={...D1(e||".",{relative:t})},m=my();if(e==null){d.search=m.search;let a=new URLSearchParams(d.search),w=a.getAll("index");if(w.some(M=>M==="")){a.delete("index"),w.filter(P=>P).forEach(P=>a.append("index",P));let M=a.toString();d.search=M?`?${M}`:""}}return(!e||e===".")&&c.route.index&&(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(d.pathname=d.pathname==="/"?n:Im([n,d.pathname])),Dw(d)}function Kie(e,{relative:t}={}){let n=K.useContext(TG);os(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=LG("useViewTransitionState"),c=D1(e,{relative:t});if(!n.isTransitioning)return!1;let d=Nm(n.currentLocation.pathname,i)||n.currentLocation.pathname,m=Nm(n.nextLocation.pathname,i)||n.nextLocation.pathname;return pE(c.pathname,m)!=null||pE(c.pathname,d)!=null}var k1=yG();const NG=Wa(k1);var Jie=(e,t,n,i,c,d,m,a)=>{let w=document.documentElement,S=["light","dark"];function M($){(Array.isArray(e)?e:[e]).forEach(G=>{let q=G==="class",V=q&&d?c.map(J=>d[J]||J):c;q?(w.classList.remove(...V),w.classList.add(d&&d[$]?d[$]:$)):w.setAttribute(G,$)}),P($)}function P($){a&&S.includes($)&&(w.style.colorScheme=$)}function N(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(i)M(i);else try{let $=localStorage.getItem(t)||n,G=m&&$==="system"?N():$;M(G)}catch{}},Qie=K.createContext(void 0),eae={setTheme:e=>{},themes:[]},tae=()=>{var e;return(e=K.useContext(Qie))!=null?e:eae};K.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:i,enableColorScheme:c,defaultTheme:d,value:m,themes:a,nonce:w,scriptProps:S})=>{let M=JSON.stringify([n,t,d,e,a,m,i,c]).slice(1,-1);return K.createElement("script",{...S,suppressHydrationWarning:!0,nonce:typeof window>"u"?w:"",dangerouslySetInnerHTML:{__html:`(${Jie.toString()})(${M})`}})});function nae(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const rae=e=>{switch(e){case"success":return oae;case"info":return lae;case"warning":return sae;case"error":return cae;default:return null}},iae=Array(12).fill(0),aae=({visible:e,className:t})=>Ce.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Ce.createElement("div",{className:"sonner-spinner"},iae.map((n,i)=>Ce.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),oae=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),sae=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),lae=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),cae=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ce.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),uae=Ce.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ce.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ce.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),hae=()=>{const[e,t]=Ce.useState(document.hidden);return Ce.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let ID=1;class dae{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:i,...c}=t,d=typeof t?.id=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:ID++,m=this.toasts.find(w=>w.id===d),a=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(d)&&this.dismissedToasts.delete(d),m?this.toasts=this.toasts.map(w=>w.id===d?(this.publish({...w,...t,id:d,title:i}),{...w,...t,id:d,dismissible:a,title:i}):w):this.addToast({title:i,...c,dismissible:a,id:d}),d},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(i=>i({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let i;n.loading!==void 0&&(i=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const c=Promise.resolve(t instanceof Function?t():t);let d=i!==void 0,m;const a=c.then(async S=>{if(m=["resolve",S],Ce.isValidElement(S))d=!1,this.create({id:i,type:"default",message:S});else if(pae(S)&&!S.ok){d=!1;const P=typeof n.error=="function"?await n.error(`HTTP error! status: ${S.status}`):n.error,N=typeof n.description=="function"?await n.description(`HTTP error! status: ${S.status}`):n.description,G=typeof P=="object"&&!Ce.isValidElement(P)?P:{message:P};this.create({id:i,type:"error",description:N,...G})}else if(S instanceof Error){d=!1;const P=typeof n.error=="function"?await n.error(S):n.error,N=typeof n.description=="function"?await n.description(S):n.description,G=typeof P=="object"&&!Ce.isValidElement(P)?P:{message:P};this.create({id:i,type:"error",description:N,...G})}else if(n.success!==void 0){d=!1;const P=typeof n.success=="function"?await n.success(S):n.success,N=typeof n.description=="function"?await n.description(S):n.description,G=typeof P=="object"&&!Ce.isValidElement(P)?P:{message:P};this.create({id:i,type:"success",description:N,...G})}}).catch(async S=>{if(m=["reject",S],n.error!==void 0){d=!1;const M=typeof n.error=="function"?await n.error(S):n.error,P=typeof n.description=="function"?await n.description(S):n.description,$=typeof M=="object"&&!Ce.isValidElement(M)?M:{message:M};this.create({id:i,type:"error",description:P,...$})}}).finally(()=>{d&&(this.dismiss(i),i=void 0),n.finally==null||n.finally.call(n)}),w=()=>new Promise((S,M)=>a.then(()=>m[0]==="reject"?M(m[1]):S(m[1])).catch(M));return typeof i!="string"&&typeof i!="number"?{unwrap:w}:Object.assign(i,{unwrap:w})},this.custom=(t,n)=>{const i=n?.id||ID++;return this.create({jsx:t(i),id:i,...n}),i},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const au=new dae,fae=(e,t)=>{const n=t?.id||ID++;return au.addToast({title:e,...t,id:n}),n},pae=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",mae=fae,gae=()=>au.toasts,yae=()=>au.getActiveToasts(),ua=Object.assign(mae,{success:au.success,info:au.info,warning:au.warning,error:au.error,custom:au.custom,message:au.message,promise:au.promise,dismiss:au.dismiss,loading:au.loading},{getHistory:gae,getToasts:yae});nae("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function AT(e){return e.label!==void 0}const _ae=3,vae="24px",xae="16px",PF=4e3,bae=356,wae=14,Sae=45,Tae=200;function Jf(...e){return e.filter(Boolean).join(" ")}function Eae(e){const[t,n]=e.split("-"),i=[];return t&&i.push(t),n&&i.push(n),i}const Aae=e=>{var t,n,i,c,d,m,a,w,S;const{invert:M,toast:P,unstyled:N,interacting:$,setHeights:G,visibleToasts:q,heights:V,index:J,toasts:ee,expanded:re,removeToast:fe,defaultRichColors:ne,closeButton:ce,style:me,cancelButtonStyle:ve,actionButtonStyle:De,className:Ye="",descriptionClassName:ze="",duration:tt,position:at,gap:ct,expandByDefault:ht,classNames:Ie,icons:rt,closeButtonAriaLabel:Qe="Close toast"}=e,[St,qe]=Ce.useState(null),[vt,nt]=Ce.useState(null),[gt,Ut]=Ce.useState(!1),[$t,qt]=Ce.useState(!1),[Ht,mn]=Ce.useState(!1),[en,En]=Ce.useState(!1),[Xn,cn]=Ce.useState(!1),[Jr,mr]=Ce.useState(0),[Cr,li]=Ce.useState(0),hi=Ce.useRef(P.duration||tt||PF),so=Ce.useRef(null),ra=Ce.useRef(null),xt=J===0,Bt=J+1<=q,tn=P.type,$n=P.dismissible!==!1,qn=P.className||"",An=P.descriptionClassName||"",tr=Ce.useMemo(()=>V.findIndex(dr=>dr.toastId===P.id)||0,[V,P.id]),Ir=Ce.useMemo(()=>{var dr;return(dr=P.closeButton)!=null?dr:ce},[P.closeButton,ce]),mi=Ce.useMemo(()=>P.duration||tt||PF,[P.duration,tt]),Mi=Ce.useRef(0),_o=Ce.useRef(0),oa=Ce.useRef(0),Ua=Ce.useRef(null),[lo,eo]=at.split("-"),co=Ce.useMemo(()=>V.reduce((dr,kt,Dr)=>Dr>=tr?dr:dr+kt.height,0),[V,tr]),vo=hae(),ss=P.invert||M,ir=tn==="loading";_o.current=Ce.useMemo(()=>tr*ct+co,[tr,co]),Ce.useEffect(()=>{hi.current=mi},[mi]),Ce.useEffect(()=>{Ut(!0)},[]),Ce.useEffect(()=>{const dr=ra.current;if(dr){const kt=dr.getBoundingClientRect().height;return li(kt),G(Dr=>[{toastId:P.id,height:kt,position:P.position},...Dr]),()=>G(Dr=>Dr.filter(to=>to.toastId!==P.id))}},[G,P.id]),Ce.useLayoutEffect(()=>{if(!gt)return;const dr=ra.current,kt=dr.style.height;dr.style.height="auto";const Dr=dr.getBoundingClientRect().height;dr.style.height=kt,li(Dr),G(to=>to.find(hr=>hr.toastId===P.id)?to.map(hr=>hr.toastId===P.id?{...hr,height:Dr}:hr):[{toastId:P.id,height:Dr,position:P.position},...to])},[gt,P.title,P.description,G,P.id,P.jsx,P.action,P.cancel]);const xi=Ce.useCallback(()=>{qt(!0),mr(_o.current),G(dr=>dr.filter(kt=>kt.toastId!==P.id)),setTimeout(()=>{fe(P)},Tae)},[P,fe,G,_o]);Ce.useEffect(()=>{if(P.promise&&tn==="loading"||P.duration===1/0||P.type==="loading")return;let dr;return re||$||vo?(()=>{if(oa.current<Mi.current){const to=new Date().getTime()-Mi.current;hi.current=hi.current-to}oa.current=new Date().getTime()})():(()=>{hi.current!==1/0&&(Mi.current=new Date().getTime(),dr=setTimeout(()=>{P.onAutoClose==null||P.onAutoClose.call(P,P),xi()},hi.current))})(),()=>clearTimeout(dr)},[re,$,P,tn,vo,xi]),Ce.useEffect(()=>{P.delete&&(xi(),P.onDismiss==null||P.onDismiss.call(P,P))},[xi,P.delete]);function ci(){var dr;if(rt?.loading){var kt;return Ce.createElement("div",{className:Jf(Ie?.loader,P==null||(kt=P.classNames)==null?void 0:kt.loader,"sonner-loader"),"data-visible":tn==="loading"},rt.loading)}return Ce.createElement(aae,{className:Jf(Ie?.loader,P==null||(dr=P.classNames)==null?void 0:dr.loader),visible:tn==="loading"})}const Ra=P.icon||rt?.[tn]||rae(tn);var ya,Tl;return Ce.createElement("li",{tabIndex:0,ref:ra,className:Jf(Ye,qn,Ie?.toast,P==null||(t=P.classNames)==null?void 0:t.toast,Ie?.default,Ie?.[tn],P==null||(n=P.classNames)==null?void 0:n[tn]),"data-sonner-toast":"","data-rich-colors":(ya=P.richColors)!=null?ya:ne,"data-styled":!(P.jsx||P.unstyled||N),"data-mounted":gt,"data-promise":!!P.promise,"data-swiped":Xn,"data-removed":$t,"data-visible":Bt,"data-y-position":lo,"data-x-position":eo,"data-index":J,"data-front":xt,"data-swiping":Ht,"data-dismissible":$n,"data-type":tn,"data-invert":ss,"data-swipe-out":en,"data-swipe-direction":vt,"data-expanded":!!(re||ht&&gt),"data-testid":P.testId,style:{"--index":J,"--toasts-before":J,"--z-index":ee.length-J,"--offset":`${$t?Jr:_o.current}px`,"--initial-height":ht?"auto":`${Cr}px`,...me,...P.style},onDragEnd:()=>{mn(!1),qe(null),Ua.current=null},onPointerDown:dr=>{dr.button!==2&&(ir||!$n||(so.current=new Date,mr(_o.current),dr.target.setPointerCapture(dr.pointerId),dr.target.tagName!=="BUTTON"&&(mn(!0),Ua.current={x:dr.clientX,y:dr.clientY})))},onPointerUp:()=>{var dr,kt,Dr;if(en||!$n)return;Ua.current=null;const to=Number(((dr=ra.current)==null?void 0:dr.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Hs=Number(((kt=ra.current)==null?void 0:kt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),hr=new Date().getTime()-((Dr=so.current)==null?void 0:Dr.getTime()),ot=St==="x"?to:Hs,he=Math.abs(ot)/hr;if(Math.abs(ot)>=Sae||he>.11){mr(_o.current),P.onDismiss==null||P.onDismiss.call(P,P),nt(St==="x"?to>0?"right":"left":Hs>0?"down":"up"),xi(),En(!0);return}else{var ye,Ae;(ye=ra.current)==null||ye.style.setProperty("--swipe-amount-x","0px"),(Ae=ra.current)==null||Ae.style.setProperty("--swipe-amount-y","0px")}cn(!1),mn(!1),qe(null)},onPointerMove:dr=>{var kt,Dr,to;if(!Ua.current||!$n||((kt=window.getSelection())==null?void 0:kt.toString().length)>0)return;const hr=dr.clientY-Ua.current.y,ot=dr.clientX-Ua.current.x;var he;const ye=(he=e.swipeDirections)!=null?he:Eae(at);!St&&(Math.abs(ot)>1||Math.abs(hr)>1)&&qe(Math.abs(ot)>Math.abs(hr)?"x":"y");let Ae={x:0,y:0};const He=Pe=>1/(1.5+Math.abs(Pe)/20);if(St==="y"){if(ye.includes("top")||ye.includes("bottom"))if(ye.includes("top")&&hr<0||ye.includes("bottom")&&hr>0)Ae.y=hr;else{const Pe=hr*He(hr);Ae.y=Math.abs(Pe)<Math.abs(hr)?Pe:hr}}else if(St==="x"&&(ye.includes("left")||ye.includes("right")))if(ye.includes("left")&&ot<0||ye.includes("right")&&ot>0)Ae.x=ot;else{const Pe=ot*He(ot);Ae.x=Math.abs(Pe)<Math.abs(ot)?Pe:ot}(Math.abs(Ae.x)>0||Math.abs(Ae.y)>0)&&cn(!0),(Dr=ra.current)==null||Dr.style.setProperty("--swipe-amount-x",`${Ae.x}px`),(to=ra.current)==null||to.style.setProperty("--swipe-amount-y",`${Ae.y}px`)}},Ir&&!P.jsx&&tn!=="loading"?Ce.createElement("button",{"aria-label":Qe,"data-disabled":ir,"data-close-button":!0,onClick:ir||!$n?()=>{}:()=>{xi(),P.onDismiss==null||P.onDismiss.call(P,P)},className:Jf(Ie?.closeButton,P==null||(i=P.classNames)==null?void 0:i.closeButton)},(Tl=rt?.close)!=null?Tl:uae):null,(tn||P.icon||P.promise)&&P.icon!==null&&(rt?.[tn]!==null||P.icon)?Ce.createElement("div",{"data-icon":"",className:Jf(Ie?.icon,P==null||(c=P.classNames)==null?void 0:c.icon)},P.promise||P.type==="loading"&&!P.icon?P.icon||ci():null,P.type!=="loading"?Ra:null):null,Ce.createElement("div",{"data-content":"",className:Jf(Ie?.content,P==null||(d=P.classNames)==null?void 0:d.content)},Ce.createElement("div",{"data-title":"",className:Jf(Ie?.title,P==null||(m=P.classNames)==null?void 0:m.title)},P.jsx?P.jsx:typeof P.title=="function"?P.title():P.title),P.description?Ce.createElement("div",{"data-description":"",className:Jf(ze,An,Ie?.description,P==null||(a=P.classNames)==null?void 0:a.description)},typeof P.description=="function"?P.description():P.description):null),Ce.isValidElement(P.cancel)?P.cancel:P.cancel&&AT(P.cancel)?Ce.createElement("button",{"data-button":!0,"data-cancel":!0,style:P.cancelButtonStyle||ve,onClick:dr=>{AT(P.cancel)&&$n&&(P.cancel.onClick==null||P.cancel.onClick.call(P.cancel,dr),xi())},className:Jf(Ie?.cancelButton,P==null||(w=P.classNames)==null?void 0:w.cancelButton)},P.cancel.label):null,Ce.isValidElement(P.action)?P.action:P.action&&AT(P.action)?Ce.createElement("button",{"data-button":!0,"data-action":!0,style:P.actionButtonStyle||De,onClick:dr=>{AT(P.action)&&(P.action.onClick==null||P.action.onClick.call(P.action,dr),!dr.defaultPrevented&&xi())},className:Jf(Ie?.actionButton,P==null||(S=P.classNames)==null?void 0:S.actionButton)},P.action.label):null)};function OF(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Cae(e,t){const n={};return[e,t].forEach((i,c)=>{const d=c===1,m=d?"--mobile-offset":"--offset",a=d?xae:vae;function w(S){["top","right","bottom","left"].forEach(M=>{n[`${m}-${M}`]=typeof S=="number"?`${S}px`:S})}typeof i=="number"||typeof i=="string"?w(i):typeof i=="object"?["top","right","bottom","left"].forEach(S=>{i[S]===void 0?n[`${m}-${S}`]=a:n[`${m}-${S}`]=typeof i[S]=="number"?`${i[S]}px`:i[S]}):w(a)}),n}const Mae=Ce.forwardRef(function(t,n){const{id:i,invert:c,position:d="bottom-right",hotkey:m=["altKey","KeyT"],expand:a,closeButton:w,className:S,offset:M,mobileOffset:P,theme:N="light",richColors:$,duration:G,style:q,visibleToasts:V=_ae,toastOptions:J,dir:ee=OF(),gap:re=wae,icons:fe,containerAriaLabel:ne="Notifications"}=t,[ce,me]=Ce.useState([]),ve=Ce.useMemo(()=>i?ce.filter(gt=>gt.toasterId===i):ce.filter(gt=>!gt.toasterId),[ce,i]),De=Ce.useMemo(()=>Array.from(new Set([d].concat(ve.filter(gt=>gt.position).map(gt=>gt.position)))),[ve,d]),[Ye,ze]=Ce.useState([]),[tt,at]=Ce.useState(!1),[ct,ht]=Ce.useState(!1),[Ie,rt]=Ce.useState(N!=="system"?N:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Qe=Ce.useRef(null),St=m.join("+").replace(/Key/g,"").replace(/Digit/g,""),qe=Ce.useRef(null),vt=Ce.useRef(!1),nt=Ce.useCallback(gt=>{me(Ut=>{var $t;return($t=Ut.find(qt=>qt.id===gt.id))!=null&&$t.delete||au.dismiss(gt.id),Ut.filter(({id:qt})=>qt!==gt.id)})},[]);return Ce.useEffect(()=>au.subscribe(gt=>{if(gt.dismiss){requestAnimationFrame(()=>{me(Ut=>Ut.map($t=>$t.id===gt.id?{...$t,delete:!0}:$t))});return}setTimeout(()=>{NG.flushSync(()=>{me(Ut=>{const $t=Ut.findIndex(qt=>qt.id===gt.id);return $t!==-1?[...Ut.slice(0,$t),{...Ut[$t],...gt},...Ut.slice($t+1)]:[gt,...Ut]})})})}),[ce]),Ce.useEffect(()=>{if(N!=="system"){rt(N);return}if(N==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?rt("dark"):rt("light")),typeof window>"u")return;const gt=window.matchMedia("(prefers-color-scheme: dark)");try{gt.addEventListener("change",({matches:Ut})=>{rt(Ut?"dark":"light")})}catch{gt.addListener(({matches:$t})=>{try{rt($t?"dark":"light")}catch(qt){console.error(qt)}})}},[N]),Ce.useEffect(()=>{ce.length<=1&&at(!1)},[ce]),Ce.useEffect(()=>{const gt=Ut=>{var $t;if(m.every(mn=>Ut[mn]||Ut.code===mn)){var Ht;at(!0),(Ht=Qe.current)==null||Ht.focus()}Ut.code==="Escape"&&(document.activeElement===Qe.current||($t=Qe.current)!=null&&$t.contains(document.activeElement))&&at(!1)};return document.addEventListener("keydown",gt),()=>document.removeEventListener("keydown",gt)},[m]),Ce.useEffect(()=>{if(Qe.current)return()=>{qe.current&&(qe.current.focus({preventScroll:!0}),qe.current=null,vt.current=!1)}},[Qe.current]),Ce.createElement("section",{ref:n,"aria-label":`${ne} ${St}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},De.map((gt,Ut)=>{var $t;const[qt,Ht]=gt.split("-");return ve.length?Ce.createElement("ol",{key:gt,dir:ee==="auto"?OF():ee,tabIndex:-1,ref:Qe,className:S,"data-sonner-toaster":!0,"data-sonner-theme":Ie,"data-y-position":qt,"data-x-position":Ht,style:{"--front-toast-height":`${(($t=Ye[0])==null?void 0:$t.height)||0}px`,"--width":`${bae}px`,"--gap":`${re}px`,...q,...Cae(M,P)},onBlur:mn=>{vt.current&&!mn.currentTarget.contains(mn.relatedTarget)&&(vt.current=!1,qe.current&&(qe.current.focus({preventScroll:!0}),qe.current=null))},onFocus:mn=>{mn.target instanceof HTMLElement&&mn.target.dataset.dismissible==="false"||vt.current||(vt.current=!0,qe.current=mn.relatedTarget)},onMouseEnter:()=>at(!0),onMouseMove:()=>at(!0),onMouseLeave:()=>{ct||at(!1)},onDragEnd:()=>at(!1),onPointerDown:mn=>{mn.target instanceof HTMLElement&&mn.target.dataset.dismissible==="false"||ht(!0)},onPointerUp:()=>ht(!1)},ve.filter(mn=>!mn.position&&Ut===0||mn.position===gt).map((mn,en)=>{var En,Xn;return Ce.createElement(Aae,{key:mn.id,icons:fe,index:en,toast:mn,defaultRichColors:$,duration:(En=J?.duration)!=null?En:G,className:J?.className,descriptionClassName:J?.descriptionClassName,invert:c,visibleToasts:V,closeButton:(Xn=J?.closeButton)!=null?Xn:w,interacting:ct,position:gt,style:J?.style,unstyled:J?.unstyled,classNames:J?.classNames,cancelButtonStyle:J?.cancelButtonStyle,actionButtonStyle:J?.actionButtonStyle,closeButtonAriaLabel:J?.closeButtonAriaLabel,removeToast:nt,toasts:ve.filter(cn=>cn.position==mn.position),heights:Ye.filter(cn=>cn.position==mn.position),setHeights:ze,expandByDefault:a,gap:re,expanded:tt,swipeDirections:t.swipeDirections})})):null}))}),Pae=({...e})=>{const{theme:t="system"}=tae();return D.jsx(Mae,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function zG(e,t){return function(){return e.apply(t,arguments)}}const{toString:Oae}=Object.prototype,{getPrototypeOf:JL}=Object,{iterator:ZA,toStringTag:jG}=Symbol,YA=(e=>t=>{const n=Oae.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ef=e=>(e=e.toLowerCase(),t=>YA(t)===e),KA=e=>t=>typeof t===e,{isArray:y0}=Array,Bx=KA("undefined");function L1(e){return e!==null&&!Bx(e)&&e.constructor!==null&&!Bx(e.constructor)&&uu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const BG=ef("ArrayBuffer");function Rae(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&BG(e.buffer),t}const Iae=KA("string"),uu=KA("function"),FG=KA("number"),N1=e=>e!==null&&typeof e=="object",Dae=e=>e===!0||e===!1,nE=e=>{if(YA(e)!=="object")return!1;const t=JL(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(jG in e)&&!(ZA in e)},kae=e=>{if(!N1(e)||L1(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Lae=ef("Date"),Nae=ef("File"),zae=ef("Blob"),jae=ef("FileList"),Bae=e=>N1(e)&&uu(e.pipe),Fae=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||uu(e.append)&&((t=YA(e))==="formdata"||t==="object"&&uu(e.toString)&&e.toString()==="[object FormData]"))},Vae=ef("URLSearchParams"),[Uae,$ae,qae,Hae]=["ReadableStream","Request","Response","Headers"].map(ef),Gae=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function z1(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let i,c;if(typeof e!="object"&&(e=[e]),y0(e))for(i=0,c=e.length;i<c;i++)t.call(null,e[i],i,e);else{if(L1(e))return;const d=n?Object.getOwnPropertyNames(e):Object.keys(e),m=d.length;let a;for(i=0;i<m;i++)a=d[i],t.call(null,e[a],a,e)}}function VG(e,t){if(L1(e))return null;t=t.toLowerCase();const n=Object.keys(e);let i=n.length,c;for(;i-- >0;)if(c=n[i],t===c.toLowerCase())return c;return null}const k_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,UG=e=>!Bx(e)&&e!==k_;function DD(){const{caseless:e,skipUndefined:t}=UG(this)&&this||{},n={},i=(c,d)=>{const m=e&&VG(n,d)||d;nE(n[m])&&nE(c)?n[m]=DD(n[m],c):nE(c)?n[m]=DD({},c):y0(c)?n[m]=c.slice():(!t||!Bx(c))&&(n[m]=c)};for(let c=0,d=arguments.length;c<d;c++)arguments[c]&&z1(arguments[c],i);return n}const Wae=(e,t,n,{allOwnKeys:i}={})=>(z1(t,(c,d)=>{n&&uu(c)?e[d]=zG(c,n):e[d]=c},{allOwnKeys:i}),e),Xae=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Zae=(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Yae=(e,t,n,i)=>{let c,d,m;const a={};if(t=t||{},e==null)return t;do{for(c=Object.getOwnPropertyNames(e),d=c.length;d-- >0;)m=c[d],(!i||i(m,e,t))&&!a[m]&&(t[m]=e[m],a[m]=!0);e=n!==!1&&JL(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Kae=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return i!==-1&&i===n},Jae=e=>{if(!e)return null;if(y0(e))return e;let t=e.length;if(!FG(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Qae=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&JL(Uint8Array)),eoe=(e,t)=>{const i=(e&&e[ZA]).call(e);let c;for(;(c=i.next())&&!c.done;){const d=c.value;t.call(e,d[0],d[1])}},toe=(e,t)=>{let n;const i=[];for(;(n=e.exec(t))!==null;)i.push(n);return i},noe=ef("HTMLFormElement"),roe=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,c){return i.toUpperCase()+c}),RF=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),ioe=ef("RegExp"),$G=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};z1(n,(c,d)=>{let m;(m=t(c,d,e))!==!1&&(i[d]=m||c)}),Object.defineProperties(e,i)},aoe=e=>{$G(e,(t,n)=>{if(uu(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=e[n];if(uu(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},ooe=(e,t)=>{const n={},i=c=>{c.forEach(d=>{n[d]=!0})};return y0(e)?i(e):i(String(e).split(t)),n},soe=()=>{},loe=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function coe(e){return!!(e&&uu(e.append)&&e[jG]==="FormData"&&e[ZA])}const uoe=e=>{const t=new Array(10),n=(i,c)=>{if(N1(i)){if(t.indexOf(i)>=0)return;if(L1(i))return i;if(!("toJSON"in i)){t[c]=i;const d=y0(i)?[]:{};return z1(i,(m,a)=>{const w=n(m,c+1);!Bx(w)&&(d[a]=w)}),t[c]=void 0,d}}return i};return n(e,0)},hoe=ef("AsyncFunction"),doe=e=>e&&(N1(e)||uu(e))&&uu(e.then)&&uu(e.catch),qG=((e,t)=>e?setImmediate:t?((n,i)=>(k_.addEventListener("message",({source:c,data:d})=>{c===k_&&d===n&&i.length&&i.shift()()},!1),c=>{i.push(c),k_.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",uu(k_.postMessage)),foe=typeof queueMicrotask<"u"?queueMicrotask.bind(k_):typeof process<"u"&&process.nextTick||qG,poe=e=>e!=null&&uu(e[ZA]),yn={isArray:y0,isArrayBuffer:BG,isBuffer:L1,isFormData:Fae,isArrayBufferView:Rae,isString:Iae,isNumber:FG,isBoolean:Dae,isObject:N1,isPlainObject:nE,isEmptyObject:kae,isReadableStream:Uae,isRequest:$ae,isResponse:qae,isHeaders:Hae,isUndefined:Bx,isDate:Lae,isFile:Nae,isBlob:zae,isRegExp:ioe,isFunction:uu,isStream:Bae,isURLSearchParams:Vae,isTypedArray:Qae,isFileList:jae,forEach:z1,merge:DD,extend:Wae,trim:Gae,stripBOM:Xae,inherits:Zae,toFlatObject:Yae,kindOf:YA,kindOfTest:ef,endsWith:Kae,toArray:Jae,forEachEntry:eoe,matchAll:toe,isHTMLForm:noe,hasOwnProperty:RF,hasOwnProp:RF,reduceDescriptors:$G,freezeMethods:aoe,toObjectSet:ooe,toCamelCase:roe,noop:soe,toFiniteNumber:loe,findKey:VG,global:k_,isContextDefined:UG,isSpecCompliantForm:coe,toJSONObject:uoe,isAsyncFn:hoe,isThenable:doe,setImmediate:qG,asap:foe,isIterable:poe};function Fi(e,t,n,i,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),c&&(this.response=c,this.status=c.status?c.status:null)}yn.inherits(Fi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:yn.toJSONObject(this.config),code:this.code,status:this.status}}});const HG=Fi.prototype,GG={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{GG[e]={value:e}});Object.defineProperties(Fi,GG);Object.defineProperty(HG,"isAxiosError",{value:!0});Fi.from=(e,t,n,i,c,d)=>{const m=Object.create(HG);yn.toFlatObject(e,m,function(M){return M!==Error.prototype},S=>S!=="isAxiosError");const a=e&&e.message?e.message:"Error",w=t==null&&e?e.code:t;return Fi.call(m,a,w,n,i,c),e&&m.cause==null&&Object.defineProperty(m,"cause",{value:e,configurable:!0}),m.name=e&&e.name||"Error",d&&Object.assign(m,d),m};const moe=null;function kD(e){return yn.isPlainObject(e)||yn.isArray(e)}function WG(e){return yn.endsWith(e,"[]")?e.slice(0,-2):e}function IF(e,t,n){return e?e.concat(t).map(function(c,d){return c=WG(c),!n&&d?"["+c+"]":c}).join(n?".":""):t}function goe(e){return yn.isArray(e)&&!e.some(kD)}const yoe=yn.toFlatObject(yn,{},null,function(t){return/^is[A-Z]/.test(t)});function JA(e,t,n){if(!yn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=yn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(q,V){return!yn.isUndefined(V[q])});const i=n.metaTokens,c=n.visitor||M,d=n.dots,m=n.indexes,w=(n.Blob||typeof Blob<"u"&&Blob)&&yn.isSpecCompliantForm(t);if(!yn.isFunction(c))throw new TypeError("visitor must be a function");function S(G){if(G===null)return"";if(yn.isDate(G))return G.toISOString();if(yn.isBoolean(G))return G.toString();if(!w&&yn.isBlob(G))throw new Fi("Blob is not supported. Use a Buffer instead.");return yn.isArrayBuffer(G)||yn.isTypedArray(G)?w&&typeof Blob=="function"?new Blob([G]):Buffer.from(G):G}function M(G,q,V){let J=G;if(G&&!V&&typeof G=="object"){if(yn.endsWith(q,"{}"))q=i?q:q.slice(0,-2),G=JSON.stringify(G);else if(yn.isArray(G)&&goe(G)||(yn.isFileList(G)||yn.endsWith(q,"[]"))&&(J=yn.toArray(G)))return q=WG(q),J.forEach(function(re,fe){!(yn.isUndefined(re)||re===null)&&t.append(m===!0?IF([q],fe,d):m===null?q:q+"[]",S(re))}),!1}return kD(G)?!0:(t.append(IF(V,q,d),S(G)),!1)}const P=[],N=Object.assign(yoe,{defaultVisitor:M,convertValue:S,isVisitable:kD});function $(G,q){if(!yn.isUndefined(G)){if(P.indexOf(G)!==-1)throw Error("Circular reference detected in "+q.join("."));P.push(G),yn.forEach(G,function(J,ee){(!(yn.isUndefined(J)||J===null)&&c.call(t,J,yn.isString(ee)?ee.trim():ee,q,N))===!0&&$(J,q?q.concat(ee):[ee])}),P.pop()}}if(!yn.isObject(e))throw new TypeError("data must be an object");return $(e),t}function DF(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function QL(e,t){this._pairs=[],e&&JA(e,this,t)}const XG=QL.prototype;XG.append=function(t,n){this._pairs.push([t,n])};XG.toString=function(t){const n=t?function(i){return t.call(this,i,DF)}:DF;return this._pairs.map(function(c){return n(c[0])+"="+n(c[1])},"").join("&")};function _oe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ZG(e,t,n){if(!t)return e;const i=n&&n.encode||_oe;yn.isFunction(n)&&(n={serialize:n});const c=n&&n.serialize;let d;if(c?d=c(t,n):d=yn.isURLSearchParams(t)?t.toString():new QL(t,n).toString(i),d){const m=e.indexOf("#");m!==-1&&(e=e.slice(0,m)),e+=(e.indexOf("?")===-1?"?":"&")+d}return e}class kF{constructor(){this.handlers=[]}use(t,n,i){return this.handlers.push({fulfilled:t,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){yn.forEach(this.handlers,function(i){i!==null&&t(i)})}}const YG={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},voe=typeof URLSearchParams<"u"?URLSearchParams:QL,xoe=typeof FormData<"u"?FormData:null,boe=typeof Blob<"u"?Blob:null,woe={isBrowser:!0,classes:{URLSearchParams:voe,FormData:xoe,Blob:boe},protocols:["http","https","file","blob","url","data"]},eN=typeof window<"u"&&typeof document<"u",LD=typeof navigator=="object"&&navigator||void 0,Soe=eN&&(!LD||["ReactNative","NativeScript","NS"].indexOf(LD.product)<0),Toe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Eoe=eN&&window.location.href||"http://localhost",Aoe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:eN,hasStandardBrowserEnv:Soe,hasStandardBrowserWebWorkerEnv:Toe,navigator:LD,origin:Eoe},Symbol.toStringTag,{value:"Module"})),uc={...Aoe,...woe};function Coe(e,t){return JA(e,new uc.classes.URLSearchParams,{visitor:function(n,i,c,d){return uc.isNode&&yn.isBuffer(n)?(this.append(i,n.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)},...t})}function Moe(e){return yn.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Poe(e){const t={},n=Object.keys(e);let i;const c=n.length;let d;for(i=0;i<c;i++)d=n[i],t[d]=e[d];return t}function KG(e){function t(n,i,c,d){let m=n[d++];if(m==="__proto__")return!0;const a=Number.isFinite(+m),w=d>=n.length;return m=!m&&yn.isArray(c)?c.length:m,w?(yn.hasOwnProp(c,m)?c[m]=[c[m],i]:c[m]=i,!a):((!c[m]||!yn.isObject(c[m]))&&(c[m]=[]),t(n,i,c[m],d)&&yn.isArray(c[m])&&(c[m]=Poe(c[m])),!a)}if(yn.isFormData(e)&&yn.isFunction(e.entries)){const n={};return yn.forEachEntry(e,(i,c)=>{t(Moe(i),c,n,0)}),n}return null}function Ooe(e,t,n){if(yn.isString(e))try{return(t||JSON.parse)(e),yn.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(e)}const j1={transitional:YG,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const i=n.getContentType()||"",c=i.indexOf("application/json")>-1,d=yn.isObject(t);if(d&&yn.isHTMLForm(t)&&(t=new FormData(t)),yn.isFormData(t))return c?JSON.stringify(KG(t)):t;if(yn.isArrayBuffer(t)||yn.isBuffer(t)||yn.isStream(t)||yn.isFile(t)||yn.isBlob(t)||yn.isReadableStream(t))return t;if(yn.isArrayBufferView(t))return t.buffer;if(yn.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(d){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Coe(t,this.formSerializer).toString();if((a=yn.isFileList(t))||i.indexOf("multipart/form-data")>-1){const w=this.env&&this.env.FormData;return JA(a?{"files[]":t}:t,w&&new w,this.formSerializer)}}return d||c?(n.setContentType("application/json",!1),Ooe(t)):t}],transformResponse:[function(t){const n=this.transitional||j1.transitional,i=n&&n.forcedJSONParsing,c=this.responseType==="json";if(yn.isResponse(t)||yn.isReadableStream(t))return t;if(t&&yn.isString(t)&&(i&&!this.responseType||c)){const m=!(n&&n.silentJSONParsing)&&c;try{return JSON.parse(t,this.parseReviver)}catch(a){if(m)throw a.name==="SyntaxError"?Fi.from(a,Fi.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:uc.classes.FormData,Blob:uc.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};yn.forEach(["delete","get","head","post","put","patch"],e=>{j1.headers[e]={}});const Roe=yn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ioe=e=>{const t={};let n,i,c;return e&&e.split(`
`).forEach(function(m){c=m.indexOf(":"),n=m.substring(0,c).trim().toLowerCase(),i=m.substring(c+1).trim(),!(!n||t[n]&&Roe[n])&&(n==="set-cookie"?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t},LF=Symbol("internals");function Yb(e){return e&&String(e).trim().toLowerCase()}function rE(e){return e===!1||e==null?e:yn.isArray(e)?e.map(rE):String(e)}function Doe(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}const koe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function DM(e,t,n,i,c){if(yn.isFunction(i))return i.call(this,t,n);if(c&&(t=n),!!yn.isString(t)){if(yn.isString(i))return t.indexOf(i)!==-1;if(yn.isRegExp(i))return i.test(t)}}function Loe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,i)=>n.toUpperCase()+i)}function Noe(e,t){const n=yn.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(c,d,m){return this[i].call(this,t,c,d,m)},configurable:!0})})}let hu=class{constructor(t){t&&this.set(t)}set(t,n,i){const c=this;function d(a,w,S){const M=Yb(w);if(!M)throw new Error("header name must be a non-empty string");const P=yn.findKey(c,M);(!P||c[P]===void 0||S===!0||S===void 0&&c[P]!==!1)&&(c[P||w]=rE(a))}const m=(a,w)=>yn.forEach(a,(S,M)=>d(S,M,w));if(yn.isPlainObject(t)||t instanceof this.constructor)m(t,n);else if(yn.isString(t)&&(t=t.trim())&&!koe(t))m(Ioe(t),n);else if(yn.isObject(t)&&yn.isIterable(t)){let a={},w,S;for(const M of t){if(!yn.isArray(M))throw TypeError("Object iterator must return a key-value pair");a[S=M[0]]=(w=a[S])?yn.isArray(w)?[...w,M[1]]:[w,M[1]]:M[1]}m(a,n)}else t!=null&&d(n,t,i);return this}get(t,n){if(t=Yb(t),t){const i=yn.findKey(this,t);if(i){const c=this[i];if(!n)return c;if(n===!0)return Doe(c);if(yn.isFunction(n))return n.call(this,c,i);if(yn.isRegExp(n))return n.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Yb(t),t){const i=yn.findKey(this,t);return!!(i&&this[i]!==void 0&&(!n||DM(this,this[i],i,n)))}return!1}delete(t,n){const i=this;let c=!1;function d(m){if(m=Yb(m),m){const a=yn.findKey(i,m);a&&(!n||DM(i,i[a],a,n))&&(delete i[a],c=!0)}}return yn.isArray(t)?t.forEach(d):d(t),c}clear(t){const n=Object.keys(this);let i=n.length,c=!1;for(;i--;){const d=n[i];(!t||DM(this,this[d],d,t,!0))&&(delete this[d],c=!0)}return c}normalize(t){const n=this,i={};return yn.forEach(this,(c,d)=>{const m=yn.findKey(i,d);if(m){n[m]=rE(c),delete n[d];return}const a=t?Loe(d):String(d).trim();a!==d&&delete n[d],n[a]=rE(c),i[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return yn.forEach(this,(i,c)=>{i!=null&&i!==!1&&(n[c]=t&&yn.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const i=new this(t);return n.forEach(c=>i.set(c)),i}static accessor(t){const i=(this[LF]=this[LF]={accessors:{}}).accessors,c=this.prototype;function d(m){const a=Yb(m);i[a]||(Noe(c,m),i[a]=!0)}return yn.isArray(t)?t.forEach(d):d(t),this}};hu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);yn.reduceDescriptors(hu.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[n]=i}}});yn.freezeMethods(hu);function kM(e,t){const n=this||j1,i=t||n,c=hu.from(i.headers);let d=i.data;return yn.forEach(e,function(a){d=a.call(n,d,c.normalize(),t?t.status:void 0)}),c.normalize(),d}function JG(e){return!!(e&&e.__CANCEL__)}function _0(e,t,n){Fi.call(this,e??"canceled",Fi.ERR_CANCELED,t,n),this.name="CanceledError"}yn.inherits(_0,Fi,{__CANCEL__:!0});function QG(e,t,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?e(n):t(new Fi("Request failed with status code "+n.status,[Fi.ERR_BAD_REQUEST,Fi.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function zoe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function joe(e,t){e=e||10;const n=new Array(e),i=new Array(e);let c=0,d=0,m;return t=t!==void 0?t:1e3,function(w){const S=Date.now(),M=i[d];m||(m=S),n[c]=w,i[c]=S;let P=d,N=0;for(;P!==c;)N+=n[P++],P=P%e;if(c=(c+1)%e,c===d&&(d=(d+1)%e),S-m<t)return;const $=M&&S-M;return $?Math.round(N*1e3/$):void 0}}function Boe(e,t){let n=0,i=1e3/t,c,d;const m=(S,M=Date.now())=>{n=M,c=null,d&&(clearTimeout(d),d=null),e(...S)};return[(...S)=>{const M=Date.now(),P=M-n;P>=i?m(S,M):(c=S,d||(d=setTimeout(()=>{d=null,m(c)},i-P)))},()=>c&&m(c)]}const mE=(e,t,n=3)=>{let i=0;const c=joe(50,250);return Boe(d=>{const m=d.loaded,a=d.lengthComputable?d.total:void 0,w=m-i,S=c(w),M=m<=a;i=m;const P={loaded:m,total:a,progress:a?m/a:void 0,bytes:w,rate:S||void 0,estimated:S&&a&&M?(a-m)/S:void 0,event:d,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(P)},n)},NF=(e,t)=>{const n=e!=null;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},zF=e=>(...t)=>yn.asap(()=>e(...t)),Foe=uc.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,uc.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(uc.origin),uc.navigator&&/(msie|trident)/i.test(uc.navigator.userAgent)):()=>!0,Voe=uc.hasStandardBrowserEnv?{write(e,t,n,i,c,d){const m=[e+"="+encodeURIComponent(t)];yn.isNumber(n)&&m.push("expires="+new Date(n).toGMTString()),yn.isString(i)&&m.push("path="+i),yn.isString(c)&&m.push("domain="+c),d===!0&&m.push("secure"),document.cookie=m.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Uoe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function $oe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function eW(e,t,n){let i=!Uoe(t);return e&&(i||n==!1)?$oe(e,t):t}const jF=e=>e instanceof hu?{...e}:e;function Z_(e,t){t=t||{};const n={};function i(S,M,P,N){return yn.isPlainObject(S)&&yn.isPlainObject(M)?yn.merge.call({caseless:N},S,M):yn.isPlainObject(M)?yn.merge({},M):yn.isArray(M)?M.slice():M}function c(S,M,P,N){if(yn.isUndefined(M)){if(!yn.isUndefined(S))return i(void 0,S,P,N)}else return i(S,M,P,N)}function d(S,M){if(!yn.isUndefined(M))return i(void 0,M)}function m(S,M){if(yn.isUndefined(M)){if(!yn.isUndefined(S))return i(void 0,S)}else return i(void 0,M)}function a(S,M,P){if(P in t)return i(S,M);if(P in e)return i(void 0,S)}const w={url:d,method:d,data:d,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:a,headers:(S,M,P)=>c(jF(S),jF(M),P,!0)};return yn.forEach(Object.keys({...e,...t}),function(M){const P=w[M]||c,N=P(e[M],t[M],M);yn.isUndefined(N)&&P!==a||(n[M]=N)}),n}const tW=e=>{const t=Z_({},e);let{data:n,withXSRFToken:i,xsrfHeaderName:c,xsrfCookieName:d,headers:m,auth:a}=t;if(t.headers=m=hu.from(m),t.url=ZG(eW(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&m.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),yn.isFormData(n)){if(uc.hasStandardBrowserEnv||uc.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if(yn.isFunction(n.getHeaders)){const w=n.getHeaders(),S=["content-type","content-length"];Object.entries(w).forEach(([M,P])=>{S.includes(M.toLowerCase())&&m.set(M,P)})}}if(uc.hasStandardBrowserEnv&&(i&&yn.isFunction(i)&&(i=i(t)),i||i!==!1&&Foe(t.url))){const w=c&&d&&Voe.read(d);w&&m.set(c,w)}return t},qoe=typeof XMLHttpRequest<"u",Hoe=qoe&&function(e){return new Promise(function(n,i){const c=tW(e);let d=c.data;const m=hu.from(c.headers).normalize();let{responseType:a,onUploadProgress:w,onDownloadProgress:S}=c,M,P,N,$,G;function q(){$&&$(),G&&G(),c.cancelToken&&c.cancelToken.unsubscribe(M),c.signal&&c.signal.removeEventListener("abort",M)}let V=new XMLHttpRequest;V.open(c.method.toUpperCase(),c.url,!0),V.timeout=c.timeout;function J(){if(!V)return;const re=hu.from("getAllResponseHeaders"in V&&V.getAllResponseHeaders()),ne={data:!a||a==="text"||a==="json"?V.responseText:V.response,status:V.status,statusText:V.statusText,headers:re,config:e,request:V};QG(function(me){n(me),q()},function(me){i(me),q()},ne),V=null}"onloadend"in V?V.onloadend=J:V.onreadystatechange=function(){!V||V.readyState!==4||V.status===0&&!(V.responseURL&&V.responseURL.indexOf("file:")===0)||setTimeout(J)},V.onabort=function(){V&&(i(new Fi("Request aborted",Fi.ECONNABORTED,e,V)),V=null)},V.onerror=function(fe){const ne=fe&&fe.message?fe.message:"Network Error",ce=new Fi(ne,Fi.ERR_NETWORK,e,V);ce.event=fe||null,i(ce),V=null},V.ontimeout=function(){let fe=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const ne=c.transitional||YG;c.timeoutErrorMessage&&(fe=c.timeoutErrorMessage),i(new Fi(fe,ne.clarifyTimeoutError?Fi.ETIMEDOUT:Fi.ECONNABORTED,e,V)),V=null},d===void 0&&m.setContentType(null),"setRequestHeader"in V&&yn.forEach(m.toJSON(),function(fe,ne){V.setRequestHeader(ne,fe)}),yn.isUndefined(c.withCredentials)||(V.withCredentials=!!c.withCredentials),a&&a!=="json"&&(V.responseType=c.responseType),S&&([N,G]=mE(S,!0),V.addEventListener("progress",N)),w&&V.upload&&([P,$]=mE(w),V.upload.addEventListener("progress",P),V.upload.addEventListener("loadend",$)),(c.cancelToken||c.signal)&&(M=re=>{V&&(i(!re||re.type?new _0(null,e,V):re),V.abort(),V=null)},c.cancelToken&&c.cancelToken.subscribe(M),c.signal&&(c.signal.aborted?M():c.signal.addEventListener("abort",M)));const ee=zoe(c.url);if(ee&&uc.protocols.indexOf(ee)===-1){i(new Fi("Unsupported protocol "+ee+":",Fi.ERR_BAD_REQUEST,e));return}V.send(d||null)})},Goe=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let i=new AbortController,c;const d=function(S){if(!c){c=!0,a();const M=S instanceof Error?S:this.reason;i.abort(M instanceof Fi?M:new _0(M instanceof Error?M.message:M))}};let m=t&&setTimeout(()=>{m=null,d(new Fi(`timeout ${t} of ms exceeded`,Fi.ETIMEDOUT))},t);const a=()=>{e&&(m&&clearTimeout(m),m=null,e.forEach(S=>{S.unsubscribe?S.unsubscribe(d):S.removeEventListener("abort",d)}),e=null)};e.forEach(S=>S.addEventListener("abort",d));const{signal:w}=i;return w.unsubscribe=()=>yn.asap(a),w}},Woe=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let i=0,c;for(;i<n;)c=i+t,yield e.slice(i,c),i=c},Xoe=async function*(e,t){for await(const n of Zoe(e))yield*Woe(n,t)},Zoe=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:i}=await t.read();if(n)break;yield i}}finally{await t.cancel()}},BF=(e,t,n,i)=>{const c=Xoe(e,t);let d=0,m,a=w=>{m||(m=!0,i&&i(w))};return new ReadableStream({async pull(w){try{const{done:S,value:M}=await c.next();if(S){a(),w.close();return}let P=M.byteLength;if(n){let N=d+=P;n(N)}w.enqueue(new Uint8Array(M))}catch(S){throw a(S),S}},cancel(w){return a(w),c.return()}},{highWaterMark:2})},FF=64*1024,{isFunction:CT}=yn,Yoe=(({Request:e,Response:t})=>({Request:e,Response:t}))(yn.global),{ReadableStream:VF,TextEncoder:UF}=yn.global,$F=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Koe=e=>{e=yn.merge.call({skipUndefined:!0},Yoe,e);const{fetch:t,Request:n,Response:i}=e,c=t?CT(t):typeof fetch=="function",d=CT(n),m=CT(i);if(!c)return!1;const a=c&&CT(VF),w=c&&(typeof UF=="function"?(G=>q=>G.encode(q))(new UF):async G=>new Uint8Array(await new n(G).arrayBuffer())),S=d&&a&&$F(()=>{let G=!1;const q=new n(uc.origin,{body:new VF,method:"POST",get duplex(){return G=!0,"half"}}).headers.has("Content-Type");return G&&!q}),M=m&&a&&$F(()=>yn.isReadableStream(new i("").body)),P={stream:M&&(G=>G.body)};c&&["text","arrayBuffer","blob","formData","stream"].forEach(G=>{!P[G]&&(P[G]=(q,V)=>{let J=q&&q[G];if(J)return J.call(q);throw new Fi(`Response type '${G}' is not supported`,Fi.ERR_NOT_SUPPORT,V)})});const N=async G=>{if(G==null)return 0;if(yn.isBlob(G))return G.size;if(yn.isSpecCompliantForm(G))return(await new n(uc.origin,{method:"POST",body:G}).arrayBuffer()).byteLength;if(yn.isArrayBufferView(G)||yn.isArrayBuffer(G))return G.byteLength;if(yn.isURLSearchParams(G)&&(G=G+""),yn.isString(G))return(await w(G)).byteLength},$=async(G,q)=>{const V=yn.toFiniteNumber(G.getContentLength());return V??N(q)};return async G=>{let{url:q,method:V,data:J,signal:ee,cancelToken:re,timeout:fe,onDownloadProgress:ne,onUploadProgress:ce,responseType:me,headers:ve,withCredentials:De="same-origin",fetchOptions:Ye}=tW(G),ze=t||fetch;me=me?(me+"").toLowerCase():"text";let tt=Goe([ee,re&&re.toAbortSignal()],fe),at=null;const ct=tt&&tt.unsubscribe&&(()=>{tt.unsubscribe()});let ht;try{if(ce&&S&&V!=="get"&&V!=="head"&&(ht=await $(ve,J))!==0){let vt=new n(q,{method:"POST",body:J,duplex:"half"}),nt;if(yn.isFormData(J)&&(nt=vt.headers.get("content-type"))&&ve.setContentType(nt),vt.body){const[gt,Ut]=NF(ht,mE(zF(ce)));J=BF(vt.body,FF,gt,Ut)}}yn.isString(De)||(De=De?"include":"omit");const Ie=d&&"credentials"in n.prototype,rt={...Ye,signal:tt,method:V.toUpperCase(),headers:ve.normalize().toJSON(),body:J,duplex:"half",credentials:Ie?De:void 0};at=d&&new n(q,rt);let Qe=await(d?ze(at,Ye):ze(q,rt));const St=M&&(me==="stream"||me==="response");if(M&&(ne||St&&ct)){const vt={};["status","statusText","headers"].forEach($t=>{vt[$t]=Qe[$t]});const nt=yn.toFiniteNumber(Qe.headers.get("content-length")),[gt,Ut]=ne&&NF(nt,mE(zF(ne),!0))||[];Qe=new i(BF(Qe.body,FF,gt,()=>{Ut&&Ut(),ct&&ct()}),vt)}me=me||"text";let qe=await P[yn.findKey(P,me)||"text"](Qe,G);return!St&&ct&&ct(),await new Promise((vt,nt)=>{QG(vt,nt,{data:qe,headers:hu.from(Qe.headers),status:Qe.status,statusText:Qe.statusText,config:G,request:at})})}catch(Ie){throw ct&&ct(),Ie&&Ie.name==="TypeError"&&/Load failed|fetch/i.test(Ie.message)?Object.assign(new Fi("Network Error",Fi.ERR_NETWORK,G,at),{cause:Ie.cause||Ie}):Fi.from(Ie,Ie&&Ie.code,G,at)}}},Joe=new Map,nW=e=>{let t=e?e.env:{};const{fetch:n,Request:i,Response:c}=t,d=[i,c,n];let m=d.length,a=m,w,S,M=Joe;for(;a--;)w=d[a],S=M.get(w),S===void 0&&M.set(w,S=a?new Map:Koe(t)),M=S;return S};nW();const ND={http:moe,xhr:Hoe,fetch:{get:nW}};yn.forEach(ND,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const qF=e=>`- ${e}`,Qoe=e=>yn.isFunction(e)||e===null||e===!1,rW={getAdapter:(e,t)=>{e=yn.isArray(e)?e:[e];const{length:n}=e;let i,c;const d={};for(let m=0;m<n;m++){i=e[m];let a;if(c=i,!Qoe(i)&&(c=ND[(a=String(i)).toLowerCase()],c===void 0))throw new Fi(`Unknown adapter '${a}'`);if(c&&(yn.isFunction(c)||(c=c.get(t))))break;d[a||"#"+m]=c}if(!c){const m=Object.entries(d).map(([w,S])=>`adapter ${w} `+(S===!1?"is not supported by the environment":"is not available in the build"));let a=n?m.length>1?`since :
`+m.map(qF).join(`
`):" "+qF(m[0]):"as no adapter specified";throw new Fi("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return c},adapters:ND};function LM(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new _0(null,e)}function HF(e){return LM(e),e.headers=hu.from(e.headers),e.data=kM.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),rW.getAdapter(e.adapter||j1.adapter,e)(e).then(function(i){return LM(e),i.data=kM.call(e,e.transformResponse,i),i.headers=hu.from(i.headers),i},function(i){return JG(i)||(LM(e),i&&i.response&&(i.response.data=kM.call(e,e.transformResponse,i.response),i.response.headers=hu.from(i.response.headers))),Promise.reject(i)})}const iW="1.12.2",QA={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{QA[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const GF={};QA.transitional=function(t,n,i){function c(d,m){return"[Axios v"+iW+"] Transitional option '"+d+"'"+m+(i?". "+i:"")}return(d,m,a)=>{if(t===!1)throw new Fi(c(m," has been removed"+(n?" in "+n:"")),Fi.ERR_DEPRECATED);return n&&!GF[m]&&(GF[m]=!0,console.warn(c(m," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(d,m,a):!0}};QA.spelling=function(t){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function ese(e,t,n){if(typeof e!="object")throw new Fi("options must be an object",Fi.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let c=i.length;for(;c-- >0;){const d=i[c],m=t[d];if(m){const a=e[d],w=a===void 0||m(a,d,e);if(w!==!0)throw new Fi("option "+d+" must be "+w,Fi.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Fi("Unknown option "+d,Fi.ERR_BAD_OPTION)}}const iE={assertOptions:ese,validators:QA},Qf=iE.validators;let q_=class{constructor(t){this.defaults=t||{},this.interceptors={request:new kF,response:new kF}}async request(t,n){try{return await this._request(t,n)}catch(i){if(i instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const d=c.stack?c.stack.replace(/^.+\n/,""):"";try{i.stack?d&&!String(i.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+d):i.stack=d}catch{}}throw i}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Z_(this.defaults,n);const{transitional:i,paramsSerializer:c,headers:d}=n;i!==void 0&&iE.assertOptions(i,{silentJSONParsing:Qf.transitional(Qf.boolean),forcedJSONParsing:Qf.transitional(Qf.boolean),clarifyTimeoutError:Qf.transitional(Qf.boolean)},!1),c!=null&&(yn.isFunction(c)?n.paramsSerializer={serialize:c}:iE.assertOptions(c,{encode:Qf.function,serialize:Qf.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),iE.assertOptions(n,{baseUrl:Qf.spelling("baseURL"),withXsrfToken:Qf.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let m=d&&yn.merge(d.common,d[n.method]);d&&yn.forEach(["delete","get","head","post","put","patch","common"],G=>{delete d[G]}),n.headers=hu.concat(m,d);const a=[];let w=!0;this.interceptors.request.forEach(function(q){typeof q.runWhen=="function"&&q.runWhen(n)===!1||(w=w&&q.synchronous,a.unshift(q.fulfilled,q.rejected))});const S=[];this.interceptors.response.forEach(function(q){S.push(q.fulfilled,q.rejected)});let M,P=0,N;if(!w){const G=[HF.bind(this),void 0];for(G.unshift(...a),G.push(...S),N=G.length,M=Promise.resolve(n);P<N;)M=M.then(G[P++],G[P++]);return M}N=a.length;let $=n;for(;P<N;){const G=a[P++],q=a[P++];try{$=G($)}catch(V){q.call(this,V);break}}try{M=HF.call(this,$)}catch(G){return Promise.reject(G)}for(P=0,N=S.length;P<N;)M=M.then(S[P++],S[P++]);return M}getUri(t){t=Z_(this.defaults,t);const n=eW(t.baseURL,t.url,t.allowAbsoluteUrls);return ZG(n,t.params,t.paramsSerializer)}};yn.forEach(["delete","get","head","options"],function(t){q_.prototype[t]=function(n,i){return this.request(Z_(i||{},{method:t,url:n,data:(i||{}).data}))}});yn.forEach(["post","put","patch"],function(t){function n(i){return function(d,m,a){return this.request(Z_(a||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:d,data:m}))}}q_.prototype[t]=n(),q_.prototype[t+"Form"]=n(!0)});let tse=class aW{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(d){n=d});const i=this;this.promise.then(c=>{if(!i._listeners)return;let d=i._listeners.length;for(;d-- >0;)i._listeners[d](c);i._listeners=null}),this.promise.then=c=>{let d;const m=new Promise(a=>{i.subscribe(a),d=a}).then(c);return m.cancel=function(){i.unsubscribe(d)},m},t(function(d,m,a){i.reason||(i.reason=new _0(d,m,a),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=i=>{t.abort(i)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new aW(function(c){t=c}),cancel:t}}};function nse(e){return function(n){return e.apply(null,n)}}function rse(e){return yn.isObject(e)&&e.isAxiosError===!0}const zD={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zD).forEach(([e,t])=>{zD[t]=e});function oW(e){const t=new q_(e),n=zG(q_.prototype.request,t);return yn.extend(n,q_.prototype,t,{allOwnKeys:!0}),yn.extend(n,t,null,{allOwnKeys:!0}),n.create=function(c){return oW(Z_(e,c))},n}const Wo=oW(j1);Wo.Axios=q_;Wo.CanceledError=_0;Wo.CancelToken=tse;Wo.isCancel=JG;Wo.VERSION=iW;Wo.toFormData=JA;Wo.AxiosError=Fi;Wo.Cancel=Wo.CanceledError;Wo.all=function(t){return Promise.all(t)};Wo.spread=nse;Wo.isAxiosError=rse;Wo.mergeConfig=Z_;Wo.AxiosHeaders=hu;Wo.formToJSON=e=>KG(yn.isHTMLForm(e)?new FormData(e):e);Wo.getAdapter=rW.getAdapter;Wo.HttpStatusCode=zD;Wo.default=Wo;const{Axios:pBe,AxiosError:mBe,CanceledError:gBe,isCancel:yBe,CancelToken:_Be,VERSION:vBe,all:xBe,Cancel:bBe,isAxiosError:wBe,spread:SBe,toFormData:TBe,AxiosHeaders:EBe,HttpStatusCode:ABe,formToJSON:CBe,getAdapter:MBe,mergeConfig:PBe}=Wo,sW=Wo.create({baseURL:"http://auth.jolitravel.jampzdev.com",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},withCredentials:!0}),ns=Wo.create({baseURL:"http://back.fleet.jolitravel.jampzdev.com",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},withCredentials:!0});async function ise(){return(await sW.post("/api/logout",{},{withCredentials:!0})).data}const B1=K.createContext({}),ase=({children:e})=>{const[t,n]=K.useState(null),[i,c]=K.useState(!0),d=async()=>{try{const a=await sW.get("/api/user",{withCredentials:!0});return n(a.data),a.data}catch{return n(null),null}finally{c(!1)}};K.useEffect(()=>{d()},[]);const m=async()=>{try{await ise()}catch{}finally{n(null),window.location.href="https://landing.jolitravel.jampzdev.com/login"}};return D.jsx(B1.Provider,{value:{auth:t,setAuth:n,loading:i,logout:m},children:e})},lW=K.createContext({theme:"system",setTheme:()=>null});function ose({children:e,defaultTheme:t="system",storageKey:n="vite-ui-theme",...i}){const[c,d]=K.useState(()=>localStorage.getItem(n)||t);K.useEffect(()=>{const a=window.document.documentElement;if(a.classList.remove("light","dark"),c==="system"){const w=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";a.classList.add(w);return}a.classList.add(c)},[c]);const m={theme:c,setTheme:a=>{localStorage.setItem(n,a),d(a)}};return D.jsx(lW.Provider,{...i,value:m,children:e})}const sse=()=>{const e=K.useContext(lW);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lse=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),cse=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),WF=e=>{const t=cse(e);return t.charAt(0).toUpperCase()+t.slice(1)},cW=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),use=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hse={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dse=K.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:m,...a},w)=>K.createElement("svg",{ref:w,...hse,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:cW("lucide",c),...!d&&!use(a)&&{"aria-hidden":"true"},...a},[...m.map(([S,M])=>K.createElement(S,M)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=(e,t)=>{const n=K.forwardRef(({className:i,...c},d)=>K.createElement(dse,{ref:d,iconNode:t,className:cW(`lucide-${lse(WF(e))}`,`lucide-${e}`,i),...c}));return n.displayName=WF(e),n};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fse=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],pse=yo("arrow-up-right",fse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mse=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],gse=yo("badge-check",mse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yse=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],_se=yo("bell",yse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vse=[["path",{d:"M12 21V7",key:"gj6g52"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3",key:"8arnkb"}]],xse=yo("book-open-check",vse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bse=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],uW=yo("calendar",bse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wse=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],Sse=yo("car",wse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tse=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],e2=yo("check",Tse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ese=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],t2=yo("chevron-down",Ese);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ase=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],hW=yo("chevron-left",Ase);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cse=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],v0=yo("chevron-right",Cse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mse=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Pse=yo("chevron-up",Mse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ose=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],n2=yo("chevrons-up-down",Ose);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rse=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Ise=yo("ellipsis",Rse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dse=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kse=yo("eye",Dse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lse=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Nse=yo("gauge",Lse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zse=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],jse=yo("history",zse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bse=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Fse=yo("loader-circle",Bse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vse=[["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M3 12h1",key:"lp3yf2"}],["path",{d:"M3 18h1",key:"1eiwyy"}],["path",{d:"M3 6h1",key:"rgxa97"}],["path",{d:"M8 12h1",key:"1con00"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M8 6h1",key:"tn6mkg"}]],Use=yo("logs",Vse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $se=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],qse=yo("moon",$se);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hse=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],Gse=yo("panel-left",Hse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wse=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],XF=yo("plus",Wse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xse=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Zse=yo("search",Xse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yse=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Kse=yo("sun",Yse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jse=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],Qse=yo("tags",Jse);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ele=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ZF=yo("trash",ele);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tle=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],nle=yo("user",tle);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rle=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],dW=yo("x",rle);function vr(e,t,{checkForDefaultPrevented:n=!0}={}){return function(c){if(e?.(c),n===!1||!c.defaultPrevented)return t?.(c)}}function ile(e,t){const n=K.createContext(t),i=d=>{const{children:m,...a}=d,w=K.useMemo(()=>a,Object.values(a));return D.jsx(n.Provider,{value:w,children:m})};i.displayName=e+"Provider";function c(d){const m=K.useContext(n);if(m)return m;if(t!==void 0)return t;throw new Error(`\`${d}\` must be used within \`${e}\``)}return[i,c]}function ih(e,t=[]){let n=[];function i(d,m){const a=K.createContext(m),w=n.length;n=[...n,m];const S=P=>{const{scope:N,children:$,...G}=P,q=N?.[e]?.[w]||a,V=K.useMemo(()=>G,Object.values(G));return D.jsx(q.Provider,{value:V,children:$})};S.displayName=d+"Provider";function M(P,N){const $=N?.[e]?.[w]||a,G=K.useContext($);if(G)return G;if(m!==void 0)return m;throw new Error(`\`${P}\` must be used within \`${d}\``)}return[S,M]}const c=()=>{const d=n.map(m=>K.createContext(m));return function(a){const w=a?.[e]||d;return K.useMemo(()=>({[`__scope${e}`]:{...a,[e]:w}}),[a,w])}};return c.scopeName=e,[i,ale(c,...t)]}function ale(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(d){const m=i.reduce((a,{useScope:w,scopeName:S})=>{const P=w(d)[`__scope${S}`];return{...a,...P}},{});return K.useMemo(()=>({[`__scope${t.scopeName}`]:m}),[m])}};return n.scopeName=t.scopeName,n}var qs=globalThis?.document?K.useLayoutEffect:()=>{},ole=gG[" useInsertionEffect ".trim().toString()]||qs;function mp({prop:e,defaultProp:t,onChange:n=()=>{},caller:i}){const[c,d,m]=sle({defaultProp:t,onChange:n}),a=e!==void 0,w=a?e:c;{const M=K.useRef(e!==void 0);K.useEffect(()=>{const P=M.current;P!==a&&console.warn(`${i} is changing from ${P?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),M.current=a},[a,i])}const S=K.useCallback(M=>{if(a){const P=lle(M)?M(e):M;P!==e&&m.current?.(P)}else d(M)},[a,e,d,m]);return[w,S]}function sle({defaultProp:e,onChange:t}){const[n,i]=K.useState(e),c=K.useRef(n),d=K.useRef(t);return ole(()=>{d.current=t},[t]),K.useEffect(()=>{c.current!==n&&(d.current?.(n),c.current=n)},[n,c]),[n,i,d]}function lle(e){return typeof e=="function"}function YF(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function zm(...e){return t=>{let n=!1;const i=e.map(c=>{const d=YF(c,t);return!n&&typeof d=="function"&&(n=!0),d});if(n)return()=>{for(let c=0;c<i.length;c++){const d=i[c];typeof d=="function"?d():YF(e[c],null)}}}}function ba(...e){return K.useCallback(zm(...e),e)}function cy(e){const t=cle(e),n=K.forwardRef((i,c)=>{const{children:d,...m}=i,a=K.Children.toArray(d),w=a.find(ule);if(w){const S=w.props.children,M=a.map(P=>P===w?K.Children.count(S)>1?K.Children.only(null):K.isValidElement(S)?S.props.children:null:P);return D.jsx(t,{...m,ref:c,children:K.isValidElement(S)?K.cloneElement(S,void 0,M):null})}return D.jsx(t,{...m,ref:c,children:d})});return n.displayName=`${e}.Slot`,n}var F1=cy("Slot");function cle(e){const t=K.forwardRef((n,i)=>{const{children:c,...d}=n;if(K.isValidElement(c)){const m=dle(c),a=hle(d,c.props);return c.type!==K.Fragment&&(a.ref=i?zm(i,m):m),K.cloneElement(c,a)}return K.Children.count(c)>1?K.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var fW=Symbol("radix.slottable");function pW(e){const t=({children:n})=>D.jsx(D.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=fW,t}function ule(e){return K.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===fW}function hle(e,t){const n={...t};for(const i in t){const c=e[i],d=t[i];/^on[A-Z]/.test(i)?c&&d?n[i]=(...a)=>{const w=d(...a);return c(...a),w}:c&&(n[i]=c):i==="style"?n[i]={...c,...d}:i==="className"&&(n[i]=[c,d].filter(Boolean).join(" "))}return{...e,...n}}function dle(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var fle=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ii=fle.reduce((e,t)=>{const n=cy(`Primitive.${t}`),i=K.forwardRef((c,d)=>{const{asChild:m,...a}=c,w=m?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),D.jsx(w,{...a,ref:d})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function mW(e,t){e&&k1.flushSync(()=>e.dispatchEvent(t))}function ple(e,t){return K.useReducer((n,i)=>t[n][i]??n,e)}var ah=e=>{const{present:t,children:n}=e,i=mle(t),c=typeof n=="function"?n({present:i.isPresent}):K.Children.only(n),d=ba(i.ref,gle(c));return typeof n=="function"||i.isPresent?K.cloneElement(c,{ref:d}):null};ah.displayName="Presence";function mle(e){const[t,n]=K.useState(),i=K.useRef(null),c=K.useRef(e),d=K.useRef("none"),m=e?"mounted":"unmounted",[a,w]=ple(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return K.useEffect(()=>{const S=MT(i.current);d.current=a==="mounted"?S:"none"},[a]),qs(()=>{const S=i.current,M=c.current;if(M!==e){const N=d.current,$=MT(S);e?w("MOUNT"):$==="none"||S?.display==="none"?w("UNMOUNT"):w(M&&N!==$?"ANIMATION_OUT":"UNMOUNT"),c.current=e}},[e,w]),qs(()=>{if(t){let S;const M=t.ownerDocument.defaultView??window,P=$=>{const q=MT(i.current).includes(CSS.escape($.animationName));if($.target===t&&q&&(w("ANIMATION_END"),!c.current)){const V=t.style.animationFillMode;t.style.animationFillMode="forwards",S=M.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=V)})}},N=$=>{$.target===t&&(d.current=MT(i.current))};return t.addEventListener("animationstart",N),t.addEventListener("animationcancel",P),t.addEventListener("animationend",P),()=>{M.clearTimeout(S),t.removeEventListener("animationstart",N),t.removeEventListener("animationcancel",P),t.removeEventListener("animationend",P)}}else w("ANIMATION_END")},[t,w]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:K.useCallback(S=>{i.current=S?getComputedStyle(S):null,n(S)},[])}}function MT(e){return e?.animationName||"none"}function gle(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var yle=gG[" useId ".trim().toString()]||(()=>{}),_le=0;function ol(e){const[t,n]=K.useState(yle());return qs(()=>{n(i=>i??String(_le++))},[e]),e||(t?`radix-${t}`:"")}var r2="Collapsible",[vle,gW]=ih(r2),[xle,tN]=vle(r2),yW=K.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:i,defaultOpen:c,disabled:d,onOpenChange:m,...a}=e,[w,S]=mp({prop:i,defaultProp:c??!1,onChange:m,caller:r2});return D.jsx(xle,{scope:n,disabled:d,contentId:ol(),open:w,onOpenToggle:K.useCallback(()=>S(M=>!M),[S]),children:D.jsx(ii.div,{"data-state":rN(w),"data-disabled":d?"":void 0,...a,ref:t})})});yW.displayName=r2;var _W="CollapsibleTrigger",vW=K.forwardRef((e,t)=>{const{__scopeCollapsible:n,...i}=e,c=tN(_W,n);return D.jsx(ii.button,{type:"button","aria-controls":c.contentId,"aria-expanded":c.open||!1,"data-state":rN(c.open),"data-disabled":c.disabled?"":void 0,disabled:c.disabled,...i,ref:t,onClick:vr(e.onClick,c.onOpenToggle)})});vW.displayName=_W;var nN="CollapsibleContent",xW=K.forwardRef((e,t)=>{const{forceMount:n,...i}=e,c=tN(nN,e.__scopeCollapsible);return D.jsx(ah,{present:n||c.open,children:({present:d})=>D.jsx(ble,{...i,ref:t,present:d})})});xW.displayName=nN;var ble=K.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:i,children:c,...d}=e,m=tN(nN,n),[a,w]=K.useState(i),S=K.useRef(null),M=ba(t,S),P=K.useRef(0),N=P.current,$=K.useRef(0),G=$.current,q=m.open||a,V=K.useRef(q),J=K.useRef(void 0);return K.useEffect(()=>{const ee=requestAnimationFrame(()=>V.current=!1);return()=>cancelAnimationFrame(ee)},[]),qs(()=>{const ee=S.current;if(ee){J.current=J.current||{transitionDuration:ee.style.transitionDuration,animationName:ee.style.animationName},ee.style.transitionDuration="0s",ee.style.animationName="none";const re=ee.getBoundingClientRect();P.current=re.height,$.current=re.width,V.current||(ee.style.transitionDuration=J.current.transitionDuration,ee.style.animationName=J.current.animationName),w(i)}},[m.open,i]),D.jsx(ii.div,{"data-state":rN(m.open),"data-disabled":m.disabled?"":void 0,id:m.contentId,hidden:!q,...d,ref:M,style:{"--radix-collapsible-content-height":N?`${N}px`:void 0,"--radix-collapsible-content-width":G?`${G}px`:void 0,...e.style},children:q&&c})});function rN(e){return e?"open":"closed"}var wle=yW,Sle=vW,Tle=xW;function bW(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var c=e.length;for(t=0;t<c;t++)e[t]&&(n=bW(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function xa(){for(var e,t,n=0,i="",c=arguments.length;n<c;n++)(e=arguments[n])&&(t=bW(e))&&(i&&(i+=" "),i+=t);return i}const KF=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,JF=xa,iN=(e,t)=>n=>{var i;if(t?.variants==null)return JF(e,n?.class,n?.className);const{variants:c,defaultVariants:d}=t,m=Object.keys(c).map(S=>{const M=n?.[S],P=d?.[S];if(M===null)return null;const N=KF(M)||KF(P);return c[S][N]}),a=n&&Object.entries(n).reduce((S,M)=>{let[P,N]=M;return N===void 0||(S[P]=N),S},{}),w=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((S,M)=>{let{class:P,className:N,...$}=M;return Object.entries($).every(G=>{let[q,V]=G;return Array.isArray(V)?V.includes({...d,...a}[q]):{...d,...a}[q]===V})?[...S,P,N]:S},[]);return JF(e,m,w,n?.class,n?.className)},NM=768;function Ele(){const[e,t]=K.useState(void 0);return K.useEffect(()=>{const n=window.matchMedia(`(max-width: ${NM-1}px)`),i=()=>{t(window.innerWidth<NM)};return n.addEventListener("change",i),t(window.innerWidth<NM),()=>n.removeEventListener("change",i)},[]),!!e}const aN="-",Ale=e=>{const t=Mle(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:m=>{const a=m.split(aN);return a[0]===""&&a.length!==1&&a.shift(),wW(a,t)||Cle(m)},getConflictingClassGroupIds:(m,a)=>{const w=n[m]||[];return a&&i[m]?[...w,...i[m]]:w}}},wW=(e,t)=>{if(e.length===0)return t.classGroupId;const n=e[0],i=t.nextPart.get(n),c=i?wW(e.slice(1),i):void 0;if(c)return c;if(t.validators.length===0)return;const d=e.join(aN);return t.validators.find(({validator:m})=>m(d))?.classGroupId},QF=/^\[(.+)\]$/,Cle=e=>{if(QF.test(e)){const t=QF.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Mle=e=>{const{theme:t,classGroups:n}=e,i={nextPart:new Map,validators:[]};for(const c in n)jD(n[c],i,c,t);return i},jD=(e,t,n,i)=>{e.forEach(c=>{if(typeof c=="string"){const d=c===""?t:e5(t,c);d.classGroupId=n;return}if(typeof c=="function"){if(Ple(c)){jD(c(i),t,n,i);return}t.validators.push({validator:c,classGroupId:n});return}Object.entries(c).forEach(([d,m])=>{jD(m,e5(t,d),n,i)})})},e5=(e,t)=>{let n=e;return t.split(aN).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},Ple=e=>e.isThemeGetter,Ole=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,i=new Map;const c=(d,m)=>{n.set(d,m),t++,t>e&&(t=0,i=n,n=new Map)};return{get(d){let m=n.get(d);if(m!==void 0)return m;if((m=i.get(d))!==void 0)return c(d,m),m},set(d,m){n.has(d)?n.set(d,m):c(d,m)}}},BD="!",FD=":",Rle=FD.length,Ile=e=>{const{prefix:t,experimentalParseClassName:n}=e;let i=c=>{const d=[];let m=0,a=0,w=0,S;for(let G=0;G<c.length;G++){let q=c[G];if(m===0&&a===0){if(q===FD){d.push(c.slice(w,G)),w=G+Rle;continue}if(q==="/"){S=G;continue}}q==="["?m++:q==="]"?m--:q==="("?a++:q===")"&&a--}const M=d.length===0?c:c.substring(w),P=Dle(M),N=P!==M,$=S&&S>w?S-w:void 0;return{modifiers:d,hasImportantModifier:N,baseClassName:P,maybePostfixModifierPosition:$}};if(t){const c=t+FD,d=i;i=m=>m.startsWith(c)?d(m.substring(c.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:m,maybePostfixModifierPosition:void 0}}if(n){const c=i;i=d=>n({className:d,parseClassName:c})}return i},Dle=e=>e.endsWith(BD)?e.substring(0,e.length-1):e.startsWith(BD)?e.substring(1):e,kle=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(i=>[i,!0]));return i=>{if(i.length<=1)return i;const c=[];let d=[];return i.forEach(m=>{m[0]==="["||t[m]?(c.push(...d.sort(),m),d=[]):d.push(m)}),c.push(...d.sort()),c}},Lle=e=>({cache:Ole(e.cacheSize),parseClassName:Ile(e),sortModifiers:kle(e),...Ale(e)}),Nle=/\s+/,zle=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:c,sortModifiers:d}=t,m=[],a=e.trim().split(Nle);let w="";for(let S=a.length-1;S>=0;S-=1){const M=a[S],{isExternal:P,modifiers:N,hasImportantModifier:$,baseClassName:G,maybePostfixModifierPosition:q}=n(M);if(P){w=M+(w.length>0?" "+w:w);continue}let V=!!q,J=i(V?G.substring(0,q):G);if(!J){if(!V){w=M+(w.length>0?" "+w:w);continue}if(J=i(G),!J){w=M+(w.length>0?" "+w:w);continue}V=!1}const ee=d(N).join(":"),re=$?ee+BD:ee,fe=re+J;if(m.includes(fe))continue;m.push(fe);const ne=c(J,V);for(let ce=0;ce<ne.length;++ce){const me=ne[ce];m.push(re+me)}w=M+(w.length>0?" "+w:w)}return w};function jle(){let e=0,t,n,i="";for(;e<arguments.length;)(t=arguments[e++])&&(n=SW(t))&&(i&&(i+=" "),i+=n);return i}const SW=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=SW(e[i]))&&(n&&(n+=" "),n+=t);return n};function Ble(e,...t){let n,i,c,d=m;function m(w){const S=t.reduce((M,P)=>P(M),e());return n=Lle(S),i=n.cache.get,c=n.cache.set,d=a,a(w)}function a(w){const S=i(w);if(S)return S;const M=zle(w,n);return c(w,M),M}return function(){return d(jle.apply(null,arguments))}}const tl=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},TW=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,EW=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Fle=/^\d+\/\d+$/,Vle=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Ule=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$le=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,qle=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Hle=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,sx=e=>Fle.test(e),ta=e=>!!e&&!Number.isNaN(Number(e)),Zg=e=>!!e&&Number.isInteger(Number(e)),zM=e=>e.endsWith("%")&&ta(e.slice(0,-1)),wm=e=>Vle.test(e),Gle=()=>!0,Wle=e=>Ule.test(e)&&!$le.test(e),AW=()=>!1,Xle=e=>qle.test(e),Zle=e=>Hle.test(e),Yle=e=>!Nr(e)&&!zr(e),Kle=e=>x0(e,PW,AW),Nr=e=>TW.test(e),C_=e=>x0(e,OW,Wle),jM=e=>x0(e,nce,ta),t5=e=>x0(e,CW,AW),Jle=e=>x0(e,MW,Zle),PT=e=>x0(e,RW,Xle),zr=e=>EW.test(e),Kb=e=>b0(e,OW),Qle=e=>b0(e,rce),n5=e=>b0(e,CW),ece=e=>b0(e,PW),tce=e=>b0(e,MW),OT=e=>b0(e,RW,!0),x0=(e,t,n)=>{const i=TW.exec(e);return i?i[1]?t(i[1]):n(i[2]):!1},b0=(e,t,n=!1)=>{const i=EW.exec(e);return i?i[1]?t(i[1]):n:!1},CW=e=>e==="position"||e==="percentage",MW=e=>e==="image"||e==="url",PW=e=>e==="length"||e==="size"||e==="bg-size",OW=e=>e==="length",nce=e=>e==="number",rce=e=>e==="family-name",RW=e=>e==="shadow",ice=()=>{const e=tl("color"),t=tl("font"),n=tl("text"),i=tl("font-weight"),c=tl("tracking"),d=tl("leading"),m=tl("breakpoint"),a=tl("container"),w=tl("spacing"),S=tl("radius"),M=tl("shadow"),P=tl("inset-shadow"),N=tl("text-shadow"),$=tl("drop-shadow"),G=tl("blur"),q=tl("perspective"),V=tl("aspect"),J=tl("ease"),ee=tl("animate"),re=()=>["auto","avoid","all","avoid-page","page","left","right","column"],fe=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],ne=()=>[...fe(),zr,Nr],ce=()=>["auto","hidden","clip","visible","scroll"],me=()=>["auto","contain","none"],ve=()=>[zr,Nr,w],De=()=>[sx,"full","auto",...ve()],Ye=()=>[Zg,"none","subgrid",zr,Nr],ze=()=>["auto",{span:["full",Zg,zr,Nr]},Zg,zr,Nr],tt=()=>[Zg,"auto",zr,Nr],at=()=>["auto","min","max","fr",zr,Nr],ct=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ht=()=>["start","end","center","stretch","center-safe","end-safe"],Ie=()=>["auto",...ve()],rt=()=>[sx,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...ve()],Qe=()=>[e,zr,Nr],St=()=>[...fe(),n5,t5,{position:[zr,Nr]}],qe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],vt=()=>["auto","cover","contain",ece,Kle,{size:[zr,Nr]}],nt=()=>[zM,Kb,C_],gt=()=>["","none","full",S,zr,Nr],Ut=()=>["",ta,Kb,C_],$t=()=>["solid","dashed","dotted","double"],qt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ht=()=>[ta,zM,n5,t5],mn=()=>["","none",G,zr,Nr],en=()=>["none",ta,zr,Nr],En=()=>["none",ta,zr,Nr],Xn=()=>[ta,zr,Nr],cn=()=>[sx,"full",...ve()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[wm],breakpoint:[wm],color:[Gle],container:[wm],"drop-shadow":[wm],ease:["in","out","in-out"],font:[Yle],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[wm],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[wm],shadow:[wm],spacing:["px",ta],text:[wm],"text-shadow":[wm],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",sx,Nr,zr,V]}],container:["container"],columns:[{columns:[ta,Nr,zr,a]}],"break-after":[{"break-after":re()}],"break-before":[{"break-before":re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:ne()}],overflow:[{overflow:ce()}],"overflow-x":[{"overflow-x":ce()}],"overflow-y":[{"overflow-y":ce()}],overscroll:[{overscroll:me()}],"overscroll-x":[{"overscroll-x":me()}],"overscroll-y":[{"overscroll-y":me()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:De()}],"inset-x":[{"inset-x":De()}],"inset-y":[{"inset-y":De()}],start:[{start:De()}],end:[{end:De()}],top:[{top:De()}],right:[{right:De()}],bottom:[{bottom:De()}],left:[{left:De()}],visibility:["visible","invisible","collapse"],z:[{z:[Zg,"auto",zr,Nr]}],basis:[{basis:[sx,"full","auto",a,...ve()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ta,sx,"auto","initial","none",Nr]}],grow:[{grow:["",ta,zr,Nr]}],shrink:[{shrink:["",ta,zr,Nr]}],order:[{order:[Zg,"first","last","none",zr,Nr]}],"grid-cols":[{"grid-cols":Ye()}],"col-start-end":[{col:ze()}],"col-start":[{"col-start":tt()}],"col-end":[{"col-end":tt()}],"grid-rows":[{"grid-rows":Ye()}],"row-start-end":[{row:ze()}],"row-start":[{"row-start":tt()}],"row-end":[{"row-end":tt()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":at()}],"auto-rows":[{"auto-rows":at()}],gap:[{gap:ve()}],"gap-x":[{"gap-x":ve()}],"gap-y":[{"gap-y":ve()}],"justify-content":[{justify:[...ct(),"normal"]}],"justify-items":[{"justify-items":[...ht(),"normal"]}],"justify-self":[{"justify-self":["auto",...ht()]}],"align-content":[{content:["normal",...ct()]}],"align-items":[{items:[...ht(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ht(),{baseline:["","last"]}]}],"place-content":[{"place-content":ct()}],"place-items":[{"place-items":[...ht(),"baseline"]}],"place-self":[{"place-self":["auto",...ht()]}],p:[{p:ve()}],px:[{px:ve()}],py:[{py:ve()}],ps:[{ps:ve()}],pe:[{pe:ve()}],pt:[{pt:ve()}],pr:[{pr:ve()}],pb:[{pb:ve()}],pl:[{pl:ve()}],m:[{m:Ie()}],mx:[{mx:Ie()}],my:[{my:Ie()}],ms:[{ms:Ie()}],me:[{me:Ie()}],mt:[{mt:Ie()}],mr:[{mr:Ie()}],mb:[{mb:Ie()}],ml:[{ml:Ie()}],"space-x":[{"space-x":ve()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":ve()}],"space-y-reverse":["space-y-reverse"],size:[{size:rt()}],w:[{w:[a,"screen",...rt()]}],"min-w":[{"min-w":[a,"screen","none",...rt()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[m]},...rt()]}],h:[{h:["screen","lh",...rt()]}],"min-h":[{"min-h":["screen","lh","none",...rt()]}],"max-h":[{"max-h":["screen","lh",...rt()]}],"font-size":[{text:["base",n,Kb,C_]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,zr,jM]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",zM,Nr]}],"font-family":[{font:[Qle,Nr,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[c,zr,Nr]}],"line-clamp":[{"line-clamp":[ta,"none",zr,jM]}],leading:[{leading:[d,...ve()]}],"list-image":[{"list-image":["none",zr,Nr]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",zr,Nr]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Qe()}],"text-color":[{text:Qe()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...$t(),"wavy"]}],"text-decoration-thickness":[{decoration:[ta,"from-font","auto",zr,C_]}],"text-decoration-color":[{decoration:Qe()}],"underline-offset":[{"underline-offset":[ta,"auto",zr,Nr]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ve()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",zr,Nr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",zr,Nr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:St()}],"bg-repeat":[{bg:qe()}],"bg-size":[{bg:vt()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Zg,zr,Nr],radial:["",zr,Nr],conic:[Zg,zr,Nr]},tce,Jle]}],"bg-color":[{bg:Qe()}],"gradient-from-pos":[{from:nt()}],"gradient-via-pos":[{via:nt()}],"gradient-to-pos":[{to:nt()}],"gradient-from":[{from:Qe()}],"gradient-via":[{via:Qe()}],"gradient-to":[{to:Qe()}],rounded:[{rounded:gt()}],"rounded-s":[{"rounded-s":gt()}],"rounded-e":[{"rounded-e":gt()}],"rounded-t":[{"rounded-t":gt()}],"rounded-r":[{"rounded-r":gt()}],"rounded-b":[{"rounded-b":gt()}],"rounded-l":[{"rounded-l":gt()}],"rounded-ss":[{"rounded-ss":gt()}],"rounded-se":[{"rounded-se":gt()}],"rounded-ee":[{"rounded-ee":gt()}],"rounded-es":[{"rounded-es":gt()}],"rounded-tl":[{"rounded-tl":gt()}],"rounded-tr":[{"rounded-tr":gt()}],"rounded-br":[{"rounded-br":gt()}],"rounded-bl":[{"rounded-bl":gt()}],"border-w":[{border:Ut()}],"border-w-x":[{"border-x":Ut()}],"border-w-y":[{"border-y":Ut()}],"border-w-s":[{"border-s":Ut()}],"border-w-e":[{"border-e":Ut()}],"border-w-t":[{"border-t":Ut()}],"border-w-r":[{"border-r":Ut()}],"border-w-b":[{"border-b":Ut()}],"border-w-l":[{"border-l":Ut()}],"divide-x":[{"divide-x":Ut()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Ut()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...$t(),"hidden","none"]}],"divide-style":[{divide:[...$t(),"hidden","none"]}],"border-color":[{border:Qe()}],"border-color-x":[{"border-x":Qe()}],"border-color-y":[{"border-y":Qe()}],"border-color-s":[{"border-s":Qe()}],"border-color-e":[{"border-e":Qe()}],"border-color-t":[{"border-t":Qe()}],"border-color-r":[{"border-r":Qe()}],"border-color-b":[{"border-b":Qe()}],"border-color-l":[{"border-l":Qe()}],"divide-color":[{divide:Qe()}],"outline-style":[{outline:[...$t(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ta,zr,Nr]}],"outline-w":[{outline:["",ta,Kb,C_]}],"outline-color":[{outline:Qe()}],shadow:[{shadow:["","none",M,OT,PT]}],"shadow-color":[{shadow:Qe()}],"inset-shadow":[{"inset-shadow":["none",P,OT,PT]}],"inset-shadow-color":[{"inset-shadow":Qe()}],"ring-w":[{ring:Ut()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Qe()}],"ring-offset-w":[{"ring-offset":[ta,C_]}],"ring-offset-color":[{"ring-offset":Qe()}],"inset-ring-w":[{"inset-ring":Ut()}],"inset-ring-color":[{"inset-ring":Qe()}],"text-shadow":[{"text-shadow":["none",N,OT,PT]}],"text-shadow-color":[{"text-shadow":Qe()}],opacity:[{opacity:[ta,zr,Nr]}],"mix-blend":[{"mix-blend":[...qt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":qt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ta]}],"mask-image-linear-from-pos":[{"mask-linear-from":Ht()}],"mask-image-linear-to-pos":[{"mask-linear-to":Ht()}],"mask-image-linear-from-color":[{"mask-linear-from":Qe()}],"mask-image-linear-to-color":[{"mask-linear-to":Qe()}],"mask-image-t-from-pos":[{"mask-t-from":Ht()}],"mask-image-t-to-pos":[{"mask-t-to":Ht()}],"mask-image-t-from-color":[{"mask-t-from":Qe()}],"mask-image-t-to-color":[{"mask-t-to":Qe()}],"mask-image-r-from-pos":[{"mask-r-from":Ht()}],"mask-image-r-to-pos":[{"mask-r-to":Ht()}],"mask-image-r-from-color":[{"mask-r-from":Qe()}],"mask-image-r-to-color":[{"mask-r-to":Qe()}],"mask-image-b-from-pos":[{"mask-b-from":Ht()}],"mask-image-b-to-pos":[{"mask-b-to":Ht()}],"mask-image-b-from-color":[{"mask-b-from":Qe()}],"mask-image-b-to-color":[{"mask-b-to":Qe()}],"mask-image-l-from-pos":[{"mask-l-from":Ht()}],"mask-image-l-to-pos":[{"mask-l-to":Ht()}],"mask-image-l-from-color":[{"mask-l-from":Qe()}],"mask-image-l-to-color":[{"mask-l-to":Qe()}],"mask-image-x-from-pos":[{"mask-x-from":Ht()}],"mask-image-x-to-pos":[{"mask-x-to":Ht()}],"mask-image-x-from-color":[{"mask-x-from":Qe()}],"mask-image-x-to-color":[{"mask-x-to":Qe()}],"mask-image-y-from-pos":[{"mask-y-from":Ht()}],"mask-image-y-to-pos":[{"mask-y-to":Ht()}],"mask-image-y-from-color":[{"mask-y-from":Qe()}],"mask-image-y-to-color":[{"mask-y-to":Qe()}],"mask-image-radial":[{"mask-radial":[zr,Nr]}],"mask-image-radial-from-pos":[{"mask-radial-from":Ht()}],"mask-image-radial-to-pos":[{"mask-radial-to":Ht()}],"mask-image-radial-from-color":[{"mask-radial-from":Qe()}],"mask-image-radial-to-color":[{"mask-radial-to":Qe()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":fe()}],"mask-image-conic-pos":[{"mask-conic":[ta]}],"mask-image-conic-from-pos":[{"mask-conic-from":Ht()}],"mask-image-conic-to-pos":[{"mask-conic-to":Ht()}],"mask-image-conic-from-color":[{"mask-conic-from":Qe()}],"mask-image-conic-to-color":[{"mask-conic-to":Qe()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:St()}],"mask-repeat":[{mask:qe()}],"mask-size":[{mask:vt()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",zr,Nr]}],filter:[{filter:["","none",zr,Nr]}],blur:[{blur:mn()}],brightness:[{brightness:[ta,zr,Nr]}],contrast:[{contrast:[ta,zr,Nr]}],"drop-shadow":[{"drop-shadow":["","none",$,OT,PT]}],"drop-shadow-color":[{"drop-shadow":Qe()}],grayscale:[{grayscale:["",ta,zr,Nr]}],"hue-rotate":[{"hue-rotate":[ta,zr,Nr]}],invert:[{invert:["",ta,zr,Nr]}],saturate:[{saturate:[ta,zr,Nr]}],sepia:[{sepia:["",ta,zr,Nr]}],"backdrop-filter":[{"backdrop-filter":["","none",zr,Nr]}],"backdrop-blur":[{"backdrop-blur":mn()}],"backdrop-brightness":[{"backdrop-brightness":[ta,zr,Nr]}],"backdrop-contrast":[{"backdrop-contrast":[ta,zr,Nr]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ta,zr,Nr]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ta,zr,Nr]}],"backdrop-invert":[{"backdrop-invert":["",ta,zr,Nr]}],"backdrop-opacity":[{"backdrop-opacity":[ta,zr,Nr]}],"backdrop-saturate":[{"backdrop-saturate":[ta,zr,Nr]}],"backdrop-sepia":[{"backdrop-sepia":["",ta,zr,Nr]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":ve()}],"border-spacing-x":[{"border-spacing-x":ve()}],"border-spacing-y":[{"border-spacing-y":ve()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",zr,Nr]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ta,"initial",zr,Nr]}],ease:[{ease:["linear","initial",J,zr,Nr]}],delay:[{delay:[ta,zr,Nr]}],animate:[{animate:["none",ee,zr,Nr]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[q,zr,Nr]}],"perspective-origin":[{"perspective-origin":ne()}],rotate:[{rotate:en()}],"rotate-x":[{"rotate-x":en()}],"rotate-y":[{"rotate-y":en()}],"rotate-z":[{"rotate-z":en()}],scale:[{scale:En()}],"scale-x":[{"scale-x":En()}],"scale-y":[{"scale-y":En()}],"scale-z":[{"scale-z":En()}],"scale-3d":["scale-3d"],skew:[{skew:Xn()}],"skew-x":[{"skew-x":Xn()}],"skew-y":[{"skew-y":Xn()}],transform:[{transform:[zr,Nr,"","none","gpu","cpu"]}],"transform-origin":[{origin:ne()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:cn()}],"translate-x":[{"translate-x":cn()}],"translate-y":[{"translate-y":cn()}],"translate-z":[{"translate-z":cn()}],"translate-none":["translate-none"],accent:[{accent:Qe()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Qe()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",zr,Nr]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ve()}],"scroll-mx":[{"scroll-mx":ve()}],"scroll-my":[{"scroll-my":ve()}],"scroll-ms":[{"scroll-ms":ve()}],"scroll-me":[{"scroll-me":ve()}],"scroll-mt":[{"scroll-mt":ve()}],"scroll-mr":[{"scroll-mr":ve()}],"scroll-mb":[{"scroll-mb":ve()}],"scroll-ml":[{"scroll-ml":ve()}],"scroll-p":[{"scroll-p":ve()}],"scroll-px":[{"scroll-px":ve()}],"scroll-py":[{"scroll-py":ve()}],"scroll-ps":[{"scroll-ps":ve()}],"scroll-pe":[{"scroll-pe":ve()}],"scroll-pt":[{"scroll-pt":ve()}],"scroll-pr":[{"scroll-pr":ve()}],"scroll-pb":[{"scroll-pb":ve()}],"scroll-pl":[{"scroll-pl":ve()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",zr,Nr]}],fill:[{fill:["none",...Qe()]}],"stroke-w":[{stroke:[ta,Kb,C_,jM]}],stroke:[{stroke:["none",...Qe()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},ace=Ble(ice);function bn(...e){return ace(xa(e))}const Fx=iN("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function na({className:e,variant:t,size:n,asChild:i=!1,...c}){const d=i?F1:"button";return D.jsx(d,{"data-slot":"button",className:bn(Fx({variant:t,size:n,className:e})),...c})}function io({className:e,type:t,...n}){return D.jsx("input",{type:t,"data-slot":"input",className:bn("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}var oce="Separator",r5="horizontal",sce=["horizontal","vertical"],IW=K.forwardRef((e,t)=>{const{decorative:n,orientation:i=r5,...c}=e,d=lce(i)?i:r5,a=n?{role:"none"}:{"aria-orientation":d==="vertical"?d:void 0,role:"separator"};return D.jsx(ii.div,{"data-orientation":d,...a,...c,ref:t})});IW.displayName=oce;function lce(e){return sce.includes(e)}var cce=IW;function Us({className:e,orientation:t="horizontal",decorative:n=!0,...i}){return D.jsx(cce,{"data-slot":"separator",decorative:n,orientation:t,className:bn("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...i})}function Yd(e){const t=K.useRef(e);return K.useEffect(()=>{t.current=e}),K.useMemo(()=>(...n)=>t.current?.(...n),[])}function uce(e,t=globalThis?.document){const n=Yd(e);K.useEffect(()=>{const i=c=>{c.key==="Escape"&&n(c)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var hce="DismissableLayer",VD="dismissableLayer.update",dce="dismissableLayer.pointerDownOutside",fce="dismissableLayer.focusOutside",i5,DW=K.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),w0=K.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:m,onDismiss:a,...w}=e,S=K.useContext(DW),[M,P]=K.useState(null),N=M?.ownerDocument??globalThis?.document,[,$]=K.useState({}),G=ba(t,me=>P(me)),q=Array.from(S.layers),[V]=[...S.layersWithOutsidePointerEventsDisabled].slice(-1),J=q.indexOf(V),ee=M?q.indexOf(M):-1,re=S.layersWithOutsidePointerEventsDisabled.size>0,fe=ee>=J,ne=gce(me=>{const ve=me.target,De=[...S.branches].some(Ye=>Ye.contains(ve));!fe||De||(c?.(me),m?.(me),me.defaultPrevented||a?.())},N),ce=yce(me=>{const ve=me.target;[...S.branches].some(Ye=>Ye.contains(ve))||(d?.(me),m?.(me),me.defaultPrevented||a?.())},N);return uce(me=>{ee===S.layers.size-1&&(i?.(me),!me.defaultPrevented&&a&&(me.preventDefault(),a()))},N),K.useEffect(()=>{if(M)return n&&(S.layersWithOutsidePointerEventsDisabled.size===0&&(i5=N.body.style.pointerEvents,N.body.style.pointerEvents="none"),S.layersWithOutsidePointerEventsDisabled.add(M)),S.layers.add(M),a5(),()=>{n&&S.layersWithOutsidePointerEventsDisabled.size===1&&(N.body.style.pointerEvents=i5)}},[M,N,n,S]),K.useEffect(()=>()=>{M&&(S.layers.delete(M),S.layersWithOutsidePointerEventsDisabled.delete(M),a5())},[M,S]),K.useEffect(()=>{const me=()=>$({});return document.addEventListener(VD,me),()=>document.removeEventListener(VD,me)},[]),D.jsx(ii.div,{...w,ref:G,style:{pointerEvents:re?fe?"auto":"none":void 0,...e.style},onFocusCapture:vr(e.onFocusCapture,ce.onFocusCapture),onBlurCapture:vr(e.onBlurCapture,ce.onBlurCapture),onPointerDownCapture:vr(e.onPointerDownCapture,ne.onPointerDownCapture)})});w0.displayName=hce;var pce="DismissableLayerBranch",mce=K.forwardRef((e,t)=>{const n=K.useContext(DW),i=K.useRef(null),c=ba(t,i);return K.useEffect(()=>{const d=i.current;if(d)return n.branches.add(d),()=>{n.branches.delete(d)}},[n.branches]),D.jsx(ii.div,{...e,ref:c})});mce.displayName=pce;function gce(e,t=globalThis?.document){const n=Yd(e),i=K.useRef(!1),c=K.useRef(()=>{});return K.useEffect(()=>{const d=a=>{if(a.target&&!i.current){let w=function(){kW(dce,n,S,{discrete:!0})};const S={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",c.current),c.current=w,t.addEventListener("click",c.current,{once:!0})):w()}else t.removeEventListener("click",c.current);i.current=!1},m=window.setTimeout(()=>{t.addEventListener("pointerdown",d)},0);return()=>{window.clearTimeout(m),t.removeEventListener("pointerdown",d),t.removeEventListener("click",c.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function yce(e,t=globalThis?.document){const n=Yd(e),i=K.useRef(!1);return K.useEffect(()=>{const c=d=>{d.target&&!i.current&&kW(fce,n,{originalEvent:d},{discrete:!1})};return t.addEventListener("focusin",c),()=>t.removeEventListener("focusin",c)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function a5(){const e=new CustomEvent(VD);document.dispatchEvent(e)}function kW(e,t,n,{discrete:i}){const c=n.originalEvent.target,d=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&c.addEventListener(e,t,{once:!0}),i?mW(c,d):c.dispatchEvent(d)}var BM="focusScope.autoFocusOnMount",FM="focusScope.autoFocusOnUnmount",o5={bubbles:!1,cancelable:!0},_ce="FocusScope",V1=K.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:c,onUnmountAutoFocus:d,...m}=e,[a,w]=K.useState(null),S=Yd(c),M=Yd(d),P=K.useRef(null),N=ba(t,q=>w(q)),$=K.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;K.useEffect(()=>{if(i){let q=function(re){if($.paused||!a)return;const fe=re.target;a.contains(fe)?P.current=fe:Jg(P.current,{select:!0})},V=function(re){if($.paused||!a)return;const fe=re.relatedTarget;fe!==null&&(a.contains(fe)||Jg(P.current,{select:!0}))},J=function(re){if(document.activeElement===document.body)for(const ne of re)ne.removedNodes.length>0&&Jg(a)};document.addEventListener("focusin",q),document.addEventListener("focusout",V);const ee=new MutationObserver(J);return a&&ee.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",q),document.removeEventListener("focusout",V),ee.disconnect()}}},[i,a,$.paused]),K.useEffect(()=>{if(a){l5.add($);const q=document.activeElement;if(!a.contains(q)){const J=new CustomEvent(BM,o5);a.addEventListener(BM,S),a.dispatchEvent(J),J.defaultPrevented||(vce(Tce(LW(a)),{select:!0}),document.activeElement===q&&Jg(a))}return()=>{a.removeEventListener(BM,S),setTimeout(()=>{const J=new CustomEvent(FM,o5);a.addEventListener(FM,M),a.dispatchEvent(J),J.defaultPrevented||Jg(q??document.body,{select:!0}),a.removeEventListener(FM,M),l5.remove($)},0)}}},[a,S,M,$]);const G=K.useCallback(q=>{if(!n&&!i||$.paused)return;const V=q.key==="Tab"&&!q.altKey&&!q.ctrlKey&&!q.metaKey,J=document.activeElement;if(V&&J){const ee=q.currentTarget,[re,fe]=xce(ee);re&&fe?!q.shiftKey&&J===fe?(q.preventDefault(),n&&Jg(re,{select:!0})):q.shiftKey&&J===re&&(q.preventDefault(),n&&Jg(fe,{select:!0})):J===ee&&q.preventDefault()}},[n,i,$.paused]);return D.jsx(ii.div,{tabIndex:-1,...m,ref:N,onKeyDown:G})});V1.displayName=_ce;function vce(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if(Jg(i,{select:t}),document.activeElement!==n)return}function xce(e){const t=LW(e),n=s5(t,e),i=s5(t.reverse(),e);return[n,i]}function LW(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const c=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||c?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function s5(e,t){for(const n of e)if(!bce(n,{upTo:t}))return n}function bce(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function wce(e){return e instanceof HTMLInputElement&&"select"in e}function Jg(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&wce(e)&&t&&e.select()}}var l5=Sce();function Sce(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=c5(e,t),e.unshift(t)},remove(t){e=c5(e,t),e[0]?.resume()}}}function c5(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function Tce(e){return e.filter(t=>t.tagName!=="A")}var Ece="Portal",S0=K.forwardRef((e,t)=>{const{container:n,...i}=e,[c,d]=K.useState(!1);qs(()=>d(!0),[]);const m=n||c&&globalThis?.document?.body;return m?NG.createPortal(D.jsx(ii.div,{...i,ref:t}),m):null});S0.displayName=Ece;var VM=0;function i2(){K.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??u5()),document.body.insertAdjacentElement("beforeend",e[1]??u5()),VM++,()=>{VM===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),VM--}},[])}function u5(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var np=function(){return np=Object.assign||function(t){for(var n,i=1,c=arguments.length;i<c;i++){n=arguments[i];for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(t[d]=n[d])}return t},np.apply(this,arguments)};function NW(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(e);c<i.length;c++)t.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(e,i[c])&&(n[i[c]]=e[i[c]]);return n}function Ace(e,t,n){if(n||arguments.length===2)for(var i=0,c=t.length,d;i<c;i++)(d||!(i in t))&&(d||(d=Array.prototype.slice.call(t,0,i)),d[i]=t[i]);return e.concat(d||Array.prototype.slice.call(t))}var aE="right-scroll-bar-position",oE="width-before-scroll-bar",Cce="with-scroll-bars-hidden",Mce="--removed-body-scroll-bar-size";function UM(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Pce(e,t){var n=K.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var c=n.value;c!==i&&(n.value=i,n.callback(i,c))}}}})[0];return n.callback=t,n.facade}var Oce=typeof window<"u"?K.useLayoutEffect:K.useEffect,h5=new WeakMap;function Rce(e,t){var n=Pce(null,function(i){return e.forEach(function(c){return UM(c,i)})});return Oce(function(){var i=h5.get(n);if(i){var c=new Set(i),d=new Set(e),m=n.current;c.forEach(function(a){d.has(a)||UM(a,null)}),d.forEach(function(a){c.has(a)||UM(a,m)})}h5.set(n,e)},[e]),n}function Ice(e){return e}function Dce(e,t){t===void 0&&(t=Ice);var n=[],i=!1,c={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(d){var m=t(d,i);return n.push(m),function(){n=n.filter(function(a){return a!==m})}},assignSyncMedium:function(d){for(i=!0;n.length;){var m=n;n=[],m.forEach(d)}n={push:function(a){return d(a)},filter:function(){return n}}},assignMedium:function(d){i=!0;var m=[];if(n.length){var a=n;n=[],a.forEach(d),m=n}var w=function(){var M=m;m=[],M.forEach(d)},S=function(){return Promise.resolve().then(w)};S(),n={push:function(M){m.push(M),S()},filter:function(M){return m=m.filter(M),n}}}};return c}function kce(e){e===void 0&&(e={});var t=Dce(null);return t.options=np({async:!0,ssr:!1},e),t}var zW=function(e){var t=e.sideCar,n=NW(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return K.createElement(i,np({},n))};zW.isSideCarExport=!0;function Lce(e,t){return e.useMedium(t),zW}var jW=kce(),$M=function(){},a2=K.forwardRef(function(e,t){var n=K.useRef(null),i=K.useState({onScrollCapture:$M,onWheelCapture:$M,onTouchMoveCapture:$M}),c=i[0],d=i[1],m=e.forwardProps,a=e.children,w=e.className,S=e.removeScrollBar,M=e.enabled,P=e.shards,N=e.sideCar,$=e.noRelative,G=e.noIsolation,q=e.inert,V=e.allowPinchZoom,J=e.as,ee=J===void 0?"div":J,re=e.gapMode,fe=NW(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),ne=N,ce=Rce([n,t]),me=np(np({},fe),c);return K.createElement(K.Fragment,null,M&&K.createElement(ne,{sideCar:jW,removeScrollBar:S,shards:P,noRelative:$,noIsolation:G,inert:q,setCallbacks:d,allowPinchZoom:!!V,lockRef:n,gapMode:re}),m?K.cloneElement(K.Children.only(a),np(np({},me),{ref:ce})):K.createElement(ee,np({},me,{className:w,ref:ce}),a))});a2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};a2.classNames={fullWidth:oE,zeroRight:aE};var Nce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function zce(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Nce();return t&&e.setAttribute("nonce",t),e}function jce(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Bce(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Fce=function(){var e=0,t=null;return{add:function(n){e==0&&(t=zce())&&(jce(t,n),Bce(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Vce=function(){var e=Fce();return function(t,n){K.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},BW=function(){var e=Vce(),t=function(n){var i=n.styles,c=n.dynamic;return e(i,c),null};return t},Uce={left:0,top:0,right:0,gap:0},qM=function(e){return parseInt(e||"",10)||0},$ce=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],c=t[e==="padding"?"paddingRight":"marginRight"];return[qM(n),qM(i),qM(c)]},qce=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Uce;var t=$ce(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},Hce=BW(),Px="data-scroll-locked",Gce=function(e,t,n,i){var c=e.left,d=e.top,m=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Cce,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(a,"px ").concat(i,`;
  }
  body[`).concat(Px,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(c,`px;
    padding-top: `).concat(d,`px;
    padding-right: `).concat(m,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(aE,` {
    right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(oE,` {
    margin-right: `).concat(a,"px ").concat(i,`;
  }
  
  .`).concat(aE," .").concat(aE,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(oE," .").concat(oE,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Px,`] {
    `).concat(Mce,": ").concat(a,`px;
  }
`)},d5=function(){var e=parseInt(document.body.getAttribute(Px)||"0",10);return isFinite(e)?e:0},Wce=function(){K.useEffect(function(){return document.body.setAttribute(Px,(d5()+1).toString()),function(){var e=d5()-1;e<=0?document.body.removeAttribute(Px):document.body.setAttribute(Px,e.toString())}},[])},Xce=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,c=i===void 0?"margin":i;Wce();var d=K.useMemo(function(){return qce(c)},[c]);return K.createElement(Hce,{styles:Gce(d,!t,c,n?"":"!important")})},UD=!1;if(typeof window<"u")try{var RT=Object.defineProperty({},"passive",{get:function(){return UD=!0,!0}});window.addEventListener("test",RT,RT),window.removeEventListener("test",RT,RT)}catch{UD=!1}var lx=UD?{passive:!1}:!1,Zce=function(e){return e.tagName==="TEXTAREA"},FW=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Zce(e)&&n[t]==="visible")},Yce=function(e){return FW(e,"overflowY")},Kce=function(e){return FW(e,"overflowX")},f5=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var c=VW(e,i);if(c){var d=UW(e,i),m=d[1],a=d[2];if(m>a)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},Jce=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},Qce=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},VW=function(e,t){return e==="v"?Yce(t):Kce(t)},UW=function(e,t){return e==="v"?Jce(t):Qce(t)},eue=function(e,t){return e==="h"&&t==="rtl"?-1:1},tue=function(e,t,n,i,c){var d=eue(e,window.getComputedStyle(t).direction),m=d*i,a=n.target,w=t.contains(a),S=!1,M=m>0,P=0,N=0;do{if(!a)break;var $=UW(e,a),G=$[0],q=$[1],V=$[2],J=q-V-d*G;(G||J)&&VW(e,a)&&(P+=J,N+=G);var ee=a.parentNode;a=ee&&ee.nodeType===Node.DOCUMENT_FRAGMENT_NODE?ee.host:ee}while(!w&&a!==document.body||w&&(t.contains(a)||t===a));return(M&&Math.abs(P)<1||!M&&Math.abs(N)<1)&&(S=!0),S},IT=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},p5=function(e){return[e.deltaX,e.deltaY]},m5=function(e){return e&&"current"in e?e.current:e},nue=function(e,t){return e[0]===t[0]&&e[1]===t[1]},rue=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},iue=0,cx=[];function aue(e){var t=K.useRef([]),n=K.useRef([0,0]),i=K.useRef(),c=K.useState(iue++)[0],d=K.useState(BW)[0],m=K.useRef(e);K.useEffect(function(){m.current=e},[e]),K.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(c));var q=Ace([e.lockRef.current],(e.shards||[]).map(m5),!0).filter(Boolean);return q.forEach(function(V){return V.classList.add("allow-interactivity-".concat(c))}),function(){document.body.classList.remove("block-interactivity-".concat(c)),q.forEach(function(V){return V.classList.remove("allow-interactivity-".concat(c))})}}},[e.inert,e.lockRef.current,e.shards]);var a=K.useCallback(function(q,V){if("touches"in q&&q.touches.length===2||q.type==="wheel"&&q.ctrlKey)return!m.current.allowPinchZoom;var J=IT(q),ee=n.current,re="deltaX"in q?q.deltaX:ee[0]-J[0],fe="deltaY"in q?q.deltaY:ee[1]-J[1],ne,ce=q.target,me=Math.abs(re)>Math.abs(fe)?"h":"v";if("touches"in q&&me==="h"&&ce.type==="range")return!1;var ve=f5(me,ce);if(!ve)return!0;if(ve?ne=me:(ne=me==="v"?"h":"v",ve=f5(me,ce)),!ve)return!1;if(!i.current&&"changedTouches"in q&&(re||fe)&&(i.current=ne),!ne)return!0;var De=i.current||ne;return tue(De,V,q,De==="h"?re:fe)},[]),w=K.useCallback(function(q){var V=q;if(!(!cx.length||cx[cx.length-1]!==d)){var J="deltaY"in V?p5(V):IT(V),ee=t.current.filter(function(ne){return ne.name===V.type&&(ne.target===V.target||V.target===ne.shadowParent)&&nue(ne.delta,J)})[0];if(ee&&ee.should){V.cancelable&&V.preventDefault();return}if(!ee){var re=(m.current.shards||[]).map(m5).filter(Boolean).filter(function(ne){return ne.contains(V.target)}),fe=re.length>0?a(V,re[0]):!m.current.noIsolation;fe&&V.cancelable&&V.preventDefault()}}},[]),S=K.useCallback(function(q,V,J,ee){var re={name:q,delta:V,target:J,should:ee,shadowParent:oue(J)};t.current.push(re),setTimeout(function(){t.current=t.current.filter(function(fe){return fe!==re})},1)},[]),M=K.useCallback(function(q){n.current=IT(q),i.current=void 0},[]),P=K.useCallback(function(q){S(q.type,p5(q),q.target,a(q,e.lockRef.current))},[]),N=K.useCallback(function(q){S(q.type,IT(q),q.target,a(q,e.lockRef.current))},[]);K.useEffect(function(){return cx.push(d),e.setCallbacks({onScrollCapture:P,onWheelCapture:P,onTouchMoveCapture:N}),document.addEventListener("wheel",w,lx),document.addEventListener("touchmove",w,lx),document.addEventListener("touchstart",M,lx),function(){cx=cx.filter(function(q){return q!==d}),document.removeEventListener("wheel",w,lx),document.removeEventListener("touchmove",w,lx),document.removeEventListener("touchstart",M,lx)}},[]);var $=e.removeScrollBar,G=e.inert;return K.createElement(K.Fragment,null,G?K.createElement(d,{styles:rue(c)}):null,$?K.createElement(Xce,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function oue(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const sue=Lce(jW,aue);var U1=K.forwardRef(function(e,t){return K.createElement(a2,np({},e,{ref:t,sideCar:sue}))});U1.classNames=a2.classNames;var lue=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ux=new WeakMap,DT=new WeakMap,kT={},HM=0,$W=function(e){return e&&(e.host||$W(e.parentNode))},cue=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=$W(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},uue=function(e,t,n,i){var c=cue(t,Array.isArray(e)?e:[e]);kT[n]||(kT[n]=new WeakMap);var d=kT[n],m=[],a=new Set,w=new Set(c),S=function(P){!P||a.has(P)||(a.add(P),S(P.parentNode))};c.forEach(S);var M=function(P){!P||w.has(P)||Array.prototype.forEach.call(P.children,function(N){if(a.has(N))M(N);else try{var $=N.getAttribute(i),G=$!==null&&$!=="false",q=(ux.get(N)||0)+1,V=(d.get(N)||0)+1;ux.set(N,q),d.set(N,V),m.push(N),q===1&&G&&DT.set(N,!0),V===1&&N.setAttribute(n,"true"),G||N.setAttribute(i,"true")}catch(J){console.error("aria-hidden: cannot operate on ",N,J)}})};return M(t),a.clear(),HM++,function(){m.forEach(function(P){var N=ux.get(P)-1,$=d.get(P)-1;ux.set(P,N),d.set(P,$),N||(DT.has(P)||P.removeAttribute(i),DT.delete(P)),$||P.removeAttribute(n)}),HM--,HM||(ux=new WeakMap,ux=new WeakMap,DT=new WeakMap,kT={})}},o2=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),c=lue(e);return c?(i.push.apply(i,Array.from(c.querySelectorAll("[aria-live], script"))),uue(i,c,n,"aria-hidden")):function(){return null}},s2="Dialog",[qW,HW]=ih(s2),[hue,tf]=qW(s2),GW=e=>{const{__scopeDialog:t,children:n,open:i,defaultOpen:c,onOpenChange:d,modal:m=!0}=e,a=K.useRef(null),w=K.useRef(null),[S,M]=mp({prop:i,defaultProp:c??!1,onChange:d,caller:s2});return D.jsx(hue,{scope:t,triggerRef:a,contentRef:w,contentId:ol(),titleId:ol(),descriptionId:ol(),open:S,onOpenChange:M,onOpenToggle:K.useCallback(()=>M(P=>!P),[M]),modal:m,children:n})};GW.displayName=s2;var WW="DialogTrigger",XW=K.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,c=tf(WW,n),d=ba(t,c.triggerRef);return D.jsx(ii.button,{type:"button","aria-haspopup":"dialog","aria-expanded":c.open,"aria-controls":c.contentId,"data-state":lN(c.open),...i,ref:d,onClick:vr(e.onClick,c.onOpenToggle)})});XW.displayName=WW;var oN="DialogPortal",[due,ZW]=qW(oN,{forceMount:void 0}),YW=e=>{const{__scopeDialog:t,forceMount:n,children:i,container:c}=e,d=tf(oN,t);return D.jsx(due,{scope:t,forceMount:n,children:K.Children.map(i,m=>D.jsx(ah,{present:n||d.open,children:D.jsx(S0,{asChild:!0,container:c,children:m})}))})};YW.displayName=oN;var gE="DialogOverlay",KW=K.forwardRef((e,t)=>{const n=ZW(gE,e.__scopeDialog),{forceMount:i=n.forceMount,...c}=e,d=tf(gE,e.__scopeDialog);return d.modal?D.jsx(ah,{present:i||d.open,children:D.jsx(pue,{...c,ref:t})}):null});KW.displayName=gE;var fue=cy("DialogOverlay.RemoveScroll"),pue=K.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,c=tf(gE,n);return D.jsx(U1,{as:fue,allowPinchZoom:!0,shards:[c.contentRef],children:D.jsx(ii.div,{"data-state":lN(c.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),Y_="DialogContent",JW=K.forwardRef((e,t)=>{const n=ZW(Y_,e.__scopeDialog),{forceMount:i=n.forceMount,...c}=e,d=tf(Y_,e.__scopeDialog);return D.jsx(ah,{present:i||d.open,children:d.modal?D.jsx(mue,{...c,ref:t}):D.jsx(gue,{...c,ref:t})})});JW.displayName=Y_;var mue=K.forwardRef((e,t)=>{const n=tf(Y_,e.__scopeDialog),i=K.useRef(null),c=ba(t,n.contentRef,i);return K.useEffect(()=>{const d=i.current;if(d)return o2(d)},[]),D.jsx(QW,{...e,ref:c,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vr(e.onCloseAutoFocus,d=>{d.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:vr(e.onPointerDownOutside,d=>{const m=d.detail.originalEvent,a=m.button===0&&m.ctrlKey===!0;(m.button===2||a)&&d.preventDefault()}),onFocusOutside:vr(e.onFocusOutside,d=>d.preventDefault())})}),gue=K.forwardRef((e,t)=>{const n=tf(Y_,e.__scopeDialog),i=K.useRef(!1),c=K.useRef(!1);return D.jsx(QW,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:d=>{e.onCloseAutoFocus?.(d),d.defaultPrevented||(i.current||n.triggerRef.current?.focus(),d.preventDefault()),i.current=!1,c.current=!1},onInteractOutside:d=>{e.onInteractOutside?.(d),d.defaultPrevented||(i.current=!0,d.detail.originalEvent.type==="pointerdown"&&(c.current=!0));const m=d.target;n.triggerRef.current?.contains(m)&&d.preventDefault(),d.detail.originalEvent.type==="focusin"&&c.current&&d.preventDefault()}})}),QW=K.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:i,onOpenAutoFocus:c,onCloseAutoFocus:d,...m}=e,a=tf(Y_,n),w=K.useRef(null),S=ba(t,w);return i2(),D.jsxs(D.Fragment,{children:[D.jsx(V1,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:c,onUnmountAutoFocus:d,children:D.jsx(w0,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":lN(a.open),...m,ref:S,onDismiss:()=>a.onOpenChange(!1)})}),D.jsxs(D.Fragment,{children:[D.jsx(_ue,{titleId:a.titleId}),D.jsx(xue,{contentRef:w,descriptionId:a.descriptionId})]})]})}),sN="DialogTitle",e7=K.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,c=tf(sN,n);return D.jsx(ii.h2,{id:c.titleId,...i,ref:t})});e7.displayName=sN;var t7="DialogDescription",n7=K.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,c=tf(t7,n);return D.jsx(ii.p,{id:c.descriptionId,...i,ref:t})});n7.displayName=t7;var r7="DialogClose",i7=K.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,c=tf(r7,n);return D.jsx(ii.button,{type:"button",...i,ref:t,onClick:vr(e.onClick,()=>c.onOpenChange(!1))})});i7.displayName=r7;function lN(e){return e?"open":"closed"}var a7="DialogTitleWarning",[yue,o7]=ile(a7,{contentName:Y_,titleName:sN,docsSlug:"dialog"}),_ue=({titleId:e})=>{const t=o7(a7),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return K.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},vue="DialogDescriptionWarning",xue=({contentRef:e,descriptionId:t})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${o7(vue).contentName}}.`;return K.useEffect(()=>{const c=e.current?.getAttribute("aria-describedby");t&&c&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},l2=GW,s7=XW,c2=YW,u2=KW,h2=JW,cN=e7,uN=n7,$1=i7;function bue({...e}){return D.jsx(l2,{"data-slot":"sheet",...e})}function wue({...e}){return D.jsx(c2,{"data-slot":"sheet-portal",...e})}function Sue({className:e,...t}){return D.jsx(u2,{"data-slot":"sheet-overlay",className:bn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function Tue({className:e,children:t,side:n="right",...i}){return D.jsxs(wue,{children:[D.jsx(Sue,{}),D.jsxs(h2,{"data-slot":"sheet-content",className:bn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",n==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",n==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",n==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",n==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...i,children:[t,D.jsxs($1,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[D.jsx(dW,{className:"size-4"}),D.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Eue({className:e,...t}){return D.jsx("div",{"data-slot":"sheet-header",className:bn("flex flex-col gap-1.5 p-4",e),...t})}function Aue({className:e,...t}){return D.jsx(cN,{"data-slot":"sheet-title",className:bn("text-foreground font-semibold",e),...t})}function Cue({className:e,...t}){return D.jsx(uN,{"data-slot":"sheet-description",className:bn("text-muted-foreground text-sm",e),...t})}function Oi({className:e,...t}){return D.jsx("div",{"data-slot":"skeleton",className:bn("bg-accent animate-pulse rounded-md",e),...t})}const Mue=["top","right","bottom","left"],uy=Math.min,eh=Math.max,yE=Math.round,LT=Math.floor,lp=e=>({x:e,y:e}),Pue={left:"right",right:"left",bottom:"top",top:"bottom"},Oue={start:"end",end:"start"};function $D(e,t,n){return eh(e,uy(t,n))}function jm(e,t){return typeof e=="function"?e(t):e}function Bm(e){return e.split("-")[0]}function T0(e){return e.split("-")[1]}function hN(e){return e==="x"?"y":"x"}function dN(e){return e==="y"?"height":"width"}const Rue=new Set(["top","bottom"]);function rp(e){return Rue.has(Bm(e))?"y":"x"}function fN(e){return hN(rp(e))}function Iue(e,t,n){n===void 0&&(n=!1);const i=T0(e),c=fN(e),d=dN(c);let m=c==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[d]>t.floating[d]&&(m=_E(m)),[m,_E(m)]}function Due(e){const t=_E(e);return[qD(e),t,qD(t)]}function qD(e){return e.replace(/start|end/g,t=>Oue[t])}const g5=["left","right"],y5=["right","left"],kue=["top","bottom"],Lue=["bottom","top"];function Nue(e,t,n){switch(e){case"top":case"bottom":return n?t?y5:g5:t?g5:y5;case"left":case"right":return t?kue:Lue;default:return[]}}function zue(e,t,n,i){const c=T0(e);let d=Nue(Bm(e),n==="start",i);return c&&(d=d.map(m=>m+"-"+c),t&&(d=d.concat(d.map(qD)))),d}function _E(e){return e.replace(/left|right|bottom|top/g,t=>Pue[t])}function jue(e){return{top:0,right:0,bottom:0,left:0,...e}}function l7(e){return typeof e!="number"?jue(e):{top:e,right:e,bottom:e,left:e}}function vE(e){const{x:t,y:n,width:i,height:c}=e;return{width:i,height:c,top:n,left:t,right:t+i,bottom:n+c,x:t,y:n}}function _5(e,t,n){let{reference:i,floating:c}=e;const d=rp(t),m=fN(t),a=dN(m),w=Bm(t),S=d==="y",M=i.x+i.width/2-c.width/2,P=i.y+i.height/2-c.height/2,N=i[a]/2-c[a]/2;let $;switch(w){case"top":$={x:M,y:i.y-c.height};break;case"bottom":$={x:M,y:i.y+i.height};break;case"right":$={x:i.x+i.width,y:P};break;case"left":$={x:i.x-c.width,y:P};break;default:$={x:i.x,y:i.y}}switch(T0(t)){case"start":$[m]-=N*(n&&S?-1:1);break;case"end":$[m]+=N*(n&&S?-1:1);break}return $}const Bue=async(e,t,n)=>{const{placement:i="bottom",strategy:c="absolute",middleware:d=[],platform:m}=n,a=d.filter(Boolean),w=await(m.isRTL==null?void 0:m.isRTL(t));let S=await m.getElementRects({reference:e,floating:t,strategy:c}),{x:M,y:P}=_5(S,i,w),N=i,$={},G=0;for(let q=0;q<a.length;q++){const{name:V,fn:J}=a[q],{x:ee,y:re,data:fe,reset:ne}=await J({x:M,y:P,initialPlacement:i,placement:N,strategy:c,middlewareData:$,rects:S,platform:m,elements:{reference:e,floating:t}});M=ee??M,P=re??P,$={...$,[V]:{...$[V],...fe}},ne&&G<=50&&(G++,typeof ne=="object"&&(ne.placement&&(N=ne.placement),ne.rects&&(S=ne.rects===!0?await m.getElementRects({reference:e,floating:t,strategy:c}):ne.rects),{x:M,y:P}=_5(S,N,w)),q=-1)}return{x:M,y:P,placement:N,strategy:c,middlewareData:$}};async function kw(e,t){var n;t===void 0&&(t={});const{x:i,y:c,platform:d,rects:m,elements:a,strategy:w}=e,{boundary:S="clippingAncestors",rootBoundary:M="viewport",elementContext:P="floating",altBoundary:N=!1,padding:$=0}=jm(t,e),G=l7($),V=a[N?P==="floating"?"reference":"floating":P],J=vE(await d.getClippingRect({element:(n=await(d.isElement==null?void 0:d.isElement(V)))==null||n?V:V.contextElement||await(d.getDocumentElement==null?void 0:d.getDocumentElement(a.floating)),boundary:S,rootBoundary:M,strategy:w})),ee=P==="floating"?{x:i,y:c,width:m.floating.width,height:m.floating.height}:m.reference,re=await(d.getOffsetParent==null?void 0:d.getOffsetParent(a.floating)),fe=await(d.isElement==null?void 0:d.isElement(re))?await(d.getScale==null?void 0:d.getScale(re))||{x:1,y:1}:{x:1,y:1},ne=vE(d.convertOffsetParentRelativeRectToViewportRelativeRect?await d.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:ee,offsetParent:re,strategy:w}):ee);return{top:(J.top-ne.top+G.top)/fe.y,bottom:(ne.bottom-J.bottom+G.bottom)/fe.y,left:(J.left-ne.left+G.left)/fe.x,right:(ne.right-J.right+G.right)/fe.x}}const Fue=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:c,rects:d,platform:m,elements:a,middlewareData:w}=t,{element:S,padding:M=0}=jm(e,t)||{};if(S==null)return{};const P=l7(M),N={x:n,y:i},$=fN(c),G=dN($),q=await m.getDimensions(S),V=$==="y",J=V?"top":"left",ee=V?"bottom":"right",re=V?"clientHeight":"clientWidth",fe=d.reference[G]+d.reference[$]-N[$]-d.floating[G],ne=N[$]-d.reference[$],ce=await(m.getOffsetParent==null?void 0:m.getOffsetParent(S));let me=ce?ce[re]:0;(!me||!await(m.isElement==null?void 0:m.isElement(ce)))&&(me=a.floating[re]||d.floating[G]);const ve=fe/2-ne/2,De=me/2-q[G]/2-1,Ye=uy(P[J],De),ze=uy(P[ee],De),tt=Ye,at=me-q[G]-ze,ct=me/2-q[G]/2+ve,ht=$D(tt,ct,at),Ie=!w.arrow&&T0(c)!=null&&ct!==ht&&d.reference[G]/2-(ct<tt?Ye:ze)-q[G]/2<0,rt=Ie?ct<tt?ct-tt:ct-at:0;return{[$]:N[$]+rt,data:{[$]:ht,centerOffset:ct-ht-rt,...Ie&&{alignmentOffset:rt}},reset:Ie}}}),Uue=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:c,middlewareData:d,rects:m,initialPlacement:a,platform:w,elements:S}=t,{mainAxis:M=!0,crossAxis:P=!0,fallbackPlacements:N,fallbackStrategy:$="bestFit",fallbackAxisSideDirection:G="none",flipAlignment:q=!0,...V}=jm(e,t);if((n=d.arrow)!=null&&n.alignmentOffset)return{};const J=Bm(c),ee=rp(a),re=Bm(a)===a,fe=await(w.isRTL==null?void 0:w.isRTL(S.floating)),ne=N||(re||!q?[_E(a)]:Due(a)),ce=G!=="none";!N&&ce&&ne.push(...zue(a,q,G,fe));const me=[a,...ne],ve=await kw(t,V),De=[];let Ye=((i=d.flip)==null?void 0:i.overflows)||[];if(M&&De.push(ve[J]),P){const ct=Iue(c,m,fe);De.push(ve[ct[0]],ve[ct[1]])}if(Ye=[...Ye,{placement:c,overflows:De}],!De.every(ct=>ct<=0)){var ze,tt;const ct=(((ze=d.flip)==null?void 0:ze.index)||0)+1,ht=me[ct];if(ht&&(!(P==="alignment"?ee!==rp(ht):!1)||Ye.every(Qe=>rp(Qe.placement)===ee?Qe.overflows[0]>0:!0)))return{data:{index:ct,overflows:Ye},reset:{placement:ht}};let Ie=(tt=Ye.filter(rt=>rt.overflows[0]<=0).sort((rt,Qe)=>rt.overflows[1]-Qe.overflows[1])[0])==null?void 0:tt.placement;if(!Ie)switch($){case"bestFit":{var at;const rt=(at=Ye.filter(Qe=>{if(ce){const St=rp(Qe.placement);return St===ee||St==="y"}return!0}).map(Qe=>[Qe.placement,Qe.overflows.filter(St=>St>0).reduce((St,qe)=>St+qe,0)]).sort((Qe,St)=>Qe[1]-St[1])[0])==null?void 0:at[0];rt&&(Ie=rt);break}case"initialPlacement":Ie=a;break}if(c!==Ie)return{reset:{placement:Ie}}}return{}}}};function v5(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function x5(e){return Mue.some(t=>e[t]>=0)}const $ue=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...c}=jm(e,t);switch(i){case"referenceHidden":{const d=await kw(t,{...c,elementContext:"reference"}),m=v5(d,n.reference);return{data:{referenceHiddenOffsets:m,referenceHidden:x5(m)}}}case"escaped":{const d=await kw(t,{...c,altBoundary:!0}),m=v5(d,n.floating);return{data:{escapedOffsets:m,escaped:x5(m)}}}default:return{}}}}},c7=new Set(["left","top"]);async function que(e,t){const{placement:n,platform:i,elements:c}=e,d=await(i.isRTL==null?void 0:i.isRTL(c.floating)),m=Bm(n),a=T0(n),w=rp(n)==="y",S=c7.has(m)?-1:1,M=d&&w?-1:1,P=jm(t,e);let{mainAxis:N,crossAxis:$,alignmentAxis:G}=typeof P=="number"?{mainAxis:P,crossAxis:0,alignmentAxis:null}:{mainAxis:P.mainAxis||0,crossAxis:P.crossAxis||0,alignmentAxis:P.alignmentAxis};return a&&typeof G=="number"&&($=a==="end"?G*-1:G),w?{x:$*M,y:N*S}:{x:N*S,y:$*M}}const Hue=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:c,y:d,placement:m,middlewareData:a}=t,w=await que(t,e);return m===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:c+w.x,y:d+w.y,data:{...w,placement:m}}}}},Gue=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:c}=t,{mainAxis:d=!0,crossAxis:m=!1,limiter:a={fn:V=>{let{x:J,y:ee}=V;return{x:J,y:ee}}},...w}=jm(e,t),S={x:n,y:i},M=await kw(t,w),P=rp(Bm(c)),N=hN(P);let $=S[N],G=S[P];if(d){const V=N==="y"?"top":"left",J=N==="y"?"bottom":"right",ee=$+M[V],re=$-M[J];$=$D(ee,$,re)}if(m){const V=P==="y"?"top":"left",J=P==="y"?"bottom":"right",ee=G+M[V],re=G-M[J];G=$D(ee,G,re)}const q=a.fn({...t,[N]:$,[P]:G});return{...q,data:{x:q.x-n,y:q.y-i,enabled:{[N]:d,[P]:m}}}}}},Wue=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:c,rects:d,middlewareData:m}=t,{offset:a=0,mainAxis:w=!0,crossAxis:S=!0}=jm(e,t),M={x:n,y:i},P=rp(c),N=hN(P);let $=M[N],G=M[P];const q=jm(a,t),V=typeof q=="number"?{mainAxis:q,crossAxis:0}:{mainAxis:0,crossAxis:0,...q};if(w){const re=N==="y"?"height":"width",fe=d.reference[N]-d.floating[re]+V.mainAxis,ne=d.reference[N]+d.reference[re]-V.mainAxis;$<fe?$=fe:$>ne&&($=ne)}if(S){var J,ee;const re=N==="y"?"width":"height",fe=c7.has(Bm(c)),ne=d.reference[P]-d.floating[re]+(fe&&((J=m.offset)==null?void 0:J[P])||0)+(fe?0:V.crossAxis),ce=d.reference[P]+d.reference[re]+(fe?0:((ee=m.offset)==null?void 0:ee[P])||0)-(fe?V.crossAxis:0);G<ne?G=ne:G>ce&&(G=ce)}return{[N]:$,[P]:G}}}},Xue=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:c,rects:d,platform:m,elements:a}=t,{apply:w=()=>{},...S}=jm(e,t),M=await kw(t,S),P=Bm(c),N=T0(c),$=rp(c)==="y",{width:G,height:q}=d.floating;let V,J;P==="top"||P==="bottom"?(V=P,J=N===(await(m.isRTL==null?void 0:m.isRTL(a.floating))?"start":"end")?"left":"right"):(J=P,V=N==="end"?"top":"bottom");const ee=q-M.top-M.bottom,re=G-M.left-M.right,fe=uy(q-M[V],ee),ne=uy(G-M[J],re),ce=!t.middlewareData.shift;let me=fe,ve=ne;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(ve=re),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(me=ee),ce&&!N){const Ye=eh(M.left,0),ze=eh(M.right,0),tt=eh(M.top,0),at=eh(M.bottom,0);$?ve=G-2*(Ye!==0||ze!==0?Ye+ze:eh(M.left,M.right)):me=q-2*(tt!==0||at!==0?tt+at:eh(M.top,M.bottom))}await w({...t,availableWidth:ve,availableHeight:me});const De=await m.getDimensions(a.floating);return G!==De.width||q!==De.height?{reset:{rects:!0}}:{}}}};function d2(){return typeof window<"u"}function E0(e){return u7(e)?(e.nodeName||"").toLowerCase():"#document"}function nh(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function xp(e){var t;return(t=(u7(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function u7(e){return d2()?e instanceof Node||e instanceof nh(e).Node:!1}function Kd(e){return d2()?e instanceof Element||e instanceof nh(e).Element:!1}function gp(e){return d2()?e instanceof HTMLElement||e instanceof nh(e).HTMLElement:!1}function b5(e){return!d2()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof nh(e).ShadowRoot}const Zue=new Set(["inline","contents"]);function q1(e){const{overflow:t,overflowX:n,overflowY:i,display:c}=Jd(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!Zue.has(c)}const Yue=new Set(["table","td","th"]);function Kue(e){return Yue.has(E0(e))}const Jue=[":popover-open",":modal"];function f2(e){return Jue.some(t=>{try{return e.matches(t)}catch{return!1}})}const Que=["transform","translate","scale","rotate","perspective"],ehe=["transform","translate","scale","rotate","perspective","filter"],the=["paint","layout","strict","content"];function pN(e){const t=mN(),n=Kd(e)?Jd(e):e;return Que.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||ehe.some(i=>(n.willChange||"").includes(i))||the.some(i=>(n.contain||"").includes(i))}function nhe(e){let t=hy(e);for(;gp(t)&&!Vx(t);){if(pN(t))return t;if(f2(t))return null;t=hy(t)}return null}function mN(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const rhe=new Set(["html","body","#document"]);function Vx(e){return rhe.has(E0(e))}function Jd(e){return nh(e).getComputedStyle(e)}function p2(e){return Kd(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function hy(e){if(E0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||b5(e)&&e.host||xp(e);return b5(t)?t.host:t}function h7(e){const t=hy(e);return Vx(t)?e.ownerDocument?e.ownerDocument.body:e.body:gp(t)&&q1(t)?t:h7(t)}function Lw(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const c=h7(e),d=c===((i=e.ownerDocument)==null?void 0:i.body),m=nh(c);if(d){const a=HD(m);return t.concat(m,m.visualViewport||[],q1(c)?c:[],a&&n?Lw(a):[])}return t.concat(c,Lw(c,[],n))}function HD(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function d7(e){const t=Jd(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const c=gp(e),d=c?e.offsetWidth:n,m=c?e.offsetHeight:i,a=yE(n)!==d||yE(i)!==m;return a&&(n=d,i=m),{width:n,height:i,$:a}}function gN(e){return Kd(e)?e:e.contextElement}function Ox(e){const t=gN(e);if(!gp(t))return lp(1);const n=t.getBoundingClientRect(),{width:i,height:c,$:d}=d7(t);let m=(d?yE(n.width):n.width)/i,a=(d?yE(n.height):n.height)/c;return(!m||!Number.isFinite(m))&&(m=1),(!a||!Number.isFinite(a))&&(a=1),{x:m,y:a}}const ihe=lp(0);function f7(e){const t=nh(e);return!mN()||!t.visualViewport?ihe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function ahe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==nh(e)?!1:t}function K_(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const c=e.getBoundingClientRect(),d=gN(e);let m=lp(1);t&&(i?Kd(i)&&(m=Ox(i)):m=Ox(e));const a=ahe(d,n,i)?f7(d):lp(0);let w=(c.left+a.x)/m.x,S=(c.top+a.y)/m.y,M=c.width/m.x,P=c.height/m.y;if(d){const N=nh(d),$=i&&Kd(i)?nh(i):i;let G=N,q=HD(G);for(;q&&i&&$!==G;){const V=Ox(q),J=q.getBoundingClientRect(),ee=Jd(q),re=J.left+(q.clientLeft+parseFloat(ee.paddingLeft))*V.x,fe=J.top+(q.clientTop+parseFloat(ee.paddingTop))*V.y;w*=V.x,S*=V.y,M*=V.x,P*=V.y,w+=re,S+=fe,G=nh(q),q=HD(G)}}return vE({width:M,height:P,x:w,y:S})}function yN(e,t){const n=p2(e).scrollLeft;return t?t.left+n:K_(xp(e)).left+n}function p7(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),c=i.left+t.scrollLeft-(n?0:yN(e,i)),d=i.top+t.scrollTop;return{x:c,y:d}}function ohe(e){let{elements:t,rect:n,offsetParent:i,strategy:c}=e;const d=c==="fixed",m=xp(i),a=t?f2(t.floating):!1;if(i===m||a&&d)return n;let w={scrollLeft:0,scrollTop:0},S=lp(1);const M=lp(0),P=gp(i);if((P||!P&&!d)&&((E0(i)!=="body"||q1(m))&&(w=p2(i)),gp(i))){const $=K_(i);S=Ox(i),M.x=$.x+i.clientLeft,M.y=$.y+i.clientTop}const N=m&&!P&&!d?p7(m,w,!0):lp(0);return{width:n.width*S.x,height:n.height*S.y,x:n.x*S.x-w.scrollLeft*S.x+M.x+N.x,y:n.y*S.y-w.scrollTop*S.y+M.y+N.y}}function she(e){return Array.from(e.getClientRects())}function lhe(e){const t=xp(e),n=p2(e),i=e.ownerDocument.body,c=eh(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),d=eh(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let m=-n.scrollLeft+yN(e);const a=-n.scrollTop;return Jd(i).direction==="rtl"&&(m+=eh(t.clientWidth,i.clientWidth)-c),{width:c,height:d,x:m,y:a}}function che(e,t){const n=nh(e),i=xp(e),c=n.visualViewport;let d=i.clientWidth,m=i.clientHeight,a=0,w=0;if(c){d=c.width,m=c.height;const S=mN();(!S||S&&t==="fixed")&&(a=c.offsetLeft,w=c.offsetTop)}return{width:d,height:m,x:a,y:w}}const uhe=new Set(["absolute","fixed"]);function hhe(e,t){const n=K_(e,!0,t==="fixed"),i=n.top+e.clientTop,c=n.left+e.clientLeft,d=gp(e)?Ox(e):lp(1),m=e.clientWidth*d.x,a=e.clientHeight*d.y,w=c*d.x,S=i*d.y;return{width:m,height:a,x:w,y:S}}function w5(e,t,n){let i;if(t==="viewport")i=che(e,n);else if(t==="document")i=lhe(xp(e));else if(Kd(t))i=hhe(t,n);else{const c=f7(e);i={x:t.x-c.x,y:t.y-c.y,width:t.width,height:t.height}}return vE(i)}function m7(e,t){const n=hy(e);return n===t||!Kd(n)||Vx(n)?!1:Jd(n).position==="fixed"||m7(n,t)}function dhe(e,t){const n=t.get(e);if(n)return n;let i=Lw(e,[],!1).filter(a=>Kd(a)&&E0(a)!=="body"),c=null;const d=Jd(e).position==="fixed";let m=d?hy(e):e;for(;Kd(m)&&!Vx(m);){const a=Jd(m),w=pN(m);!w&&a.position==="fixed"&&(c=null),(d?!w&&!c:!w&&a.position==="static"&&!!c&&uhe.has(c.position)||q1(m)&&!w&&m7(e,m))?i=i.filter(M=>M!==m):c=a,m=hy(m)}return t.set(e,i),i}function fhe(e){let{element:t,boundary:n,rootBoundary:i,strategy:c}=e;const m=[...n==="clippingAncestors"?f2(t)?[]:dhe(t,this._c):[].concat(n),i],a=m[0],w=m.reduce((S,M)=>{const P=w5(t,M,c);return S.top=eh(P.top,S.top),S.right=uy(P.right,S.right),S.bottom=uy(P.bottom,S.bottom),S.left=eh(P.left,S.left),S},w5(t,a,c));return{width:w.right-w.left,height:w.bottom-w.top,x:w.left,y:w.top}}function phe(e){const{width:t,height:n}=d7(e);return{width:t,height:n}}function mhe(e,t,n){const i=gp(t),c=xp(t),d=n==="fixed",m=K_(e,!0,d,t);let a={scrollLeft:0,scrollTop:0};const w=lp(0);function S(){w.x=yN(c)}if(i||!i&&!d)if((E0(t)!=="body"||q1(c))&&(a=p2(t)),i){const $=K_(t,!0,d,t);w.x=$.x+t.clientLeft,w.y=$.y+t.clientTop}else c&&S();d&&!i&&c&&S();const M=c&&!i&&!d?p7(c,a):lp(0),P=m.left+a.scrollLeft-w.x-M.x,N=m.top+a.scrollTop-w.y-M.y;return{x:P,y:N,width:m.width,height:m.height}}function GM(e){return Jd(e).position==="static"}function S5(e,t){if(!gp(e)||Jd(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return xp(e)===n&&(n=n.ownerDocument.body),n}function g7(e,t){const n=nh(e);if(f2(e))return n;if(!gp(e)){let c=hy(e);for(;c&&!Vx(c);){if(Kd(c)&&!GM(c))return c;c=hy(c)}return n}let i=S5(e,t);for(;i&&Kue(i)&&GM(i);)i=S5(i,t);return i&&Vx(i)&&GM(i)&&!pN(i)?n:i||nhe(e)||n}const ghe=async function(e){const t=this.getOffsetParent||g7,n=this.getDimensions,i=await n(e.floating);return{reference:mhe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function yhe(e){return Jd(e).direction==="rtl"}const _he={convertOffsetParentRelativeRectToViewportRelativeRect:ohe,getDocumentElement:xp,getClippingRect:fhe,getOffsetParent:g7,getElementRects:ghe,getClientRects:she,getDimensions:phe,getScale:Ox,isElement:Kd,isRTL:yhe};function y7(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function vhe(e,t){let n=null,i;const c=xp(e);function d(){var a;clearTimeout(i),(a=n)==null||a.disconnect(),n=null}function m(a,w){a===void 0&&(a=!1),w===void 0&&(w=1),d();const S=e.getBoundingClientRect(),{left:M,top:P,width:N,height:$}=S;if(a||t(),!N||!$)return;const G=LT(P),q=LT(c.clientWidth-(M+N)),V=LT(c.clientHeight-(P+$)),J=LT(M),re={rootMargin:-G+"px "+-q+"px "+-V+"px "+-J+"px",threshold:eh(0,uy(1,w))||1};let fe=!0;function ne(ce){const me=ce[0].intersectionRatio;if(me!==w){if(!fe)return m();me?m(!1,me):i=setTimeout(()=>{m(!1,1e-7)},1e3)}me===1&&!y7(S,e.getBoundingClientRect())&&m(),fe=!1}try{n=new IntersectionObserver(ne,{...re,root:c.ownerDocument})}catch{n=new IntersectionObserver(ne,re)}n.observe(e)}return m(!0),d}function xhe(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:c=!0,ancestorResize:d=!0,elementResize:m=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:w=!1}=i,S=gN(e),M=c||d?[...S?Lw(S):[],...Lw(t)]:[];M.forEach(J=>{c&&J.addEventListener("scroll",n,{passive:!0}),d&&J.addEventListener("resize",n)});const P=S&&a?vhe(S,n):null;let N=-1,$=null;m&&($=new ResizeObserver(J=>{let[ee]=J;ee&&ee.target===S&&$&&($.unobserve(t),cancelAnimationFrame(N),N=requestAnimationFrame(()=>{var re;(re=$)==null||re.observe(t)})),n()}),S&&!w&&$.observe(S),$.observe(t));let G,q=w?K_(e):null;w&&V();function V(){const J=K_(e);q&&!y7(q,J)&&n(),q=J,G=requestAnimationFrame(V)}return n(),()=>{var J;M.forEach(ee=>{c&&ee.removeEventListener("scroll",n),d&&ee.removeEventListener("resize",n)}),P?.(),(J=$)==null||J.disconnect(),$=null,w&&cancelAnimationFrame(G)}}const bhe=Hue,whe=Gue,She=Uue,The=Xue,Ehe=$ue,T5=Fue,Ahe=Wue,Che=(e,t,n)=>{const i=new Map,c={platform:_he,...n},d={...c.platform,_c:i};return Bue(e,t,{...c,platform:d})};var Mhe=typeof document<"u",Phe=function(){},sE=Mhe?K.useLayoutEffect:Phe;function xE(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,c;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!xE(e[i],t[i]))return!1;return!0}if(c=Object.keys(e),n=c.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,c[i]))return!1;for(i=n;i--!==0;){const d=c[i];if(!(d==="_owner"&&e.$$typeof)&&!xE(e[d],t[d]))return!1}return!0}return e!==e&&t!==t}function _7(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function E5(e,t){const n=_7(e);return Math.round(t*n)/n}function WM(e){const t=K.useRef(e);return sE(()=>{t.current=e}),t}function Ohe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:c,elements:{reference:d,floating:m}={},transform:a=!0,whileElementsMounted:w,open:S}=e,[M,P]=K.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[N,$]=K.useState(i);xE(N,i)||$(i);const[G,q]=K.useState(null),[V,J]=K.useState(null),ee=K.useCallback(Qe=>{Qe!==ce.current&&(ce.current=Qe,q(Qe))},[]),re=K.useCallback(Qe=>{Qe!==me.current&&(me.current=Qe,J(Qe))},[]),fe=d||G,ne=m||V,ce=K.useRef(null),me=K.useRef(null),ve=K.useRef(M),De=w!=null,Ye=WM(w),ze=WM(c),tt=WM(S),at=K.useCallback(()=>{if(!ce.current||!me.current)return;const Qe={placement:t,strategy:n,middleware:N};ze.current&&(Qe.platform=ze.current),Che(ce.current,me.current,Qe).then(St=>{const qe={...St,isPositioned:tt.current!==!1};ct.current&&!xE(ve.current,qe)&&(ve.current=qe,k1.flushSync(()=>{P(qe)}))})},[N,t,n,ze,tt]);sE(()=>{S===!1&&ve.current.isPositioned&&(ve.current.isPositioned=!1,P(Qe=>({...Qe,isPositioned:!1})))},[S]);const ct=K.useRef(!1);sE(()=>(ct.current=!0,()=>{ct.current=!1}),[]),sE(()=>{if(fe&&(ce.current=fe),ne&&(me.current=ne),fe&&ne){if(Ye.current)return Ye.current(fe,ne,at);at()}},[fe,ne,at,Ye,De]);const ht=K.useMemo(()=>({reference:ce,floating:me,setReference:ee,setFloating:re}),[ee,re]),Ie=K.useMemo(()=>({reference:fe,floating:ne}),[fe,ne]),rt=K.useMemo(()=>{const Qe={position:n,left:0,top:0};if(!Ie.floating)return Qe;const St=E5(Ie.floating,M.x),qe=E5(Ie.floating,M.y);return a?{...Qe,transform:"translate("+St+"px, "+qe+"px)",..._7(Ie.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:St,top:qe}},[n,a,Ie.floating,M.x,M.y]);return K.useMemo(()=>({...M,update:at,refs:ht,elements:Ie,floatingStyles:rt}),[M,at,ht,Ie,rt])}const Rhe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:c}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?T5({element:i.current,padding:c}).fn(n):{}:i?T5({element:i,padding:c}).fn(n):{}}}},Ihe=(e,t)=>({...bhe(e),options:[e,t]}),Dhe=(e,t)=>({...whe(e),options:[e,t]}),khe=(e,t)=>({...Ahe(e),options:[e,t]}),Lhe=(e,t)=>({...She(e),options:[e,t]}),Nhe=(e,t)=>({...The(e),options:[e,t]}),zhe=(e,t)=>({...Ehe(e),options:[e,t]}),jhe=(e,t)=>({...Rhe(e),options:[e,t]});var Bhe="Arrow",v7=K.forwardRef((e,t)=>{const{children:n,width:i=10,height:c=5,...d}=e;return D.jsx(ii.svg,{...d,ref:t,width:i,height:c,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:D.jsx("polygon",{points:"0,0 30,0 15,10"})})});v7.displayName=Bhe;var Fhe=v7;function Vhe(e){const[t,n]=K.useState(void 0);return qs(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(c=>{if(!Array.isArray(c)||!c.length)return;const d=c[0];let m,a;if("borderBoxSize"in d){const w=d.borderBoxSize,S=Array.isArray(w)?w[0]:w;m=S.inlineSize,a=S.blockSize}else m=e.offsetWidth,a=e.offsetHeight;n({width:m,height:a})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var _N="Popper",[x7,gy]=ih(_N),[Uhe,b7]=x7(_N),w7=e=>{const{__scopePopper:t,children:n}=e,[i,c]=K.useState(null);return D.jsx(Uhe,{scope:t,anchor:i,onAnchorChange:c,children:n})};w7.displayName=_N;var S7="PopperAnchor",T7=K.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...c}=e,d=b7(S7,n),m=K.useRef(null),a=ba(t,m),w=K.useRef(null);return K.useEffect(()=>{const S=w.current;w.current=i?.current||m.current,S!==w.current&&d.onAnchorChange(w.current)}),i?null:D.jsx(ii.div,{...c,ref:a})});T7.displayName=S7;var vN="PopperContent",[$he,qhe]=x7(vN),E7=K.forwardRef((e,t)=>{const{__scopePopper:n,side:i="bottom",sideOffset:c=0,align:d="center",alignOffset:m=0,arrowPadding:a=0,avoidCollisions:w=!0,collisionBoundary:S=[],collisionPadding:M=0,sticky:P="partial",hideWhenDetached:N=!1,updatePositionStrategy:$="optimized",onPlaced:G,...q}=e,V=b7(vN,n),[J,ee]=K.useState(null),re=ba(t,Ht=>ee(Ht)),[fe,ne]=K.useState(null),ce=Vhe(fe),me=ce?.width??0,ve=ce?.height??0,De=i+(d!=="center"?"-"+d:""),Ye=typeof M=="number"?M:{top:0,right:0,bottom:0,left:0,...M},ze=Array.isArray(S)?S:[S],tt=ze.length>0,at={padding:Ye,boundary:ze.filter(Ghe),altBoundary:tt},{refs:ct,floatingStyles:ht,placement:Ie,isPositioned:rt,middlewareData:Qe}=Ohe({strategy:"fixed",placement:De,whileElementsMounted:(...Ht)=>xhe(...Ht,{animationFrame:$==="always"}),elements:{reference:V.anchor},middleware:[Ihe({mainAxis:c+ve,alignmentAxis:m}),w&&Dhe({mainAxis:!0,crossAxis:!1,limiter:P==="partial"?khe():void 0,...at}),w&&Lhe({...at}),Nhe({...at,apply:({elements:Ht,rects:mn,availableWidth:en,availableHeight:En})=>{const{width:Xn,height:cn}=mn.reference,Jr=Ht.floating.style;Jr.setProperty("--radix-popper-available-width",`${en}px`),Jr.setProperty("--radix-popper-available-height",`${En}px`),Jr.setProperty("--radix-popper-anchor-width",`${Xn}px`),Jr.setProperty("--radix-popper-anchor-height",`${cn}px`)}}),fe&&jhe({element:fe,padding:a}),Whe({arrowWidth:me,arrowHeight:ve}),N&&zhe({strategy:"referenceHidden",...at})]}),[St,qe]=M7(Ie),vt=Yd(G);qs(()=>{rt&&vt?.()},[rt,vt]);const nt=Qe.arrow?.x,gt=Qe.arrow?.y,Ut=Qe.arrow?.centerOffset!==0,[$t,qt]=K.useState();return qs(()=>{J&&qt(window.getComputedStyle(J).zIndex)},[J]),D.jsx("div",{ref:ct.setFloating,"data-radix-popper-content-wrapper":"",style:{...ht,transform:rt?ht.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:$t,"--radix-popper-transform-origin":[Qe.transformOrigin?.x,Qe.transformOrigin?.y].join(" "),...Qe.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:D.jsx($he,{scope:n,placedSide:St,onArrowChange:ne,arrowX:nt,arrowY:gt,shouldHideArrow:Ut,children:D.jsx(ii.div,{"data-side":St,"data-align":qe,...q,ref:re,style:{...q.style,animation:rt?void 0:"none"}})})})});E7.displayName=vN;var A7="PopperArrow",Hhe={top:"bottom",right:"left",bottom:"top",left:"right"},C7=K.forwardRef(function(t,n){const{__scopePopper:i,...c}=t,d=qhe(A7,i),m=Hhe[d.placedSide];return D.jsx("span",{ref:d.onArrowChange,style:{position:"absolute",left:d.arrowX,top:d.arrowY,[m]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[d.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[d.placedSide],visibility:d.shouldHideArrow?"hidden":void 0},children:D.jsx(Fhe,{...c,ref:n,style:{...c.style,display:"block"}})})});C7.displayName=A7;function Ghe(e){return e!==null}var Whe=e=>({name:"transformOrigin",options:e,fn(t){const{placement:n,rects:i,middlewareData:c}=t,m=c.arrow?.centerOffset!==0,a=m?0:e.arrowWidth,w=m?0:e.arrowHeight,[S,M]=M7(n),P={start:"0%",center:"50%",end:"100%"}[M],N=(c.arrow?.x??0)+a/2,$=(c.arrow?.y??0)+w/2;let G="",q="";return S==="bottom"?(G=m?P:`${N}px`,q=`${-w}px`):S==="top"?(G=m?P:`${N}px`,q=`${i.floating.height+w}px`):S==="right"?(G=`${-w}px`,q=m?P:`${$}px`):S==="left"&&(G=`${i.floating.width+w}px`,q=m?P:`${$}px`),{data:{x:G,y:q}}}});function M7(e){const[t,n="center"]=e.split("-");return[t,n]}var m2=w7,H1=T7,g2=E7,y2=C7,P7=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Xhe="VisuallyHidden",O7=K.forwardRef((e,t)=>D.jsx(ii.span,{...e,ref:t,style:{...P7,...e.style}}));O7.displayName=Xhe;var Zhe=O7,[_2,OBe]=ih("Tooltip",[gy]),v2=gy(),R7="TooltipProvider",Yhe=700,GD="tooltip.open",[Khe,xN]=_2(R7),I7=e=>{const{__scopeTooltip:t,delayDuration:n=Yhe,skipDelayDuration:i=300,disableHoverableContent:c=!1,children:d}=e,m=K.useRef(!0),a=K.useRef(!1),w=K.useRef(0);return K.useEffect(()=>{const S=w.current;return()=>window.clearTimeout(S)},[]),D.jsx(Khe,{scope:t,isOpenDelayedRef:m,delayDuration:n,onOpen:K.useCallback(()=>{window.clearTimeout(w.current),m.current=!1},[]),onClose:K.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>m.current=!0,i)},[i]),isPointerInTransitRef:a,onPointerInTransitChange:K.useCallback(S=>{a.current=S},[]),disableHoverableContent:c,children:d})};I7.displayName=R7;var Nw="Tooltip",[Jhe,G1]=_2(Nw),D7=e=>{const{__scopeTooltip:t,children:n,open:i,defaultOpen:c,onOpenChange:d,disableHoverableContent:m,delayDuration:a}=e,w=xN(Nw,e.__scopeTooltip),S=v2(t),[M,P]=K.useState(null),N=ol(),$=K.useRef(0),G=m??w.disableHoverableContent,q=a??w.delayDuration,V=K.useRef(!1),[J,ee]=mp({prop:i,defaultProp:c??!1,onChange:me=>{me?(w.onOpen(),document.dispatchEvent(new CustomEvent(GD))):w.onClose(),d?.(me)},caller:Nw}),re=K.useMemo(()=>J?V.current?"delayed-open":"instant-open":"closed",[J]),fe=K.useCallback(()=>{window.clearTimeout($.current),$.current=0,V.current=!1,ee(!0)},[ee]),ne=K.useCallback(()=>{window.clearTimeout($.current),$.current=0,ee(!1)},[ee]),ce=K.useCallback(()=>{window.clearTimeout($.current),$.current=window.setTimeout(()=>{V.current=!0,ee(!0),$.current=0},q)},[q,ee]);return K.useEffect(()=>()=>{$.current&&(window.clearTimeout($.current),$.current=0)},[]),D.jsx(m2,{...S,children:D.jsx(Jhe,{scope:t,contentId:N,open:J,stateAttribute:re,trigger:M,onTriggerChange:P,onTriggerEnter:K.useCallback(()=>{w.isOpenDelayedRef.current?ce():fe()},[w.isOpenDelayedRef,ce,fe]),onTriggerLeave:K.useCallback(()=>{G?ne():(window.clearTimeout($.current),$.current=0)},[ne,G]),onOpen:fe,onClose:ne,disableHoverableContent:G,children:n})})};D7.displayName=Nw;var WD="TooltipTrigger",k7=K.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,c=G1(WD,n),d=xN(WD,n),m=v2(n),a=K.useRef(null),w=ba(t,a,c.onTriggerChange),S=K.useRef(!1),M=K.useRef(!1),P=K.useCallback(()=>S.current=!1,[]);return K.useEffect(()=>()=>document.removeEventListener("pointerup",P),[P]),D.jsx(H1,{asChild:!0,...m,children:D.jsx(ii.button,{"aria-describedby":c.open?c.contentId:void 0,"data-state":c.stateAttribute,...i,ref:w,onPointerMove:vr(e.onPointerMove,N=>{N.pointerType!=="touch"&&!M.current&&!d.isPointerInTransitRef.current&&(c.onTriggerEnter(),M.current=!0)}),onPointerLeave:vr(e.onPointerLeave,()=>{c.onTriggerLeave(),M.current=!1}),onPointerDown:vr(e.onPointerDown,()=>{c.open&&c.onClose(),S.current=!0,document.addEventListener("pointerup",P,{once:!0})}),onFocus:vr(e.onFocus,()=>{S.current||c.onOpen()}),onBlur:vr(e.onBlur,c.onClose),onClick:vr(e.onClick,c.onClose)})})});k7.displayName=WD;var bN="TooltipPortal",[Qhe,ede]=_2(bN,{forceMount:void 0}),L7=e=>{const{__scopeTooltip:t,forceMount:n,children:i,container:c}=e,d=G1(bN,t);return D.jsx(Qhe,{scope:t,forceMount:n,children:D.jsx(ah,{present:n||d.open,children:D.jsx(S0,{asChild:!0,container:c,children:i})})})};L7.displayName=bN;var Ux="TooltipContent",N7=K.forwardRef((e,t)=>{const n=ede(Ux,e.__scopeTooltip),{forceMount:i=n.forceMount,side:c="top",...d}=e,m=G1(Ux,e.__scopeTooltip);return D.jsx(ah,{present:i||m.open,children:m.disableHoverableContent?D.jsx(z7,{side:c,...d,ref:t}):D.jsx(tde,{side:c,...d,ref:t})})}),tde=K.forwardRef((e,t)=>{const n=G1(Ux,e.__scopeTooltip),i=xN(Ux,e.__scopeTooltip),c=K.useRef(null),d=ba(t,c),[m,a]=K.useState(null),{trigger:w,onClose:S}=n,M=c.current,{onPointerInTransitChange:P}=i,N=K.useCallback(()=>{a(null),P(!1)},[P]),$=K.useCallback((G,q)=>{const V=G.currentTarget,J={x:G.clientX,y:G.clientY},ee=ade(J,V.getBoundingClientRect()),re=ode(J,ee),fe=sde(q.getBoundingClientRect()),ne=cde([...re,...fe]);a(ne),P(!0)},[P]);return K.useEffect(()=>()=>N(),[N]),K.useEffect(()=>{if(w&&M){const G=V=>$(V,M),q=V=>$(V,w);return w.addEventListener("pointerleave",G),M.addEventListener("pointerleave",q),()=>{w.removeEventListener("pointerleave",G),M.removeEventListener("pointerleave",q)}}},[w,M,$,N]),K.useEffect(()=>{if(m){const G=q=>{const V=q.target,J={x:q.clientX,y:q.clientY},ee=w?.contains(V)||M?.contains(V),re=!lde(J,m);ee?N():re&&(N(),S())};return document.addEventListener("pointermove",G),()=>document.removeEventListener("pointermove",G)}},[w,M,m,S,N]),D.jsx(z7,{...e,ref:d})}),[nde,rde]=_2(Nw,{isInside:!1}),ide=pW("TooltipContent"),z7=K.forwardRef((e,t)=>{const{__scopeTooltip:n,children:i,"aria-label":c,onEscapeKeyDown:d,onPointerDownOutside:m,...a}=e,w=G1(Ux,n),S=v2(n),{onClose:M}=w;return K.useEffect(()=>(document.addEventListener(GD,M),()=>document.removeEventListener(GD,M)),[M]),K.useEffect(()=>{if(w.trigger){const P=N=>{N.target?.contains(w.trigger)&&M()};return window.addEventListener("scroll",P,{capture:!0}),()=>window.removeEventListener("scroll",P,{capture:!0})}},[w.trigger,M]),D.jsx(w0,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:P=>P.preventDefault(),onDismiss:M,children:D.jsxs(g2,{"data-state":w.stateAttribute,...S,...a,ref:t,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[D.jsx(ide,{children:i}),D.jsx(nde,{scope:n,isInside:!0,children:D.jsx(Zhe,{id:w.contentId,role:"tooltip",children:c||i})})]})})});N7.displayName=Ux;var j7="TooltipArrow",B7=K.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,c=v2(n);return rde(j7,n).isInside?null:D.jsx(y2,{...c,...i,ref:t})});B7.displayName=j7;function ade(e,t){const n=Math.abs(t.top-e.y),i=Math.abs(t.bottom-e.y),c=Math.abs(t.right-e.x),d=Math.abs(t.left-e.x);switch(Math.min(n,i,c,d)){case d:return"left";case c:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function ode(e,t,n=5){const i=[];switch(t){case"top":i.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":i.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":i.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":i.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return i}function sde(e){const{top:t,right:n,bottom:i,left:c}=e;return[{x:c,y:t},{x:n,y:t},{x:n,y:i},{x:c,y:i}]}function lde(e,t){const{x:n,y:i}=e;let c=!1;for(let d=0,m=t.length-1;d<t.length;m=d++){const a=t[d],w=t[m],S=a.x,M=a.y,P=w.x,N=w.y;M>i!=N>i&&n<(P-S)*(i-M)/(N-M)+S&&(c=!c)}return c}function cde(e){const t=e.slice();return t.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),ude(t)}function ude(e){if(e.length<=1)return e.slice();const t=[];for(let i=0;i<e.length;i++){const c=e[i];for(;t.length>=2;){const d=t[t.length-1],m=t[t.length-2];if((d.x-m.x)*(c.y-m.y)>=(d.y-m.y)*(c.x-m.x))t.pop();else break}t.push(c)}t.pop();const n=[];for(let i=e.length-1;i>=0;i--){const c=e[i];for(;n.length>=2;){const d=n[n.length-1],m=n[n.length-2];if((d.x-m.x)*(c.y-m.y)>=(d.y-m.y)*(c.x-m.x))n.pop();else break}n.push(c)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var hde=I7,dde=D7,fde=k7,pde=L7,mde=N7,gde=B7;function F7({delayDuration:e=0,...t}){return D.jsx(hde,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function yde({...e}){return D.jsx(F7,{children:D.jsx(dde,{"data-slot":"tooltip",...e})})}function _de({...e}){return D.jsx(fde,{"data-slot":"tooltip-trigger",...e})}function vde({className:e,sideOffset:t=0,children:n,...i}){return D.jsx(pde,{children:D.jsxs(mde,{"data-slot":"tooltip-content",sideOffset:t,className:bn("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...i,children:[n,D.jsx(gde,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const xde="sidebar_state",bde=3600*24*7,wde="16rem",Sde="18rem",Tde="3rem",Ede="b",V7=K.createContext(null);function W1(){const e=K.useContext(V7);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}function bE({defaultOpen:e=!0,open:t,onOpenChange:n,className:i,style:c,children:d,...m}){const a=Ele(),[w,S]=K.useState(!1),[M,P]=K.useState(e),N=t??M,$=K.useCallback(J=>{const ee=typeof J=="function"?J(N):J;n?n(ee):P(ee),document.cookie=`${xde}=${ee}; path=/; max-age=${bde}`},[n,N]),G=K.useCallback(()=>a?S(J=>!J):$(J=>!J),[a,$,S]);K.useEffect(()=>{const J=ee=>{ee.key===Ede&&(ee.metaKey||ee.ctrlKey)&&(ee.preventDefault(),G())};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[G]);const q=N?"expanded":"collapsed",V=K.useMemo(()=>({state:q,open:N,setOpen:$,isMobile:a,openMobile:w,setOpenMobile:S,toggleSidebar:G}),[q,N,$,a,w,S,G]);return D.jsx(V7.Provider,{value:V,children:D.jsx(F7,{delayDuration:0,children:D.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":wde,"--sidebar-width-icon":Tde,...c},className:bn("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",i),...m,children:d})})})}function Ade({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:i,children:c,...d}){const{isMobile:m,state:a,openMobile:w,setOpenMobile:S}=W1();return n==="none"?D.jsx("div",{"data-slot":"sidebar",className:bn("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",i),...d,children:c}):m?D.jsx(bue,{open:w,onOpenChange:S,...d,children:D.jsxs(Tue,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":Sde},side:e,children:[D.jsxs(Eue,{className:"sr-only",children:[D.jsx(Aue,{children:"Sidebar"}),D.jsx(Cue,{children:"Displays the mobile sidebar."})]}),D.jsx("div",{className:"flex h-full w-full flex-col",children:c})]})}):D.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":a,"data-collapsible":a==="collapsed"?n:"","data-variant":t,"data-side":e,"data-slot":"sidebar",children:[D.jsx("div",{"data-slot":"sidebar-gap",className:bn("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),D.jsx("div",{"data-slot":"sidebar-container",className:bn("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-0)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r-0 group-data-[side=right]:border-l",i),...d,children:D.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:c})})]})}function wE({className:e,onClick:t,...n}){const{toggleSidebar:i}=W1();return D.jsxs(na,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:bn("size-7",e),onClick:c=>{t?.(c),i()},...n,children:[D.jsx(Gse,{}),D.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function Cde({className:e,...t}){const{toggleSidebar:n}=W1();return D.jsx("button",{"data-sidebar":"rail","data-slot":"sidebar-rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:bn("hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})}function SE({className:e,...t}){return D.jsx("main",{"data-slot":"sidebar-inset",className:bn("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",e),...t})}function Mde({className:e,...t}){return D.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:bn("flex flex-col gap-2 p-2",e),...t})}function Pde({className:e,...t}){return D.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:bn("flex flex-col gap-2 p-2",e),...t})}function Ode({className:e,...t}){return D.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:bn("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t})}function Rde({className:e,...t}){return D.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:bn("relative flex w-full min-w-0 flex-col p-2",e),...t})}function Ide({className:e,asChild:t=!1,...n}){const i=t?F1:"div";return D.jsx(i,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:bn("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:hidden",e),...n})}function Dde({className:e,...t}){return D.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:bn("w-full text-sm",e),...t})}function TE({className:e,...t}){return D.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:bn("flex w-full min-w-0 flex-col gap-1",e),...t})}function EE({className:e,...t}){return D.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:bn("group/menu-item relative",e),...t})}const kde=iN("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"bg-opacity-0 hover:bg-opacity-100 hover:bg-sidebar-accent transition duration-100 hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function XD({asChild:e=!1,isActive:t=!1,variant:n="default",size:i="default",tooltip:c,className:d,...m}){const a=e?F1:"button",{isMobile:w,state:S}=W1(),M=D.jsx(a,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":i,"data-active":t,className:bn(kde({variant:n,size:i}),d),...m});return c?(typeof c=="string"&&(c={children:c}),D.jsxs(yde,{children:[D.jsx(_de,{asChild:!0,children:M}),D.jsx(vde,{side:"right",align:"center",hidden:S!=="collapsed"||w,...c})]})):M}function Lde({data:e}){const t=location.pathname;return D.jsx(Rde,{children:D.jsx(Dde,{className:"flex flex-col gap-2",children:e.map((n,i)=>n.NavGroup?D.jsxs("div",{children:[D.jsx(Ide,{children:n.NavGroup.NavLabel}),D.jsx(TE,{children:n.NavGroup.NavItems.map((c,d)=>D.jsx(EE,{children:D.jsx(XD,{className:"data-[active=true]:bg-[var(--vivid-indigo)]",asChild:!0,isActive:c.url==t,children:D.jsxs(fc,{to:c.url,children:[D.jsx(c.icon,{}),c.title]})})},d))})]},i):n.title?D.jsx(TE,{children:D.jsx(EE,{children:D.jsx(XD,{asChild:!0,isActive:item.url==t,children:D.jsxs(fc,{to:n.url,children:[D.jsx(n.icon,{}),n.title]})})})}):null)})})}var XM={exports:{}},ZM={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A5;function Nde(){if(A5)return ZM;A5=1;var e=HA();function t(P,N){return P===N&&(P!==0||1/P===1/N)||P!==P&&N!==N}var n=typeof Object.is=="function"?Object.is:t,i=e.useState,c=e.useEffect,d=e.useLayoutEffect,m=e.useDebugValue;function a(P,N){var $=N(),G=i({inst:{value:$,getSnapshot:N}}),q=G[0].inst,V=G[1];return d(function(){q.value=$,q.getSnapshot=N,w(q)&&V({inst:q})},[P,$,N]),c(function(){return w(q)&&V({inst:q}),P(function(){w(q)&&V({inst:q})})},[P]),m($),$}function w(P){var N=P.getSnapshot;P=P.value;try{var $=N();return!n(P,$)}catch{return!0}}function S(P,N){return N()}var M=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?S:a;return ZM.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:M,ZM}var C5;function zde(){return C5||(C5=1,XM.exports=Nde()),XM.exports}var jde=zde();function Bde(){return jde.useSyncExternalStore(Fde,()=>!0,()=>!1)}function Fde(){return()=>{}}var wN="Avatar",[Vde,RBe]=ih(wN),[Ude,U7]=Vde(wN),$7=K.forwardRef((e,t)=>{const{__scopeAvatar:n,...i}=e,[c,d]=K.useState("idle");return D.jsx(Ude,{scope:n,imageLoadingStatus:c,onImageLoadingStatusChange:d,children:D.jsx(ii.span,{...i,ref:t})})});$7.displayName=wN;var q7="AvatarImage",H7=K.forwardRef((e,t)=>{const{__scopeAvatar:n,src:i,onLoadingStatusChange:c=()=>{},...d}=e,m=U7(q7,n),a=$de(i,d),w=Yd(S=>{c(S),m.onImageLoadingStatusChange(S)});return qs(()=>{a!=="idle"&&w(a)},[a,w]),a==="loaded"?D.jsx(ii.img,{...d,ref:t,src:i}):null});H7.displayName=q7;var G7="AvatarFallback",W7=K.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:i,...c}=e,d=U7(G7,n),[m,a]=K.useState(i===void 0);return K.useEffect(()=>{if(i!==void 0){const w=window.setTimeout(()=>a(!0),i);return()=>window.clearTimeout(w)}},[i]),m&&d.imageLoadingStatus!=="loaded"?D.jsx(ii.span,{...c,ref:t}):null});W7.displayName=G7;function M5(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function $de(e,{referrerPolicy:t,crossOrigin:n}){const i=Bde(),c=K.useRef(null),d=i?(c.current||(c.current=new window.Image),c.current):null,[m,a]=K.useState(()=>M5(d,e));return qs(()=>{a(M5(d,e))},[d,e]),qs(()=>{const w=P=>()=>{a(P)};if(!d)return;const S=w("loaded"),M=w("error");return d.addEventListener("load",S),d.addEventListener("error",M),t&&(d.referrerPolicy=t),typeof n=="string"&&(d.crossOrigin=n),()=>{d.removeEventListener("load",S),d.removeEventListener("error",M)}},[d,n,t]),m}var qde=$7,Hde=H7,Gde=W7;function P5({className:e,...t}){return D.jsx(qde,{"data-slot":"avatar",className:bn("relative flex size-8 shrink-0 overflow-hidden rounded-full",e),...t})}function O5({className:e,...t}){return D.jsx(Hde,{"data-slot":"avatar-image",className:bn("aspect-square size-full",e),...t})}function R5({className:e,...t}){return D.jsx(Gde,{"data-slot":"avatar-fallback",className:bn("bg-sidebar-primary flex size-full items-center justify-center rounded-full text-sidebar-primary-foreground",e),...t})}function x2(e){const t=e+"CollectionProvider",[n,i]=ih(t),[c,d]=n(t,{collectionRef:{current:null},itemMap:new Map}),m=q=>{const{scope:V,children:J}=q,ee=Ce.useRef(null),re=Ce.useRef(new Map).current;return D.jsx(c,{scope:V,itemMap:re,collectionRef:ee,children:J})};m.displayName=t;const a=e+"CollectionSlot",w=cy(a),S=Ce.forwardRef((q,V)=>{const{scope:J,children:ee}=q,re=d(a,J),fe=ba(V,re.collectionRef);return D.jsx(w,{ref:fe,children:ee})});S.displayName=a;const M=e+"CollectionItemSlot",P="data-radix-collection-item",N=cy(M),$=Ce.forwardRef((q,V)=>{const{scope:J,children:ee,...re}=q,fe=Ce.useRef(null),ne=ba(V,fe),ce=d(M,J);return Ce.useEffect(()=>(ce.itemMap.set(fe,{ref:fe,...re}),()=>void ce.itemMap.delete(fe))),D.jsx(N,{[P]:"",ref:ne,children:ee})});$.displayName=M;function G(q){const V=d(e+"CollectionConsumer",q);return Ce.useCallback(()=>{const ee=V.collectionRef.current;if(!ee)return[];const re=Array.from(ee.querySelectorAll(`[${P}]`));return Array.from(V.itemMap.values()).sort((ce,me)=>re.indexOf(ce.ref.current)-re.indexOf(me.ref.current))},[V.collectionRef,V.itemMap])}return[{Provider:m,Slot:S,ItemSlot:$},G,i]}var Wde=K.createContext(void 0);function b2(e){const t=K.useContext(Wde);return e||t||"ltr"}var YM="rovingFocusGroup.onEntryFocus",Xde={bubbles:!1,cancelable:!0},X1="RovingFocusGroup",[ZD,X7,Zde]=x2(X1),[Yde,Z7]=ih(X1,[Zde]),[Kde,Jde]=Yde(X1),Y7=K.forwardRef((e,t)=>D.jsx(ZD.Provider,{scope:e.__scopeRovingFocusGroup,children:D.jsx(ZD.Slot,{scope:e.__scopeRovingFocusGroup,children:D.jsx(Qde,{...e,ref:t})})}));Y7.displayName=X1;var Qde=K.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:c=!1,dir:d,currentTabStopId:m,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:w,onEntryFocus:S,preventScrollOnEntryFocus:M=!1,...P}=e,N=K.useRef(null),$=ba(t,N),G=b2(d),[q,V]=mp({prop:m,defaultProp:a??null,onChange:w,caller:X1}),[J,ee]=K.useState(!1),re=Yd(S),fe=X7(n),ne=K.useRef(!1),[ce,me]=K.useState(0);return K.useEffect(()=>{const ve=N.current;if(ve)return ve.addEventListener(YM,re),()=>ve.removeEventListener(YM,re)},[re]),D.jsx(Kde,{scope:n,orientation:i,dir:G,loop:c,currentTabStopId:q,onItemFocus:K.useCallback(ve=>V(ve),[V]),onItemShiftTab:K.useCallback(()=>ee(!0),[]),onFocusableItemAdd:K.useCallback(()=>me(ve=>ve+1),[]),onFocusableItemRemove:K.useCallback(()=>me(ve=>ve-1),[]),children:D.jsx(ii.div,{tabIndex:J||ce===0?-1:0,"data-orientation":i,...P,ref:$,style:{outline:"none",...e.style},onMouseDown:vr(e.onMouseDown,()=>{ne.current=!0}),onFocus:vr(e.onFocus,ve=>{const De=!ne.current;if(ve.target===ve.currentTarget&&De&&!J){const Ye=new CustomEvent(YM,Xde);if(ve.currentTarget.dispatchEvent(Ye),!Ye.defaultPrevented){const ze=fe().filter(Ie=>Ie.focusable),tt=ze.find(Ie=>Ie.active),at=ze.find(Ie=>Ie.id===q),ht=[tt,at,...ze].filter(Boolean).map(Ie=>Ie.ref.current);Q7(ht,M)}}ne.current=!1}),onBlur:vr(e.onBlur,()=>ee(!1))})})}),K7="RovingFocusGroupItem",J7=K.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:c=!1,tabStopId:d,children:m,...a}=e,w=ol(),S=d||w,M=Jde(K7,n),P=M.currentTabStopId===S,N=X7(n),{onFocusableItemAdd:$,onFocusableItemRemove:G,currentTabStopId:q}=M;return K.useEffect(()=>{if(i)return $(),()=>G()},[i,$,G]),D.jsx(ZD.ItemSlot,{scope:n,id:S,focusable:i,active:c,children:D.jsx(ii.span,{tabIndex:P?0:-1,"data-orientation":M.orientation,...a,ref:t,onMouseDown:vr(e.onMouseDown,V=>{i?M.onItemFocus(S):V.preventDefault()}),onFocus:vr(e.onFocus,()=>M.onItemFocus(S)),onKeyDown:vr(e.onKeyDown,V=>{if(V.key==="Tab"&&V.shiftKey){M.onItemShiftTab();return}if(V.target!==V.currentTarget)return;const J=nfe(V,M.orientation,M.dir);if(J!==void 0){if(V.metaKey||V.ctrlKey||V.altKey||V.shiftKey)return;V.preventDefault();let re=N().filter(fe=>fe.focusable).map(fe=>fe.ref.current);if(J==="last")re.reverse();else if(J==="prev"||J==="next"){J==="prev"&&re.reverse();const fe=re.indexOf(V.currentTarget);re=M.loop?rfe(re,fe+1):re.slice(fe+1)}setTimeout(()=>Q7(re))}}),children:typeof m=="function"?m({isCurrentTabStop:P,hasTabStop:q!=null}):m})})});J7.displayName=K7;var efe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function tfe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function nfe(e,t,n){const i=tfe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return efe[i]}function Q7(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function rfe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var ife=Y7,afe=J7,YD=["Enter"," "],ofe=["ArrowDown","PageUp","Home"],e9=["ArrowUp","PageDown","End"],sfe=[...ofe,...e9],lfe={ltr:[...YD,"ArrowRight"],rtl:[...YD,"ArrowLeft"]},cfe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Z1="Menu",[zw,ufe,hfe]=x2(Z1),[sv,t9]=ih(Z1,[hfe,gy,Z7]),w2=gy(),n9=Z7(),[dfe,lv]=sv(Z1),[ffe,Y1]=sv(Z1),r9=e=>{const{__scopeMenu:t,open:n=!1,children:i,dir:c,onOpenChange:d,modal:m=!0}=e,a=w2(t),[w,S]=K.useState(null),M=K.useRef(!1),P=Yd(d),N=b2(c);return K.useEffect(()=>{const $=()=>{M.current=!0,document.addEventListener("pointerdown",G,{capture:!0,once:!0}),document.addEventListener("pointermove",G,{capture:!0,once:!0})},G=()=>M.current=!1;return document.addEventListener("keydown",$,{capture:!0}),()=>{document.removeEventListener("keydown",$,{capture:!0}),document.removeEventListener("pointerdown",G,{capture:!0}),document.removeEventListener("pointermove",G,{capture:!0})}},[]),D.jsx(m2,{...a,children:D.jsx(dfe,{scope:t,open:n,onOpenChange:P,content:w,onContentChange:S,children:D.jsx(ffe,{scope:t,onClose:K.useCallback(()=>P(!1),[P]),isUsingKeyboardRef:M,dir:N,modal:m,children:i})})})};r9.displayName=Z1;var pfe="MenuAnchor",SN=K.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,c=w2(n);return D.jsx(H1,{...c,...i,ref:t})});SN.displayName=pfe;var TN="MenuPortal",[mfe,i9]=sv(TN,{forceMount:void 0}),a9=e=>{const{__scopeMenu:t,forceMount:n,children:i,container:c}=e,d=lv(TN,t);return D.jsx(mfe,{scope:t,forceMount:n,children:D.jsx(ah,{present:n||d.open,children:D.jsx(S0,{asChild:!0,container:c,children:i})})})};a9.displayName=TN;var Yh="MenuContent",[gfe,EN]=sv(Yh),o9=K.forwardRef((e,t)=>{const n=i9(Yh,e.__scopeMenu),{forceMount:i=n.forceMount,...c}=e,d=lv(Yh,e.__scopeMenu),m=Y1(Yh,e.__scopeMenu);return D.jsx(zw.Provider,{scope:e.__scopeMenu,children:D.jsx(ah,{present:i||d.open,children:D.jsx(zw.Slot,{scope:e.__scopeMenu,children:m.modal?D.jsx(yfe,{...c,ref:t}):D.jsx(_fe,{...c,ref:t})})})})}),yfe=K.forwardRef((e,t)=>{const n=lv(Yh,e.__scopeMenu),i=K.useRef(null),c=ba(t,i);return K.useEffect(()=>{const d=i.current;if(d)return o2(d)},[]),D.jsx(AN,{...e,ref:c,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:vr(e.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),_fe=K.forwardRef((e,t)=>{const n=lv(Yh,e.__scopeMenu);return D.jsx(AN,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),vfe=cy("MenuContent.ScrollLock"),AN=K.forwardRef((e,t)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:c,onOpenAutoFocus:d,onCloseAutoFocus:m,disableOutsidePointerEvents:a,onEntryFocus:w,onEscapeKeyDown:S,onPointerDownOutside:M,onFocusOutside:P,onInteractOutside:N,onDismiss:$,disableOutsideScroll:G,...q}=e,V=lv(Yh,n),J=Y1(Yh,n),ee=w2(n),re=n9(n),fe=ufe(n),[ne,ce]=K.useState(null),me=K.useRef(null),ve=ba(t,me,V.onContentChange),De=K.useRef(0),Ye=K.useRef(""),ze=K.useRef(0),tt=K.useRef(null),at=K.useRef("right"),ct=K.useRef(0),ht=G?U1:K.Fragment,Ie=G?{as:vfe,allowPinchZoom:!0}:void 0,rt=St=>{const qe=Ye.current+St,vt=fe().filter(Ht=>!Ht.disabled),nt=document.activeElement,gt=vt.find(Ht=>Ht.ref.current===nt)?.textValue,Ut=vt.map(Ht=>Ht.textValue),$t=Rfe(Ut,qe,gt),qt=vt.find(Ht=>Ht.textValue===$t)?.ref.current;(function Ht(mn){Ye.current=mn,window.clearTimeout(De.current),mn!==""&&(De.current=window.setTimeout(()=>Ht(""),1e3))})(qe),qt&&setTimeout(()=>qt.focus())};K.useEffect(()=>()=>window.clearTimeout(De.current),[]),i2();const Qe=K.useCallback(St=>at.current===tt.current?.side&&Dfe(St,tt.current?.area),[]);return D.jsx(gfe,{scope:n,searchRef:Ye,onItemEnter:K.useCallback(St=>{Qe(St)&&St.preventDefault()},[Qe]),onItemLeave:K.useCallback(St=>{Qe(St)||(me.current?.focus(),ce(null))},[Qe]),onTriggerLeave:K.useCallback(St=>{Qe(St)&&St.preventDefault()},[Qe]),pointerGraceTimerRef:ze,onPointerGraceIntentChange:K.useCallback(St=>{tt.current=St},[]),children:D.jsx(ht,{...Ie,children:D.jsx(V1,{asChild:!0,trapped:c,onMountAutoFocus:vr(d,St=>{St.preventDefault(),me.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:m,children:D.jsx(w0,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:S,onPointerDownOutside:M,onFocusOutside:P,onInteractOutside:N,onDismiss:$,children:D.jsx(ife,{asChild:!0,...re,dir:J.dir,orientation:"vertical",loop:i,currentTabStopId:ne,onCurrentTabStopIdChange:ce,onEntryFocus:vr(w,St=>{J.isUsingKeyboardRef.current||St.preventDefault()}),preventScrollOnEntryFocus:!0,children:D.jsx(g2,{role:"menu","aria-orientation":"vertical","data-state":w9(V.open),"data-radix-menu-content":"",dir:J.dir,...ee,...q,ref:ve,style:{outline:"none",...q.style},onKeyDown:vr(q.onKeyDown,St=>{const vt=St.target.closest("[data-radix-menu-content]")===St.currentTarget,nt=St.ctrlKey||St.altKey||St.metaKey,gt=St.key.length===1;vt&&(St.key==="Tab"&&St.preventDefault(),!nt&&gt&&rt(St.key));const Ut=me.current;if(St.target!==Ut||!sfe.includes(St.key))return;St.preventDefault();const qt=fe().filter(Ht=>!Ht.disabled).map(Ht=>Ht.ref.current);e9.includes(St.key)&&qt.reverse(),Pfe(qt)}),onBlur:vr(e.onBlur,St=>{St.currentTarget.contains(St.target)||(window.clearTimeout(De.current),Ye.current="")}),onPointerMove:vr(e.onPointerMove,jw(St=>{const qe=St.target,vt=ct.current!==St.clientX;if(St.currentTarget.contains(qe)&&vt){const nt=St.clientX>ct.current?"right":"left";at.current=nt,ct.current=St.clientX}}))})})})})})})});o9.displayName=Yh;var xfe="MenuGroup",CN=K.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return D.jsx(ii.div,{role:"group",...i,ref:t})});CN.displayName=xfe;var bfe="MenuLabel",s9=K.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return D.jsx(ii.div,{...i,ref:t})});s9.displayName=bfe;var AE="MenuItem",I5="menu.itemSelect",S2=K.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:i,...c}=e,d=K.useRef(null),m=Y1(AE,e.__scopeMenu),a=EN(AE,e.__scopeMenu),w=ba(t,d),S=K.useRef(!1),M=()=>{const P=d.current;if(!n&&P){const N=new CustomEvent(I5,{bubbles:!0,cancelable:!0});P.addEventListener(I5,$=>i?.($),{once:!0}),mW(P,N),N.defaultPrevented?S.current=!1:m.onClose()}};return D.jsx(l9,{...c,ref:w,disabled:n,onClick:vr(e.onClick,M),onPointerDown:P=>{e.onPointerDown?.(P),S.current=!0},onPointerUp:vr(e.onPointerUp,P=>{S.current||P.currentTarget?.click()}),onKeyDown:vr(e.onKeyDown,P=>{const N=a.searchRef.current!=="";n||N&&P.key===" "||YD.includes(P.key)&&(P.currentTarget.click(),P.preventDefault())})})});S2.displayName=AE;var l9=K.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:i=!1,textValue:c,...d}=e,m=EN(AE,n),a=n9(n),w=K.useRef(null),S=ba(t,w),[M,P]=K.useState(!1),[N,$]=K.useState("");return K.useEffect(()=>{const G=w.current;G&&$((G.textContent??"").trim())},[d.children]),D.jsx(zw.ItemSlot,{scope:n,disabled:i,textValue:c??N,children:D.jsx(afe,{asChild:!0,...a,focusable:!i,children:D.jsx(ii.div,{role:"menuitem","data-highlighted":M?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...d,ref:S,onPointerMove:vr(e.onPointerMove,jw(G=>{i?m.onItemLeave(G):(m.onItemEnter(G),G.defaultPrevented||G.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:vr(e.onPointerLeave,jw(G=>m.onItemLeave(G))),onFocus:vr(e.onFocus,()=>P(!0)),onBlur:vr(e.onBlur,()=>P(!1))})})})}),wfe="MenuCheckboxItem",c9=K.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:i,...c}=e;return D.jsx(p9,{scope:e.__scopeMenu,checked:n,children:D.jsx(S2,{role:"menuitemcheckbox","aria-checked":CE(n)?"mixed":n,...c,ref:t,"data-state":PN(n),onSelect:vr(c.onSelect,()=>i?.(CE(n)?!0:!n),{checkForDefaultPrevented:!1})})})});c9.displayName=wfe;var u9="MenuRadioGroup",[Sfe,Tfe]=sv(u9,{value:void 0,onValueChange:()=>{}}),h9=K.forwardRef((e,t)=>{const{value:n,onValueChange:i,...c}=e,d=Yd(i);return D.jsx(Sfe,{scope:e.__scopeMenu,value:n,onValueChange:d,children:D.jsx(CN,{...c,ref:t})})});h9.displayName=u9;var d9="MenuRadioItem",f9=K.forwardRef((e,t)=>{const{value:n,...i}=e,c=Tfe(d9,e.__scopeMenu),d=n===c.value;return D.jsx(p9,{scope:e.__scopeMenu,checked:d,children:D.jsx(S2,{role:"menuitemradio","aria-checked":d,...i,ref:t,"data-state":PN(d),onSelect:vr(i.onSelect,()=>c.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});f9.displayName=d9;var MN="MenuItemIndicator",[p9,Efe]=sv(MN,{checked:!1}),m9=K.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:i,...c}=e,d=Efe(MN,n);return D.jsx(ah,{present:i||CE(d.checked)||d.checked===!0,children:D.jsx(ii.span,{...c,ref:t,"data-state":PN(d.checked)})})});m9.displayName=MN;var Afe="MenuSeparator",g9=K.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return D.jsx(ii.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});g9.displayName=Afe;var Cfe="MenuArrow",y9=K.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,c=w2(n);return D.jsx(y2,{...c,...i,ref:t})});y9.displayName=Cfe;var Mfe="MenuSub",[IBe,_9]=sv(Mfe),mw="MenuSubTrigger",v9=K.forwardRef((e,t)=>{const n=lv(mw,e.__scopeMenu),i=Y1(mw,e.__scopeMenu),c=_9(mw,e.__scopeMenu),d=EN(mw,e.__scopeMenu),m=K.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:w}=d,S={__scopeMenu:e.__scopeMenu},M=K.useCallback(()=>{m.current&&window.clearTimeout(m.current),m.current=null},[]);return K.useEffect(()=>M,[M]),K.useEffect(()=>{const P=a.current;return()=>{window.clearTimeout(P),w(null)}},[a,w]),D.jsx(SN,{asChild:!0,...S,children:D.jsx(l9,{id:c.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":c.contentId,"data-state":w9(n.open),...e,ref:zm(t,c.onTriggerChange),onClick:P=>{e.onClick?.(P),!(e.disabled||P.defaultPrevented)&&(P.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:vr(e.onPointerMove,jw(P=>{d.onItemEnter(P),!P.defaultPrevented&&!e.disabled&&!n.open&&!m.current&&(d.onPointerGraceIntentChange(null),m.current=window.setTimeout(()=>{n.onOpenChange(!0),M()},100))})),onPointerLeave:vr(e.onPointerLeave,jw(P=>{M();const N=n.content?.getBoundingClientRect();if(N){const $=n.content?.dataset.side,G=$==="right",q=G?-5:5,V=N[G?"left":"right"],J=N[G?"right":"left"];d.onPointerGraceIntentChange({area:[{x:P.clientX+q,y:P.clientY},{x:V,y:N.top},{x:J,y:N.top},{x:J,y:N.bottom},{x:V,y:N.bottom}],side:$}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>d.onPointerGraceIntentChange(null),300)}else{if(d.onTriggerLeave(P),P.defaultPrevented)return;d.onPointerGraceIntentChange(null)}})),onKeyDown:vr(e.onKeyDown,P=>{const N=d.searchRef.current!=="";e.disabled||N&&P.key===" "||lfe[i.dir].includes(P.key)&&(n.onOpenChange(!0),n.content?.focus(),P.preventDefault())})})})});v9.displayName=mw;var x9="MenuSubContent",b9=K.forwardRef((e,t)=>{const n=i9(Yh,e.__scopeMenu),{forceMount:i=n.forceMount,...c}=e,d=lv(Yh,e.__scopeMenu),m=Y1(Yh,e.__scopeMenu),a=_9(x9,e.__scopeMenu),w=K.useRef(null),S=ba(t,w);return D.jsx(zw.Provider,{scope:e.__scopeMenu,children:D.jsx(ah,{present:i||d.open,children:D.jsx(zw.Slot,{scope:e.__scopeMenu,children:D.jsx(AN,{id:a.contentId,"aria-labelledby":a.triggerId,...c,ref:S,align:"start",side:m.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:M=>{m.isUsingKeyboardRef.current&&w.current?.focus(),M.preventDefault()},onCloseAutoFocus:M=>M.preventDefault(),onFocusOutside:vr(e.onFocusOutside,M=>{M.target!==a.trigger&&d.onOpenChange(!1)}),onEscapeKeyDown:vr(e.onEscapeKeyDown,M=>{m.onClose(),M.preventDefault()}),onKeyDown:vr(e.onKeyDown,M=>{const P=M.currentTarget.contains(M.target),N=cfe[m.dir].includes(M.key);P&&N&&(d.onOpenChange(!1),a.trigger?.focus(),M.preventDefault())})})})})})});b9.displayName=x9;function w9(e){return e?"open":"closed"}function CE(e){return e==="indeterminate"}function PN(e){return CE(e)?"indeterminate":e?"checked":"unchecked"}function Pfe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Ofe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}function Rfe(e,t,n){const c=t.length>1&&Array.from(t).every(S=>S===t[0])?t[0]:t,d=n?e.indexOf(n):-1;let m=Ofe(e,Math.max(d,0));c.length===1&&(m=m.filter(S=>S!==n));const w=m.find(S=>S.toLowerCase().startsWith(c.toLowerCase()));return w!==n?w:void 0}function Ife(e,t){const{x:n,y:i}=e;let c=!1;for(let d=0,m=t.length-1;d<t.length;m=d++){const a=t[d],w=t[m],S=a.x,M=a.y,P=w.x,N=w.y;M>i!=N>i&&n<(P-S)*(i-M)/(N-M)+S&&(c=!c)}return c}function Dfe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Ife(n,t)}function jw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var kfe=r9,Lfe=SN,Nfe=a9,zfe=o9,jfe=CN,Bfe=s9,Ffe=S2,Vfe=c9,Ufe=h9,$fe=f9,qfe=m9,Hfe=g9,Gfe=y9,Wfe=v9,Xfe=b9,T2="DropdownMenu",[Zfe,DBe]=ih(T2,[t9]),kc=t9(),[Yfe,S9]=Zfe(T2),T9=e=>{const{__scopeDropdownMenu:t,children:n,dir:i,open:c,defaultOpen:d,onOpenChange:m,modal:a=!0}=e,w=kc(t),S=K.useRef(null),[M,P]=mp({prop:c,defaultProp:d??!1,onChange:m,caller:T2});return D.jsx(Yfe,{scope:t,triggerId:ol(),triggerRef:S,contentId:ol(),open:M,onOpenChange:P,onOpenToggle:K.useCallback(()=>P(N=>!N),[P]),modal:a,children:D.jsx(kfe,{...w,open:M,onOpenChange:P,dir:i,modal:a,children:n})})};T9.displayName=T2;var E9="DropdownMenuTrigger",A9=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...c}=e,d=S9(E9,n),m=kc(n);return D.jsx(Lfe,{asChild:!0,...m,children:D.jsx(ii.button,{type:"button",id:d.triggerId,"aria-haspopup":"menu","aria-expanded":d.open,"aria-controls":d.open?d.contentId:void 0,"data-state":d.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...c,ref:zm(t,d.triggerRef),onPointerDown:vr(e.onPointerDown,a=>{!i&&a.button===0&&a.ctrlKey===!1&&(d.onOpenToggle(),d.open||a.preventDefault())}),onKeyDown:vr(e.onKeyDown,a=>{i||(["Enter"," "].includes(a.key)&&d.onOpenToggle(),a.key==="ArrowDown"&&d.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});A9.displayName=E9;var Kfe="DropdownMenuPortal",C9=e=>{const{__scopeDropdownMenu:t,...n}=e,i=kc(t);return D.jsx(Nfe,{...i,...n})};C9.displayName=Kfe;var M9="DropdownMenuContent",P9=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=S9(M9,n),d=kc(n),m=K.useRef(!1);return D.jsx(zfe,{id:c.contentId,"aria-labelledby":c.triggerId,...d,...i,ref:t,onCloseAutoFocus:vr(e.onCloseAutoFocus,a=>{m.current||c.triggerRef.current?.focus(),m.current=!1,a.preventDefault()}),onInteractOutside:vr(e.onInteractOutside,a=>{const w=a.detail.originalEvent,S=w.button===0&&w.ctrlKey===!0,M=w.button===2||S;(!c.modal||M)&&(m.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});P9.displayName=M9;var Jfe="DropdownMenuGroup",O9=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(jfe,{...c,...i,ref:t})});O9.displayName=Jfe;var Qfe="DropdownMenuLabel",R9=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Bfe,{...c,...i,ref:t})});R9.displayName=Qfe;var epe="DropdownMenuItem",I9=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Ffe,{...c,...i,ref:t})});I9.displayName=epe;var tpe="DropdownMenuCheckboxItem",npe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Vfe,{...c,...i,ref:t})});npe.displayName=tpe;var rpe="DropdownMenuRadioGroup",ipe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Ufe,{...c,...i,ref:t})});ipe.displayName=rpe;var ape="DropdownMenuRadioItem",ope=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx($fe,{...c,...i,ref:t})});ope.displayName=ape;var spe="DropdownMenuItemIndicator",lpe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(qfe,{...c,...i,ref:t})});lpe.displayName=spe;var cpe="DropdownMenuSeparator",D9=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Hfe,{...c,...i,ref:t})});D9.displayName=cpe;var upe="DropdownMenuArrow",hpe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Gfe,{...c,...i,ref:t})});hpe.displayName=upe;var dpe="DropdownMenuSubTrigger",fpe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Wfe,{...c,...i,ref:t})});fpe.displayName=dpe;var ppe="DropdownMenuSubContent",mpe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,c=kc(n);return D.jsx(Xfe,{...c,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mpe.displayName=ppe;var gpe=T9,ype=A9,_pe=C9,vpe=P9,xpe=O9,bpe=R9,wpe=I9,Spe=D9;function k9({...e}){return D.jsx(gpe,{"data-slot":"dropdown-menu",...e})}function L9({...e}){return D.jsx(ype,{"data-slot":"dropdown-menu-trigger",...e})}function N9({className:e,sideOffset:t=4,...n}){return D.jsx(_pe,{children:D.jsx(vpe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:bn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function Tpe({...e}){return D.jsx(xpe,{"data-slot":"dropdown-menu-group",...e})}function Rx({className:e,inset:t,variant:n="default",...i}){return D.jsx(wpe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:bn("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...i})}function Epe({className:e,inset:t,...n}){return D.jsx(bpe,{"data-slot":"dropdown-menu-label","data-inset":t,className:bn("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",e),...n})}function D5({className:e,...t}){return D.jsx(Spe,{"data-slot":"dropdown-menu-separator",className:bn("bg-border -mx-1 my-1 h-px",e),...t})}function Ape({user:e,logout:t}){const{isMobile:n}=W1();return D.jsx(TE,{children:D.jsx(EE,{children:D.jsxs(k9,{children:[D.jsx(L9,{asChild:!0,children:D.jsxs(XD,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[D.jsxs(P5,{className:"h-8 w-8 rounded-lg",children:[D.jsx(O5,{src:e.avatar,alt:e.name}),D.jsx(R5,{className:"rounded-lg bg-[var(--neon-pink)]",children:"CN"})]}),D.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[D.jsx("span",{className:"truncate font-medium",children:e.name}),D.jsx("span",{className:"truncate text-xs",children:e.email})]}),D.jsx(n2,{className:"ml-auto size-4"})]})}),D.jsxs(N9,{className:"w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg",side:n?"bottom":"right",align:"end",sideOffset:4,children:[D.jsx(Epe,{className:"p-0 font-normal",children:D.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[D.jsxs(P5,{className:"h-8 w-8 rounded-lg",children:[D.jsx(O5,{src:e.avatar,alt:e.name}),D.jsx(R5,{className:"rounded-lg text-sidebar-primary-foreground bg-[var(--neon-pink)]",children:"CN"})]}),D.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[D.jsx("span",{className:"truncate font-medium",children:e.name}),D.jsx("span",{className:"truncate text-xs",children:e.email})]})]})}),D.jsx(D5,{}),D.jsxs(Tpe,{children:[D.jsxs(Rx,{children:[D.jsx(gse,{}),"Account"]}),D.jsxs(Rx,{children:[D.jsx(_se,{}),"Notifications"]})]}),D.jsx(D5,{}),D.jsx(Rx,{onClick:()=>{t()},children:"Logout"})]})]})})})}const Cpe="/assets/joli_cropped-C7siT9aC.png",Mpe={logisticsIINav:[{NavGroup:{NavLabel:"Analytics",NavItems:[{title:"Dashboard",url:"/",icon:Nse}]}},{NavGroup:{NavLabel:"Fleet",NavItems:[{title:"Vehicles",url:"/vehicles",icon:Sse},{title:"Drivers",url:"/drivers",icon:nle}]}},{NavGroup:{NavLabel:"Reservation and Dispatch",NavItems:[{title:"Reservations",url:"/reservation",icon:xse},{title:"Dispatch Orders",url:"/dispatch",icon:Qse}]}},{NavGroup:{NavLabel:"Logs",NavItems:[{title:"Trip History",url:"#",icon:jse},{title:"Trip Logs",url:"#",icon:Use}]}}]};function ME({...e}){const{auth:t,logout:n,loading:i}=K.useContext(B1),c={name:t?.name,role:t?.role,avatar:null,email:t?.email};return D.jsxs(Ade,{collapsible:"icon",...e,className:"rounded-md",children:[D.jsx(Mde,{children:D.jsx(TE,{children:D.jsx(EE,{children:D.jsx(fc,{to:"/",className:"flex justify-center",children:D.jsx("img",{src:Cpe,className:"h-10  object-scale-down",alt:""})})})})}),D.jsx(Ode,{className:"flex flex-col gap-2",children:i?D.jsxs("div",{className:"flex flex-col gap-2 px-2 h-full",children:[D.jsx(Oi,{className:"h-8 w-full"}),D.jsx(Oi,{className:"h-8 w-full"}),D.jsx(Oi,{className:"flex-1 w-full"}),D.jsx(Oi,{className:"flex-1 w-full"})]}):D.jsx(D.Fragment,{children:c.role==="Fleet Manager"?D.jsx(Lde,{data:Mpe.logisticsIINav}):null})}),D.jsx(Cde,{}),D.jsx(Pde,{children:i?D.jsx(Oi,{className:"w-full h-full"}):D.jsx(Ape,{user:c,logout:n})})]})}function z9(){const{setTheme:e}=sse();return D.jsxs(k9,{children:[D.jsx(L9,{asChild:!0,children:D.jsxs(na,{variant:"outline",size:"icon",children:[D.jsx(Kse,{className:"h-[1.2rem] w-[1.2rem] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90"}),D.jsx(qse,{className:"absolute h-[1.2rem] w-[1.2rem] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0"}),D.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),D.jsxs(N9,{align:"end",children:[D.jsx(Rx,{onClick:()=>e("light"),children:"Light"}),D.jsx(Rx,{onClick:()=>e("dark"),children:"Dark"}),D.jsx(Rx,{onClick:()=>e("system"),children:"System"})]})]})}function Ppe({...e}){return D.jsx("nav",{"aria-label":"breadcrumb","data-slot":"breadcrumb",...e})}function Ope({className:e,...t}){return D.jsx("ol",{"data-slot":"breadcrumb-list",className:bn("text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",e),...t})}function Rpe({className:e,...t}){return D.jsx("li",{"data-slot":"breadcrumb-item",className:bn("inline-flex items-center gap-1.5",e),...t})}function k5({asChild:e,className:t,...n}){const i=e?F1:"a";return D.jsx(i,{"data-slot":"breadcrumb-link",className:bn("hover:text-foreground transition-colors",t),...n})}function Ipe({children:e,className:t,...n}){return D.jsx("li",{"data-slot":"breadcrumb-separator",role:"presentation","aria-hidden":"true",className:bn("[&>svg]:size-3.5",t),...n,children:e??D.jsx(v0,{})})}function j9(){const n=my().pathname.split("/").filter(Boolean);return D.jsx(Ppe,{children:D.jsx(Ope,{children:n.map((i,c)=>{const d="/"+n.slice(0,c+1).join("/"),m=i.charAt(0).toUpperCase()+i.slice(1);return D.jsxs(Ce.Fragment,{children:[D.jsx(Rpe,{children:c===n.length-1?D.jsx("span",{className:"font-medium",children:m=="LogisticsII"?"Home":m}):c===0?D.jsx(D.Fragment,{children:D.jsx(k5,{asChild:!0,children:D.jsx(fc,{to:d,children:"Home"})})}):D.jsx(D.Fragment,{children:D.jsx(k5,{asChild:!0,children:D.jsx(fc,{to:d,children:m})})})}),c!==n.length-1&&D.jsx(Ipe,{})]},`${d}-${c}`)})})})}function Dpe({allowedRoles:e}){const{auth:t,loading:n,logout:i}=K.useContext(B1),c=I1(),[d,m]=K.useState(null);return K.useEffect(()=>{if(!n)if(t)if(e.includes(t.role))m(!0);else{m(!1),ua.error("Unauthorized User! Redirecting to login...",{position:"top-center"});const a=setTimeout(()=>{i()},2500);return()=>clearTimeout(a)}else{m(!1);const a=setTimeout(()=>{i()},2500);return()=>clearTimeout(a)}},[t,n,e,i,c]),n||d===null?D.jsxs(bE,{children:[D.jsx("title",{children:"Loading..."}),D.jsx(ME,{}),D.jsxs(SE,{children:[D.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2",children:D.jsxs("div",{className:"flex items-center gap-2 px-4",children:[D.jsx(wE,{className:"-ml-1"}),D.jsx(Us,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"})]})}),D.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0",children:[D.jsx(Oi,{className:"h-1/3 w-full"}),D.jsx(Oi,{className:"h-2/3 w-full"})]})]})]}):d===!1?D.jsx(D.Fragment,{children:D.jsx("p",{className:"p-4",children:"Unauthorized access, redirecting..."})}):D.jsx(D.Fragment,{children:D.jsxs(bE,{children:[D.jsx("title",{children:"JOLI - Admin"}),D.jsx(ME,{}),D.jsxs(SE,{children:[D.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2 rounded-md bg-background/80 backdrop-blur-md",children:D.jsxs("div",{className:"flex justify-between w-full items-center pr-4",children:[D.jsxs("div",{className:"flex items-center gap-2 px-4",children:[D.jsx(wE,{className:"-ml-1"}),D.jsx(Us,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),D.jsx(j9,{})]}),D.jsx(z9,{})]})}),D.jsx("div",{className:"flex flex-1 flex-col p-4 pt-0 relative",children:D.jsx(OG,{})})]})]})})}const kpe=K.createContext({setMapComponent:()=>{},mapComponent:null});function Lpe({allowedRoles:e}){const{auth:t,loading:n,logout:i}=K.useContext(B1),c=I1(),[d,m]=K.useState(null),[a,w]=K.useState(null);return K.useEffect(()=>{if(!n)if(t)if(e.includes(t.role))m(!0);else{m(!1),ua.error("Unauthorized User! Redirecting to login...",{position:"top-center"});const S=setTimeout(()=>{i()},2500);return()=>clearTimeout(S)}else{m(!1);const S=setTimeout(()=>{i()},2500);return()=>clearTimeout(S)}},[t,n,e,i,c]),n||d===null?D.jsxs(bE,{children:[D.jsx("title",{children:"Loading..."}),D.jsx(ME,{}),D.jsxs(SE,{children:[D.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2",children:D.jsxs("div",{className:"flex items-center gap-2 px-4",children:[D.jsx(wE,{className:"-ml-1"}),D.jsx(Us,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"})]})}),D.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 pt-0",children:[D.jsx(Oi,{className:"h-1/3 w-full"}),D.jsx(Oi,{className:"h-2/3 w-full"})]})]})]}):d===!1?D.jsx(D.Fragment,{children:D.jsx("p",{className:"p-4",children:"Unauthorized access, redirecting..."})}):D.jsx(D.Fragment,{children:D.jsx(kpe.Provider,{value:{mapComponent:a,setMapComponent:w},children:D.jsxs(bE,{children:[D.jsx("title",{children:"JOLI - Admin"}),D.jsx(ME,{}),D.jsxs(SE,{children:[D.jsx("header",{className:"flex h-16 shrink-0 items-center gap-2 z-50 bg-background/80 backdrop-blur-md mb-3",children:D.jsxs("div",{className:"flex justify-between w-full items-center pr-4",children:[D.jsxs("div",{className:"flex items-center gap-2 px-4",children:[D.jsx(wE,{className:"-ml-1"}),D.jsx(Us,{orientation:"vertical",className:"mr-2 data-[orientation=vertical]:h-4"}),D.jsx(j9,{})]}),D.jsx(z9,{})]})}),a&&D.jsx("div",{className:"fixed inset-0 w-screen h-screen",children:a}),D.jsx(OG,{context:{setMapComponent:w}})]})]})})})}const B9=K.createContext({});function Npe(e){const t=K.useRef(null);return t.current===null&&(t.current=e()),t.current}const ON=typeof window<"u",zpe=ON?K.useLayoutEffect:K.useEffect,RN=K.createContext(null);function IN(e,t){e.indexOf(t)===-1&&e.push(t)}function DN(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Fm=(e,t,n)=>n>t?t:n<e?e:n;let kN=()=>{};const Vm={},F9=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function V9(e){return typeof e=="object"&&e!==null}const U9=e=>/^0[^.\s]+$/u.test(e);function LN(e){let t;return()=>(t===void 0&&(t=e()),t)}const Kh=e=>e,jpe=(e,t)=>n=>t(e(n)),K1=(...e)=>e.reduce(jpe),Bw=(e,t,n)=>{const i=t-e;return i===0?1:(n-e)/i};class NN{constructor(){this.subscriptions=[]}add(t){return IN(this.subscriptions,t),()=>DN(this.subscriptions,t)}notify(t,n,i){const c=this.subscriptions.length;if(c)if(c===1)this.subscriptions[0](t,n,i);else for(let d=0;d<c;d++){const m=this.subscriptions[d];m&&m(t,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const cp=e=>e*1e3,up=e=>e/1e3;function $9(e,t){return t?e*(1e3/t):0}const q9=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Bpe=1e-7,Fpe=12;function Vpe(e,t,n,i,c){let d,m,a=0;do m=t+(n-t)/2,d=q9(m,i,c)-e,d>0?n=m:t=m;while(Math.abs(d)>Bpe&&++a<Fpe);return m}function J1(e,t,n,i){if(e===t&&n===i)return Kh;const c=d=>Vpe(d,0,1,e,n);return d=>d===0||d===1?d:q9(c(d),t,i)}const H9=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,G9=e=>t=>1-e(1-t),W9=J1(.33,1.53,.69,.99),zN=G9(W9),X9=H9(zN),Z9=e=>(e*=2)<1?.5*zN(e):.5*(2-Math.pow(2,-10*(e-1))),jN=e=>1-Math.sin(Math.acos(e)),Y9=G9(jN),K9=H9(jN),Upe=J1(.42,0,1,1),$pe=J1(0,0,.58,1),J9=J1(.42,0,.58,1),qpe=e=>Array.isArray(e)&&typeof e[0]!="number",Q9=e=>Array.isArray(e)&&typeof e[0]=="number",Hpe={linear:Kh,easeIn:Upe,easeInOut:J9,easeOut:$pe,circIn:jN,circInOut:K9,circOut:Y9,backIn:zN,backInOut:X9,backOut:W9,anticipate:Z9},Gpe=e=>typeof e=="string",L5=e=>{if(Q9(e)){kN(e.length===4);const[t,n,i,c]=e;return J1(t,n,i,c)}else if(Gpe(e))return Hpe[e];return e},NT=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Wpe(e,t){let n=new Set,i=new Set,c=!1,d=!1;const m=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function w(M){m.has(M)&&(S.schedule(M),e()),M(a)}const S={schedule:(M,P=!1,N=!1)=>{const G=N&&c?n:i;return P&&m.add(M),G.has(M)||G.add(M),M},cancel:M=>{i.delete(M),m.delete(M)},process:M=>{if(a=M,c){d=!0;return}c=!0,[n,i]=[i,n],n.forEach(w),n.clear(),c=!1,d&&(d=!1,S.process(M))}};return S}const Xpe=40;function eX(e,t){let n=!1,i=!0;const c={delta:0,timestamp:0,isProcessing:!1},d=()=>n=!0,m=NT.reduce((re,fe)=>(re[fe]=Wpe(d),re),{}),{setup:a,read:w,resolveKeyframes:S,preUpdate:M,update:P,preRender:N,render:$,postRender:G}=m,q=()=>{const re=Vm.useManualTiming?c.timestamp:performance.now();n=!1,Vm.useManualTiming||(c.delta=i?1e3/60:Math.max(Math.min(re-c.timestamp,Xpe),1)),c.timestamp=re,c.isProcessing=!0,a.process(c),w.process(c),S.process(c),M.process(c),P.process(c),N.process(c),$.process(c),G.process(c),c.isProcessing=!1,n&&t&&(i=!1,e(q))},V=()=>{n=!0,i=!0,c.isProcessing||e(q)};return{schedule:NT.reduce((re,fe)=>{const ne=m[fe];return re[fe]=(ce,me=!1,ve=!1)=>(n||V(),ne.schedule(ce,me,ve)),re},{}),cancel:re=>{for(let fe=0;fe<NT.length;fe++)m[NT[fe]].cancel(re)},state:c,steps:m}}const{schedule:Ho,cancel:dy,state:Nl,steps:KM}=eX(typeof requestAnimationFrame<"u"?requestAnimationFrame:Kh,!0);let lE;function Zpe(){lE=void 0}const su={now:()=>(lE===void 0&&su.set(Nl.isProcessing||Vm.useManualTiming?Nl.timestamp:performance.now()),lE),set:e=>{lE=e,queueMicrotask(Zpe)}},tX=e=>t=>typeof t=="string"&&t.startsWith(e),BN=tX("--"),Ype=tX("var(--"),FN=e=>Ype(e)?Kpe.test(e.split("/*")[0].trim()):!1,Kpe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,A0={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Fw={...A0,transform:e=>Fm(0,1,e)},zT={...A0,default:1},Sw=e=>Math.round(e*1e5)/1e5,VN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Jpe(e){return e==null}const Qpe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,UN=(e,t)=>n=>!!(typeof n=="string"&&Qpe.test(n)&&n.startsWith(e)||t&&!Jpe(n)&&Object.prototype.hasOwnProperty.call(n,t)),nX=(e,t,n)=>i=>{if(typeof i!="string")return i;const[c,d,m,a]=i.match(VN);return{[e]:parseFloat(c),[t]:parseFloat(d),[n]:parseFloat(m),alpha:a!==void 0?parseFloat(a):1}},eme=e=>Fm(0,255,e),JM={...A0,transform:e=>Math.round(eme(e))},L_={test:UN("rgb","red"),parse:nX("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:i=1})=>"rgba("+JM.transform(e)+", "+JM.transform(t)+", "+JM.transform(n)+", "+Sw(Fw.transform(i))+")"};function tme(e){let t="",n="",i="",c="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),c=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),c=e.substring(4,5),t+=t,n+=n,i+=i,c+=c),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:c?parseInt(c,16)/255:1}}const KD={test:UN("#"),parse:tme,transform:L_.transform},Q1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Qg=Q1("deg"),hp=Q1("%"),Ti=Q1("px"),nme=Q1("vh"),rme=Q1("vw"),N5={...hp,parse:e=>hp.parse(e)/100,transform:e=>hp.transform(e*100)},vx={test:UN("hsl","hue"),parse:nX("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+hp.transform(Sw(t))+", "+hp.transform(Sw(n))+", "+Sw(Fw.transform(i))+")"},Vs={test:e=>L_.test(e)||KD.test(e)||vx.test(e),parse:e=>L_.test(e)?L_.parse(e):vx.test(e)?vx.parse(e):KD.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?L_.transform(e):vx.transform(e),getAnimatableNone:e=>{const t=Vs.parse(e);return t.alpha=0,Vs.transform(t)}},ime=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function ame(e){return isNaN(e)&&typeof e=="string"&&(e.match(VN)?.length||0)+(e.match(ime)?.length||0)>0}const rX="number",iX="color",ome="var",sme="var(",z5="${}",lme=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vw(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},c=[];let d=0;const a=t.replace(lme,w=>(Vs.test(w)?(i.color.push(d),c.push(iX),n.push(Vs.parse(w))):w.startsWith(sme)?(i.var.push(d),c.push(ome),n.push(w)):(i.number.push(d),c.push(rX),n.push(parseFloat(w))),++d,z5)).split(z5);return{values:n,split:a,indexes:i,types:c}}function aX(e){return Vw(e).values}function oX(e){const{split:t,types:n}=Vw(e),i=t.length;return c=>{let d="";for(let m=0;m<i;m++)if(d+=t[m],c[m]!==void 0){const a=n[m];a===rX?d+=Sw(c[m]):a===iX?d+=Vs.transform(c[m]):d+=c[m]}return d}}const cme=e=>typeof e=="number"?0:Vs.test(e)?Vs.getAnimatableNone(e):e;function ume(e){const t=aX(e);return oX(e)(t.map(cme))}const fy={test:ame,parse:aX,createTransformer:oX,getAnimatableNone:ume};function QM(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function hme({hue:e,saturation:t,lightness:n,alpha:i}){e/=360,t/=100,n/=100;let c=0,d=0,m=0;if(!t)c=d=m=n;else{const a=n<.5?n*(1+t):n+t-n*t,w=2*n-a;c=QM(w,a,e+1/3),d=QM(w,a,e),m=QM(w,a,e-1/3)}return{red:Math.round(c*255),green:Math.round(d*255),blue:Math.round(m*255),alpha:i}}function PE(e,t){return n=>n>0?t:e}const is=(e,t,n)=>e+(t-e)*n,eP=(e,t,n)=>{const i=e*e,c=n*(t*t-i)+i;return c<0?0:Math.sqrt(c)},dme=[KD,L_,vx],fme=e=>dme.find(t=>t.test(e));function j5(e){const t=fme(e);if(!t)return!1;let n=t.parse(e);return t===vx&&(n=hme(n)),n}const B5=(e,t)=>{const n=j5(e),i=j5(t);if(!n||!i)return PE(e,t);const c={...n};return d=>(c.red=eP(n.red,i.red,d),c.green=eP(n.green,i.green,d),c.blue=eP(n.blue,i.blue,d),c.alpha=is(n.alpha,i.alpha,d),L_.transform(c))},JD=new Set(["none","hidden"]);function pme(e,t){return JD.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function mme(e,t){return n=>is(e,t,n)}function $N(e){return typeof e=="number"?mme:typeof e=="string"?FN(e)?PE:Vs.test(e)?B5:_me:Array.isArray(e)?sX:typeof e=="object"?Vs.test(e)?B5:gme:PE}function sX(e,t){const n=[...e],i=n.length,c=e.map((d,m)=>$N(d)(d,t[m]));return d=>{for(let m=0;m<i;m++)n[m]=c[m](d);return n}}function gme(e,t){const n={...e,...t},i={};for(const c in n)e[c]!==void 0&&t[c]!==void 0&&(i[c]=$N(e[c])(e[c],t[c]));return c=>{for(const d in i)n[d]=i[d](c);return n}}function yme(e,t){const n=[],i={color:0,var:0,number:0};for(let c=0;c<t.values.length;c++){const d=t.types[c],m=e.indexes[d][i[d]],a=e.values[m]??0;n[c]=a,i[d]++}return n}const _me=(e,t)=>{const n=fy.createTransformer(t),i=Vw(e),c=Vw(t);return i.indexes.var.length===c.indexes.var.length&&i.indexes.color.length===c.indexes.color.length&&i.indexes.number.length>=c.indexes.number.length?JD.has(e)&&!c.values.length||JD.has(t)&&!i.values.length?pme(e,t):K1(sX(yme(i,c),c.values),n):PE(e,t)};function lX(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?is(e,t,n):$N(e)(e,t)}const vme=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>Ho.update(t,n),stop:()=>dy(t),now:()=>Nl.isProcessing?Nl.timestamp:su.now()}},cX=(e,t,n=10)=>{let i="";const c=Math.max(Math.round(t/n),2);for(let d=0;d<c;d++)i+=Math.round(e(d/(c-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},OE=2e4;function qN(e){let t=0;const n=50;let i=e.next(t);for(;!i.done&&t<OE;)t+=n,i=e.next(t);return t>=OE?1/0:t}function xme(e,t=100,n){const i=n({...e,keyframes:[0,t]}),c=Math.min(qN(i),OE);return{type:"keyframes",ease:d=>i.next(c*d).value/t,duration:up(c)}}const bme=5;function uX(e,t,n){const i=Math.max(t-bme,0);return $9(n-e(i),t-i)}const fs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},tP=.001;function wme({duration:e=fs.duration,bounce:t=fs.bounce,velocity:n=fs.velocity,mass:i=fs.mass}){let c,d,m=1-t;m=Fm(fs.minDamping,fs.maxDamping,m),e=Fm(fs.minDuration,fs.maxDuration,up(e)),m<1?(c=S=>{const M=S*m,P=M*e,N=M-n,$=QD(S,m),G=Math.exp(-P);return tP-N/$*G},d=S=>{const P=S*m*e,N=P*n+n,$=Math.pow(m,2)*Math.pow(S,2)*e,G=Math.exp(-P),q=QD(Math.pow(S,2),m);return(-c(S)+tP>0?-1:1)*((N-$)*G)/q}):(c=S=>{const M=Math.exp(-S*e),P=(S-n)*e+1;return-tP+M*P},d=S=>{const M=Math.exp(-S*e),P=(n-S)*(e*e);return M*P});const a=5/e,w=Tme(c,d,a);if(e=cp(e),isNaN(w))return{stiffness:fs.stiffness,damping:fs.damping,duration:e};{const S=Math.pow(w,2)*i;return{stiffness:S,damping:m*2*Math.sqrt(i*S),duration:e}}}const Sme=12;function Tme(e,t,n){let i=n;for(let c=1;c<Sme;c++)i=i-e(i)/t(i);return i}function QD(e,t){return e*Math.sqrt(1-t*t)}const Eme=["duration","bounce"],Ame=["stiffness","damping","mass"];function F5(e,t){return t.some(n=>e[n]!==void 0)}function Cme(e){let t={velocity:fs.velocity,stiffness:fs.stiffness,damping:fs.damping,mass:fs.mass,isResolvedFromDuration:!1,...e};if(!F5(e,Ame)&&F5(e,Eme))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),c=i*i,d=2*Fm(.05,1,1-(e.bounce||0))*Math.sqrt(c);t={...t,mass:fs.mass,stiffness:c,damping:d}}else{const n=wme(e);t={...t,...n,mass:fs.mass},t.isResolvedFromDuration=!0}return t}function RE(e=fs.visualDuration,t=fs.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:c}=n;const d=n.keyframes[0],m=n.keyframes[n.keyframes.length-1],a={done:!1,value:d},{stiffness:w,damping:S,mass:M,duration:P,velocity:N,isResolvedFromDuration:$}=Cme({...n,velocity:-up(n.velocity||0)}),G=N||0,q=S/(2*Math.sqrt(w*M)),V=m-d,J=up(Math.sqrt(w/M)),ee=Math.abs(V)<5;i||(i=ee?fs.restSpeed.granular:fs.restSpeed.default),c||(c=ee?fs.restDelta.granular:fs.restDelta.default);let re;if(q<1){const ne=QD(J,q);re=ce=>{const me=Math.exp(-q*J*ce);return m-me*((G+q*J*V)/ne*Math.sin(ne*ce)+V*Math.cos(ne*ce))}}else if(q===1)re=ne=>m-Math.exp(-J*ne)*(V+(G+J*V)*ne);else{const ne=J*Math.sqrt(q*q-1);re=ce=>{const me=Math.exp(-q*J*ce),ve=Math.min(ne*ce,300);return m-me*((G+q*J*V)*Math.sinh(ve)+ne*V*Math.cosh(ve))/ne}}const fe={calculatedDuration:$&&P||null,next:ne=>{const ce=re(ne);if($)a.done=ne>=P;else{let me=ne===0?G:0;q<1&&(me=ne===0?cp(G):uX(re,ne,ce));const ve=Math.abs(me)<=i,De=Math.abs(m-ce)<=c;a.done=ve&&De}return a.value=a.done?m:ce,a},toString:()=>{const ne=Math.min(qN(fe),OE),ce=cX(me=>fe.next(ne*me).value,ne,30);return ne+"ms "+ce},toTransition:()=>{}};return fe}RE.applyToOptions=e=>{const t=xme(e,100,RE);return e.ease=t.ease,e.duration=cp(t.duration),e.type="keyframes",e};function ek({keyframes:e,velocity:t=0,power:n=.8,timeConstant:i=325,bounceDamping:c=10,bounceStiffness:d=500,modifyTarget:m,min:a,max:w,restDelta:S=.5,restSpeed:M}){const P=e[0],N={done:!1,value:P},$=ve=>a!==void 0&&ve<a||w!==void 0&&ve>w,G=ve=>a===void 0?w:w===void 0||Math.abs(a-ve)<Math.abs(w-ve)?a:w;let q=n*t;const V=P+q,J=m===void 0?V:m(V);J!==V&&(q=J-P);const ee=ve=>-q*Math.exp(-ve/i),re=ve=>J+ee(ve),fe=ve=>{const De=ee(ve),Ye=re(ve);N.done=Math.abs(De)<=S,N.value=N.done?J:Ye};let ne,ce;const me=ve=>{$(N.value)&&(ne=ve,ce=RE({keyframes:[N.value,G(N.value)],velocity:uX(re,ve,N.value),damping:c,stiffness:d,restDelta:S,restSpeed:M}))};return me(0),{calculatedDuration:null,next:ve=>{let De=!1;return!ce&&ne===void 0&&(De=!0,fe(ve),me(ve)),ne!==void 0&&ve>=ne?ce.next(ve-ne):(!De&&fe(ve),N)}}}function Mme(e,t,n){const i=[],c=n||Vm.mix||lX,d=e.length-1;for(let m=0;m<d;m++){let a=c(e[m],e[m+1]);if(t){const w=Array.isArray(t)?t[m]||Kh:t;a=K1(w,a)}i.push(a)}return i}function Pme(e,t,{clamp:n=!0,ease:i,mixer:c}={}){const d=e.length;if(kN(d===t.length),d===1)return()=>t[0];if(d===2&&t[0]===t[1])return()=>t[1];const m=e[0]===e[1];e[0]>e[d-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Mme(t,i,c),w=a.length,S=M=>{if(m&&M<e[0])return t[0];let P=0;if(w>1)for(;P<e.length-2&&!(M<e[P+1]);P++);const N=Bw(e[P],e[P+1],M);return a[P](N)};return n?M=>S(Fm(e[0],e[d-1],M)):S}function Ome(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const c=Bw(0,t,i);e.push(is(n,1,c))}}function Rme(e){const t=[0];return Ome(t,e.length-1),t}function Ime(e,t){return e.map(n=>n*t)}function Dme(e,t){return e.map(()=>t||J9).splice(0,e.length-1)}function Tw({duration:e=300,keyframes:t,times:n,ease:i="easeInOut"}){const c=qpe(i)?i.map(L5):L5(i),d={done:!1,value:t[0]},m=Ime(n&&n.length===t.length?n:Rme(t),e),a=Pme(m,t,{ease:Array.isArray(c)?c:Dme(t,c)});return{calculatedDuration:e,next:w=>(d.value=a(w),d.done=w>=e,d)}}const kme=e=>e!==null;function HN(e,{repeat:t,repeatType:n="loop"},i,c=1){const d=e.filter(kme),a=c<0||t&&n!=="loop"&&t%2===1?0:d.length-1;return!a||i===void 0?d[a]:i}const Lme={decay:ek,inertia:ek,tween:Tw,keyframes:Tw,spring:RE};function hX(e){typeof e.type=="string"&&(e.type=Lme[e.type])}class GN{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const Nme=e=>e/100;class WN extends GN{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==su.now()&&this.tick(su.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;hX(t);const{type:n=Tw,repeat:i=0,repeatDelay:c=0,repeatType:d,velocity:m=0}=t;let{keyframes:a}=t;const w=n||Tw;w!==Tw&&typeof a[0]!="number"&&(this.mixKeyframes=K1(Nme,lX(a[0],a[1])),a=[0,100]);const S=w({...t,keyframes:a});d==="mirror"&&(this.mirroredGenerator=w({...t,keyframes:[...a].reverse(),velocity:-m})),S.calculatedDuration===null&&(S.calculatedDuration=qN(S));const{calculatedDuration:M}=S;this.calculatedDuration=M,this.resolvedDuration=M+c,this.totalDuration=this.resolvedDuration*(i+1)-c,this.generator=S}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:i,totalDuration:c,mixKeyframes:d,mirroredGenerator:m,resolvedDuration:a,calculatedDuration:w}=this;if(this.startTime===null)return i.next(0);const{delay:S=0,keyframes:M,repeat:P,repeatType:N,repeatDelay:$,type:G,onUpdate:q,finalKeyframe:V}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-c/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const J=this.currentTime-S*(this.playbackSpeed>=0?1:-1),ee=this.playbackSpeed>=0?J<0:J>c;this.currentTime=Math.max(J,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let re=this.currentTime,fe=i;if(P){const ve=Math.min(this.currentTime,c)/a;let De=Math.floor(ve),Ye=ve%1;!Ye&&ve>=1&&(Ye=1),Ye===1&&De--,De=Math.min(De,P+1),!!(De%2)&&(N==="reverse"?(Ye=1-Ye,$&&(Ye-=$/a)):N==="mirror"&&(fe=m)),re=Fm(0,1,Ye)*a}const ne=ee?{done:!1,value:M[0]}:fe.next(re);d&&(ne.value=d(ne.value));let{done:ce}=ne;!ee&&w!==null&&(ce=this.playbackSpeed>=0?this.currentTime>=c:this.currentTime<=0);const me=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ce);return me&&G!==ek&&(ne.value=HN(M,this.options,V,this.speed)),q&&q(ne.value),me&&this.finish(),ne}then(t,n){return this.finished.then(t,n)}get duration(){return up(this.calculatedDuration)}get time(){return up(this.currentTime)}set time(t){t=cp(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(su.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=up(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=vme,startTime:n}=this.options;this.driver||(this.driver=t(c=>this.tick(c))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(su.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function zme(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const N_=e=>e*180/Math.PI,tk=e=>{const t=N_(Math.atan2(e[1],e[0]));return nk(t)},jme={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:tk,rotateZ:tk,skewX:e=>N_(Math.atan(e[1])),skewY:e=>N_(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},nk=e=>(e=e%360,e<0&&(e+=360),e),V5=tk,U5=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),$5=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Bme={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:U5,scaleY:$5,scale:e=>(U5(e)+$5(e))/2,rotateX:e=>nk(N_(Math.atan2(e[6],e[5]))),rotateY:e=>nk(N_(Math.atan2(-e[2],e[0]))),rotateZ:V5,rotate:V5,skewX:e=>N_(Math.atan(e[4])),skewY:e=>N_(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function rk(e){return e.includes("scale")?1:0}function ik(e,t){if(!e||e==="none")return rk(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,c;if(n)i=Bme,c=n;else{const a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=jme,c=a}if(!c)return rk(t);const d=i[t],m=c[1].split(",").map(Vme);return typeof d=="function"?d(m):m[d]}const Fme=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return ik(n,t)};function Vme(e){return parseFloat(e.trim())}const C0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],M0=new Set(C0),q5=e=>e===A0||e===Ti,Ume=new Set(["x","y","z"]),$me=C0.filter(e=>!Ume.has(e));function qme(e){const t=[];return $me.forEach(n=>{const i=e.getValue(n);i!==void 0&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t}const H_={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>ik(t,"x"),y:(e,{transform:t})=>ik(t,"y")};H_.translateX=H_.x;H_.translateY=H_.y;const G_=new Set;let ak=!1,ok=!1,sk=!1;function dX(){if(ok){const e=Array.from(G_).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),n=new Map;t.forEach(i=>{const c=qme(i);c.length&&(n.set(i,c),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const c=n.get(i);c&&c.forEach(([d,m])=>{i.getValue(d)?.set(m)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}ok=!1,ak=!1,G_.forEach(e=>e.complete(sk)),G_.clear()}function fX(){G_.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(ok=!0)})}function Hme(){sk=!0,fX(),dX(),sk=!1}class XN{constructor(t,n,i,c,d,m=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=i,this.motionValue=c,this.element=d,this.isAsync=m}scheduleResolve(){this.state="scheduled",this.isAsync?(G_.add(this),ak||(ak=!0,Ho.read(fX),Ho.resolveKeyframes(dX))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:i,motionValue:c}=this;if(t[0]===null){const d=c?.get(),m=t[t.length-1];if(d!==void 0)t[0]=d;else if(i&&n){const a=i.readValue(n,m);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=m),c&&d===void 0&&c.set(t[0])}zme(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),G_.delete(this)}cancel(){this.state==="scheduled"&&(G_.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Gme=e=>e.startsWith("--");function Wme(e,t,n){Gme(t)?e.style.setProperty(t,n):e.style[t]=n}const Xme=LN(()=>window.ScrollTimeline!==void 0),Zme={};function Yme(e,t){const n=LN(e);return()=>Zme[t]??n()}const pX=Yme(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),gw=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,H5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gw([0,.65,.55,1]),circOut:gw([.55,0,1,.45]),backIn:gw([.31,.01,.66,-.59]),backOut:gw([.33,1.53,.69,.99])};function mX(e,t){if(e)return typeof e=="function"?pX()?cX(e,t):"ease-out":Q9(e)?gw(e):Array.isArray(e)?e.map(n=>mX(n,t)||H5.easeOut):H5[e]}function Kme(e,t,n,{delay:i=0,duration:c=300,repeat:d=0,repeatType:m="loop",ease:a="easeOut",times:w}={},S=void 0){const M={[t]:n};w&&(M.offset=w);const P=mX(a,c);Array.isArray(P)&&(M.easing=P);const N={delay:i,duration:c,easing:Array.isArray(P)?"linear":P,fill:"both",iterations:d+1,direction:m==="reverse"?"alternate":"normal"};return S&&(N.pseudoElement=S),e.animate(M,N)}function gX(e){return typeof e=="function"&&"applyToOptions"in e}function Jme({type:e,...t}){return gX(e)&&pX()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class Qme extends GN{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:i,keyframes:c,pseudoElement:d,allowFlatten:m=!1,finalKeyframe:a,onComplete:w}=t;this.isPseudoElement=!!d,this.allowFlatten=m,this.options=t,kN(typeof t.type!="string");const S=Jme(t);this.animation=Kme(n,i,c,S,d),S.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!d){const M=HN(c,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(M):Wme(n,i,M),this.animation.cancel()}w?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return up(Number(t))}get time(){return up(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=cp(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&Xme()?(this.animation.timeline=t,Kh):n(this)}}const yX={anticipate:Z9,backInOut:X9,circInOut:K9};function ege(e){return e in yX}function tge(e){typeof e.ease=="string"&&ege(e.ease)&&(e.ease=yX[e.ease])}const G5=10;class nge extends Qme{constructor(t){tge(t),hX(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:i,onComplete:c,element:d,...m}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const a=new WN({...m,autoplay:!1}),w=cp(this.finishedTime??this.time);n.setWithVelocity(a.sample(w-G5).value,a.sample(w).value,G5),a.stop()}}const W5=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(fy.test(e)||e==="0")&&!e.startsWith("url("));function rge(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function ige(e,t,n,i){const c=e[0];if(c===null)return!1;if(t==="display"||t==="visibility")return!0;const d=e[e.length-1],m=W5(c,t),a=W5(d,t);return!m||!a?!1:rge(e)||(n==="spring"||gX(n))&&i}function lk(e){e.duration=0,e.type}const age=new Set(["opacity","clipPath","filter","transform"]),oge=LN(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function sge(e){const{motionValue:t,name:n,repeatDelay:i,repeatType:c,damping:d,type:m}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:w,transformTemplate:S}=t.owner.getProps();return oge()&&n&&age.has(n)&&(n!=="transform"||!S)&&!w&&!i&&c!=="mirror"&&d!==0&&m!=="inertia"}const lge=40;class cge extends GN{constructor({autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:c=0,repeatDelay:d=0,repeatType:m="loop",keyframes:a,name:w,motionValue:S,element:M,...P}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=su.now();const N={autoplay:t,delay:n,type:i,repeat:c,repeatDelay:d,repeatType:m,name:w,motionValue:S,element:M,...P},$=M?.KeyframeResolver||XN;this.keyframeResolver=new $(a,(G,q,V)=>this.onKeyframesResolved(G,q,N,!V),w,S,M),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,n,i,c){this.keyframeResolver=void 0;const{name:d,type:m,velocity:a,delay:w,isHandoff:S,onUpdate:M}=i;this.resolvedAt=su.now(),ige(t,d,m,a)||((Vm.instantAnimations||!w)&&M?.(HN(t,i,n)),t[0]=t[t.length-1],lk(i),i.repeat=0);const N={startTime:c?this.resolvedAt?this.resolvedAt-this.createdAt>lge?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:t},$=!S&&sge(N)?new nge({...N,element:N.motionValue.owner.current}):new WN(N);$.finished.then(()=>this.notifyFinished()).catch(Kh),this.pendingTimeline&&(this.stopTimeline=$.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=$}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),Hme()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const uge=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function hge(e){const t=uge.exec(e);if(!t)return[,];const[,n,i,c]=t;return[`--${n??i}`,c]}function _X(e,t,n=1){const[i,c]=hge(e);if(!i)return;const d=window.getComputedStyle(t).getPropertyValue(i);if(d){const m=d.trim();return F9(m)?parseFloat(m):m}return FN(c)?_X(c,t,n+1):c}function ZN(e,t){return e?.[t]??e?.default??e}const vX=new Set(["width","height","top","left","right","bottom",...C0]),dge={test:e=>e==="auto",parse:e=>e},xX=e=>t=>t.test(e),bX=[A0,Ti,hp,Qg,rme,nme,dge],X5=e=>bX.find(xX(e));function fge(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||U9(e):!0}const pge=new Set(["brightness","contrast","saturate","opacity"]);function mge(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=n.match(VN)||[];if(!i)return e;const c=n.replace(i,"");let d=pge.has(t)?1:0;return i!==n&&(d*=100),t+"("+d+c+")"}const gge=/\b([a-z-]*)\(.*?\)/gu,ck={...fy,getAnimatableNone:e=>{const t=e.match(gge);return t?t.map(mge).join(" "):e}},Z5={...A0,transform:Math.round},yge={rotate:Qg,rotateX:Qg,rotateY:Qg,rotateZ:Qg,scale:zT,scaleX:zT,scaleY:zT,scaleZ:zT,skew:Qg,skewX:Qg,skewY:Qg,distance:Ti,translateX:Ti,translateY:Ti,translateZ:Ti,x:Ti,y:Ti,z:Ti,perspective:Ti,transformPerspective:Ti,opacity:Fw,originX:N5,originY:N5,originZ:Ti},YN={borderWidth:Ti,borderTopWidth:Ti,borderRightWidth:Ti,borderBottomWidth:Ti,borderLeftWidth:Ti,borderRadius:Ti,radius:Ti,borderTopLeftRadius:Ti,borderTopRightRadius:Ti,borderBottomRightRadius:Ti,borderBottomLeftRadius:Ti,width:Ti,maxWidth:Ti,height:Ti,maxHeight:Ti,top:Ti,right:Ti,bottom:Ti,left:Ti,padding:Ti,paddingTop:Ti,paddingRight:Ti,paddingBottom:Ti,paddingLeft:Ti,margin:Ti,marginTop:Ti,marginRight:Ti,marginBottom:Ti,marginLeft:Ti,backgroundPositionX:Ti,backgroundPositionY:Ti,...yge,zIndex:Z5,fillOpacity:Fw,strokeOpacity:Fw,numOctaves:Z5},_ge={...YN,color:Vs,backgroundColor:Vs,outlineColor:Vs,fill:Vs,stroke:Vs,borderColor:Vs,borderTopColor:Vs,borderRightColor:Vs,borderBottomColor:Vs,borderLeftColor:Vs,filter:ck,WebkitFilter:ck},wX=e=>_ge[e];function SX(e,t){let n=wX(e);return n!==ck&&(n=fy),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const vge=new Set(["auto","none","0"]);function xge(e,t,n){let i=0,c;for(;i<e.length&&!c;){const d=e[i];typeof d=="string"&&!vge.has(d)&&Vw(d).values.length&&(c=e[i]),i++}if(c&&n)for(const d of t)e[d]=SX(n,c)}class bge extends XN{constructor(t,n,i,c,d){super(t,n,i,c,d,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let w=0;w<t.length;w++){let S=t[w];if(typeof S=="string"&&(S=S.trim(),FN(S))){const M=_X(S,n.current);M!==void 0&&(t[w]=M),w===t.length-1&&(this.finalKeyframe=S)}}if(this.resolveNoneKeyframes(),!vX.has(i)||t.length!==2)return;const[c,d]=t,m=X5(c),a=X5(d);if(m!==a)if(q5(m)&&q5(a))for(let w=0;w<t.length;w++){const S=t[w];typeof S=="string"&&(t[w]=parseFloat(S))}else H_[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,i=[];for(let c=0;c<t.length;c++)(t[c]===null||fge(t[c]))&&i.push(c);i.length&&xge(t,i,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=H_[i](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const c=n[n.length-1];c!==void 0&&t.getValue(i,c).jump(c,!1)}measureEndState(){const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const c=t.getValue(n);c&&c.jump(this.measuredOrigin,!1);const d=i.length-1,m=i[d];i[d]=H_[n](t.measureViewportBox(),window.getComputedStyle(t.current)),m!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=m),this.removedTransforms?.length&&this.removedTransforms.forEach(([a,w])=>{t.getValue(a).set(w)}),this.resolveNoneKeyframes()}}function wge(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;const c=n?.[e]??i.querySelectorAll(e);return c?Array.from(c):[]}return Array.from(e)}const TX=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function Sge(e){return V9(e)&&"offsetHeight"in e}const Y5=30,Tge=e=>!isNaN(parseFloat(e));class Ege{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const c=su.now();if(this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const d of this.dependents)d.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=su.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Tge(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new NN);const i=this.events[t].add(n);return t==="change"?()=>{i(),Ho.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=su.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Y5)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Y5);return $9(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $x(e,t){return new Ege(e,t)}const{schedule:KN}=eX(queueMicrotask,!1),Ud={x:!1,y:!1};function EX(){return Ud.x||Ud.y}function Age(e){return e==="x"||e==="y"?Ud[e]?null:(Ud[e]=!0,()=>{Ud[e]=!1}):Ud.x||Ud.y?null:(Ud.x=Ud.y=!0,()=>{Ud.x=Ud.y=!1})}function AX(e,t){const n=wge(e),i=new AbortController,c={passive:!0,...t,signal:i.signal};return[n,c,()=>i.abort()]}function K5(e){return!(e.pointerType==="touch"||EX())}function Cge(e,t,n={}){const[i,c,d]=AX(e,n),m=a=>{if(!K5(a))return;const{target:w}=a,S=t(w,a);if(typeof S!="function"||!w)return;const M=P=>{K5(P)&&(S(P),w.removeEventListener("pointerleave",M))};w.addEventListener("pointerleave",M,c)};return i.forEach(a=>{a.addEventListener("pointerenter",m,c)}),d}const CX=(e,t)=>t?e===t?!0:CX(e,t.parentElement):!1,JN=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Mge=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Pge(e){return Mge.has(e.tagName)||e.tabIndex!==-1}const cE=new WeakSet;function J5(e){return t=>{t.key==="Enter"&&e(t)}}function nP(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Oge=(e,t)=>{const n=e.currentTarget;if(!n)return;const i=J5(()=>{if(cE.has(n))return;nP(n,"down");const c=J5(()=>{nP(n,"up")}),d=()=>nP(n,"cancel");n.addEventListener("keyup",c,t),n.addEventListener("blur",d,t)});n.addEventListener("keydown",i,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),t)};function Q5(e){return JN(e)&&!EX()}function Rge(e,t,n={}){const[i,c,d]=AX(e,n),m=a=>{const w=a.currentTarget;if(!Q5(a))return;cE.add(w);const S=t(w,a),M=($,G)=>{window.removeEventListener("pointerup",P),window.removeEventListener("pointercancel",N),cE.has(w)&&cE.delete(w),Q5($)&&typeof S=="function"&&S($,{success:G})},P=$=>{M($,w===window||w===document||n.useGlobalTarget||CX(w,$.target))},N=$=>{M($,!1)};window.addEventListener("pointerup",P,c),window.addEventListener("pointercancel",N,c)};return i.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",m,c),Sge(a)&&(a.addEventListener("focus",S=>Oge(S,c)),!Pge(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),d}function MX(e){return V9(e)&&"ownerSVGElement"in e}function Ige(e){return MX(e)&&e.tagName==="svg"}const dc=e=>!!(e&&e.getVelocity),Dge=[...bX,Vs,fy],kge=e=>Dge.find(xX(e)),PX=K.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Lge(e=!0){const t=K.useContext(RN);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:c}=t,d=K.useId();K.useEffect(()=>{if(e)return c(d)},[e]);const m=K.useCallback(()=>e&&i&&i(d),[d,i,e]);return!n&&i?[!1,m]:[!0]}const OX=K.createContext({strict:!1}),e4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},qx={};for(const e in e4)qx[e]={isEnabled:t=>e4[e].some(n=>!!t[n])};function Nge(e){for(const t in e)qx[t]={...qx[t],...e[t]}}const zge=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function IE(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||zge.has(e)}let RX=e=>!IE(e);function jge(e){typeof e=="function"&&(RX=t=>t.startsWith("on")?!IE(t):e(t))}try{jge(require("@emotion/is-prop-valid").default)}catch{}function Bge(e,t,n){const i={};for(const c in e)c==="values"&&typeof e.values=="object"||(RX(c)||n===!0&&IE(c)||!t&&!IE(c)||e.draggable&&c.startsWith("onDrag"))&&(i[c]=e[c]);return i}const E2=K.createContext({});function A2(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Uw(e){return typeof e=="string"||Array.isArray(e)}const QN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ez=["initial",...QN];function C2(e){return A2(e.animate)||ez.some(t=>Uw(e[t]))}function IX(e){return!!(C2(e)||e.variants)}function Fge(e,t){if(C2(e)){const{initial:n,animate:i}=e;return{initial:n===!1||Uw(n)?n:void 0,animate:Uw(i)?i:void 0}}return e.inherit!==!1?t:{}}function Vge(e){const{initial:t,animate:n}=Fge(e,K.useContext(E2));return K.useMemo(()=>({initial:t,animate:n}),[t4(t),t4(n)])}function t4(e){return Array.isArray(e)?e.join(" "):e}const $w={};function Uge(e){for(const t in e)$w[t]=e[t],BN(t)&&($w[t].isCSSVariable=!0)}function DX(e,{layout:t,layoutId:n}){return M0.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!$w[e]||e==="opacity")}const $ge={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qge=C0.length;function Hge(e,t,n){let i="",c=!0;for(let d=0;d<qge;d++){const m=C0[d],a=e[m];if(a===void 0)continue;let w=!0;if(typeof a=="number"?w=a===(m.startsWith("scale")?1:0):w=parseFloat(a)===0,!w||n){const S=TX(a,YN[m]);if(!w){c=!1;const M=$ge[m]||m;i+=`${M}(${S}) `}n&&(t[m]=S)}}return i=i.trim(),n?i=n(t,c?"":i):c&&(i="none"),i}function tz(e,t,n){const{style:i,vars:c,transformOrigin:d}=e;let m=!1,a=!1;for(const w in t){const S=t[w];if(M0.has(w)){m=!0;continue}else if(BN(w)){c[w]=S;continue}else{const M=TX(S,YN[w]);w.startsWith("origin")?(a=!0,d[w]=M):i[w]=M}}if(t.transform||(m||n?i.transform=Hge(t,e.transform,n):i.transform&&(i.transform="none")),a){const{originX:w="50%",originY:S="50%",originZ:M=0}=d;i.transformOrigin=`${w} ${S} ${M}`}}const nz=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function kX(e,t,n){for(const i in t)!dc(t[i])&&!DX(i,n)&&(e[i]=t[i])}function Gge({transformTemplate:e},t){return K.useMemo(()=>{const n=nz();return tz(n,t,e),Object.assign({},n.vars,n.style)},[t])}function Wge(e,t){const n=e.style||{},i={};return kX(i,n,e),Object.assign(i,Gge(e,t)),i}function Xge(e,t){const n={},i=Wge(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const Zge={offset:"stroke-dashoffset",array:"stroke-dasharray"},Yge={offset:"strokeDashoffset",array:"strokeDasharray"};function Kge(e,t,n=1,i=0,c=!0){e.pathLength=1;const d=c?Zge:Yge;e[d.offset]=Ti.transform(-i);const m=Ti.transform(t),a=Ti.transform(n);e[d.array]=`${m} ${a}`}function LX(e,{attrX:t,attrY:n,attrScale:i,pathLength:c,pathSpacing:d=1,pathOffset:m=0,...a},w,S,M){if(tz(e,a,S),w){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:P,style:N}=e;P.transform&&(N.transform=P.transform,delete P.transform),(N.transform||P.transformOrigin)&&(N.transformOrigin=P.transformOrigin??"50% 50%",delete P.transformOrigin),N.transform&&(N.transformBox=M?.transformBox??"fill-box",delete P.transformBox),t!==void 0&&(P.x=t),n!==void 0&&(P.y=n),i!==void 0&&(P.scale=i),c!==void 0&&Kge(P,c,d,m,!1)}const NX=()=>({...nz(),attrs:{}}),zX=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Jge(e,t,n,i){const c=K.useMemo(()=>{const d=NX();return LX(d,t,zX(i),e.transformTemplate,e.style),{...d.attrs,style:{...d.style}}},[t]);if(e.style){const d={};kX(d,e.style,e),c.style={...d,...c.style}}return c}const Qge=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function rz(e){return typeof e!="string"||e.includes("-")?!1:!!(Qge.indexOf(e)>-1||/[A-Z]/u.test(e))}function eye(e,t,n,{latestValues:i},c,d=!1){const a=(rz(e)?Jge:Xge)(t,i,c,e),w=Bge(t,typeof e=="string",d),S=e!==K.Fragment?{...w,...a,ref:n}:{},{children:M}=t,P=K.useMemo(()=>dc(M)?M.get():M,[M]);return K.createElement(e,{...S,children:P})}function n4(e){const t=[{},{}];return e?.values.forEach((n,i)=>{t[0][i]=n.get(),t[1][i]=n.getVelocity()}),t}function iz(e,t,n,i){if(typeof t=="function"){const[c,d]=n4(i);t=t(n!==void 0?n:e.custom,c,d)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[c,d]=n4(i);t=t(n!==void 0?n:e.custom,c,d)}return t}function uE(e){return dc(e)?e.get():e}function tye({scrapeMotionValuesFromProps:e,createRenderState:t},n,i,c){return{latestValues:nye(n,i,c,e),renderState:t()}}function nye(e,t,n,i){const c={},d=i(e,{});for(const N in d)c[N]=uE(d[N]);let{initial:m,animate:a}=e;const w=C2(e),S=IX(e);t&&S&&!w&&e.inherit!==!1&&(m===void 0&&(m=t.initial),a===void 0&&(a=t.animate));let M=n?n.initial===!1:!1;M=M||m===!1;const P=M?a:m;if(P&&typeof P!="boolean"&&!A2(P)){const N=Array.isArray(P)?P:[P];for(let $=0;$<N.length;$++){const G=iz(e,N[$]);if(G){const{transitionEnd:q,transition:V,...J}=G;for(const ee in J){let re=J[ee];if(Array.isArray(re)){const fe=M?re.length-1:0;re=re[fe]}re!==null&&(c[ee]=re)}for(const ee in q)c[ee]=q[ee]}}}return c}const jX=e=>(t,n)=>{const i=K.useContext(E2),c=K.useContext(RN),d=()=>tye(e,t,i,c);return n?d():Npe(d)};function az(e,t,n){const{style:i}=e,c={};for(const d in i)(dc(i[d])||t.style&&dc(t.style[d])||DX(d,e)||n?.getValue(d)?.liveStyle!==void 0)&&(c[d]=i[d]);return c}const rye=jX({scrapeMotionValuesFromProps:az,createRenderState:nz});function BX(e,t,n){const i=az(e,t,n);for(const c in e)if(dc(e[c])||dc(t[c])){const d=C0.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;i[d]=e[c]}return i}const iye=jX({scrapeMotionValuesFromProps:BX,createRenderState:NX}),aye=Symbol.for("motionComponentSymbol");function xx(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function oye(e,t,n){return K.useCallback(i=>{i&&e.onMount&&e.onMount(i),t&&(i?t.mount(i):t.unmount()),n&&(typeof n=="function"?n(i):xx(n)&&(n.current=i))},[t])}const oz=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),sye="framerAppearId",FX="data-"+oz(sye),VX=K.createContext({});function lye(e,t,n,i,c){const{visualElement:d}=K.useContext(E2),m=K.useContext(OX),a=K.useContext(RN),w=K.useContext(PX).reducedMotion,S=K.useRef(null);i=i||m.renderer,!S.current&&i&&(S.current=i(e,{visualState:t,parent:d,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:w}));const M=S.current,P=K.useContext(VX);M&&!M.projection&&c&&(M.type==="html"||M.type==="svg")&&cye(S.current,n,c,P);const N=K.useRef(!1);K.useInsertionEffect(()=>{M&&N.current&&M.update(n,a)});const $=n[FX],G=K.useRef(!!$&&!window.MotionHandoffIsComplete?.($)&&window.MotionHasOptimisedAnimation?.($));return zpe(()=>{M&&(N.current=!0,window.MotionIsMounted=!0,M.updateFeatures(),M.scheduleRenderMicrotask(),G.current&&M.animationState&&M.animationState.animateChanges())}),K.useEffect(()=>{M&&(!G.current&&M.animationState&&M.animationState.animateChanges(),G.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.($)}),G.current=!1),M.enteringChildren=void 0)}),M}function cye(e,t,n,i){const{layoutId:c,layout:d,drag:m,dragConstraints:a,layoutScroll:w,layoutRoot:S,layoutCrossfade:M}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:UX(e.parent)),e.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!m||a&&xx(a),visualElement:e,animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,crossfade:M,layoutScroll:w,layoutRoot:S})}function UX(e){if(e)return e.options.allowProjection!==!1?e.projection:UX(e.parent)}function rP(e,{forwardMotionProps:t=!1}={},n,i){n&&Nge(n);const c=rz(e)?iye:rye;function d(a,w){let S;const M={...K.useContext(PX),...a,layoutId:uye(a)},{isStatic:P}=M,N=Vge(a),$=c(a,P);if(!P&&ON){hye();const G=dye(M);S=G.MeasureLayout,N.visualElement=lye(e,$,M,i,G.ProjectionNode)}return D.jsxs(E2.Provider,{value:N,children:[S&&N.visualElement?D.jsx(S,{visualElement:N.visualElement,...M}):null,eye(e,a,oye($,N.visualElement,w),$,P,t)]})}d.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const m=K.forwardRef(d);return m[aye]=e,m}function uye({layoutId:e}){const t=K.useContext(B9).id;return t&&e!==void 0?t+"-"+e:e}function hye(e,t){K.useContext(OX).strict}function dye(e){const{drag:t,layout:n}=qx;if(!t&&!n)return{};const i={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function fye(e,t){if(typeof Proxy>"u")return rP;const n=new Map,i=(d,m)=>rP(d,m,e,t),c=(d,m)=>i(d,m);return new Proxy(c,{get:(d,m)=>m==="create"?i:(n.has(m)||n.set(m,rP(m,void 0,e,t)),n.get(m))})}function $X({top:e,left:t,right:n,bottom:i}){return{x:{min:t,max:n},y:{min:e,max:i}}}function pye({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function mye(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function iP(e){return e===void 0||e===1}function uk({scale:e,scaleX:t,scaleY:n}){return!iP(e)||!iP(t)||!iP(n)}function O_(e){return uk(e)||qX(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function qX(e){return r4(e.x)||r4(e.y)}function r4(e){return e&&e!=="0%"}function DE(e,t,n){const i=e-n,c=t*i;return n+c}function i4(e,t,n,i,c){return c!==void 0&&(e=DE(e,c,i)),DE(e,n,i)+t}function hk(e,t=0,n=1,i,c){e.min=i4(e.min,t,n,i,c),e.max=i4(e.max,t,n,i,c)}function HX(e,{x:t,y:n}){hk(e.x,t.translate,t.scale,t.originPoint),hk(e.y,n.translate,n.scale,n.originPoint)}const a4=.999999999999,o4=1.0000000000001;function gye(e,t,n,i=!1){const c=n.length;if(!c)return;t.x=t.y=1;let d,m;for(let a=0;a<c;a++){d=n[a],m=d.projectionDelta;const{visualElement:w}=d.options;w&&w.props.style&&w.props.style.display==="contents"||(i&&d.options.layoutScroll&&d.scroll&&d!==d.root&&wx(e,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),m&&(t.x*=m.x.scale,t.y*=m.y.scale,HX(e,m)),i&&O_(d.latestValues)&&wx(e,d.latestValues))}t.x<o4&&t.x>a4&&(t.x=1),t.y<o4&&t.y>a4&&(t.y=1)}function bx(e,t){e.min=e.min+t,e.max=e.max+t}function s4(e,t,n,i,c=.5){const d=is(e.min,e.max,c);hk(e,t,n,d,i)}function wx(e,t){s4(e.x,t.x,t.scaleX,t.scale,t.originX),s4(e.y,t.y,t.scaleY,t.scale,t.originY)}function GX(e,t){return $X(mye(e.getBoundingClientRect(),t))}function yye(e,t,n){const i=GX(e,n),{scroll:c}=t;return c&&(bx(i.x,c.offset.x),bx(i.y,c.offset.y)),i}const l4=()=>({translate:0,scale:1,origin:0,originPoint:0}),Sx=()=>({x:l4(),y:l4()}),c4=()=>({min:0,max:0}),Es=()=>({x:c4(),y:c4()}),dk={current:null},WX={current:!1};function _ye(){if(WX.current=!0,!!ON)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>dk.current=e.matches;e.addEventListener("change",t),t()}else dk.current=!1}const vye=new WeakMap;function xye(e,t,n){for(const i in t){const c=t[i],d=n[i];if(dc(c))e.addValue(i,c);else if(dc(d))e.addValue(i,$x(c,{owner:e}));else if(d!==c)if(e.hasValue(i)){const m=e.getValue(i);m.liveStyle===!0?m.jump(c):m.hasAnimated||m.set(c)}else{const m=e.getStaticValue(i);e.addValue(i,$x(m!==void 0?m:c,{owner:e}))}}for(const i in n)t[i]===void 0&&e.removeValue(i);return t}const u4=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class bye{scrapeMotionValuesFromProps(t,n,i){return{}}constructor({parent:t,props:n,presenceContext:i,reducedMotionConfig:c,blockInitialAnimation:d,visualState:m},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=XN,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const N=su.now();this.renderScheduledAt<N&&(this.renderScheduledAt=N,Ho.render(this.render,!1,!0))};const{latestValues:w,renderState:S}=m;this.latestValues=w,this.baseTarget={...w},this.initialValues=n.initial?{...w}:{},this.renderState=S,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=c,this.options=a,this.blockInitialAnimation=!!d,this.isControllingVariants=C2(n),this.isVariantNode=IX(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:M,...P}=this.scrapeMotionValuesFromProps(n,{},this);for(const N in P){const $=P[N];w[N]!==void 0&&dc($)&&$.set(w[N])}}mount(t){this.current=t,vye.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),WX.current||_ye(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:dk.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),dy(this.notifyUpdate),dy(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=M0.has(t);i&&this.onBindTransform&&this.onBindTransform();const c=n.on("change",m=>{this.latestValues[t]=m,this.props.onUpdate&&Ho.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let d;window.MotionCheckAppearSync&&(d=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{c(),d&&d(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in qx){const n=qx[t];if(!n)continue;const{isEnabled:i,Feature:c}=n;if(!this.features[t]&&c&&i(this.props)&&(this.features[t]=new c(this)),this.features[t]){const d=this.features[t];d.isMounted?d.update():(d.mount(),d.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Es()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<u4.length;i++){const c=u4[i];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);const d="on"+c,m=t[d];m&&(this.propEventSubscriptions[c]=this.on(c,m))}this.prevMotionValues=xye(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const i=this.values.get(t);n!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&n!==void 0&&(i=$x(n===null?void 0:n,{owner:this}),this.addValue(t,i)),i}readValue(t,n){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(F9(i)||U9(i))?i=parseFloat(i):!kge(i)&&fy.test(n)&&(i=SX(t,n)),this.setBaseTarget(t,dc(i)?i.get():i)),dc(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const d=iz(this.props,n,this.presenceContext?.custom);d&&(i=d[t])}if(n&&i!==void 0)return i;const c=this.getBaseTargetFromProps(this.props,t);return c!==void 0&&!dc(c)?c:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new NN),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){KN.render(this.render)}}class XX extends bye{constructor(){super(...arguments),this.KeyframeResolver=bge}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:i}){delete n[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;dc(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function ZX(e,{style:t,vars:n},i,c){const d=e.style;let m;for(m in t)d[m]=t[m];c?.applyProjectionStyles(d,i);for(m in n)d.setProperty(m,n[m])}function wye(e){return window.getComputedStyle(e)}class Sye extends XX{constructor(){super(...arguments),this.type="html",this.renderInstance=ZX}readValueFromInstance(t,n){if(M0.has(n))return this.projection?.isProjecting?rk(n):Fme(t,n);{const i=wye(t),c=(BN(n)?i.getPropertyValue(n):i[n])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(t,{transformPagePoint:n}){return GX(t,n)}build(t,n,i){tz(t,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,n,i){return az(t,n,i)}}const YX=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Tye(e,t,n,i){ZX(e,t,void 0,i);for(const c in t.attrs)e.setAttribute(YX.has(c)?c:oz(c),t.attrs[c])}class Eye extends XX{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Es}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(M0.has(n)){const i=wX(n);return i&&i.default||0}return n=YX.has(n)?n:oz(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,i){return BX(t,n,i)}build(t,n,i){LX(t,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,n,i,c){Tye(t,n,i,c)}mount(t){this.isSVGTag=zX(t.tagName),super.mount(t)}}const Aye=(e,t)=>rz(e)?new Eye(t):new Sye(t,{allowProjection:e!==K.Fragment});function Ix(e,t,n){const i=e.getProps();return iz(i,t,n!==void 0?n:i.custom,e)}const fk=e=>Array.isArray(e);function Cye(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,$x(n))}function Mye(e){return fk(e)?e[e.length-1]||0:e}function Pye(e,t){const n=Ix(e,t);let{transitionEnd:i={},transition:c={},...d}=n||{};d={...d,...i};for(const m in d){const a=Mye(d[m]);Cye(e,m,a)}}function Oye(e){return!!(dc(e)&&e.add)}function pk(e,t){const n=e.getValue("willChange");if(Oye(n))return n.add(t);if(!n&&Vm.WillChange){const i=new Vm.WillChange("auto");e.addValue("willChange",i),i.add(t)}}function KX(e){return e.props[FX]}const Rye=e=>e!==null;function Iye(e,{repeat:t,repeatType:n="loop"},i){const c=e.filter(Rye),d=t&&n!=="loop"&&t%2===1?0:c.length-1;return c[d]}const Dye={type:"spring",stiffness:500,damping:25,restSpeed:10},kye=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Lye={type:"keyframes",duration:.8},Nye={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},zye=(e,{keyframes:t})=>t.length>2?Lye:M0.has(e)?e.startsWith("scale")?kye(t[1]):Dye:Nye;function jye({when:e,delay:t,delayChildren:n,staggerChildren:i,staggerDirection:c,repeat:d,repeatType:m,repeatDelay:a,from:w,elapsed:S,...M}){return!!Object.keys(M).length}const sz=(e,t,n,i={},c,d)=>m=>{const a=ZN(i,e)||{},w=a.delay||i.delay||0;let{elapsed:S=0}=i;S=S-cp(w);const M={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-S,onUpdate:N=>{t.set(N),a.onUpdate&&a.onUpdate(N)},onComplete:()=>{m(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:d?void 0:c};jye(a)||Object.assign(M,zye(e,M)),M.duration&&(M.duration=cp(M.duration)),M.repeatDelay&&(M.repeatDelay=cp(M.repeatDelay)),M.from!==void 0&&(M.keyframes[0]=M.from);let P=!1;if((M.type===!1||M.duration===0&&!M.repeatDelay)&&(lk(M),M.delay===0&&(P=!0)),(Vm.instantAnimations||Vm.skipAnimations)&&(P=!0,lk(M),M.delay=0),M.allowFlatten=!a.type&&!a.ease,P&&!d&&t.get()!==void 0){const N=Iye(M.keyframes,a);if(N!==void 0){Ho.update(()=>{M.onUpdate(N),M.onComplete()});return}}return a.isSync?new WN(M):new cge(M)};function Bye({protectedKeys:e,needsAnimating:t},n){const i=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,i}function JX(e,t,{delay:n=0,transitionOverride:i,type:c}={}){let{transition:d=e.getDefaultTransition(),transitionEnd:m,...a}=t;i&&(d=i);const w=[],S=c&&e.animationState&&e.animationState.getState()[c];for(const M in a){const P=e.getValue(M,e.latestValues[M]??null),N=a[M];if(N===void 0||S&&Bye(S,M))continue;const $={delay:n,...ZN(d||{},M)},G=P.get();if(G!==void 0&&!P.isAnimating&&!Array.isArray(N)&&N===G&&!$.velocity)continue;let q=!1;if(window.MotionHandoffAnimation){const J=KX(e);if(J){const ee=window.MotionHandoffAnimation(J,M,Ho);ee!==null&&($.startTime=ee,q=!0)}}pk(e,M),P.start(sz(M,P,N,e.shouldReduceMotion&&vX.has(M)?{type:!1}:$,e,q));const V=P.animation;V&&w.push(V)}return m&&Promise.all(w).then(()=>{Ho.update(()=>{m&&Pye(e,m)})}),w}function QX(e,t,n,i=0,c=1){const d=Array.from(e).sort((S,M)=>S.sortNodePosition(M)).indexOf(t),m=e.size,a=(m-1)*i;return typeof n=="function"?n(d,m):c===1?d*i:a-d*i}function mk(e,t,n={}){const i=Ix(e,t,n.type==="exit"?e.presenceContext?.custom:void 0);let{transition:c=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(c=n.transitionOverride);const d=i?()=>Promise.all(JX(e,i,n)):()=>Promise.resolve(),m=e.variantChildren&&e.variantChildren.size?(w=0)=>{const{delayChildren:S=0,staggerChildren:M,staggerDirection:P}=c;return Fye(e,t,w,S,M,P,n)}:()=>Promise.resolve(),{when:a}=c;if(a){const[w,S]=a==="beforeChildren"?[d,m]:[m,d];return w().then(()=>S())}else return Promise.all([d(),m(n.delay)])}function Fye(e,t,n=0,i=0,c=0,d=1,m){const a=[];for(const w of e.variantChildren)w.notify("AnimationStart",t),a.push(mk(w,t,{...m,delay:n+(typeof i=="function"?0:i)+QX(e.variantChildren,w,i,c,d)}).then(()=>w.notify("AnimationComplete",t)));return Promise.all(a)}function Vye(e,t,n={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const c=t.map(d=>mk(e,d,n));i=Promise.all(c)}else if(typeof t=="string")i=mk(e,t,n);else{const c=typeof t=="function"?Ix(e,t,n.custom):t;i=Promise.all(JX(e,c,n))}return i.then(()=>{e.notify("AnimationComplete",t)})}function eZ(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}const Uye=ez.length;function tZ(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?tZ(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<Uye;n++){const i=ez[n],c=e.props[i];(Uw(c)||c===!1)&&(t[i]=c)}return t}const $ye=[...QN].reverse(),qye=QN.length;function Hye(e){return t=>Promise.all(t.map(({animation:n,options:i})=>Vye(e,n,i)))}function Gye(e){let t=Hye(e),n=h4(),i=!0;const c=w=>(S,M)=>{const P=Ix(e,M,w==="exit"?e.presenceContext?.custom:void 0);if(P){const{transition:N,transitionEnd:$,...G}=P;S={...S,...G,...$}}return S};function d(w){t=w(e)}function m(w){const{props:S}=e,M=tZ(e.parent)||{},P=[],N=new Set;let $={},G=1/0;for(let V=0;V<qye;V++){const J=$ye[V],ee=n[J],re=S[J]!==void 0?S[J]:M[J],fe=Uw(re),ne=J===w?ee.isActive:null;ne===!1&&(G=V);let ce=re===M[J]&&re!==S[J]&&fe;if(ce&&i&&e.manuallyAnimateOnMount&&(ce=!1),ee.protectedKeys={...$},!ee.isActive&&ne===null||!re&&!ee.prevProp||A2(re)||typeof re=="boolean")continue;const me=Wye(ee.prevProp,re);let ve=me||J===w&&ee.isActive&&!ce&&fe||V>G&&fe,De=!1;const Ye=Array.isArray(re)?re:[re];let ze=Ye.reduce(c(J),{});ne===!1&&(ze={});const{prevResolvedValues:tt={}}=ee,at={...tt,...ze},ct=rt=>{ve=!0,N.has(rt)&&(De=!0,N.delete(rt)),ee.needsAnimating[rt]=!0;const Qe=e.getValue(rt);Qe&&(Qe.liveStyle=!1)};for(const rt in at){const Qe=ze[rt],St=tt[rt];if($.hasOwnProperty(rt))continue;let qe=!1;fk(Qe)&&fk(St)?qe=!eZ(Qe,St):qe=Qe!==St,qe?Qe!=null?ct(rt):N.add(rt):Qe!==void 0&&N.has(rt)?ct(rt):ee.protectedKeys[rt]=!0}ee.prevProp=re,ee.prevResolvedValues=ze,ee.isActive&&($={...$,...ze}),i&&e.blockInitialAnimation&&(ve=!1);const ht=ce&&me;ve&&(!ht||De)&&P.push(...Ye.map(rt=>{const Qe={type:J};if(typeof rt=="string"&&i&&!ht&&e.manuallyAnimateOnMount&&e.parent){const{parent:St}=e,qe=Ix(St,rt);if(St.enteringChildren&&qe){const{delayChildren:vt}=qe.transition||{};Qe.delay=QX(St.enteringChildren,e,vt)}}return{animation:rt,options:Qe}}))}if(N.size){const V={};if(typeof S.initial!="boolean"){const J=Ix(e,Array.isArray(S.initial)?S.initial[0]:S.initial);J&&J.transition&&(V.transition=J.transition)}N.forEach(J=>{const ee=e.getBaseTarget(J),re=e.getValue(J);re&&(re.liveStyle=!0),V[J]=ee??null}),P.push({animation:V})}let q=!!P.length;return i&&(S.initial===!1||S.initial===S.animate)&&!e.manuallyAnimateOnMount&&(q=!1),i=!1,q?t(P):Promise.resolve()}function a(w,S){if(n[w].isActive===S)return Promise.resolve();e.variantChildren?.forEach(P=>P.animationState?.setActive(w,S)),n[w].isActive=S;const M=m(w);for(const P in n)n[P].protectedKeys={};return M}return{animateChanges:m,setActive:a,setAnimateFunction:d,getState:()=>n,reset:()=>{n=h4(),i=!0}}}function Wye(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!eZ(t,e):!1}function M_(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function h4(){return{animate:M_(!0),whileInView:M_(),whileHover:M_(),whileTap:M_(),whileDrag:M_(),whileFocus:M_(),exit:M_()}}class yy{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Xye extends yy{constructor(t){super(t),t.animationState||(t.animationState=Gye(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();A2(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Zye=0;class Yye extends yy{constructor(){super(...arguments),this.id=Zye++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const c=this.node.animationState.setActive("exit",!t);n&&!t&&c.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Kye={animation:{Feature:Xye},exit:{Feature:Yye}};function qw(e,t,n,i={passive:!0}){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}function eS(e){return{point:{x:e.pageX,y:e.pageY}}}const Jye=e=>t=>JN(t)&&e(t,eS(t));function Ew(e,t,n,i){return qw(e,t,Jye(n),i)}const nZ=1e-4,Qye=1-nZ,e_e=1+nZ,rZ=.01,t_e=0-rZ,n_e=0+rZ;function Ic(e){return e.max-e.min}function r_e(e,t,n){return Math.abs(e-t)<=n}function d4(e,t,n,i=.5){e.origin=i,e.originPoint=is(t.min,t.max,e.origin),e.scale=Ic(n)/Ic(t),e.translate=is(n.min,n.max,e.origin)-e.originPoint,(e.scale>=Qye&&e.scale<=e_e||isNaN(e.scale))&&(e.scale=1),(e.translate>=t_e&&e.translate<=n_e||isNaN(e.translate))&&(e.translate=0)}function Aw(e,t,n,i){d4(e.x,t.x,n.x,i?i.originX:void 0),d4(e.y,t.y,n.y,i?i.originY:void 0)}function f4(e,t,n){e.min=n.min+t.min,e.max=e.min+Ic(t)}function i_e(e,t,n){f4(e.x,t.x,n.x),f4(e.y,t.y,n.y)}function p4(e,t,n){e.min=t.min-n.min,e.max=e.min+Ic(t)}function Cw(e,t,n){p4(e.x,t.x,n.x),p4(e.y,t.y,n.y)}function Gh(e){return[e("x"),e("y")]}const iZ=({current:e})=>e?e.ownerDocument.defaultView:null,m4=(e,t)=>Math.abs(e-t);function a_e(e,t){const n=m4(e.x,t.x),i=m4(e.y,t.y);return Math.sqrt(n**2+i**2)}class aZ{constructor(t,n,{transformPagePoint:i,contextWindow:c=window,dragSnapToOrigin:d=!1,distanceThreshold:m=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=oP(this.lastMoveEventInfo,this.history),$=this.startEvent!==null,G=a_e(N.offset,{x:0,y:0})>=this.distanceThreshold;if(!$&&!G)return;const{point:q}=N,{timestamp:V}=Nl;this.history.push({...q,timestamp:V});const{onStart:J,onMove:ee}=this.handlers;$||(J&&J(this.lastMoveEvent,N),this.startEvent=this.lastMoveEvent),ee&&ee(this.lastMoveEvent,N)},this.handlePointerMove=(N,$)=>{this.lastMoveEvent=N,this.lastMoveEventInfo=aP($,this.transformPagePoint),Ho.update(this.updatePoint,!0)},this.handlePointerUp=(N,$)=>{this.end();const{onEnd:G,onSessionEnd:q,resumeAnimation:V}=this.handlers;if(this.dragSnapToOrigin&&V&&V(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const J=oP(N.type==="pointercancel"?this.lastMoveEventInfo:aP($,this.transformPagePoint),this.history);this.startEvent&&G&&G(N,J),q&&q(N,J)},!JN(t))return;this.dragSnapToOrigin=d,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=m,this.contextWindow=c||window;const a=eS(t),w=aP(a,this.transformPagePoint),{point:S}=w,{timestamp:M}=Nl;this.history=[{...S,timestamp:M}];const{onSessionStart:P}=n;P&&P(t,oP(w,this.history)),this.removeListeners=K1(Ew(this.contextWindow,"pointermove",this.handlePointerMove),Ew(this.contextWindow,"pointerup",this.handlePointerUp),Ew(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),dy(this.updatePoint)}}function aP(e,t){return t?{point:t(e.point)}:e}function g4(e,t){return{x:e.x-t.x,y:e.y-t.y}}function oP({point:e},t){return{point:e,delta:g4(e,oZ(t)),offset:g4(e,o_e(t)),velocity:s_e(t,.1)}}function o_e(e){return e[0]}function oZ(e){return e[e.length-1]}function s_e(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const c=oZ(e);for(;n>=0&&(i=e[n],!(c.timestamp-i.timestamp>cp(t)));)n--;if(!i)return{x:0,y:0};const d=up(c.timestamp-i.timestamp);if(d===0)return{x:0,y:0};const m={x:(c.x-i.x)/d,y:(c.y-i.y)/d};return m.x===1/0&&(m.x=0),m.y===1/0&&(m.y=0),m}function l_e(e,{min:t,max:n},i){return t!==void 0&&e<t?e=i?is(t,e,i.min):Math.max(e,t):n!==void 0&&e>n&&(e=i?is(n,e,i.max):Math.min(e,n)),e}function y4(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function c_e(e,{top:t,left:n,bottom:i,right:c}){return{x:y4(e.x,n,c),y:y4(e.y,t,i)}}function _4(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function u_e(e,t){return{x:_4(e.x,t.x),y:_4(e.y,t.y)}}function h_e(e,t){let n=.5;const i=Ic(e),c=Ic(t);return c>i?n=Bw(t.min,t.max-i,e.min):i>c&&(n=Bw(e.min,e.max-c,t.min)),Fm(0,1,n)}function d_e(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const gk=.35;function f_e(e=gk){return e===!1?e=0:e===!0&&(e=gk),{x:v4(e,"left","right"),y:v4(e,"top","bottom")}}function v4(e,t,n){return{min:x4(e,t),max:x4(e,n)}}function x4(e,t){return typeof e=="number"?e:e[t]||0}const p_e=new WeakMap;class m_e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Es(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:c}=this.visualElement;if(c&&c.isPresent===!1)return;const d=P=>{const{dragSnapToOrigin:N}=this.getProps();N?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(eS(P).point)},m=(P,N)=>{const{drag:$,dragPropagation:G,onDragStart:q}=this.getProps();if($&&!G&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Age($),!this.openDragLock))return;this.latestPointerEvent=P,this.latestPanInfo=N,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Gh(J=>{let ee=this.getAxisMotionValue(J).get()||0;if(hp.test(ee)){const{projection:re}=this.visualElement;if(re&&re.layout){const fe=re.layout.layoutBox[J];fe&&(ee=Ic(fe)*(parseFloat(ee)/100))}}this.originPoint[J]=ee}),q&&Ho.postRender(()=>q(P,N)),pk(this.visualElement,"transform");const{animationState:V}=this.visualElement;V&&V.setActive("whileDrag",!0)},a=(P,N)=>{this.latestPointerEvent=P,this.latestPanInfo=N;const{dragPropagation:$,dragDirectionLock:G,onDirectionLock:q,onDrag:V}=this.getProps();if(!$&&!this.openDragLock)return;const{offset:J}=N;if(G&&this.currentDirection===null){this.currentDirection=g_e(J),this.currentDirection!==null&&q&&q(this.currentDirection);return}this.updateAxis("x",N.point,J),this.updateAxis("y",N.point,J),this.visualElement.render(),V&&V(P,N)},w=(P,N)=>{this.latestPointerEvent=P,this.latestPanInfo=N,this.stop(P,N),this.latestPointerEvent=null,this.latestPanInfo=null},S=()=>Gh(P=>this.getAnimationState(P)==="paused"&&this.getAxisMotionValue(P).animation?.play()),{dragSnapToOrigin:M}=this.getProps();this.panSession=new aZ(t,{onSessionStart:d,onStart:m,onMove:a,onSessionEnd:w,resumeAnimation:S},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:M,distanceThreshold:i,contextWindow:iZ(this.visualElement)})}stop(t,n){const i=t||this.latestPointerEvent,c=n||this.latestPanInfo,d=this.isDragging;if(this.cancel(),!d||!c||!i)return;const{velocity:m}=c;this.startAnimation(m);const{onDragEnd:a}=this.getProps();a&&Ho.postRender(()=>a(i,c))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,i){const{drag:c}=this.getProps();if(!i||!jT(t,c,this.currentDirection))return;const d=this.getAxisMotionValue(t);let m=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(m=l_e(m,this.constraints[t],this.elastic[t])),d.set(m)}resolveConstraints(){const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,c=this.constraints;t&&xx(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=c_e(i.layoutBox,t):this.constraints=!1,this.elastic=f_e(n),c!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Gh(d=>{this.constraints!==!1&&this.getAxisMotionValue(d)&&(this.constraints[d]=d_e(i.layoutBox[d],this.constraints[d]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!xx(t))return!1;const i=t.current,{projection:c}=this.visualElement;if(!c||!c.layout)return!1;const d=yye(i,c.root,this.visualElement.getTransformPagePoint());let m=u_e(c.layout.layoutBox,d);if(n){const a=n(pye(m));this.hasMutatedConstraints=!!a,a&&(m=$X(a))}return m}startAnimation(t){const{drag:n,dragMomentum:i,dragElastic:c,dragTransition:d,dragSnapToOrigin:m,onDragTransitionEnd:a}=this.getProps(),w=this.constraints||{},S=Gh(M=>{if(!jT(M,n,this.currentDirection))return;let P=w&&w[M]||{};m&&(P={min:0,max:0});const N=c?200:1e6,$=c?40:1e7,G={type:"inertia",velocity:i?t[M]:0,bounceStiffness:N,bounceDamping:$,timeConstant:750,restDelta:1,restSpeed:10,...d,...P};return this.startAxisValueAnimation(M,G)});return Promise.all(S).then(a)}startAxisValueAnimation(t,n){const i=this.getAxisMotionValue(t);return pk(this.visualElement,t),i.start(sz(t,i,0,n,this.visualElement,!1))}stopAnimation(){Gh(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Gh(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),c=i[n];return c||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Gh(n=>{const{drag:i}=this.getProps();if(!jT(n,i,this.currentDirection))return;const{projection:c}=this.visualElement,d=this.getAxisMotionValue(n);if(c&&c.layout){const{min:m,max:a}=c.layout.layoutBox[n];d.set(t[n]-is(m,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!xx(n)||!i||!this.constraints)return;this.stopAnimation();const c={x:0,y:0};Gh(m=>{const a=this.getAxisMotionValue(m);if(a&&this.constraints!==!1){const w=a.get();c[m]=h_e({min:w,max:w},this.constraints[m])}});const{transformTemplate:d}=this.visualElement.getProps();this.visualElement.current.style.transform=d?d({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Gh(m=>{if(!jT(m,t,null))return;const a=this.getAxisMotionValue(m),{min:w,max:S}=this.constraints[m];a.set(is(w,S,c[m]))})}addListeners(){if(!this.visualElement.current)return;p_e.set(this.visualElement,this);const t=this.visualElement.current,n=Ew(t,"pointerdown",w=>{const{drag:S,dragListener:M=!0}=this.getProps();S&&M&&this.start(w)}),i=()=>{const{dragConstraints:w}=this.getProps();xx(w)&&w.current&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,d=c.addEventListener("measure",i);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),Ho.read(i);const m=qw(window,"resize",()=>this.scalePositionWithinConstraints()),a=c.addEventListener("didUpdate",(({delta:w,hasLayoutChanged:S})=>{this.isDragging&&S&&(Gh(M=>{const P=this.getAxisMotionValue(M);P&&(this.originPoint[M]+=w[M].translate,P.set(P.get()+w[M].translate))}),this.visualElement.render())}));return()=>{m(),n(),d(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:c=!1,dragConstraints:d=!1,dragElastic:m=gk,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:i,dragPropagation:c,dragConstraints:d,dragElastic:m,dragMomentum:a}}}function jT(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function g_e(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class y_e extends yy{constructor(t){super(t),this.removeGroupControls=Kh,this.removeListeners=Kh,this.controls=new m_e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Kh}unmount(){this.removeGroupControls(),this.removeListeners()}}const b4=e=>(t,n)=>{e&&Ho.postRender(()=>e(t,n))};class __e extends yy{constructor(){super(...arguments),this.removePointerDownListener=Kh}onPointerDown(t){this.session=new aZ(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iZ(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:i,onPanEnd:c}=this.node.getProps();return{onSessionStart:b4(t),onStart:b4(n),onMove:i,onEnd:(d,m)=>{delete this.session,c&&Ho.postRender(()=>c(d,m))}}}mount(){this.removePointerDownListener=Ew(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const hE={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function w4(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Jb={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ti.test(e))e=parseFloat(e);else return e;const n=w4(e,t.target.x),i=w4(e,t.target.y);return`${n}% ${i}%`}},v_e={correct:(e,{treeScale:t,projectionDelta:n})=>{const i=e,c=fy.parse(e);if(c.length>5)return i;const d=fy.createTransformer(e),m=typeof c[0]!="number"?1:0,a=n.x.scale*t.x,w=n.y.scale*t.y;c[0+m]/=a,c[1+m]/=w;const S=is(a,w,.5);return typeof c[2+m]=="number"&&(c[2+m]/=S),typeof c[3+m]=="number"&&(c[3+m]/=S),d(c)}};let sP=!1;class x_e extends K.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i,layoutId:c}=this.props,{projection:d}=t;Uge(b_e),d&&(n.group&&n.group.add(d),i&&i.register&&c&&i.register(d),sP&&d.root.didUpdate(),d.addEventListener("animationComplete",()=>{this.safeToRemove()}),d.setOptions({...d.options,onExitComplete:()=>this.safeToRemove()})),hE.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:i,drag:c,isPresent:d}=this.props,{projection:m}=i;return m&&(m.isPresent=d,sP=!0,c||t.layoutDependency!==n||n===void 0||t.isPresent!==d?m.willUpdate():this.safeToRemove(),t.isPresent!==d&&(d?m.promote():m.relegate()||Ho.postRender(()=>{const a=m.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),KN.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:c}=t;sP=!0,c&&(c.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(c),i&&i.deregister&&i.deregister(c))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function sZ(e){const[t,n]=Lge(),i=K.useContext(B9);return D.jsx(x_e,{...e,layoutGroup:i,switchLayoutGroup:K.useContext(VX),isPresent:t,safeToRemove:n})}const b_e={borderRadius:{...Jb,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Jb,borderTopRightRadius:Jb,borderBottomLeftRadius:Jb,borderBottomRightRadius:Jb,boxShadow:v_e};function w_e(e,t,n){const i=dc(e)?e:$x(e);return i.start(sz("",i,t,n)),i.animation}const S_e=(e,t)=>e.depth-t.depth;class T_e{constructor(){this.children=[],this.isDirty=!1}add(t){IN(this.children,t),this.isDirty=!0}remove(t){DN(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(S_e),this.isDirty=!1,this.children.forEach(t)}}function E_e(e,t){const n=su.now(),i=({timestamp:c})=>{const d=c-n;d>=t&&(dy(i),e(d-t))};return Ho.setup(i,!0),()=>dy(i)}const lZ=["TopLeft","TopRight","BottomLeft","BottomRight"],A_e=lZ.length,S4=e=>typeof e=="string"?parseFloat(e):e,T4=e=>typeof e=="number"||Ti.test(e);function C_e(e,t,n,i,c,d){c?(e.opacity=is(0,n.opacity??1,M_e(i)),e.opacityExit=is(t.opacity??1,0,P_e(i))):d&&(e.opacity=is(t.opacity??1,n.opacity??1,i));for(let m=0;m<A_e;m++){const a=`border${lZ[m]}Radius`;let w=E4(t,a),S=E4(n,a);if(w===void 0&&S===void 0)continue;w||(w=0),S||(S=0),w===0||S===0||T4(w)===T4(S)?(e[a]=Math.max(is(S4(w),S4(S),i),0),(hp.test(S)||hp.test(w))&&(e[a]+="%")):e[a]=S}(t.rotate||n.rotate)&&(e.rotate=is(t.rotate||0,n.rotate||0,i))}function E4(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const M_e=cZ(0,.5,Y9),P_e=cZ(.5,.95,Kh);function cZ(e,t,n){return i=>i<e?0:i>t?1:n(Bw(e,t,i))}function A4(e,t){e.min=t.min,e.max=t.max}function Uh(e,t){A4(e.x,t.x),A4(e.y,t.y)}function C4(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function M4(e,t,n,i,c){return e-=t,e=DE(e,1/n,i),c!==void 0&&(e=DE(e,1/c,i)),e}function O_e(e,t=0,n=1,i=.5,c,d=e,m=e){if(hp.test(t)&&(t=parseFloat(t),t=is(m.min,m.max,t/100)-m.min),typeof t!="number")return;let a=is(d.min,d.max,i);e===d&&(a-=t),e.min=M4(e.min,t,n,a,c),e.max=M4(e.max,t,n,a,c)}function P4(e,t,[n,i,c],d,m){O_e(e,t[n],t[i],t[c],t.scale,d,m)}const R_e=["x","scaleX","originX"],I_e=["y","scaleY","originY"];function O4(e,t,n,i){P4(e.x,t,R_e,n?n.x:void 0,i?i.x:void 0),P4(e.y,t,I_e,n?n.y:void 0,i?i.y:void 0)}function R4(e){return e.translate===0&&e.scale===1}function uZ(e){return R4(e.x)&&R4(e.y)}function I4(e,t){return e.min===t.min&&e.max===t.max}function D_e(e,t){return I4(e.x,t.x)&&I4(e.y,t.y)}function D4(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function hZ(e,t){return D4(e.x,t.x)&&D4(e.y,t.y)}function k4(e){return Ic(e.x)/Ic(e.y)}function L4(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class k_e{constructor(){this.members=[]}add(t){IN(this.members,t),t.scheduleRender()}remove(t){if(DN(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(c=>t===c);if(n===0)return!1;let i;for(let c=n;c>=0;c--){const d=this.members[c];if(d.isPresent!==!1){i=d;break}}return i?(this.promote(i),!0):!1}promote(t,n){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,n&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:c}=t.options;c===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:i}=t;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function L_e(e,t,n){let i="";const c=e.x.translate/t.x,d=e.y.translate/t.y,m=n?.z||0;if((c||d||m)&&(i=`translate3d(${c}px, ${d}px, ${m}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:S,rotate:M,rotateX:P,rotateY:N,skewX:$,skewY:G}=n;S&&(i=`perspective(${S}px) ${i}`),M&&(i+=`rotate(${M}deg) `),P&&(i+=`rotateX(${P}deg) `),N&&(i+=`rotateY(${N}deg) `),$&&(i+=`skewX(${$}deg) `),G&&(i+=`skewY(${G}deg) `)}const a=e.x.scale*t.x,w=e.y.scale*t.y;return(a!==1||w!==1)&&(i+=`scale(${a}, ${w})`),i||"none"}const lP=["","X","Y","Z"],N_e=1e3;let z_e=0;function cP(e,t,n,i){const{latestValues:c}=t;c[e]&&(n[e]=c[e],t.setStaticValue(e,0),i&&(i[e]=0))}function dZ(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=KX(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:c,layoutId:d}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Ho,!(c||d))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&dZ(i)}function fZ({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:i,resetTransform:c}){return class{constructor(m={},a=t?.()){this.id=z_e++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(F_e),this.nodes.forEach(q_e),this.nodes.forEach(H_e),this.nodes.forEach(V_e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=m,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let w=0;w<this.path.length;w++)this.path[w].shouldResetTransform=!0;this.root===this&&(this.nodes=new T_e)}addEventListener(m,a){return this.eventHandlers.has(m)||this.eventHandlers.set(m,new NN),this.eventHandlers.get(m).add(a)}notifyListeners(m,...a){const w=this.eventHandlers.get(m);w&&w.notify(...a)}hasListeners(m){return this.eventHandlers.has(m)}mount(m){if(this.instance)return;this.isSVG=MX(m)&&!Ige(m),this.instance=m;const{layoutId:a,layout:w,visualElement:S}=this.options;if(S&&!S.current&&S.mount(m),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(w||a)&&(this.isLayoutDirty=!0),e){let M,P=0;const N=()=>this.root.updateBlockedByResize=!1;Ho.read(()=>{P=window.innerWidth}),e(m,()=>{const $=window.innerWidth;$!==P&&(P=$,this.root.updateBlockedByResize=!0,M&&M(),M=E_e(N,250),hE.hasAnimatedSinceResize&&(hE.hasAnimatedSinceResize=!1,this.nodes.forEach(j4)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&S&&(a||w)&&this.addEventListener("didUpdate",({delta:M,hasLayoutChanged:P,hasRelativeLayoutChanged:N,layout:$})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const G=this.options.transition||S.getDefaultTransition()||Y_e,{onLayoutAnimationStart:q,onLayoutAnimationComplete:V}=S.getProps(),J=!this.targetLayout||!hZ(this.targetLayout,$),ee=!P&&N;if(this.options.layoutRoot||this.resumeFrom||ee||P&&(J||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const re={...ZN(G,"layout"),onPlay:q,onComplete:V};(S.shouldReduceMotion||this.options.layoutRoot)&&(re.delay=0,re.type=!1),this.startAnimation(re),this.setAnimationOrigin(M,ee)}else P||j4(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=$})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const m=this.getStack();m&&m.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),dy(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(G_e),this.animationId++)}getTransformTemplate(){const{visualElement:m}=this.options;return m&&m.getProps().transformTemplate}willUpdate(m=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&dZ(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let M=0;M<this.path.length;M++){const P=this.path[M];P.shouldResetTransform=!0,P.updateScroll("snapshot"),P.options.layoutRoot&&P.willUpdate(!1)}const{layoutId:a,layout:w}=this.options;if(a===void 0&&!w)return;const S=this.getTransformTemplate();this.prevTransformTemplateValue=S?S(this.latestValues,""):void 0,this.updateSnapshot(),m&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(N4);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(z4);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach($_e),this.nodes.forEach(j_e),this.nodes.forEach(B_e)):this.nodes.forEach(z4),this.clearAllSnapshots();const a=su.now();Nl.delta=Fm(0,1e3/60,a-Nl.timestamp),Nl.timestamp=a,Nl.isProcessing=!0,KM.update.process(Nl),KM.preRender.process(Nl),KM.render.process(Nl),Nl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,KN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(U_e),this.sharedNodes.forEach(W_e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ho.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ho.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ic(this.snapshot.measuredBox.x)&&!Ic(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let w=0;w<this.path.length;w++)this.path[w].updateScroll();const m=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Es(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,m?m.layoutBox:void 0)}updateScroll(m="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===m&&(a=!1),a&&this.instance){const w=i(this.instance);this.scroll={animationId:this.root.animationId,phase:m,isRoot:w,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:w}}}resetTransform(){if(!c)return;const m=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!uZ(this.projectionDelta),w=this.getTransformTemplate(),S=w?w(this.latestValues,""):void 0,M=S!==this.prevTransformTemplateValue;m&&this.instance&&(a||O_(this.latestValues)||M)&&(c(this.instance,S),this.shouldResetTransform=!1,this.scheduleRender())}measure(m=!0){const a=this.measurePageBox();let w=this.removeElementScroll(a);return m&&(w=this.removeTransform(w)),K_e(w),{animationId:this.root.animationId,measuredBox:a,layoutBox:w,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:m}=this.options;if(!m)return Es();const a=m.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(J_e))){const{scroll:S}=this.root;S&&(bx(a.x,S.offset.x),bx(a.y,S.offset.y))}return a}removeElementScroll(m){const a=Es();if(Uh(a,m),this.scroll?.wasRoot)return a;for(let w=0;w<this.path.length;w++){const S=this.path[w],{scroll:M,options:P}=S;S!==this.root&&M&&P.layoutScroll&&(M.wasRoot&&Uh(a,m),bx(a.x,M.offset.x),bx(a.y,M.offset.y))}return a}applyTransform(m,a=!1){const w=Es();Uh(w,m);for(let S=0;S<this.path.length;S++){const M=this.path[S];!a&&M.options.layoutScroll&&M.scroll&&M!==M.root&&wx(w,{x:-M.scroll.offset.x,y:-M.scroll.offset.y}),O_(M.latestValues)&&wx(w,M.latestValues)}return O_(this.latestValues)&&wx(w,this.latestValues),w}removeTransform(m){const a=Es();Uh(a,m);for(let w=0;w<this.path.length;w++){const S=this.path[w];if(!S.instance||!O_(S.latestValues))continue;uk(S.latestValues)&&S.updateSnapshot();const M=Es(),P=S.measurePageBox();Uh(M,P),O4(a,S.latestValues,S.snapshot?S.snapshot.layoutBox:void 0,M)}return O_(this.latestValues)&&O4(a,this.latestValues),a}setTargetDelta(m){this.targetDelta=m,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(m){this.options={...this.options,...m,crossfade:m.crossfade!==void 0?m.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Nl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(m=!1){const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==a;if(!(m||w&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:M,layoutId:P}=this.options;if(!(!this.layout||!(M||P))){if(this.resolvedRelativeTargetAt=Nl.timestamp,!this.targetDelta&&!this.relativeTarget){const N=this.getClosestProjectingParent();N&&N.layout&&this.animationProgress!==1?(this.relativeParent=N,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Es(),this.relativeTargetOrigin=Es(),Cw(this.relativeTargetOrigin,this.layout.layoutBox,N.layout.layoutBox),Uh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Es(),this.targetWithTransforms=Es()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),i_e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Uh(this.target,this.layout.layoutBox),HX(this.target,this.targetDelta)):Uh(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const N=this.getClosestProjectingParent();N&&!!N.resumingFrom==!!this.resumingFrom&&!N.options.layoutScroll&&N.target&&this.animationProgress!==1?(this.relativeParent=N,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Es(),this.relativeTargetOrigin=Es(),Cw(this.relativeTargetOrigin,this.target,N.target),Uh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||uk(this.parent.latestValues)||qX(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const m=this.getLead(),a=!!this.resumingFrom||this!==m;let w=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(w=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===Nl.timestamp&&(w=!1),w)return;const{layout:S,layoutId:M}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(S||M))return;Uh(this.layoutCorrected,this.layout.layoutBox);const P=this.treeScale.x,N=this.treeScale.y;gye(this.layoutCorrected,this.treeScale,this.path,a),m.layout&&!m.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(m.target=m.layout.layoutBox,m.targetWithTransforms=Es());const{target:$}=m;if(!$){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(C4(this.prevProjectionDelta.x,this.projectionDelta.x),C4(this.prevProjectionDelta.y,this.projectionDelta.y)),Aw(this.projectionDelta,this.layoutCorrected,$,this.latestValues),(this.treeScale.x!==P||this.treeScale.y!==N||!L4(this.projectionDelta.x,this.prevProjectionDelta.x)||!L4(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",$))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(m=!0){if(this.options.visualElement?.scheduleRender(),m){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Sx(),this.projectionDelta=Sx(),this.projectionDeltaWithTransform=Sx()}setAnimationOrigin(m,a=!1){const w=this.snapshot,S=w?w.latestValues:{},M={...this.latestValues},P=Sx();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const N=Es(),$=w?w.source:void 0,G=this.layout?this.layout.source:void 0,q=$!==G,V=this.getStack(),J=!V||V.members.length<=1,ee=!!(q&&!J&&this.options.crossfade===!0&&!this.path.some(Z_e));this.animationProgress=0;let re;this.mixTargetDelta=fe=>{const ne=fe/1e3;B4(P.x,m.x,ne),B4(P.y,m.y,ne),this.setTargetDelta(P),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cw(N,this.layout.layoutBox,this.relativeParent.layout.layoutBox),X_e(this.relativeTarget,this.relativeTargetOrigin,N,ne),re&&D_e(this.relativeTarget,re)&&(this.isProjectionDirty=!1),re||(re=Es()),Uh(re,this.relativeTarget)),q&&(this.animationValues=M,C_e(M,S,this.latestValues,ne,ee,J)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ne},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(m){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(dy(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ho.update(()=>{hE.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=$x(0)),this.currentAnimation=w_e(this.motionValue,[0,1e3],{...m,velocity:0,isSync:!0,onUpdate:a=>{this.mixTargetDelta(a),m.onUpdate&&m.onUpdate(a)},onStop:()=>{},onComplete:()=>{m.onComplete&&m.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const m=this.getStack();m&&m.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(N_e),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const m=this.getLead();let{targetWithTransforms:a,target:w,layout:S,latestValues:M}=m;if(!(!a||!w||!S)){if(this!==m&&this.layout&&S&&pZ(this.options.animationType,this.layout.layoutBox,S.layoutBox)){w=this.target||Es();const P=Ic(this.layout.layoutBox.x);w.x.min=m.target.x.min,w.x.max=w.x.min+P;const N=Ic(this.layout.layoutBox.y);w.y.min=m.target.y.min,w.y.max=w.y.min+N}Uh(a,w),wx(a,M),Aw(this.projectionDeltaWithTransform,this.layoutCorrected,a,M)}}registerSharedNode(m,a){this.sharedNodes.has(m)||this.sharedNodes.set(m,new k_e),this.sharedNodes.get(m).add(a);const S=a.options.initialPromotionConfig;a.promote({transition:S?S.transition:void 0,preserveFollowOpacity:S&&S.shouldPreserveFollowOpacity?S.shouldPreserveFollowOpacity(a):void 0})}isLead(){const m=this.getStack();return m?m.lead===this:!0}getLead(){const{layoutId:m}=this.options;return m?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:m}=this.options;return m?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:m}=this.options;if(m)return this.root.sharedNodes.get(m)}promote({needsReset:m,transition:a,preserveFollowOpacity:w}={}){const S=this.getStack();S&&S.promote(this,w),m&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const m=this.getStack();return m?m.relegate(this):!1}resetSkewAndRotation(){const{visualElement:m}=this.options;if(!m)return;let a=!1;const{latestValues:w}=m;if((w.z||w.rotate||w.rotateX||w.rotateY||w.rotateZ||w.skewX||w.skewY)&&(a=!0),!a)return;const S={};w.z&&cP("z",m,S,this.animationValues);for(let M=0;M<lP.length;M++)cP(`rotate${lP[M]}`,m,S,this.animationValues),cP(`skew${lP[M]}`,m,S,this.animationValues);m.render();for(const M in S)m.setStaticValue(M,S[M]),this.animationValues&&(this.animationValues[M]=S[M]);m.scheduleRender()}applyProjectionStyles(m,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){m.visibility="hidden";return}const w=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,m.visibility="",m.opacity="",m.pointerEvents=uE(a?.pointerEvents)||"",m.transform=w?w(this.latestValues,""):"none";return}const S=this.getLead();if(!this.projectionDelta||!this.layout||!S.target){this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=uE(a?.pointerEvents)||""),this.hasProjected&&!O_(this.latestValues)&&(m.transform=w?w({},""):"none",this.hasProjected=!1);return}m.visibility="";const M=S.animationValues||S.latestValues;this.applyTransformsToTarget();let P=L_e(this.projectionDeltaWithTransform,this.treeScale,M);w&&(P=w(M,P)),m.transform=P;const{x:N,y:$}=this.projectionDelta;m.transformOrigin=`${N.origin*100}% ${$.origin*100}% 0`,S.animationValues?m.opacity=S===this?M.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:m.opacity=S===this?M.opacity!==void 0?M.opacity:"":M.opacityExit!==void 0?M.opacityExit:0;for(const G in $w){if(M[G]===void 0)continue;const{correct:q,applyTo:V,isCSSVariable:J}=$w[G],ee=P==="none"?M[G]:q(M[G],S);if(V){const re=V.length;for(let fe=0;fe<re;fe++)m[V[fe]]=ee}else J?this.options.visualElement.renderState.vars[G]=ee:m[G]=ee}this.options.layoutId&&(m.pointerEvents=S===this?uE(a?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(m=>m.currentAnimation?.stop()),this.root.nodes.forEach(N4),this.root.sharedNodes.clear()}}}function j_e(e){e.updateLayout()}function B_e(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:c}=e.options,d=t.source!==e.layout.source;c==="size"?Gh(M=>{const P=d?t.measuredBox[M]:t.layoutBox[M],N=Ic(P);P.min=n[M].min,P.max=P.min+N}):pZ(c,t.layoutBox,n)&&Gh(M=>{const P=d?t.measuredBox[M]:t.layoutBox[M],N=Ic(n[M]);P.max=P.min+N,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[M].max=e.relativeTarget[M].min+N)});const m=Sx();Aw(m,n,t.layoutBox);const a=Sx();d?Aw(a,e.applyTransform(i,!0),t.measuredBox):Aw(a,n,t.layoutBox);const w=!uZ(m);let S=!1;if(!e.resumeFrom){const M=e.getClosestProjectingParent();if(M&&!M.resumeFrom){const{snapshot:P,layout:N}=M;if(P&&N){const $=Es();Cw($,t.layoutBox,P.layoutBox);const G=Es();Cw(G,n,N.layoutBox),hZ($,G)||(S=!0),M.options.layoutRoot&&(e.relativeTarget=G,e.relativeTargetOrigin=$,e.relativeParent=M)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:a,layoutDelta:m,hasLayoutChanged:w,hasRelativeLayoutChanged:S})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function F_e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function V_e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function U_e(e){e.clearSnapshot()}function N4(e){e.clearMeasurements()}function z4(e){e.isLayoutDirty=!1}function $_e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function j4(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function q_e(e){e.resolveTargetDelta()}function H_e(e){e.calcProjection()}function G_e(e){e.resetSkewAndRotation()}function W_e(e){e.removeLeadSnapshot()}function B4(e,t,n){e.translate=is(t.translate,0,n),e.scale=is(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function F4(e,t,n,i){e.min=is(t.min,n.min,i),e.max=is(t.max,n.max,i)}function X_e(e,t,n,i){F4(e.x,t.x,n.x,i),F4(e.y,t.y,n.y,i)}function Z_e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Y_e={duration:.45,ease:[.4,0,.1,1]},V4=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),U4=V4("applewebkit/")&&!V4("chrome/")?Math.round:Kh;function $4(e){e.min=U4(e.min),e.max=U4(e.max)}function K_e(e){$4(e.x),$4(e.y)}function pZ(e,t,n){return e==="position"||e==="preserve-aspect"&&!r_e(k4(t),k4(n),.2)}function J_e(e){return e!==e.root&&e.scroll?.wasRoot}const Q_e=fZ({attachResizeListener:(e,t)=>qw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),uP={current:void 0},mZ=fZ({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!uP.current){const e=new Q_e({});e.mount(window),e.setOptions({layoutScroll:!0}),uP.current=e}return uP.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),eve={pan:{Feature:__e},drag:{Feature:y_e,ProjectionNode:mZ,MeasureLayout:sZ}};function q4(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const c="onHover"+n,d=i[c];d&&Ho.postRender(()=>d(t,eS(t)))}class tve extends yy{mount(){const{current:t}=this.node;t&&(this.unmount=Cge(t,(n,i)=>(q4(this.node,i,"Start"),c=>q4(this.node,c,"End"))))}unmount(){}}class nve extends yy{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=K1(qw(this.node.current,"focus",()=>this.onFocus()),qw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function H4(e,t,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const c="onTap"+(n==="End"?"":n),d=i[c];d&&Ho.postRender(()=>d(t,eS(t)))}class rve extends yy{mount(){const{current:t}=this.node;t&&(this.unmount=Rge(t,(n,i)=>(H4(this.node,i,"Start"),(c,{success:d})=>H4(this.node,c,d?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const yk=new WeakMap,hP=new WeakMap,ive=e=>{const t=yk.get(e.target);t&&t(e)},ave=e=>{e.forEach(ive)};function ove({root:e,...t}){const n=e||document;hP.has(n)||hP.set(n,{});const i=hP.get(n),c=JSON.stringify(t);return i[c]||(i[c]=new IntersectionObserver(ave,{root:e,...t})),i[c]}function sve(e,t,n){const i=ove(t);return yk.set(e,n),i.observe(e),()=>{yk.delete(e),i.unobserve(e)}}const lve={some:0,all:1};class cve extends yy{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:i,amount:c="some",once:d}=t,m={root:n?n.current:void 0,rootMargin:i,threshold:typeof c=="number"?c:lve[c]},a=w=>{const{isIntersecting:S}=w;if(this.isInView===S||(this.isInView=S,d&&!S&&this.hasEnteredView))return;S&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",S);const{onViewportEnter:M,onViewportLeave:P}=this.node.getProps(),N=S?M:P;N&&N(w)};return sve(this.node.current,m,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(uve(t,n))&&this.startObserver()}unmount(){}}function uve({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const hve={inView:{Feature:cve},tap:{Feature:rve},focus:{Feature:nve},hover:{Feature:tve}},dve={layout:{ProjectionNode:mZ,MeasureLayout:sZ}},fve={...Kye,...hve,...eve,...dve},oh=fye(fve,Aye);var pve="Label",gZ=K.forwardRef((e,t)=>D.jsx(ii.label,{...e,ref:t,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(e.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));gZ.displayName=pve;var mve=gZ;function Ar({className:e,...t}){return D.jsx(mve,{"data-slot":"label",className:bn("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function gve(){const e=I1();return D.jsxs(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[D.jsx(Ar,{style:{marginBottom:"1rem"},children:"Looks like you've wandered too far"}),D.jsx(na,{style:{marginBottom:"0.5rem"},onClick:()=>e(-1),children:"Go Back to previous location"}),D.jsx(na,{variant:"secondary",onClick:()=>e("/"),children:"Go Home"})]})}function Uo({className:e,...t}){return D.jsx("div",{"data-slot":"card",className:bn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function $o({className:e,...t}){return D.jsx("div",{"data-slot":"card-header",className:bn("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function il({className:e,...t}){return D.jsx("div",{"data-slot":"card-title",className:bn("leading-none font-semibold",e),...t})}function hc({className:e,...t}){return D.jsx("div",{"data-slot":"card-description",className:bn("text-muted-foreground text-sm",e),...t})}function qo({className:e,...t}){return D.jsx("div",{"data-slot":"card-content",className:bn("px-6",e),...t})}var dP,G4;function du(){if(G4)return dP;G4=1;var e=Array.isArray;return dP=e,dP}var fP,W4;function yZ(){if(W4)return fP;W4=1;var e=typeof TT=="object"&&TT&&TT.Object===Object&&TT;return fP=e,fP}var pP,X4;function bp(){if(X4)return pP;X4=1;var e=yZ(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return pP=n,pP}var mP,Z4;function tS(){if(Z4)return mP;Z4=1;var e=bp(),t=e.Symbol;return mP=t,mP}var gP,Y4;function yve(){if(Y4)return gP;Y4=1;var e=tS(),t=Object.prototype,n=t.hasOwnProperty,i=t.toString,c=e?e.toStringTag:void 0;function d(m){var a=n.call(m,c),w=m[c];try{m[c]=void 0;var S=!0}catch{}var M=i.call(m);return S&&(a?m[c]=w:delete m[c]),M}return gP=d,gP}var yP,K4;function _ve(){if(K4)return yP;K4=1;var e=Object.prototype,t=e.toString;function n(i){return t.call(i)}return yP=n,yP}var _P,J4;function Gm(){if(J4)return _P;J4=1;var e=tS(),t=yve(),n=_ve(),i="[object Null]",c="[object Undefined]",d=e?e.toStringTag:void 0;function m(a){return a==null?a===void 0?c:i:d&&d in Object(a)?t(a):n(a)}return _P=m,_P}var vP,Q4;function Wm(){if(Q4)return vP;Q4=1;function e(t){return t!=null&&typeof t=="object"}return vP=e,vP}var xP,eV;function P0(){if(eV)return xP;eV=1;var e=Gm(),t=Wm(),n="[object Symbol]";function i(c){return typeof c=="symbol"||t(c)&&e(c)==n}return xP=i,xP}var bP,tV;function lz(){if(tV)return bP;tV=1;var e=du(),t=P0(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function c(d,m){if(e(d))return!1;var a=typeof d;return a=="number"||a=="symbol"||a=="boolean"||d==null||t(d)?!0:i.test(d)||!n.test(d)||m!=null&&d in Object(m)}return bP=c,bP}var wP,nV;function _y(){if(nV)return wP;nV=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return wP=e,wP}var SP,rV;function cz(){if(rV)return SP;rV=1;var e=Gm(),t=_y(),n="[object AsyncFunction]",i="[object Function]",c="[object GeneratorFunction]",d="[object Proxy]";function m(a){if(!t(a))return!1;var w=e(a);return w==i||w==c||w==n||w==d}return SP=m,SP}var TP,iV;function vve(){if(iV)return TP;iV=1;var e=bp(),t=e["__core-js_shared__"];return TP=t,TP}var EP,aV;function xve(){if(aV)return EP;aV=1;var e=vve(),t=(function(){var i=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""})();function n(i){return!!t&&t in i}return EP=n,EP}var AP,oV;function _Z(){if(oV)return AP;oV=1;var e=Function.prototype,t=e.toString;function n(i){if(i!=null){try{return t.call(i)}catch{}try{return i+""}catch{}}return""}return AP=n,AP}var CP,sV;function bve(){if(sV)return CP;sV=1;var e=cz(),t=xve(),n=_y(),i=_Z(),c=/[\\^$.*+?()[\]{}|]/g,d=/^\[object .+?Constructor\]$/,m=Function.prototype,a=Object.prototype,w=m.toString,S=a.hasOwnProperty,M=RegExp("^"+w.call(S).replace(c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P(N){if(!n(N)||t(N))return!1;var $=e(N)?M:d;return $.test(i(N))}return CP=P,CP}var MP,lV;function wve(){if(lV)return MP;lV=1;function e(t,n){return t?.[n]}return MP=e,MP}var PP,cV;function cv(){if(cV)return PP;cV=1;var e=bve(),t=wve();function n(i,c){var d=t(i,c);return e(d)?d:void 0}return PP=n,PP}var OP,uV;function M2(){if(uV)return OP;uV=1;var e=cv(),t=e(Object,"create");return OP=t,OP}var RP,hV;function Sve(){if(hV)return RP;hV=1;var e=M2();function t(){this.__data__=e?e(null):{},this.size=0}return RP=t,RP}var IP,dV;function Tve(){if(dV)return IP;dV=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return IP=e,IP}var DP,fV;function Eve(){if(fV)return DP;fV=1;var e=M2(),t="__lodash_hash_undefined__",n=Object.prototype,i=n.hasOwnProperty;function c(d){var m=this.__data__;if(e){var a=m[d];return a===t?void 0:a}return i.call(m,d)?m[d]:void 0}return DP=c,DP}var kP,pV;function Ave(){if(pV)return kP;pV=1;var e=M2(),t=Object.prototype,n=t.hasOwnProperty;function i(c){var d=this.__data__;return e?d[c]!==void 0:n.call(d,c)}return kP=i,kP}var LP,mV;function Cve(){if(mV)return LP;mV=1;var e=M2(),t="__lodash_hash_undefined__";function n(i,c){var d=this.__data__;return this.size+=this.has(i)?0:1,d[i]=e&&c===void 0?t:c,this}return LP=n,LP}var NP,gV;function Mve(){if(gV)return NP;gV=1;var e=Sve(),t=Tve(),n=Eve(),i=Ave(),c=Cve();function d(m){var a=-1,w=m==null?0:m.length;for(this.clear();++a<w;){var S=m[a];this.set(S[0],S[1])}}return d.prototype.clear=e,d.prototype.delete=t,d.prototype.get=n,d.prototype.has=i,d.prototype.set=c,NP=d,NP}var zP,yV;function Pve(){if(yV)return zP;yV=1;function e(){this.__data__=[],this.size=0}return zP=e,zP}var jP,_V;function uz(){if(_V)return jP;_V=1;function e(t,n){return t===n||t!==t&&n!==n}return jP=e,jP}var BP,vV;function P2(){if(vV)return BP;vV=1;var e=uz();function t(n,i){for(var c=n.length;c--;)if(e(n[c][0],i))return c;return-1}return BP=t,BP}var FP,xV;function Ove(){if(xV)return FP;xV=1;var e=P2(),t=Array.prototype,n=t.splice;function i(c){var d=this.__data__,m=e(d,c);if(m<0)return!1;var a=d.length-1;return m==a?d.pop():n.call(d,m,1),--this.size,!0}return FP=i,FP}var VP,bV;function Rve(){if(bV)return VP;bV=1;var e=P2();function t(n){var i=this.__data__,c=e(i,n);return c<0?void 0:i[c][1]}return VP=t,VP}var UP,wV;function Ive(){if(wV)return UP;wV=1;var e=P2();function t(n){return e(this.__data__,n)>-1}return UP=t,UP}var $P,SV;function Dve(){if(SV)return $P;SV=1;var e=P2();function t(n,i){var c=this.__data__,d=e(c,n);return d<0?(++this.size,c.push([n,i])):c[d][1]=i,this}return $P=t,$P}var qP,TV;function O2(){if(TV)return qP;TV=1;var e=Pve(),t=Ove(),n=Rve(),i=Ive(),c=Dve();function d(m){var a=-1,w=m==null?0:m.length;for(this.clear();++a<w;){var S=m[a];this.set(S[0],S[1])}}return d.prototype.clear=e,d.prototype.delete=t,d.prototype.get=n,d.prototype.has=i,d.prototype.set=c,qP=d,qP}var HP,EV;function hz(){if(EV)return HP;EV=1;var e=cv(),t=bp(),n=e(t,"Map");return HP=n,HP}var GP,AV;function kve(){if(AV)return GP;AV=1;var e=Mve(),t=O2(),n=hz();function i(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return GP=i,GP}var WP,CV;function Lve(){if(CV)return WP;CV=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return WP=e,WP}var XP,MV;function R2(){if(MV)return XP;MV=1;var e=Lve();function t(n,i){var c=n.__data__;return e(i)?c[typeof i=="string"?"string":"hash"]:c.map}return XP=t,XP}var ZP,PV;function Nve(){if(PV)return ZP;PV=1;var e=R2();function t(n){var i=e(this,n).delete(n);return this.size-=i?1:0,i}return ZP=t,ZP}var YP,OV;function zve(){if(OV)return YP;OV=1;var e=R2();function t(n){return e(this,n).get(n)}return YP=t,YP}var KP,RV;function jve(){if(RV)return KP;RV=1;var e=R2();function t(n){return e(this,n).has(n)}return KP=t,KP}var JP,IV;function Bve(){if(IV)return JP;IV=1;var e=R2();function t(n,i){var c=e(this,n),d=c.size;return c.set(n,i),this.size+=c.size==d?0:1,this}return JP=t,JP}var QP,DV;function dz(){if(DV)return QP;DV=1;var e=kve(),t=Nve(),n=zve(),i=jve(),c=Bve();function d(m){var a=-1,w=m==null?0:m.length;for(this.clear();++a<w;){var S=m[a];this.set(S[0],S[1])}}return d.prototype.clear=e,d.prototype.delete=t,d.prototype.get=n,d.prototype.has=i,d.prototype.set=c,QP=d,QP}var eO,kV;function vZ(){if(kV)return eO;kV=1;var e=dz(),t="Expected a function";function n(i,c){if(typeof i!="function"||c!=null&&typeof c!="function")throw new TypeError(t);var d=function(){var m=arguments,a=c?c.apply(this,m):m[0],w=d.cache;if(w.has(a))return w.get(a);var S=i.apply(this,m);return d.cache=w.set(a,S)||w,S};return d.cache=new(n.Cache||e),d}return n.Cache=e,eO=n,eO}var tO,LV;function Fve(){if(LV)return tO;LV=1;var e=vZ(),t=500;function n(i){var c=e(i,function(m){return d.size===t&&d.clear(),m}),d=c.cache;return c}return tO=n,tO}var nO,NV;function Vve(){if(NV)return nO;NV=1;var e=Fve(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,i=e(function(c){var d=[];return c.charCodeAt(0)===46&&d.push(""),c.replace(t,function(m,a,w,S){d.push(w?S.replace(n,"$1"):a||m)}),d});return nO=i,nO}var rO,zV;function fz(){if(zV)return rO;zV=1;function e(t,n){for(var i=-1,c=t==null?0:t.length,d=Array(c);++i<c;)d[i]=n(t[i],i,t);return d}return rO=e,rO}var iO,jV;function Uve(){if(jV)return iO;jV=1;var e=tS(),t=fz(),n=du(),i=P0(),c=e?e.prototype:void 0,d=c?c.toString:void 0;function m(a){if(typeof a=="string")return a;if(n(a))return t(a,m)+"";if(i(a))return d?d.call(a):"";var w=a+"";return w=="0"&&1/a==-1/0?"-0":w}return iO=m,iO}var aO,BV;function xZ(){if(BV)return aO;BV=1;var e=Uve();function t(n){return n==null?"":e(n)}return aO=t,aO}var oO,FV;function bZ(){if(FV)return oO;FV=1;var e=du(),t=lz(),n=Vve(),i=xZ();function c(d,m){return e(d)?d:t(d,m)?[d]:n(i(d))}return oO=c,oO}var sO,VV;function I2(){if(VV)return sO;VV=1;var e=P0();function t(n){if(typeof n=="string"||e(n))return n;var i=n+"";return i=="0"&&1/n==-1/0?"-0":i}return sO=t,sO}var lO,UV;function pz(){if(UV)return lO;UV=1;var e=bZ(),t=I2();function n(i,c){c=e(c,i);for(var d=0,m=c.length;i!=null&&d<m;)i=i[t(c[d++])];return d&&d==m?i:void 0}return lO=n,lO}var cO,$V;function wZ(){if($V)return cO;$V=1;var e=pz();function t(n,i,c){var d=n==null?void 0:e(n,i);return d===void 0?c:d}return cO=t,cO}var $ve=wZ();const Jh=Wa($ve);var uO,qV;function qve(){if(qV)return uO;qV=1;function e(t){return t==null}return uO=e,uO}var Hve=qve();const ga=Wa(Hve);var hO,HV;function Gve(){if(HV)return hO;HV=1;var e=Gm(),t=du(),n=Wm(),i="[object String]";function c(d){return typeof d=="string"||!t(d)&&n(d)&&e(d)==i}return hO=c,hO}var Wve=Gve();const J_=Wa(Wve);var Xve=cz();const Hi=Wa(Xve);var Zve=_y();const O0=Wa(Zve);var dO={exports:{}},Ha={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GV;function Yve(){if(GV)return Ha;GV=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),m=Symbol.for("react.context"),a=Symbol.for("react.server_context"),w=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),$=Symbol.for("react.offscreen"),G;G=Symbol.for("react.module.reference");function q(V){if(typeof V=="object"&&V!==null){var J=V.$$typeof;switch(J){case e:switch(V=V.type,V){case n:case c:case i:case S:case M:return V;default:switch(V=V&&V.$$typeof,V){case a:case m:case w:case N:case P:case d:return V;default:return J}}case t:return J}}}return Ha.ContextConsumer=m,Ha.ContextProvider=d,Ha.Element=e,Ha.ForwardRef=w,Ha.Fragment=n,Ha.Lazy=N,Ha.Memo=P,Ha.Portal=t,Ha.Profiler=c,Ha.StrictMode=i,Ha.Suspense=S,Ha.SuspenseList=M,Ha.isAsyncMode=function(){return!1},Ha.isConcurrentMode=function(){return!1},Ha.isContextConsumer=function(V){return q(V)===m},Ha.isContextProvider=function(V){return q(V)===d},Ha.isElement=function(V){return typeof V=="object"&&V!==null&&V.$$typeof===e},Ha.isForwardRef=function(V){return q(V)===w},Ha.isFragment=function(V){return q(V)===n},Ha.isLazy=function(V){return q(V)===N},Ha.isMemo=function(V){return q(V)===P},Ha.isPortal=function(V){return q(V)===t},Ha.isProfiler=function(V){return q(V)===c},Ha.isStrictMode=function(V){return q(V)===i},Ha.isSuspense=function(V){return q(V)===S},Ha.isSuspenseList=function(V){return q(V)===M},Ha.isValidElementType=function(V){return typeof V=="string"||typeof V=="function"||V===n||V===c||V===i||V===S||V===M||V===$||typeof V=="object"&&V!==null&&(V.$$typeof===N||V.$$typeof===P||V.$$typeof===d||V.$$typeof===m||V.$$typeof===w||V.$$typeof===G||V.getModuleId!==void 0)},Ha.typeOf=q,Ha}var WV;function Kve(){return WV||(WV=1,dO.exports=Yve()),dO.exports}var Jve=Kve(),fO,XV;function SZ(){if(XV)return fO;XV=1;var e=Gm(),t=Wm(),n="[object Number]";function i(c){return typeof c=="number"||t(c)&&e(c)==n}return fO=i,fO}var pO,ZV;function Qve(){if(ZV)return pO;ZV=1;var e=SZ();function t(n){return e(n)&&n!=+n}return pO=t,pO}var exe=Qve();const R0=Wa(exe);var txe=SZ();const nxe=Wa(txe);var Wd=function(t){return t===0?0:t>0?1:-1},z_=function(t){return J_(t)&&t.indexOf("%")===t.length-1},rr=function(t){return nxe(t)&&!R0(t)},rxe=function(t){return ga(t)},al=function(t){return rr(t)||J_(t)},ixe=0,nS=function(t){var n=++ixe;return"".concat(t||"").concat(n)},Q_=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!rr(t)&&!J_(t))return i;var d;if(z_(t)){var m=t.indexOf("%");d=n*parseFloat(t.slice(0,m))/100}else d=+t;return R0(d)&&(d=i),c&&d>n&&(d=n),d},ny=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},axe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,i={},c=0;c<n;c++)if(!i[t[c]])i[t[c]]=!0;else return!0;return!1},Wh=function(t,n){return rr(t)&&rr(n)?function(i){return t+i*(n-t)}:function(){return n}};function kE(e,t,n){return!e||!e.length?null:e.find(function(i){return i&&(typeof t=="function"?t(i):Jh(i,t))===n})}var oxe=function(t,n){return rr(t)&&rr(n)?t-n:J_(t)&&J_(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function Dx(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function _k(e){"@babel/helpers - typeof";return _k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_k(e)}var sxe=["viewBox","children"],lxe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],YV=["points","pathLength"],mO={svg:sxe,polygon:YV,polyline:YV},mz=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],LE=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(K.isValidElement(t)&&(i=t.props),!O0(i))return null;var c={};return Object.keys(i).forEach(function(d){mz.includes(d)&&(c[d]=n||function(m){return i[d](i,m)})}),c},cxe=function(t,n,i){return function(c){return t(n,i,c),null}},NE=function(t,n,i){if(!O0(t)||_k(t)!=="object")return null;var c=null;return Object.keys(t).forEach(function(d){var m=t[d];mz.includes(d)&&typeof m=="function"&&(c||(c={}),c[d]=cxe(m,n,i))}),c},uxe=["children"],hxe=["children"];function KV(e,t){if(e==null)return{};var n=dxe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function dxe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function vk(e){"@babel/helpers - typeof";return vk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vk(e)}var JV={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Dm=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},QV=null,gO=null,gz=function e(t){if(t===QV&&Array.isArray(gO))return gO;var n=[];return K.Children.forEach(t,function(i){ga(i)||(Jve.isFragment(i)?n=n.concat(e(i.props.children)):n.push(i))}),gO=n,QV=t,n};function Zd(e,t){var n=[],i=[];return Array.isArray(t)?i=t.map(function(c){return Dm(c)}):i=[Dm(t)],gz(e).forEach(function(c){var d=Jh(c,"type.displayName")||Jh(c,"type.name");i.indexOf(d)!==-1&&n.push(c)}),n}function Ku(e,t){var n=Zd(e,t);return n&&n[0]}var eU=function(t){if(!t||!t.props)return!1;var n=t.props,i=n.width,c=n.height;return!(!rr(i)||i<=0||!rr(c)||c<=0)},fxe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],pxe=function(t){return t&&t.type&&J_(t.type)&&fxe.indexOf(t.type)>=0},mxe=function(t){return t&&vk(t)==="object"&&"clipDot"in t},gxe=function(t,n,i,c){var d,m=(d=mO?.[c])!==null&&d!==void 0?d:[];return n.startsWith("data-")||!Hi(t)&&(c&&m.includes(n)||lxe.includes(n))||i&&mz.includes(n)},ha=function(t,n,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var c=t;if(K.isValidElement(t)&&(c=t.props),!O0(c))return null;var d={};return Object.keys(c).forEach(function(m){var a;gxe((a=c)===null||a===void 0?void 0:a[m],m,n,i)&&(d[m]=c[m])}),d},xk=function e(t,n){if(t===n)return!0;var i=K.Children.count(t);if(i!==K.Children.count(n))return!1;if(i===0)return!0;if(i===1)return tU(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var c=0;c<i;c++){var d=t[c],m=n[c];if(Array.isArray(d)||Array.isArray(m)){if(!e(d,m))return!1}else if(!tU(d,m))return!1}return!0},tU=function(t,n){if(ga(t)&&ga(n))return!0;if(!ga(t)&&!ga(n)){var i=t.props||{},c=i.children,d=KV(i,uxe),m=n.props||{},a=m.children,w=KV(m,hxe);return c&&a?Dx(d,w)&&xk(c,a):!c&&!a?Dx(d,w):!1}return!1},nU=function(t,n){var i=[],c={};return gz(t).forEach(function(d,m){if(pxe(d))i.push(d);else if(d){var a=Dm(d.type),w=n[a]||{},S=w.handler,M=w.once;if(S&&(!M||!c[a])){var P=S(d,a,m);i.push(P),c[a]=!0}}}),i},yxe=function(t){var n=t&&t.type;return n&&JV[n]?JV[n]:null},_xe=function(t,n){return gz(n).indexOf(t)},vxe=["children","width","height","viewBox","className","style","title","desc"];function bk(){return bk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bk.apply(this,arguments)}function xxe(e,t){if(e==null)return{};var n=bxe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function bxe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function wk(e){var t=e.children,n=e.width,i=e.height,c=e.viewBox,d=e.className,m=e.style,a=e.title,w=e.desc,S=xxe(e,vxe),M=c||{width:n,height:i,x:0,y:0},P=xa("recharts-surface",d);return Ce.createElement("svg",bk({},ha(S,!0,"svg"),{className:P,width:n,height:i,style:m,viewBox:"".concat(M.x," ").concat(M.y," ").concat(M.width," ").concat(M.height)}),Ce.createElement("title",null,a),Ce.createElement("desc",null,w),t)}var wxe=["children","className"];function Sk(){return Sk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Sk.apply(this,arguments)}function Sxe(e,t){if(e==null)return{};var n=Txe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Txe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var as=Ce.forwardRef(function(e,t){var n=e.children,i=e.className,c=Sxe(e,wxe),d=xa("recharts-layer",i);return Ce.createElement("g",Sk({className:d},ha(c,!0),{ref:t}),n)}),km=function(t,n){for(var i=arguments.length,c=new Array(i>2?i-2:0),d=2;d<i;d++)c[d-2]=arguments[d]},yO,rU;function Exe(){if(rU)return yO;rU=1;function e(t,n,i){var c=-1,d=t.length;n<0&&(n=-n>d?0:d+n),i=i>d?d:i,i<0&&(i+=d),d=n>i?0:i-n>>>0,n>>>=0;for(var m=Array(d);++c<d;)m[c]=t[c+n];return m}return yO=e,yO}var _O,iU;function Axe(){if(iU)return _O;iU=1;var e=Exe();function t(n,i,c){var d=n.length;return c=c===void 0?d:c,!i&&c>=d?n:e(n,i,c)}return _O=t,_O}var vO,aU;function TZ(){if(aU)return vO;aU=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",i="\\u20d0-\\u20ff",c=t+n+i,d="\\ufe0e\\ufe0f",m="\\u200d",a=RegExp("["+m+e+c+d+"]");function w(S){return a.test(S)}return vO=w,vO}var xO,oU;function Cxe(){if(oU)return xO;oU=1;function e(t){return t.split("")}return xO=e,xO}var bO,sU;function Mxe(){if(sU)return bO;sU=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",i="\\u20d0-\\u20ff",c=t+n+i,d="\\ufe0e\\ufe0f",m="["+e+"]",a="["+c+"]",w="\\ud83c[\\udffb-\\udfff]",S="(?:"+a+"|"+w+")",M="[^"+e+"]",P="(?:\\ud83c[\\udde6-\\uddff]){2}",N="[\\ud800-\\udbff][\\udc00-\\udfff]",$="\\u200d",G=S+"?",q="["+d+"]?",V="(?:"+$+"(?:"+[M,P,N].join("|")+")"+q+G+")*",J=q+G+V,ee="(?:"+[M+a+"?",a,P,N,m].join("|")+")",re=RegExp(w+"(?="+w+")|"+ee+J,"g");function fe(ne){return ne.match(re)||[]}return bO=fe,bO}var wO,lU;function Pxe(){if(lU)return wO;lU=1;var e=Cxe(),t=TZ(),n=Mxe();function i(c){return t(c)?n(c):e(c)}return wO=i,wO}var SO,cU;function Oxe(){if(cU)return SO;cU=1;var e=Axe(),t=TZ(),n=Pxe(),i=xZ();function c(d){return function(m){m=i(m);var a=t(m)?n(m):void 0,w=a?a[0]:m.charAt(0),S=a?e(a,1).join(""):m.slice(1);return w[d]()+S}}return SO=c,SO}var TO,uU;function Rxe(){if(uU)return TO;uU=1;var e=Oxe(),t=e("toUpperCase");return TO=t,TO}var Ixe=Rxe();const D2=Wa(Ixe);function Oo(e){return function(){return e}}const EZ=Math.cos,zE=Math.sin,nf=Math.sqrt,jE=Math.PI,k2=2*jE,Tk=Math.PI,Ek=2*Tk,R_=1e-6,Dxe=Ek-R_;function AZ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function kxe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return AZ;const n=10**t;return function(i){this._+=i[0];for(let c=1,d=i.length;c<d;++c)this._+=Math.round(arguments[c]*n)/n+i[c]}}class Lxe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?AZ:kxe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,c){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+c}`}bezierCurveTo(t,n,i,c,d,m){this._append`C${+t},${+n},${+i},${+c},${this._x1=+d},${this._y1=+m}`}arcTo(t,n,i,c,d){if(t=+t,n=+n,i=+i,c=+c,d=+d,d<0)throw new Error(`negative radius: ${d}`);let m=this._x1,a=this._y1,w=i-t,S=c-n,M=m-t,P=a-n,N=M*M+P*P;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(N>R_)if(!(Math.abs(P*w-S*M)>R_)||!d)this._append`L${this._x1=t},${this._y1=n}`;else{let $=i-m,G=c-a,q=w*w+S*S,V=$*$+G*G,J=Math.sqrt(q),ee=Math.sqrt(N),re=d*Math.tan((Tk-Math.acos((q+N-V)/(2*J*ee)))/2),fe=re/ee,ne=re/J;Math.abs(fe-1)>R_&&this._append`L${t+fe*M},${n+fe*P}`,this._append`A${d},${d},0,0,${+(P*$>M*G)},${this._x1=t+ne*w},${this._y1=n+ne*S}`}}arc(t,n,i,c,d,m){if(t=+t,n=+n,i=+i,m=!!m,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(c),w=i*Math.sin(c),S=t+a,M=n+w,P=1^m,N=m?c-d:d-c;this._x1===null?this._append`M${S},${M}`:(Math.abs(this._x1-S)>R_||Math.abs(this._y1-M)>R_)&&this._append`L${S},${M}`,i&&(N<0&&(N=N%Ek+Ek),N>Dxe?this._append`A${i},${i},0,1,${P},${t-a},${n-w}A${i},${i},0,1,${P},${this._x1=S},${this._y1=M}`:N>R_&&this._append`A${i},${i},0,${+(N>=Tk)},${P},${this._x1=t+i*Math.cos(d)},${this._y1=n+i*Math.sin(d)}`)}rect(t,n,i,c){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+c}h${-i}Z`}toString(){return this._}}function yz(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new Lxe(t)}function _z(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CZ(e){this._context=e}CZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function L2(e){return new CZ(e)}function MZ(e){return e[0]}function PZ(e){return e[1]}function OZ(e,t){var n=Oo(!0),i=null,c=L2,d=null,m=yz(a);e=typeof e=="function"?e:e===void 0?MZ:Oo(e),t=typeof t=="function"?t:t===void 0?PZ:Oo(t);function a(w){var S,M=(w=_z(w)).length,P,N=!1,$;for(i==null&&(d=c($=m())),S=0;S<=M;++S)!(S<M&&n(P=w[S],S,w))===N&&((N=!N)?d.lineStart():d.lineEnd()),N&&d.point(+e(P,S,w),+t(P,S,w));if($)return d=null,$+""||null}return a.x=function(w){return arguments.length?(e=typeof w=="function"?w:Oo(+w),a):e},a.y=function(w){return arguments.length?(t=typeof w=="function"?w:Oo(+w),a):t},a.defined=function(w){return arguments.length?(n=typeof w=="function"?w:Oo(!!w),a):n},a.curve=function(w){return arguments.length?(c=w,i!=null&&(d=c(i)),a):c},a.context=function(w){return arguments.length?(w==null?i=d=null:d=c(i=w),a):i},a}function BT(e,t,n){var i=null,c=Oo(!0),d=null,m=L2,a=null,w=yz(S);e=typeof e=="function"?e:e===void 0?MZ:Oo(+e),t=typeof t=="function"?t:Oo(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?PZ:Oo(+n);function S(P){var N,$,G,q=(P=_z(P)).length,V,J=!1,ee,re=new Array(q),fe=new Array(q);for(d==null&&(a=m(ee=w())),N=0;N<=q;++N){if(!(N<q&&c(V=P[N],N,P))===J)if(J=!J)$=N,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),G=N-1;G>=$;--G)a.point(re[G],fe[G]);a.lineEnd(),a.areaEnd()}J&&(re[N]=+e(V,N,P),fe[N]=+t(V,N,P),a.point(i?+i(V,N,P):re[N],n?+n(V,N,P):fe[N]))}if(ee)return a=null,ee+""||null}function M(){return OZ().defined(c).curve(m).context(d)}return S.x=function(P){return arguments.length?(e=typeof P=="function"?P:Oo(+P),i=null,S):e},S.x0=function(P){return arguments.length?(e=typeof P=="function"?P:Oo(+P),S):e},S.x1=function(P){return arguments.length?(i=P==null?null:typeof P=="function"?P:Oo(+P),S):i},S.y=function(P){return arguments.length?(t=typeof P=="function"?P:Oo(+P),n=null,S):t},S.y0=function(P){return arguments.length?(t=typeof P=="function"?P:Oo(+P),S):t},S.y1=function(P){return arguments.length?(n=P==null?null:typeof P=="function"?P:Oo(+P),S):n},S.lineX0=S.lineY0=function(){return M().x(e).y(t)},S.lineY1=function(){return M().x(e).y(n)},S.lineX1=function(){return M().x(i).y(t)},S.defined=function(P){return arguments.length?(c=typeof P=="function"?P:Oo(!!P),S):c},S.curve=function(P){return arguments.length?(m=P,d!=null&&(a=m(d)),S):m},S.context=function(P){return arguments.length?(P==null?d=a=null:a=m(d=P),S):d},S}class RZ{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Nxe(e){return new RZ(e,!0)}function zxe(e){return new RZ(e,!1)}const vz={draw(e,t){const n=nf(t/jE);e.moveTo(n,0),e.arc(0,0,n,0,k2)}},jxe={draw(e,t){const n=nf(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},IZ=nf(1/3),Bxe=IZ*2,Fxe={draw(e,t){const n=nf(t/Bxe),i=n*IZ;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}},Vxe={draw(e,t){const n=nf(t),i=-n/2;e.rect(i,i,n,n)}},Uxe=.8908130915292852,DZ=zE(jE/10)/zE(7*jE/10),$xe=zE(k2/10)*DZ,qxe=-EZ(k2/10)*DZ,Hxe={draw(e,t){const n=nf(t*Uxe),i=$xe*n,c=qxe*n;e.moveTo(0,-n),e.lineTo(i,c);for(let d=1;d<5;++d){const m=k2*d/5,a=EZ(m),w=zE(m);e.lineTo(w*n,-a*n),e.lineTo(a*i-w*c,w*i+a*c)}e.closePath()}},EO=nf(3),Gxe={draw(e,t){const n=-nf(t/(EO*3));e.moveTo(0,n*2),e.lineTo(-EO*n,-n),e.lineTo(EO*n,-n),e.closePath()}},$h=-.5,qh=nf(3)/2,Ak=1/nf(12),Wxe=(Ak/2+1)*3,Xxe={draw(e,t){const n=nf(t/Wxe),i=n/2,c=n*Ak,d=i,m=n*Ak+n,a=-d,w=m;e.moveTo(i,c),e.lineTo(d,m),e.lineTo(a,w),e.lineTo($h*i-qh*c,qh*i+$h*c),e.lineTo($h*d-qh*m,qh*d+$h*m),e.lineTo($h*a-qh*w,qh*a+$h*w),e.lineTo($h*i+qh*c,$h*c-qh*i),e.lineTo($h*d+qh*m,$h*m-qh*d),e.lineTo($h*a+qh*w,$h*w-qh*a),e.closePath()}};function Zxe(e,t){let n=null,i=yz(c);e=typeof e=="function"?e:Oo(e||vz),t=typeof t=="function"?t:Oo(t===void 0?64:+t);function c(){let d;if(n||(n=d=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),d)return n=null,d+""||null}return c.type=function(d){return arguments.length?(e=typeof d=="function"?d:Oo(d),c):e},c.size=function(d){return arguments.length?(t=typeof d=="function"?d:Oo(+d),c):t},c.context=function(d){return arguments.length?(n=d??null,c):n},c}function BE(){}function FE(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function kZ(e){this._context=e}kZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:FE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:FE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Yxe(e){return new kZ(e)}function LZ(e){this._context=e}LZ.prototype={areaStart:BE,areaEnd:BE,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:FE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Kxe(e){return new LZ(e)}function NZ(e){this._context=e}NZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:FE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Jxe(e){return new NZ(e)}function zZ(e){this._context=e}zZ.prototype={areaStart:BE,areaEnd:BE,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Qxe(e){return new zZ(e)}function hU(e){return e<0?-1:1}function dU(e,t,n){var i=e._x1-e._x0,c=t-e._x1,d=(e._y1-e._y0)/(i||c<0&&-0),m=(n-e._y1)/(c||i<0&&-0),a=(d*c+m*i)/(i+c);return(hU(d)+hU(m))*Math.min(Math.abs(d),Math.abs(m),.5*Math.abs(a))||0}function fU(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function AO(e,t,n){var i=e._x0,c=e._y0,d=e._x1,m=e._y1,a=(d-i)/3;e._context.bezierCurveTo(i+a,c+a*t,d-a,m-a*n,d,m)}function VE(e){this._context=e}VE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AO(this,this._t0,fU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,AO(this,fU(this,n=dU(this,e,t)),n);break;default:AO(this,this._t0,n=dU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function jZ(e){this._context=new BZ(e)}(jZ.prototype=Object.create(VE.prototype)).point=function(e,t){VE.prototype.point.call(this,t,e)};function BZ(e){this._context=e}BZ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,c,d){this._context.bezierCurveTo(t,e,i,n,d,c)}};function e0e(e){return new VE(e)}function t0e(e){return new jZ(e)}function FZ(e){this._context=e}FZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=pU(e),c=pU(t),d=0,m=1;m<n;++d,++m)this._context.bezierCurveTo(i[0][d],c[0][d],i[1][d],c[1][d],e[m],t[m]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function pU(e){var t,n=e.length-1,i,c=new Array(n),d=new Array(n),m=new Array(n);for(c[0]=0,d[0]=2,m[0]=e[0]+2*e[1],t=1;t<n-1;++t)c[t]=1,d[t]=4,m[t]=4*e[t]+2*e[t+1];for(c[n-1]=2,d[n-1]=7,m[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=c[t]/d[t-1],d[t]-=i,m[t]-=i*m[t-1];for(c[n-1]=m[n-1]/d[n-1],t=n-2;t>=0;--t)c[t]=(m[t]-c[t+1])/d[t];for(d[n-1]=(e[n]+c[n-1])/2,t=0;t<n-1;++t)d[t]=2*e[t+1]-c[t+1];return[c,d]}function n0e(e){return new FZ(e)}function N2(e,t){this._context=e,this._t=t}N2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function r0e(e){return new N2(e,.5)}function i0e(e){return new N2(e,0)}function a0e(e){return new N2(e,1)}function Hx(e,t){if((m=e.length)>1)for(var n=1,i,c,d=e[t[0]],m,a=d.length;n<m;++n)for(c=d,d=e[t[n]],i=0;i<a;++i)d[i][1]+=d[i][0]=isNaN(c[i][1])?c[i][0]:c[i][1]}function Ck(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function o0e(e,t){return e[t]}function s0e(e){const t=[];return t.key=e,t}function l0e(){var e=Oo([]),t=Ck,n=Hx,i=o0e;function c(d){var m=Array.from(e.apply(this,arguments),s0e),a,w=m.length,S=-1,M;for(const P of d)for(a=0,++S;a<w;++a)(m[a][S]=[0,+i(P,m[a].key,S,d)]).data=P;for(a=0,M=_z(t(m));a<w;++a)m[M[a]].index=a;return n(m,M),m}return c.keys=function(d){return arguments.length?(e=typeof d=="function"?d:Oo(Array.from(d)),c):e},c.value=function(d){return arguments.length?(i=typeof d=="function"?d:Oo(+d),c):i},c.order=function(d){return arguments.length?(t=d==null?Ck:typeof d=="function"?d:Oo(Array.from(d)),c):t},c.offset=function(d){return arguments.length?(n=d??Hx,c):n},c}function c0e(e,t){if((i=e.length)>0){for(var n,i,c=0,d=e[0].length,m;c<d;++c){for(m=n=0;n<i;++n)m+=e[n][c][1]||0;if(m)for(n=0;n<i;++n)e[n][c][1]/=m}Hx(e,t)}}function u0e(e,t){if((c=e.length)>0){for(var n=0,i=e[t[0]],c,d=i.length;n<d;++n){for(var m=0,a=0;m<c;++m)a+=e[m][n][1]||0;i[n][1]+=i[n][0]=-a/2}Hx(e,t)}}function h0e(e,t){if(!(!((m=e.length)>0)||!((d=(c=e[t[0]]).length)>0))){for(var n=0,i=1,c,d,m;i<d;++i){for(var a=0,w=0,S=0;a<m;++a){for(var M=e[t[a]],P=M[i][1]||0,N=M[i-1][1]||0,$=(P-N)/2,G=0;G<a;++G){var q=e[t[G]],V=q[i][1]||0,J=q[i-1][1]||0;$+=V-J}w+=P,S+=$*P}c[i-1][1]+=c[i-1][0]=n,w&&(n-=S/w)}c[i-1][1]+=c[i-1][0]=n,Hx(e,t)}}function Hw(e){"@babel/helpers - typeof";return Hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hw(e)}var d0e=["type","size","sizeType"];function Mk(){return Mk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Mk.apply(this,arguments)}function mU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function gU(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mU(Object(n),!0).forEach(function(i){f0e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mU(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function f0e(e,t,n){return t=p0e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p0e(e){var t=m0e(e,"string");return Hw(t)=="symbol"?t:t+""}function m0e(e,t){if(Hw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Hw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g0e(e,t){if(e==null)return{};var n=y0e(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function y0e(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var VZ={symbolCircle:vz,symbolCross:jxe,symbolDiamond:Fxe,symbolSquare:Vxe,symbolStar:Hxe,symbolTriangle:Gxe,symbolWye:Xxe},_0e=Math.PI/180,v0e=function(t){var n="symbol".concat(D2(t));return VZ[n]||vz},x0e=function(t,n,i){if(n==="area")return t;switch(i){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var c=18*_0e;return 1.25*t*t*(Math.tan(c)-Math.tan(c*2)*Math.pow(Math.tan(c),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},b0e=function(t,n){VZ["symbol".concat(D2(t))]=n},xz=function(t){var n=t.type,i=n===void 0?"circle":n,c=t.size,d=c===void 0?64:c,m=t.sizeType,a=m===void 0?"area":m,w=g0e(t,d0e),S=gU(gU({},w),{},{type:i,size:d,sizeType:a}),M=function(){var V=v0e(i),J=Zxe().type(V).size(x0e(d,a,i));return J()},P=S.className,N=S.cx,$=S.cy,G=ha(S,!0);return N===+N&&$===+$&&d===+d?Ce.createElement("path",Mk({},G,{className:xa("recharts-symbols",P),transform:"translate(".concat(N,", ").concat($,")"),d:M()})):null};xz.registerSymbol=b0e;function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function Pk(){return Pk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Pk.apply(this,arguments)}function yU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function w0e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yU(Object(n),!0).forEach(function(i){Gw(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yU(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function S0e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T0e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,$Z(i.key),i)}}function E0e(e,t,n){return t&&T0e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function A0e(e,t,n){return t=UE(t),C0e(e,UZ()?Reflect.construct(t,n||[],UE(e).constructor):t.apply(e,n))}function C0e(e,t){if(t&&(Gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M0e(e)}function M0e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UZ=function(){return!!e})()}function UE(e){return UE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},UE(e)}function P0e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ok(e,t)}function Ok(e,t){return Ok=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},Ok(e,t)}function Gw(e,t,n){return t=$Z(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Z(e){var t=O0e(e,"string");return Gx(t)=="symbol"?t:t+""}function O0e(e,t){if(Gx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Gx(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Hh=32,bz=(function(e){function t(){return S0e(this,t),A0e(this,t,arguments)}return P0e(t,e),E0e(t,[{key:"renderIcon",value:function(i){var c=this.props.inactiveColor,d=Hh/2,m=Hh/6,a=Hh/3,w=i.inactive?c:i.color;if(i.type==="plainline")return Ce.createElement("line",{strokeWidth:4,fill:"none",stroke:w,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:d,x2:Hh,y2:d,className:"recharts-legend-icon"});if(i.type==="line")return Ce.createElement("path",{strokeWidth:4,fill:"none",stroke:w,d:"M0,".concat(d,"h").concat(a,`
            A`).concat(m,",").concat(m,",0,1,1,").concat(2*a,",").concat(d,`
            H`).concat(Hh,"M").concat(2*a,",").concat(d,`
            A`).concat(m,",").concat(m,",0,1,1,").concat(a,",").concat(d),className:"recharts-legend-icon"});if(i.type==="rect")return Ce.createElement("path",{stroke:"none",fill:w,d:"M0,".concat(Hh/8,"h").concat(Hh,"v").concat(Hh*3/4,"h").concat(-Hh,"z"),className:"recharts-legend-icon"});if(Ce.isValidElement(i.legendIcon)){var S=w0e({},i);return delete S.legendIcon,Ce.cloneElement(i.legendIcon,S)}return Ce.createElement(xz,{fill:w,cx:d,cy:d,size:Hh,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,c=this.props,d=c.payload,m=c.iconSize,a=c.layout,w=c.formatter,S=c.inactiveColor,M={x:0,y:0,width:Hh,height:Hh},P={display:a==="horizontal"?"inline-block":"block",marginRight:10},N={display:"inline-block",verticalAlign:"middle",marginRight:4};return d.map(function($,G){var q=$.formatter||w,V=xa(Gw(Gw({"recharts-legend-item":!0},"legend-item-".concat(G),!0),"inactive",$.inactive));if($.type==="none")return null;var J=Hi($.value)?null:$.value;km(!Hi($.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var ee=$.inactive?S:$.color;return Ce.createElement("li",Pk({className:V,style:P,key:"legend-item-".concat(G)},NE(i.props,$,G)),Ce.createElement(wk,{width:m,height:m,viewBox:M,style:N},i.renderIcon($)),Ce.createElement("span",{className:"recharts-legend-item-text",style:{color:ee}},q?q(J,$,G):J))})}},{key:"render",value:function(){var i=this.props,c=i.payload,d=i.layout,m=i.align;if(!c||!c.length)return null;var a={padding:0,margin:0,textAlign:d==="horizontal"?m:"left"};return Ce.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])})(K.PureComponent);Gw(bz,"displayName","Legend");Gw(bz,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var CO,_U;function R0e(){if(_U)return CO;_U=1;var e=O2();function t(){this.__data__=new e,this.size=0}return CO=t,CO}var MO,vU;function I0e(){if(vU)return MO;vU=1;function e(t){var n=this.__data__,i=n.delete(t);return this.size=n.size,i}return MO=e,MO}var PO,xU;function D0e(){if(xU)return PO;xU=1;function e(t){return this.__data__.get(t)}return PO=e,PO}var OO,bU;function k0e(){if(bU)return OO;bU=1;function e(t){return this.__data__.has(t)}return OO=e,OO}var RO,wU;function L0e(){if(wU)return RO;wU=1;var e=O2(),t=hz(),n=dz(),i=200;function c(d,m){var a=this.__data__;if(a instanceof e){var w=a.__data__;if(!t||w.length<i-1)return w.push([d,m]),this.size=++a.size,this;a=this.__data__=new n(w)}return a.set(d,m),this.size=a.size,this}return RO=c,RO}var IO,SU;function qZ(){if(SU)return IO;SU=1;var e=O2(),t=R0e(),n=I0e(),i=D0e(),c=k0e(),d=L0e();function m(a){var w=this.__data__=new e(a);this.size=w.size}return m.prototype.clear=t,m.prototype.delete=n,m.prototype.get=i,m.prototype.has=c,m.prototype.set=d,IO=m,IO}var DO,TU;function N0e(){if(TU)return DO;TU=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return DO=t,DO}var kO,EU;function z0e(){if(EU)return kO;EU=1;function e(t){return this.__data__.has(t)}return kO=e,kO}var LO,AU;function HZ(){if(AU)return LO;AU=1;var e=dz(),t=N0e(),n=z0e();function i(c){var d=-1,m=c==null?0:c.length;for(this.__data__=new e;++d<m;)this.add(c[d])}return i.prototype.add=i.prototype.push=t,i.prototype.has=n,LO=i,LO}var NO,CU;function GZ(){if(CU)return NO;CU=1;function e(t,n){for(var i=-1,c=t==null?0:t.length;++i<c;)if(n(t[i],i,t))return!0;return!1}return NO=e,NO}var zO,MU;function WZ(){if(MU)return zO;MU=1;function e(t,n){return t.has(n)}return zO=e,zO}var jO,PU;function XZ(){if(PU)return jO;PU=1;var e=HZ(),t=GZ(),n=WZ(),i=1,c=2;function d(m,a,w,S,M,P){var N=w&i,$=m.length,G=a.length;if($!=G&&!(N&&G>$))return!1;var q=P.get(m),V=P.get(a);if(q&&V)return q==a&&V==m;var J=-1,ee=!0,re=w&c?new e:void 0;for(P.set(m,a),P.set(a,m);++J<$;){var fe=m[J],ne=a[J];if(S)var ce=N?S(ne,fe,J,a,m,P):S(fe,ne,J,m,a,P);if(ce!==void 0){if(ce)continue;ee=!1;break}if(re){if(!t(a,function(me,ve){if(!n(re,ve)&&(fe===me||M(fe,me,w,S,P)))return re.push(ve)})){ee=!1;break}}else if(!(fe===ne||M(fe,ne,w,S,P))){ee=!1;break}}return P.delete(m),P.delete(a),ee}return jO=d,jO}var BO,OU;function j0e(){if(OU)return BO;OU=1;var e=bp(),t=e.Uint8Array;return BO=t,BO}var FO,RU;function B0e(){if(RU)return FO;RU=1;function e(t){var n=-1,i=Array(t.size);return t.forEach(function(c,d){i[++n]=[d,c]}),i}return FO=e,FO}var VO,IU;function wz(){if(IU)return VO;IU=1;function e(t){var n=-1,i=Array(t.size);return t.forEach(function(c){i[++n]=c}),i}return VO=e,VO}var UO,DU;function F0e(){if(DU)return UO;DU=1;var e=tS(),t=j0e(),n=uz(),i=XZ(),c=B0e(),d=wz(),m=1,a=2,w="[object Boolean]",S="[object Date]",M="[object Error]",P="[object Map]",N="[object Number]",$="[object RegExp]",G="[object Set]",q="[object String]",V="[object Symbol]",J="[object ArrayBuffer]",ee="[object DataView]",re=e?e.prototype:void 0,fe=re?re.valueOf:void 0;function ne(ce,me,ve,De,Ye,ze,tt){switch(ve){case ee:if(ce.byteLength!=me.byteLength||ce.byteOffset!=me.byteOffset)return!1;ce=ce.buffer,me=me.buffer;case J:return!(ce.byteLength!=me.byteLength||!ze(new t(ce),new t(me)));case w:case S:case N:return n(+ce,+me);case M:return ce.name==me.name&&ce.message==me.message;case $:case q:return ce==me+"";case P:var at=c;case G:var ct=De&m;if(at||(at=d),ce.size!=me.size&&!ct)return!1;var ht=tt.get(ce);if(ht)return ht==me;De|=a,tt.set(ce,me);var Ie=i(at(ce),at(me),De,Ye,ze,tt);return tt.delete(ce),Ie;case V:if(fe)return fe.call(ce)==fe.call(me)}return!1}return UO=ne,UO}var $O,kU;function ZZ(){if(kU)return $O;kU=1;function e(t,n){for(var i=-1,c=n.length,d=t.length;++i<c;)t[d+i]=n[i];return t}return $O=e,$O}var qO,LU;function V0e(){if(LU)return qO;LU=1;var e=ZZ(),t=du();function n(i,c,d){var m=c(i);return t(i)?m:e(m,d(i))}return qO=n,qO}var HO,NU;function U0e(){if(NU)return HO;NU=1;function e(t,n){for(var i=-1,c=t==null?0:t.length,d=0,m=[];++i<c;){var a=t[i];n(a,i,t)&&(m[d++]=a)}return m}return HO=e,HO}var GO,zU;function $0e(){if(zU)return GO;zU=1;function e(){return[]}return GO=e,GO}var WO,jU;function q0e(){if(jU)return WO;jU=1;var e=U0e(),t=$0e(),n=Object.prototype,i=n.propertyIsEnumerable,c=Object.getOwnPropertySymbols,d=c?function(m){return m==null?[]:(m=Object(m),e(c(m),function(a){return i.call(m,a)}))}:t;return WO=d,WO}var XO,BU;function H0e(){if(BU)return XO;BU=1;function e(t,n){for(var i=-1,c=Array(t);++i<t;)c[i]=n(i);return c}return XO=e,XO}var ZO,FU;function G0e(){if(FU)return ZO;FU=1;var e=Gm(),t=Wm(),n="[object Arguments]";function i(c){return t(c)&&e(c)==n}return ZO=i,ZO}var YO,VU;function Sz(){if(VU)return YO;VU=1;var e=G0e(),t=Wm(),n=Object.prototype,i=n.hasOwnProperty,c=n.propertyIsEnumerable,d=e((function(){return arguments})())?e:function(m){return t(m)&&i.call(m,"callee")&&!c.call(m,"callee")};return YO=d,YO}var yw={exports:{}},KO,UU;function W0e(){if(UU)return KO;UU=1;function e(){return!1}return KO=e,KO}yw.exports;var $U;function YZ(){return $U||($U=1,(function(e,t){var n=bp(),i=W0e(),c=t&&!t.nodeType&&t,d=c&&!0&&e&&!e.nodeType&&e,m=d&&d.exports===c,a=m?n.Buffer:void 0,w=a?a.isBuffer:void 0,S=w||i;e.exports=S})(yw,yw.exports)),yw.exports}var JO,qU;function Tz(){if(qU)return JO;qU=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(i,c){var d=typeof i;return c=c??e,!!c&&(d=="number"||d!="symbol"&&t.test(i))&&i>-1&&i%1==0&&i<c}return JO=n,JO}var QO,HU;function Ez(){if(HU)return QO;HU=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return QO=t,QO}var eR,GU;function X0e(){if(GU)return eR;GU=1;var e=Gm(),t=Ez(),n=Wm(),i="[object Arguments]",c="[object Array]",d="[object Boolean]",m="[object Date]",a="[object Error]",w="[object Function]",S="[object Map]",M="[object Number]",P="[object Object]",N="[object RegExp]",$="[object Set]",G="[object String]",q="[object WeakMap]",V="[object ArrayBuffer]",J="[object DataView]",ee="[object Float32Array]",re="[object Float64Array]",fe="[object Int8Array]",ne="[object Int16Array]",ce="[object Int32Array]",me="[object Uint8Array]",ve="[object Uint8ClampedArray]",De="[object Uint16Array]",Ye="[object Uint32Array]",ze={};ze[ee]=ze[re]=ze[fe]=ze[ne]=ze[ce]=ze[me]=ze[ve]=ze[De]=ze[Ye]=!0,ze[i]=ze[c]=ze[V]=ze[d]=ze[J]=ze[m]=ze[a]=ze[w]=ze[S]=ze[M]=ze[P]=ze[N]=ze[$]=ze[G]=ze[q]=!1;function tt(at){return n(at)&&t(at.length)&&!!ze[e(at)]}return eR=tt,eR}var tR,WU;function KZ(){if(WU)return tR;WU=1;function e(t){return function(n){return t(n)}}return tR=e,tR}var _w={exports:{}};_w.exports;var XU;function Z0e(){return XU||(XU=1,(function(e,t){var n=yZ(),i=t&&!t.nodeType&&t,c=i&&!0&&e&&!e.nodeType&&e,d=c&&c.exports===i,m=d&&n.process,a=(function(){try{var w=c&&c.require&&c.require("util").types;return w||m&&m.binding&&m.binding("util")}catch{}})();e.exports=a})(_w,_w.exports)),_w.exports}var nR,ZU;function JZ(){if(ZU)return nR;ZU=1;var e=X0e(),t=KZ(),n=Z0e(),i=n&&n.isTypedArray,c=i?t(i):e;return nR=c,nR}var rR,YU;function Y0e(){if(YU)return rR;YU=1;var e=H0e(),t=Sz(),n=du(),i=YZ(),c=Tz(),d=JZ(),m=Object.prototype,a=m.hasOwnProperty;function w(S,M){var P=n(S),N=!P&&t(S),$=!P&&!N&&i(S),G=!P&&!N&&!$&&d(S),q=P||N||$||G,V=q?e(S.length,String):[],J=V.length;for(var ee in S)(M||a.call(S,ee))&&!(q&&(ee=="length"||$&&(ee=="offset"||ee=="parent")||G&&(ee=="buffer"||ee=="byteLength"||ee=="byteOffset")||c(ee,J)))&&V.push(ee);return V}return rR=w,rR}var iR,KU;function K0e(){if(KU)return iR;KU=1;var e=Object.prototype;function t(n){var i=n&&n.constructor,c=typeof i=="function"&&i.prototype||e;return n===c}return iR=t,iR}var aR,JU;function QZ(){if(JU)return aR;JU=1;function e(t,n){return function(i){return t(n(i))}}return aR=e,aR}var oR,QU;function J0e(){if(QU)return oR;QU=1;var e=QZ(),t=e(Object.keys,Object);return oR=t,oR}var sR,e6;function Q0e(){if(e6)return sR;e6=1;var e=K0e(),t=J0e(),n=Object.prototype,i=n.hasOwnProperty;function c(d){if(!e(d))return t(d);var m=[];for(var a in Object(d))i.call(d,a)&&a!="constructor"&&m.push(a);return m}return sR=c,sR}var lR,t6;function rS(){if(t6)return lR;t6=1;var e=cz(),t=Ez();function n(i){return i!=null&&t(i.length)&&!e(i)}return lR=n,lR}var cR,n6;function z2(){if(n6)return cR;n6=1;var e=Y0e(),t=Q0e(),n=rS();function i(c){return n(c)?e(c):t(c)}return cR=i,cR}var uR,r6;function ebe(){if(r6)return uR;r6=1;var e=V0e(),t=q0e(),n=z2();function i(c){return e(c,n,t)}return uR=i,uR}var hR,i6;function tbe(){if(i6)return hR;i6=1;var e=ebe(),t=1,n=Object.prototype,i=n.hasOwnProperty;function c(d,m,a,w,S,M){var P=a&t,N=e(d),$=N.length,G=e(m),q=G.length;if($!=q&&!P)return!1;for(var V=$;V--;){var J=N[V];if(!(P?J in m:i.call(m,J)))return!1}var ee=M.get(d),re=M.get(m);if(ee&&re)return ee==m&&re==d;var fe=!0;M.set(d,m),M.set(m,d);for(var ne=P;++V<$;){J=N[V];var ce=d[J],me=m[J];if(w)var ve=P?w(me,ce,J,m,d,M):w(ce,me,J,d,m,M);if(!(ve===void 0?ce===me||S(ce,me,a,w,M):ve)){fe=!1;break}ne||(ne=J=="constructor")}if(fe&&!ne){var De=d.constructor,Ye=m.constructor;De!=Ye&&"constructor"in d&&"constructor"in m&&!(typeof De=="function"&&De instanceof De&&typeof Ye=="function"&&Ye instanceof Ye)&&(fe=!1)}return M.delete(d),M.delete(m),fe}return hR=c,hR}var dR,a6;function nbe(){if(a6)return dR;a6=1;var e=cv(),t=bp(),n=e(t,"DataView");return dR=n,dR}var fR,o6;function rbe(){if(o6)return fR;o6=1;var e=cv(),t=bp(),n=e(t,"Promise");return fR=n,fR}var pR,s6;function eY(){if(s6)return pR;s6=1;var e=cv(),t=bp(),n=e(t,"Set");return pR=n,pR}var mR,l6;function ibe(){if(l6)return mR;l6=1;var e=cv(),t=bp(),n=e(t,"WeakMap");return mR=n,mR}var gR,c6;function abe(){if(c6)return gR;c6=1;var e=nbe(),t=hz(),n=rbe(),i=eY(),c=ibe(),d=Gm(),m=_Z(),a="[object Map]",w="[object Object]",S="[object Promise]",M="[object Set]",P="[object WeakMap]",N="[object DataView]",$=m(e),G=m(t),q=m(n),V=m(i),J=m(c),ee=d;return(e&&ee(new e(new ArrayBuffer(1)))!=N||t&&ee(new t)!=a||n&&ee(n.resolve())!=S||i&&ee(new i)!=M||c&&ee(new c)!=P)&&(ee=function(re){var fe=d(re),ne=fe==w?re.constructor:void 0,ce=ne?m(ne):"";if(ce)switch(ce){case $:return N;case G:return a;case q:return S;case V:return M;case J:return P}return fe}),gR=ee,gR}var yR,u6;function obe(){if(u6)return yR;u6=1;var e=qZ(),t=XZ(),n=F0e(),i=tbe(),c=abe(),d=du(),m=YZ(),a=JZ(),w=1,S="[object Arguments]",M="[object Array]",P="[object Object]",N=Object.prototype,$=N.hasOwnProperty;function G(q,V,J,ee,re,fe){var ne=d(q),ce=d(V),me=ne?M:c(q),ve=ce?M:c(V);me=me==S?P:me,ve=ve==S?P:ve;var De=me==P,Ye=ve==P,ze=me==ve;if(ze&&m(q)){if(!m(V))return!1;ne=!0,De=!1}if(ze&&!De)return fe||(fe=new e),ne||a(q)?t(q,V,J,ee,re,fe):n(q,V,me,J,ee,re,fe);if(!(J&w)){var tt=De&&$.call(q,"__wrapped__"),at=Ye&&$.call(V,"__wrapped__");if(tt||at){var ct=tt?q.value():q,ht=at?V.value():V;return fe||(fe=new e),re(ct,ht,J,ee,fe)}}return ze?(fe||(fe=new e),i(q,V,J,ee,re,fe)):!1}return yR=G,yR}var _R,h6;function Az(){if(h6)return _R;h6=1;var e=obe(),t=Wm();function n(i,c,d,m,a){return i===c?!0:i==null||c==null||!t(i)&&!t(c)?i!==i&&c!==c:e(i,c,d,m,n,a)}return _R=n,_R}var vR,d6;function sbe(){if(d6)return vR;d6=1;var e=qZ(),t=Az(),n=1,i=2;function c(d,m,a,w){var S=a.length,M=S,P=!w;if(d==null)return!M;for(d=Object(d);S--;){var N=a[S];if(P&&N[2]?N[1]!==d[N[0]]:!(N[0]in d))return!1}for(;++S<M;){N=a[S];var $=N[0],G=d[$],q=N[1];if(P&&N[2]){if(G===void 0&&!($ in d))return!1}else{var V=new e;if(w)var J=w(G,q,$,d,m,V);if(!(J===void 0?t(q,G,n|i,w,V):J))return!1}}return!0}return vR=c,vR}var xR,f6;function tY(){if(f6)return xR;f6=1;var e=_y();function t(n){return n===n&&!e(n)}return xR=t,xR}var bR,p6;function lbe(){if(p6)return bR;p6=1;var e=tY(),t=z2();function n(i){for(var c=t(i),d=c.length;d--;){var m=c[d],a=i[m];c[d]=[m,a,e(a)]}return c}return bR=n,bR}var wR,m6;function nY(){if(m6)return wR;m6=1;function e(t,n){return function(i){return i==null?!1:i[t]===n&&(n!==void 0||t in Object(i))}}return wR=e,wR}var SR,g6;function cbe(){if(g6)return SR;g6=1;var e=sbe(),t=lbe(),n=nY();function i(c){var d=t(c);return d.length==1&&d[0][2]?n(d[0][0],d[0][1]):function(m){return m===c||e(m,c,d)}}return SR=i,SR}var TR,y6;function ube(){if(y6)return TR;y6=1;function e(t,n){return t!=null&&n in Object(t)}return TR=e,TR}var ER,_6;function hbe(){if(_6)return ER;_6=1;var e=bZ(),t=Sz(),n=du(),i=Tz(),c=Ez(),d=I2();function m(a,w,S){w=e(w,a);for(var M=-1,P=w.length,N=!1;++M<P;){var $=d(w[M]);if(!(N=a!=null&&S(a,$)))break;a=a[$]}return N||++M!=P?N:(P=a==null?0:a.length,!!P&&c(P)&&i($,P)&&(n(a)||t(a)))}return ER=m,ER}var AR,v6;function dbe(){if(v6)return AR;v6=1;var e=ube(),t=hbe();function n(i,c){return i!=null&&t(i,c,e)}return AR=n,AR}var CR,x6;function fbe(){if(x6)return CR;x6=1;var e=Az(),t=wZ(),n=dbe(),i=lz(),c=tY(),d=nY(),m=I2(),a=1,w=2;function S(M,P){return i(M)&&c(P)?d(m(M),P):function(N){var $=t(N,M);return $===void 0&&$===P?n(N,M):e(P,$,a|w)}}return CR=S,CR}var MR,b6;function I0(){if(b6)return MR;b6=1;function e(t){return t}return MR=e,MR}var PR,w6;function pbe(){if(w6)return PR;w6=1;function e(t){return function(n){return n?.[t]}}return PR=e,PR}var OR,S6;function mbe(){if(S6)return OR;S6=1;var e=pz();function t(n){return function(i){return e(i,n)}}return OR=t,OR}var RR,T6;function gbe(){if(T6)return RR;T6=1;var e=pbe(),t=mbe(),n=lz(),i=I2();function c(d){return n(d)?e(i(d)):t(d)}return RR=c,RR}var IR,E6;function vy(){if(E6)return IR;E6=1;var e=cbe(),t=fbe(),n=I0(),i=du(),c=gbe();function d(m){return typeof m=="function"?m:m==null?n:typeof m=="object"?i(m)?t(m[0],m[1]):e(m):c(m)}return IR=d,IR}var DR,A6;function rY(){if(A6)return DR;A6=1;function e(t,n,i,c){for(var d=t.length,m=i+(c?1:-1);c?m--:++m<d;)if(n(t[m],m,t))return m;return-1}return DR=e,DR}var kR,C6;function ybe(){if(C6)return kR;C6=1;function e(t){return t!==t}return kR=e,kR}var LR,M6;function _be(){if(M6)return LR;M6=1;function e(t,n,i){for(var c=i-1,d=t.length;++c<d;)if(t[c]===n)return c;return-1}return LR=e,LR}var NR,P6;function vbe(){if(P6)return NR;P6=1;var e=rY(),t=ybe(),n=_be();function i(c,d,m){return d===d?n(c,d,m):e(c,t,m)}return NR=i,NR}var zR,O6;function xbe(){if(O6)return zR;O6=1;var e=vbe();function t(n,i){var c=n==null?0:n.length;return!!c&&e(n,i,0)>-1}return zR=t,zR}var jR,R6;function bbe(){if(R6)return jR;R6=1;function e(t,n,i){for(var c=-1,d=t==null?0:t.length;++c<d;)if(i(n,t[c]))return!0;return!1}return jR=e,jR}var BR,I6;function wbe(){if(I6)return BR;I6=1;function e(){}return BR=e,BR}var FR,D6;function Sbe(){if(D6)return FR;D6=1;var e=eY(),t=wbe(),n=wz(),i=1/0,c=e&&1/n(new e([,-0]))[1]==i?function(d){return new e(d)}:t;return FR=c,FR}var VR,k6;function Tbe(){if(k6)return VR;k6=1;var e=HZ(),t=xbe(),n=bbe(),i=WZ(),c=Sbe(),d=wz(),m=200;function a(w,S,M){var P=-1,N=t,$=w.length,G=!0,q=[],V=q;if(M)G=!1,N=n;else if($>=m){var J=S?null:c(w);if(J)return d(J);G=!1,N=i,V=new e}else V=S?[]:q;e:for(;++P<$;){var ee=w[P],re=S?S(ee):ee;if(ee=M||ee!==0?ee:0,G&&re===re){for(var fe=V.length;fe--;)if(V[fe]===re)continue e;S&&V.push(re),q.push(ee)}else N(V,re,M)||(V!==q&&V.push(re),q.push(ee))}return q}return VR=a,VR}var UR,L6;function Ebe(){if(L6)return UR;L6=1;var e=vy(),t=Tbe();function n(i,c){return i&&i.length?t(i,e(c,2)):[]}return UR=n,UR}var Abe=Ebe();const N6=Wa(Abe);function iY(e,t,n){return t===!0?N6(e,n):Hi(t)?N6(e,t):e}function Wx(e){"@babel/helpers - typeof";return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}var Cbe=["ref"];function z6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Sm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z6(Object(n),!0).forEach(function(i){j2(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z6(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Mbe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j6(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,oY(i.key),i)}}function Pbe(e,t,n){return t&&j6(e.prototype,t),n&&j6(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Obe(e,t,n){return t=$E(t),Rbe(e,aY()?Reflect.construct(t,n||[],$E(e).constructor):t.apply(e,n))}function Rbe(e,t){if(t&&(Wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ibe(e)}function Ibe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aY=function(){return!!e})()}function $E(e){return $E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},$E(e)}function Dbe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rk(e,t)}function Rk(e,t){return Rk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},Rk(e,t)}function j2(e,t,n){return t=oY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oY(e){var t=kbe(e,"string");return Wx(t)=="symbol"?t:t+""}function kbe(e,t){if(Wx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Wx(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Lbe(e,t){if(e==null)return{};var n=Nbe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Nbe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function zbe(e){return e.value}function jbe(e,t){if(Ce.isValidElement(e))return Ce.cloneElement(e,t);if(typeof e=="function")return Ce.createElement(e,t);t.ref;var n=Lbe(t,Cbe);return Ce.createElement(bz,n)}var B6=1,kx=(function(e){function t(){var n;Mbe(this,t);for(var i=arguments.length,c=new Array(i),d=0;d<i;d++)c[d]=arguments[d];return n=Obe(this,t,[].concat(c)),j2(n,"lastBoundingBox",{width:-1,height:-1}),n}return Dbe(t,e),Pbe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,c=this.getBBox();c?(Math.abs(c.width-this.lastBoundingBox.width)>B6||Math.abs(c.height-this.lastBoundingBox.height)>B6)&&(this.lastBoundingBox.width=c.width,this.lastBoundingBox.height=c.height,i&&i(c)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Sm({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var c=this.props,d=c.layout,m=c.align,a=c.verticalAlign,w=c.margin,S=c.chartWidth,M=c.chartHeight,P,N;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(m==="center"&&d==="vertical"){var $=this.getBBoxSnapshot();P={left:((S||0)-$.width)/2}}else P=m==="right"?{right:w&&w.right||0}:{left:w&&w.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(a==="middle"){var G=this.getBBoxSnapshot();N={top:((M||0)-G.height)/2}}else N=a==="bottom"?{bottom:w&&w.bottom||0}:{top:w&&w.top||0};return Sm(Sm({},P),N)}},{key:"render",value:function(){var i=this,c=this.props,d=c.content,m=c.width,a=c.height,w=c.wrapperStyle,S=c.payloadUniqBy,M=c.payload,P=Sm(Sm({position:"absolute",width:m||"auto",height:a||"auto"},this.getDefaultPosition(w)),w);return Ce.createElement("div",{className:"recharts-legend-wrapper",style:P,ref:function($){i.wrapperNode=$}},jbe(d,Sm(Sm({},this.props),{},{payload:iY(M,S,zbe)})))}}],[{key:"getWithHeight",value:function(i,c){var d=Sm(Sm({},this.defaultProps),i.props),m=d.layout;return m==="vertical"&&rr(i.props.height)?{height:i.props.height}:m==="horizontal"?{width:i.props.width||c}:null}}])})(K.PureComponent);j2(kx,"displayName","Legend");j2(kx,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var $R,F6;function Bbe(){if(F6)return $R;F6=1;var e=tS(),t=Sz(),n=du(),i=e?e.isConcatSpreadable:void 0;function c(d){return n(d)||t(d)||!!(i&&d&&d[i])}return $R=c,$R}var qR,V6;function sY(){if(V6)return qR;V6=1;var e=ZZ(),t=Bbe();function n(i,c,d,m,a){var w=-1,S=i.length;for(d||(d=t),a||(a=[]);++w<S;){var M=i[w];c>0&&d(M)?c>1?n(M,c-1,d,m,a):e(a,M):m||(a[a.length]=M)}return a}return qR=n,qR}var HR,U6;function Fbe(){if(U6)return HR;U6=1;function e(t){return function(n,i,c){for(var d=-1,m=Object(n),a=c(n),w=a.length;w--;){var S=a[t?w:++d];if(i(m[S],S,m)===!1)break}return n}}return HR=e,HR}var GR,$6;function Vbe(){if($6)return GR;$6=1;var e=Fbe(),t=e();return GR=t,GR}var WR,q6;function lY(){if(q6)return WR;q6=1;var e=Vbe(),t=z2();function n(i,c){return i&&e(i,c,t)}return WR=n,WR}var XR,H6;function Ube(){if(H6)return XR;H6=1;var e=rS();function t(n,i){return function(c,d){if(c==null)return c;if(!e(c))return n(c,d);for(var m=c.length,a=i?m:-1,w=Object(c);(i?a--:++a<m)&&d(w[a],a,w)!==!1;);return c}}return XR=t,XR}var ZR,G6;function Cz(){if(G6)return ZR;G6=1;var e=lY(),t=Ube(),n=t(e);return ZR=n,ZR}var YR,W6;function cY(){if(W6)return YR;W6=1;var e=Cz(),t=rS();function n(i,c){var d=-1,m=t(i)?Array(i.length):[];return e(i,function(a,w,S){m[++d]=c(a,w,S)}),m}return YR=n,YR}var KR,X6;function $be(){if(X6)return KR;X6=1;function e(t,n){var i=t.length;for(t.sort(n);i--;)t[i]=t[i].value;return t}return KR=e,KR}var JR,Z6;function qbe(){if(Z6)return JR;Z6=1;var e=P0();function t(n,i){if(n!==i){var c=n!==void 0,d=n===null,m=n===n,a=e(n),w=i!==void 0,S=i===null,M=i===i,P=e(i);if(!S&&!P&&!a&&n>i||a&&w&&M&&!S&&!P||d&&w&&M||!c&&M||!m)return 1;if(!d&&!a&&!P&&n<i||P&&c&&m&&!d&&!a||S&&c&&m||!w&&m||!M)return-1}return 0}return JR=t,JR}var QR,Y6;function Hbe(){if(Y6)return QR;Y6=1;var e=qbe();function t(n,i,c){for(var d=-1,m=n.criteria,a=i.criteria,w=m.length,S=c.length;++d<w;){var M=e(m[d],a[d]);if(M){if(d>=S)return M;var P=c[d];return M*(P=="desc"?-1:1)}}return n.index-i.index}return QR=t,QR}var eI,K6;function Gbe(){if(K6)return eI;K6=1;var e=fz(),t=pz(),n=vy(),i=cY(),c=$be(),d=KZ(),m=Hbe(),a=I0(),w=du();function S(M,P,N){P.length?P=e(P,function(q){return w(q)?function(V){return t(V,q.length===1?q[0]:q)}:q}):P=[a];var $=-1;P=e(P,d(n));var G=i(M,function(q,V,J){var ee=e(P,function(re){return re(q)});return{criteria:ee,index:++$,value:q}});return c(G,function(q,V){return m(q,V,N)})}return eI=S,eI}var tI,J6;function Wbe(){if(J6)return tI;J6=1;function e(t,n,i){switch(i.length){case 0:return t.call(n);case 1:return t.call(n,i[0]);case 2:return t.call(n,i[0],i[1]);case 3:return t.call(n,i[0],i[1],i[2])}return t.apply(n,i)}return tI=e,tI}var nI,Q6;function Xbe(){if(Q6)return nI;Q6=1;var e=Wbe(),t=Math.max;function n(i,c,d){return c=t(c===void 0?i.length-1:c,0),function(){for(var m=arguments,a=-1,w=t(m.length-c,0),S=Array(w);++a<w;)S[a]=m[c+a];a=-1;for(var M=Array(c+1);++a<c;)M[a]=m[a];return M[c]=d(S),e(i,this,M)}}return nI=n,nI}var rI,e$;function Zbe(){if(e$)return rI;e$=1;function e(t){return function(){return t}}return rI=e,rI}var iI,t$;function uY(){if(t$)return iI;t$=1;var e=cv(),t=(function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}})();return iI=t,iI}var aI,n$;function Ybe(){if(n$)return aI;n$=1;var e=Zbe(),t=uY(),n=I0(),i=t?function(c,d){return t(c,"toString",{configurable:!0,enumerable:!1,value:e(d),writable:!0})}:n;return aI=i,aI}var oI,r$;function Kbe(){if(r$)return oI;r$=1;var e=800,t=16,n=Date.now;function i(c){var d=0,m=0;return function(){var a=n(),w=t-(a-m);if(m=a,w>0){if(++d>=e)return arguments[0]}else d=0;return c.apply(void 0,arguments)}}return oI=i,oI}var sI,i$;function Jbe(){if(i$)return sI;i$=1;var e=Ybe(),t=Kbe(),n=t(e);return sI=n,sI}var lI,a$;function Qbe(){if(a$)return lI;a$=1;var e=I0(),t=Xbe(),n=Jbe();function i(c,d){return n(t(c,d,e),c+"")}return lI=i,lI}var cI,o$;function B2(){if(o$)return cI;o$=1;var e=uz(),t=rS(),n=Tz(),i=_y();function c(d,m,a){if(!i(a))return!1;var w=typeof m;return(w=="number"?t(a)&&n(m,a.length):w=="string"&&m in a)?e(a[m],d):!1}return cI=c,cI}var uI,s$;function ewe(){if(s$)return uI;s$=1;var e=sY(),t=Gbe(),n=Qbe(),i=B2(),c=n(function(d,m){if(d==null)return[];var a=m.length;return a>1&&i(d,m[0],m[1])?m=[]:a>2&&i(m[0],m[1],m[2])&&(m=[m[0]]),t(d,e(m,1),[])});return uI=c,uI}var twe=ewe();const Mz=Wa(twe);function Ww(e){"@babel/helpers - typeof";return Ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(e)}function Ik(){return Ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ik.apply(this,arguments)}function nwe(e,t){return owe(e)||awe(e,t)||iwe(e,t)||rwe()}function rwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iwe(e,t){if(e){if(typeof e=="string")return l$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l$(e,t)}}function l$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function awe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function owe(e){if(Array.isArray(e))return e}function c$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function hI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c$(Object(n),!0).forEach(function(i){swe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function swe(e,t,n){return t=lwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lwe(e){var t=cwe(e,"string");return Ww(t)=="symbol"?t:t+""}function cwe(e,t){if(Ww(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ww(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uwe(e){return Array.isArray(e)&&al(e[0])&&al(e[1])?e.join(" ~ "):e}var hwe=function(t){var n=t.separator,i=n===void 0?" : ":n,c=t.contentStyle,d=c===void 0?{}:c,m=t.itemStyle,a=m===void 0?{}:m,w=t.labelStyle,S=w===void 0?{}:w,M=t.payload,P=t.formatter,N=t.itemSorter,$=t.wrapperClassName,G=t.labelClassName,q=t.label,V=t.labelFormatter,J=t.accessibilityLayer,ee=J===void 0?!1:J,re=function(){if(M&&M.length){var tt={padding:0,margin:0},at=(N?Mz(M,N):M).map(function(ct,ht){if(ct.type==="none")return null;var Ie=hI({display:"block",paddingTop:4,paddingBottom:4,color:ct.color||"#000"},a),rt=ct.formatter||P||uwe,Qe=ct.value,St=ct.name,qe=Qe,vt=St;if(rt&&qe!=null&&vt!=null){var nt=rt(Qe,St,ct,ht,M);if(Array.isArray(nt)){var gt=nwe(nt,2);qe=gt[0],vt=gt[1]}else qe=nt}return Ce.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ht),style:Ie},al(vt)?Ce.createElement("span",{className:"recharts-tooltip-item-name"},vt):null,al(vt)?Ce.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,Ce.createElement("span",{className:"recharts-tooltip-item-value"},qe),Ce.createElement("span",{className:"recharts-tooltip-item-unit"},ct.unit||""))});return Ce.createElement("ul",{className:"recharts-tooltip-item-list",style:tt},at)}return null},fe=hI({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},d),ne=hI({margin:0},S),ce=!ga(q),me=ce?q:"",ve=xa("recharts-default-tooltip",$),De=xa("recharts-tooltip-label",G);ce&&V&&M!==void 0&&M!==null&&(me=V(q,M));var Ye=ee?{role:"status","aria-live":"assertive"}:{};return Ce.createElement("div",Ik({className:ve,style:fe},Ye),Ce.createElement("p",{className:De,style:ne},Ce.isValidElement(me)?me:"".concat(me)),re())};function Xw(e){"@babel/helpers - typeof";return Xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xw(e)}function FT(e,t,n){return t=dwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dwe(e){var t=fwe(e,"string");return Xw(t)=="symbol"?t:t+""}function fwe(e,t){if(Xw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Xw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qb="recharts-tooltip-wrapper",pwe={visibility:"hidden"};function mwe(e){var t=e.coordinate,n=e.translateX,i=e.translateY;return xa(Qb,FT(FT(FT(FT({},"".concat(Qb,"-right"),rr(n)&&t&&rr(t.x)&&n>=t.x),"".concat(Qb,"-left"),rr(n)&&t&&rr(t.x)&&n<t.x),"".concat(Qb,"-bottom"),rr(i)&&t&&rr(t.y)&&i>=t.y),"".concat(Qb,"-top"),rr(i)&&t&&rr(t.y)&&i<t.y))}function u$(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.key,c=e.offsetTopLeft,d=e.position,m=e.reverseDirection,a=e.tooltipDimension,w=e.viewBox,S=e.viewBoxDimension;if(d&&rr(d[i]))return d[i];var M=n[i]-a-c,P=n[i]+c;if(t[i])return m[i]?M:P;if(m[i]){var N=M,$=w[i];return N<$?Math.max(P,w[i]):Math.max(M,w[i])}var G=P+a,q=w[i]+S;return G>q?Math.max(M,w[i]):Math.max(P,w[i])}function gwe(e){var t=e.translateX,n=e.translateY,i=e.useTranslate3d;return{transform:i?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function ywe(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.offsetTopLeft,c=e.position,d=e.reverseDirection,m=e.tooltipBox,a=e.useTranslate3d,w=e.viewBox,S,M,P;return m.height>0&&m.width>0&&n?(M=u$({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:i,position:c,reverseDirection:d,tooltipDimension:m.width,viewBox:w,viewBoxDimension:w.width}),P=u$({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:i,position:c,reverseDirection:d,tooltipDimension:m.height,viewBox:w,viewBoxDimension:w.height}),S=gwe({translateX:M,translateY:P,useTranslate3d:a})):S=pwe,{cssProperties:S,cssClasses:mwe({translateX:M,translateY:P,coordinate:n})}}function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function h$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function d$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h$(Object(n),!0).forEach(function(i){kk(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function _we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vwe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,dY(i.key),i)}}function xwe(e,t,n){return t&&vwe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bwe(e,t,n){return t=qE(t),wwe(e,hY()?Reflect.construct(t,n||[],qE(e).constructor):t.apply(e,n))}function wwe(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Swe(e)}function Swe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hY=function(){return!!e})()}function qE(e){return qE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qE(e)}function Twe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dk(e,t)}function Dk(e,t){return Dk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},Dk(e,t)}function kk(e,t,n){return t=dY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dY(e){var t=Ewe(e,"string");return Xx(t)=="symbol"?t:t+""}function Ewe(e,t){if(Xx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Xx(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var f$=1,Awe=(function(e){function t(){var n;_we(this,t);for(var i=arguments.length,c=new Array(i),d=0;d<i;d++)c[d]=arguments[d];return n=bwe(this,t,[].concat(c)),kk(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),kk(n,"handleKeyDown",function(m){if(m.key==="Escape"){var a,w,S,M;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(w=n.props.coordinate)===null||w===void 0?void 0:w.x)!==null&&a!==void 0?a:0,y:(S=(M=n.props.coordinate)===null||M===void 0?void 0:M.y)!==null&&S!==void 0?S:0}})}}),n}return Twe(t,e),xwe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>f$||Math.abs(i.height-this.state.lastBoundingBox.height)>f$)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,c;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((c=this.props.coordinate)===null||c===void 0?void 0:c.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,c=this.props,d=c.active,m=c.allowEscapeViewBox,a=c.animationDuration,w=c.animationEasing,S=c.children,M=c.coordinate,P=c.hasPayload,N=c.isAnimationActive,$=c.offset,G=c.position,q=c.reverseDirection,V=c.useTranslate3d,J=c.viewBox,ee=c.wrapperStyle,re=ywe({allowEscapeViewBox:m,coordinate:M,offsetTopLeft:$,position:G,reverseDirection:q,tooltipBox:this.state.lastBoundingBox,useTranslate3d:V,viewBox:J}),fe=re.cssClasses,ne=re.cssProperties,ce=d$(d$({transition:N&&d?"transform ".concat(a,"ms ").concat(w):void 0},ne),{},{pointerEvents:"none",visibility:!this.state.dismissed&&d&&P?"visible":"hidden",position:"absolute",top:0,left:0},ee);return Ce.createElement("div",{tabIndex:-1,className:fe,style:ce,ref:function(ve){i.wrapperNode=ve}},S)}}])})(K.PureComponent),Cwe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},D0={isSsr:Cwe()};function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function p$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function m$(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p$(Object(n),!0).forEach(function(i){Pz(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Mwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pwe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,pY(i.key),i)}}function Owe(e,t,n){return t&&Pwe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rwe(e,t,n){return t=HE(t),Iwe(e,fY()?Reflect.construct(t,n||[],HE(e).constructor):t.apply(e,n))}function Iwe(e,t){if(t&&(Zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dwe(e)}function Dwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fY=function(){return!!e})()}function HE(e){return HE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HE(e)}function kwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lk(e,t)}function Lk(e,t){return Lk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},Lk(e,t)}function Pz(e,t,n){return t=pY(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pY(e){var t=Lwe(e,"string");return Zx(t)=="symbol"?t:t+""}function Lwe(e,t){if(Zx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Zx(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Nwe(e){return e.dataKey}function zwe(e,t){return Ce.isValidElement(e)?Ce.cloneElement(e,t):typeof e=="function"?Ce.createElement(e,t):Ce.createElement(hwe,t)}var tp=(function(e){function t(){return Mwe(this,t),Rwe(this,t,arguments)}return kwe(t,e),Owe(t,[{key:"render",value:function(){var i=this,c=this.props,d=c.active,m=c.allowEscapeViewBox,a=c.animationDuration,w=c.animationEasing,S=c.content,M=c.coordinate,P=c.filterNull,N=c.isAnimationActive,$=c.offset,G=c.payload,q=c.payloadUniqBy,V=c.position,J=c.reverseDirection,ee=c.useTranslate3d,re=c.viewBox,fe=c.wrapperStyle,ne=G??[];P&&ne.length&&(ne=iY(G.filter(function(me){return me.value!=null&&(me.hide!==!0||i.props.includeHidden)}),q,Nwe));var ce=ne.length>0;return Ce.createElement(Awe,{allowEscapeViewBox:m,animationDuration:a,animationEasing:w,isAnimationActive:N,active:d,coordinate:M,hasPayload:ce,offset:$,position:V,reverseDirection:J,useTranslate3d:ee,viewBox:re,wrapperStyle:fe},zwe(S,m$(m$({},this.props),{},{payload:ne})))}}])})(K.PureComponent);Pz(tp,"displayName","Tooltip");Pz(tp,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!D0.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var dI,g$;function jwe(){if(g$)return dI;g$=1;var e=bp(),t=function(){return e.Date.now()};return dI=t,dI}var fI,y$;function Bwe(){if(y$)return fI;y$=1;var e=/\s/;function t(n){for(var i=n.length;i--&&e.test(n.charAt(i)););return i}return fI=t,fI}var pI,_$;function Fwe(){if(_$)return pI;_$=1;var e=Bwe(),t=/^\s+/;function n(i){return i&&i.slice(0,e(i)+1).replace(t,"")}return pI=n,pI}var mI,v$;function mY(){if(v$)return mI;v$=1;var e=Fwe(),t=_y(),n=P0(),i=NaN,c=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,m=/^0o[0-7]+$/i,a=parseInt;function w(S){if(typeof S=="number")return S;if(n(S))return i;if(t(S)){var M=typeof S.valueOf=="function"?S.valueOf():S;S=t(M)?M+"":M}if(typeof S!="string")return S===0?S:+S;S=e(S);var P=d.test(S);return P||m.test(S)?a(S.slice(2),P?2:8):c.test(S)?i:+S}return mI=w,mI}var gI,x$;function Vwe(){if(x$)return gI;x$=1;var e=_y(),t=jwe(),n=mY(),i="Expected a function",c=Math.max,d=Math.min;function m(a,w,S){var M,P,N,$,G,q,V=0,J=!1,ee=!1,re=!0;if(typeof a!="function")throw new TypeError(i);w=n(w)||0,e(S)&&(J=!!S.leading,ee="maxWait"in S,N=ee?c(n(S.maxWait)||0,w):N,re="trailing"in S?!!S.trailing:re);function fe(at){var ct=M,ht=P;return M=P=void 0,V=at,$=a.apply(ht,ct),$}function ne(at){return V=at,G=setTimeout(ve,w),J?fe(at):$}function ce(at){var ct=at-q,ht=at-V,Ie=w-ct;return ee?d(Ie,N-ht):Ie}function me(at){var ct=at-q,ht=at-V;return q===void 0||ct>=w||ct<0||ee&&ht>=N}function ve(){var at=t();if(me(at))return De(at);G=setTimeout(ve,ce(at))}function De(at){return G=void 0,re&&M?fe(at):(M=P=void 0,$)}function Ye(){G!==void 0&&clearTimeout(G),V=0,M=q=P=G=void 0}function ze(){return G===void 0?$:De(t())}function tt(){var at=t(),ct=me(at);if(M=arguments,P=this,q=at,ct){if(G===void 0)return ne(q);if(ee)return clearTimeout(G),G=setTimeout(ve,w),fe(q)}return G===void 0&&(G=setTimeout(ve,w)),$}return tt.cancel=Ye,tt.flush=ze,tt}return gI=m,gI}var yI,b$;function Uwe(){if(b$)return yI;b$=1;var e=Vwe(),t=_y(),n="Expected a function";function i(c,d,m){var a=!0,w=!0;if(typeof c!="function")throw new TypeError(n);return t(m)&&(a="leading"in m?!!m.leading:a,w="trailing"in m?!!m.trailing:w),e(c,d,{leading:a,maxWait:d,trailing:w})}return yI=i,yI}var $we=Uwe();const gY=Wa($we);function Zw(e){"@babel/helpers - typeof";return Zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zw(e)}function w$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function VT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w$(Object(n),!0).forEach(function(i){qwe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function qwe(e,t,n){return t=Hwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hwe(e){var t=Gwe(e,"string");return Zw(t)=="symbol"?t:t+""}function Gwe(e,t){if(Zw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Zw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wwe(e,t){return Kwe(e)||Ywe(e,t)||Zwe(e,t)||Xwe()}function Xwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zwe(e,t){if(e){if(typeof e=="string")return S$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S$(e,t)}}function S$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ywe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function Kwe(e){if(Array.isArray(e))return e}var Jwe=K.forwardRef(function(e,t){var n=e.aspect,i=e.initialDimension,c=i===void 0?{width:-1,height:-1}:i,d=e.width,m=d===void 0?"100%":d,a=e.height,w=a===void 0?"100%":a,S=e.minWidth,M=S===void 0?0:S,P=e.minHeight,N=e.maxHeight,$=e.children,G=e.debounce,q=G===void 0?0:G,V=e.id,J=e.className,ee=e.onResize,re=e.style,fe=re===void 0?{}:re,ne=K.useRef(null),ce=K.useRef();ce.current=ee,K.useImperativeHandle(t,function(){return Object.defineProperty(ne.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ne.current},configurable:!0})});var me=K.useState({containerWidth:c.width,containerHeight:c.height}),ve=Wwe(me,2),De=ve[0],Ye=ve[1],ze=K.useCallback(function(at,ct){Ye(function(ht){var Ie=Math.round(at),rt=Math.round(ct);return ht.containerWidth===Ie&&ht.containerHeight===rt?ht:{containerWidth:Ie,containerHeight:rt}})},[]);K.useEffect(function(){var at=function(St){var qe,vt=St[0].contentRect,nt=vt.width,gt=vt.height;ze(nt,gt),(qe=ce.current)===null||qe===void 0||qe.call(ce,nt,gt)};q>0&&(at=gY(at,q,{trailing:!0,leading:!1}));var ct=new ResizeObserver(at),ht=ne.current.getBoundingClientRect(),Ie=ht.width,rt=ht.height;return ze(Ie,rt),ct.observe(ne.current),function(){ct.disconnect()}},[ze,q]);var tt=K.useMemo(function(){var at=De.containerWidth,ct=De.containerHeight;if(at<0||ct<0)return null;km(z_(m)||z_(w),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,m,w),km(!n||n>0,"The aspect(%s) must be greater than zero.",n);var ht=z_(m)?at:m,Ie=z_(w)?ct:w;n&&n>0&&(ht?Ie=ht/n:Ie&&(ht=Ie*n),N&&Ie>N&&(Ie=N)),km(ht>0||Ie>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ht,Ie,m,w,M,P,n);var rt=!Array.isArray($)&&Dm($.type).endsWith("Chart");return Ce.Children.map($,function(Qe){return Ce.isValidElement(Qe)?K.cloneElement(Qe,VT({width:ht,height:Ie},rt?{style:VT({height:"100%",width:"100%",maxHeight:Ie,maxWidth:ht},Qe.props.style)}:{})):Qe})},[n,$,w,N,P,M,De,m]);return Ce.createElement("div",{id:V?"".concat(V):void 0,className:xa("recharts-responsive-container",J),style:VT(VT({},fe),{},{width:m,height:w,minWidth:M,minHeight:P,maxHeight:N}),ref:ne},tt)}),yY=function(t){return null};yY.displayName="Cell";function Yw(e){"@babel/helpers - typeof";return Yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yw(e)}function T$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Nk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?T$(Object(n),!0).forEach(function(i){Qwe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T$(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Qwe(e,t,n){return t=e1e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e1e(e){var t=t1e(e,"string");return Yw(t)=="symbol"?t:t+""}function t1e(e,t){if(Yw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Yw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hx={widthCache:{},cacheCount:0},n1e=2e3,r1e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},E$="recharts_measurement_span";function i1e(e){var t=Nk({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Mw=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||D0.isSsr)return{width:0,height:0};var i=i1e(n),c=JSON.stringify({text:t,copyStyle:i});if(hx.widthCache[c])return hx.widthCache[c];try{var d=document.getElementById(E$);d||(d=document.createElement("span"),d.setAttribute("id",E$),d.setAttribute("aria-hidden","true"),document.body.appendChild(d));var m=Nk(Nk({},r1e),i);Object.assign(d.style,m),d.textContent="".concat(t);var a=d.getBoundingClientRect(),w={width:a.width,height:a.height};return hx.widthCache[c]=w,++hx.cacheCount>n1e&&(hx.cacheCount=0,hx.widthCache={}),w}catch{return{width:0,height:0}}},a1e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Kw(e){"@babel/helpers - typeof";return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kw(e)}function GE(e,t){return c1e(e)||l1e(e,t)||s1e(e,t)||o1e()}function o1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s1e(e,t){if(e){if(typeof e=="string")return A$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A$(e,t)}}function A$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l1e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;w=!1}else for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function c1e(e){if(Array.isArray(e))return e}function u1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C$(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d1e(i.key),i)}}function h1e(e,t,n){return t&&C$(e.prototype,t),n&&C$(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d1e(e){var t=f1e(e,"string");return Kw(t)=="symbol"?t:t+""}function f1e(e,t){if(Kw(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Kw(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var M$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,P$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,p1e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,m1e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,_Y={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},g1e=Object.keys(_Y),Tx="NaN";function y1e(e,t){return e*_Y[t]}var UT=(function(){function e(t,n){u1e(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!p1e.test(n)&&(this.num=NaN,this.unit=""),g1e.includes(n)&&(this.num=y1e(t,n),this.unit="px")}return h1e(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var i,c=(i=m1e.exec(n))!==null&&i!==void 0?i:[],d=GE(c,3),m=d[1],a=d[2];return new e(parseFloat(m),a??"")}}])})();function vY(e){if(e.includes(Tx))return Tx;for(var t=e;t.includes("*")||t.includes("/");){var n,i=(n=M$.exec(t))!==null&&n!==void 0?n:[],c=GE(i,4),d=c[1],m=c[2],a=c[3],w=UT.parse(d??""),S=UT.parse(a??""),M=m==="*"?w.multiply(S):w.divide(S);if(M.isNaN())return Tx;t=t.replace(M$,M.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var P,N=(P=P$.exec(t))!==null&&P!==void 0?P:[],$=GE(N,4),G=$[1],q=$[2],V=$[3],J=UT.parse(G??""),ee=UT.parse(V??""),re=q==="+"?J.add(ee):J.subtract(ee);if(re.isNaN())return Tx;t=t.replace(P$,re.toString())}return t}var O$=/\(([^()]*)\)/;function _1e(e){for(var t=e;t.includes("(");){var n=O$.exec(t),i=GE(n,2),c=i[1];t=t.replace(O$,vY(c))}return t}function v1e(e){var t=e.replace(/\s+/g,"");return t=_1e(t),t=vY(t),t}function x1e(e){try{return v1e(e)}catch{return Tx}}function _I(e){var t=x1e(e.slice(5,-1));return t===Tx?"":t}var b1e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],w1e=["dx","dy","angle","className","breakAll"];function zk(){return zk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},zk.apply(this,arguments)}function R$(e,t){if(e==null)return{};var n=S1e(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function S1e(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function I$(e,t){return C1e(e)||A1e(e,t)||E1e(e,t)||T1e()}function T1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E1e(e,t){if(e){if(typeof e=="string")return D$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D$(e,t)}}function D$(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function A1e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;w=!1}else for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function C1e(e){if(Array.isArray(e))return e}var xY=/[ \f\n\r\t\v\u2028\u2029]+/,bY=function(t){var n=t.children,i=t.breakAll,c=t.style;try{var d=[];ga(n)||(i?d=n.toString().split(""):d=n.toString().split(xY));var m=d.map(function(w){return{word:w,width:Mw(w,c).width}}),a=i?0:Mw("",c).width;return{wordsWithComputedWidth:m,spaceWidth:a}}catch{return null}},M1e=function(t,n,i,c,d){var m=t.maxLines,a=t.children,w=t.style,S=t.breakAll,M=rr(m),P=a,N=function(){var ht=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ht.reduce(function(Ie,rt){var Qe=rt.word,St=rt.width,qe=Ie[Ie.length-1];if(qe&&(c==null||d||qe.width+St+i<Number(c)))qe.words.push(Qe),qe.width+=St+i;else{var vt={words:[Qe],width:St};Ie.push(vt)}return Ie},[])},$=N(n),G=function(ht){return ht.reduce(function(Ie,rt){return Ie.width>rt.width?Ie:rt})};if(!M)return $;for(var q="",V=function(ht){var Ie=P.slice(0,ht),rt=bY({breakAll:S,style:w,children:Ie+q}).wordsWithComputedWidth,Qe=N(rt),St=Qe.length>m||G(Qe).width>Number(c);return[St,Qe]},J=0,ee=P.length-1,re=0,fe;J<=ee&&re<=P.length-1;){var ne=Math.floor((J+ee)/2),ce=ne-1,me=V(ce),ve=I$(me,2),De=ve[0],Ye=ve[1],ze=V(ne),tt=I$(ze,1),at=tt[0];if(!De&&!at&&(J=ne+1),De&&at&&(ee=ne-1),!De&&at){fe=Ye;break}re++}return fe||$},k$=function(t){var n=ga(t)?[]:t.toString().split(xY);return[{words:n}]},P1e=function(t){var n=t.width,i=t.scaleToFit,c=t.children,d=t.style,m=t.breakAll,a=t.maxLines;if((n||i)&&!D0.isSsr){var w,S,M=bY({breakAll:m,children:c,style:d});if(M){var P=M.wordsWithComputedWidth,N=M.spaceWidth;w=P,S=N}else return k$(c);return M1e({breakAll:m,children:c,maxLines:a,style:d},w,S,n,i)}return k$(c)},L$="#808080",WE=function(t){var n=t.x,i=n===void 0?0:n,c=t.y,d=c===void 0?0:c,m=t.lineHeight,a=m===void 0?"1em":m,w=t.capHeight,S=w===void 0?"0.71em":w,M=t.scaleToFit,P=M===void 0?!1:M,N=t.textAnchor,$=N===void 0?"start":N,G=t.verticalAnchor,q=G===void 0?"end":G,V=t.fill,J=V===void 0?L$:V,ee=R$(t,b1e),re=K.useMemo(function(){return P1e({breakAll:ee.breakAll,children:ee.children,maxLines:ee.maxLines,scaleToFit:P,style:ee.style,width:ee.width})},[ee.breakAll,ee.children,ee.maxLines,P,ee.style,ee.width]),fe=ee.dx,ne=ee.dy,ce=ee.angle,me=ee.className,ve=ee.breakAll,De=R$(ee,w1e);if(!al(i)||!al(d))return null;var Ye=i+(rr(fe)?fe:0),ze=d+(rr(ne)?ne:0),tt;switch(q){case"start":tt=_I("calc(".concat(S,")"));break;case"middle":tt=_I("calc(".concat((re.length-1)/2," * -").concat(a," + (").concat(S," / 2))"));break;default:tt=_I("calc(".concat(re.length-1," * -").concat(a,")"));break}var at=[];if(P){var ct=re[0].width,ht=ee.width;at.push("scale(".concat((rr(ht)?ht/ct:1)/ct,")"))}return ce&&at.push("rotate(".concat(ce,", ").concat(Ye,", ").concat(ze,")")),at.length&&(De.transform=at.join(" ")),Ce.createElement("text",zk({},ha(De,!0),{x:Ye,y:ze,className:xa("recharts-text",me),textAnchor:$,fill:J.includes("url")?L$:J}),re.map(function(Ie,rt){var Qe=Ie.words.join(ve?"":" ");return Ce.createElement("tspan",{x:Ye,dy:rt===0?tt:a,key:"".concat(Qe,"-").concat(rt)},Qe)}))};function sy(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function O1e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Oz(e){let t,n,i;e.length!==2?(t=sy,n=(a,w)=>sy(e(a),w),i=(a,w)=>e(a)-w):(t=e===sy||e===O1e?e:R1e,n=e,i=e);function c(a,w,S=0,M=a.length){if(S<M){if(t(w,w)!==0)return M;do{const P=S+M>>>1;n(a[P],w)<0?S=P+1:M=P}while(S<M)}return S}function d(a,w,S=0,M=a.length){if(S<M){if(t(w,w)!==0)return M;do{const P=S+M>>>1;n(a[P],w)<=0?S=P+1:M=P}while(S<M)}return S}function m(a,w,S=0,M=a.length){const P=c(a,w,S,M-1);return P>S&&i(a[P-1],w)>-i(a[P],w)?P-1:P}return{left:c,center:m,right:d}}function R1e(){return 0}function wY(e){return e===null?NaN:+e}function*I1e(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const D1e=Oz(sy),iS=D1e.right;Oz(wY).center;class N$ extends Map{constructor(t,n=N1e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,c]of t)this.set(i,c)}get(t){return super.get(z$(this,t))}has(t){return super.has(z$(this,t))}set(t,n){return super.set(k1e(this,t),n)}delete(t){return super.delete(L1e(this,t))}}function z$({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function k1e({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function L1e({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function N1e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function z1e(e=sy){if(e===sy)return SY;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function SY(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const j1e=Math.sqrt(50),B1e=Math.sqrt(10),F1e=Math.sqrt(2);function XE(e,t,n){const i=(t-e)/Math.max(0,n),c=Math.floor(Math.log10(i)),d=i/Math.pow(10,c),m=d>=j1e?10:d>=B1e?5:d>=F1e?2:1;let a,w,S;return c<0?(S=Math.pow(10,-c)/m,a=Math.round(e*S),w=Math.round(t*S),a/S<e&&++a,w/S>t&&--w,S=-S):(S=Math.pow(10,c)*m,a=Math.round(e/S),w=Math.round(t/S),a*S<e&&++a,w*S>t&&--w),w<a&&.5<=n&&n<2?XE(e,t,n*2):[a,w,S]}function jk(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[c,d,m]=i?XE(t,e,n):XE(e,t,n);if(!(d>=c))return[];const a=d-c+1,w=new Array(a);if(i)if(m<0)for(let S=0;S<a;++S)w[S]=(d-S)/-m;else for(let S=0;S<a;++S)w[S]=(d-S)*m;else if(m<0)for(let S=0;S<a;++S)w[S]=(c+S)/-m;else for(let S=0;S<a;++S)w[S]=(c+S)*m;return w}function Bk(e,t,n){return t=+t,e=+e,n=+n,XE(e,t,n)[2]}function Fk(e,t,n){t=+t,e=+e,n=+n;const i=t<e,c=i?Bk(t,e,n):Bk(e,t,n);return(i?-1:1)*(c<0?1/-c:c)}function j$(e,t){let n;for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function B$(e,t){let n;for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function TY(e,t,n=0,i=1/0,c){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(c=c===void 0?SY:z1e(c);i>n;){if(i-n>600){const w=i-n+1,S=t-n+1,M=Math.log(w),P=.5*Math.exp(2*M/3),N=.5*Math.sqrt(M*P*(w-P)/w)*(S-w/2<0?-1:1),$=Math.max(n,Math.floor(t-S*P/w+N)),G=Math.min(i,Math.floor(t+(w-S)*P/w+N));TY(e,t,$,G,c)}const d=e[t];let m=n,a=i;for(ew(e,n,t),c(e[i],d)>0&&ew(e,n,i);m<a;){for(ew(e,m,a),++m,--a;c(e[m],d)<0;)++m;for(;c(e[a],d)>0;)--a}c(e[n],d)===0?ew(e,n,a):(++a,ew(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function ew(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function V1e(e,t,n){if(e=Float64Array.from(I1e(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return B$(e);if(t>=1)return j$(e);var i,c=(i-1)*t,d=Math.floor(c),m=j$(TY(e,d).subarray(0,d+1)),a=B$(e.subarray(d+1));return m+(a-m)*(c-d)}}function U1e(e,t,n=wY){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,c=(i-1)*t,d=Math.floor(c),m=+n(e[d],d,e),a=+n(e[d+1],d+1,e);return m+(a-m)*(c-d)}}function $1e(e,t,n){e=+e,t=+t,n=(c=arguments.length)<2?(t=e,e=0,1):c<3?1:+n;for(var i=-1,c=Math.max(0,Math.ceil((t-e)/n))|0,d=new Array(c);++i<c;)d[i]=e+i*n;return d}function ed(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Xm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Vk=Symbol("implicit");function Rz(){var e=new N$,t=[],n=[],i=Vk;function c(d){let m=e.get(d);if(m===void 0){if(i!==Vk)return i;e.set(d,m=t.push(d)-1)}return n[m%n.length]}return c.domain=function(d){if(!arguments.length)return t.slice();t=[],e=new N$;for(const m of d)e.has(m)||e.set(m,t.push(m)-1);return c},c.range=function(d){return arguments.length?(n=Array.from(d),c):n.slice()},c.unknown=function(d){return arguments.length?(i=d,c):i},c.copy=function(){return Rz(t,n).unknown(i)},ed.apply(c,arguments),c}function Jw(){var e=Rz().unknown(void 0),t=e.domain,n=e.range,i=0,c=1,d,m,a=!1,w=0,S=0,M=.5;delete e.unknown;function P(){var N=t().length,$=c<i,G=$?c:i,q=$?i:c;d=(q-G)/Math.max(1,N-w+S*2),a&&(d=Math.floor(d)),G+=(q-G-d*(N-w))*M,m=d*(1-w),a&&(G=Math.round(G),m=Math.round(m));var V=$1e(N).map(function(J){return G+d*J});return n($?V.reverse():V)}return e.domain=function(N){return arguments.length?(t(N),P()):t()},e.range=function(N){return arguments.length?([i,c]=N,i=+i,c=+c,P()):[i,c]},e.rangeRound=function(N){return[i,c]=N,i=+i,c=+c,a=!0,P()},e.bandwidth=function(){return m},e.step=function(){return d},e.round=function(N){return arguments.length?(a=!!N,P()):a},e.padding=function(N){return arguments.length?(w=Math.min(1,S=+N),P()):w},e.paddingInner=function(N){return arguments.length?(w=Math.min(1,N),P()):w},e.paddingOuter=function(N){return arguments.length?(S=+N,P()):S},e.align=function(N){return arguments.length?(M=Math.max(0,Math.min(1,N)),P()):M},e.copy=function(){return Jw(t(),[i,c]).round(a).paddingInner(w).paddingOuter(S).align(M)},ed.apply(P(),arguments)}function EY(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return EY(t())},e}function Pw(){return EY(Jw.apply(null,arguments).paddingInner(1))}function Iz(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function AY(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function aS(){}var Qw=.7,ZE=1/Qw,Lx="\\s*([+-]?\\d+)\\s*",e1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",q1e=/^#([0-9a-f]{3,8})$/,H1e=new RegExp(`^rgb\\(${Lx},${Lx},${Lx}\\)$`),G1e=new RegExp(`^rgb\\(${dp},${dp},${dp}\\)$`),W1e=new RegExp(`^rgba\\(${Lx},${Lx},${Lx},${e1}\\)$`),X1e=new RegExp(`^rgba\\(${dp},${dp},${dp},${e1}\\)$`),Z1e=new RegExp(`^hsl\\(${e1},${dp},${dp}\\)$`),Y1e=new RegExp(`^hsla\\(${e1},${dp},${dp},${e1}\\)$`),F$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Iz(aS,t1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:V$,formatHex:V$,formatHex8:K1e,formatHsl:J1e,formatRgb:U$,toString:U$});function V$(){return this.rgb().formatHex()}function K1e(){return this.rgb().formatHex8()}function J1e(){return CY(this).formatHsl()}function U$(){return this.rgb().formatRgb()}function t1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=q1e.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?$$(t):n===3?new lu(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$T(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$T(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=H1e.exec(e))?new lu(t[1],t[2],t[3],1):(t=G1e.exec(e))?new lu(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=W1e.exec(e))?$T(t[1],t[2],t[3],t[4]):(t=X1e.exec(e))?$T(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Z1e.exec(e))?G$(t[1],t[2]/100,t[3]/100,1):(t=Y1e.exec(e))?G$(t[1],t[2]/100,t[3]/100,t[4]):F$.hasOwnProperty(e)?$$(F$[e]):e==="transparent"?new lu(NaN,NaN,NaN,0):null}function $$(e){return new lu(e>>16&255,e>>8&255,e&255,1)}function $T(e,t,n,i){return i<=0&&(e=t=n=NaN),new lu(e,t,n,i)}function Q1e(e){return e instanceof aS||(e=t1(e)),e?(e=e.rgb(),new lu(e.r,e.g,e.b,e.opacity)):new lu}function Uk(e,t,n,i){return arguments.length===1?Q1e(e):new lu(e,t,n,i??1)}function lu(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Iz(lu,Uk,AY(aS,{brighter(e){return e=e==null?ZE:Math.pow(ZE,e),new lu(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qw:Math.pow(Qw,e),new lu(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new lu(W_(this.r),W_(this.g),W_(this.b),YE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:q$,formatHex:q$,formatHex8:eSe,formatRgb:H$,toString:H$}));function q$(){return`#${j_(this.r)}${j_(this.g)}${j_(this.b)}`}function eSe(){return`#${j_(this.r)}${j_(this.g)}${j_(this.b)}${j_((isNaN(this.opacity)?1:this.opacity)*255)}`}function H$(){const e=YE(this.opacity);return`${e===1?"rgb(":"rgba("}${W_(this.r)}, ${W_(this.g)}, ${W_(this.b)}${e===1?")":`, ${e})`}`}function YE(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function W_(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function j_(e){return e=W_(e),(e<16?"0":"")+e.toString(16)}function G$(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hd(e,t,n,i)}function CY(e){if(e instanceof Hd)return new Hd(e.h,e.s,e.l,e.opacity);if(e instanceof aS||(e=t1(e)),!e)return new Hd;if(e instanceof Hd)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,c=Math.min(t,n,i),d=Math.max(t,n,i),m=NaN,a=d-c,w=(d+c)/2;return a?(t===d?m=(n-i)/a+(n<i)*6:n===d?m=(i-t)/a+2:m=(t-n)/a+4,a/=w<.5?d+c:2-d-c,m*=60):a=w>0&&w<1?0:m,new Hd(m,a,w,e.opacity)}function tSe(e,t,n,i){return arguments.length===1?CY(e):new Hd(e,t,n,i??1)}function Hd(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Iz(Hd,tSe,AY(aS,{brighter(e){return e=e==null?ZE:Math.pow(ZE,e),new Hd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qw:Math.pow(Qw,e),new Hd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,c=2*n-i;return new lu(vI(e>=240?e-240:e+120,c,i),vI(e,c,i),vI(e<120?e+240:e-120,c,i),this.opacity)},clamp(){return new Hd(W$(this.h),qT(this.s),qT(this.l),YE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=YE(this.opacity);return`${e===1?"hsl(":"hsla("}${W$(this.h)}, ${qT(this.s)*100}%, ${qT(this.l)*100}%${e===1?")":`, ${e})`}`}}));function W$(e){return e=(e||0)%360,e<0?e+360:e}function qT(e){return Math.max(0,Math.min(1,e||0))}function vI(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Dz=e=>()=>e;function nSe(e,t){return function(n){return e+n*t}}function rSe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function iSe(e){return(e=+e)==1?MY:function(t,n){return n-t?rSe(t,n,e):Dz(isNaN(t)?n:t)}}function MY(e,t){var n=t-e;return n?nSe(e,n):Dz(isNaN(e)?t:e)}const X$=(function e(t){var n=iSe(t);function i(c,d){var m=n((c=Uk(c)).r,(d=Uk(d)).r),a=n(c.g,d.g),w=n(c.b,d.b),S=MY(c.opacity,d.opacity);return function(M){return c.r=m(M),c.g=a(M),c.b=w(M),c.opacity=S(M),c+""}}return i.gamma=e,i})(1);function aSe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),c;return function(d){for(c=0;c<n;++c)i[c]=e[c]*(1-d)+t[c]*d;return i}}function oSe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sSe(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,c=new Array(i),d=new Array(n),m;for(m=0;m<i;++m)c[m]=k0(e[m],t[m]);for(;m<n;++m)d[m]=t[m];return function(a){for(m=0;m<i;++m)d[m]=c[m](a);return d}}function lSe(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function KE(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function cSe(e,t){var n={},i={},c;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(c in t)c in e?n[c]=k0(e[c],t[c]):i[c]=t[c];return function(d){for(c in n)i[c]=n[c](d);return i}}var $k=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xI=new RegExp($k.source,"g");function uSe(e){return function(){return e}}function hSe(e){return function(t){return e(t)+""}}function dSe(e,t){var n=$k.lastIndex=xI.lastIndex=0,i,c,d,m=-1,a=[],w=[];for(e=e+"",t=t+"";(i=$k.exec(e))&&(c=xI.exec(t));)(d=c.index)>n&&(d=t.slice(n,d),a[m]?a[m]+=d:a[++m]=d),(i=i[0])===(c=c[0])?a[m]?a[m]+=c:a[++m]=c:(a[++m]=null,w.push({i:m,x:KE(i,c)})),n=xI.lastIndex;return n<t.length&&(d=t.slice(n),a[m]?a[m]+=d:a[++m]=d),a.length<2?w[0]?hSe(w[0].x):uSe(t):(t=w.length,function(S){for(var M=0,P;M<t;++M)a[(P=w[M]).i]=P.x(S);return a.join("")})}function k0(e,t){var n=typeof t,i;return t==null||n==="boolean"?Dz(t):(n==="number"?KE:n==="string"?(i=t1(t))?(t=i,X$):dSe:t instanceof t1?X$:t instanceof Date?lSe:oSe(t)?aSe:Array.isArray(t)?sSe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?cSe:KE)(e,t)}function kz(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function fSe(e,t){t===void 0&&(t=e,e=k0);for(var n=0,i=t.length-1,c=t[0],d=new Array(i<0?0:i);n<i;)d[n]=e(c,c=t[++n]);return function(m){var a=Math.max(0,Math.min(i-1,Math.floor(m*=i)));return d[a](m-a)}}function pSe(e){return function(){return e}}function JE(e){return+e}var Z$=[0,1];function Dc(e){return e}function qk(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:pSe(isNaN(t)?NaN:.5)}function mSe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function gSe(e,t,n){var i=e[0],c=e[1],d=t[0],m=t[1];return c<i?(i=qk(c,i),d=n(m,d)):(i=qk(i,c),d=n(d,m)),function(a){return d(i(a))}}function ySe(e,t,n){var i=Math.min(e.length,t.length)-1,c=new Array(i),d=new Array(i),m=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++m<i;)c[m]=qk(e[m],e[m+1]),d[m]=n(t[m],t[m+1]);return function(a){var w=iS(e,a,1,i)-1;return d[w](c[w](a))}}function oS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function F2(){var e=Z$,t=Z$,n=k0,i,c,d,m=Dc,a,w,S;function M(){var N=Math.min(e.length,t.length);return m!==Dc&&(m=mSe(e[0],e[N-1])),a=N>2?ySe:gSe,w=S=null,P}function P(N){return N==null||isNaN(N=+N)?d:(w||(w=a(e.map(i),t,n)))(i(m(N)))}return P.invert=function(N){return m(c((S||(S=a(t,e.map(i),KE)))(N)))},P.domain=function(N){return arguments.length?(e=Array.from(N,JE),M()):e.slice()},P.range=function(N){return arguments.length?(t=Array.from(N),M()):t.slice()},P.rangeRound=function(N){return t=Array.from(N),n=kz,M()},P.clamp=function(N){return arguments.length?(m=N?!0:Dc,M()):m!==Dc},P.interpolate=function(N){return arguments.length?(n=N,M()):n},P.unknown=function(N){return arguments.length?(d=N,P):d},function(N,$){return i=N,c=$,M()}}function Lz(){return F2()(Dc,Dc)}function _Se(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function QE(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Yx(e){return e=QE(Math.abs(e)),e?e[1]:NaN}function vSe(e,t){return function(n,i){for(var c=n.length,d=[],m=0,a=e[0],w=0;c>0&&a>0&&(w+a+1>i&&(a=Math.max(1,i-w)),d.push(n.substring(c-=a,c+a)),!((w+=a+1)>i));)a=e[m=(m+1)%e.length];return d.reverse().join(t)}}function xSe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var bSe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function n1(e){if(!(t=bSe.exec(e)))throw new Error("invalid format: "+e);var t;return new Nz({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}n1.prototype=Nz.prototype;function Nz(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Nz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function wSe(e){e:for(var t=e.length,n=1,i=-1,c;n<t;++n)switch(e[n]){case".":i=c=n;break;case"0":i===0&&(i=n),c=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(c+1):e}var PY;function SSe(e,t){var n=QE(e,t);if(!n)return e+"";var i=n[0],c=n[1],d=c-(PY=Math.max(-8,Math.min(8,Math.floor(c/3)))*3)+1,m=i.length;return d===m?i:d>m?i+new Array(d-m+1).join("0"):d>0?i.slice(0,d)+"."+i.slice(d):"0."+new Array(1-d).join("0")+QE(e,Math.max(0,t+d-1))[0]}function Y$(e,t){var n=QE(e,t);if(!n)return e+"";var i=n[0],c=n[1];return c<0?"0."+new Array(-c).join("0")+i:i.length>c+1?i.slice(0,c+1)+"."+i.slice(c+1):i+new Array(c-i.length+2).join("0")}const K$={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:_Se,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Y$(e*100,t),r:Y$,s:SSe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function J$(e){return e}var Q$=Array.prototype.map,eq=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function TSe(e){var t=e.grouping===void 0||e.thousands===void 0?J$:vSe(Q$.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",c=e.decimal===void 0?".":e.decimal+"",d=e.numerals===void 0?J$:xSe(Q$.call(e.numerals,String)),m=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",w=e.nan===void 0?"NaN":e.nan+"";function S(P){P=n1(P);var N=P.fill,$=P.align,G=P.sign,q=P.symbol,V=P.zero,J=P.width,ee=P.comma,re=P.precision,fe=P.trim,ne=P.type;ne==="n"?(ee=!0,ne="g"):K$[ne]||(re===void 0&&(re=12),fe=!0,ne="g"),(V||N==="0"&&$==="=")&&(V=!0,N="0",$="=");var ce=q==="$"?n:q==="#"&&/[boxX]/.test(ne)?"0"+ne.toLowerCase():"",me=q==="$"?i:/[%p]/.test(ne)?m:"",ve=K$[ne],De=/[defgprs%]/.test(ne);re=re===void 0?6:/[gprs]/.test(ne)?Math.max(1,Math.min(21,re)):Math.max(0,Math.min(20,re));function Ye(ze){var tt=ce,at=me,ct,ht,Ie;if(ne==="c")at=ve(ze)+at,ze="";else{ze=+ze;var rt=ze<0||1/ze<0;if(ze=isNaN(ze)?w:ve(Math.abs(ze),re),fe&&(ze=wSe(ze)),rt&&+ze==0&&G!=="+"&&(rt=!1),tt=(rt?G==="("?G:a:G==="-"||G==="("?"":G)+tt,at=(ne==="s"?eq[8+PY/3]:"")+at+(rt&&G==="("?")":""),De){for(ct=-1,ht=ze.length;++ct<ht;)if(Ie=ze.charCodeAt(ct),48>Ie||Ie>57){at=(Ie===46?c+ze.slice(ct+1):ze.slice(ct))+at,ze=ze.slice(0,ct);break}}}ee&&!V&&(ze=t(ze,1/0));var Qe=tt.length+ze.length+at.length,St=Qe<J?new Array(J-Qe+1).join(N):"";switch(ee&&V&&(ze=t(St+ze,St.length?J-at.length:1/0),St=""),$){case"<":ze=tt+ze+at+St;break;case"=":ze=tt+St+ze+at;break;case"^":ze=St.slice(0,Qe=St.length>>1)+tt+ze+at+St.slice(Qe);break;default:ze=St+tt+ze+at;break}return d(ze)}return Ye.toString=function(){return P+""},Ye}function M(P,N){var $=S((P=n1(P),P.type="f",P)),G=Math.max(-8,Math.min(8,Math.floor(Yx(N)/3)))*3,q=Math.pow(10,-G),V=eq[8+G/3];return function(J){return $(q*J)+V}}return{format:S,formatPrefix:M}}var HT,zz,OY;ESe({thousands:",",grouping:[3],currency:["$",""]});function ESe(e){return HT=TSe(e),zz=HT.format,OY=HT.formatPrefix,HT}function ASe(e){return Math.max(0,-Yx(Math.abs(e)))}function CSe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Yx(t)/3)))*3-Yx(Math.abs(e)))}function MSe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Yx(t)-Yx(e))+1}function RY(e,t,n,i){var c=Fk(e,t,n),d;switch(i=n1(i??",f"),i.type){case"s":{var m=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(d=CSe(c,m))&&(i.precision=d),OY(i,m)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(d=MSe(c,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=d-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(d=ASe(c))&&(i.precision=d-(i.type==="%")*2);break}}return zz(i)}function xy(e){var t=e.domain;return e.ticks=function(n){var i=t();return jk(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var c=t();return RY(c[0],c[c.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),c=0,d=i.length-1,m=i[c],a=i[d],w,S,M=10;for(a<m&&(S=m,m=a,a=S,S=c,c=d,d=S);M-- >0;){if(S=Bk(m,a,n),S===w)return i[c]=m,i[d]=a,t(i);if(S>0)m=Math.floor(m/S)*S,a=Math.ceil(a/S)*S;else if(S<0)m=Math.ceil(m*S)/S,a=Math.floor(a*S)/S;else break;w=S}return e},e}function eA(){var e=Lz();return e.copy=function(){return oS(e,eA())},ed.apply(e,arguments),xy(e)}function IY(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,JE),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return IY(e).unknown(t)},e=arguments.length?Array.from(e,JE):[0,1],xy(n)}function DY(e,t){e=e.slice();var n=0,i=e.length-1,c=e[n],d=e[i],m;return d<c&&(m=n,n=i,i=m,m=c,c=d,d=m),e[n]=t.floor(c),e[i]=t.ceil(d),e}function tq(e){return Math.log(e)}function nq(e){return Math.exp(e)}function PSe(e){return-Math.log(-e)}function OSe(e){return-Math.exp(-e)}function RSe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ISe(e){return e===10?RSe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function DSe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function rq(e){return(t,n)=>-e(-t,n)}function jz(e){const t=e(tq,nq),n=t.domain;let i=10,c,d;function m(){return c=DSe(i),d=ISe(i),n()[0]<0?(c=rq(c),d=rq(d),e(PSe,OSe)):e(tq,nq),t}return t.base=function(a){return arguments.length?(i=+a,m()):i},t.domain=function(a){return arguments.length?(n(a),m()):n()},t.ticks=a=>{const w=n();let S=w[0],M=w[w.length-1];const P=M<S;P&&([S,M]=[M,S]);let N=c(S),$=c(M),G,q;const V=a==null?10:+a;let J=[];if(!(i%1)&&$-N<V){if(N=Math.floor(N),$=Math.ceil($),S>0){for(;N<=$;++N)for(G=1;G<i;++G)if(q=N<0?G/d(-N):G*d(N),!(q<S)){if(q>M)break;J.push(q)}}else for(;N<=$;++N)for(G=i-1;G>=1;--G)if(q=N>0?G/d(-N):G*d(N),!(q<S)){if(q>M)break;J.push(q)}J.length*2<V&&(J=jk(S,M,V))}else J=jk(N,$,Math.min($-N,V)).map(d);return P?J.reverse():J},t.tickFormat=(a,w)=>{if(a==null&&(a=10),w==null&&(w=i===10?"s":","),typeof w!="function"&&(!(i%1)&&(w=n1(w)).precision==null&&(w.trim=!0),w=zz(w)),a===1/0)return w;const S=Math.max(1,i*a/t.ticks().length);return M=>{let P=M/d(Math.round(c(M)));return P*i<i-.5&&(P*=i),P<=S?w(M):""}},t.nice=()=>n(DY(n(),{floor:a=>d(Math.floor(c(a))),ceil:a=>d(Math.ceil(c(a)))})),t}function kY(){const e=jz(F2()).domain([1,10]);return e.copy=()=>oS(e,kY()).base(e.base()),ed.apply(e,arguments),e}function iq(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function aq(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Bz(e){var t=1,n=e(iq(t),aq(t));return n.constant=function(i){return arguments.length?e(iq(t=+i),aq(t)):t},xy(n)}function LY(){var e=Bz(F2());return e.copy=function(){return oS(e,LY()).constant(e.constant())},ed.apply(e,arguments)}function oq(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function kSe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function LSe(e){return e<0?-e*e:e*e}function Fz(e){var t=e(Dc,Dc),n=1;function i(){return n===1?e(Dc,Dc):n===.5?e(kSe,LSe):e(oq(n),oq(1/n))}return t.exponent=function(c){return arguments.length?(n=+c,i()):n},xy(t)}function Vz(){var e=Fz(F2());return e.copy=function(){return oS(e,Vz()).exponent(e.exponent())},ed.apply(e,arguments),e}function NSe(){return Vz.apply(null,arguments).exponent(.5)}function sq(e){return Math.sign(e)*e*e}function zSe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function NY(){var e=Lz(),t=[0,1],n=!1,i;function c(d){var m=zSe(e(d));return isNaN(m)?i:n?Math.round(m):m}return c.invert=function(d){return e.invert(sq(d))},c.domain=function(d){return arguments.length?(e.domain(d),c):e.domain()},c.range=function(d){return arguments.length?(e.range((t=Array.from(d,JE)).map(sq)),c):t.slice()},c.rangeRound=function(d){return c.range(d).round(!0)},c.round=function(d){return arguments.length?(n=!!d,c):n},c.clamp=function(d){return arguments.length?(e.clamp(d),c):e.clamp()},c.unknown=function(d){return arguments.length?(i=d,c):i},c.copy=function(){return NY(e.domain(),t).round(n).clamp(e.clamp()).unknown(i)},ed.apply(c,arguments),xy(c)}function zY(){var e=[],t=[],n=[],i;function c(){var m=0,a=Math.max(1,t.length);for(n=new Array(a-1);++m<a;)n[m-1]=U1e(e,m/a);return d}function d(m){return m==null||isNaN(m=+m)?i:t[iS(n,m)]}return d.invertExtent=function(m){var a=t.indexOf(m);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},d.domain=function(m){if(!arguments.length)return e.slice();e=[];for(let a of m)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(sy),c()},d.range=function(m){return arguments.length?(t=Array.from(m),c()):t.slice()},d.unknown=function(m){return arguments.length?(i=m,d):i},d.quantiles=function(){return n.slice()},d.copy=function(){return zY().domain(e).range(t).unknown(i)},ed.apply(d,arguments)}function jY(){var e=0,t=1,n=1,i=[.5],c=[0,1],d;function m(w){return w!=null&&w<=w?c[iS(i,w,0,n)]:d}function a(){var w=-1;for(i=new Array(n);++w<n;)i[w]=((w+1)*t-(w-n)*e)/(n+1);return m}return m.domain=function(w){return arguments.length?([e,t]=w,e=+e,t=+t,a()):[e,t]},m.range=function(w){return arguments.length?(n=(c=Array.from(w)).length-1,a()):c.slice()},m.invertExtent=function(w){var S=c.indexOf(w);return S<0?[NaN,NaN]:S<1?[e,i[0]]:S>=n?[i[n-1],t]:[i[S-1],i[S]]},m.unknown=function(w){return arguments.length&&(d=w),m},m.thresholds=function(){return i.slice()},m.copy=function(){return jY().domain([e,t]).range(c).unknown(d)},ed.apply(xy(m),arguments)}function BY(){var e=[.5],t=[0,1],n,i=1;function c(d){return d!=null&&d<=d?t[iS(e,d,0,i)]:n}return c.domain=function(d){return arguments.length?(e=Array.from(d),i=Math.min(e.length,t.length-1),c):e.slice()},c.range=function(d){return arguments.length?(t=Array.from(d),i=Math.min(e.length,t.length-1),c):t.slice()},c.invertExtent=function(d){var m=t.indexOf(d);return[e[m-1],e[m]]},c.unknown=function(d){return arguments.length?(n=d,c):n},c.copy=function(){return BY().domain(e).range(t).unknown(n)},ed.apply(c,arguments)}const bI=new Date,wI=new Date;function ll(e,t,n,i){function c(d){return e(d=arguments.length===0?new Date:new Date(+d)),d}return c.floor=d=>(e(d=new Date(+d)),d),c.ceil=d=>(e(d=new Date(d-1)),t(d,1),e(d),d),c.round=d=>{const m=c(d),a=c.ceil(d);return d-m<a-d?m:a},c.offset=(d,m)=>(t(d=new Date(+d),m==null?1:Math.floor(m)),d),c.range=(d,m,a)=>{const w=[];if(d=c.ceil(d),a=a==null?1:Math.floor(a),!(d<m)||!(a>0))return w;let S;do w.push(S=new Date(+d)),t(d,a),e(d);while(S<d&&d<m);return w},c.filter=d=>ll(m=>{if(m>=m)for(;e(m),!d(m);)m.setTime(m-1)},(m,a)=>{if(m>=m)if(a<0)for(;++a<=0;)for(;t(m,-1),!d(m););else for(;--a>=0;)for(;t(m,1),!d(m););}),n&&(c.count=(d,m)=>(bI.setTime(+d),wI.setTime(+m),e(bI),e(wI),Math.floor(n(bI,wI))),c.every=d=>(d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?c.filter(i?m=>i(m)%d===0:m=>c.count(0,m)%d===0):c)),c}const tA=ll(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);tA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ll(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):tA);tA.range;const Am=1e3,Zh=Am*60,Cm=Zh*60,Um=Cm*24,Uz=Um*7,lq=Um*30,SI=Um*365,B_=ll(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Am)},(e,t)=>(t-e)/Am,e=>e.getUTCSeconds());B_.range;const $z=ll(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Am)},(e,t)=>{e.setTime(+e+t*Zh)},(e,t)=>(t-e)/Zh,e=>e.getMinutes());$z.range;const qz=ll(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Zh)},(e,t)=>(t-e)/Zh,e=>e.getUTCMinutes());qz.range;const Hz=ll(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Am-e.getMinutes()*Zh)},(e,t)=>{e.setTime(+e+t*Cm)},(e,t)=>(t-e)/Cm,e=>e.getHours());Hz.range;const Gz=ll(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Cm)},(e,t)=>(t-e)/Cm,e=>e.getUTCHours());Gz.range;const sS=ll(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Zh)/Um,e=>e.getDate()-1);sS.range;const V2=ll(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Um,e=>e.getUTCDate()-1);V2.range;const FY=ll(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Um,e=>Math.floor(e/Um));FY.range;function uv(e){return ll(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Zh)/Uz)}const U2=uv(0),nA=uv(1),jSe=uv(2),BSe=uv(3),Kx=uv(4),FSe=uv(5),VSe=uv(6);U2.range;nA.range;jSe.range;BSe.range;Kx.range;FSe.range;VSe.range;function hv(e){return ll(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Uz)}const $2=hv(0),rA=hv(1),USe=hv(2),$Se=hv(3),Jx=hv(4),qSe=hv(5),HSe=hv(6);$2.range;rA.range;USe.range;$Se.range;Jx.range;qSe.range;HSe.range;const Wz=ll(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Wz.range;const Xz=ll(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Xz.range;const $m=ll(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());$m.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ll(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});$m.range;const qm=ll(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());qm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ll(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});qm.range;function VY(e,t,n,i,c,d){const m=[[B_,1,Am],[B_,5,5*Am],[B_,15,15*Am],[B_,30,30*Am],[d,1,Zh],[d,5,5*Zh],[d,15,15*Zh],[d,30,30*Zh],[c,1,Cm],[c,3,3*Cm],[c,6,6*Cm],[c,12,12*Cm],[i,1,Um],[i,2,2*Um],[n,1,Uz],[t,1,lq],[t,3,3*lq],[e,1,SI]];function a(S,M,P){const N=M<S;N&&([S,M]=[M,S]);const $=P&&typeof P.range=="function"?P:w(S,M,P),G=$?$.range(S,+M+1):[];return N?G.reverse():G}function w(S,M,P){const N=Math.abs(M-S)/P,$=Oz(([,,V])=>V).right(m,N);if($===m.length)return e.every(Fk(S/SI,M/SI,P));if($===0)return tA.every(Math.max(Fk(S,M,P),1));const[G,q]=m[N/m[$-1][2]<m[$][2]/N?$-1:$];return G.every(q)}return[a,w]}const[GSe,WSe]=VY(qm,Xz,$2,FY,Gz,qz),[XSe,ZSe]=VY($m,Wz,U2,sS,Hz,$z);function TI(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function EI(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function tw(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function YSe(e){var t=e.dateTime,n=e.date,i=e.time,c=e.periods,d=e.days,m=e.shortDays,a=e.months,w=e.shortMonths,S=nw(c),M=rw(c),P=nw(d),N=rw(d),$=nw(m),G=rw(m),q=nw(a),V=rw(a),J=nw(w),ee=rw(w),re={a:rt,A:Qe,b:St,B:qe,c:null,d:pq,e:pq,f:vTe,g:PTe,G:RTe,H:gTe,I:yTe,j:_Te,L:UY,m:xTe,M:bTe,p:vt,q:nt,Q:yq,s:_q,S:wTe,u:STe,U:TTe,V:ETe,w:ATe,W:CTe,x:null,X:null,y:MTe,Y:OTe,Z:ITe,"%":gq},fe={a:gt,A:Ut,b:$t,B:qt,c:null,d:mq,e:mq,f:NTe,g:GTe,G:XTe,H:DTe,I:kTe,j:LTe,L:qY,m:zTe,M:jTe,p:Ht,q:mn,Q:yq,s:_q,S:BTe,u:FTe,U:VTe,V:UTe,w:$Te,W:qTe,x:null,X:null,y:HTe,Y:WTe,Z:ZTe,"%":gq},ne={a:Ye,A:ze,b:tt,B:at,c:ct,d:dq,e:dq,f:dTe,g:hq,G:uq,H:fq,I:fq,j:lTe,L:hTe,m:sTe,M:cTe,p:De,q:oTe,Q:pTe,s:mTe,S:uTe,u:tTe,U:nTe,V:rTe,w:eTe,W:iTe,x:ht,X:Ie,y:hq,Y:uq,Z:aTe,"%":fTe};re.x=ce(n,re),re.X=ce(i,re),re.c=ce(t,re),fe.x=ce(n,fe),fe.X=ce(i,fe),fe.c=ce(t,fe);function ce(en,En){return function(Xn){var cn=[],Jr=-1,mr=0,Cr=en.length,li,hi,so;for(Xn instanceof Date||(Xn=new Date(+Xn));++Jr<Cr;)en.charCodeAt(Jr)===37&&(cn.push(en.slice(mr,Jr)),(hi=cq[li=en.charAt(++Jr)])!=null?li=en.charAt(++Jr):hi=li==="e"?" ":"0",(so=En[li])&&(li=so(Xn,hi)),cn.push(li),mr=Jr+1);return cn.push(en.slice(mr,Jr)),cn.join("")}}function me(en,En){return function(Xn){var cn=tw(1900,void 0,1),Jr=ve(cn,en,Xn+="",0),mr,Cr;if(Jr!=Xn.length)return null;if("Q"in cn)return new Date(cn.Q);if("s"in cn)return new Date(cn.s*1e3+("L"in cn?cn.L:0));if(En&&!("Z"in cn)&&(cn.Z=0),"p"in cn&&(cn.H=cn.H%12+cn.p*12),cn.m===void 0&&(cn.m="q"in cn?cn.q:0),"V"in cn){if(cn.V<1||cn.V>53)return null;"w"in cn||(cn.w=1),"Z"in cn?(mr=EI(tw(cn.y,0,1)),Cr=mr.getUTCDay(),mr=Cr>4||Cr===0?rA.ceil(mr):rA(mr),mr=V2.offset(mr,(cn.V-1)*7),cn.y=mr.getUTCFullYear(),cn.m=mr.getUTCMonth(),cn.d=mr.getUTCDate()+(cn.w+6)%7):(mr=TI(tw(cn.y,0,1)),Cr=mr.getDay(),mr=Cr>4||Cr===0?nA.ceil(mr):nA(mr),mr=sS.offset(mr,(cn.V-1)*7),cn.y=mr.getFullYear(),cn.m=mr.getMonth(),cn.d=mr.getDate()+(cn.w+6)%7)}else("W"in cn||"U"in cn)&&("w"in cn||(cn.w="u"in cn?cn.u%7:"W"in cn?1:0),Cr="Z"in cn?EI(tw(cn.y,0,1)).getUTCDay():TI(tw(cn.y,0,1)).getDay(),cn.m=0,cn.d="W"in cn?(cn.w+6)%7+cn.W*7-(Cr+5)%7:cn.w+cn.U*7-(Cr+6)%7);return"Z"in cn?(cn.H+=cn.Z/100|0,cn.M+=cn.Z%100,EI(cn)):TI(cn)}}function ve(en,En,Xn,cn){for(var Jr=0,mr=En.length,Cr=Xn.length,li,hi;Jr<mr;){if(cn>=Cr)return-1;if(li=En.charCodeAt(Jr++),li===37){if(li=En.charAt(Jr++),hi=ne[li in cq?En.charAt(Jr++):li],!hi||(cn=hi(en,Xn,cn))<0)return-1}else if(li!=Xn.charCodeAt(cn++))return-1}return cn}function De(en,En,Xn){var cn=S.exec(En.slice(Xn));return cn?(en.p=M.get(cn[0].toLowerCase()),Xn+cn[0].length):-1}function Ye(en,En,Xn){var cn=$.exec(En.slice(Xn));return cn?(en.w=G.get(cn[0].toLowerCase()),Xn+cn[0].length):-1}function ze(en,En,Xn){var cn=P.exec(En.slice(Xn));return cn?(en.w=N.get(cn[0].toLowerCase()),Xn+cn[0].length):-1}function tt(en,En,Xn){var cn=J.exec(En.slice(Xn));return cn?(en.m=ee.get(cn[0].toLowerCase()),Xn+cn[0].length):-1}function at(en,En,Xn){var cn=q.exec(En.slice(Xn));return cn?(en.m=V.get(cn[0].toLowerCase()),Xn+cn[0].length):-1}function ct(en,En,Xn){return ve(en,t,En,Xn)}function ht(en,En,Xn){return ve(en,n,En,Xn)}function Ie(en,En,Xn){return ve(en,i,En,Xn)}function rt(en){return m[en.getDay()]}function Qe(en){return d[en.getDay()]}function St(en){return w[en.getMonth()]}function qe(en){return a[en.getMonth()]}function vt(en){return c[+(en.getHours()>=12)]}function nt(en){return 1+~~(en.getMonth()/3)}function gt(en){return m[en.getUTCDay()]}function Ut(en){return d[en.getUTCDay()]}function $t(en){return w[en.getUTCMonth()]}function qt(en){return a[en.getUTCMonth()]}function Ht(en){return c[+(en.getUTCHours()>=12)]}function mn(en){return 1+~~(en.getUTCMonth()/3)}return{format:function(en){var En=ce(en+="",re);return En.toString=function(){return en},En},parse:function(en){var En=me(en+="",!1);return En.toString=function(){return en},En},utcFormat:function(en){var En=ce(en+="",fe);return En.toString=function(){return en},En},utcParse:function(en){var En=me(en+="",!0);return En.toString=function(){return en},En}}}var cq={"-":"",_:" ",0:"0"},Sl=/^\s*\d+/,KSe=/^%/,JSe=/[\\^$*+?|[\]().{}]/g;function Na(e,t,n){var i=e<0?"-":"",c=(i?-e:e)+"",d=c.length;return i+(d<n?new Array(n-d+1).join(t)+c:c)}function QSe(e){return e.replace(JSe,"\\$&")}function nw(e){return new RegExp("^(?:"+e.map(QSe).join("|")+")","i")}function rw(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function eTe(e,t,n){var i=Sl.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function tTe(e,t,n){var i=Sl.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function nTe(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function rTe(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function iTe(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function uq(e,t,n){var i=Sl.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function hq(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function aTe(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function oTe(e,t,n){var i=Sl.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function sTe(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function dq(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function lTe(e,t,n){var i=Sl.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function fq(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function cTe(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function uTe(e,t,n){var i=Sl.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function hTe(e,t,n){var i=Sl.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function dTe(e,t,n){var i=Sl.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function fTe(e,t,n){var i=KSe.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function pTe(e,t,n){var i=Sl.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function mTe(e,t,n){var i=Sl.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function pq(e,t){return Na(e.getDate(),t,2)}function gTe(e,t){return Na(e.getHours(),t,2)}function yTe(e,t){return Na(e.getHours()%12||12,t,2)}function _Te(e,t){return Na(1+sS.count($m(e),e),t,3)}function UY(e,t){return Na(e.getMilliseconds(),t,3)}function vTe(e,t){return UY(e,t)+"000"}function xTe(e,t){return Na(e.getMonth()+1,t,2)}function bTe(e,t){return Na(e.getMinutes(),t,2)}function wTe(e,t){return Na(e.getSeconds(),t,2)}function STe(e){var t=e.getDay();return t===0?7:t}function TTe(e,t){return Na(U2.count($m(e)-1,e),t,2)}function $Y(e){var t=e.getDay();return t>=4||t===0?Kx(e):Kx.ceil(e)}function ETe(e,t){return e=$Y(e),Na(Kx.count($m(e),e)+($m(e).getDay()===4),t,2)}function ATe(e){return e.getDay()}function CTe(e,t){return Na(nA.count($m(e)-1,e),t,2)}function MTe(e,t){return Na(e.getFullYear()%100,t,2)}function PTe(e,t){return e=$Y(e),Na(e.getFullYear()%100,t,2)}function OTe(e,t){return Na(e.getFullYear()%1e4,t,4)}function RTe(e,t){var n=e.getDay();return e=n>=4||n===0?Kx(e):Kx.ceil(e),Na(e.getFullYear()%1e4,t,4)}function ITe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Na(t/60|0,"0",2)+Na(t%60,"0",2)}function mq(e,t){return Na(e.getUTCDate(),t,2)}function DTe(e,t){return Na(e.getUTCHours(),t,2)}function kTe(e,t){return Na(e.getUTCHours()%12||12,t,2)}function LTe(e,t){return Na(1+V2.count(qm(e),e),t,3)}function qY(e,t){return Na(e.getUTCMilliseconds(),t,3)}function NTe(e,t){return qY(e,t)+"000"}function zTe(e,t){return Na(e.getUTCMonth()+1,t,2)}function jTe(e,t){return Na(e.getUTCMinutes(),t,2)}function BTe(e,t){return Na(e.getUTCSeconds(),t,2)}function FTe(e){var t=e.getUTCDay();return t===0?7:t}function VTe(e,t){return Na($2.count(qm(e)-1,e),t,2)}function HY(e){var t=e.getUTCDay();return t>=4||t===0?Jx(e):Jx.ceil(e)}function UTe(e,t){return e=HY(e),Na(Jx.count(qm(e),e)+(qm(e).getUTCDay()===4),t,2)}function $Te(e){return e.getUTCDay()}function qTe(e,t){return Na(rA.count(qm(e)-1,e),t,2)}function HTe(e,t){return Na(e.getUTCFullYear()%100,t,2)}function GTe(e,t){return e=HY(e),Na(e.getUTCFullYear()%100,t,2)}function WTe(e,t){return Na(e.getUTCFullYear()%1e4,t,4)}function XTe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Jx(e):Jx.ceil(e),Na(e.getUTCFullYear()%1e4,t,4)}function ZTe(){return"+0000"}function gq(){return"%"}function yq(e){return+e}function _q(e){return Math.floor(+e/1e3)}var dx,GY,WY;YTe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function YTe(e){return dx=YSe(e),GY=dx.format,dx.parse,WY=dx.utcFormat,dx.utcParse,dx}function KTe(e){return new Date(e)}function JTe(e){return e instanceof Date?+e:+new Date(+e)}function Zz(e,t,n,i,c,d,m,a,w,S){var M=Lz(),P=M.invert,N=M.domain,$=S(".%L"),G=S(":%S"),q=S("%I:%M"),V=S("%I %p"),J=S("%a %d"),ee=S("%b %d"),re=S("%B"),fe=S("%Y");function ne(ce){return(w(ce)<ce?$:a(ce)<ce?G:m(ce)<ce?q:d(ce)<ce?V:i(ce)<ce?c(ce)<ce?J:ee:n(ce)<ce?re:fe)(ce)}return M.invert=function(ce){return new Date(P(ce))},M.domain=function(ce){return arguments.length?N(Array.from(ce,JTe)):N().map(KTe)},M.ticks=function(ce){var me=N();return e(me[0],me[me.length-1],ce??10)},M.tickFormat=function(ce,me){return me==null?ne:S(me)},M.nice=function(ce){var me=N();return(!ce||typeof ce.range!="function")&&(ce=t(me[0],me[me.length-1],ce??10)),ce?N(DY(me,ce)):M},M.copy=function(){return oS(M,Zz(e,t,n,i,c,d,m,a,w,S))},M}function QTe(){return ed.apply(Zz(XSe,ZSe,$m,Wz,U2,sS,Hz,$z,B_,GY).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eEe(){return ed.apply(Zz(GSe,WSe,qm,Xz,$2,V2,Gz,qz,B_,WY).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function q2(){var e=0,t=1,n,i,c,d,m=Dc,a=!1,w;function S(P){return P==null||isNaN(P=+P)?w:m(c===0?.5:(P=(d(P)-n)*c,a?Math.max(0,Math.min(1,P)):P))}S.domain=function(P){return arguments.length?([e,t]=P,n=d(e=+e),i=d(t=+t),c=n===i?0:1/(i-n),S):[e,t]},S.clamp=function(P){return arguments.length?(a=!!P,S):a},S.interpolator=function(P){return arguments.length?(m=P,S):m};function M(P){return function(N){var $,G;return arguments.length?([$,G]=N,m=P($,G),S):[m(0),m(1)]}}return S.range=M(k0),S.rangeRound=M(kz),S.unknown=function(P){return arguments.length?(w=P,S):w},function(P){return d=P,n=P(e),i=P(t),c=n===i?0:1/(i-n),S}}function by(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function XY(){var e=xy(q2()(Dc));return e.copy=function(){return by(e,XY())},Xm.apply(e,arguments)}function ZY(){var e=jz(q2()).domain([1,10]);return e.copy=function(){return by(e,ZY()).base(e.base())},Xm.apply(e,arguments)}function YY(){var e=Bz(q2());return e.copy=function(){return by(e,YY()).constant(e.constant())},Xm.apply(e,arguments)}function Yz(){var e=Fz(q2());return e.copy=function(){return by(e,Yz()).exponent(e.exponent())},Xm.apply(e,arguments)}function tEe(){return Yz.apply(null,arguments).exponent(.5)}function KY(){var e=[],t=Dc;function n(i){if(i!=null&&!isNaN(i=+i))return t((iS(e,i,1)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let c of i)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(sy),n},n.interpolator=function(i){return arguments.length?(t=i,n):t},n.range=function(){return e.map((i,c)=>t(c/(e.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(c,d)=>V1e(e,d/i))},n.copy=function(){return KY(t).domain(e)},Xm.apply(n,arguments)}function H2(){var e=0,t=.5,n=1,i=1,c,d,m,a,w,S=Dc,M,P=!1,N;function $(q){return isNaN(q=+q)?N:(q=.5+((q=+M(q))-d)*(i*q<i*d?a:w),S(P?Math.max(0,Math.min(1,q)):q))}$.domain=function(q){return arguments.length?([e,t,n]=q,c=M(e=+e),d=M(t=+t),m=M(n=+n),a=c===d?0:.5/(d-c),w=d===m?0:.5/(m-d),i=d<c?-1:1,$):[e,t,n]},$.clamp=function(q){return arguments.length?(P=!!q,$):P},$.interpolator=function(q){return arguments.length?(S=q,$):S};function G(q){return function(V){var J,ee,re;return arguments.length?([J,ee,re]=V,S=fSe(q,[J,ee,re]),$):[S(0),S(.5),S(1)]}}return $.range=G(k0),$.rangeRound=G(kz),$.unknown=function(q){return arguments.length?(N=q,$):N},function(q){return M=q,c=q(e),d=q(t),m=q(n),a=c===d?0:.5/(d-c),w=d===m?0:.5/(m-d),i=d<c?-1:1,$}}function JY(){var e=xy(H2()(Dc));return e.copy=function(){return by(e,JY())},Xm.apply(e,arguments)}function QY(){var e=jz(H2()).domain([.1,1,10]);return e.copy=function(){return by(e,QY()).base(e.base())},Xm.apply(e,arguments)}function eK(){var e=Bz(H2());return e.copy=function(){return by(e,eK()).constant(e.constant())},Xm.apply(e,arguments)}function Kz(){var e=Fz(H2());return e.copy=function(){return by(e,Kz()).exponent(e.exponent())},Xm.apply(e,arguments)}function nEe(){return Kz.apply(null,arguments).exponent(.5)}const vq=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Jw,scaleDiverging:JY,scaleDivergingLog:QY,scaleDivergingPow:Kz,scaleDivergingSqrt:nEe,scaleDivergingSymlog:eK,scaleIdentity:IY,scaleImplicit:Vk,scaleLinear:eA,scaleLog:kY,scaleOrdinal:Rz,scalePoint:Pw,scalePow:Vz,scaleQuantile:zY,scaleQuantize:jY,scaleRadial:NY,scaleSequential:XY,scaleSequentialLog:ZY,scaleSequentialPow:Yz,scaleSequentialQuantile:KY,scaleSequentialSqrt:tEe,scaleSequentialSymlog:YY,scaleSqrt:NSe,scaleSymlog:LY,scaleThreshold:BY,scaleTime:QTe,scaleUtc:eEe,tickFormat:RY},Symbol.toStringTag,{value:"Module"}));var AI,xq;function tK(){if(xq)return AI;xq=1;var e=P0();function t(n,i,c){for(var d=-1,m=n.length;++d<m;){var a=n[d],w=i(a);if(w!=null&&(S===void 0?w===w&&!e(w):c(w,S)))var S=w,M=a}return M}return AI=t,AI}var CI,bq;function rEe(){if(bq)return CI;bq=1;function e(t,n){return t>n}return CI=e,CI}var MI,wq;function iEe(){if(wq)return MI;wq=1;var e=tK(),t=rEe(),n=I0();function i(c){return c&&c.length?e(c,n,t):void 0}return MI=i,MI}var aEe=iEe();const ry=Wa(aEe);var PI,Sq;function oEe(){if(Sq)return PI;Sq=1;function e(t,n){return t<n}return PI=e,PI}var OI,Tq;function sEe(){if(Tq)return OI;Tq=1;var e=tK(),t=oEe(),n=I0();function i(c){return c&&c.length?e(c,n,t):void 0}return OI=i,OI}var lEe=sEe();const G2=Wa(lEe);var RI,Eq;function cEe(){if(Eq)return RI;Eq=1;var e=fz(),t=vy(),n=cY(),i=du();function c(d,m){var a=i(d)?e:n;return a(d,t(m,3))}return RI=c,RI}var II,Aq;function uEe(){if(Aq)return II;Aq=1;var e=sY(),t=cEe();function n(i,c){return e(t(i,c),1)}return II=n,II}var hEe=uEe();const dEe=Wa(hEe);var DI,Cq;function fEe(){if(Cq)return DI;Cq=1;var e=Az();function t(n,i){return e(n,i)}return DI=t,DI}var pEe=fEe();const r1=Wa(pEe);var L0=1e9,mEe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Qz,Go=!0,Qh="[DecimalError] ",X_=Qh+"Invalid argument: ",Jz=Qh+"Exponent out of range: ",N0=Math.floor,I_=Math.pow,gEe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,th,bl=1e7,No=7,nK=9007199254740991,iA=N0(nK/No),Rr={};Rr.absoluteValue=Rr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Rr.comparedTo=Rr.cmp=function(e){var t,n,i,c,d=this;if(e=new d.constructor(e),d.s!==e.s)return d.s||-e.s;if(d.e!==e.e)return d.e>e.e^d.s<0?1:-1;for(i=d.d.length,c=e.d.length,t=0,n=i<c?i:c;t<n;++t)if(d.d[t]!==e.d[t])return d.d[t]>e.d[t]^d.s<0?1:-1;return i===c?0:i>c^d.s<0?1:-1};Rr.decimalPlaces=Rr.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*No;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Rr.dividedBy=Rr.div=function(e){return Lm(this,new this.constructor(e))};Rr.dividedToIntegerBy=Rr.idiv=function(e){var t=this,n=t.constructor;return go(Lm(t,new n(e),0,1),n.precision)};Rr.equals=Rr.eq=function(e){return!this.cmp(e)};Rr.exponent=function(){return $s(this)};Rr.greaterThan=Rr.gt=function(e){return this.cmp(e)>0};Rr.greaterThanOrEqualTo=Rr.gte=function(e){return this.cmp(e)>=0};Rr.isInteger=Rr.isint=function(){return this.e>this.d.length-2};Rr.isNegative=Rr.isneg=function(){return this.s<0};Rr.isPositive=Rr.ispos=function(){return this.s>0};Rr.isZero=function(){return this.s===0};Rr.lessThan=Rr.lt=function(e){return this.cmp(e)<0};Rr.lessThanOrEqualTo=Rr.lte=function(e){return this.cmp(e)<1};Rr.logarithm=Rr.log=function(e){var t,n=this,i=n.constructor,c=i.precision,d=c+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq(th))throw Error(Qh+"NaN");if(n.s<1)throw Error(Qh+(n.s?"NaN":"-Infinity"));return n.eq(th)?new i(0):(Go=!1,t=Lm(i1(n,d),i1(e,d),d),Go=!0,go(t,c))};Rr.minus=Rr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aK(t,e):rK(t,(e.s=-e.s,e))};Rr.modulo=Rr.mod=function(e){var t,n=this,i=n.constructor,c=i.precision;if(e=new i(e),!e.s)throw Error(Qh+"NaN");return n.s?(Go=!1,t=Lm(n,e,0,1).times(e),Go=!0,n.minus(t)):go(new i(n),c)};Rr.naturalExponential=Rr.exp=function(){return iK(this)};Rr.naturalLogarithm=Rr.ln=function(){return i1(this)};Rr.negated=Rr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Rr.plus=Rr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?rK(t,e):aK(t,(e.s=-e.s,e))};Rr.precision=Rr.sd=function(e){var t,n,i,c=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(X_+e);if(t=$s(c)+1,i=c.d.length-1,n=i*No+1,i=c.d[i],i){for(;i%10==0;i/=10)n--;for(i=c.d[0];i>=10;i/=10)n++}return e&&t>n?t:n};Rr.squareRoot=Rr.sqrt=function(){var e,t,n,i,c,d,m,a=this,w=a.constructor;if(a.s<1){if(!a.s)return new w(0);throw Error(Qh+"NaN")}for(e=$s(a),Go=!1,c=Math.sqrt(+a),c==0||c==1/0?(t=ip(a.d),(t.length+e)%2==0&&(t+="0"),c=Math.sqrt(t),e=N0((e+1)/2)-(e<0||e%2),c==1/0?t="5e"+e:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new w(t)):i=new w(c.toString()),n=w.precision,c=m=n+3;;)if(d=i,i=d.plus(Lm(a,d,m+2)).times(.5),ip(d.d).slice(0,m)===(t=ip(i.d)).slice(0,m)){if(t=t.slice(m-3,m+1),c==m&&t=="4999"){if(go(d,n+1,0),d.times(d).eq(a)){i=d;break}}else if(t!="9999")break;m+=4}return Go=!0,go(i,n)};Rr.times=Rr.mul=function(e){var t,n,i,c,d,m,a,w,S,M=this,P=M.constructor,N=M.d,$=(e=new P(e)).d;if(!M.s||!e.s)return new P(0);for(e.s*=M.s,n=M.e+e.e,w=N.length,S=$.length,w<S&&(d=N,N=$,$=d,m=w,w=S,S=m),d=[],m=w+S,i=m;i--;)d.push(0);for(i=S;--i>=0;){for(t=0,c=w+i;c>i;)a=d[c]+$[i]*N[c-i-1]+t,d[c--]=a%bl|0,t=a/bl|0;d[c]=(d[c]+t)%bl|0}for(;!d[--m];)d.pop();return t?++n:d.shift(),e.d=d,e.e=n,Go?go(e,P.precision):e};Rr.toDecimalPlaces=Rr.todp=function(e,t){var n=this,i=n.constructor;return n=new i(n),e===void 0?n:(yp(e,0,L0),t===void 0?t=i.rounding:yp(t,0,8),go(n,e+$s(n)+1,t))};Rr.toExponential=function(e,t){var n,i=this,c=i.constructor;return e===void 0?n=ev(i,!0):(yp(e,0,L0),t===void 0?t=c.rounding:yp(t,0,8),i=go(new c(i),e+1,t),n=ev(i,!0,e+1)),n};Rr.toFixed=function(e,t){var n,i,c=this,d=c.constructor;return e===void 0?ev(c):(yp(e,0,L0),t===void 0?t=d.rounding:yp(t,0,8),i=go(new d(c),e+$s(c)+1,t),n=ev(i.abs(),!1,e+$s(i)+1),c.isneg()&&!c.isZero()?"-"+n:n)};Rr.toInteger=Rr.toint=function(){var e=this,t=e.constructor;return go(new t(e),$s(e)+1,t.rounding)};Rr.toNumber=function(){return+this};Rr.toPower=Rr.pow=function(e){var t,n,i,c,d,m,a=this,w=a.constructor,S=12,M=+(e=new w(e));if(!e.s)return new w(th);if(a=new w(a),!a.s){if(e.s<1)throw Error(Qh+"Infinity");return a}if(a.eq(th))return a;if(i=w.precision,e.eq(th))return go(a,i);if(t=e.e,n=e.d.length-1,m=t>=n,d=a.s,m){if((n=M<0?-M:M)<=nK){for(c=new w(th),t=Math.ceil(i/No+4),Go=!1;n%2&&(c=c.times(a),Pq(c.d,t)),n=N0(n/2),n!==0;)a=a.times(a),Pq(a.d,t);return Go=!0,e.s<0?new w(th).div(c):go(c,i)}}else if(d<0)throw Error(Qh+"NaN");return d=d<0&&e.d[Math.max(t,n)]&1?-1:1,a.s=1,Go=!1,c=e.times(i1(a,i+S)),Go=!0,c=iK(c),c.s=d,c};Rr.toPrecision=function(e,t){var n,i,c=this,d=c.constructor;return e===void 0?(n=$s(c),i=ev(c,n<=d.toExpNeg||n>=d.toExpPos)):(yp(e,1,L0),t===void 0?t=d.rounding:yp(t,0,8),c=go(new d(c),e,t),n=$s(c),i=ev(c,e<=n||n<=d.toExpNeg,e)),i};Rr.toSignificantDigits=Rr.tosd=function(e,t){var n=this,i=n.constructor;return e===void 0?(e=i.precision,t=i.rounding):(yp(e,1,L0),t===void 0?t=i.rounding:yp(t,0,8)),go(new i(n),e,t)};Rr.toString=Rr.valueOf=Rr.val=Rr.toJSON=Rr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=$s(e),n=e.constructor;return ev(e,t<=n.toExpNeg||t>=n.toExpPos)};function rK(e,t){var n,i,c,d,m,a,w,S,M=e.constructor,P=M.precision;if(!e.s||!t.s)return t.s||(t=new M(e)),Go?go(t,P):t;if(w=e.d,S=t.d,m=e.e,c=t.e,w=w.slice(),d=m-c,d){for(d<0?(i=w,d=-d,a=S.length):(i=S,c=m,a=w.length),m=Math.ceil(P/No),a=m>a?m+1:a+1,d>a&&(d=a,i.length=1),i.reverse();d--;)i.push(0);i.reverse()}for(a=w.length,d=S.length,a-d<0&&(d=a,i=S,S=w,w=i),n=0;d;)n=(w[--d]=w[d]+S[d]+n)/bl|0,w[d]%=bl;for(n&&(w.unshift(n),++c),a=w.length;w[--a]==0;)w.pop();return t.d=w,t.e=c,Go?go(t,P):t}function yp(e,t,n){if(e!==~~e||e<t||e>n)throw Error(X_+e)}function ip(e){var t,n,i,c=e.length-1,d="",m=e[0];if(c>0){for(d+=m,t=1;t<c;t++)i=e[t]+"",n=No-i.length,n&&(d+=ty(n)),d+=i;m=e[t],i=m+"",n=No-i.length,n&&(d+=ty(n))}else if(m===0)return"0";for(;m%10===0;)m/=10;return d+m}var Lm=(function(){function e(i,c){var d,m=0,a=i.length;for(i=i.slice();a--;)d=i[a]*c+m,i[a]=d%bl|0,m=d/bl|0;return m&&i.unshift(m),i}function t(i,c,d,m){var a,w;if(d!=m)w=d>m?1:-1;else for(a=w=0;a<d;a++)if(i[a]!=c[a]){w=i[a]>c[a]?1:-1;break}return w}function n(i,c,d){for(var m=0;d--;)i[d]-=m,m=i[d]<c[d]?1:0,i[d]=m*bl+i[d]-c[d];for(;!i[0]&&i.length>1;)i.shift()}return function(i,c,d,m){var a,w,S,M,P,N,$,G,q,V,J,ee,re,fe,ne,ce,me,ve,De=i.constructor,Ye=i.s==c.s?1:-1,ze=i.d,tt=c.d;if(!i.s)return new De(i);if(!c.s)throw Error(Qh+"Division by zero");for(w=i.e-c.e,me=tt.length,ne=ze.length,$=new De(Ye),G=$.d=[],S=0;tt[S]==(ze[S]||0);)++S;if(tt[S]>(ze[S]||0)&&--w,d==null?ee=d=De.precision:m?ee=d+($s(i)-$s(c))+1:ee=d,ee<0)return new De(0);if(ee=ee/No+2|0,S=0,me==1)for(M=0,tt=tt[0],ee++;(S<ne||M)&&ee--;S++)re=M*bl+(ze[S]||0),G[S]=re/tt|0,M=re%tt|0;else{for(M=bl/(tt[0]+1)|0,M>1&&(tt=e(tt,M),ze=e(ze,M),me=tt.length,ne=ze.length),fe=me,q=ze.slice(0,me),V=q.length;V<me;)q[V++]=0;ve=tt.slice(),ve.unshift(0),ce=tt[0],tt[1]>=bl/2&&++ce;do M=0,a=t(tt,q,me,V),a<0?(J=q[0],me!=V&&(J=J*bl+(q[1]||0)),M=J/ce|0,M>1?(M>=bl&&(M=bl-1),P=e(tt,M),N=P.length,V=q.length,a=t(P,q,N,V),a==1&&(M--,n(P,me<N?ve:tt,N))):(M==0&&(a=M=1),P=tt.slice()),N=P.length,N<V&&P.unshift(0),n(q,P,V),a==-1&&(V=q.length,a=t(tt,q,me,V),a<1&&(M++,n(q,me<V?ve:tt,V))),V=q.length):a===0&&(M++,q=[0]),G[S++]=M,a&&q[0]?q[V++]=ze[fe]||0:(q=[ze[fe]],V=1);while((fe++<ne||q[0]!==void 0)&&ee--)}return G[0]||G.shift(),$.e=w,go($,m?d+$s($)+1:d)}})();function iK(e,t){var n,i,c,d,m,a,w=0,S=0,M=e.constructor,P=M.precision;if($s(e)>16)throw Error(Jz+$s(e));if(!e.s)return new M(th);for(Go=!1,a=P,m=new M(.03125);e.abs().gte(.1);)e=e.times(m),S+=5;for(i=Math.log(I_(2,S))/Math.LN10*2+5|0,a+=i,n=c=d=new M(th),M.precision=a;;){if(c=go(c.times(e),a),n=n.times(++w),m=d.plus(Lm(c,n,a)),ip(m.d).slice(0,a)===ip(d.d).slice(0,a)){for(;S--;)d=go(d.times(d),a);return M.precision=P,t==null?(Go=!0,go(d,P)):d}d=m}}function $s(e){for(var t=e.e*No,n=e.d[0];n>=10;n/=10)t++;return t}function kI(e,t,n){if(t>e.LN10.sd())throw Go=!0,n&&(e.precision=n),Error(Qh+"LN10 precision limit exceeded");return go(new e(e.LN10),t)}function ty(e){for(var t="";e--;)t+="0";return t}function i1(e,t){var n,i,c,d,m,a,w,S,M,P=1,N=10,$=e,G=$.d,q=$.constructor,V=q.precision;if($.s<1)throw Error(Qh+($.s?"NaN":"-Infinity"));if($.eq(th))return new q(0);if(t==null?(Go=!1,S=V):S=t,$.eq(10))return t==null&&(Go=!0),kI(q,S);if(S+=N,q.precision=S,n=ip(G),i=n.charAt(0),d=$s($),Math.abs(d)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)$=$.times(e),n=ip($.d),i=n.charAt(0),P++;d=$s($),i>1?($=new q("0."+n),d++):$=new q(i+"."+n.slice(1))}else return w=kI(q,S+2,V).times(d+""),$=i1(new q(i+"."+n.slice(1)),S-N).plus(w),q.precision=V,t==null?(Go=!0,go($,V)):$;for(a=m=$=Lm($.minus(th),$.plus(th),S),M=go($.times($),S),c=3;;){if(m=go(m.times(M),S),w=a.plus(Lm(m,new q(c),S)),ip(w.d).slice(0,S)===ip(a.d).slice(0,S))return a=a.times(2),d!==0&&(a=a.plus(kI(q,S+2,V).times(d+""))),a=Lm(a,new q(P),S),q.precision=V,t==null?(Go=!0,go(a,V)):a;a=w,c+=2}}function Mq(e,t){var n,i,c;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length),i=0;t.charCodeAt(i)===48;)++i;for(c=t.length;t.charCodeAt(c-1)===48;)--c;if(t=t.slice(i,c),t){if(c-=i,n=n-i-1,e.e=N0(n/No),e.d=[],i=(n+1)%No,n<0&&(i+=No),i<c){for(i&&e.d.push(+t.slice(0,i)),c-=No;i<c;)e.d.push(+t.slice(i,i+=No));t=t.slice(i),i=No-t.length}else i-=c;for(;i--;)t+="0";if(e.d.push(+t),Go&&(e.e>iA||e.e<-iA))throw Error(Jz+n)}else e.s=0,e.e=0,e.d=[0];return e}function go(e,t,n){var i,c,d,m,a,w,S,M,P=e.d;for(m=1,d=P[0];d>=10;d/=10)m++;if(i=t-m,i<0)i+=No,c=t,S=P[M=0];else{if(M=Math.ceil((i+1)/No),d=P.length,M>=d)return e;for(S=d=P[M],m=1;d>=10;d/=10)m++;i%=No,c=i-No+m}if(n!==void 0&&(d=I_(10,m-c-1),a=S/d%10|0,w=t<0||P[M+1]!==void 0||S%d,w=n<4?(a||w)&&(n==0||n==(e.s<0?3:2)):a>5||a==5&&(n==4||w||n==6&&(i>0?c>0?S/I_(10,m-c):0:P[M-1])%10&1||n==(e.s<0?8:7))),t<1||!P[0])return w?(d=$s(e),P.length=1,t=t-d-1,P[0]=I_(10,(No-t%No)%No),e.e=N0(-t/No)||0):(P.length=1,P[0]=e.e=e.s=0),e;if(i==0?(P.length=M,d=1,M--):(P.length=M+1,d=I_(10,No-i),P[M]=c>0?(S/I_(10,m-c)%I_(10,c)|0)*d:0),w)for(;;)if(M==0){(P[0]+=d)==bl&&(P[0]=1,++e.e);break}else{if(P[M]+=d,P[M]!=bl)break;P[M--]=0,d=1}for(i=P.length;P[--i]===0;)P.pop();if(Go&&(e.e>iA||e.e<-iA))throw Error(Jz+$s(e));return e}function aK(e,t){var n,i,c,d,m,a,w,S,M,P,N=e.constructor,$=N.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new N(e),Go?go(t,$):t;if(w=e.d,P=t.d,i=t.e,S=e.e,w=w.slice(),m=S-i,m){for(M=m<0,M?(n=w,m=-m,a=P.length):(n=P,i=S,a=w.length),c=Math.max(Math.ceil($/No),a)+2,m>c&&(m=c,n.length=1),n.reverse(),c=m;c--;)n.push(0);n.reverse()}else{for(c=w.length,a=P.length,M=c<a,M&&(a=c),c=0;c<a;c++)if(w[c]!=P[c]){M=w[c]<P[c];break}m=0}for(M&&(n=w,w=P,P=n,t.s=-t.s),a=w.length,c=P.length-a;c>0;--c)w[a++]=0;for(c=P.length;c>m;){if(w[--c]<P[c]){for(d=c;d&&w[--d]===0;)w[d]=bl-1;--w[d],w[c]+=bl}w[c]-=P[c]}for(;w[--a]===0;)w.pop();for(;w[0]===0;w.shift())--i;return w[0]?(t.d=w,t.e=i,Go?go(t,$):t):new N(0)}function ev(e,t,n){var i,c=$s(e),d=ip(e.d),m=d.length;return t?(n&&(i=n-m)>0?d=d.charAt(0)+"."+d.slice(1)+ty(i):m>1&&(d=d.charAt(0)+"."+d.slice(1)),d=d+(c<0?"e":"e+")+c):c<0?(d="0."+ty(-c-1)+d,n&&(i=n-m)>0&&(d+=ty(i))):c>=m?(d+=ty(c+1-m),n&&(i=n-c-1)>0&&(d=d+"."+ty(i))):((i=c+1)<m&&(d=d.slice(0,i)+"."+d.slice(i)),n&&(i=n-m)>0&&(c+1===m&&(d+="."),d+=ty(i))),e.s<0?"-"+d:d}function Pq(e,t){if(e.length>t)return e.length=t,!0}function oK(e){var t,n,i;function c(d){var m=this;if(!(m instanceof c))return new c(d);if(m.constructor=c,d instanceof c){m.s=d.s,m.e=d.e,m.d=(d=d.d)?d.slice():d;return}if(typeof d=="number"){if(d*0!==0)throw Error(X_+d);if(d>0)m.s=1;else if(d<0)d=-d,m.s=-1;else{m.s=0,m.e=0,m.d=[0];return}if(d===~~d&&d<1e7){m.e=0,m.d=[d];return}return Mq(m,d.toString())}else if(typeof d!="string")throw Error(X_+d);if(d.charCodeAt(0)===45?(d=d.slice(1),m.s=-1):m.s=1,gEe.test(d))Mq(m,d);else throw Error(X_+d)}if(c.prototype=Rr,c.ROUND_UP=0,c.ROUND_DOWN=1,c.ROUND_CEIL=2,c.ROUND_FLOOR=3,c.ROUND_HALF_UP=4,c.ROUND_HALF_DOWN=5,c.ROUND_HALF_EVEN=6,c.ROUND_HALF_CEIL=7,c.ROUND_HALF_FLOOR=8,c.clone=oK,c.config=c.set=yEe,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return c.config(e),c}function yEe(e){if(!e||typeof e!="object")throw Error(Qh+"Object expected");var t,n,i,c=["precision",1,L0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<c.length;t+=3)if((i=e[n=c[t]])!==void 0)if(N0(i)===i&&i>=c[t+1]&&i<=c[t+2])this[n]=i;else throw Error(X_+n+": "+i);if((i=e[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(X_+n+": "+i);return this}var Qz=oK(mEe);th=new Qz(1);const ao=Qz;function _Ee(e){return wEe(e)||bEe(e)||xEe(e)||vEe()}function vEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xEe(e,t){if(e){if(typeof e=="string")return Hk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hk(e,t)}}function bEe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function wEe(e){if(Array.isArray(e))return Hk(e)}function Hk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var SEe=function(t){return t},sK={},lK=function(t){return t===sK},Oq=function(t){return function n(){return arguments.length===0||arguments.length===1&&lK(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},TEe=function e(t,n){return t===1?n:Oq(function(){for(var i=arguments.length,c=new Array(i),d=0;d<i;d++)c[d]=arguments[d];var m=c.filter(function(a){return a!==sK}).length;return m>=t?n.apply(void 0,c):e(t-m,Oq(function(){for(var a=arguments.length,w=new Array(a),S=0;S<a;S++)w[S]=arguments[S];var M=c.map(function(P){return lK(P)?w.shift():P});return n.apply(void 0,_Ee(M).concat(w))}))})},W2=function(t){return TEe(t.length,t)},Gk=function(t,n){for(var i=[],c=t;c<n;++c)i[c-t]=c;return i},EEe=W2(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),AEe=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.length)return SEe;var c=n.reverse(),d=c[0],m=c.slice(1);return function(){return m.reduce(function(a,w){return w(a)},d.apply(void 0,arguments))}},Wk=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},cK=function(t){var n=null,i=null;return function(){for(var c=arguments.length,d=new Array(c),m=0;m<c;m++)d[m]=arguments[m];return n&&d.every(function(a,w){return a===n[w]})||(n=d,i=t.apply(void 0,d)),i}};function CEe(e){var t;return e===0?t=1:t=Math.floor(new ao(e).abs().log(10).toNumber())+1,t}function MEe(e,t,n){for(var i=new ao(e),c=0,d=[];i.lt(t)&&c<1e5;)d.push(i.toNumber()),i=i.add(n),c++;return d}var PEe=W2(function(e,t,n){var i=+e,c=+t;return i+n*(c-i)}),OEe=W2(function(e,t,n){var i=t-+e;return i=i||1/0,(n-e)/i}),REe=W2(function(e,t,n){var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(n-e)/i))});const X2={rangeStep:MEe,getDigitCount:CEe,interpolateNumber:PEe,uninterpolateNumber:OEe,uninterpolateTruncation:REe};function Xk(e){return kEe(e)||DEe(e)||uK(e)||IEe()}function IEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DEe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function kEe(e){if(Array.isArray(e))return Zk(e)}function a1(e,t){return zEe(e)||NEe(e,t)||uK(e,t)||LEe()}function LEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uK(e,t){if(e){if(typeof e=="string")return Zk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zk(e,t)}}function Zk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function NEe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],i=!0,c=!1,d=void 0;try{for(var m=e[Symbol.iterator](),a;!(i=(a=m.next()).done)&&(n.push(a.value),!(t&&n.length===t));i=!0);}catch(w){c=!0,d=w}finally{try{!i&&m.return!=null&&m.return()}finally{if(c)throw d}}return n}}function zEe(e){if(Array.isArray(e))return e}function hK(e){var t=a1(e,2),n=t[0],i=t[1],c=n,d=i;return n>i&&(c=i,d=n),[c,d]}function dK(e,t,n){if(e.lte(0))return new ao(0);var i=X2.getDigitCount(e.toNumber()),c=new ao(10).pow(i),d=e.div(c),m=i!==1?.05:.1,a=new ao(Math.ceil(d.div(m).toNumber())).add(n).mul(m),w=a.mul(c);return t?w:new ao(Math.ceil(w))}function jEe(e,t,n){var i=1,c=new ao(e);if(!c.isint()&&n){var d=Math.abs(e);d<1?(i=new ao(10).pow(X2.getDigitCount(e)-1),c=new ao(Math.floor(c.div(i).toNumber())).mul(i)):d>1&&(c=new ao(Math.floor(e)))}else e===0?c=new ao(Math.floor((t-1)/2)):n||(c=new ao(Math.floor(e)));var m=Math.floor((t-1)/2),a=AEe(EEe(function(w){return c.add(new ao(w-m).mul(i)).toNumber()}),Gk);return a(0,t)}function fK(e,t,n,i){var c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new ao(0),tickMin:new ao(0),tickMax:new ao(0)};var d=dK(new ao(t).sub(e).div(n-1),i,c),m;e<=0&&t>=0?m=new ao(0):(m=new ao(e).add(t).div(2),m=m.sub(new ao(m).mod(d)));var a=Math.ceil(m.sub(e).div(d).toNumber()),w=Math.ceil(new ao(t).sub(m).div(d).toNumber()),S=a+w+1;return S>n?fK(e,t,n,i,c+1):(S<n&&(w=t>0?w+(n-S):w,a=t>0?a:a+(n-S)),{step:d,tickMin:m.sub(new ao(a).mul(d)),tickMax:m.add(new ao(w).mul(d))})}function BEe(e){var t=a1(e,2),n=t[0],i=t[1],c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,m=Math.max(c,2),a=hK([n,i]),w=a1(a,2),S=w[0],M=w[1];if(S===-1/0||M===1/0){var P=M===1/0?[S].concat(Xk(Gk(0,c-1).map(function(){return 1/0}))):[].concat(Xk(Gk(0,c-1).map(function(){return-1/0})),[M]);return n>i?Wk(P):P}if(S===M)return jEe(S,c,d);var N=fK(S,M,m,d),$=N.step,G=N.tickMin,q=N.tickMax,V=X2.rangeStep(G,q.add(new ao(.1).mul($)),$);return n>i?Wk(V):V}function FEe(e,t){var n=a1(e,2),i=n[0],c=n[1],d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,m=hK([i,c]),a=a1(m,2),w=a[0],S=a[1];if(w===-1/0||S===1/0)return[i,c];if(w===S)return[w];var M=Math.max(t,2),P=dK(new ao(S).sub(w).div(M-1),d,0),N=[].concat(Xk(X2.rangeStep(new ao(w),new ao(S).sub(new ao(.99).mul(P)),P)),[S]);return i>c?Wk(N):N}var VEe=cK(BEe),UEe=cK(FEe),$Ee="Invariant failed";function tv(e,t){throw new Error($Ee)}var qEe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Qx(e){"@babel/helpers - typeof";return Qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qx(e)}function aA(){return aA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},aA.apply(this,arguments)}function HEe(e,t){return ZEe(e)||XEe(e,t)||WEe(e,t)||GEe()}function GEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WEe(e,t){if(e){if(typeof e=="string")return Rq(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rq(e,t)}}function Rq(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function XEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function ZEe(e){if(Array.isArray(e))return e}function YEe(e,t){if(e==null)return{};var n=KEe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function KEe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function JEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function QEe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,gK(i.key),i)}}function eAe(e,t,n){return t&&QEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tAe(e,t,n){return t=oA(t),nAe(e,pK()?Reflect.construct(t,n||[],oA(e).constructor):t.apply(e,n))}function nAe(e,t){if(t&&(Qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rAe(e)}function rAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pK=function(){return!!e})()}function oA(e){return oA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},oA(e)}function iAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yk(e,t)}function Yk(e,t){return Yk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},Yk(e,t)}function mK(e,t,n){return t=gK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gK(e){var t=aAe(e,"string");return Qx(t)=="symbol"?t:t+""}function aAe(e,t){if(Qx(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Qx(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Z2=(function(e){function t(){return JEe(this,t),tAe(this,t,arguments)}return iAe(t,e),eAe(t,[{key:"render",value:function(){var i=this.props,c=i.offset,d=i.layout,m=i.width,a=i.dataKey,w=i.data,S=i.dataPointFormatter,M=i.xAxis,P=i.yAxis,N=YEe(i,qEe),$=ha(N,!1);this.props.direction==="x"&&M.type!=="number"&&tv();var G=w.map(function(q){var V=S(q,a),J=V.x,ee=V.y,re=V.value,fe=V.errorVal;if(!fe)return null;var ne=[],ce,me;if(Array.isArray(fe)){var ve=HEe(fe,2);ce=ve[0],me=ve[1]}else ce=me=fe;if(d==="vertical"){var De=M.scale,Ye=ee+c,ze=Ye+m,tt=Ye-m,at=De(re-ce),ct=De(re+me);ne.push({x1:ct,y1:ze,x2:ct,y2:tt}),ne.push({x1:at,y1:Ye,x2:ct,y2:Ye}),ne.push({x1:at,y1:ze,x2:at,y2:tt})}else if(d==="horizontal"){var ht=P.scale,Ie=J+c,rt=Ie-m,Qe=Ie+m,St=ht(re-ce),qe=ht(re+me);ne.push({x1:rt,y1:qe,x2:Qe,y2:qe}),ne.push({x1:Ie,y1:St,x2:Ie,y2:qe}),ne.push({x1:rt,y1:St,x2:Qe,y2:St})}return Ce.createElement(as,aA({className:"recharts-errorBar",key:"bar-".concat(ne.map(function(vt){return"".concat(vt.x1,"-").concat(vt.x2,"-").concat(vt.y1,"-").concat(vt.y2)}))},$),ne.map(function(vt){return Ce.createElement("line",aA({},vt,{key:"line-".concat(vt.x1,"-").concat(vt.x2,"-").concat(vt.y1,"-").concat(vt.y2)}))}))});return Ce.createElement(as,{className:"recharts-errorBars"},G)}}])})(Ce.Component);mK(Z2,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});mK(Z2,"displayName","ErrorBar");function o1(e){"@babel/helpers - typeof";return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(e)}function Iq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function P_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iq(Object(n),!0).forEach(function(i){oAe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function oAe(e,t,n){return t=sAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sAe(e){var t=lAe(e,"string");return o1(t)=="symbol"?t:t+""}function lAe(e,t){if(o1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(o1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yK=function(t){var n=t.children,i=t.formattedGraphicalItems,c=t.legendWidth,d=t.legendContent,m=Ku(n,kx);if(!m)return null;var a=kx.defaultProps,w=a!==void 0?P_(P_({},a),m.props):{},S;return m.props&&m.props.payload?S=m.props&&m.props.payload:d==="children"?S=(i||[]).reduce(function(M,P){var N=P.item,$=P.props,G=$.sectors||$.data||[];return M.concat(G.map(function(q){return{type:m.props.iconType||N.props.legendType,value:q.name,color:q.fill,payload:q}}))},[]):S=(i||[]).map(function(M){var P=M.item,N=P.type.defaultProps,$=N!==void 0?P_(P_({},N),P.props):{},G=$.dataKey,q=$.name,V=$.legendType,J=$.hide;return{inactive:J,dataKey:G,type:w.iconType||V||"square",color:ej(P),value:q||G,payload:$}}),P_(P_(P_({},w),kx.getWithHeight(m,c)),{},{payload:S,item:m})};function s1(e){"@babel/helpers - typeof";return s1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s1(e)}function Dq(e){return dAe(e)||hAe(e)||uAe(e)||cAe()}function cAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uAe(e,t){if(e){if(typeof e=="string")return Kk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kk(e,t)}}function hAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dAe(e){if(Array.isArray(e))return Kk(e)}function Kk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function kq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function ps(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kq(Object(n),!0).forEach(function(i){Nx(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Nx(e,t,n){return t=fAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fAe(e){var t=pAe(e,"string");return s1(t)=="symbol"?t:t+""}function pAe(e,t){if(s1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(s1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rh(e,t,n){return ga(e)||ga(t)?n:al(t)?Jh(e,t,n):Hi(t)?t(e):n}function Ow(e,t,n,i){var c=dEe(e,function(a){return rh(a,t)});if(n==="number"){var d=c.filter(function(a){return rr(a)||parseFloat(a)});return d.length?[G2(d),ry(d)]:[1/0,-1/0]}var m=i?c.filter(function(a){return!ga(a)}):c;return m.map(function(a){return al(a)||a instanceof Date?a:""})}var mAe=function(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,m=-1,a=(n=i?.length)!==null&&n!==void 0?n:0;if(a<=1)return 0;if(d&&d.axisType==="angleAxis"&&Math.abs(Math.abs(d.range[1]-d.range[0])-360)<=1e-6)for(var w=d.range,S=0;S<a;S++){var M=S>0?c[S-1].coordinate:c[a-1].coordinate,P=c[S].coordinate,N=S>=a-1?c[0].coordinate:c[S+1].coordinate,$=void 0;if(Wd(P-M)!==Wd(N-P)){var G=[];if(Wd(N-P)===Wd(w[1]-w[0])){$=N;var q=P+w[1]-w[0];G[0]=Math.min(q,(q+M)/2),G[1]=Math.max(q,(q+M)/2)}else{$=M;var V=N+w[1]-w[0];G[0]=Math.min(P,(V+P)/2),G[1]=Math.max(P,(V+P)/2)}var J=[Math.min(P,($+P)/2),Math.max(P,($+P)/2)];if(t>J[0]&&t<=J[1]||t>=G[0]&&t<=G[1]){m=c[S].index;break}}else{var ee=Math.min(M,N),re=Math.max(M,N);if(t>(ee+P)/2&&t<=(re+P)/2){m=c[S].index;break}}}else for(var fe=0;fe<a;fe++)if(fe===0&&t<=(i[fe].coordinate+i[fe+1].coordinate)/2||fe>0&&fe<a-1&&t>(i[fe].coordinate+i[fe-1].coordinate)/2&&t<=(i[fe].coordinate+i[fe+1].coordinate)/2||fe===a-1&&t>(i[fe].coordinate+i[fe-1].coordinate)/2){m=i[fe].index;break}return m},ej=function(t){var n,i=t,c=i.type.displayName,d=(n=t.type)!==null&&n!==void 0&&n.defaultProps?ps(ps({},t.type.defaultProps),t.props):t.props,m=d.stroke,a=d.fill,w;switch(c){case"Line":w=m;break;case"Area":case"Radar":w=m&&m!=="none"?m:a;break;default:w=a;break}return w},gAe=function(t){var n=t.barSize,i=t.totalSize,c=t.stackGroups,d=c===void 0?{}:c;if(!d)return{};for(var m={},a=Object.keys(d),w=0,S=a.length;w<S;w++)for(var M=d[a[w]].stackGroups,P=Object.keys(M),N=0,$=P.length;N<$;N++){var G=M[P[N]],q=G.items,V=G.cateAxisId,J=q.filter(function(me){return Dm(me.type).indexOf("Bar")>=0});if(J&&J.length){var ee=J[0].type.defaultProps,re=ee!==void 0?ps(ps({},ee),J[0].props):J[0].props,fe=re.barSize,ne=re[V];m[ne]||(m[ne]=[]);var ce=ga(fe)?n:fe;m[ne].push({item:J[0],stackList:J.slice(1),barSize:ga(ce)?void 0:Q_(ce,i,0)})}}return m},yAe=function(t){var n=t.barGap,i=t.barCategoryGap,c=t.bandSize,d=t.sizeList,m=d===void 0?[]:d,a=t.maxBarSize,w=m.length;if(w<1)return null;var S=Q_(n,c,0,!0),M,P=[];if(m[0].barSize===+m[0].barSize){var N=!1,$=c/w,G=m.reduce(function(fe,ne){return fe+ne.barSize||0},0);G+=(w-1)*S,G>=c&&(G-=(w-1)*S,S=0),G>=c&&$>0&&(N=!0,$*=.9,G=w*$);var q=(c-G)/2>>0,V={offset:q-S,size:0};M=m.reduce(function(fe,ne){var ce={item:ne.item,position:{offset:V.offset+V.size+S,size:N?$:ne.barSize}},me=[].concat(Dq(fe),[ce]);return V=me[me.length-1].position,ne.stackList&&ne.stackList.length&&ne.stackList.forEach(function(ve){me.push({item:ve,position:V})}),me},P)}else{var J=Q_(i,c,0,!0);c-2*J-(w-1)*S<=0&&(S=0);var ee=(c-2*J-(w-1)*S)/w;ee>1&&(ee>>=0);var re=a===+a?Math.min(ee,a):ee;M=m.reduce(function(fe,ne,ce){var me=[].concat(Dq(fe),[{item:ne.item,position:{offset:J+(ee+S)*ce+(ee-re)/2,size:re}}]);return ne.stackList&&ne.stackList.length&&ne.stackList.forEach(function(ve){me.push({item:ve,position:me[me.length-1].position})}),me},P)}return M},_Ae=function(t,n,i,c){var d=i.children,m=i.width,a=i.margin,w=m-(a.left||0)-(a.right||0),S=yK({children:d,legendWidth:w});if(S){var M=c||{},P=M.width,N=M.height,$=S.align,G=S.verticalAlign,q=S.layout;if((q==="vertical"||q==="horizontal"&&G==="middle")&&$!=="center"&&rr(t[$]))return ps(ps({},t),{},Nx({},$,t[$]+(P||0)));if((q==="horizontal"||q==="vertical"&&$==="center")&&G!=="middle"&&rr(t[G]))return ps(ps({},t),{},Nx({},G,t[G]+(N||0)))}return t},vAe=function(t,n,i){return ga(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||i==="x"?n==="xAxis":i==="y"?n==="yAxis":!0},_K=function(t,n,i,c,d){var m=n.props.children,a=Zd(m,Z2).filter(function(S){return vAe(c,d,S.props.direction)});if(a&&a.length){var w=a.map(function(S){return S.props.dataKey});return t.reduce(function(S,M){var P=rh(M,i);if(ga(P))return S;var N=Array.isArray(P)?[G2(P),ry(P)]:[P,P],$=w.reduce(function(G,q){var V=rh(M,q,0),J=N[0]-Math.abs(Array.isArray(V)?V[0]:V),ee=N[1]+Math.abs(Array.isArray(V)?V[1]:V);return[Math.min(J,G[0]),Math.max(ee,G[1])]},[1/0,-1/0]);return[Math.min($[0],S[0]),Math.max($[1],S[1])]},[1/0,-1/0])}return null},xAe=function(t,n,i,c,d){var m=n.map(function(a){return _K(t,a,i,d,c)}).filter(function(a){return!ga(a)});return m&&m.length?m.reduce(function(a,w){return[Math.min(a[0],w[0]),Math.max(a[1],w[1])]},[1/0,-1/0]):null},vK=function(t,n,i,c,d){var m=n.map(function(w){var S=w.props.dataKey;return i==="number"&&S&&_K(t,w,S,c)||Ow(t,S,i,d)});if(i==="number")return m.reduce(function(w,S){return[Math.min(w[0],S[0]),Math.max(w[1],S[1])]},[1/0,-1/0]);var a={};return m.reduce(function(w,S){for(var M=0,P=S.length;M<P;M++)a[S[M]]||(a[S[M]]=!0,w.push(S[M]));return w},[])},xK=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},bK=function(t,n,i,c){if(c)return t.map(function(w){return w.coordinate});var d,m,a=t.map(function(w){return w.coordinate===n&&(d=!0),w.coordinate===i&&(m=!0),w.coordinate});return d||a.push(n),m||a.push(i),a},Mm=function(t,n,i){if(!t)return null;var c=t.scale,d=t.duplicateDomain,m=t.type,a=t.range,w=t.realScaleType==="scaleBand"?c.bandwidth()/2:2,S=(n||i)&&m==="category"&&c.bandwidth?c.bandwidth()/w:0;if(S=t.axisType==="angleAxis"&&a?.length>=2?Wd(a[0]-a[1])*2*S:S,n&&(t.ticks||t.niceTicks)){var M=(t.ticks||t.niceTicks).map(function(P){var N=d?d.indexOf(P):P;return{coordinate:c(N)+S,value:P,offset:S}});return M.filter(function(P){return!R0(P.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(P,N){return{coordinate:c(P)+S,value:P,index:N,offset:S}}):c.ticks&&!i?c.ticks(t.tickCount).map(function(P){return{coordinate:c(P)+S,value:P,offset:S}}):c.domain().map(function(P,N){return{coordinate:c(P)+S,value:d?d[P]:P,index:N,offset:S}})},LI=new WeakMap,GT=function(t,n){if(typeof n!="function")return t;LI.has(t)||LI.set(t,new WeakMap);var i=LI.get(t);if(i.has(n))return i.get(n);var c=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return i.set(n,c),c},bAe=function(t,n,i){var c=t.scale,d=t.type,m=t.layout,a=t.axisType;if(c==="auto")return m==="radial"&&a==="radiusAxis"?{scale:Jw(),realScaleType:"band"}:m==="radial"&&a==="angleAxis"?{scale:eA(),realScaleType:"linear"}:d==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!i)?{scale:Pw(),realScaleType:"point"}:d==="category"?{scale:Jw(),realScaleType:"band"}:{scale:eA(),realScaleType:"linear"};if(J_(c)){var w="scale".concat(D2(c));return{scale:(vq[w]||Pw)(),realScaleType:vq[w]?w:"point"}}return Hi(c)?{scale:c}:{scale:Pw(),realScaleType:"point"}},Lq=1e-4,wAe=function(t){var n=t.domain();if(!(!n||n.length<=2)){var i=n.length,c=t.range(),d=Math.min(c[0],c[1])-Lq,m=Math.max(c[0],c[1])+Lq,a=t(n[0]),w=t(n[i-1]);(a<d||a>m||w<d||w>m)&&t.domain([n[0],n[i-1]])}},SAe=function(t,n){if(!t)return null;for(var i=0,c=t.length;i<c;i++)if(t[i].item===n)return t[i].position;return null},TAe=function(t,n){if(!n||n.length!==2||!rr(n[0])||!rr(n[1]))return t;var i=Math.min(n[0],n[1]),c=Math.max(n[0],n[1]),d=[t[0],t[1]];return(!rr(t[0])||t[0]<i)&&(d[0]=i),(!rr(t[1])||t[1]>c)&&(d[1]=c),d[0]>c&&(d[0]=c),d[1]<i&&(d[1]=i),d},EAe=function(t){var n=t.length;if(!(n<=0))for(var i=0,c=t[0].length;i<c;++i)for(var d=0,m=0,a=0;a<n;++a){var w=R0(t[a][i][1])?t[a][i][0]:t[a][i][1];w>=0?(t[a][i][0]=d,t[a][i][1]=d+w,d=t[a][i][1]):(t[a][i][0]=m,t[a][i][1]=m+w,m=t[a][i][1])}},AAe=function(t){var n=t.length;if(!(n<=0))for(var i=0,c=t[0].length;i<c;++i)for(var d=0,m=0;m<n;++m){var a=R0(t[m][i][1])?t[m][i][0]:t[m][i][1];a>=0?(t[m][i][0]=d,t[m][i][1]=d+a,d=t[m][i][1]):(t[m][i][0]=0,t[m][i][1]=0)}},CAe={sign:EAe,expand:c0e,none:Hx,silhouette:u0e,wiggle:h0e,positive:AAe},MAe=function(t,n,i){var c=n.map(function(a){return a.props.dataKey}),d=CAe[i],m=l0e().keys(c).value(function(a,w){return+rh(a,w,0)}).order(Ck).offset(d);return m(t)},PAe=function(t,n,i,c,d,m){if(!t)return null;var a=m?n.reverse():n,w={},S=a.reduce(function(P,N){var $,G=($=N.type)!==null&&$!==void 0&&$.defaultProps?ps(ps({},N.type.defaultProps),N.props):N.props,q=G.stackId,V=G.hide;if(V)return P;var J=G[i],ee=P[J]||{hasStack:!1,stackGroups:{}};if(al(q)){var re=ee.stackGroups[q]||{numericAxisId:i,cateAxisId:c,items:[]};re.items.push(N),ee.hasStack=!0,ee.stackGroups[q]=re}else ee.stackGroups[nS("_stackId_")]={numericAxisId:i,cateAxisId:c,items:[N]};return ps(ps({},P),{},Nx({},J,ee))},w),M={};return Object.keys(S).reduce(function(P,N){var $=S[N];if($.hasStack){var G={};$.stackGroups=Object.keys($.stackGroups).reduce(function(q,V){var J=$.stackGroups[V];return ps(ps({},q),{},Nx({},V,{numericAxisId:i,cateAxisId:c,items:J.items,stackedData:MAe(t,J.items,d)}))},G)}return ps(ps({},P),{},Nx({},N,$))},M)},OAe=function(t,n){var i=n.realScaleType,c=n.type,d=n.tickCount,m=n.originalDomain,a=n.allowDecimals,w=i||n.scale;if(w!=="auto"&&w!=="linear")return null;if(d&&c==="number"&&m&&(m[0]==="auto"||m[1]==="auto")){var S=t.domain();if(!S.length)return null;var M=VEe(S,d,a);return t.domain([G2(M),ry(M)]),{niceTicks:M}}if(d&&c==="number"){var P=t.domain(),N=UEe(P,d,a);return{niceTicks:N}}return null};function Nq(e){var t=e.axis,n=e.ticks,i=e.bandSize,c=e.entry,d=e.index,m=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!ga(c[t.dataKey])){var a=kE(n,"value",c[t.dataKey]);if(a)return a.coordinate+i/2}return n[d]?n[d].coordinate+i/2:null}var w=rh(c,ga(m)?t.dataKey:m);return ga(w)?null:t.scale(w)}var zq=function(t){var n=t.axis,i=t.ticks,c=t.offset,d=t.bandSize,m=t.entry,a=t.index;if(n.type==="category")return i[a]?i[a].coordinate+c:null;var w=rh(m,n.dataKey,n.domain[a]);return ga(w)?null:n.scale(w)-d/2+c},RAe=function(t){var n=t.numericAxis,i=n.scale.domain();if(n.type==="number"){var c=Math.min(i[0],i[1]),d=Math.max(i[0],i[1]);return c<=0&&d>=0?0:d<0?d:c}return i[0]},IAe=function(t,n){var i,c=(i=t.type)!==null&&i!==void 0&&i.defaultProps?ps(ps({},t.type.defaultProps),t.props):t.props,d=c.stackId;if(al(d)){var m=n[d];if(m){var a=m.items.indexOf(t);return a>=0?m.stackedData[a]:null}}return null},DAe=function(t){return t.reduce(function(n,i){return[G2(i.concat([n[0]]).filter(rr)),ry(i.concat([n[1]]).filter(rr))]},[1/0,-1/0])},wK=function(t,n,i){return Object.keys(t).reduce(function(c,d){var m=t[d],a=m.stackedData,w=a.reduce(function(S,M){var P=DAe(M.slice(n,i+1));return[Math.min(S[0],P[0]),Math.max(S[1],P[1])]},[1/0,-1/0]);return[Math.min(w[0],c[0]),Math.max(w[1],c[1])]},[1/0,-1/0]).map(function(c){return c===1/0||c===-1/0?0:c})},jq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Bq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Jk=function(t,n,i){if(Hi(t))return t(n,i);if(!Array.isArray(t))return n;var c=[];if(rr(t[0]))c[0]=i?t[0]:Math.min(t[0],n[0]);else if(jq.test(t[0])){var d=+jq.exec(t[0])[1];c[0]=n[0]-d}else Hi(t[0])?c[0]=t[0](n[0]):c[0]=n[0];if(rr(t[1]))c[1]=i?t[1]:Math.max(t[1],n[1]);else if(Bq.test(t[1])){var m=+Bq.exec(t[1])[1];c[1]=n[1]+m}else Hi(t[1])?c[1]=t[1](n[1]):c[1]=n[1];return c},sA=function(t,n,i){if(t&&t.scale&&t.scale.bandwidth){var c=t.scale.bandwidth();if(!i||c>0)return c}if(t&&n&&n.length>=2){for(var d=Mz(n,function(P){return P.coordinate}),m=1/0,a=1,w=d.length;a<w;a++){var S=d[a],M=d[a-1];m=Math.min((S.coordinate||0)-(M.coordinate||0),m)}return m===1/0?0:m}return i?void 0:0},Fq=function(t,n,i){return!t||!t.length||r1(t,Jh(i,"type.defaultProps.domain"))?n:t},SK=function(t,n){var i=t.type.defaultProps?ps(ps({},t.type.defaultProps),t.props):t.props,c=i.dataKey,d=i.name,m=i.unit,a=i.formatter,w=i.tooltipType,S=i.chartType,M=i.hide;return ps(ps({},ha(t,!1)),{},{dataKey:c,unit:m,formatter:a,name:d||c,color:ej(t),value:rh(n,c),type:w,payload:n,chartType:S,hide:M})};function l1(e){"@babel/helpers - typeof";return l1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l1(e)}function Vq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Uq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vq(Object(n),!0).forEach(function(i){kAe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function kAe(e,t,n){return t=LAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LAe(e){var t=NAe(e,"string");return l1(t)=="symbol"?t:t+""}function NAe(e,t){if(l1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(l1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lA=Math.PI/180,zAe=function(t){return t*180/Math.PI},zl=function(t,n,i,c){return{x:t+Math.cos(-lA*c)*i,y:n+Math.sin(-lA*c)*i}},jAe=function(t,n){var i=t.x,c=t.y,d=n.x,m=n.y;return Math.sqrt(Math.pow(i-d,2)+Math.pow(c-m,2))},BAe=function(t,n){var i=t.x,c=t.y,d=n.cx,m=n.cy,a=jAe({x:i,y:c},{x:d,y:m});if(a<=0)return{radius:a};var w=(i-d)/a,S=Math.acos(w);return c>m&&(S=2*Math.PI-S),{radius:a,angle:zAe(S),angleInRadian:S}},FAe=function(t){var n=t.startAngle,i=t.endAngle,c=Math.floor(n/360),d=Math.floor(i/360),m=Math.min(c,d);return{startAngle:n-m*360,endAngle:i-m*360}},VAe=function(t,n){var i=n.startAngle,c=n.endAngle,d=Math.floor(i/360),m=Math.floor(c/360),a=Math.min(d,m);return t+a*360},$q=function(t,n){var i=t.x,c=t.y,d=BAe({x:i,y:c},n),m=d.radius,a=d.angle,w=n.innerRadius,S=n.outerRadius;if(m<w||m>S)return!1;if(m===0)return!0;var M=FAe(n),P=M.startAngle,N=M.endAngle,$=a,G;if(P<=N){for(;$>N;)$-=360;for(;$<P;)$+=360;G=$>=P&&$<=N}else{for(;$>P;)$-=360;for(;$<N;)$+=360;G=$>=N&&$<=P}return G?Uq(Uq({},n),{},{radius:m,angle:VAe($,n)}):null};function c1(e){"@babel/helpers - typeof";return c1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c1(e)}var UAe=["offset"];function $Ae(e){return WAe(e)||GAe(e)||HAe(e)||qAe()}function qAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HAe(e,t){if(e){if(typeof e=="string")return Qk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qk(e,t)}}function GAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WAe(e){if(Array.isArray(e))return Qk(e)}function Qk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function XAe(e,t){if(e==null)return{};var n=ZAe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function ZAe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function qq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function rl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qq(Object(n),!0).forEach(function(i){YAe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function YAe(e,t,n){return t=KAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KAe(e){var t=JAe(e,"string");return c1(t)=="symbol"?t:t+""}function JAe(e,t){if(c1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(c1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u1(){return u1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},u1.apply(this,arguments)}var QAe=function(t){var n=t.value,i=t.formatter,c=ga(t.children)?n:t.children;return Hi(i)?i(c):c},e2e=function(t,n){var i=Wd(n-t),c=Math.min(Math.abs(n-t),360);return i*c},t2e=function(t,n,i){var c=t.position,d=t.viewBox,m=t.offset,a=t.className,w=d,S=w.cx,M=w.cy,P=w.innerRadius,N=w.outerRadius,$=w.startAngle,G=w.endAngle,q=w.clockWise,V=(P+N)/2,J=e2e($,G),ee=J>=0?1:-1,re,fe;c==="insideStart"?(re=$+ee*m,fe=q):c==="insideEnd"?(re=G-ee*m,fe=!q):c==="end"&&(re=G+ee*m,fe=q),fe=J<=0?fe:!fe;var ne=zl(S,M,V,re),ce=zl(S,M,V,re+(fe?1:-1)*359),me="M".concat(ne.x,",").concat(ne.y,`
    A`).concat(V,",").concat(V,",0,1,").concat(fe?0:1,`,
    `).concat(ce.x,",").concat(ce.y),ve=ga(t.id)?nS("recharts-radial-line-"):t.id;return Ce.createElement("text",u1({},i,{dominantBaseline:"central",className:xa("recharts-radial-bar-label",a)}),Ce.createElement("defs",null,Ce.createElement("path",{id:ve,d:me})),Ce.createElement("textPath",{xlinkHref:"#".concat(ve)},n))},n2e=function(t){var n=t.viewBox,i=t.offset,c=t.position,d=n,m=d.cx,a=d.cy,w=d.innerRadius,S=d.outerRadius,M=d.startAngle,P=d.endAngle,N=(M+P)/2;if(c==="outside"){var $=zl(m,a,S+i,N),G=$.x,q=$.y;return{x:G,y:q,textAnchor:G>=m?"start":"end",verticalAnchor:"middle"}}if(c==="center")return{x:m,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(c==="centerTop")return{x:m,y:a,textAnchor:"middle",verticalAnchor:"start"};if(c==="centerBottom")return{x:m,y:a,textAnchor:"middle",verticalAnchor:"end"};var V=(w+S)/2,J=zl(m,a,V,N),ee=J.x,re=J.y;return{x:ee,y:re,textAnchor:"middle",verticalAnchor:"middle"}},r2e=function(t){var n=t.viewBox,i=t.parentViewBox,c=t.offset,d=t.position,m=n,a=m.x,w=m.y,S=m.width,M=m.height,P=M>=0?1:-1,N=P*c,$=P>0?"end":"start",G=P>0?"start":"end",q=S>=0?1:-1,V=q*c,J=q>0?"end":"start",ee=q>0?"start":"end";if(d==="top"){var re={x:a+S/2,y:w-P*c,textAnchor:"middle",verticalAnchor:$};return rl(rl({},re),i?{height:Math.max(w-i.y,0),width:S}:{})}if(d==="bottom"){var fe={x:a+S/2,y:w+M+N,textAnchor:"middle",verticalAnchor:G};return rl(rl({},fe),i?{height:Math.max(i.y+i.height-(w+M),0),width:S}:{})}if(d==="left"){var ne={x:a-V,y:w+M/2,textAnchor:J,verticalAnchor:"middle"};return rl(rl({},ne),i?{width:Math.max(ne.x-i.x,0),height:M}:{})}if(d==="right"){var ce={x:a+S+V,y:w+M/2,textAnchor:ee,verticalAnchor:"middle"};return rl(rl({},ce),i?{width:Math.max(i.x+i.width-ce.x,0),height:M}:{})}var me=i?{width:S,height:M}:{};return d==="insideLeft"?rl({x:a+V,y:w+M/2,textAnchor:ee,verticalAnchor:"middle"},me):d==="insideRight"?rl({x:a+S-V,y:w+M/2,textAnchor:J,verticalAnchor:"middle"},me):d==="insideTop"?rl({x:a+S/2,y:w+N,textAnchor:"middle",verticalAnchor:G},me):d==="insideBottom"?rl({x:a+S/2,y:w+M-N,textAnchor:"middle",verticalAnchor:$},me):d==="insideTopLeft"?rl({x:a+V,y:w+N,textAnchor:ee,verticalAnchor:G},me):d==="insideTopRight"?rl({x:a+S-V,y:w+N,textAnchor:J,verticalAnchor:G},me):d==="insideBottomLeft"?rl({x:a+V,y:w+M-N,textAnchor:ee,verticalAnchor:$},me):d==="insideBottomRight"?rl({x:a+S-V,y:w+M-N,textAnchor:J,verticalAnchor:$},me):O0(d)&&(rr(d.x)||z_(d.x))&&(rr(d.y)||z_(d.y))?rl({x:a+Q_(d.x,S),y:w+Q_(d.y,M),textAnchor:"end",verticalAnchor:"end"},me):rl({x:a+S/2,y:w+M/2,textAnchor:"middle",verticalAnchor:"middle"},me)},i2e=function(t){return"cx"in t&&rr(t.cx)};function lc(e){var t=e.offset,n=t===void 0?5:t,i=XAe(e,UAe),c=rl({offset:n},i),d=c.viewBox,m=c.position,a=c.value,w=c.children,S=c.content,M=c.className,P=M===void 0?"":M,N=c.textBreakAll;if(!d||ga(a)&&ga(w)&&!K.isValidElement(S)&&!Hi(S))return null;if(K.isValidElement(S))return K.cloneElement(S,c);var $;if(Hi(S)){if($=K.createElement(S,c),K.isValidElement($))return $}else $=QAe(c);var G=i2e(d),q=ha(c,!0);if(G&&(m==="insideStart"||m==="insideEnd"||m==="end"))return t2e(c,$,q);var V=G?n2e(c):r2e(c);return Ce.createElement(WE,u1({className:xa("recharts-label",P)},q,V,{breakAll:N}),$)}lc.displayName="Label";var TK=function(t){var n=t.cx,i=t.cy,c=t.angle,d=t.startAngle,m=t.endAngle,a=t.r,w=t.radius,S=t.innerRadius,M=t.outerRadius,P=t.x,N=t.y,$=t.top,G=t.left,q=t.width,V=t.height,J=t.clockWise,ee=t.labelViewBox;if(ee)return ee;if(rr(q)&&rr(V)){if(rr(P)&&rr(N))return{x:P,y:N,width:q,height:V};if(rr($)&&rr(G))return{x:$,y:G,width:q,height:V}}return rr(P)&&rr(N)?{x:P,y:N,width:0,height:0}:rr(n)&&rr(i)?{cx:n,cy:i,startAngle:d||c||0,endAngle:m||c||0,innerRadius:S||0,outerRadius:M||w||a||0,clockWise:J}:t.viewBox?t.viewBox:{}},a2e=function(t,n){return t?t===!0?Ce.createElement(lc,{key:"label-implicit",viewBox:n}):al(t)?Ce.createElement(lc,{key:"label-implicit",viewBox:n,value:t}):K.isValidElement(t)?t.type===lc?K.cloneElement(t,{key:"label-implicit",viewBox:n}):Ce.createElement(lc,{key:"label-implicit",content:t,viewBox:n}):Hi(t)?Ce.createElement(lc,{key:"label-implicit",content:t,viewBox:n}):O0(t)?Ce.createElement(lc,u1({viewBox:n},t,{key:"label-implicit"})):null:null},o2e=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&i&&!t.label)return null;var c=t.children,d=TK(t),m=Zd(c,lc).map(function(w,S){return K.cloneElement(w,{viewBox:n||d,key:"label-".concat(S)})});if(!i)return m;var a=a2e(t.label,n||d);return[a].concat($Ae(m))};lc.parseViewBox=TK;lc.renderCallByParent=o2e;var NI,Hq;function s2e(){if(Hq)return NI;Hq=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return NI=e,NI}var l2e=s2e();const c2e=Wa(l2e);function h1(e){"@babel/helpers - typeof";return h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h1(e)}var u2e=["valueAccessor"],h2e=["data","dataKey","clockWise","id","textBreakAll"];function d2e(e){return g2e(e)||m2e(e)||p2e(e)||f2e()}function f2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p2e(e,t){if(e){if(typeof e=="string")return eL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eL(e,t)}}function m2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function g2e(e){if(Array.isArray(e))return eL(e)}function eL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function cA(){return cA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cA.apply(this,arguments)}function Gq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Wq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Gq(Object(n),!0).forEach(function(i){y2e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function y2e(e,t,n){return t=_2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _2e(e){var t=v2e(e,"string");return h1(t)=="symbol"?t:t+""}function v2e(e,t){if(h1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(h1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xq(e,t){if(e==null)return{};var n=x2e(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function x2e(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var b2e=function(t){return Array.isArray(t.value)?c2e(t.value):t.value};function ly(e){var t=e.valueAccessor,n=t===void 0?b2e:t,i=Xq(e,u2e),c=i.data,d=i.dataKey,m=i.clockWise,a=i.id,w=i.textBreakAll,S=Xq(i,h2e);return!c||!c.length?null:Ce.createElement(as,{className:"recharts-label-list"},c.map(function(M,P){var N=ga(d)?n(M,P):rh(M&&M.payload,d),$=ga(a)?{}:{id:"".concat(a,"-").concat(P)};return Ce.createElement(lc,cA({},ha(M,!0),S,$,{parentViewBox:M.parentViewBox,value:N,textBreakAll:w,viewBox:lc.parseViewBox(ga(m)?M:Wq(Wq({},M),{},{clockWise:m})),key:"label-".concat(P),index:P}))}))}ly.displayName="LabelList";function w2e(e,t){return e?e===!0?Ce.createElement(ly,{key:"labelList-implicit",data:t}):Ce.isValidElement(e)||Hi(e)?Ce.createElement(ly,{key:"labelList-implicit",data:t,content:e}):O0(e)?Ce.createElement(ly,cA({data:t},e,{key:"labelList-implicit"})):null:null}function S2e(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,c=Zd(i,ly).map(function(m,a){return K.cloneElement(m,{data:t,key:"labelList-".concat(a)})});if(!n)return c;var d=w2e(e.label,t);return[d].concat(d2e(c))}ly.renderCallByParent=S2e;function d1(e){"@babel/helpers - typeof";return d1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d1(e)}function tL(){return tL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tL.apply(this,arguments)}function Zq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Yq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zq(Object(n),!0).forEach(function(i){T2e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function T2e(e,t,n){return t=E2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E2e(e){var t=A2e(e,"string");return d1(t)=="symbol"?t:t+""}function A2e(e,t){if(d1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(d1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var C2e=function(t,n){var i=Wd(n-t),c=Math.min(Math.abs(n-t),359.999);return i*c},WT=function(t){var n=t.cx,i=t.cy,c=t.radius,d=t.angle,m=t.sign,a=t.isExternal,w=t.cornerRadius,S=t.cornerIsExternal,M=w*(a?1:-1)+c,P=Math.asin(w/M)/lA,N=S?d:d+m*P,$=zl(n,i,M,N),G=zl(n,i,c,N),q=S?d-m*P:d,V=zl(n,i,M*Math.cos(P*lA),q);return{center:$,circleTangency:G,lineTangency:V,theta:P}},EK=function(t){var n=t.cx,i=t.cy,c=t.innerRadius,d=t.outerRadius,m=t.startAngle,a=t.endAngle,w=C2e(m,a),S=m+w,M=zl(n,i,d,m),P=zl(n,i,d,S),N="M ".concat(M.x,",").concat(M.y,`
    A `).concat(d,",").concat(d,`,0,
    `).concat(+(Math.abs(w)>180),",").concat(+(m>S),`,
    `).concat(P.x,",").concat(P.y,`
  `);if(c>0){var $=zl(n,i,c,m),G=zl(n,i,c,S);N+="L ".concat(G.x,",").concat(G.y,`
            A `).concat(c,",").concat(c,`,0,
            `).concat(+(Math.abs(w)>180),",").concat(+(m<=S),`,
            `).concat($.x,",").concat($.y," Z")}else N+="L ".concat(n,",").concat(i," Z");return N},M2e=function(t){var n=t.cx,i=t.cy,c=t.innerRadius,d=t.outerRadius,m=t.cornerRadius,a=t.forceCornerRadius,w=t.cornerIsExternal,S=t.startAngle,M=t.endAngle,P=Wd(M-S),N=WT({cx:n,cy:i,radius:d,angle:S,sign:P,cornerRadius:m,cornerIsExternal:w}),$=N.circleTangency,G=N.lineTangency,q=N.theta,V=WT({cx:n,cy:i,radius:d,angle:M,sign:-P,cornerRadius:m,cornerIsExternal:w}),J=V.circleTangency,ee=V.lineTangency,re=V.theta,fe=w?Math.abs(S-M):Math.abs(S-M)-q-re;if(fe<0)return a?"M ".concat(G.x,",").concat(G.y,`
        a`).concat(m,",").concat(m,",0,0,1,").concat(m*2,`,0
        a`).concat(m,",").concat(m,",0,0,1,").concat(-m*2,`,0
      `):EK({cx:n,cy:i,innerRadius:c,outerRadius:d,startAngle:S,endAngle:M});var ne="M ".concat(G.x,",").concat(G.y,`
    A`).concat(m,",").concat(m,",0,0,").concat(+(P<0),",").concat($.x,",").concat($.y,`
    A`).concat(d,",").concat(d,",0,").concat(+(fe>180),",").concat(+(P<0),",").concat(J.x,",").concat(J.y,`
    A`).concat(m,",").concat(m,",0,0,").concat(+(P<0),",").concat(ee.x,",").concat(ee.y,`
  `);if(c>0){var ce=WT({cx:n,cy:i,radius:c,angle:S,sign:P,isExternal:!0,cornerRadius:m,cornerIsExternal:w}),me=ce.circleTangency,ve=ce.lineTangency,De=ce.theta,Ye=WT({cx:n,cy:i,radius:c,angle:M,sign:-P,isExternal:!0,cornerRadius:m,cornerIsExternal:w}),ze=Ye.circleTangency,tt=Ye.lineTangency,at=Ye.theta,ct=w?Math.abs(S-M):Math.abs(S-M)-De-at;if(ct<0&&m===0)return"".concat(ne,"L").concat(n,",").concat(i,"Z");ne+="L".concat(tt.x,",").concat(tt.y,`
      A`).concat(m,",").concat(m,",0,0,").concat(+(P<0),",").concat(ze.x,",").concat(ze.y,`
      A`).concat(c,",").concat(c,",0,").concat(+(ct>180),",").concat(+(P>0),",").concat(me.x,",").concat(me.y,`
      A`).concat(m,",").concat(m,",0,0,").concat(+(P<0),",").concat(ve.x,",").concat(ve.y,"Z")}else ne+="L".concat(n,",").concat(i,"Z");return ne},P2e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},AK=function(t){var n=Yq(Yq({},P2e),t),i=n.cx,c=n.cy,d=n.innerRadius,m=n.outerRadius,a=n.cornerRadius,w=n.forceCornerRadius,S=n.cornerIsExternal,M=n.startAngle,P=n.endAngle,N=n.className;if(m<d||M===P)return null;var $=xa("recharts-sector",N),G=m-d,q=Q_(a,G,0,!0),V;return q>0&&Math.abs(M-P)<360?V=M2e({cx:i,cy:c,innerRadius:d,outerRadius:m,cornerRadius:Math.min(q,G/2),forceCornerRadius:w,cornerIsExternal:S,startAngle:M,endAngle:P}):V=EK({cx:i,cy:c,innerRadius:d,outerRadius:m,startAngle:M,endAngle:P}),Ce.createElement("path",tL({},ha(n,!0),{className:$,d:V,role:"img"}))};function f1(e){"@babel/helpers - typeof";return f1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f1(e)}function nL(){return nL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nL.apply(this,arguments)}function Kq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Jq(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kq(Object(n),!0).forEach(function(i){O2e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kq(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function O2e(e,t,n){return t=R2e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R2e(e){var t=I2e(e,"string");return f1(t)=="symbol"?t:t+""}function I2e(e,t){if(f1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(f1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qq={curveBasisClosed:Kxe,curveBasisOpen:Jxe,curveBasis:Yxe,curveBumpX:Nxe,curveBumpY:zxe,curveLinearClosed:Qxe,curveLinear:L2,curveMonotoneX:e0e,curveMonotoneY:t0e,curveNatural:n0e,curveStep:r0e,curveStepAfter:a0e,curveStepBefore:i0e},XT=function(t){return t.x===+t.x&&t.y===+t.y},iw=function(t){return t.x},aw=function(t){return t.y},D2e=function(t,n){if(Hi(t))return t;var i="curve".concat(D2(t));return(i==="curveMonotone"||i==="curveBump")&&n?Qq["".concat(i).concat(n==="vertical"?"Y":"X")]:Qq[i]||L2},k2e=function(t){var n=t.type,i=n===void 0?"linear":n,c=t.points,d=c===void 0?[]:c,m=t.baseLine,a=t.layout,w=t.connectNulls,S=w===void 0?!1:w,M=D2e(i,a),P=S?d.filter(function(q){return XT(q)}):d,N;if(Array.isArray(m)){var $=S?m.filter(function(q){return XT(q)}):m,G=P.map(function(q,V){return Jq(Jq({},q),{},{base:$[V]})});return a==="vertical"?N=BT().y(aw).x1(iw).x0(function(q){return q.base.x}):N=BT().x(iw).y1(aw).y0(function(q){return q.base.y}),N.defined(XT).curve(M),N(G)}return a==="vertical"&&rr(m)?N=BT().y(aw).x1(iw).x0(m):rr(m)?N=BT().x(iw).y1(aw).y0(m):N=OZ().x(iw).y(aw),N.defined(XT).curve(M),N(P)},Rw=function(t){var n=t.className,i=t.points,c=t.path,d=t.pathRef;if((!i||!i.length)&&!c)return null;var m=i&&i.length?k2e(t):c;return K.createElement("path",nL({},ha(t,!1),LE(t),{className:xa("recharts-curve",n),d:m,ref:d}))},zI={exports:{}},jI,e8;function L2e(){if(e8)return jI;e8=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return jI=e,jI}var BI,t8;function N2e(){if(t8)return BI;t8=1;var e=L2e();function t(){}function n(){}return n.resetWarningCache=t,BI=function(){function i(m,a,w,S,M,P){if(P!==e){var N=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw N.name="Invariant Violation",N}}i.isRequired=i;function c(){return i}var d={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:c,element:i,elementType:i,instanceOf:c,node:i,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:n,resetWarningCache:t};return d.PropTypes=d,d},BI}var n8;function z2e(){return n8||(n8=1,zI.exports=N2e()()),zI.exports}var j2e=z2e();const Ga=Wa(j2e);var B2e=Object.getOwnPropertyNames,F2e=Object.getOwnPropertySymbols,V2e=Object.prototype.hasOwnProperty;function r8(e,t){return function(i,c,d){return e(i,c,d)&&t(i,c,d)}}function ZT(e){return function(n,i,c){if(!n||!i||typeof n!="object"||typeof i!="object")return e(n,i,c);var d=c.cache,m=d.get(n),a=d.get(i);if(m&&a)return m===i&&a===n;d.set(n,i),d.set(i,n);var w=e(n,i,c);return d.delete(n),d.delete(i),w}}function i8(e){return B2e(e).concat(F2e(e))}var U2e=Object.hasOwn||(function(e,t){return V2e.call(e,t)});function dv(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var $2e="__v",q2e="__o",H2e="_owner",a8=Object.getOwnPropertyDescriptor,o8=Object.keys;function G2e(e,t,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!n.equals(e[i],t[i],i,i,e,t,n))return!1;return!0}function W2e(e,t){return dv(e.getTime(),t.getTime())}function X2e(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Z2e(e,t){return e===t}function s8(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var c=new Array(i),d=e.entries(),m,a,w=0;(m=d.next())&&!m.done;){for(var S=t.entries(),M=!1,P=0;(a=S.next())&&!a.done;){if(c[P]){P++;continue}var N=m.value,$=a.value;if(n.equals(N[0],$[0],w,P,e,t,n)&&n.equals(N[1],$[1],N[0],$[0],e,t,n)){M=c[P]=!0;break}P++}if(!M)return!1;w++}return!0}var Y2e=dv;function K2e(e,t,n){var i=o8(e),c=i.length;if(o8(t).length!==c)return!1;for(;c-- >0;)if(!CK(e,t,n,i[c]))return!1;return!0}function ow(e,t,n){var i=i8(e),c=i.length;if(i8(t).length!==c)return!1;for(var d,m,a;c-- >0;)if(d=i[c],!CK(e,t,n,d)||(m=a8(e,d),a=a8(t,d),(m||a)&&(!m||!a||m.configurable!==a.configurable||m.enumerable!==a.enumerable||m.writable!==a.writable)))return!1;return!0}function J2e(e,t){return dv(e.valueOf(),t.valueOf())}function Q2e(e,t){return e.source===t.source&&e.flags===t.flags}function l8(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var c=new Array(i),d=e.values(),m,a;(m=d.next())&&!m.done;){for(var w=t.values(),S=!1,M=0;(a=w.next())&&!a.done;){if(!c[M]&&n.equals(m.value,a.value,m.value,a.value,e,t,n)){S=c[M]=!0;break}M++}if(!S)return!1}return!0}function eCe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function tCe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function CK(e,t,n,i){return(i===H2e||i===q2e||i===$2e)&&(e.$$typeof||t.$$typeof)?!0:U2e(t,i)&&n.equals(e[i],t[i],i,i,e,t,n)}var nCe="[object Arguments]",rCe="[object Boolean]",iCe="[object Date]",aCe="[object Error]",oCe="[object Map]",sCe="[object Number]",lCe="[object Object]",cCe="[object RegExp]",uCe="[object Set]",hCe="[object String]",dCe="[object URL]",fCe=Array.isArray,c8=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,u8=Object.assign,pCe=Object.prototype.toString.call.bind(Object.prototype.toString);function mCe(e){var t=e.areArraysEqual,n=e.areDatesEqual,i=e.areErrorsEqual,c=e.areFunctionsEqual,d=e.areMapsEqual,m=e.areNumbersEqual,a=e.areObjectsEqual,w=e.arePrimitiveWrappersEqual,S=e.areRegExpsEqual,M=e.areSetsEqual,P=e.areTypedArraysEqual,N=e.areUrlsEqual;return function(G,q,V){if(G===q)return!0;if(G==null||q==null)return!1;var J=typeof G;if(J!==typeof q)return!1;if(J!=="object")return J==="number"?m(G,q,V):J==="function"?c(G,q,V):!1;var ee=G.constructor;if(ee!==q.constructor)return!1;if(ee===Object)return a(G,q,V);if(fCe(G))return t(G,q,V);if(c8!=null&&c8(G))return P(G,q,V);if(ee===Date)return n(G,q,V);if(ee===RegExp)return S(G,q,V);if(ee===Map)return d(G,q,V);if(ee===Set)return M(G,q,V);var re=pCe(G);return re===iCe?n(G,q,V):re===cCe?S(G,q,V):re===oCe?d(G,q,V):re===uCe?M(G,q,V):re===lCe?typeof G.then!="function"&&typeof q.then!="function"&&a(G,q,V):re===dCe?N(G,q,V):re===aCe?i(G,q,V):re===nCe?a(G,q,V):re===rCe||re===sCe||re===hCe?w(G,q,V):!1}}function gCe(e){var t=e.circular,n=e.createCustomConfig,i=e.strict,c={areArraysEqual:i?ow:G2e,areDatesEqual:W2e,areErrorsEqual:X2e,areFunctionsEqual:Z2e,areMapsEqual:i?r8(s8,ow):s8,areNumbersEqual:Y2e,areObjectsEqual:i?ow:K2e,arePrimitiveWrappersEqual:J2e,areRegExpsEqual:Q2e,areSetsEqual:i?r8(l8,ow):l8,areTypedArraysEqual:i?ow:eCe,areUrlsEqual:tCe};if(n&&(c=u8({},c,n(c))),t){var d=ZT(c.areArraysEqual),m=ZT(c.areMapsEqual),a=ZT(c.areObjectsEqual),w=ZT(c.areSetsEqual);c=u8({},c,{areArraysEqual:d,areMapsEqual:m,areObjectsEqual:a,areSetsEqual:w})}return c}function yCe(e){return function(t,n,i,c,d,m,a){return e(t,n,a)}}function _Ce(e){var t=e.circular,n=e.comparator,i=e.createState,c=e.equals,d=e.strict;if(i)return function(w,S){var M=i(),P=M.cache,N=P===void 0?t?new WeakMap:void 0:P,$=M.meta;return n(w,S,{cache:N,equals:c,meta:$,strict:d})};if(t)return function(w,S){return n(w,S,{cache:new WeakMap,equals:c,meta:void 0,strict:d})};var m={cache:void 0,equals:c,meta:void 0,strict:d};return function(w,S){return n(w,S,m)}}var vCe=wy();wy({strict:!0});wy({circular:!0});wy({circular:!0,strict:!0});wy({createInternalComparator:function(){return dv}});wy({strict:!0,createInternalComparator:function(){return dv}});wy({circular:!0,createInternalComparator:function(){return dv}});wy({circular:!0,createInternalComparator:function(){return dv},strict:!0});function wy(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,i=e.createInternalComparator,c=e.createState,d=e.strict,m=d===void 0?!1:d,a=gCe(e),w=mCe(a),S=i?i(w):yCe(w);return _Ce({circular:n,comparator:w,createState:c,equals:S,strict:m})}function xCe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function h8(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=function c(d){n<0&&(n=d),d-n>t?(e(d),n=-1):xCe(c)};requestAnimationFrame(i)}function rL(e){"@babel/helpers - typeof";return rL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rL(e)}function bCe(e){return ECe(e)||TCe(e)||SCe(e)||wCe()}function wCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SCe(e,t){if(e){if(typeof e=="string")return d8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d8(e,t)}}function d8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function TCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ECe(e){if(Array.isArray(e))return e}function ACe(){var e={},t=function(){return null},n=!1,i=function c(d){if(!n){if(Array.isArray(d)){if(!d.length)return;var m=d,a=bCe(m),w=a[0],S=a.slice(1);if(typeof w=="number"){h8(c.bind(null,S),w);return}c(w),h8(c.bind(null,S));return}rL(d)==="object"&&(e=d,t(e)),typeof d=="function"&&d()}};return{stop:function(){n=!0},start:function(d){n=!1,i(d)},subscribe:function(d){return t=d,function(){t=function(){return null}}}}}function p1(e){"@babel/helpers - typeof";return p1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p1(e)}function f8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function p8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f8(Object(n),!0).forEach(function(i){MK(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function MK(e,t,n){return t=CCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CCe(e){var t=MCe(e,"string");return p1(t)==="symbol"?t:String(t)}function MCe(e,t){if(p1(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(p1(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PCe=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(i,c){return i.filter(function(d){return c.includes(d)})})},OCe=function(t){return t},RCe=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Iw=function(t,n){return Object.keys(n).reduce(function(i,c){return p8(p8({},i),{},MK({},c,t(c,n[c])))},{})},m8=function(t,n,i){return t.map(function(c){return"".concat(RCe(c)," ").concat(n,"ms ").concat(i)}).join(",")};function ICe(e,t){return LCe(e)||kCe(e,t)||PK(e,t)||DCe()}function DCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kCe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function LCe(e){if(Array.isArray(e))return e}function NCe(e){return BCe(e)||jCe(e)||PK(e)||zCe()}function zCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PK(e,t){if(e){if(typeof e=="string")return iL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iL(e,t)}}function jCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BCe(e){if(Array.isArray(e))return iL(e)}function iL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var uA=1e-4,OK=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},RK=function(t,n){return t.map(function(i,c){return i*Math.pow(n,c)}).reduce(function(i,c){return i+c})},g8=function(t,n){return function(i){var c=OK(t,n);return RK(c,i)}},FCe=function(t,n){return function(i){var c=OK(t,n),d=[].concat(NCe(c.map(function(m,a){return m*a}).slice(1)),[0]);return RK(d,i)}},y8=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var c=n[0],d=n[1],m=n[2],a=n[3];if(n.length===1)switch(n[0]){case"linear":c=0,d=0,m=1,a=1;break;case"ease":c=.25,d=.1,m=.25,a=1;break;case"ease-in":c=.42,d=0,m=1,a=1;break;case"ease-out":c=.42,d=0,m=.58,a=1;break;case"ease-in-out":c=0,d=0,m=.58,a=1;break;default:{var w=n[0].split("(");if(w[0]==="cubic-bezier"&&w[1].split(")")[0].split(",").length===4){var S=w[1].split(")")[0].split(",").map(function(V){return parseFloat(V)}),M=ICe(S,4);c=M[0],d=M[1],m=M[2],a=M[3]}}}var P=g8(c,m),N=g8(d,a),$=FCe(c,m),G=function(J){return J>1?1:J<0?0:J},q=function(J){for(var ee=J>1?1:J,re=ee,fe=0;fe<8;++fe){var ne=P(re)-ee,ce=$(re);if(Math.abs(ne-ee)<uA||ce<uA)return N(re);re=G(re-ne/ce)}return N(re)};return q.isStepper=!1,q},VCe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,i=n===void 0?100:n,c=t.damping,d=c===void 0?8:c,m=t.dt,a=m===void 0?17:m,w=function(M,P,N){var $=-(M-P)*i,G=N*d,q=N+($-G)*a/1e3,V=N*a/1e3+M;return Math.abs(V-P)<uA&&Math.abs(q)<uA?[P,0]:[V,q]};return w.isStepper=!0,w.dt=a,w},UCe=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var c=n[0];if(typeof c=="string")switch(c){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return y8(c);case"spring":return VCe();default:if(c.split("(")[0]==="cubic-bezier")return y8(c)}return typeof c=="function"?c:null};function m1(e){"@babel/helpers - typeof";return m1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m1(e)}function _8(e){return HCe(e)||qCe(e)||IK(e)||$Ce()}function $Ce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HCe(e){if(Array.isArray(e))return oL(e)}function v8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Ll(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?v8(Object(n),!0).forEach(function(i){aL(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function aL(e,t,n){return t=GCe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GCe(e){var t=WCe(e,"string");return m1(t)==="symbol"?t:String(t)}function WCe(e,t){if(m1(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(m1(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XCe(e,t){return KCe(e)||YCe(e,t)||IK(e,t)||ZCe()}function ZCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IK(e,t){if(e){if(typeof e=="string")return oL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oL(e,t)}}function oL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function YCe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function KCe(e){if(Array.isArray(e))return e}var hA=function(t,n,i){return t+(n-t)*i},sL=function(t){var n=t.from,i=t.to;return n!==i},JCe=function e(t,n,i){var c=Iw(function(d,m){if(sL(m)){var a=t(m.from,m.to,m.velocity),w=XCe(a,2),S=w[0],M=w[1];return Ll(Ll({},m),{},{from:S,velocity:M})}return m},n);return i<1?Iw(function(d,m){return sL(m)?Ll(Ll({},m),{},{velocity:hA(m.velocity,c[d].velocity,i),from:hA(m.from,c[d].from,i)}):m},n):e(t,c,i-1)};const QCe=(function(e,t,n,i,c){var d=PCe(e,t),m=d.reduce(function(V,J){return Ll(Ll({},V),{},aL({},J,[e[J],t[J]]))},{}),a=d.reduce(function(V,J){return Ll(Ll({},V),{},aL({},J,{from:e[J],velocity:0,to:t[J]}))},{}),w=-1,S,M,P=function(){return null},N=function(){return Iw(function(J,ee){return ee.from},a)},$=function(){return!Object.values(a).filter(sL).length},G=function(J){S||(S=J);var ee=J-S,re=ee/n.dt;a=JCe(n,a,re),c(Ll(Ll(Ll({},e),t),N())),S=J,$()||(w=requestAnimationFrame(P))},q=function(J){M||(M=J);var ee=(J-M)/i,re=Iw(function(ne,ce){return hA.apply(void 0,_8(ce).concat([n(ee)]))},m);if(c(Ll(Ll(Ll({},e),t),re)),ee<1)w=requestAnimationFrame(P);else{var fe=Iw(function(ne,ce){return hA.apply(void 0,_8(ce).concat([n(1)]))},m);c(Ll(Ll(Ll({},e),t),fe))}};return P=n.isStepper?G:q,function(){return requestAnimationFrame(P),function(){cancelAnimationFrame(w)}}});function e0(e){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(e)}var eMe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function tMe(e,t){if(e==null)return{};var n=nMe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function nMe(e,t){if(e==null)return{};var n={},i=Object.keys(e),c,d;for(d=0;d<i.length;d++)c=i[d],!(t.indexOf(c)>=0)&&(n[c]=e[c]);return n}function FI(e){return oMe(e)||aMe(e)||iMe(e)||rMe()}function rMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iMe(e,t){if(e){if(typeof e=="string")return lL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lL(e,t)}}function aMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oMe(e){if(Array.isArray(e))return lL(e)}function lL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function x8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Fd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x8(Object(n),!0).forEach(function(i){vw(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function vw(e,t,n){return t=DK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lMe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,DK(i.key),i)}}function cMe(e,t,n){return t&&lMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DK(e){var t=uMe(e,"string");return e0(t)==="symbol"?t:String(t)}function uMe(e,t){if(e0(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(e0(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cL(e,t)}function cL(e,t){return cL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},cL(e,t)}function dMe(e){var t=fMe();return function(){var i=dA(e),c;if(t){var d=dA(this).constructor;c=Reflect.construct(i,arguments,d)}else c=i.apply(this,arguments);return uL(this,c)}}function uL(e,t){if(t&&(e0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hL(e)}function hL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dA(e){return dA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dA(e)}var Hm=(function(e){hMe(n,e);var t=dMe(n);function n(i,c){var d;sMe(this,n),d=t.call(this,i,c);var m=d.props,a=m.isActive,w=m.attributeName,S=m.from,M=m.to,P=m.steps,N=m.children,$=m.duration;if(d.handleStyleChange=d.handleStyleChange.bind(hL(d)),d.changeStyle=d.changeStyle.bind(hL(d)),!a||$<=0)return d.state={style:{}},typeof N=="function"&&(d.state={style:M}),uL(d);if(P&&P.length)d.state={style:P[0].style};else if(S){if(typeof N=="function")return d.state={style:S},uL(d);d.state={style:w?vw({},w,S):S}}else d.state={style:{}};return d}return cMe(n,[{key:"componentDidMount",value:function(){var c=this.props,d=c.isActive,m=c.canBegin;this.mounted=!0,!(!d||!m)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(c){var d=this.props,m=d.isActive,a=d.canBegin,w=d.attributeName,S=d.shouldReAnimate,M=d.to,P=d.from,N=this.state.style;if(a){if(!m){var $={style:w?vw({},w,M):M};this.state&&N&&(w&&N[w]!==M||!w&&N!==M)&&this.setState($);return}if(!(vCe(c.to,M)&&c.canBegin&&c.isActive)){var G=!c.canBegin||!c.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var q=G||S?P:c.to;if(this.state&&N){var V={style:w?vw({},w,q):q};(w&&N[w]!==q||!w&&N!==q)&&this.setState(V)}this.runAnimation(Fd(Fd({},this.props),{},{from:q,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var c=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),c&&c()}},{key:"handleStyleChange",value:function(c){this.changeStyle(c)}},{key:"changeStyle",value:function(c){this.mounted&&this.setState({style:c})}},{key:"runJSAnimation",value:function(c){var d=this,m=c.from,a=c.to,w=c.duration,S=c.easing,M=c.begin,P=c.onAnimationEnd,N=c.onAnimationStart,$=QCe(m,a,UCe(S),w,this.changeStyle),G=function(){d.stopJSAnimation=$()};this.manager.start([N,M,G,w,P])}},{key:"runStepAnimation",value:function(c){var d=this,m=c.steps,a=c.begin,w=c.onAnimationStart,S=m[0],M=S.style,P=S.duration,N=P===void 0?0:P,$=function(q,V,J){if(J===0)return q;var ee=V.duration,re=V.easing,fe=re===void 0?"ease":re,ne=V.style,ce=V.properties,me=V.onAnimationEnd,ve=J>0?m[J-1]:V,De=ce||Object.keys(ne);if(typeof fe=="function"||fe==="spring")return[].concat(FI(q),[d.runJSAnimation.bind(d,{from:ve.style,to:ne,duration:ee,easing:fe}),ee]);var Ye=m8(De,ee,fe),ze=Fd(Fd(Fd({},ve.style),ne),{},{transition:Ye});return[].concat(FI(q),[ze,ee,me]).filter(OCe)};return this.manager.start([w].concat(FI(m.reduce($,[M,Math.max(N,a)])),[c.onAnimationEnd]))}},{key:"runAnimation",value:function(c){this.manager||(this.manager=ACe());var d=c.begin,m=c.duration,a=c.attributeName,w=c.to,S=c.easing,M=c.onAnimationStart,P=c.onAnimationEnd,N=c.steps,$=c.children,G=this.manager;if(this.unSubscribe=G.subscribe(this.handleStyleChange),typeof S=="function"||typeof $=="function"||S==="spring"){this.runJSAnimation(c);return}if(N.length>1){this.runStepAnimation(c);return}var q=a?vw({},a,w):w,V=m8(Object.keys(q),m,S);G.start([M,d,Fd(Fd({},q),{},{transition:V}),m,P])}},{key:"render",value:function(){var c=this.props,d=c.children;c.begin;var m=c.duration;c.attributeName,c.easing;var a=c.isActive;c.steps,c.from,c.to,c.canBegin,c.onAnimationEnd,c.shouldReAnimate,c.onAnimationReStart;var w=tMe(c,eMe),S=K.Children.count(d),M=this.state.style;if(typeof d=="function")return d(M);if(!a||S===0||m<=0)return d;var P=function($){var G=$.props,q=G.style,V=q===void 0?{}:q,J=G.className,ee=K.cloneElement($,Fd(Fd({},w),{},{style:Fd(Fd({},V),M),className:J}));return ee};return S===1?P(K.Children.only(d)):Ce.createElement("div",null,K.Children.map(d,function(N){return P(N)}))}}]),n})(K.PureComponent);Hm.displayName="Animate";Hm.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Hm.propTypes={from:Ga.oneOfType([Ga.object,Ga.string]),to:Ga.oneOfType([Ga.object,Ga.string]),attributeName:Ga.string,duration:Ga.number,begin:Ga.number,easing:Ga.oneOfType([Ga.string,Ga.func]),steps:Ga.arrayOf(Ga.shape({duration:Ga.number.isRequired,style:Ga.object.isRequired,easing:Ga.oneOfType([Ga.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ga.func]),properties:Ga.arrayOf("string"),onAnimationEnd:Ga.func})),children:Ga.oneOfType([Ga.node,Ga.func]),isActive:Ga.bool,canBegin:Ga.bool,onAnimationEnd:Ga.func,shouldReAnimate:Ga.bool,onAnimationStart:Ga.func,onAnimationReStart:Ga.func};function g1(e){"@babel/helpers - typeof";return g1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g1(e)}function fA(){return fA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fA.apply(this,arguments)}function pMe(e,t){return _Me(e)||yMe(e,t)||gMe(e,t)||mMe()}function mMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gMe(e,t){if(e){if(typeof e=="string")return b8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b8(e,t)}}function b8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function yMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function _Me(e){if(Array.isArray(e))return e}function w8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function S8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w8(Object(n),!0).forEach(function(i){vMe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function vMe(e,t,n){return t=xMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xMe(e){var t=bMe(e,"string");return g1(t)=="symbol"?t:t+""}function bMe(e,t){if(g1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(g1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T8=function(t,n,i,c,d){var m=Math.min(Math.abs(i)/2,Math.abs(c)/2),a=c>=0?1:-1,w=i>=0?1:-1,S=c>=0&&i>=0||c<0&&i<0?1:0,M;if(m>0&&d instanceof Array){for(var P=[0,0,0,0],N=0,$=4;N<$;N++)P[N]=d[N]>m?m:d[N];M="M".concat(t,",").concat(n+a*P[0]),P[0]>0&&(M+="A ".concat(P[0],",").concat(P[0],",0,0,").concat(S,",").concat(t+w*P[0],",").concat(n)),M+="L ".concat(t+i-w*P[1],",").concat(n),P[1]>0&&(M+="A ".concat(P[1],",").concat(P[1],",0,0,").concat(S,`,
        `).concat(t+i,",").concat(n+a*P[1])),M+="L ".concat(t+i,",").concat(n+c-a*P[2]),P[2]>0&&(M+="A ".concat(P[2],",").concat(P[2],",0,0,").concat(S,`,
        `).concat(t+i-w*P[2],",").concat(n+c)),M+="L ".concat(t+w*P[3],",").concat(n+c),P[3]>0&&(M+="A ".concat(P[3],",").concat(P[3],",0,0,").concat(S,`,
        `).concat(t,",").concat(n+c-a*P[3])),M+="Z"}else if(m>0&&d===+d&&d>0){var G=Math.min(m,d);M="M ".concat(t,",").concat(n+a*G,`
            A `).concat(G,",").concat(G,",0,0,").concat(S,",").concat(t+w*G,",").concat(n,`
            L `).concat(t+i-w*G,",").concat(n,`
            A `).concat(G,",").concat(G,",0,0,").concat(S,",").concat(t+i,",").concat(n+a*G,`
            L `).concat(t+i,",").concat(n+c-a*G,`
            A `).concat(G,",").concat(G,",0,0,").concat(S,",").concat(t+i-w*G,",").concat(n+c,`
            L `).concat(t+w*G,",").concat(n+c,`
            A `).concat(G,",").concat(G,",0,0,").concat(S,",").concat(t,",").concat(n+c-a*G," Z")}else M="M ".concat(t,",").concat(n," h ").concat(i," v ").concat(c," h ").concat(-i," Z");return M},wMe=function(t,n){if(!t||!n)return!1;var i=t.x,c=t.y,d=n.x,m=n.y,a=n.width,w=n.height;if(Math.abs(a)>0&&Math.abs(w)>0){var S=Math.min(d,d+a),M=Math.max(d,d+a),P=Math.min(m,m+w),N=Math.max(m,m+w);return i>=S&&i<=M&&c>=P&&c<=N}return!1},SMe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tj=function(t){var n=S8(S8({},SMe),t),i=K.useRef(),c=K.useState(-1),d=pMe(c,2),m=d[0],a=d[1];K.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var fe=i.current.getTotalLength();fe&&a(fe)}catch{}},[]);var w=n.x,S=n.y,M=n.width,P=n.height,N=n.radius,$=n.className,G=n.animationEasing,q=n.animationDuration,V=n.animationBegin,J=n.isAnimationActive,ee=n.isUpdateAnimationActive;if(w!==+w||S!==+S||M!==+M||P!==+P||M===0||P===0)return null;var re=xa("recharts-rectangle",$);return ee?Ce.createElement(Hm,{canBegin:m>0,from:{width:M,height:P,x:w,y:S},to:{width:M,height:P,x:w,y:S},duration:q,animationEasing:G,isActive:ee},function(fe){var ne=fe.width,ce=fe.height,me=fe.x,ve=fe.y;return Ce.createElement(Hm,{canBegin:m>0,from:"0px ".concat(m===-1?1:m,"px"),to:"".concat(m,"px 0px"),attributeName:"strokeDasharray",begin:V,duration:q,isActive:J,easing:G},Ce.createElement("path",fA({},ha(n,!0),{className:re,d:T8(me,ve,ne,ce,N),ref:i})))}):Ce.createElement("path",fA({},ha(n,!0),{className:re,d:T8(w,S,M,P,N)}))};function dL(){return dL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},dL.apply(this,arguments)}var nj=function(t){var n=t.cx,i=t.cy,c=t.r,d=t.className,m=xa("recharts-dot",d);return n===+n&&i===+i&&c===+c?K.createElement("circle",dL({},ha(t,!1),LE(t),{className:m,cx:n,cy:i,r:c})):null};function y1(e){"@babel/helpers - typeof";return y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y1(e)}var TMe=["x","y","top","left","width","height","className"];function fL(){return fL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fL.apply(this,arguments)}function E8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function EMe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?E8(Object(n),!0).forEach(function(i){AMe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function AMe(e,t,n){return t=CMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CMe(e){var t=MMe(e,"string");return y1(t)=="symbol"?t:t+""}function MMe(e,t){if(y1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(y1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PMe(e,t){if(e==null)return{};var n=OMe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function OMe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var RMe=function(t,n,i,c,d,m){return"M".concat(t,",").concat(d,"v").concat(c,"M").concat(m,",").concat(n,"h").concat(i)},IMe=function(t){var n=t.x,i=n===void 0?0:n,c=t.y,d=c===void 0?0:c,m=t.top,a=m===void 0?0:m,w=t.left,S=w===void 0?0:w,M=t.width,P=M===void 0?0:M,N=t.height,$=N===void 0?0:N,G=t.className,q=PMe(t,TMe),V=EMe({x:i,y:d,top:a,left:S,width:P,height:$},q);return!rr(i)||!rr(d)||!rr(P)||!rr($)||!rr(a)||!rr(S)?null:Ce.createElement("path",fL({},ha(V,!0),{className:xa("recharts-cross",G),d:RMe(i,d,P,$,a,S)}))},VI,A8;function DMe(){if(A8)return VI;A8=1;var e=QZ(),t=e(Object.getPrototypeOf,Object);return VI=t,VI}var UI,C8;function kMe(){if(C8)return UI;C8=1;var e=Gm(),t=DMe(),n=Wm(),i="[object Object]",c=Function.prototype,d=Object.prototype,m=c.toString,a=d.hasOwnProperty,w=m.call(Object);function S(M){if(!n(M)||e(M)!=i)return!1;var P=t(M);if(P===null)return!0;var N=a.call(P,"constructor")&&P.constructor;return typeof N=="function"&&N instanceof N&&m.call(N)==w}return UI=S,UI}var LMe=kMe();const NMe=Wa(LMe);var $I,M8;function zMe(){if(M8)return $I;M8=1;var e=Gm(),t=Wm(),n="[object Boolean]";function i(c){return c===!0||c===!1||t(c)&&e(c)==n}return $I=i,$I}var jMe=zMe();const BMe=Wa(jMe);function _1(e){"@babel/helpers - typeof";return _1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_1(e)}function pA(){return pA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},pA.apply(this,arguments)}function FMe(e,t){return qMe(e)||$Me(e,t)||UMe(e,t)||VMe()}function VMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UMe(e,t){if(e){if(typeof e=="string")return P8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P8(e,t)}}function P8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function $Me(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function qMe(e){if(Array.isArray(e))return e}function O8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function R8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?O8(Object(n),!0).forEach(function(i){HMe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function HMe(e,t,n){return t=GMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GMe(e){var t=WMe(e,"string");return _1(t)=="symbol"?t:t+""}function WMe(e,t){if(_1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(_1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I8=function(t,n,i,c,d){var m=i-c,a;return a="M ".concat(t,",").concat(n),a+="L ".concat(t+i,",").concat(n),a+="L ".concat(t+i-m/2,",").concat(n+d),a+="L ".concat(t+i-m/2-c,",").concat(n+d),a+="L ".concat(t,",").concat(n," Z"),a},XMe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ZMe=function(t){var n=R8(R8({},XMe),t),i=K.useRef(),c=K.useState(-1),d=FMe(c,2),m=d[0],a=d[1];K.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var re=i.current.getTotalLength();re&&a(re)}catch{}},[]);var w=n.x,S=n.y,M=n.upperWidth,P=n.lowerWidth,N=n.height,$=n.className,G=n.animationEasing,q=n.animationDuration,V=n.animationBegin,J=n.isUpdateAnimationActive;if(w!==+w||S!==+S||M!==+M||P!==+P||N!==+N||M===0&&P===0||N===0)return null;var ee=xa("recharts-trapezoid",$);return J?Ce.createElement(Hm,{canBegin:m>0,from:{upperWidth:0,lowerWidth:0,height:N,x:w,y:S},to:{upperWidth:M,lowerWidth:P,height:N,x:w,y:S},duration:q,animationEasing:G,isActive:J},function(re){var fe=re.upperWidth,ne=re.lowerWidth,ce=re.height,me=re.x,ve=re.y;return Ce.createElement(Hm,{canBegin:m>0,from:"0px ".concat(m===-1?1:m,"px"),to:"".concat(m,"px 0px"),attributeName:"strokeDasharray",begin:V,duration:q,easing:G},Ce.createElement("path",pA({},ha(n,!0),{className:ee,d:I8(me,ve,fe,ne,ce),ref:i})))}):Ce.createElement("g",null,Ce.createElement("path",pA({},ha(n,!0),{className:ee,d:I8(w,S,M,P,N)})))},YMe=["option","shapeType","propTransformer","activeClassName","isActive"];function v1(e){"@babel/helpers - typeof";return v1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v1(e)}function KMe(e,t){if(e==null)return{};var n=JMe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function JMe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function D8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function mA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D8(Object(n),!0).forEach(function(i){QMe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function QMe(e,t,n){return t=ePe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ePe(e){var t=tPe(e,"string");return v1(t)=="symbol"?t:t+""}function tPe(e,t){if(v1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(v1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nPe(e,t){return mA(mA({},t),e)}function rPe(e,t){return e==="symbols"}function k8(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return Ce.createElement(tj,n);case"trapezoid":return Ce.createElement(ZMe,n);case"sector":return Ce.createElement(AK,n);case"symbols":if(rPe(t))return Ce.createElement(xz,n);break;default:return null}}function iPe(e){return K.isValidElement(e)?e.props:e}function aPe(e){var t=e.option,n=e.shapeType,i=e.propTransformer,c=i===void 0?nPe:i,d=e.activeClassName,m=d===void 0?"recharts-active-shape":d,a=e.isActive,w=KMe(e,YMe),S;if(K.isValidElement(t))S=K.cloneElement(t,mA(mA({},w),iPe(t)));else if(Hi(t))S=t(w);else if(NMe(t)&&!BMe(t)){var M=c(t,w);S=Ce.createElement(k8,{shapeType:n,elementProps:M})}else{var P=w;S=Ce.createElement(k8,{shapeType:n,elementProps:P})}return a?Ce.createElement(as,{className:m},S):S}function Y2(e,t){return t!=null&&"trapezoids"in e.props}function K2(e,t){return t!=null&&"sectors"in e.props}function x1(e,t){return t!=null&&"points"in e.props}function oPe(e,t){var n,i,c=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,d=e.y===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.y)||e.y===t.y;return c&&d}function sPe(e,t){var n=e.endAngle===t.endAngle,i=e.startAngle===t.startAngle;return n&&i}function lPe(e,t){var n=e.x===t.x,i=e.y===t.y,c=e.z===t.z;return n&&i&&c}function cPe(e,t){var n;return Y2(e,t)?n=oPe:K2(e,t)?n=sPe:x1(e,t)&&(n=lPe),n}function uPe(e,t){var n;return Y2(e,t)?n="trapezoids":K2(e,t)?n="sectors":x1(e,t)&&(n="points"),n}function hPe(e,t){if(Y2(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(K2(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return x1(e,t)?t.payload:{}}function dPe(e){var t=e.activeTooltipItem,n=e.graphicalItem,i=e.itemData,c=uPe(n,t),d=hPe(n,t),m=i.filter(function(w,S){var M=r1(d,w),P=n.props[c].filter(function(G){var q=cPe(n,t);return q(G,t)}),N=n.props[c].indexOf(P[P.length-1]),$=S===N;return M&&$}),a=i.indexOf(m[m.length-1]);return a}var qI,L8;function fPe(){if(L8)return qI;L8=1;var e=Math.ceil,t=Math.max;function n(i,c,d,m){for(var a=-1,w=t(e((c-i)/(d||1)),0),S=Array(w);w--;)S[m?w:++a]=i,i+=d;return S}return qI=n,qI}var HI,N8;function kK(){if(N8)return HI;N8=1;var e=mY(),t=1/0,n=17976931348623157e292;function i(c){if(!c)return c===0?c:0;if(c=e(c),c===t||c===-t){var d=c<0?-1:1;return d*n}return c===c?c:0}return HI=i,HI}var GI,z8;function pPe(){if(z8)return GI;z8=1;var e=fPe(),t=B2(),n=kK();function i(c){return function(d,m,a){return a&&typeof a!="number"&&t(d,m,a)&&(m=a=void 0),d=n(d),m===void 0?(m=d,d=0):m=n(m),a=a===void 0?d<m?1:-1:n(a),e(d,m,a,c)}}return GI=i,GI}var WI,j8;function mPe(){if(j8)return WI;j8=1;var e=pPe(),t=e();return WI=t,WI}var gPe=mPe();const gA=Wa(gPe);function b1(e){"@babel/helpers - typeof";return b1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b1(e)}function B8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function F8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B8(Object(n),!0).forEach(function(i){LK(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function LK(e,t,n){return t=yPe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yPe(e){var t=_Pe(e,"string");return b1(t)=="symbol"?t:t+""}function _Pe(e,t){if(b1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(b1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vPe=["Webkit","Moz","O","ms"],xPe=function(t,n){var i=t.replace(/(\w)/,function(d){return d.toUpperCase()}),c=vPe.reduce(function(d,m){return F8(F8({},d),{},LK({},m+i,n))},{});return c[t]=n,c};function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function yA(){return yA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},yA.apply(this,arguments)}function V8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function XI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V8(Object(n),!0).forEach(function(i){Yu(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function bPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U8(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,zK(i.key),i)}}function wPe(e,t,n){return t&&U8(e.prototype,t),n&&U8(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function SPe(e,t,n){return t=_A(t),TPe(e,NK()?Reflect.construct(t,n||[],_A(e).constructor):t.apply(e,n))}function TPe(e,t){if(t&&(t0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EPe(e)}function EPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NK=function(){return!!e})()}function _A(e){return _A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},_A(e)}function APe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pL(e,t)}function pL(e,t){return pL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},pL(e,t)}function Yu(e,t,n){return t=zK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zK(e){var t=CPe(e,"string");return t0(t)=="symbol"?t:t+""}function CPe(e,t){if(t0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(t0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var MPe=function(t){var n=t.data,i=t.startIndex,c=t.endIndex,d=t.x,m=t.width,a=t.travellerWidth;if(!n||!n.length)return{};var w=n.length,S=Pw().domain(gA(0,w)).range([d,d+m-a]),M=S.domain().map(function(P){return S(P)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:S(i),endX:S(c),scale:S,scaleValues:M}},$8=function(t){return t.changedTouches&&!!t.changedTouches.length},n0=(function(e){function t(n){var i;return bPe(this,t),i=SPe(this,t,[n]),Yu(i,"handleDrag",function(c){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(c):i.state.isSlideMoving&&i.handleSlideDrag(c)}),Yu(i,"handleTouchMove",function(c){c.changedTouches!=null&&c.changedTouches.length>0&&i.handleDrag(c.changedTouches[0])}),Yu(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var c=i.props,d=c.endIndex,m=c.onDragEnd,a=c.startIndex;m?.({endIndex:d,startIndex:a})}),i.detachDragEndListener()}),Yu(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Yu(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Yu(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Yu(i,"handleSlideDragStart",function(c){var d=$8(c)?c.changedTouches[0]:c;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:d.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return APe(t,e),wPe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var c=i.startX,d=i.endX,m=this.state.scaleValues,a=this.props,w=a.gap,S=a.data,M=S.length-1,P=Math.min(c,d),N=Math.max(c,d),$=t.getIndexInRange(m,P),G=t.getIndexInRange(m,N);return{startIndex:$-$%w,endIndex:G===M?M:G-G%w}}},{key:"getTextOfTick",value:function(i){var c=this.props,d=c.data,m=c.tickFormatter,a=c.dataKey,w=rh(d[i],a,i);return Hi(m)?m(w,i):w}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var c=this.state,d=c.slideMoveStartX,m=c.startX,a=c.endX,w=this.props,S=w.x,M=w.width,P=w.travellerWidth,N=w.startIndex,$=w.endIndex,G=w.onChange,q=i.pageX-d;q>0?q=Math.min(q,S+M-P-a,S+M-P-m):q<0&&(q=Math.max(q,S-m,S-a));var V=this.getIndex({startX:m+q,endX:a+q});(V.startIndex!==N||V.endIndex!==$)&&G&&G(V),this.setState({startX:m+q,endX:a+q,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,c){var d=$8(c)?c.changedTouches[0]:c;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:d.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var c=this.state,d=c.brushMoveStartX,m=c.movingTravellerId,a=c.endX,w=c.startX,S=this.state[m],M=this.props,P=M.x,N=M.width,$=M.travellerWidth,G=M.onChange,q=M.gap,V=M.data,J={startX:this.state.startX,endX:this.state.endX},ee=i.pageX-d;ee>0?ee=Math.min(ee,P+N-$-S):ee<0&&(ee=Math.max(ee,P-S)),J[m]=S+ee;var re=this.getIndex(J),fe=re.startIndex,ne=re.endIndex,ce=function(){var ve=V.length-1;return m==="startX"&&(a>w?fe%q===0:ne%q===0)||a<w&&ne===ve||m==="endX"&&(a>w?ne%q===0:fe%q===0)||a>w&&ne===ve};this.setState(Yu(Yu({},m,S+ee),"brushMoveStartX",i.pageX),function(){G&&ce()&&G(re)})}},{key:"handleTravellerMoveKeyboard",value:function(i,c){var d=this,m=this.state,a=m.scaleValues,w=m.startX,S=m.endX,M=this.state[c],P=a.indexOf(M);if(P!==-1){var N=P+i;if(!(N===-1||N>=a.length)){var $=a[N];c==="startX"&&$>=S||c==="endX"&&$<=w||this.setState(Yu({},c,$),function(){d.props.onChange(d.getIndex({startX:d.state.startX,endX:d.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,c=i.x,d=i.y,m=i.width,a=i.height,w=i.fill,S=i.stroke;return Ce.createElement("rect",{stroke:S,fill:w,x:c,y:d,width:m,height:a})}},{key:"renderPanorama",value:function(){var i=this.props,c=i.x,d=i.y,m=i.width,a=i.height,w=i.data,S=i.children,M=i.padding,P=K.Children.only(S);return P?Ce.cloneElement(P,{x:c,y:d,width:m,height:a,margin:M,compact:!0,data:w}):null}},{key:"renderTravellerLayer",value:function(i,c){var d,m,a=this,w=this.props,S=w.y,M=w.travellerWidth,P=w.height,N=w.traveller,$=w.ariaLabel,G=w.data,q=w.startIndex,V=w.endIndex,J=Math.max(i,this.props.x),ee=XI(XI({},ha(this.props,!1)),{},{x:J,y:S,width:M,height:P}),re=$||"Min value: ".concat((d=G[q])===null||d===void 0?void 0:d.name,", Max value: ").concat((m=G[V])===null||m===void 0?void 0:m.name);return Ce.createElement(as,{tabIndex:0,role:"slider","aria-label":re,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[c],onTouchStart:this.travellerDragStartHandlers[c],onKeyDown:function(ne){["ArrowLeft","ArrowRight"].includes(ne.key)&&(ne.preventDefault(),ne.stopPropagation(),a.handleTravellerMoveKeyboard(ne.key==="ArrowRight"?1:-1,c))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(N,ee))}},{key:"renderSlide",value:function(i,c){var d=this.props,m=d.y,a=d.height,w=d.stroke,S=d.travellerWidth,M=Math.min(i,c)+S,P=Math.max(Math.abs(c-i)-S,0);return Ce.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:w,fillOpacity:.2,x:M,y:m,width:P,height:a})}},{key:"renderText",value:function(){var i=this.props,c=i.startIndex,d=i.endIndex,m=i.y,a=i.height,w=i.travellerWidth,S=i.stroke,M=this.state,P=M.startX,N=M.endX,$=5,G={pointerEvents:"none",fill:S};return Ce.createElement(as,{className:"recharts-brush-texts"},Ce.createElement(WE,yA({textAnchor:"end",verticalAnchor:"middle",x:Math.min(P,N)-$,y:m+a/2},G),this.getTextOfTick(c)),Ce.createElement(WE,yA({textAnchor:"start",verticalAnchor:"middle",x:Math.max(P,N)+w+$,y:m+a/2},G),this.getTextOfTick(d)))}},{key:"render",value:function(){var i=this.props,c=i.data,d=i.className,m=i.children,a=i.x,w=i.y,S=i.width,M=i.height,P=i.alwaysShowText,N=this.state,$=N.startX,G=N.endX,q=N.isTextActive,V=N.isSlideMoving,J=N.isTravellerMoving,ee=N.isTravellerFocused;if(!c||!c.length||!rr(a)||!rr(w)||!rr(S)||!rr(M)||S<=0||M<=0)return null;var re=xa("recharts-brush",d),fe=Ce.Children.count(m)===1,ne=xPe("userSelect","none");return Ce.createElement(as,{className:re,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ne},this.renderBackground(),fe&&this.renderPanorama(),this.renderSlide($,G),this.renderTravellerLayer($,"startX"),this.renderTravellerLayer(G,"endX"),(q||V||J||ee||P)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var c=i.x,d=i.y,m=i.width,a=i.height,w=i.stroke,S=Math.floor(d+a/2)-1;return Ce.createElement(Ce.Fragment,null,Ce.createElement("rect",{x:c,y:d,width:m,height:a,fill:w,stroke:"none"}),Ce.createElement("line",{x1:c+1,y1:S,x2:c+m-1,y2:S,fill:"none",stroke:"#fff"}),Ce.createElement("line",{x1:c+1,y1:S+2,x2:c+m-1,y2:S+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,c){var d;return Ce.isValidElement(i)?d=Ce.cloneElement(i,c):Hi(i)?d=i(c):d=t.renderDefaultTraveller(c),d}},{key:"getDerivedStateFromProps",value:function(i,c){var d=i.data,m=i.width,a=i.x,w=i.travellerWidth,S=i.updateId,M=i.startIndex,P=i.endIndex;if(d!==c.prevData||S!==c.prevUpdateId)return XI({prevData:d,prevTravellerWidth:w,prevUpdateId:S,prevX:a,prevWidth:m},d&&d.length?MPe({data:d,width:m,x:a,travellerWidth:w,startIndex:M,endIndex:P}):{scale:null,scaleValues:null});if(c.scale&&(m!==c.prevWidth||a!==c.prevX||w!==c.prevTravellerWidth)){c.scale.range([a,a+m-w]);var N=c.scale.domain().map(function($){return c.scale($)});return{prevData:d,prevTravellerWidth:w,prevUpdateId:S,prevX:a,prevWidth:m,startX:c.scale(i.startIndex),endX:c.scale(i.endIndex),scaleValues:N}}return null}},{key:"getIndexInRange",value:function(i,c){for(var d=i.length,m=0,a=d-1;a-m>1;){var w=Math.floor((m+a)/2);i[w]>c?a=w:m=w}return c>=i[a]?a:m}}])})(K.PureComponent);Yu(n0,"displayName","Brush");Yu(n0,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var ZI,q8;function PPe(){if(q8)return ZI;q8=1;var e=Cz();function t(n,i){var c;return e(n,function(d,m,a){return c=i(d,m,a),!c}),!!c}return ZI=t,ZI}var YI,H8;function OPe(){if(H8)return YI;H8=1;var e=GZ(),t=vy(),n=PPe(),i=du(),c=B2();function d(m,a,w){var S=i(m)?e:n;return w&&c(m,a,w)&&(a=void 0),S(m,t(a,3))}return YI=d,YI}var RPe=OPe();const IPe=Wa(RPe);var fp=function(t,n){var i=t.alwaysShow,c=t.ifOverflow;return i&&(c="extendDomain"),c===n},KI,G8;function DPe(){if(G8)return KI;G8=1;var e=uY();function t(n,i,c){i=="__proto__"&&e?e(n,i,{configurable:!0,enumerable:!0,value:c,writable:!0}):n[i]=c}return KI=t,KI}var JI,W8;function kPe(){if(W8)return JI;W8=1;var e=DPe(),t=lY(),n=vy();function i(c,d){var m={};return d=n(d,3),t(c,function(a,w,S){e(m,w,d(a,w,S))}),m}return JI=i,JI}var LPe=kPe();const NPe=Wa(LPe);var QI,X8;function zPe(){if(X8)return QI;X8=1;function e(t,n){for(var i=-1,c=t==null?0:t.length;++i<c;)if(!n(t[i],i,t))return!1;return!0}return QI=e,QI}var eD,Z8;function jPe(){if(Z8)return eD;Z8=1;var e=Cz();function t(n,i){var c=!0;return e(n,function(d,m,a){return c=!!i(d,m,a),c}),c}return eD=t,eD}var tD,Y8;function BPe(){if(Y8)return tD;Y8=1;var e=zPe(),t=jPe(),n=vy(),i=du(),c=B2();function d(m,a,w){var S=i(m)?e:t;return w&&c(m,a,w)&&(a=void 0),S(m,n(a,3))}return tD=d,tD}var FPe=BPe();const jK=Wa(FPe);var VPe=["x","y"];function w1(e){"@babel/helpers - typeof";return w1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w1(e)}function mL(){return mL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mL.apply(this,arguments)}function K8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function sw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K8(Object(n),!0).forEach(function(i){UPe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function UPe(e,t,n){return t=$Pe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Pe(e){var t=qPe(e,"string");return w1(t)=="symbol"?t:t+""}function qPe(e,t){if(w1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(w1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HPe(e,t){if(e==null)return{};var n=GPe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function GPe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function WPe(e,t){var n=e.x,i=e.y,c=HPe(e,VPe),d="".concat(n),m=parseInt(d,10),a="".concat(i),w=parseInt(a,10),S="".concat(t.height||c.height),M=parseInt(S,10),P="".concat(t.width||c.width),N=parseInt(P,10);return sw(sw(sw(sw(sw({},t),c),m?{x:m}:{}),w?{y:w}:{}),{},{height:M,width:N,name:t.name,radius:t.radius})}function J8(e){return Ce.createElement(aPe,mL({shapeType:"rectangle",propTransformer:WPe,activeClassName:"recharts-active-bar"},e))}var XPe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,c){if(typeof t=="number")return t;var d=rr(i)||rxe(i);return d?t(i,c):(d||tv(),n)}},ZPe=["value","background"],BK;function r0(e){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r0(e)}function YPe(e,t){if(e==null)return{};var n=KPe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function KPe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function vA(){return vA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},vA.apply(this,arguments)}function Q8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Fs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q8(Object(n),!0).forEach(function(i){iy(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function JPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,VK(i.key),i)}}function QPe(e,t,n){return t&&eH(e.prototype,t),n&&eH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function eOe(e,t,n){return t=xA(t),tOe(e,FK()?Reflect.construct(t,n||[],xA(e).constructor):t.apply(e,n))}function tOe(e,t){if(t&&(r0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nOe(e)}function nOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FK=function(){return!!e})()}function xA(e){return xA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},xA(e)}function rOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gL(e,t)}function gL(e,t){return gL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},gL(e,t)}function iy(e,t,n){return t=VK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VK(e){var t=iOe(e,"string");return r0(t)=="symbol"?t:t+""}function iOe(e,t){if(r0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(r0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var lS=(function(e){function t(){var n;JPe(this,t);for(var i=arguments.length,c=new Array(i),d=0;d<i;d++)c[d]=arguments[d];return n=eOe(this,t,[].concat(c)),iy(n,"state",{isAnimationFinished:!1}),iy(n,"id",nS("recharts-bar-")),iy(n,"handleAnimationEnd",function(){var m=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),m&&m()}),iy(n,"handleAnimationStart",function(){var m=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),m&&m()}),n}return rOe(t,e),QPe(t,[{key:"renderRectanglesStatically",value:function(i){var c=this,d=this.props,m=d.shape,a=d.dataKey,w=d.activeIndex,S=d.activeBar,M=ha(this.props,!1);return i&&i.map(function(P,N){var $=N===w,G=$?S:m,q=Fs(Fs(Fs({},M),P),{},{isActive:$,option:G,index:N,dataKey:a,onAnimationStart:c.handleAnimationStart,onAnimationEnd:c.handleAnimationEnd});return Ce.createElement(as,vA({className:"recharts-bar-rectangle"},NE(c.props,P,N),{key:"rectangle-".concat(P?.x,"-").concat(P?.y,"-").concat(P?.value,"-").concat(N)}),Ce.createElement(J8,q))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,c=this.props,d=c.data,m=c.layout,a=c.isAnimationActive,w=c.animationBegin,S=c.animationDuration,M=c.animationEasing,P=c.animationId,N=this.state.prevData;return Ce.createElement(Hm,{begin:w,duration:S,isActive:a,easing:M,from:{t:0},to:{t:1},key:"bar-".concat(P),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function($){var G=$.t,q=d.map(function(V,J){var ee=N&&N[J];if(ee){var re=Wh(ee.x,V.x),fe=Wh(ee.y,V.y),ne=Wh(ee.width,V.width),ce=Wh(ee.height,V.height);return Fs(Fs({},V),{},{x:re(G),y:fe(G),width:ne(G),height:ce(G)})}if(m==="horizontal"){var me=Wh(0,V.height),ve=me(G);return Fs(Fs({},V),{},{y:V.y+V.height-ve,height:ve})}var De=Wh(0,V.width),Ye=De(G);return Fs(Fs({},V),{},{width:Ye})});return Ce.createElement(as,null,i.renderRectanglesStatically(q))})}},{key:"renderRectangles",value:function(){var i=this.props,c=i.data,d=i.isAnimationActive,m=this.state.prevData;return d&&c&&c.length&&(!m||!r1(m,c))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(c)}},{key:"renderBackground",value:function(){var i=this,c=this.props,d=c.data,m=c.dataKey,a=c.activeIndex,w=ha(this.props.background,!1);return d.map(function(S,M){S.value;var P=S.background,N=YPe(S,ZPe);if(!P)return null;var $=Fs(Fs(Fs(Fs(Fs({},N),{},{fill:"#eee"},P),w),NE(i.props,S,M)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:m,index:M,className:"recharts-bar-background-rectangle"});return Ce.createElement(J8,vA({key:"background-bar-".concat(M),option:i.props.background,isActive:M===a},$))})}},{key:"renderErrorBar",value:function(i,c){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var d=this.props,m=d.data,a=d.xAxis,w=d.yAxis,S=d.layout,M=d.children,P=Zd(M,Z2);if(!P)return null;var N=S==="vertical"?m[0].height/2:m[0].width/2,$=function(V,J){var ee=Array.isArray(V.value)?V.value[1]:V.value;return{x:V.x,y:V.y,value:ee,errorVal:rh(V,J)}},G={clipPath:i?"url(#clipPath-".concat(c,")"):null};return Ce.createElement(as,G,P.map(function(q){return Ce.cloneElement(q,{key:"error-bar-".concat(c,"-").concat(q.props.dataKey),data:m,xAxis:a,yAxis:w,layout:S,offset:N,dataPointFormatter:$})}))}},{key:"render",value:function(){var i=this.props,c=i.hide,d=i.data,m=i.className,a=i.xAxis,w=i.yAxis,S=i.left,M=i.top,P=i.width,N=i.height,$=i.isAnimationActive,G=i.background,q=i.id;if(c||!d||!d.length)return null;var V=this.state.isAnimationFinished,J=xa("recharts-bar",m),ee=a&&a.allowDataOverflow,re=w&&w.allowDataOverflow,fe=ee||re,ne=ga(q)?this.id:q;return Ce.createElement(as,{className:J},ee||re?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(ne)},Ce.createElement("rect",{x:ee?S:S-P/2,y:re?M:M-N/2,width:ee?P:P*2,height:re?N:N*2}))):null,Ce.createElement(as,{className:"recharts-bar-rectangles",clipPath:fe?"url(#clipPath-".concat(ne,")"):null},G?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(fe,ne),(!$||V)&&ly.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(i,c){return i.animationId!==c.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:c.curData}:i.data!==c.curData?{curData:i.data}:null}}])})(K.PureComponent);BK=lS;iy(lS,"displayName","Bar");iy(lS,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!D0.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});iy(lS,"getComposedData",function(e){var t=e.props,n=e.item,i=e.barPosition,c=e.bandSize,d=e.xAxis,m=e.yAxis,a=e.xAxisTicks,w=e.yAxisTicks,S=e.stackedData,M=e.dataStartIndex,P=e.displayedData,N=e.offset,$=SAe(i,n);if(!$)return null;var G=t.layout,q=n.type.defaultProps,V=q!==void 0?Fs(Fs({},q),n.props):n.props,J=V.dataKey,ee=V.children,re=V.minPointSize,fe=G==="horizontal"?m:d,ne=S?fe.scale.domain():null,ce=RAe({numericAxis:fe}),me=Zd(ee,yY),ve=P.map(function(De,Ye){var ze,tt,at,ct,ht,Ie;S?ze=TAe(S[M+Ye],ne):(ze=rh(De,J),Array.isArray(ze)||(ze=[ce,ze]));var rt=XPe(re,BK.defaultProps.minPointSize)(ze[1],Ye);if(G==="horizontal"){var Qe,St=[m.scale(ze[0]),m.scale(ze[1])],qe=St[0],vt=St[1];tt=zq({axis:d,ticks:a,bandSize:c,offset:$.offset,entry:De,index:Ye}),at=(Qe=vt??qe)!==null&&Qe!==void 0?Qe:void 0,ct=$.size;var nt=qe-vt;if(ht=Number.isNaN(nt)?0:nt,Ie={x:tt,y:m.y,width:ct,height:m.height},Math.abs(rt)>0&&Math.abs(ht)<Math.abs(rt)){var gt=Wd(ht||rt)*(Math.abs(rt)-Math.abs(ht));at-=gt,ht+=gt}}else{var Ut=[d.scale(ze[0]),d.scale(ze[1])],$t=Ut[0],qt=Ut[1];if(tt=$t,at=zq({axis:m,ticks:w,bandSize:c,offset:$.offset,entry:De,index:Ye}),ct=qt-$t,ht=$.size,Ie={x:d.x,y:at,width:d.width,height:ht},Math.abs(rt)>0&&Math.abs(ct)<Math.abs(rt)){var Ht=Wd(ct||rt)*(Math.abs(rt)-Math.abs(ct));ct+=Ht}}return Fs(Fs(Fs({},De),{},{x:tt,y:at,width:ct,height:ht,value:S?ze:ze[1],payload:De,background:Ie},me&&me[Ye]&&me[Ye].props),{},{tooltipPayload:[SK(n,De)],tooltipPosition:{x:tt+ct/2,y:at+ht/2}})});return Fs({data:ve,layout:G},N)});function S1(e){"@babel/helpers - typeof";return S1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S1(e)}function aOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,UK(i.key),i)}}function oOe(e,t,n){return t&&tH(e.prototype,t),n&&tH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function qd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nH(Object(n),!0).forEach(function(i){J2(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function J2(e,t,n){return t=UK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UK(e){var t=sOe(e,"string");return S1(t)=="symbol"?t:t+""}function sOe(e,t){if(S1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(S1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lOe=function(t,n,i,c,d){var m=t.width,a=t.height,w=t.layout,S=t.children,M=Object.keys(n),P={left:i.left,leftMirror:i.left,right:m-i.right,rightMirror:m-i.right,top:i.top,topMirror:i.top,bottom:a-i.bottom,bottomMirror:a-i.bottom},N=!!Ku(S,lS);return M.reduce(function($,G){var q=n[G],V=q.orientation,J=q.domain,ee=q.padding,re=ee===void 0?{}:ee,fe=q.mirror,ne=q.reversed,ce="".concat(V).concat(fe?"Mirror":""),me,ve,De,Ye,ze;if(q.type==="number"&&(q.padding==="gap"||q.padding==="no-gap")){var tt=J[1]-J[0],at=1/0,ct=q.categoricalDomain.sort(oxe);if(ct.forEach(function(Ut,$t){$t>0&&(at=Math.min((Ut||0)-(ct[$t-1]||0),at))}),Number.isFinite(at)){var ht=at/tt,Ie=q.layout==="vertical"?i.height:i.width;if(q.padding==="gap"&&(me=ht*Ie/2),q.padding==="no-gap"){var rt=Q_(t.barCategoryGap,ht*Ie),Qe=ht*Ie/2;me=Qe-rt-(Qe-rt)/Ie*rt}}}c==="xAxis"?ve=[i.left+(re.left||0)+(me||0),i.left+i.width-(re.right||0)-(me||0)]:c==="yAxis"?ve=w==="horizontal"?[i.top+i.height-(re.bottom||0),i.top+(re.top||0)]:[i.top+(re.top||0)+(me||0),i.top+i.height-(re.bottom||0)-(me||0)]:ve=q.range,ne&&(ve=[ve[1],ve[0]]);var St=bAe(q,d,N),qe=St.scale,vt=St.realScaleType;qe.domain(J).range(ve),wAe(qe);var nt=OAe(qe,qd(qd({},q),{},{realScaleType:vt}));c==="xAxis"?(ze=V==="top"&&!fe||V==="bottom"&&fe,De=i.left,Ye=P[ce]-ze*q.height):c==="yAxis"&&(ze=V==="left"&&!fe||V==="right"&&fe,De=P[ce]-ze*q.width,Ye=i.top);var gt=qd(qd(qd({},q),nt),{},{realScaleType:vt,x:De,y:Ye,scale:qe,width:c==="xAxis"?i.width:q.width,height:c==="yAxis"?i.height:q.height});return gt.bandSize=sA(gt,nt),!q.hide&&c==="xAxis"?P[ce]+=(ze?-1:1)*gt.height:q.hide||(P[ce]+=(ze?-1:1)*gt.width),qd(qd({},$),{},J2({},G,gt))},{})},$K=function(t,n){var i=t.x,c=t.y,d=n.x,m=n.y;return{x:Math.min(i,d),y:Math.min(c,m),width:Math.abs(d-i),height:Math.abs(m-c)}},cOe=function(t){var n=t.x1,i=t.y1,c=t.x2,d=t.y2;return $K({x:n,y:i},{x:c,y:d})},qK=(function(){function e(t){aOe(this,e),this.scale=t}return oOe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=i.bandAware,d=i.position;if(n!==void 0){if(d)switch(d){case"start":return this.scale(n);case"middle":{var m=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+m}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(n)+a}default:return this.scale(n)}if(c){var w=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+w}return this.scale(n)}}},{key:"isInRange",value:function(n){var i=this.range(),c=i[0],d=i[i.length-1];return c<=d?n>=c&&n<=d:n>=d&&n<=c}}],[{key:"create",value:function(n){return new e(n)}}])})();J2(qK,"EPS",1e-4);var rj=function(t){var n=Object.keys(t).reduce(function(i,c){return qd(qd({},i),{},J2({},c,qK.create(t[c])))},{});return qd(qd({},n),{},{apply:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=d.bandAware,a=d.position;return NPe(c,function(w,S){return n[S].apply(w,{bandAware:m,position:a})})},isInRange:function(c){return jK(c,function(d,m){return n[m].isInRange(d)})}})};function uOe(e){return(e%180+180)%180}var hOe=function(t){var n=t.width,i=t.height,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=uOe(c),m=d*Math.PI/180,a=Math.atan(i/n),w=m>a&&m<Math.PI-a?i/Math.sin(m):n/Math.cos(m);return Math.abs(w)},nD,rH;function dOe(){if(rH)return nD;rH=1;var e=vy(),t=rS(),n=z2();function i(c){return function(d,m,a){var w=Object(d);if(!t(d)){var S=e(m,3);d=n(d),m=function(P){return S(w[P],P,w)}}var M=c(d,m,a);return M>-1?w[S?d[M]:M]:void 0}}return nD=i,nD}var rD,iH;function fOe(){if(iH)return rD;iH=1;var e=kK();function t(n){var i=e(n),c=i%1;return i===i?c?i-c:i:0}return rD=t,rD}var iD,aH;function pOe(){if(aH)return iD;aH=1;var e=rY(),t=vy(),n=fOe(),i=Math.max;function c(d,m,a){var w=d==null?0:d.length;if(!w)return-1;var S=a==null?0:n(a);return S<0&&(S=i(w+S,0)),e(d,t(m,3),S)}return iD=c,iD}var aD,oH;function mOe(){if(oH)return aD;oH=1;var e=dOe(),t=pOe(),n=e(t);return aD=n,aD}var gOe=mOe();const yOe=Wa(gOe);var _Oe=vZ();const vOe=Wa(_Oe);var xOe=vOe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),ij=K.createContext(void 0),aj=K.createContext(void 0),HK=K.createContext(void 0),GK=K.createContext({}),WK=K.createContext(void 0),XK=K.createContext(0),ZK=K.createContext(0),sH=function(t){var n=t.state,i=n.xAxisMap,c=n.yAxisMap,d=n.offset,m=t.clipPathId,a=t.children,w=t.width,S=t.height,M=xOe(d);return Ce.createElement(ij.Provider,{value:i},Ce.createElement(aj.Provider,{value:c},Ce.createElement(GK.Provider,{value:d},Ce.createElement(HK.Provider,{value:M},Ce.createElement(WK.Provider,{value:m},Ce.createElement(XK.Provider,{value:S},Ce.createElement(ZK.Provider,{value:w},a)))))))},bOe=function(){return K.useContext(WK)},YK=function(t){var n=K.useContext(ij);n==null&&tv();var i=n[t];return i==null&&tv(),i},wOe=function(){var t=K.useContext(ij);return ny(t)},SOe=function(){var t=K.useContext(aj),n=yOe(t,function(i){return jK(i.domain,Number.isFinite)});return n||ny(t)},KK=function(t){var n=K.useContext(aj);n==null&&tv();var i=n[t];return i==null&&tv(),i},TOe=function(){var t=K.useContext(HK);return t},EOe=function(){return K.useContext(GK)},oj=function(){return K.useContext(ZK)},sj=function(){return K.useContext(XK)};function i0(e){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i0(e)}function AOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function COe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,QK(i.key),i)}}function MOe(e,t,n){return t&&COe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function POe(e,t,n){return t=bA(t),OOe(e,JK()?Reflect.construct(t,n||[],bA(e).constructor):t.apply(e,n))}function OOe(e,t){if(t&&(i0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ROe(e)}function ROe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JK=function(){return!!e})()}function bA(e){return bA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},bA(e)}function IOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yL(e,t)}function yL(e,t){return yL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},yL(e,t)}function lH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function cH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lH(Object(n),!0).forEach(function(i){lj(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function lj(e,t,n){return t=QK(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QK(e){var t=DOe(e,"string");return i0(t)=="symbol"?t:t+""}function DOe(e,t){if(i0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(i0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function kOe(e,t){return jOe(e)||zOe(e,t)||NOe(e,t)||LOe()}function LOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NOe(e,t){if(e){if(typeof e=="string")return uH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uH(e,t)}}function uH(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function zOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function jOe(e){if(Array.isArray(e))return e}function _L(){return _L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_L.apply(this,arguments)}var BOe=function(t,n){var i;return Ce.isValidElement(t)?i=Ce.cloneElement(t,n):Hi(t)?i=t(n):i=Ce.createElement("line",_L({},n,{className:"recharts-reference-line-line"})),i},FOe=function(t,n,i,c,d,m,a,w,S){var M=d.x,P=d.y,N=d.width,$=d.height;if(i){var G=S.y,q=t.y.apply(G,{position:m});if(fp(S,"discard")&&!t.y.isInRange(q))return null;var V=[{x:M+N,y:q},{x:M,y:q}];return w==="left"?V.reverse():V}if(n){var J=S.x,ee=t.x.apply(J,{position:m});if(fp(S,"discard")&&!t.x.isInRange(ee))return null;var re=[{x:ee,y:P+$},{x:ee,y:P}];return a==="top"?re.reverse():re}if(c){var fe=S.segment,ne=fe.map(function(ce){return t.apply(ce,{position:m})});return fp(S,"discard")&&IPe(ne,function(ce){return!t.isInRange(ce)})?null:ne}return null};function VOe(e){var t=e.x,n=e.y,i=e.segment,c=e.xAxisId,d=e.yAxisId,m=e.shape,a=e.className,w=e.alwaysShow,S=bOe(),M=YK(c),P=KK(d),N=TOe();if(!S||!N)return null;km(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var $=rj({x:M.scale,y:P.scale}),G=al(t),q=al(n),V=i&&i.length===2,J=FOe($,G,q,V,N,e.position,M.orientation,P.orientation,e);if(!J)return null;var ee=kOe(J,2),re=ee[0],fe=re.x,ne=re.y,ce=ee[1],me=ce.x,ve=ce.y,De=fp(e,"hidden")?"url(#".concat(S,")"):void 0,Ye=cH(cH({clipPath:De},ha(e,!0)),{},{x1:fe,y1:ne,x2:me,y2:ve});return Ce.createElement(as,{className:xa("recharts-reference-line",a)},BOe(m,Ye),lc.renderCallByParent(e,cOe({x1:fe,y1:ne,x2:me,y2:ve})))}var cj=(function(e){function t(){return AOe(this,t),POe(this,t,arguments)}return IOe(t,e),MOe(t,[{key:"render",value:function(){return Ce.createElement(VOe,this.props)}}])})(Ce.Component);lj(cj,"displayName","ReferenceLine");lj(cj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function vL(){return vL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},vL.apply(this,arguments)}function a0(e){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a0(e)}function hH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function dH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hH(Object(n),!0).forEach(function(i){Q2(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function UOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $Oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,tJ(i.key),i)}}function qOe(e,t,n){return t&&$Oe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function HOe(e,t,n){return t=wA(t),GOe(e,eJ()?Reflect.construct(t,n||[],wA(e).constructor):t.apply(e,n))}function GOe(e,t){if(t&&(a0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WOe(e)}function WOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eJ=function(){return!!e})()}function wA(e){return wA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},wA(e)}function XOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xL(e,t)}function xL(e,t){return xL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},xL(e,t)}function Q2(e,t,n){return t=tJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tJ(e){var t=ZOe(e,"string");return a0(t)=="symbol"?t:t+""}function ZOe(e,t){if(a0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(a0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var YOe=function(t){var n=t.x,i=t.y,c=t.xAxis,d=t.yAxis,m=rj({x:c.scale,y:d.scale}),a=m.apply({x:n,y:i},{bandAware:!0});return fp(t,"discard")&&!m.isInRange(a)?null:a},eC=(function(e){function t(){return UOe(this,t),HOe(this,t,arguments)}return XOe(t,e),qOe(t,[{key:"render",value:function(){var i=this.props,c=i.x,d=i.y,m=i.r,a=i.alwaysShow,w=i.clipPathId,S=al(c),M=al(d);if(km(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!S||!M)return null;var P=YOe(this.props);if(!P)return null;var N=P.x,$=P.y,G=this.props,q=G.shape,V=G.className,J=fp(this.props,"hidden")?"url(#".concat(w,")"):void 0,ee=dH(dH({clipPath:J},ha(this.props,!0)),{},{cx:N,cy:$});return Ce.createElement(as,{className:xa("recharts-reference-dot",V)},t.renderDot(q,ee),lc.renderCallByParent(this.props,{x:N-m,y:$-m,width:2*m,height:2*m}))}}])})(Ce.Component);Q2(eC,"displayName","ReferenceDot");Q2(eC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Q2(eC,"renderDot",function(e,t){var n;return Ce.isValidElement(e)?n=Ce.cloneElement(e,t):Hi(e)?n=e(t):n=Ce.createElement(nj,vL({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function bL(){return bL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bL.apply(this,arguments)}function o0(e){"@babel/helpers - typeof";return o0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o0(e)}function fH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function pH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fH(Object(n),!0).forEach(function(i){tC(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function KOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JOe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,rJ(i.key),i)}}function QOe(e,t,n){return t&&JOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function eRe(e,t,n){return t=SA(t),tRe(e,nJ()?Reflect.construct(t,n||[],SA(e).constructor):t.apply(e,n))}function tRe(e,t){if(t&&(o0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nRe(e)}function nRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nJ=function(){return!!e})()}function SA(e){return SA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},SA(e)}function rRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wL(e,t)}function wL(e,t){return wL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},wL(e,t)}function tC(e,t,n){return t=rJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rJ(e){var t=iRe(e,"string");return o0(t)=="symbol"?t:t+""}function iRe(e,t){if(o0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(o0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var aRe=function(t,n,i,c,d){var m=d.x1,a=d.x2,w=d.y1,S=d.y2,M=d.xAxis,P=d.yAxis;if(!M||!P)return null;var N=rj({x:M.scale,y:P.scale}),$={x:t?N.x.apply(m,{position:"start"}):N.x.rangeMin,y:i?N.y.apply(w,{position:"start"}):N.y.rangeMin},G={x:n?N.x.apply(a,{position:"end"}):N.x.rangeMax,y:c?N.y.apply(S,{position:"end"}):N.y.rangeMax};return fp(d,"discard")&&(!N.isInRange($)||!N.isInRange(G))?null:$K($,G)},nC=(function(e){function t(){return KOe(this,t),eRe(this,t,arguments)}return rRe(t,e),QOe(t,[{key:"render",value:function(){var i=this.props,c=i.x1,d=i.x2,m=i.y1,a=i.y2,w=i.className,S=i.alwaysShow,M=i.clipPathId;km(S===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var P=al(c),N=al(d),$=al(m),G=al(a),q=this.props.shape;if(!P&&!N&&!$&&!G&&!q)return null;var V=aRe(P,N,$,G,this.props);if(!V&&!q)return null;var J=fp(this.props,"hidden")?"url(#".concat(M,")"):void 0;return Ce.createElement(as,{className:xa("recharts-reference-area",w)},t.renderRect(q,pH(pH({clipPath:J},ha(this.props,!0)),V)),lc.renderCallByParent(this.props,V))}}])})(Ce.Component);tC(nC,"displayName","ReferenceArea");tC(nC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});tC(nC,"renderRect",function(e,t){var n;return Ce.isValidElement(e)?n=Ce.cloneElement(e,t):Hi(e)?n=e(t):n=Ce.createElement(tj,bL({},t,{className:"recharts-reference-area-rect"})),n});function iJ(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var i=[],c=0;c<e.length;c+=t)i.push(e[c]);return i}function oRe(e,t,n){var i={width:e.width+t.width,height:e.height+t.height};return hOe(i,n)}function sRe(e,t,n){var i=n==="width",c=e.x,d=e.y,m=e.width,a=e.height;return t===1?{start:i?c:d,end:i?c+m:d+a}:{start:i?c+m:d+a,end:i?c:d}}function TA(e,t,n,i,c){if(e*t<e*i||e*t>e*c)return!1;var d=n();return e*(t-e*d/2-i)>=0&&e*(t+e*d/2-c)<=0}function lRe(e,t){return iJ(e,t+1)}function cRe(e,t,n,i,c){for(var d=(i||[]).slice(),m=t.start,a=t.end,w=0,S=1,M=m,P=function(){var G=i?.[w];if(G===void 0)return{v:iJ(i,S)};var q=w,V,J=function(){return V===void 0&&(V=n(G,q)),V},ee=G.coordinate,re=w===0||TA(e,ee,J,M,a);re||(w=0,M=m,S+=1),re&&(M=ee+e*(J()/2+c),w+=S)},N;S<=d.length;)if(N=P(),N)return N.v;return[]}function T1(e){"@babel/helpers - typeof";return T1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T1(e)}function mH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function oc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mH(Object(n),!0).forEach(function(i){uRe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function uRe(e,t,n){return t=hRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hRe(e){var t=dRe(e,"string");return T1(t)=="symbol"?t:t+""}function dRe(e,t){if(T1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(T1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fRe(e,t,n,i,c){for(var d=(i||[]).slice(),m=d.length,a=t.start,w=t.end,S=function(N){var $=d[N],G,q=function(){return G===void 0&&(G=n($,N)),G};if(N===m-1){var V=e*($.coordinate+e*q()/2-w);d[N]=$=oc(oc({},$),{},{tickCoord:V>0?$.coordinate-V*e:$.coordinate})}else d[N]=$=oc(oc({},$),{},{tickCoord:$.coordinate});var J=TA(e,$.tickCoord,q,a,w);J&&(w=$.tickCoord-e*(q()/2+c),d[N]=oc(oc({},$),{},{isShow:!0}))},M=m-1;M>=0;M--)S(M);return d}function pRe(e,t,n,i,c,d){var m=(i||[]).slice(),a=m.length,w=t.start,S=t.end;if(d){var M=i[a-1],P=n(M,a-1),N=e*(M.coordinate+e*P/2-S);m[a-1]=M=oc(oc({},M),{},{tickCoord:N>0?M.coordinate-N*e:M.coordinate});var $=TA(e,M.tickCoord,function(){return P},w,S);$&&(S=M.tickCoord-e*(P/2+c),m[a-1]=oc(oc({},M),{},{isShow:!0}))}for(var G=d?a-1:a,q=function(ee){var re=m[ee],fe,ne=function(){return fe===void 0&&(fe=n(re,ee)),fe};if(ee===0){var ce=e*(re.coordinate-e*ne()/2-w);m[ee]=re=oc(oc({},re),{},{tickCoord:ce<0?re.coordinate-ce*e:re.coordinate})}else m[ee]=re=oc(oc({},re),{},{tickCoord:re.coordinate});var me=TA(e,re.tickCoord,ne,w,S);me&&(w=re.tickCoord+e*(ne()/2+c),m[ee]=oc(oc({},re),{},{isShow:!0}))},V=0;V<G;V++)q(V);return m}function uj(e,t,n){var i=e.tick,c=e.ticks,d=e.viewBox,m=e.minTickGap,a=e.orientation,w=e.interval,S=e.tickFormatter,M=e.unit,P=e.angle;if(!c||!c.length||!i)return[];if(rr(w)||D0.isSsr)return lRe(c,typeof w=="number"&&rr(w)?w:0);var N=[],$=a==="top"||a==="bottom"?"width":"height",G=M&&$==="width"?Mw(M,{fontSize:t,letterSpacing:n}):{width:0,height:0},q=function(re,fe){var ne=Hi(S)?S(re.value,fe):re.value;return $==="width"?oRe(Mw(ne,{fontSize:t,letterSpacing:n}),G,P):Mw(ne,{fontSize:t,letterSpacing:n})[$]},V=c.length>=2?Wd(c[1].coordinate-c[0].coordinate):1,J=sRe(d,V,$);return w==="equidistantPreserveStart"?cRe(V,J,q,c,m):(w==="preserveStart"||w==="preserveStartEnd"?N=pRe(V,J,q,c,m,w==="preserveStartEnd"):N=fRe(V,J,q,c,m),N.filter(function(ee){return ee.isShow}))}var mRe=["viewBox"],gRe=["viewBox"],yRe=["ticks"];function s0(e){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s0(e)}function Ex(){return Ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ex.apply(this,arguments)}function gH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function nl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gH(Object(n),!0).forEach(function(i){hj(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function oD(e,t){if(e==null)return{};var n=_Re(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function _Re(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function vRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,oJ(i.key),i)}}function xRe(e,t,n){return t&&yH(e.prototype,t),n&&yH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function bRe(e,t,n){return t=EA(t),wRe(e,aJ()?Reflect.construct(t,n||[],EA(e).constructor):t.apply(e,n))}function wRe(e,t){if(t&&(s0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SRe(e)}function SRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aJ=function(){return!!e})()}function EA(e){return EA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},EA(e)}function TRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SL(e,t)}function SL(e,t){return SL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},SL(e,t)}function hj(e,t,n){return t=oJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oJ(e){var t=ERe(e,"string");return s0(t)=="symbol"?t:t+""}function ERe(e,t){if(s0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(s0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var z0=(function(e){function t(n){var i;return vRe(this,t),i=bRe(this,t,[n]),i.state={fontSize:"",letterSpacing:""},i}return TRe(t,e),xRe(t,[{key:"shouldComponentUpdate",value:function(i,c){var d=i.viewBox,m=oD(i,mRe),a=this.props,w=a.viewBox,S=oD(a,gRe);return!Dx(d,w)||!Dx(m,S)||!Dx(c,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var c=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];c&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var c=this.props,d=c.x,m=c.y,a=c.width,w=c.height,S=c.orientation,M=c.tickSize,P=c.mirror,N=c.tickMargin,$,G,q,V,J,ee,re=P?-1:1,fe=i.tickSize||M,ne=rr(i.tickCoord)?i.tickCoord:i.coordinate;switch(S){case"top":$=G=i.coordinate,V=m+ +!P*w,q=V-re*fe,ee=q-re*N,J=ne;break;case"left":q=V=i.coordinate,G=d+ +!P*a,$=G-re*fe,J=$-re*N,ee=ne;break;case"right":q=V=i.coordinate,G=d+ +P*a,$=G+re*fe,J=$+re*N,ee=ne;break;default:$=G=i.coordinate,V=m+ +P*w,q=V+re*fe,ee=q+re*N,J=ne;break}return{line:{x1:$,y1:q,x2:G,y2:V},tick:{x:J,y:ee}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,c=i.orientation,d=i.mirror,m;switch(c){case"left":m=d?"start":"end";break;case"right":m=d?"end":"start";break;default:m="middle";break}return m}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,c=i.orientation,d=i.mirror,m="end";switch(c){case"left":case"right":m="middle";break;case"top":m=d?"start":"end";break;default:m=d?"end":"start";break}return m}},{key:"renderAxisLine",value:function(){var i=this.props,c=i.x,d=i.y,m=i.width,a=i.height,w=i.orientation,S=i.mirror,M=i.axisLine,P=nl(nl(nl({},ha(this.props,!1)),ha(M,!1)),{},{fill:"none"});if(w==="top"||w==="bottom"){var N=+(w==="top"&&!S||w==="bottom"&&S);P=nl(nl({},P),{},{x1:c,y1:d+N*a,x2:c+m,y2:d+N*a})}else{var $=+(w==="left"&&!S||w==="right"&&S);P=nl(nl({},P),{},{x1:c+$*m,y1:d,x2:c+$*m,y2:d+a})}return Ce.createElement("line",Ex({},P,{className:xa("recharts-cartesian-axis-line",Jh(M,"className"))}))}},{key:"renderTicks",value:function(i,c,d){var m=this,a=this.props,w=a.tickLine,S=a.stroke,M=a.tick,P=a.tickFormatter,N=a.unit,$=uj(nl(nl({},this.props),{},{ticks:i}),c,d),G=this.getTickTextAnchor(),q=this.getTickVerticalAnchor(),V=ha(this.props,!1),J=ha(M,!1),ee=nl(nl({},V),{},{fill:"none"},ha(w,!1)),re=$.map(function(fe,ne){var ce=m.getTickLineCoord(fe),me=ce.line,ve=ce.tick,De=nl(nl(nl(nl({textAnchor:G,verticalAnchor:q},V),{},{stroke:"none",fill:S},J),ve),{},{index:ne,payload:fe,visibleTicksCount:$.length,tickFormatter:P});return Ce.createElement(as,Ex({className:"recharts-cartesian-axis-tick",key:"tick-".concat(fe.value,"-").concat(fe.coordinate,"-").concat(fe.tickCoord)},NE(m.props,fe,ne)),w&&Ce.createElement("line",Ex({},ee,me,{className:xa("recharts-cartesian-axis-tick-line",Jh(w,"className"))})),M&&t.renderTickItem(M,De,"".concat(Hi(P)?P(fe.value,ne):fe.value).concat(N||"")))});return Ce.createElement("g",{className:"recharts-cartesian-axis-ticks"},re)}},{key:"render",value:function(){var i=this,c=this.props,d=c.axisLine,m=c.width,a=c.height,w=c.ticksGenerator,S=c.className,M=c.hide;if(M)return null;var P=this.props,N=P.ticks,$=oD(P,yRe),G=N;return Hi(w)&&(G=N&&N.length>0?w(this.props):w($)),m<=0||a<=0||!G||!G.length?null:Ce.createElement(as,{className:xa("recharts-cartesian-axis",S),ref:function(V){i.layerReference=V}},d&&this.renderAxisLine(),this.renderTicks(G,this.state.fontSize,this.state.letterSpacing),lc.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,c,d){var m,a=xa(c.className,"recharts-cartesian-axis-tick-value");return Ce.isValidElement(i)?m=Ce.cloneElement(i,nl(nl({},c),{},{className:a})):Hi(i)?m=i(nl(nl({},c),{},{className:a})):m=Ce.createElement(WE,Ex({},c,{className:"recharts-cartesian-axis-tick-value"}),d),m}}])})(K.Component);hj(z0,"displayName","CartesianAxis");hj(z0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var ARe=["x1","y1","x2","y2","key"],CRe=["offset"];function nv(e){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(e)}function _H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function cc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_H(Object(n),!0).forEach(function(i){MRe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_H(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function MRe(e,t,n){return t=PRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PRe(e){var t=ORe(e,"string");return nv(t)=="symbol"?t:t+""}function ORe(e,t){if(nv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(nv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F_(){return F_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},F_.apply(this,arguments)}function vH(e,t){if(e==null)return{};var n=RRe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function RRe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var IRe=function(t){var n=t.fill;if(!n||n==="none")return null;var i=t.fillOpacity,c=t.x,d=t.y,m=t.width,a=t.height,w=t.ry;return Ce.createElement("rect",{x:c,y:d,ry:w,width:m,height:a,stroke:"none",fill:n,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function sJ(e,t){var n;if(Ce.isValidElement(e))n=Ce.cloneElement(e,t);else if(Hi(e))n=e(t);else{var i=t.x1,c=t.y1,d=t.x2,m=t.y2,a=t.key,w=vH(t,ARe),S=ha(w,!1);S.offset;var M=vH(S,CRe);n=Ce.createElement("line",F_({},M,{x1:i,y1:c,x2:d,y2:m,fill:"none",key:a}))}return n}function DRe(e){var t=e.x,n=e.width,i=e.horizontal,c=i===void 0?!0:i,d=e.horizontalPoints;if(!c||!d||!d.length)return null;var m=d.map(function(a,w){var S=cc(cc({},e),{},{x1:t,y1:a,x2:t+n,y2:a,key:"line-".concat(w),index:w});return sJ(c,S)});return Ce.createElement("g",{className:"recharts-cartesian-grid-horizontal"},m)}function kRe(e){var t=e.y,n=e.height,i=e.vertical,c=i===void 0?!0:i,d=e.verticalPoints;if(!c||!d||!d.length)return null;var m=d.map(function(a,w){var S=cc(cc({},e),{},{x1:a,y1:t,x2:a,y2:t+n,key:"line-".concat(w),index:w});return sJ(c,S)});return Ce.createElement("g",{className:"recharts-cartesian-grid-vertical"},m)}function LRe(e){var t=e.horizontalFill,n=e.fillOpacity,i=e.x,c=e.y,d=e.width,m=e.height,a=e.horizontalPoints,w=e.horizontal,S=w===void 0?!0:w;if(!S||!t||!t.length)return null;var M=a.map(function(N){return Math.round(N+c-c)}).sort(function(N,$){return N-$});c!==M[0]&&M.unshift(0);var P=M.map(function(N,$){var G=!M[$+1],q=G?c+m-N:M[$+1]-N;if(q<=0)return null;var V=$%t.length;return Ce.createElement("rect",{key:"react-".concat($),y:N,x:i,height:q,width:d,stroke:"none",fill:t[V],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Ce.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},P)}function NRe(e){var t=e.vertical,n=t===void 0?!0:t,i=e.verticalFill,c=e.fillOpacity,d=e.x,m=e.y,a=e.width,w=e.height,S=e.verticalPoints;if(!n||!i||!i.length)return null;var M=S.map(function(N){return Math.round(N+d-d)}).sort(function(N,$){return N-$});d!==M[0]&&M.unshift(0);var P=M.map(function(N,$){var G=!M[$+1],q=G?d+a-N:M[$+1]-N;if(q<=0)return null;var V=$%i.length;return Ce.createElement("rect",{key:"react-".concat($),x:N,y:m,width:q,height:w,stroke:"none",fill:i[V],fillOpacity:c,className:"recharts-cartesian-grid-bg"})});return Ce.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},P)}var zRe=function(t,n){var i=t.xAxis,c=t.width,d=t.height,m=t.offset;return bK(uj(cc(cc(cc({},z0.defaultProps),i),{},{ticks:Mm(i,!0),viewBox:{x:0,y:0,width:c,height:d}})),m.left,m.left+m.width,n)},jRe=function(t,n){var i=t.yAxis,c=t.width,d=t.height,m=t.offset;return bK(uj(cc(cc(cc({},z0.defaultProps),i),{},{ticks:Mm(i,!0),viewBox:{x:0,y:0,width:c,height:d}})),m.top,m.top+m.height,n)},fx={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function lJ(e){var t,n,i,c,d,m,a=oj(),w=sj(),S=EOe(),M=cc(cc({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:fx.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:fx.fill,horizontal:(i=e.horizontal)!==null&&i!==void 0?i:fx.horizontal,horizontalFill:(c=e.horizontalFill)!==null&&c!==void 0?c:fx.horizontalFill,vertical:(d=e.vertical)!==null&&d!==void 0?d:fx.vertical,verticalFill:(m=e.verticalFill)!==null&&m!==void 0?m:fx.verticalFill,x:rr(e.x)?e.x:S.left,y:rr(e.y)?e.y:S.top,width:rr(e.width)?e.width:S.width,height:rr(e.height)?e.height:S.height}),P=M.x,N=M.y,$=M.width,G=M.height,q=M.syncWithTicks,V=M.horizontalValues,J=M.verticalValues,ee=wOe(),re=SOe();if(!rr($)||$<=0||!rr(G)||G<=0||!rr(P)||P!==+P||!rr(N)||N!==+N)return null;var fe=M.verticalCoordinatesGenerator||zRe,ne=M.horizontalCoordinatesGenerator||jRe,ce=M.horizontalPoints,me=M.verticalPoints;if((!ce||!ce.length)&&Hi(ne)){var ve=V&&V.length,De=ne({yAxis:re?cc(cc({},re),{},{ticks:ve?V:re.ticks}):void 0,width:a,height:w,offset:S},ve?!0:q);km(Array.isArray(De),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(nv(De),"]")),Array.isArray(De)&&(ce=De)}if((!me||!me.length)&&Hi(fe)){var Ye=J&&J.length,ze=fe({xAxis:ee?cc(cc({},ee),{},{ticks:Ye?J:ee.ticks}):void 0,width:a,height:w,offset:S},Ye?!0:q);km(Array.isArray(ze),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(nv(ze),"]")),Array.isArray(ze)&&(me=ze)}return Ce.createElement("g",{className:"recharts-cartesian-grid"},Ce.createElement(IRe,{fill:M.fill,fillOpacity:M.fillOpacity,x:M.x,y:M.y,width:M.width,height:M.height,ry:M.ry}),Ce.createElement(DRe,F_({},M,{offset:S,horizontalPoints:ce,xAxis:ee,yAxis:re})),Ce.createElement(kRe,F_({},M,{offset:S,verticalPoints:me,xAxis:ee,yAxis:re})),Ce.createElement(LRe,F_({},M,{horizontalPoints:ce})),Ce.createElement(NRe,F_({},M,{verticalPoints:me})))}lJ.displayName="CartesianGrid";var BRe=["layout","type","stroke","connectNulls","isRange","ref"],FRe=["key"],cJ;function l0(e){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l0(e)}function uJ(e,t){if(e==null)return{};var n=VRe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function VRe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function V_(){return V_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},V_.apply(this,arguments)}function xH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function ey(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xH(Object(n),!0).forEach(function(i){ap(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function URe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bH(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,dJ(i.key),i)}}function $Re(e,t,n){return t&&bH(e.prototype,t),n&&bH(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qRe(e,t,n){return t=AA(t),HRe(e,hJ()?Reflect.construct(t,n||[],AA(e).constructor):t.apply(e,n))}function HRe(e,t){if(t&&(l0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GRe(e)}function GRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hJ=function(){return!!e})()}function AA(e){return AA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},AA(e)}function WRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TL(e,t)}function TL(e,t){return TL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},TL(e,t)}function ap(e,t,n){return t=dJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dJ(e){var t=XRe(e,"string");return l0(t)=="symbol"?t:t+""}function XRe(e,t){if(l0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(l0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Sy=(function(e){function t(){var n;URe(this,t);for(var i=arguments.length,c=new Array(i),d=0;d<i;d++)c[d]=arguments[d];return n=qRe(this,t,[].concat(c)),ap(n,"state",{isAnimationFinished:!0}),ap(n,"id",nS("recharts-area-")),ap(n,"handleAnimationEnd",function(){var m=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Hi(m)&&m()}),ap(n,"handleAnimationStart",function(){var m=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Hi(m)&&m()}),n}return WRe(t,e),$Re(t,[{key:"renderDots",value:function(i,c,d){var m=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(m&&!a)return null;var w=this.props,S=w.dot,M=w.points,P=w.dataKey,N=ha(this.props,!1),$=ha(S,!0),G=M.map(function(V,J){var ee=ey(ey(ey({key:"dot-".concat(J),r:3},N),$),{},{index:J,cx:V.x,cy:V.y,dataKey:P,value:V.value,payload:V.payload,points:M});return t.renderDotItem(S,ee)}),q={clipPath:i?"url(#clipPath-".concat(c?"":"dots-").concat(d,")"):null};return Ce.createElement(as,V_({className:"recharts-area-dots"},q),G)}},{key:"renderHorizontalRect",value:function(i){var c=this.props,d=c.baseLine,m=c.points,a=c.strokeWidth,w=m[0].x,S=m[m.length-1].x,M=i*Math.abs(w-S),P=ry(m.map(function(N){return N.y||0}));return rr(d)&&typeof d=="number"?P=Math.max(d,P):d&&Array.isArray(d)&&d.length&&(P=Math.max(ry(d.map(function(N){return N.y||0})),P)),rr(P)?Ce.createElement("rect",{x:w<S?w:w-M,y:0,width:M,height:Math.floor(P+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(i){var c=this.props,d=c.baseLine,m=c.points,a=c.strokeWidth,w=m[0].y,S=m[m.length-1].y,M=i*Math.abs(w-S),P=ry(m.map(function(N){return N.x||0}));return rr(d)&&typeof d=="number"?P=Math.max(d,P):d&&Array.isArray(d)&&d.length&&(P=Math.max(ry(d.map(function(N){return N.x||0})),P)),rr(P)?Ce.createElement("rect",{x:0,y:w<S?w:w-M,width:P+(a?parseInt("".concat(a),10):1),height:Math.floor(M)}):null}},{key:"renderClipRect",value:function(i){var c=this.props.layout;return c==="vertical"?this.renderVerticalRect(i):this.renderHorizontalRect(i)}},{key:"renderAreaStatically",value:function(i,c,d,m){var a=this.props,w=a.layout,S=a.type,M=a.stroke,P=a.connectNulls,N=a.isRange;a.ref;var $=uJ(a,BRe);return Ce.createElement(as,{clipPath:d?"url(#clipPath-".concat(m,")"):null},Ce.createElement(Rw,V_({},ha($,!0),{points:i,connectNulls:P,type:S,baseLine:c,layout:w,stroke:"none",className:"recharts-area-area"})),M!=="none"&&Ce.createElement(Rw,V_({},ha(this.props,!1),{className:"recharts-area-curve",layout:w,type:S,connectNulls:P,fill:"none",points:i})),M!=="none"&&N&&Ce.createElement(Rw,V_({},ha(this.props,!1),{className:"recharts-area-curve",layout:w,type:S,connectNulls:P,fill:"none",points:c})))}},{key:"renderAreaWithAnimation",value:function(i,c){var d=this,m=this.props,a=m.points,w=m.baseLine,S=m.isAnimationActive,M=m.animationBegin,P=m.animationDuration,N=m.animationEasing,$=m.animationId,G=this.state,q=G.prevPoints,V=G.prevBaseLine;return Ce.createElement(Hm,{begin:M,duration:P,isActive:S,easing:N,from:{t:0},to:{t:1},key:"area-".concat($),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(J){var ee=J.t;if(q){var re=q.length/a.length,fe=a.map(function(ve,De){var Ye=Math.floor(De*re);if(q[Ye]){var ze=q[Ye],tt=Wh(ze.x,ve.x),at=Wh(ze.y,ve.y);return ey(ey({},ve),{},{x:tt(ee),y:at(ee)})}return ve}),ne;if(rr(w)&&typeof w=="number"){var ce=Wh(V,w);ne=ce(ee)}else if(ga(w)||R0(w)){var me=Wh(V,0);ne=me(ee)}else ne=w.map(function(ve,De){var Ye=Math.floor(De*re);if(V[Ye]){var ze=V[Ye],tt=Wh(ze.x,ve.x),at=Wh(ze.y,ve.y);return ey(ey({},ve),{},{x:tt(ee),y:at(ee)})}return ve});return d.renderAreaStatically(fe,ne,i,c)}return Ce.createElement(as,null,Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"animationClipPath-".concat(c)},d.renderClipRect(ee))),Ce.createElement(as,{clipPath:"url(#animationClipPath-".concat(c,")")},d.renderAreaStatically(a,w,i,c)))})}},{key:"renderArea",value:function(i,c){var d=this.props,m=d.points,a=d.baseLine,w=d.isAnimationActive,S=this.state,M=S.prevPoints,P=S.prevBaseLine,N=S.totalLength;return w&&m&&m.length&&(!M&&N>0||!r1(M,m)||!r1(P,a))?this.renderAreaWithAnimation(i,c):this.renderAreaStatically(m,a,i,c)}},{key:"render",value:function(){var i,c=this.props,d=c.hide,m=c.dot,a=c.points,w=c.className,S=c.top,M=c.left,P=c.xAxis,N=c.yAxis,$=c.width,G=c.height,q=c.isAnimationActive,V=c.id;if(d||!a||!a.length)return null;var J=this.state.isAnimationFinished,ee=a.length===1,re=xa("recharts-area",w),fe=P&&P.allowDataOverflow,ne=N&&N.allowDataOverflow,ce=fe||ne,me=ga(V)?this.id:V,ve=(i=ha(m,!1))!==null&&i!==void 0?i:{r:3,strokeWidth:2},De=ve.r,Ye=De===void 0?3:De,ze=ve.strokeWidth,tt=ze===void 0?2:ze,at=mxe(m)?m:{},ct=at.clipDot,ht=ct===void 0?!0:ct,Ie=Ye*2+tt;return Ce.createElement(as,{className:re},fe||ne?Ce.createElement("defs",null,Ce.createElement("clipPath",{id:"clipPath-".concat(me)},Ce.createElement("rect",{x:fe?M:M-$/2,y:ne?S:S-G/2,width:fe?$:$*2,height:ne?G:G*2})),!ht&&Ce.createElement("clipPath",{id:"clipPath-dots-".concat(me)},Ce.createElement("rect",{x:M-Ie/2,y:S-Ie/2,width:$+Ie,height:G+Ie}))):null,ee?null:this.renderArea(ce,me),(m||ee)&&this.renderDots(ce,ht,me),(!q||J)&&ly.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(i,c){return i.animationId!==c.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,curBaseLine:i.baseLine,prevPoints:c.curPoints,prevBaseLine:c.curBaseLine}:i.points!==c.curPoints||i.baseLine!==c.curBaseLine?{curPoints:i.points,curBaseLine:i.baseLine}:null}}])})(K.PureComponent);cJ=Sy;ap(Sy,"displayName","Area");ap(Sy,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!D0.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ap(Sy,"getBaseValue",function(e,t,n,i){var c=e.layout,d=e.baseValue,m=t.props.baseValue,a=m??d;if(rr(a)&&typeof a=="number")return a;var w=c==="horizontal"?i:n,S=w.scale.domain();if(w.type==="number"){var M=Math.max(S[0],S[1]),P=Math.min(S[0],S[1]);return a==="dataMin"?P:a==="dataMax"||M<0?M:Math.max(Math.min(S[0],S[1]),0)}return a==="dataMin"?S[0]:a==="dataMax"?S[1]:S[0]});ap(Sy,"getComposedData",function(e){var t=e.props,n=e.item,i=e.xAxis,c=e.yAxis,d=e.xAxisTicks,m=e.yAxisTicks,a=e.bandSize,w=e.dataKey,S=e.stackedData,M=e.dataStartIndex,P=e.displayedData,N=e.offset,$=t.layout,G=S&&S.length,q=cJ.getBaseValue(t,n,i,c),V=$==="horizontal",J=!1,ee=P.map(function(fe,ne){var ce;G?ce=S[M+ne]:(ce=rh(fe,w),Array.isArray(ce)?J=!0:ce=[q,ce]);var me=ce[1]==null||G&&rh(fe,w)==null;return V?{x:Nq({axis:i,ticks:d,bandSize:a,entry:fe,index:ne}),y:me?null:c.scale(ce[1]),value:ce,payload:fe}:{x:me?null:i.scale(ce[1]),y:Nq({axis:c,ticks:m,bandSize:a,entry:fe,index:ne}),value:ce,payload:fe}}),re;return G||J?re=ee.map(function(fe){var ne=Array.isArray(fe.value)?fe.value[0]:null;return V?{x:fe.x,y:ne!=null&&fe.y!=null?c.scale(ne):null}:{x:ne!=null?i.scale(ne):null,y:fe.y}}):re=V?c.scale(q):i.scale(q),ey({points:ee,baseLine:re,layout:$,isRange:J},N)});ap(Sy,"renderDotItem",function(e,t){var n;if(Ce.isValidElement(e))n=Ce.cloneElement(e,t);else if(Hi(e))n=e(t);else{var i=xa("recharts-area-dot",typeof e!="boolean"?e.className:""),c=t.key,d=uJ(t,FRe);n=Ce.createElement(nj,V_({},d,{key:c,className:i}))}return n});function c0(e){"@babel/helpers - typeof";return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c0(e)}function ZRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YRe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,mJ(i.key),i)}}function KRe(e,t,n){return t&&YRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JRe(e,t,n){return t=CA(t),QRe(e,fJ()?Reflect.construct(t,n||[],CA(e).constructor):t.apply(e,n))}function QRe(e,t){if(t&&(c0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eIe(e)}function eIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fJ=function(){return!!e})()}function CA(e){return CA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},CA(e)}function tIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EL(e,t)}function EL(e,t){return EL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},EL(e,t)}function pJ(e,t,n){return t=mJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mJ(e){var t=nIe(e,"string");return c0(t)=="symbol"?t:t+""}function nIe(e,t){if(c0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(c0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function AL(){return AL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},AL.apply(this,arguments)}function rIe(e){var t=e.xAxisId,n=oj(),i=sj(),c=YK(t);return c==null?null:K.createElement(z0,AL({},c,{className:xa("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(m){return Mm(m,!0)}}))}var rC=(function(e){function t(){return ZRe(this,t),JRe(this,t,arguments)}return tIe(t,e),KRe(t,[{key:"render",value:function(){return K.createElement(rIe,this.props)}}])})(K.Component);pJ(rC,"displayName","XAxis");pJ(rC,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function u0(e){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u0(e)}function iIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aIe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_J(i.key),i)}}function oIe(e,t,n){return t&&aIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function sIe(e,t,n){return t=MA(t),lIe(e,gJ()?Reflect.construct(t,n||[],MA(e).constructor):t.apply(e,n))}function lIe(e,t){if(t&&(u0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cIe(e)}function cIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gJ=function(){return!!e})()}function MA(e){return MA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},MA(e)}function uIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CL(e,t)}function CL(e,t){return CL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},CL(e,t)}function yJ(e,t,n){return t=_J(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _J(e){var t=hIe(e,"string");return u0(t)=="symbol"?t:t+""}function hIe(e,t){if(u0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(u0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ML(){return ML=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ML.apply(this,arguments)}var dIe=function(t){var n=t.yAxisId,i=oj(),c=sj(),d=KK(n);return d==null?null:K.createElement(z0,ML({},d,{className:xa("recharts-".concat(d.axisType," ").concat(d.axisType),d.className),viewBox:{x:0,y:0,width:i,height:c},ticksGenerator:function(a){return Mm(a,!0)}}))},iC=(function(e){function t(){return iIe(this,t),sIe(this,t,arguments)}return uIe(t,e),oIe(t,[{key:"render",value:function(){return K.createElement(dIe,this.props)}}])})(K.Component);yJ(iC,"displayName","YAxis");yJ(iC,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function wH(e){return gIe(e)||mIe(e)||pIe(e)||fIe()}function fIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pIe(e,t){if(e){if(typeof e=="string")return PL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PL(e,t)}}function mIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gIe(e){if(Array.isArray(e))return PL(e)}function PL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var OL=function(t,n,i,c,d){var m=Zd(t,cj),a=Zd(t,eC),w=[].concat(wH(m),wH(a)),S=Zd(t,nC),M="".concat(c,"Id"),P=c[0],N=n;if(w.length&&(N=w.reduce(function(q,V){if(V.props[M]===i&&fp(V.props,"extendDomain")&&rr(V.props[P])){var J=V.props[P];return[Math.min(q[0],J),Math.max(q[1],J)]}return q},N)),S.length){var $="".concat(P,"1"),G="".concat(P,"2");N=S.reduce(function(q,V){if(V.props[M]===i&&fp(V.props,"extendDomain")&&rr(V.props[$])&&rr(V.props[G])){var J=V.props[$],ee=V.props[G];return[Math.min(q[0],J,ee),Math.max(q[1],J,ee)]}return q},N)}return d&&d.length&&(N=d.reduce(function(q,V){return rr(V)?[Math.min(q[0],V),Math.max(q[1],V)]:q},N)),N},sD={exports:{}},SH;function yIe(){return SH||(SH=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function c(w,S,M){this.fn=w,this.context=S,this.once=M||!1}function d(w,S,M,P,N){if(typeof M!="function")throw new TypeError("The listener must be a function");var $=new c(M,P||w,N),G=n?n+S:S;return w._events[G]?w._events[G].fn?w._events[G]=[w._events[G],$]:w._events[G].push($):(w._events[G]=$,w._eventsCount++),w}function m(w,S){--w._eventsCount===0?w._events=new i:delete w._events[S]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var S=[],M,P;if(this._eventsCount===0)return S;for(P in M=this._events)t.call(M,P)&&S.push(n?P.slice(1):P);return Object.getOwnPropertySymbols?S.concat(Object.getOwnPropertySymbols(M)):S},a.prototype.listeners=function(S){var M=n?n+S:S,P=this._events[M];if(!P)return[];if(P.fn)return[P.fn];for(var N=0,$=P.length,G=new Array($);N<$;N++)G[N]=P[N].fn;return G},a.prototype.listenerCount=function(S){var M=n?n+S:S,P=this._events[M];return P?P.fn?1:P.length:0},a.prototype.emit=function(S,M,P,N,$,G){var q=n?n+S:S;if(!this._events[q])return!1;var V=this._events[q],J=arguments.length,ee,re;if(V.fn){switch(V.once&&this.removeListener(S,V.fn,void 0,!0),J){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,M),!0;case 3:return V.fn.call(V.context,M,P),!0;case 4:return V.fn.call(V.context,M,P,N),!0;case 5:return V.fn.call(V.context,M,P,N,$),!0;case 6:return V.fn.call(V.context,M,P,N,$,G),!0}for(re=1,ee=new Array(J-1);re<J;re++)ee[re-1]=arguments[re];V.fn.apply(V.context,ee)}else{var fe=V.length,ne;for(re=0;re<fe;re++)switch(V[re].once&&this.removeListener(S,V[re].fn,void 0,!0),J){case 1:V[re].fn.call(V[re].context);break;case 2:V[re].fn.call(V[re].context,M);break;case 3:V[re].fn.call(V[re].context,M,P);break;case 4:V[re].fn.call(V[re].context,M,P,N);break;default:if(!ee)for(ne=1,ee=new Array(J-1);ne<J;ne++)ee[ne-1]=arguments[ne];V[re].fn.apply(V[re].context,ee)}}return!0},a.prototype.on=function(S,M,P){return d(this,S,M,P,!1)},a.prototype.once=function(S,M,P){return d(this,S,M,P,!0)},a.prototype.removeListener=function(S,M,P,N){var $=n?n+S:S;if(!this._events[$])return this;if(!M)return m(this,$),this;var G=this._events[$];if(G.fn)G.fn===M&&(!N||G.once)&&(!P||G.context===P)&&m(this,$);else{for(var q=0,V=[],J=G.length;q<J;q++)(G[q].fn!==M||N&&!G[q].once||P&&G[q].context!==P)&&V.push(G[q]);V.length?this._events[$]=V.length===1?V[0]:V:m(this,$)}return this},a.prototype.removeAllListeners=function(S){var M;return S?(M=n?n+S:S,this._events[M]&&m(this,M)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(sD)),sD.exports}var _Ie=yIe();const vIe=Wa(_Ie);var lD=new vIe,cD="recharts.syncMouseEvents";function E1(e){"@babel/helpers - typeof";return E1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E1(e)}function xIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bIe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,vJ(i.key),i)}}function wIe(e,t,n){return t&&bIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uD(e,t,n){return t=vJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vJ(e){var t=SIe(e,"string");return E1(t)=="symbol"?t:t+""}function SIe(e,t){if(E1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(E1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var TIe=(function(){function e(){xIe(this,e),uD(this,"activeIndex",0),uD(this,"coordinateList",[]),uD(this,"layout","horizontal")}return wIe(e,[{key:"setDetails",value:function(n){var i,c=n.coordinateList,d=c===void 0?null:c,m=n.container,a=m===void 0?null:m,w=n.layout,S=w===void 0?null:w,M=n.offset,P=M===void 0?null:M,N=n.mouseHandlerCallback,$=N===void 0?null:N;this.coordinateList=(i=d??this.coordinateList)!==null&&i!==void 0?i:[],this.container=a??this.container,this.layout=S??this.layout,this.offset=P??this.offset,this.mouseHandlerCallback=$??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var c=this.container.getBoundingClientRect(),d=c.x,m=c.y,a=c.height,w=this.coordinateList[this.activeIndex].coordinate,S=((n=window)===null||n===void 0?void 0:n.scrollX)||0,M=((i=window)===null||i===void 0?void 0:i.scrollY)||0,P=d+w+S,N=m+this.offset.top+a/2+M;this.mouseHandlerCallback({pageX:P,pageY:N})}}}])})();function EIe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var i=e?.[0],c=e?.[1];if(i&&c&&rr(i)&&rr(c))return!0}return!1}function AIe(e,t,n,i){var c=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-c:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-c,width:e==="horizontal"?i:n.width-1,height:e==="horizontal"?n.height-1:i}}function xJ(e){var t=e.cx,n=e.cy,i=e.radius,c=e.startAngle,d=e.endAngle,m=zl(t,n,i,c),a=zl(t,n,i,d);return{points:[m,a],cx:t,cy:n,radius:i,startAngle:c,endAngle:d}}function CIe(e,t,n){var i,c,d,m;if(e==="horizontal")i=t.x,d=i,c=n.top,m=n.top+n.height;else if(e==="vertical")c=t.y,m=c,i=n.left,d=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var a=t.cx,w=t.cy,S=t.innerRadius,M=t.outerRadius,P=t.angle,N=zl(a,w,S,P),$=zl(a,w,M,P);i=N.x,c=N.y,d=$.x,m=$.y}else return xJ(t);return[{x:i,y:c},{x:d,y:m}]}function A1(e){"@babel/helpers - typeof";return A1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A1(e)}function TH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function YT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TH(Object(n),!0).forEach(function(i){MIe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function MIe(e,t,n){return t=PIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PIe(e){var t=OIe(e,"string");return A1(t)=="symbol"?t:t+""}function OIe(e,t){if(A1(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(A1(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RIe(e){var t,n,i=e.element,c=e.tooltipEventType,d=e.isActive,m=e.activeCoordinate,a=e.activePayload,w=e.offset,S=e.activeTooltipIndex,M=e.tooltipAxisBandSize,P=e.layout,N=e.chartName,$=(t=i.props.cursor)!==null&&t!==void 0?t:(n=i.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!i||!$||!d||!m||N!=="ScatterChart"&&c!=="axis")return null;var G,q=Rw;if(N==="ScatterChart")G=m,q=IMe;else if(N==="BarChart")G=AIe(P,m,w,M),q=tj;else if(P==="radial"){var V=xJ(m),J=V.cx,ee=V.cy,re=V.radius,fe=V.startAngle,ne=V.endAngle;G={cx:J,cy:ee,startAngle:fe,endAngle:ne,innerRadius:re,outerRadius:re},q=AK}else G={points:CIe(P,m,w)},q=Rw;var ce=YT(YT(YT(YT({stroke:"#ccc",pointerEvents:"none"},w),G),ha($,!1)),{},{payload:a,payloadIndex:S,className:xa("recharts-tooltip-cursor",$.className)});return K.isValidElement($)?K.cloneElement($,ce):K.createElement(q,ce)}var IIe=["item"],DIe=["children","className","width","height","style","compact","title","desc"];function h0(e){"@babel/helpers - typeof";return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h0(e)}function Ax(){return Ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ax.apply(this,arguments)}function EH(e,t){return NIe(e)||LIe(e,t)||wJ(e,t)||kIe()}function kIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LIe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,c,d,m,a=[],w=!0,S=!1;try{if(d=(n=n.call(e)).next,t!==0)for(;!(w=(i=d.call(n)).done)&&(a.push(i.value),a.length!==t);w=!0);}catch(M){S=!0,c=M}finally{try{if(!w&&n.return!=null&&(m=n.return(),Object(m)!==m))return}finally{if(S)throw c}}return a}}function NIe(e){if(Array.isArray(e))return e}function AH(e,t){if(e==null)return{};var n=zIe(e,t),i,c;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(c=0;c<d.length;c++)i=d[c],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function zIe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function jIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BIe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,SJ(i.key),i)}}function FIe(e,t,n){return t&&BIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function VIe(e,t,n){return t=PA(t),UIe(e,bJ()?Reflect.construct(t,n||[],PA(e).constructor):t.apply(e,n))}function UIe(e,t){if(t&&(h0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ie(e)}function $Ie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bJ=function(){return!!e})()}function PA(e){return PA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},PA(e)}function qIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RL(e,t)}function RL(e,t){return RL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,c){return i.__proto__=c,i},RL(e,t)}function d0(e){return WIe(e)||GIe(e)||wJ(e)||HIe()}function HIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wJ(e,t){if(e){if(typeof e=="string")return IL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IL(e,t)}}function GIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WIe(e){if(Array.isArray(e))return IL(e)}function IL(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function CH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CH(Object(n),!0).forEach(function(i){vi(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CH(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function vi(e,t,n){return t=SJ(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SJ(e){var t=XIe(e,"string");return h0(t)=="symbol"?t:t+""}function XIe(e,t){if(h0(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(h0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZIe={xAxis:["bottom","top"],yAxis:["left","right"]},YIe={width:"100%",height:"100%"},TJ={x:0,y:0};function KT(e){return e}var KIe=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},JIe=function(t,n,i,c){var d=n.find(function(M){return M&&M.index===i});if(d){if(t==="horizontal")return{x:d.coordinate,y:c.y};if(t==="vertical")return{x:c.x,y:d.coordinate};if(t==="centric"){var m=d.coordinate,a=c.radius;return Mn(Mn(Mn({},c),zl(c.cx,c.cy,a,m)),{},{angle:m,radius:a})}var w=d.coordinate,S=c.angle;return Mn(Mn(Mn({},c),zl(c.cx,c.cy,w,S)),{},{angle:S,radius:w})}return TJ},aC=function(t,n){var i=n.graphicalItems,c=n.dataStartIndex,d=n.dataEndIndex,m=(i??[]).reduce(function(a,w){var S=w.props.data;return S&&S.length?[].concat(d0(a),d0(S)):a},[]);return m.length>0?m:t&&t.length&&rr(c)&&rr(d)?t.slice(c,d+1):[]};function EJ(e){return e==="number"?[0,"auto"]:void 0}var DL=function(t,n,i,c){var d=t.graphicalItems,m=t.tooltipAxis,a=aC(n,t);return i<0||!d||!d.length||i>=a.length?null:d.reduce(function(w,S){var M,P=(M=S.props.data)!==null&&M!==void 0?M:n;P&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=i&&(P=P.slice(t.dataStartIndex,t.dataEndIndex+1));var N;if(m.dataKey&&!m.allowDuplicatedCategory){var $=P===void 0?a:P;N=kE($,m.dataKey,c)}else N=P&&P[i]||a[i];return N?[].concat(d0(w),[SK(S,N)]):w},[])},MH=function(t,n,i,c){var d=c||{x:t.chartX,y:t.chartY},m=KIe(d,i),a=t.orderedTooltipTicks,w=t.tooltipAxis,S=t.tooltipTicks,M=mAe(m,a,S,w);if(M>=0&&S){var P=S[M]&&S[M].value,N=DL(t,n,M,P),$=JIe(i,a,M,d);return{activeTooltipIndex:M,activeLabel:P,activePayload:N,activeCoordinate:$}}return null},QIe=function(t,n){var i=n.axes,c=n.graphicalItems,d=n.axisType,m=n.axisIdKey,a=n.stackGroups,w=n.dataStartIndex,S=n.dataEndIndex,M=t.layout,P=t.children,N=t.stackOffset,$=xK(M,d);return i.reduce(function(G,q){var V,J=q.type.defaultProps!==void 0?Mn(Mn({},q.type.defaultProps),q.props):q.props,ee=J.type,re=J.dataKey,fe=J.allowDataOverflow,ne=J.allowDuplicatedCategory,ce=J.scale,me=J.ticks,ve=J.includeHidden,De=J[m];if(G[De])return G;var Ye=aC(t.data,{graphicalItems:c.filter(function(nt){var gt,Ut=m in nt.props?nt.props[m]:(gt=nt.type.defaultProps)===null||gt===void 0?void 0:gt[m];return Ut===De}),dataStartIndex:w,dataEndIndex:S}),ze=Ye.length,tt,at,ct;EIe(J.domain,fe,ee)&&(tt=Jk(J.domain,null,fe),$&&(ee==="number"||ce!=="auto")&&(ct=Ow(Ye,re,"category")));var ht=EJ(ee);if(!tt||tt.length===0){var Ie,rt=(Ie=J.domain)!==null&&Ie!==void 0?Ie:ht;if(re){if(tt=Ow(Ye,re,ee),ee==="category"&&$){var Qe=axe(tt);ne&&Qe?(at=tt,tt=gA(0,ze)):ne||(tt=Fq(rt,tt,q).reduce(function(nt,gt){return nt.indexOf(gt)>=0?nt:[].concat(d0(nt),[gt])},[]))}else if(ee==="category")ne?tt=tt.filter(function(nt){return nt!==""&&!ga(nt)}):tt=Fq(rt,tt,q).reduce(function(nt,gt){return nt.indexOf(gt)>=0||gt===""||ga(gt)?nt:[].concat(d0(nt),[gt])},[]);else if(ee==="number"){var St=xAe(Ye,c.filter(function(nt){var gt,Ut,$t=m in nt.props?nt.props[m]:(gt=nt.type.defaultProps)===null||gt===void 0?void 0:gt[m],qt="hide"in nt.props?nt.props.hide:(Ut=nt.type.defaultProps)===null||Ut===void 0?void 0:Ut.hide;return $t===De&&(ve||!qt)}),re,d,M);St&&(tt=St)}$&&(ee==="number"||ce!=="auto")&&(ct=Ow(Ye,re,"category"))}else $?tt=gA(0,ze):a&&a[De]&&a[De].hasStack&&ee==="number"?tt=N==="expand"?[0,1]:wK(a[De].stackGroups,w,S):tt=vK(Ye,c.filter(function(nt){var gt=m in nt.props?nt.props[m]:nt.type.defaultProps[m],Ut="hide"in nt.props?nt.props.hide:nt.type.defaultProps.hide;return gt===De&&(ve||!Ut)}),ee,M,!0);if(ee==="number")tt=OL(P,tt,De,d,me),rt&&(tt=Jk(rt,tt,fe));else if(ee==="category"&&rt){var qe=rt,vt=tt.every(function(nt){return qe.indexOf(nt)>=0});vt&&(tt=qe)}}return Mn(Mn({},G),{},vi({},De,Mn(Mn({},J),{},{axisType:d,domain:tt,categoricalDomain:ct,duplicateDomain:at,originalDomain:(V=J.domain)!==null&&V!==void 0?V:ht,isCategorical:$,layout:M})))},{})},eDe=function(t,n){var i=n.graphicalItems,c=n.Axis,d=n.axisType,m=n.axisIdKey,a=n.stackGroups,w=n.dataStartIndex,S=n.dataEndIndex,M=t.layout,P=t.children,N=aC(t.data,{graphicalItems:i,dataStartIndex:w,dataEndIndex:S}),$=N.length,G=xK(M,d),q=-1;return i.reduce(function(V,J){var ee=J.type.defaultProps!==void 0?Mn(Mn({},J.type.defaultProps),J.props):J.props,re=ee[m],fe=EJ("number");if(!V[re]){q++;var ne;return G?ne=gA(0,$):a&&a[re]&&a[re].hasStack?(ne=wK(a[re].stackGroups,w,S),ne=OL(P,ne,re,d)):(ne=Jk(fe,vK(N,i.filter(function(ce){var me,ve,De=m in ce.props?ce.props[m]:(me=ce.type.defaultProps)===null||me===void 0?void 0:me[m],Ye="hide"in ce.props?ce.props.hide:(ve=ce.type.defaultProps)===null||ve===void 0?void 0:ve.hide;return De===re&&!Ye}),"number",M),c.defaultProps.allowDataOverflow),ne=OL(P,ne,re,d)),Mn(Mn({},V),{},vi({},re,Mn(Mn({axisType:d},c.defaultProps),{},{hide:!0,orientation:Jh(ZIe,"".concat(d,".").concat(q%2),null),domain:ne,originalDomain:fe,isCategorical:G,layout:M})))}return V},{})},tDe=function(t,n){var i=n.axisType,c=i===void 0?"xAxis":i,d=n.AxisComp,m=n.graphicalItems,a=n.stackGroups,w=n.dataStartIndex,S=n.dataEndIndex,M=t.children,P="".concat(c,"Id"),N=Zd(M,d),$={};return N&&N.length?$=QIe(t,{axes:N,graphicalItems:m,axisType:c,axisIdKey:P,stackGroups:a,dataStartIndex:w,dataEndIndex:S}):m&&m.length&&($=eDe(t,{Axis:d,graphicalItems:m,axisType:c,axisIdKey:P,stackGroups:a,dataStartIndex:w,dataEndIndex:S})),$},nDe=function(t){var n=ny(t),i=Mm(n,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:Mz(i,function(c){return c.coordinate}),tooltipAxis:n,tooltipAxisBandSize:sA(n,i)}},PH=function(t){var n=t.children,i=t.defaultShowTooltip,c=Ku(n,n0),d=0,m=0;return t.data&&t.data.length!==0&&(m=t.data.length-1),c&&c.props&&(c.props.startIndex>=0&&(d=c.props.startIndex),c.props.endIndex>=0&&(m=c.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:d,dataEndIndex:m,activeTooltipIndex:-1,isTooltipActive:!!i}},rDe=function(t){return!t||!t.length?!1:t.some(function(n){var i=Dm(n&&n.type);return i&&i.indexOf("Bar")>=0})},OH=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},iDe=function(t,n){var i=t.props,c=t.graphicalItems,d=t.xAxisMap,m=d===void 0?{}:d,a=t.yAxisMap,w=a===void 0?{}:a,S=i.width,M=i.height,P=i.children,N=i.margin||{},$=Ku(P,n0),G=Ku(P,kx),q=Object.keys(w).reduce(function(ne,ce){var me=w[ce],ve=me.orientation;return!me.mirror&&!me.hide?Mn(Mn({},ne),{},vi({},ve,ne[ve]+me.width)):ne},{left:N.left||0,right:N.right||0}),V=Object.keys(m).reduce(function(ne,ce){var me=m[ce],ve=me.orientation;return!me.mirror&&!me.hide?Mn(Mn({},ne),{},vi({},ve,Jh(ne,"".concat(ve))+me.height)):ne},{top:N.top||0,bottom:N.bottom||0}),J=Mn(Mn({},V),q),ee=J.bottom;$&&(J.bottom+=$.props.height||n0.defaultProps.height),G&&n&&(J=_Ae(J,c,i,n));var re=S-J.left-J.right,fe=M-J.top-J.bottom;return Mn(Mn({brushBottom:ee},J),{},{width:Math.max(re,0),height:Math.max(fe,0)})},aDe=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},oDe=function(t){var n=t.chartName,i=t.GraphicalChild,c=t.defaultTooltipEventType,d=c===void 0?"axis":c,m=t.validateTooltipEventTypes,a=m===void 0?["axis"]:m,w=t.axisComponents,S=t.legendContent,M=t.formatAxisMap,P=t.defaultProps,N=function(J,ee){var re=ee.graphicalItems,fe=ee.stackGroups,ne=ee.offset,ce=ee.updateId,me=ee.dataStartIndex,ve=ee.dataEndIndex,De=J.barSize,Ye=J.layout,ze=J.barGap,tt=J.barCategoryGap,at=J.maxBarSize,ct=OH(Ye),ht=ct.numericAxisName,Ie=ct.cateAxisName,rt=rDe(re),Qe=[];return re.forEach(function(St,qe){var vt=aC(J.data,{graphicalItems:[St],dataStartIndex:me,dataEndIndex:ve}),nt=St.type.defaultProps!==void 0?Mn(Mn({},St.type.defaultProps),St.props):St.props,gt=nt.dataKey,Ut=nt.maxBarSize,$t=nt["".concat(ht,"Id")],qt=nt["".concat(Ie,"Id")],Ht={},mn=w.reduce(function(Bt,tn){var $n=ee["".concat(tn.axisType,"Map")],qn=nt["".concat(tn.axisType,"Id")];$n&&$n[qn]||tn.axisType==="zAxis"||tv();var An=$n[qn];return Mn(Mn({},Bt),{},vi(vi({},tn.axisType,An),"".concat(tn.axisType,"Ticks"),Mm(An)))},Ht),en=mn[Ie],En=mn["".concat(Ie,"Ticks")],Xn=fe&&fe[$t]&&fe[$t].hasStack&&IAe(St,fe[$t].stackGroups),cn=Dm(St.type).indexOf("Bar")>=0,Jr=sA(en,En),mr=[],Cr=rt&&gAe({barSize:De,stackGroups:fe,totalSize:aDe(mn,Ie)});if(cn){var li,hi,so=ga(Ut)?at:Ut,ra=(li=(hi=sA(en,En,!0))!==null&&hi!==void 0?hi:so)!==null&&li!==void 0?li:0;mr=yAe({barGap:ze,barCategoryGap:tt,bandSize:ra!==Jr?ra:Jr,sizeList:Cr[qt],maxBarSize:so}),ra!==Jr&&(mr=mr.map(function(Bt){return Mn(Mn({},Bt),{},{position:Mn(Mn({},Bt.position),{},{offset:Bt.position.offset-ra/2})})}))}var xt=St&&St.type&&St.type.getComposedData;xt&&Qe.push({props:Mn(Mn({},xt(Mn(Mn({},mn),{},{displayedData:vt,props:J,dataKey:gt,item:St,bandSize:Jr,barPosition:mr,offset:ne,stackedData:Xn,layout:Ye,dataStartIndex:me,dataEndIndex:ve}))),{},vi(vi(vi({key:St.key||"item-".concat(qe)},ht,mn[ht]),Ie,mn[Ie]),"animationId",ce)),childIndex:_xe(St,J.children),item:St})}),Qe},$=function(J,ee){var re=J.props,fe=J.dataStartIndex,ne=J.dataEndIndex,ce=J.updateId;if(!eU({props:re}))return null;var me=re.children,ve=re.layout,De=re.stackOffset,Ye=re.data,ze=re.reverseStackOrder,tt=OH(ve),at=tt.numericAxisName,ct=tt.cateAxisName,ht=Zd(me,i),Ie=PAe(Ye,ht,"".concat(at,"Id"),"".concat(ct,"Id"),De,ze),rt=w.reduce(function(nt,gt){var Ut="".concat(gt.axisType,"Map");return Mn(Mn({},nt),{},vi({},Ut,tDe(re,Mn(Mn({},gt),{},{graphicalItems:ht,stackGroups:gt.axisType===at&&Ie,dataStartIndex:fe,dataEndIndex:ne}))))},{}),Qe=iDe(Mn(Mn({},rt),{},{props:re,graphicalItems:ht}),ee?.legendBBox);Object.keys(rt).forEach(function(nt){rt[nt]=M(re,rt[nt],Qe,nt.replace("Map",""),n)});var St=rt["".concat(ct,"Map")],qe=nDe(St),vt=N(re,Mn(Mn({},rt),{},{dataStartIndex:fe,dataEndIndex:ne,updateId:ce,graphicalItems:ht,stackGroups:Ie,offset:Qe}));return Mn(Mn({formattedGraphicalItems:vt,graphicalItems:ht,offset:Qe,stackGroups:Ie},qe),rt)},G=(function(V){function J(ee){var re,fe,ne;return jIe(this,J),ne=VIe(this,J,[ee]),vi(ne,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),vi(ne,"accessibilityManager",new TIe),vi(ne,"handleLegendBBoxUpdate",function(ce){if(ce){var me=ne.state,ve=me.dataStartIndex,De=me.dataEndIndex,Ye=me.updateId;ne.setState(Mn({legendBBox:ce},$({props:ne.props,dataStartIndex:ve,dataEndIndex:De,updateId:Ye},Mn(Mn({},ne.state),{},{legendBBox:ce}))))}}),vi(ne,"handleReceiveSyncEvent",function(ce,me,ve){if(ne.props.syncId===ce){if(ve===ne.eventEmitterSymbol&&typeof ne.props.syncMethod!="function")return;ne.applySyncEvent(me)}}),vi(ne,"handleBrushChange",function(ce){var me=ce.startIndex,ve=ce.endIndex;if(me!==ne.state.dataStartIndex||ve!==ne.state.dataEndIndex){var De=ne.state.updateId;ne.setState(function(){return Mn({dataStartIndex:me,dataEndIndex:ve},$({props:ne.props,dataStartIndex:me,dataEndIndex:ve,updateId:De},ne.state))}),ne.triggerSyncEvent({dataStartIndex:me,dataEndIndex:ve})}}),vi(ne,"handleMouseEnter",function(ce){var me=ne.getMouseInfo(ce);if(me){var ve=Mn(Mn({},me),{},{isTooltipActive:!0});ne.setState(ve),ne.triggerSyncEvent(ve);var De=ne.props.onMouseEnter;Hi(De)&&De(ve,ce)}}),vi(ne,"triggeredAfterMouseMove",function(ce){var me=ne.getMouseInfo(ce),ve=me?Mn(Mn({},me),{},{isTooltipActive:!0}):{isTooltipActive:!1};ne.setState(ve),ne.triggerSyncEvent(ve);var De=ne.props.onMouseMove;Hi(De)&&De(ve,ce)}),vi(ne,"handleItemMouseEnter",function(ce){ne.setState(function(){return{isTooltipActive:!0,activeItem:ce,activePayload:ce.tooltipPayload,activeCoordinate:ce.tooltipPosition||{x:ce.cx,y:ce.cy}}})}),vi(ne,"handleItemMouseLeave",function(){ne.setState(function(){return{isTooltipActive:!1}})}),vi(ne,"handleMouseMove",function(ce){ce.persist(),ne.throttleTriggeredAfterMouseMove(ce)}),vi(ne,"handleMouseLeave",function(ce){ne.throttleTriggeredAfterMouseMove.cancel();var me={isTooltipActive:!1};ne.setState(me),ne.triggerSyncEvent(me);var ve=ne.props.onMouseLeave;Hi(ve)&&ve(me,ce)}),vi(ne,"handleOuterEvent",function(ce){var me=yxe(ce),ve=Jh(ne.props,"".concat(me));if(me&&Hi(ve)){var De,Ye;/.*touch.*/i.test(me)?Ye=ne.getMouseInfo(ce.changedTouches[0]):Ye=ne.getMouseInfo(ce),ve((De=Ye)!==null&&De!==void 0?De:{},ce)}}),vi(ne,"handleClick",function(ce){var me=ne.getMouseInfo(ce);if(me){var ve=Mn(Mn({},me),{},{isTooltipActive:!0});ne.setState(ve),ne.triggerSyncEvent(ve);var De=ne.props.onClick;Hi(De)&&De(ve,ce)}}),vi(ne,"handleMouseDown",function(ce){var me=ne.props.onMouseDown;if(Hi(me)){var ve=ne.getMouseInfo(ce);me(ve,ce)}}),vi(ne,"handleMouseUp",function(ce){var me=ne.props.onMouseUp;if(Hi(me)){var ve=ne.getMouseInfo(ce);me(ve,ce)}}),vi(ne,"handleTouchMove",function(ce){ce.changedTouches!=null&&ce.changedTouches.length>0&&ne.throttleTriggeredAfterMouseMove(ce.changedTouches[0])}),vi(ne,"handleTouchStart",function(ce){ce.changedTouches!=null&&ce.changedTouches.length>0&&ne.handleMouseDown(ce.changedTouches[0])}),vi(ne,"handleTouchEnd",function(ce){ce.changedTouches!=null&&ce.changedTouches.length>0&&ne.handleMouseUp(ce.changedTouches[0])}),vi(ne,"handleDoubleClick",function(ce){var me=ne.props.onDoubleClick;if(Hi(me)){var ve=ne.getMouseInfo(ce);me(ve,ce)}}),vi(ne,"handleContextMenu",function(ce){var me=ne.props.onContextMenu;if(Hi(me)){var ve=ne.getMouseInfo(ce);me(ve,ce)}}),vi(ne,"triggerSyncEvent",function(ce){ne.props.syncId!==void 0&&lD.emit(cD,ne.props.syncId,ce,ne.eventEmitterSymbol)}),vi(ne,"applySyncEvent",function(ce){var me=ne.props,ve=me.layout,De=me.syncMethod,Ye=ne.state.updateId,ze=ce.dataStartIndex,tt=ce.dataEndIndex;if(ce.dataStartIndex!==void 0||ce.dataEndIndex!==void 0)ne.setState(Mn({dataStartIndex:ze,dataEndIndex:tt},$({props:ne.props,dataStartIndex:ze,dataEndIndex:tt,updateId:Ye},ne.state)));else if(ce.activeTooltipIndex!==void 0){var at=ce.chartX,ct=ce.chartY,ht=ce.activeTooltipIndex,Ie=ne.state,rt=Ie.offset,Qe=Ie.tooltipTicks;if(!rt)return;if(typeof De=="function")ht=De(Qe,ce);else if(De==="value"){ht=-1;for(var St=0;St<Qe.length;St++)if(Qe[St].value===ce.activeLabel){ht=St;break}}var qe=Mn(Mn({},rt),{},{x:rt.left,y:rt.top}),vt=Math.min(at,qe.x+qe.width),nt=Math.min(ct,qe.y+qe.height),gt=Qe[ht]&&Qe[ht].value,Ut=DL(ne.state,ne.props.data,ht),$t=Qe[ht]?{x:ve==="horizontal"?Qe[ht].coordinate:vt,y:ve==="horizontal"?nt:Qe[ht].coordinate}:TJ;ne.setState(Mn(Mn({},ce),{},{activeLabel:gt,activeCoordinate:$t,activePayload:Ut,activeTooltipIndex:ht}))}else ne.setState(ce)}),vi(ne,"renderCursor",function(ce){var me,ve=ne.state,De=ve.isTooltipActive,Ye=ve.activeCoordinate,ze=ve.activePayload,tt=ve.offset,at=ve.activeTooltipIndex,ct=ve.tooltipAxisBandSize,ht=ne.getTooltipEventType(),Ie=(me=ce.props.active)!==null&&me!==void 0?me:De,rt=ne.props.layout,Qe=ce.key||"_recharts-cursor";return Ce.createElement(RIe,{key:Qe,activeCoordinate:Ye,activePayload:ze,activeTooltipIndex:at,chartName:n,element:ce,isActive:Ie,layout:rt,offset:tt,tooltipAxisBandSize:ct,tooltipEventType:ht})}),vi(ne,"renderPolarAxis",function(ce,me,ve){var De=Jh(ce,"type.axisType"),Ye=Jh(ne.state,"".concat(De,"Map")),ze=ce.type.defaultProps,tt=ze!==void 0?Mn(Mn({},ze),ce.props):ce.props,at=Ye&&Ye[tt["".concat(De,"Id")]];return K.cloneElement(ce,Mn(Mn({},at),{},{className:xa(De,at.className),key:ce.key||"".concat(me,"-").concat(ve),ticks:Mm(at,!0)}))}),vi(ne,"renderPolarGrid",function(ce){var me=ce.props,ve=me.radialLines,De=me.polarAngles,Ye=me.polarRadius,ze=ne.state,tt=ze.radiusAxisMap,at=ze.angleAxisMap,ct=ny(tt),ht=ny(at),Ie=ht.cx,rt=ht.cy,Qe=ht.innerRadius,St=ht.outerRadius;return K.cloneElement(ce,{polarAngles:Array.isArray(De)?De:Mm(ht,!0).map(function(qe){return qe.coordinate}),polarRadius:Array.isArray(Ye)?Ye:Mm(ct,!0).map(function(qe){return qe.coordinate}),cx:Ie,cy:rt,innerRadius:Qe,outerRadius:St,key:ce.key||"polar-grid",radialLines:ve})}),vi(ne,"renderLegend",function(){var ce=ne.state.formattedGraphicalItems,me=ne.props,ve=me.children,De=me.width,Ye=me.height,ze=ne.props.margin||{},tt=De-(ze.left||0)-(ze.right||0),at=yK({children:ve,formattedGraphicalItems:ce,legendWidth:tt,legendContent:S});if(!at)return null;var ct=at.item,ht=AH(at,IIe);return K.cloneElement(ct,Mn(Mn({},ht),{},{chartWidth:De,chartHeight:Ye,margin:ze,onBBoxUpdate:ne.handleLegendBBoxUpdate}))}),vi(ne,"renderTooltip",function(){var ce,me=ne.props,ve=me.children,De=me.accessibilityLayer,Ye=Ku(ve,tp);if(!Ye)return null;var ze=ne.state,tt=ze.isTooltipActive,at=ze.activeCoordinate,ct=ze.activePayload,ht=ze.activeLabel,Ie=ze.offset,rt=(ce=Ye.props.active)!==null&&ce!==void 0?ce:tt;return K.cloneElement(Ye,{viewBox:Mn(Mn({},Ie),{},{x:Ie.left,y:Ie.top}),active:rt,label:ht,payload:rt?ct:[],coordinate:at,accessibilityLayer:De})}),vi(ne,"renderBrush",function(ce){var me=ne.props,ve=me.margin,De=me.data,Ye=ne.state,ze=Ye.offset,tt=Ye.dataStartIndex,at=Ye.dataEndIndex,ct=Ye.updateId;return K.cloneElement(ce,{key:ce.key||"_recharts-brush",onChange:GT(ne.handleBrushChange,ce.props.onChange),data:De,x:rr(ce.props.x)?ce.props.x:ze.left,y:rr(ce.props.y)?ce.props.y:ze.top+ze.height+ze.brushBottom-(ve.bottom||0),width:rr(ce.props.width)?ce.props.width:ze.width,startIndex:tt,endIndex:at,updateId:"brush-".concat(ct)})}),vi(ne,"renderReferenceElement",function(ce,me,ve){if(!ce)return null;var De=ne,Ye=De.clipPathId,ze=ne.state,tt=ze.xAxisMap,at=ze.yAxisMap,ct=ze.offset,ht=ce.type.defaultProps||{},Ie=ce.props,rt=Ie.xAxisId,Qe=rt===void 0?ht.xAxisId:rt,St=Ie.yAxisId,qe=St===void 0?ht.yAxisId:St;return K.cloneElement(ce,{key:ce.key||"".concat(me,"-").concat(ve),xAxis:tt[Qe],yAxis:at[qe],viewBox:{x:ct.left,y:ct.top,width:ct.width,height:ct.height},clipPathId:Ye})}),vi(ne,"renderActivePoints",function(ce){var me=ce.item,ve=ce.activePoint,De=ce.basePoint,Ye=ce.childIndex,ze=ce.isRange,tt=[],at=me.props.key,ct=me.item.type.defaultProps!==void 0?Mn(Mn({},me.item.type.defaultProps),me.item.props):me.item.props,ht=ct.activeDot,Ie=ct.dataKey,rt=Mn(Mn({index:Ye,dataKey:Ie,cx:ve.x,cy:ve.y,r:4,fill:ej(me.item),strokeWidth:2,stroke:"#fff",payload:ve.payload,value:ve.value},ha(ht,!1)),LE(ht));return tt.push(J.renderActiveDot(ht,rt,"".concat(at,"-activePoint-").concat(Ye))),De?tt.push(J.renderActiveDot(ht,Mn(Mn({},rt),{},{cx:De.x,cy:De.y}),"".concat(at,"-basePoint-").concat(Ye))):ze&&tt.push(null),tt}),vi(ne,"renderGraphicChild",function(ce,me,ve){var De=ne.filterFormatItem(ce,me,ve);if(!De)return null;var Ye=ne.getTooltipEventType(),ze=ne.state,tt=ze.isTooltipActive,at=ze.tooltipAxis,ct=ze.activeTooltipIndex,ht=ze.activeLabel,Ie=ne.props.children,rt=Ku(Ie,tp),Qe=De.props,St=Qe.points,qe=Qe.isRange,vt=Qe.baseLine,nt=De.item.type.defaultProps!==void 0?Mn(Mn({},De.item.type.defaultProps),De.item.props):De.item.props,gt=nt.activeDot,Ut=nt.hide,$t=nt.activeBar,qt=nt.activeShape,Ht=!!(!Ut&&tt&&rt&&(gt||$t||qt)),mn={};Ye!=="axis"&&rt&&rt.props.trigger==="click"?mn={onClick:GT(ne.handleItemMouseEnter,ce.props.onClick)}:Ye!=="axis"&&(mn={onMouseLeave:GT(ne.handleItemMouseLeave,ce.props.onMouseLeave),onMouseEnter:GT(ne.handleItemMouseEnter,ce.props.onMouseEnter)});var en=K.cloneElement(ce,Mn(Mn({},De.props),mn));function En(tn){return typeof at.dataKey=="function"?at.dataKey(tn.payload):null}if(Ht)if(ct>=0){var Xn,cn;if(at.dataKey&&!at.allowDuplicatedCategory){var Jr=typeof at.dataKey=="function"?En:"payload.".concat(at.dataKey.toString());Xn=kE(St,Jr,ht),cn=qe&&vt&&kE(vt,Jr,ht)}else Xn=St?.[ct],cn=qe&&vt&&vt[ct];if(qt||$t){var mr=ce.props.activeIndex!==void 0?ce.props.activeIndex:ct;return[K.cloneElement(ce,Mn(Mn(Mn({},De.props),mn),{},{activeIndex:mr})),null,null]}if(!ga(Xn))return[en].concat(d0(ne.renderActivePoints({item:De,activePoint:Xn,basePoint:cn,childIndex:ct,isRange:qe})))}else{var Cr,li=(Cr=ne.getItemByXY(ne.state.activeCoordinate))!==null&&Cr!==void 0?Cr:{graphicalItem:en},hi=li.graphicalItem,so=hi.item,ra=so===void 0?ce:so,xt=hi.childIndex,Bt=Mn(Mn(Mn({},De.props),mn),{},{activeIndex:xt});return[K.cloneElement(ra,Bt),null,null]}return qe?[en,null,null]:[en,null]}),vi(ne,"renderCustomized",function(ce,me,ve){return K.cloneElement(ce,Mn(Mn({key:"recharts-customized-".concat(ve)},ne.props),ne.state))}),vi(ne,"renderMap",{CartesianGrid:{handler:KT,once:!0},ReferenceArea:{handler:ne.renderReferenceElement},ReferenceLine:{handler:KT},ReferenceDot:{handler:ne.renderReferenceElement},XAxis:{handler:KT},YAxis:{handler:KT},Brush:{handler:ne.renderBrush,once:!0},Bar:{handler:ne.renderGraphicChild},Line:{handler:ne.renderGraphicChild},Area:{handler:ne.renderGraphicChild},Radar:{handler:ne.renderGraphicChild},RadialBar:{handler:ne.renderGraphicChild},Scatter:{handler:ne.renderGraphicChild},Pie:{handler:ne.renderGraphicChild},Funnel:{handler:ne.renderGraphicChild},Tooltip:{handler:ne.renderCursor,once:!0},PolarGrid:{handler:ne.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ne.renderPolarAxis},PolarRadiusAxis:{handler:ne.renderPolarAxis},Customized:{handler:ne.renderCustomized}}),ne.clipPathId="".concat((re=ee.id)!==null&&re!==void 0?re:nS("recharts"),"-clip"),ne.throttleTriggeredAfterMouseMove=gY(ne.triggeredAfterMouseMove,(fe=ee.throttleDelay)!==null&&fe!==void 0?fe:1e3/60),ne.state={},ne}return qIe(J,V),FIe(J,[{key:"componentDidMount",value:function(){var re,fe;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(re=this.props.margin.left)!==null&&re!==void 0?re:0,top:(fe=this.props.margin.top)!==null&&fe!==void 0?fe:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var re=this.props,fe=re.children,ne=re.data,ce=re.height,me=re.layout,ve=Ku(fe,tp);if(ve){var De=ve.props.defaultIndex;if(!(typeof De!="number"||De<0||De>this.state.tooltipTicks.length-1)){var Ye=this.state.tooltipTicks[De]&&this.state.tooltipTicks[De].value,ze=DL(this.state,ne,De,Ye),tt=this.state.tooltipTicks[De].coordinate,at=(this.state.offset.top+ce)/2,ct=me==="horizontal",ht=ct?{x:tt,y:at}:{y:tt,x:at},Ie=this.state.formattedGraphicalItems.find(function(Qe){var St=Qe.item;return St.type.name==="Scatter"});Ie&&(ht=Mn(Mn({},ht),Ie.props.points[De].tooltipPosition),ze=Ie.props.points[De].tooltipPayload);var rt={activeTooltipIndex:De,isTooltipActive:!0,activeLabel:Ye,activePayload:ze,activeCoordinate:ht};this.setState(rt),this.renderCursor(ve),this.accessibilityManager.setIndex(De)}}}},{key:"getSnapshotBeforeUpdate",value:function(re,fe){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==fe.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==re.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==re.margin){var ne,ce;this.accessibilityManager.setDetails({offset:{left:(ne=this.props.margin.left)!==null&&ne!==void 0?ne:0,top:(ce=this.props.margin.top)!==null&&ce!==void 0?ce:0}})}return null}},{key:"componentDidUpdate",value:function(re){xk([Ku(re.children,tp)],[Ku(this.props.children,tp)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var re=Ku(this.props.children,tp);if(re&&typeof re.props.shared=="boolean"){var fe=re.props.shared?"axis":"item";return a.indexOf(fe)>=0?fe:d}return d}},{key:"getMouseInfo",value:function(re){if(!this.container)return null;var fe=this.container,ne=fe.getBoundingClientRect(),ce=a1e(ne),me={chartX:Math.round(re.pageX-ce.left),chartY:Math.round(re.pageY-ce.top)},ve=ne.width/fe.offsetWidth||1,De=this.inRange(me.chartX,me.chartY,ve);if(!De)return null;var Ye=this.state,ze=Ye.xAxisMap,tt=Ye.yAxisMap,at=this.getTooltipEventType(),ct=MH(this.state,this.props.data,this.props.layout,De);if(at!=="axis"&&ze&&tt){var ht=ny(ze).scale,Ie=ny(tt).scale,rt=ht&&ht.invert?ht.invert(me.chartX):null,Qe=Ie&&Ie.invert?Ie.invert(me.chartY):null;return Mn(Mn({},me),{},{xValue:rt,yValue:Qe},ct)}return ct?Mn(Mn({},me),ct):null}},{key:"inRange",value:function(re,fe){var ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ce=this.props.layout,me=re/ne,ve=fe/ne;if(ce==="horizontal"||ce==="vertical"){var De=this.state.offset,Ye=me>=De.left&&me<=De.left+De.width&&ve>=De.top&&ve<=De.top+De.height;return Ye?{x:me,y:ve}:null}var ze=this.state,tt=ze.angleAxisMap,at=ze.radiusAxisMap;if(tt&&at){var ct=ny(tt);return $q({x:me,y:ve},ct)}return null}},{key:"parseEventsOfWrapper",value:function(){var re=this.props.children,fe=this.getTooltipEventType(),ne=Ku(re,tp),ce={};ne&&fe==="axis"&&(ne.props.trigger==="click"?ce={onClick:this.handleClick}:ce={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var me=LE(this.props,this.handleOuterEvent);return Mn(Mn({},me),ce)}},{key:"addListener",value:function(){lD.on(cD,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){lD.removeListener(cD,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(re,fe,ne){for(var ce=this.state.formattedGraphicalItems,me=0,ve=ce.length;me<ve;me++){var De=ce[me];if(De.item===re||De.props.key===re.key||fe===Dm(De.item.type)&&ne===De.childIndex)return De}return null}},{key:"renderClipPath",value:function(){var re=this.clipPathId,fe=this.state.offset,ne=fe.left,ce=fe.top,me=fe.height,ve=fe.width;return Ce.createElement("defs",null,Ce.createElement("clipPath",{id:re},Ce.createElement("rect",{x:ne,y:ce,height:me,width:ve})))}},{key:"getXScales",value:function(){var re=this.state.xAxisMap;return re?Object.entries(re).reduce(function(fe,ne){var ce=EH(ne,2),me=ce[0],ve=ce[1];return Mn(Mn({},fe),{},vi({},me,ve.scale))},{}):null}},{key:"getYScales",value:function(){var re=this.state.yAxisMap;return re?Object.entries(re).reduce(function(fe,ne){var ce=EH(ne,2),me=ce[0],ve=ce[1];return Mn(Mn({},fe),{},vi({},me,ve.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(re){var fe;return(fe=this.state.xAxisMap)===null||fe===void 0||(fe=fe[re])===null||fe===void 0?void 0:fe.scale}},{key:"getYScaleByAxisId",value:function(re){var fe;return(fe=this.state.yAxisMap)===null||fe===void 0||(fe=fe[re])===null||fe===void 0?void 0:fe.scale}},{key:"getItemByXY",value:function(re){var fe=this.state,ne=fe.formattedGraphicalItems,ce=fe.activeItem;if(ne&&ne.length)for(var me=0,ve=ne.length;me<ve;me++){var De=ne[me],Ye=De.props,ze=De.item,tt=ze.type.defaultProps!==void 0?Mn(Mn({},ze.type.defaultProps),ze.props):ze.props,at=Dm(ze.type);if(at==="Bar"){var ct=(Ye.data||[]).find(function(Qe){return wMe(re,Qe)});if(ct)return{graphicalItem:De,payload:ct}}else if(at==="RadialBar"){var ht=(Ye.data||[]).find(function(Qe){return $q(re,Qe)});if(ht)return{graphicalItem:De,payload:ht}}else if(Y2(De,ce)||K2(De,ce)||x1(De,ce)){var Ie=dPe({graphicalItem:De,activeTooltipItem:ce,itemData:tt.data}),rt=tt.activeIndex===void 0?Ie:tt.activeIndex;return{graphicalItem:Mn(Mn({},De),{},{childIndex:rt}),payload:x1(De,ce)?tt.data[Ie]:De.props.data[Ie]}}}return null}},{key:"render",value:function(){var re=this;if(!eU(this))return null;var fe=this.props,ne=fe.children,ce=fe.className,me=fe.width,ve=fe.height,De=fe.style,Ye=fe.compact,ze=fe.title,tt=fe.desc,at=AH(fe,DIe),ct=ha(at,!1);if(Ye)return Ce.createElement(sH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ce.createElement(wk,Ax({},ct,{width:me,height:ve,title:ze,desc:tt}),this.renderClipPath(),nU(ne,this.renderMap)));if(this.props.accessibilityLayer){var ht,Ie;ct.tabIndex=(ht=this.props.tabIndex)!==null&&ht!==void 0?ht:0,ct.role=(Ie=this.props.role)!==null&&Ie!==void 0?Ie:"application",ct.onKeyDown=function(Qe){re.accessibilityManager.keyboardEvent(Qe)},ct.onFocus=function(){re.accessibilityManager.focus()}}var rt=this.parseEventsOfWrapper();return Ce.createElement(sH,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Ce.createElement("div",Ax({className:xa("recharts-wrapper",ce),style:Mn({position:"relative",cursor:"default",width:me,height:ve},De)},rt,{ref:function(St){re.container=St}}),Ce.createElement(wk,Ax({},ct,{width:me,height:ve,title:ze,desc:tt,style:YIe}),this.renderClipPath(),nU(ne,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(K.Component);vi(G,"displayName",n),vi(G,"defaultProps",Mn({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},P)),vi(G,"getDerivedStateFromProps",function(V,J){var ee=V.dataKey,re=V.data,fe=V.children,ne=V.width,ce=V.height,me=V.layout,ve=V.stackOffset,De=V.margin,Ye=J.dataStartIndex,ze=J.dataEndIndex;if(J.updateId===void 0){var tt=PH(V);return Mn(Mn(Mn({},tt),{},{updateId:0},$(Mn(Mn({props:V},tt),{},{updateId:0}),J)),{},{prevDataKey:ee,prevData:re,prevWidth:ne,prevHeight:ce,prevLayout:me,prevStackOffset:ve,prevMargin:De,prevChildren:fe})}if(ee!==J.prevDataKey||re!==J.prevData||ne!==J.prevWidth||ce!==J.prevHeight||me!==J.prevLayout||ve!==J.prevStackOffset||!Dx(De,J.prevMargin)){var at=PH(V),ct={chartX:J.chartX,chartY:J.chartY,isTooltipActive:J.isTooltipActive},ht=Mn(Mn({},MH(J,re,me)),{},{updateId:J.updateId+1}),Ie=Mn(Mn(Mn({},at),ct),ht);return Mn(Mn(Mn({},Ie),$(Mn({props:V},Ie),J)),{},{prevDataKey:ee,prevData:re,prevWidth:ne,prevHeight:ce,prevLayout:me,prevStackOffset:ve,prevMargin:De,prevChildren:fe})}if(!xk(fe,J.prevChildren)){var rt,Qe,St,qe,vt=Ku(fe,n0),nt=vt&&(rt=(Qe=vt.props)===null||Qe===void 0?void 0:Qe.startIndex)!==null&&rt!==void 0?rt:Ye,gt=vt&&(St=(qe=vt.props)===null||qe===void 0?void 0:qe.endIndex)!==null&&St!==void 0?St:ze,Ut=nt!==Ye||gt!==ze,$t=!ga(re),qt=$t&&!Ut?J.updateId:J.updateId+1;return Mn(Mn({updateId:qt},$(Mn(Mn({props:V},J),{},{updateId:qt,dataStartIndex:nt,dataEndIndex:gt}),J)),{},{prevChildren:fe,dataStartIndex:nt,dataEndIndex:gt})}return null}),vi(G,"renderActiveDot",function(V,J,ee){var re;return K.isValidElement(V)?re=K.cloneElement(V,J):Hi(V)?re=V(J):re=Ce.createElement(nj,J),Ce.createElement(as,{className:"recharts-active-dot",key:ee},re)});var q=K.forwardRef(function(J,ee){return Ce.createElement(G,Ax({},J,{ref:ee}))});return q.displayName=G.displayName,q},sDe=oDe({chartName:"AreaChart",GraphicalChild:Sy,axisComponents:[{axisType:"xAxis",AxisComp:rC},{axisType:"yAxis",AxisComp:iC}],formatAxisMap:lOe});const lDe={light:"",dark:".dark"},AJ=K.createContext(null);function cDe(){const e=K.useContext(AJ);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}function uDe({id:e,className:t,children:n,config:i,...c}){const d=K.useId(),m=`chart-${e||d.replace(/:/g,"")}`;return D.jsx(AJ.Provider,{value:{config:i},children:D.jsxs("div",{"data-slot":"chart","data-chart":m,className:bn("[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",t),...c,children:[D.jsx(hDe,{id:m,config:i}),D.jsx(Jwe,{children:n})]})})}const hDe=({id:e,config:t})=>{const n=Object.entries(t).filter(([,i])=>i.theme||i.color);return n.length?D.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(lDe).map(([i,c])=>`
${c} [data-chart=${e}] {
${n.map(([d,m])=>{const a=m.theme?.[i]||m.color;return a?`  --color-${d}: ${a};`:null}).join(`
`)}
}
`).join(`
`)}}):null},dDe=tp;function fDe({active:e,payload:t,className:n,indicator:i="dot",hideLabel:c=!1,hideIndicator:d=!1,label:m,labelFormatter:a,labelClassName:w,formatter:S,color:M,nameKey:P,labelKey:N}){const{config:$}=cDe(),G=K.useMemo(()=>{if(c||!t?.length)return null;const[V]=t,J=`${N||V?.dataKey||V?.name||"value"}`,ee=RH($,V,J),re=!N&&typeof m=="string"?$[m]?.label||m:ee?.label;return a?D.jsx("div",{className:bn("font-medium",w),children:a(re,t)}):re?D.jsx("div",{className:bn("font-medium",w),children:re}):null},[m,a,t,c,w,$,N]);if(!e||!t?.length)return null;const q=t.length===1&&i!=="dot";return D.jsxs("div",{className:bn("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",n),children:[q?null:G,D.jsx("div",{className:"grid gap-1.5",children:t.filter(V=>V.type!=="none").map((V,J)=>{const ee=`${P||V.name||V.dataKey||"value"}`,re=RH($,V,ee),fe=M||V.payload.fill||V.color;return D.jsx("div",{className:bn("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5",i==="dot"&&"items-center"),children:S&&V?.value!==void 0&&V.name?S(V.value,V.name,V,J,V.payload):D.jsxs(D.Fragment,{children:[re?.icon?D.jsx(re.icon,{}):!d&&D.jsx("div",{className:bn("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":i==="dot","w-1":i==="line","w-0 border-[1.5px] border-dashed bg-transparent":i==="dashed","my-0.5":q&&i==="dashed"}),style:{"--color-bg":fe,"--color-border":fe}}),D.jsxs("div",{className:bn("flex flex-1 justify-between leading-none",q?"items-end":"items-center"),children:[D.jsxs("div",{className:"grid gap-1.5",children:[q?G:null,D.jsx("span",{className:"text-muted-foreground",children:re?.label||V.name})]}),V.value&&D.jsx("span",{className:"text-foreground font-mono font-medium tabular-nums",children:V.value.toLocaleString()})]})]})},V.dataKey)})})]})}function RH(e,t,n){if(typeof t!="object"||t===null)return;const i="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let c=n;return n in t&&typeof t[n]=="string"?c=t[n]:i&&n in i&&typeof i[n]=="string"&&(c=i[n]),c in e?e[c]:e[n]}const pDe={total:{label:"Reservations",color:"hsl(var(--chart-1))"}};function mDe({data:e}){return D.jsx(uDe,{config:pDe,className:"w-full h-full",children:D.jsxs(sDe,{accessibilityLayer:!0,data:e,margin:{top:0,right:0,left:0,bottom:0},children:[D.jsx(lJ,{vertical:!1}),D.jsx(rC,{dataKey:"day",tickLine:!1,axisLine:!1,tickMargin:0,tickFormatter:t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),D.jsx(iC,{domain:["auto",t=>t*1.05],axisLine:!1,tickLine:!1,tick:!1,hide:!0}),D.jsx(dDe,{cursor:!1,content:D.jsx(fDe,{})}),D.jsx("defs",{children:D.jsxs("linearGradient",{id:"fillTotal",x1:"0",y1:"0",x2:"0",y2:"1",children:[D.jsx("stop",{offset:"5%",stopColor:"var(--vivid-neon-pink)",stopOpacity:.8}),D.jsx("stop",{offset:"95%",stopColor:"var(--vivid-indigo)",stopOpacity:.1})]})}),D.jsx(Sy,{dataKey:"total",type:"natural",fill:"url(#fillTotal)",fillOpacity:.4,stroke:"var(--vivid-neon-pink)"})]})})}const gDe=iN("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function _p({className:e,variant:t,asChild:n=!1,...i}){const c=n?F1:"span";return D.jsx(c,{"data-slot":"badge",className:bn(gDe({variant:t}),e),...i})}var hD={exports:{}};/*!
 * Pusher JavaScript Library v8.4.0
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */var IH;function yDe(){return IH||(IH=1,(function(e,t){(function(i,c){e.exports=c()})(window,function(){return(function(n){var i={};function c(d){if(i[d])return i[d].exports;var m=i[d]={i:d,l:!1,exports:{}};return n[d].call(m.exports,m,m.exports,c),m.l=!0,m.exports}return c.m=n,c.c=i,c.d=function(d,m,a){c.o(d,m)||Object.defineProperty(d,m,{enumerable:!0,get:a})},c.r=function(d){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},c.t=function(d,m){if(m&1&&(d=c(d)),m&8||m&4&&typeof d=="object"&&d&&d.__esModule)return d;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:d}),m&2&&typeof d!="string")for(var w in d)c.d(a,w,(function(S){return d[S]}).bind(null,w));return a},c.n=function(d){var m=d&&d.__esModule?function(){return d.default}:function(){return d};return c.d(m,"a",m),m},c.o=function(d,m){return Object.prototype.hasOwnProperty.call(d,m)},c.p="",c(c.s=2)})([(function(n,i,c){var d=this&&this.__extends||(function(){var q=function(V,J){return q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,re){ee.__proto__=re}||function(ee,re){for(var fe in re)re.hasOwnProperty(fe)&&(ee[fe]=re[fe])},q(V,J)};return function(V,J){q(V,J);function ee(){this.constructor=V}V.prototype=J===null?Object.create(J):(ee.prototype=J.prototype,new ee)}})();Object.defineProperty(i,"__esModule",{value:!0});var m=256,a=(function(){function q(V){V===void 0&&(V="="),this._paddingCharacter=V}return q.prototype.encodedLength=function(V){return this._paddingCharacter?(V+2)/3*4|0:(V*8+5)/6|0},q.prototype.encode=function(V){for(var J="",ee=0;ee<V.length-2;ee+=3){var re=V[ee]<<16|V[ee+1]<<8|V[ee+2];J+=this._encodeByte(re>>>18&63),J+=this._encodeByte(re>>>12&63),J+=this._encodeByte(re>>>6&63),J+=this._encodeByte(re>>>0&63)}var fe=V.length-ee;if(fe>0){var re=V[ee]<<16|(fe===2?V[ee+1]<<8:0);J+=this._encodeByte(re>>>18&63),J+=this._encodeByte(re>>>12&63),fe===2?J+=this._encodeByte(re>>>6&63):J+=this._paddingCharacter||"",J+=this._paddingCharacter||""}return J},q.prototype.maxDecodedLength=function(V){return this._paddingCharacter?V/4*3|0:(V*6+7)/8|0},q.prototype.decodedLength=function(V){return this.maxDecodedLength(V.length-this._getPaddingLength(V))},q.prototype.decode=function(V){if(V.length===0)return new Uint8Array(0);for(var J=this._getPaddingLength(V),ee=V.length-J,re=new Uint8Array(this.maxDecodedLength(ee)),fe=0,ne=0,ce=0,me=0,ve=0,De=0,Ye=0;ne<ee-4;ne+=4)me=this._decodeChar(V.charCodeAt(ne+0)),ve=this._decodeChar(V.charCodeAt(ne+1)),De=this._decodeChar(V.charCodeAt(ne+2)),Ye=this._decodeChar(V.charCodeAt(ne+3)),re[fe++]=me<<2|ve>>>4,re[fe++]=ve<<4|De>>>2,re[fe++]=De<<6|Ye,ce|=me&m,ce|=ve&m,ce|=De&m,ce|=Ye&m;if(ne<ee-1&&(me=this._decodeChar(V.charCodeAt(ne)),ve=this._decodeChar(V.charCodeAt(ne+1)),re[fe++]=me<<2|ve>>>4,ce|=me&m,ce|=ve&m),ne<ee-2&&(De=this._decodeChar(V.charCodeAt(ne+2)),re[fe++]=ve<<4|De>>>2,ce|=De&m),ne<ee-3&&(Ye=this._decodeChar(V.charCodeAt(ne+3)),re[fe++]=De<<6|Ye,ce|=Ye&m),ce!==0)throw new Error("Base64Coder: incorrect characters for decoding");return re},q.prototype._encodeByte=function(V){var J=V;return J+=65,J+=25-V>>>8&6,J+=51-V>>>8&-75,J+=61-V>>>8&-15,J+=62-V>>>8&3,String.fromCharCode(J)},q.prototype._decodeChar=function(V){var J=m;return J+=(42-V&V-44)>>>8&-m+V-43+62,J+=(46-V&V-48)>>>8&-m+V-47+63,J+=(47-V&V-58)>>>8&-m+V-48+52,J+=(64-V&V-91)>>>8&-m+V-65+0,J+=(96-V&V-123)>>>8&-m+V-97+26,J},q.prototype._getPaddingLength=function(V){var J=0;if(this._paddingCharacter){for(var ee=V.length-1;ee>=0&&V[ee]===this._paddingCharacter;ee--)J++;if(V.length<4||J>2)throw new Error("Base64Coder: incorrect padding")}return J},q})();i.Coder=a;var w=new a;function S(q){return w.encode(q)}i.encode=S;function M(q){return w.decode(q)}i.decode=M;var P=(function(q){d(V,q);function V(){return q!==null&&q.apply(this,arguments)||this}return V.prototype._encodeByte=function(J){var ee=J;return ee+=65,ee+=25-J>>>8&6,ee+=51-J>>>8&-75,ee+=61-J>>>8&-13,ee+=62-J>>>8&49,String.fromCharCode(ee)},V.prototype._decodeChar=function(J){var ee=m;return ee+=(44-J&J-46)>>>8&-m+J-45+62,ee+=(94-J&J-96)>>>8&-m+J-95+63,ee+=(47-J&J-58)>>>8&-m+J-48+52,ee+=(64-J&J-91)>>>8&-m+J-65+0,ee+=(96-J&J-123)>>>8&-m+J-97+26,ee},V})(a);i.URLSafeCoder=P;var N=new P;function $(q){return N.encode(q)}i.encodeURLSafe=$;function G(q){return N.decode(q)}i.decodeURLSafe=G,i.encodedLength=function(q){return w.encodedLength(q)},i.maxDecodedLength=function(q){return w.maxDecodedLength(q)},i.decodedLength=function(q){return w.decodedLength(q)}}),(function(n,i,c){Object.defineProperty(i,"__esModule",{value:!0});var d="utf8: invalid string",m="utf8: invalid source encoding";function a(M){for(var P=new Uint8Array(w(M)),N=0,$=0;$<M.length;$++){var G=M.charCodeAt($);G<128?P[N++]=G:G<2048?(P[N++]=192|G>>6,P[N++]=128|G&63):G<55296?(P[N++]=224|G>>12,P[N++]=128|G>>6&63,P[N++]=128|G&63):($++,G=(G&1023)<<10,G|=M.charCodeAt($)&1023,G+=65536,P[N++]=240|G>>18,P[N++]=128|G>>12&63,P[N++]=128|G>>6&63,P[N++]=128|G&63)}return P}i.encode=a;function w(M){for(var P=0,N=0;N<M.length;N++){var $=M.charCodeAt(N);if($<128)P+=1;else if($<2048)P+=2;else if($<55296)P+=3;else if($<=57343){if(N>=M.length-1)throw new Error(d);N++,P+=4}else throw new Error(d)}return P}i.encodedLength=w;function S(M){for(var P=[],N=0;N<M.length;N++){var $=M[N];if($&128){var G=void 0;if($<224){if(N>=M.length)throw new Error(m);var q=M[++N];if((q&192)!==128)throw new Error(m);$=($&31)<<6|q&63,G=128}else if($<240){if(N>=M.length-1)throw new Error(m);var q=M[++N],V=M[++N];if((q&192)!==128||(V&192)!==128)throw new Error(m);$=($&15)<<12|(q&63)<<6|V&63,G=2048}else if($<248){if(N>=M.length-2)throw new Error(m);var q=M[++N],V=M[++N],J=M[++N];if((q&192)!==128||(V&192)!==128||(J&192)!==128)throw new Error(m);$=($&15)<<18|(q&63)<<12|(V&63)<<6|J&63,G=65536}else throw new Error(m);if($<G||$>=55296&&$<=57343)throw new Error(m);if($>=65536){if($>1114111)throw new Error(m);$-=65536,P.push(String.fromCharCode(55296|$>>10)),$=56320|$&1023}}P.push(String.fromCharCode($))}return P.join("")}i.decode=S}),(function(n,i,c){n.exports=c(3).default}),(function(n,i,c){c.r(i);class d{constructor(ie,_e){this.lastId=0,this.prefix=ie,this.name=_e}create(ie){this.lastId++;var _e=this.lastId,Xe=this.prefix+_e,lt=this.name+"["+_e+"]",fn=!1,Qn=function(){fn||(ie.apply(null,arguments),fn=!0)};return this[_e]=Qn,{number:_e,id:Xe,name:lt,callback:Qn}}remove(ie){delete this[ie.number]}}var m=new d("_pusher_script_","Pusher.ScriptReceivers"),a={VERSION:"8.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},w=a;class S{constructor(ie){this.options=ie,this.receivers=ie.receivers||m,this.loading={}}load(ie,_e,Xe){var lt=this;if(lt.loading[ie]&&lt.loading[ie].length>0)lt.loading[ie].push(Xe);else{lt.loading[ie]=[Xe];var fn=di.createScriptRequest(lt.getPath(ie,_e)),Qn=lt.receivers.create(function(fr){if(lt.receivers.remove(Qn),lt.loading[ie]){var Vr=lt.loading[ie];delete lt.loading[ie];for(var Bi=function(za){za||fn.cleanup()},Zi=0;Zi<Vr.length;Zi++)Vr[Zi](fr,Bi)}});fn.send(Qn)}}getRoot(ie){var _e,Xe=di.getDocument().location.protocol;return ie&&ie.useTLS||Xe==="https:"?_e=this.options.cdn_https:_e=this.options.cdn_http,_e.replace(/\/*$/,"")+"/"+this.options.version}getPath(ie,_e){return this.getRoot(_e)+"/"+ie+this.options.suffix+".js"}}var M=new d("_pusher_dependencies","Pusher.DependenciesReceivers"),P=new S({cdn_http:w.cdn_http,cdn_https:w.cdn_https,version:w.VERSION,suffix:w.dependency_suffix,receivers:M});const N={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var G={buildLogSuffix:function(ge){const ie="See:",_e=N.urls[ge];if(!_e)return"";let Xe;return _e.fullUrl?Xe=_e.fullUrl:_e.path&&(Xe=N.baseUrl+_e.path),Xe?`${ie} ${Xe}`:""}},q;(function(ge){ge.UserAuthentication="user-authentication",ge.ChannelAuthorization="channel-authorization"})(q||(q={}));class V extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class J extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class ee extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class re extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class fe extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class ne extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class ce extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class me extends Error{constructor(ie){super(ie),Object.setPrototypeOf(this,new.target.prototype)}}class ve extends Error{constructor(ie,_e){super(_e),this.status=ie,Object.setPrototypeOf(this,new.target.prototype)}}var Ye=function(ge,ie,_e,Xe,lt){const fn=di.createXHR();fn.open("POST",_e.endpoint,!0),fn.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var Qn in _e.headers)fn.setRequestHeader(Qn,_e.headers[Qn]);if(_e.headersProvider!=null){let fr=_e.headersProvider();for(var Qn in fr)fn.setRequestHeader(Qn,fr[Qn])}return fn.onreadystatechange=function(){if(fn.readyState===4)if(fn.status===200){let fr,Vr=!1;try{fr=JSON.parse(fn.responseText),Vr=!0}catch{lt(new ve(200,`JSON returned from ${Xe.toString()} endpoint was invalid, yet status code was 200. Data was: ${fn.responseText}`),null)}Vr&&lt(null,fr)}else{let fr="";switch(Xe){case q.UserAuthentication:fr=G.buildLogSuffix("authenticationEndpoint");break;case q.ChannelAuthorization:fr=`Clients must be authorized to join private or presence channels. ${G.buildLogSuffix("authorizationEndpoint")}`;break}lt(new ve(fn.status,`Unable to retrieve auth string from ${Xe.toString()} endpoint - received status: ${fn.status} from ${_e.endpoint}. ${fr}`),null)}},fn.send(ie),fn};function ze(ge){return rt(ht(ge))}var tt=String.fromCharCode,at="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ct=function(ge){var ie=ge.charCodeAt(0);return ie<128?ge:ie<2048?tt(192|ie>>>6)+tt(128|ie&63):tt(224|ie>>>12&15)+tt(128|ie>>>6&63)+tt(128|ie&63)},ht=function(ge){return ge.replace(/[^\x00-\x7F]/g,ct)},Ie=function(ge){var ie=[0,2,1][ge.length%3],_e=ge.charCodeAt(0)<<16|(ge.length>1?ge.charCodeAt(1):0)<<8|(ge.length>2?ge.charCodeAt(2):0),Xe=[at.charAt(_e>>>18),at.charAt(_e>>>12&63),ie>=2?"=":at.charAt(_e>>>6&63),ie>=1?"=":at.charAt(_e&63)];return Xe.join("")},rt=window.btoa||function(ge){return ge.replace(/[\s\S]{1,3}/g,Ie)};class Qe{constructor(ie,_e,Xe,lt){this.clear=_e,this.timer=ie(()=>{this.timer&&(this.timer=lt(this.timer))},Xe)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var St=Qe;function qe(ge){window.clearTimeout(ge)}function vt(ge){window.clearInterval(ge)}class nt extends St{constructor(ie,_e){super(setTimeout,qe,ie,function(Xe){return _e(),null})}}class gt extends St{constructor(ie,_e){super(setInterval,vt,ie,function(Xe){return _e(),Xe})}}var Ut={now(){return Date.now?Date.now():new Date().valueOf()},defer(ge){return new nt(0,ge)},method(ge,...ie){var _e=Array.prototype.slice.call(arguments,1);return function(Xe){return Xe[ge].apply(Xe,_e.concat(arguments))}}},$t=Ut;function qt(ge,...ie){for(var _e=0;_e<ie.length;_e++){var Xe=ie[_e];for(var lt in Xe)Xe[lt]&&Xe[lt].constructor&&Xe[lt].constructor===Object?ge[lt]=qt(ge[lt]||{},Xe[lt]):ge[lt]=Xe[lt]}return ge}function Ht(){for(var ge=["Pusher"],ie=0;ie<arguments.length;ie++)typeof arguments[ie]=="string"?ge.push(arguments[ie]):ge.push($n(arguments[ie]));return ge.join(" : ")}function mn(ge,ie){var _e=Array.prototype.indexOf;if(ge===null)return-1;if(_e&&ge.indexOf===_e)return ge.indexOf(ie);for(var Xe=0,lt=ge.length;Xe<lt;Xe++)if(ge[Xe]===ie)return Xe;return-1}function en(ge,ie){for(var _e in ge)Object.prototype.hasOwnProperty.call(ge,_e)&&ie(ge[_e],_e,ge)}function En(ge){var ie=[];return en(ge,function(_e,Xe){ie.push(Xe)}),ie}function Xn(ge){var ie=[];return en(ge,function(_e){ie.push(_e)}),ie}function cn(ge,ie,_e){for(var Xe=0;Xe<ge.length;Xe++)ie.call(_e||window,ge[Xe],Xe,ge)}function Jr(ge,ie){for(var _e=[],Xe=0;Xe<ge.length;Xe++)_e.push(ie(ge[Xe],Xe,ge,_e));return _e}function mr(ge,ie){var _e={};return en(ge,function(Xe,lt){_e[lt]=ie(Xe)}),_e}function Cr(ge,ie){ie=ie||function(lt){return!!lt};for(var _e=[],Xe=0;Xe<ge.length;Xe++)ie(ge[Xe],Xe,ge,_e)&&_e.push(ge[Xe]);return _e}function li(ge,ie){var _e={};return en(ge,function(Xe,lt){(ie&&ie(Xe,lt,ge,_e)||Xe)&&(_e[lt]=Xe)}),_e}function hi(ge){var ie=[];return en(ge,function(_e,Xe){ie.push([Xe,_e])}),ie}function so(ge,ie){for(var _e=0;_e<ge.length;_e++)if(ie(ge[_e],_e,ge))return!0;return!1}function ra(ge,ie){for(var _e=0;_e<ge.length;_e++)if(!ie(ge[_e],_e,ge))return!1;return!0}function xt(ge){return mr(ge,function(ie){return typeof ie=="object"&&(ie=$n(ie)),encodeURIComponent(ze(ie.toString()))})}function Bt(ge){var ie=li(ge,function(Xe){return Xe!==void 0}),_e=Jr(hi(xt(ie)),$t.method("join","=")).join("&");return _e}function tn(ge){var ie=[],_e=[];return(function Xe(lt,fn){var Qn,fr,Vr;switch(typeof lt){case"object":if(!lt)return null;for(Qn=0;Qn<ie.length;Qn+=1)if(ie[Qn]===lt)return{$ref:_e[Qn]};if(ie.push(lt),_e.push(fn),Object.prototype.toString.apply(lt)==="[object Array]")for(Vr=[],Qn=0;Qn<lt.length;Qn+=1)Vr[Qn]=Xe(lt[Qn],fn+"["+Qn+"]");else{Vr={};for(fr in lt)Object.prototype.hasOwnProperty.call(lt,fr)&&(Vr[fr]=Xe(lt[fr],fn+"["+JSON.stringify(fr)+"]"))}return Vr;case"number":case"string":case"boolean":return lt}})(ge,"$")}function $n(ge){try{return JSON.stringify(ge)}catch{return JSON.stringify(tn(ge))}}class qn{constructor(){this.globalLog=ie=>{window.console&&window.console.log&&window.console.log(ie)}}debug(...ie){this.log(this.globalLog,ie)}warn(...ie){this.log(this.globalLogWarn,ie)}error(...ie){this.log(this.globalLogError,ie)}globalLogWarn(ie){window.console&&window.console.warn?window.console.warn(ie):this.globalLog(ie)}globalLogError(ie){window.console&&window.console.error?window.console.error(ie):this.globalLogWarn(ie)}log(ie,..._e){var Xe=Ht.apply(this,arguments);cs.log?cs.log(Xe):cs.logToConsole&&ie.bind(this)(Xe)}}var An=new qn,tr=function(ge,ie,_e,Xe,lt){(_e.headers!==void 0||_e.headersProvider!=null)&&An.warn(`To send headers with the ${Xe.toString()} request, you must use AJAX, rather than JSONP.`);var fn=ge.nextAuthCallbackID.toString();ge.nextAuthCallbackID++;var Qn=ge.getDocument(),fr=Qn.createElement("script");ge.auth_callbacks[fn]=function(Zi){lt(null,Zi)};var Vr="Pusher.auth_callbacks['"+fn+"']";fr.src=_e.endpoint+"?callback="+encodeURIComponent(Vr)+"&"+ie;var Bi=Qn.getElementsByTagName("head")[0]||Qn.documentElement;Bi.insertBefore(fr,Bi.firstChild)},Ir=tr;class mi{constructor(ie){this.src=ie}send(ie){var _e=this,Xe="Error loading "+_e.src;_e.script=document.createElement("script"),_e.script.id=ie.id,_e.script.src=_e.src,_e.script.type="text/javascript",_e.script.charset="UTF-8",_e.script.addEventListener?(_e.script.onerror=function(){ie.callback(Xe)},_e.script.onload=function(){ie.callback(null)}):_e.script.onreadystatechange=function(){(_e.script.readyState==="loaded"||_e.script.readyState==="complete")&&ie.callback(null)},_e.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(_e.errorScript=document.createElement("script"),_e.errorScript.id=ie.id+"_error",_e.errorScript.text=ie.name+"('"+Xe+"');",_e.script.async=_e.errorScript.async=!1):_e.script.async=!0;var lt=document.getElementsByTagName("head")[0];lt.insertBefore(_e.script,lt.firstChild),_e.errorScript&&lt.insertBefore(_e.errorScript,_e.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class Mi{constructor(ie,_e){this.url=ie,this.data=_e}send(ie){if(!this.request){var _e=Bt(this.data),Xe=this.url+"/"+ie.number+"?"+_e;this.request=di.createScriptRequest(Xe),this.request.send(ie)}}cleanup(){this.request&&this.request.cleanup()}}var _o=function(ge,ie){return function(_e,Xe){var lt="http"+(ie?"s":"")+"://",fn=lt+(ge.host||ge.options.host)+ge.options.path,Qn=di.createJSONPRequest(fn,_e),fr=di.ScriptReceivers.create(function(Vr,Bi){m.remove(fr),Qn.cleanup(),Bi&&Bi.host&&(ge.host=Bi.host),Xe&&Xe(Vr,Bi)});Qn.send(fr)}},oa={name:"jsonp",getAgent:_o},Ua=oa;function lo(ge,ie,_e){var Xe=ge+(ie.useTLS?"s":""),lt=ie.useTLS?ie.hostTLS:ie.hostNonTLS;return Xe+"://"+lt+_e}function eo(ge,ie){var _e="/app/"+ge,Xe="?protocol="+w.PROTOCOL+"&client=js&version="+w.VERSION+(ie?"&"+ie:"");return _e+Xe}var co={getInitial:function(ge,ie){var _e=(ie.httpPath||"")+eo(ge,"flash=false");return lo("ws",ie,_e)}},vo={getInitial:function(ge,ie){var _e=(ie.httpPath||"/pusher")+eo(ge);return lo("http",ie,_e)}},ss={getInitial:function(ge,ie){return lo("http",ie,ie.httpPath||"/pusher")},getPath:function(ge,ie){return eo(ge)}};class ir{constructor(){this._callbacks={}}get(ie){return this._callbacks[xi(ie)]}add(ie,_e,Xe){var lt=xi(ie);this._callbacks[lt]=this._callbacks[lt]||[],this._callbacks[lt].push({fn:_e,context:Xe})}remove(ie,_e,Xe){if(!ie&&!_e&&!Xe){this._callbacks={};return}var lt=ie?[xi(ie)]:En(this._callbacks);_e||Xe?this.removeCallback(lt,_e,Xe):this.removeAllCallbacks(lt)}removeCallback(ie,_e,Xe){cn(ie,function(lt){this._callbacks[lt]=Cr(this._callbacks[lt]||[],function(fn){return _e&&_e!==fn.fn||Xe&&Xe!==fn.context}),this._callbacks[lt].length===0&&delete this._callbacks[lt]},this)}removeAllCallbacks(ie){cn(ie,function(_e){delete this._callbacks[_e]},this)}}function xi(ge){return"_"+ge}class ci{constructor(ie){this.callbacks=new ir,this.global_callbacks=[],this.failThrough=ie}bind(ie,_e,Xe){return this.callbacks.add(ie,_e,Xe),this}bind_global(ie){return this.global_callbacks.push(ie),this}unbind(ie,_e,Xe){return this.callbacks.remove(ie,_e,Xe),this}unbind_global(ie){return ie?(this.global_callbacks=Cr(this.global_callbacks||[],_e=>_e!==ie),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(ie,_e,Xe){for(var lt=0;lt<this.global_callbacks.length;lt++)this.global_callbacks[lt](ie,_e);var fn=this.callbacks.get(ie),Qn=[];if(Xe?Qn.push(_e,Xe):_e&&Qn.push(_e),fn&&fn.length>0)for(var lt=0;lt<fn.length;lt++)fn[lt].fn.apply(fn[lt].context||window,Qn);else this.failThrough&&this.failThrough(ie,_e);return this}}class Ra extends ci{constructor(ie,_e,Xe,lt,fn){super(),this.initialize=di.transportConnectionInitializer,this.hooks=ie,this.name=_e,this.priority=Xe,this.key=lt,this.options=fn,this.state="new",this.timeline=fn.timeline,this.activityTimeout=fn.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var ie=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(ie,this.options)}catch(_e){return $t.defer(()=>{this.onError(_e),this.changeState("closed")}),!1}return this.bindListeners(),An.debug("Connecting",{transport:this.name,url:ie}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(ie){return this.state==="open"?($t.defer(()=>{this.socket&&this.socket.send(ie)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(ie){this.emit("error",{type:"WebSocketError",error:ie}),this.timeline.error(this.buildTimelineMessage({error:ie.toString()}))}onClose(ie){ie?this.changeState("closed",{code:ie.code,reason:ie.reason,wasClean:ie.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(ie){this.emit("message",ie)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=ie=>{this.onError(ie)},this.socket.onclose=ie=>{this.onClose(ie)},this.socket.onmessage=ie=>{this.onMessage(ie)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(ie,_e){this.state=ie,this.timeline.info(this.buildTimelineMessage({state:ie,params:_e})),this.emit(ie,_e)}buildTimelineMessage(ie){return qt({cid:this.id},ie)}}class ya{constructor(ie){this.hooks=ie}isSupported(ie){return this.hooks.isSupported(ie)}createConnection(ie,_e,Xe,lt){return new Ra(this.hooks,ie,_e,Xe,lt)}}var Tl=new ya({urls:co,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!di.getWebSocketAPI()},isSupported:function(){return!!di.getWebSocketAPI()},getSocket:function(ge){return di.createWebSocket(ge)}}),dr={urls:vo,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},kt=qt({getSocket:function(ge){return di.HTTPFactory.createStreamingSocket(ge)}},dr),Dr=qt({getSocket:function(ge){return di.HTTPFactory.createPollingSocket(ge)}},dr),to={isSupported:function(){return di.isXHRSupported()}},Hs=new ya(qt({},kt,to)),hr=new ya(qt({},Dr,to)),ot={ws:Tl,xhr_streaming:Hs,xhr_polling:hr},he=ot,ye=new ya({file:"sockjs",urls:ss,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(ge,ie){return new window.SockJS(ge,null,{js_path:P.getPath("sockjs",{useTLS:ie.useTLS}),ignore_null_origin:ie.ignoreNullOrigin})},beforeOpen:function(ge,ie){ge.send(JSON.stringify({path:ie}))}}),Ae={isSupported:function(ge){var ie=di.isXDRSupported(ge.useTLS);return ie}},He=new ya(qt({},kt,Ae)),Pe=new ya(qt({},Dr,Ae));he.xdr_streaming=He,he.xdr_polling=Pe,he.sockjs=ye;var Ke=he;class wt extends ci{constructor(){super();var ie=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){ie.emit("online")},!1),window.addEventListener("offline",function(){ie.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var et=new wt;class yt{constructor(ie,_e,Xe){this.manager=ie,this.transport=_e,this.minPingDelay=Xe.minPingDelay,this.maxPingDelay=Xe.maxPingDelay,this.pingDelay=void 0}createConnection(ie,_e,Xe,lt){lt=qt({},lt,{activityTimeout:this.pingDelay});var fn=this.transport.createConnection(ie,_e,Xe,lt),Qn=null,fr=function(){fn.unbind("open",fr),fn.bind("closed",Vr),Qn=$t.now()},Vr=Bi=>{if(fn.unbind("closed",Vr),Bi.code===1002||Bi.code===1003)this.manager.reportDeath();else if(!Bi.wasClean&&Qn){var Zi=$t.now()-Qn;Zi<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(Zi/2,this.minPingDelay))}};return fn.bind("open",fr),fn}isSupported(ie){return this.manager.isAlive()&&this.transport.isSupported(ie)}}const Zt={decodeMessage:function(ge){try{var ie=JSON.parse(ge.data),_e=ie.data;if(typeof _e=="string")try{_e=JSON.parse(ie.data)}catch{}var Xe={event:ie.event,channel:ie.channel,data:_e};return ie.user_id&&(Xe.user_id=ie.user_id),Xe}catch(lt){throw{type:"MessageParseError",error:lt,data:ge.data}}},encodeMessage:function(ge){return JSON.stringify(ge)},processHandshake:function(ge){var ie=Zt.decodeMessage(ge);if(ie.event==="pusher:connection_established"){if(!ie.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:ie.data.socket_id,activityTimeout:ie.data.activity_timeout*1e3}}else{if(ie.event==="pusher:error")return{action:this.getCloseAction(ie.data),error:this.getCloseError(ie.data)};throw"Invalid handshake"}},getCloseAction:function(ge){return ge.code<4e3?ge.code>=1002&&ge.code<=1004?"backoff":null:ge.code===4e3?"tls_only":ge.code<4100?"refused":ge.code<4200?"backoff":ge.code<4300?"retry":"refused"},getCloseError:function(ge){return ge.code!==1e3&&ge.code!==1001?{type:"PusherError",data:{code:ge.code,message:ge.reason||ge.message}}:null}};var zt=Zt;class Fn extends ci{constructor(ie,_e){super(),this.id=ie,this.transport=_e,this.activityTimeout=_e.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(ie){return this.transport.send(ie)}send_event(ie,_e,Xe){var lt={event:ie,data:_e};return Xe&&(lt.channel=Xe),An.debug("Event sent",lt),this.send(zt.encodeMessage(lt))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var ie={message:Xe=>{var lt;try{lt=zt.decodeMessage(Xe)}catch(fn){this.emit("error",{type:"MessageParseError",error:fn,data:Xe.data})}if(lt!==void 0){switch(An.debug("Event recd",lt),lt.event){case"pusher:error":this.emit("error",{type:"PusherError",data:lt.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",lt)}},activity:()=>{this.emit("activity")},error:Xe=>{this.emit("error",Xe)},closed:Xe=>{_e(),Xe&&Xe.code&&this.handleCloseEvent(Xe),this.transport=null,this.emit("closed")}},_e=()=>{en(ie,(Xe,lt)=>{this.transport.unbind(lt,Xe)})};en(ie,(Xe,lt)=>{this.transport.bind(lt,Xe)})}handleCloseEvent(ie){var _e=zt.getCloseAction(ie),Xe=zt.getCloseError(ie);Xe&&this.emit("error",Xe),_e&&this.emit(_e,{action:_e,error:Xe})}}class Yn{constructor(ie,_e){this.transport=ie,this.callback=_e,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=ie=>{this.unbindListeners();var _e;try{_e=zt.processHandshake(ie)}catch(Xe){this.finish("error",{error:Xe}),this.transport.close();return}_e.action==="connected"?this.finish("connected",{connection:new Fn(_e.id,this.transport),activityTimeout:_e.activityTimeout}):(this.finish(_e.action,{error:_e.error}),this.transport.close())},this.onClosed=ie=>{this.unbindListeners();var _e=zt.getCloseAction(ie)||"backoff",Xe=zt.getCloseError(ie);this.finish(_e,{error:Xe})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(ie,_e){this.callback(qt({transport:this.transport,action:ie},_e))}}class Hn{constructor(ie,_e){this.timeline=ie,this.options=_e||{}}send(ie,_e){this.timeline.isEmpty()||this.timeline.send(di.TimelineTransport.getAgent(this,ie),_e)}}class Mr extends ci{constructor(ie,_e){super(function(Xe,lt){An.debug("No callbacks on "+ie+" for "+Xe)}),this.name=ie,this.pusher=_e,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(ie,_e){return _e(null,{auth:""})}trigger(ie,_e){if(ie.indexOf("client-")!==0)throw new V("Event '"+ie+"' does not start with 'client-'");if(!this.subscribed){var Xe=G.buildLogSuffix("triggeringClientEvents");An.warn(`Client event triggered before channel 'subscription_succeeded' event . ${Xe}`)}return this.pusher.send_event(ie,_e,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(ie){var _e=ie.event,Xe=ie.data;if(_e==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(ie);else if(_e==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(ie);else if(_e.indexOf("pusher_internal:")!==0){var lt={};this.emit(_e,Xe,lt)}}handleSubscriptionSucceededEvent(ie){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",ie.data)}handleSubscriptionCountEvent(ie){ie.data.subscription_count&&(this.subscriptionCount=ie.data.subscription_count),this.emit("pusher:subscription_count",ie.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(ie,_e)=>{ie?(this.subscriptionPending=!1,An.error(ie.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:ie.message},ie instanceof ve?{status:ie.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:_e.auth,channel_data:_e.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class gr extends Mr{authorize(ie,_e){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:ie},_e)}}class Sr{constructor(){this.reset()}get(ie){return Object.prototype.hasOwnProperty.call(this.members,ie)?{id:ie,info:this.members[ie]}:null}each(ie){en(this.members,(_e,Xe)=>{ie(this.get(Xe))})}setMyID(ie){this.myID=ie}onSubscription(ie){this.members=ie.presence.hash,this.count=ie.presence.count,this.me=this.get(this.myID)}addMember(ie){return this.get(ie.user_id)===null&&this.count++,this.members[ie.user_id]=ie.user_info,this.get(ie.user_id)}removeMember(ie){var _e=this.get(ie.user_id);return _e&&(delete this.members[ie.user_id],this.count--),_e}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var gi=function(ge,ie,_e,Xe){function lt(fn){return fn instanceof _e?fn:new _e(function(Qn){Qn(fn)})}return new(_e||(_e=Promise))(function(fn,Qn){function fr(Zi){try{Bi(Xe.next(Zi))}catch(za){Qn(za)}}function Vr(Zi){try{Bi(Xe.throw(Zi))}catch(za){Qn(za)}}function Bi(Zi){Zi.done?fn(Zi.value):lt(Zi.value).then(fr,Vr)}Bi((Xe=Xe.apply(ge,ie||[])).next())})};class jr extends gr{constructor(ie,_e){super(ie,_e),this.members=new Sr}authorize(ie,_e){super.authorize(ie,(Xe,lt)=>gi(this,void 0,void 0,function*(){if(!Xe)if(lt=lt,lt.channel_data!=null){var fn=JSON.parse(lt.channel_data);this.members.setMyID(fn.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let Qn=G.buildLogSuffix("authorizationEndpoint");An.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${Qn}, or the user should be signed in.`),_e("Invalid auth response");return}_e(Xe,lt)}))}handleEvent(ie){var _e=ie.event;if(_e.indexOf("pusher_internal:")===0)this.handleInternalEvent(ie);else{var Xe=ie.data,lt={};ie.user_id&&(lt.user_id=ie.user_id),this.emit(_e,Xe,lt)}}handleInternalEvent(ie){var _e=ie.event,Xe=ie.data;switch(_e){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(ie);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(ie);break;case"pusher_internal:member_added":var lt=this.members.addMember(Xe);this.emit("pusher:member_added",lt);break;case"pusher_internal:member_removed":var fn=this.members.removeMember(Xe);fn&&this.emit("pusher:member_removed",fn);break}}handleSubscriptionSucceededEvent(ie){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(ie.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var da=c(1),Ia=c(0);class $a extends gr{constructor(ie,_e,Xe){super(ie,_e),this.key=null,this.nacl=Xe}authorize(ie,_e){super.authorize(ie,(Xe,lt)=>{if(Xe){_e(Xe,lt);return}let fn=lt.shared_secret;if(!fn){_e(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(Ia.decode)(fn),delete lt.shared_secret,_e(null,lt)})}trigger(ie,_e){throw new ne("Client events are not currently supported for encrypted channels")}handleEvent(ie){var _e=ie.event,Xe=ie.data;if(_e.indexOf("pusher_internal:")===0||_e.indexOf("pusher:")===0){super.handleEvent(ie);return}this.handleEncryptedEvent(_e,Xe)}handleEncryptedEvent(ie,_e){if(!this.key){An.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!_e.ciphertext||!_e.nonce){An.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+_e);return}let Xe=Object(Ia.decode)(_e.ciphertext);if(Xe.length<this.nacl.secretbox.overheadLength){An.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${Xe.length}`);return}let lt=Object(Ia.decode)(_e.nonce);if(lt.length<this.nacl.secretbox.nonceLength){An.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${lt.length}`);return}let fn=this.nacl.secretbox.open(Xe,lt,this.key);if(fn===null){An.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(Qn,fr)=>{if(Qn){An.error(`Failed to make a request to the authEndpoint: ${fr}. Unable to fetch new key, so dropping encrypted event`);return}if(fn=this.nacl.secretbox.open(Xe,lt,this.key),fn===null){An.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(ie,this.getDataToEmit(fn))});return}this.emit(ie,this.getDataToEmit(fn))}getDataToEmit(ie){let _e=Object(da.decode)(ie);try{return JSON.parse(_e)}catch{return _e}}}class yi extends ci{constructor(ie,_e){super(),this.state="initialized",this.connection=null,this.key=ie,this.options=_e,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var Xe=di.getNetwork();Xe.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),Xe.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(ie){return this.connection?this.connection.send(ie):!1}send_event(ie,_e,Xe){return this.connection?this.connection.send_event(ie,_e,Xe):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var ie=(_e,Xe)=>{_e?this.runner=this.strategy.connect(0,ie):Xe.action==="error"?(this.emit("error",{type:"HandshakeError",error:Xe.error}),this.timeline.error({handshakeError:Xe.error})):(this.abortConnecting(),this.handshakeCallbacks[Xe.action](Xe))};this.runner=this.strategy.connect(0,ie)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var ie=this.abandonConnection();ie.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(ie){this.timeline.info({action:"retry",delay:ie}),ie>0&&this.emit("connecting_in",Math.round(ie/1e3)),this.retryTimer=new nt(ie||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new nt(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new nt(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new nt(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(ie){return qt({},ie,{message:_e=>{this.resetActivityCheck(),this.emit("message",_e)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:_e=>{this.emit("error",_e)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(ie){return qt({},ie,{connected:_e=>{this.activityTimeout=Math.min(this.options.activityTimeout,_e.activityTimeout,_e.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(_e.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let ie=_e=>Xe=>{Xe.error&&this.emit("error",{type:"WebSocketError",error:Xe.error}),_e(Xe)};return{tls_only:ie(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:ie(()=>{this.disconnect()}),backoff:ie(()=>{this.retryIn(1e3)}),retry:ie(()=>{this.retryIn(0)})}}setConnection(ie){this.connection=ie;for(var _e in this.connectionCallbacks)this.connection.bind(_e,this.connectionCallbacks[_e]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var ie in this.connectionCallbacks)this.connection.unbind(ie,this.connectionCallbacks[ie]);var _e=this.connection;return this.connection=null,_e}}updateState(ie,_e){var Xe=this.state;if(this.state=ie,Xe!==ie){var lt=ie;lt==="connected"&&(lt+=" with new socket ID "+_e.socket_id),An.debug("State changed",Xe+" -> "+lt),this.timeline.info({state:ie,params:_e}),this.emit("state_change",{previous:Xe,current:ie}),this.emit(ie,_e)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class Qr{constructor(){this.channels={}}add(ie,_e){return this.channels[ie]||(this.channels[ie]=Ri(ie,_e)),this.channels[ie]}all(){return Xn(this.channels)}find(ie){return this.channels[ie]}remove(ie){var _e=this.channels[ie];return delete this.channels[ie],_e}disconnect(){en(this.channels,function(ie){ie.disconnect()})}}function Ri(ge,ie){if(ge.indexOf("private-encrypted-")===0){if(ie.config.nacl)return bi.createEncryptedChannel(ge,ie,ie.config.nacl);let _e="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",Xe=G.buildLogSuffix("encryptedChannelSupport");throw new ne(`${_e}. ${Xe}`)}else{if(ge.indexOf("private-")===0)return bi.createPrivateChannel(ge,ie);if(ge.indexOf("presence-")===0)return bi.createPresenceChannel(ge,ie);if(ge.indexOf("#")===0)throw new J('Cannot create a channel with name "'+ge+'".');return bi.createChannel(ge,ie)}}var Gi={createChannels(){return new Qr},createConnectionManager(ge,ie){return new yi(ge,ie)},createChannel(ge,ie){return new Mr(ge,ie)},createPrivateChannel(ge,ie){return new gr(ge,ie)},createPresenceChannel(ge,ie){return new jr(ge,ie)},createEncryptedChannel(ge,ie,_e){return new $a(ge,ie,_e)},createTimelineSender(ge,ie){return new Hn(ge,ie)},createHandshake(ge,ie){return new Yn(ge,ie)},createAssistantToTheTransportManager(ge,ie,_e){return new yt(ge,ie,_e)}},bi=Gi;class Da{constructor(ie){this.options=ie||{},this.livesLeft=this.options.lives||1/0}getAssistant(ie){return bi.createAssistantToTheTransportManager(this,ie,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class Xa{constructor(ie,_e){this.strategies=ie,this.loop=!!_e.loop,this.failFast=!!_e.failFast,this.timeout=_e.timeout,this.timeoutLimit=_e.timeoutLimit}isSupported(){return so(this.strategies,$t.method("isSupported"))}connect(ie,_e){var Xe=this.strategies,lt=0,fn=this.timeout,Qn=null,fr=(Vr,Bi)=>{Bi?_e(null,Bi):(lt=lt+1,this.loop&&(lt=lt%Xe.length),lt<Xe.length?(fn&&(fn=fn*2,this.timeoutLimit&&(fn=Math.min(fn,this.timeoutLimit))),Qn=this.tryStrategy(Xe[lt],ie,{timeout:fn,failFast:this.failFast},fr)):_e(!0))};return Qn=this.tryStrategy(Xe[lt],ie,{timeout:fn,failFast:this.failFast},fr),{abort:function(){Qn.abort()},forceMinPriority:function(Vr){ie=Vr,Qn&&Qn.forceMinPriority(Vr)}}}tryStrategy(ie,_e,Xe,lt){var fn=null,Qn=null;return Xe.timeout>0&&(fn=new nt(Xe.timeout,function(){Qn.abort(),lt(!0)})),Qn=ie.connect(_e,function(fr,Vr){fr&&fn&&fn.isRunning()&&!Xe.failFast||(fn&&fn.ensureAborted(),lt(fr,Vr))}),{abort:function(){fn&&fn.ensureAborted(),Qn.abort()},forceMinPriority:function(fr){Qn.forceMinPriority(fr)}}}}class uo{constructor(ie){this.strategies=ie}isSupported(){return so(this.strategies,$t.method("isSupported"))}connect(ie,_e){return td(this.strategies,ie,function(Xe,lt){return function(fn,Qn){if(lt[Xe].error=fn,fn){xo(lt)&&_e(!0);return}cn(lt,function(fr){fr.forceMinPriority(Qn.transport.priority)}),_e(null,Qn)}})}}function td(ge,ie,_e){var Xe=Jr(ge,function(lt,fn,Qn,fr){return lt.connect(ie,_e(fn,fr))});return{abort:function(){cn(Xe,Ro)},forceMinPriority:function(lt){cn(Xe,function(fn){fn.forceMinPriority(lt)})}}}function xo(ge){return ra(ge,function(ie){return!!ie.error})}function Ro(ge){!ge.error&&!ge.aborted&&(ge.abort(),ge.aborted=!0)}class nd{constructor(ie,_e,Xe){this.strategy=ie,this.transports=_e,this.ttl=Xe.ttl||1800*1e3,this.usingTLS=Xe.useTLS,this.timeline=Xe.timeline}isSupported(){return this.strategy.isSupported()}connect(ie,_e){var Xe=this.usingTLS,lt=Lc(Xe),fn=lt&&lt.cacheSkipCount?lt.cacheSkipCount:0,Qn=[this.strategy];if(lt&&lt.timestamp+this.ttl>=$t.now()){var fr=this.transports[lt.transport];fr&&(["ws","wss"].includes(lt.transport)||fn>3?(this.timeline.info({cached:!0,transport:lt.transport,latency:lt.latency}),Qn.push(new Xa([fr],{timeout:lt.latency*2+1e3,failFast:!0}))):fn++)}var Vr=$t.now(),Bi=Qn.pop().connect(ie,function Zi(za,Uc){za?(Nc(Xe),Qn.length>0?(Vr=$t.now(),Bi=Qn.pop().connect(ie,Zi)):_e(za)):(rd(Xe,Uc.transport.name,$t.now()-Vr,fn),_e(null,Uc))});return{abort:function(){Bi.abort()},forceMinPriority:function(Zi){ie=Zi,Bi&&Bi.forceMinPriority(Zi)}}}}function fu(ge){return"pusherTransport"+(ge?"TLS":"NonTLS")}function Lc(ge){var ie=di.getLocalStorage();if(ie)try{var _e=ie[fu(ge)];if(_e)return JSON.parse(_e)}catch{Nc(ge)}return null}function rd(ge,ie,_e,Xe){var lt=di.getLocalStorage();if(lt)try{lt[fu(ge)]=$n({timestamp:$t.now(),transport:ie,latency:_e,cacheSkipCount:Xe})}catch{}}function Nc(ge){var ie=di.getLocalStorage();if(ie)try{delete ie[fu(ge)]}catch{}}class jl{constructor(ie,{delay:_e}){this.strategy=ie,this.options={delay:_e}}isSupported(){return this.strategy.isSupported()}connect(ie,_e){var Xe=this.strategy,lt,fn=new nt(this.options.delay,function(){lt=Xe.connect(ie,_e)});return{abort:function(){fn.ensureAborted(),lt&&lt.abort()},forceMinPriority:function(Qn){ie=Qn,lt&&lt.forceMinPriority(Qn)}}}}class bo{constructor(ie,_e,Xe){this.test=ie,this.trueBranch=_e,this.falseBranch=Xe}isSupported(){var ie=this.test()?this.trueBranch:this.falseBranch;return ie.isSupported()}connect(ie,_e){var Xe=this.test()?this.trueBranch:this.falseBranch;return Xe.connect(ie,_e)}}class sh{constructor(ie){this.strategy=ie}isSupported(){return this.strategy.isSupported()}connect(ie,_e){var Xe=this.strategy.connect(ie,function(lt,fn){fn&&Xe.abort(),_e(lt,fn)});return Xe}}function ls(ge){return function(){return ge.isSupported()}}var ms=function(ge,ie,_e){var Xe={};function lt(ql,of,Ps,Jo,mh){var no=_e(ge,ql,of,Ps,Jo,mh);return Xe[ql]=no,no}var fn=Object.assign({},ie,{hostNonTLS:ge.wsHost+":"+ge.wsPort,hostTLS:ge.wsHost+":"+ge.wssPort,httpPath:ge.wsPath}),Qn=Object.assign({},fn,{useTLS:!0}),fr=Object.assign({},ie,{hostNonTLS:ge.httpHost+":"+ge.httpPort,hostTLS:ge.httpHost+":"+ge.httpsPort,httpPath:ge.httpPath}),Vr={loop:!0,timeout:15e3,timeoutLimit:6e4},Bi=new Da({minPingDelay:1e4,maxPingDelay:ge.activityTimeout}),Zi=new Da({lives:2,minPingDelay:1e4,maxPingDelay:ge.activityTimeout}),za=lt("ws","ws",3,fn,Bi),Uc=lt("wss","ws",3,Qn,Bi),Ko=lt("sockjs","sockjs",1,fr),Ml=lt("xhr_streaming","xhr_streaming",1,fr,Zi),wo=lt("xdr_streaming","xdr_streaming",1,fr,Zi),$c=lt("xhr_polling","xhr_polling",1,fr),yr=lt("xdr_polling","xdr_polling",1,fr),Tn=new Xa([za],Vr),Ws=new Xa([Uc],Vr),er=new Xa([Ko],Vr),fa=new Xa([new bo(ls(Ml),Ml,wo)],Vr),$l=new Xa([new bo(ls($c),$c,yr)],Vr),Wn=new Xa([new bo(ls(fa),new uo([fa,new jl($l,{delay:4e3})]),$l)],Vr),Pl=new bo(ls(Wn),Wn,er),yc;return ie.useTLS?yc=new uo([Tn,new jl(Pl,{delay:2e3})]):yc=new uo([Tn,new jl(Ws,{delay:2e3}),new jl(Pl,{delay:5e3})]),new nd(new sh(new bo(ls(za),yc,Pl)),Xe,{ttl:18e5,timeline:ie.timeline,useTLS:ie.useTLS})},Xo=ms,Bl=(function(){var ge=this;ge.timeline.info(ge.buildTimelineMessage({transport:ge.name+(ge.options.useTLS?"s":"")})),ge.hooks.isInitialized()?ge.changeState("initialized"):ge.hooks.file?(ge.changeState("initializing"),P.load(ge.hooks.file,{useTLS:ge.options.useTLS},function(ie,_e){ge.hooks.isInitialized()?(ge.changeState("initialized"),_e(!0)):(ie&&ge.onError(ie),ge.onClose(),_e(!1))})):ge.onClose()}),cl={getRequest:function(ge){var ie=new window.XDomainRequest;return ie.ontimeout=function(){ge.emit("error",new ee),ge.close()},ie.onerror=function(_e){ge.emit("error",_e),ge.close()},ie.onprogress=function(){ie.responseText&&ie.responseText.length>0&&ge.onChunk(200,ie.responseText)},ie.onload=function(){ie.responseText&&ie.responseText.length>0&&ge.onChunk(200,ie.responseText),ge.emit("finished",200),ge.close()},ie},abortRequest:function(ge){ge.ontimeout=ge.onerror=ge.onprogress=ge.onload=null,ge.abort()}},Cs=cl;const id=256*1024;class El extends ci{constructor(ie,_e,Xe){super(),this.hooks=ie,this.method=_e,this.url=Xe}start(ie){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},di.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(ie)}close(){this.unloader&&(di.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(ie,_e){for(;;){var Xe=this.advanceBuffer(_e);if(Xe)this.emit("chunk",{status:ie,data:Xe});else break}this.isBufferTooLong(_e)&&this.emit("buffer_too_long")}advanceBuffer(ie){var _e=ie.slice(this.position),Xe=_e.indexOf(`
`);return Xe!==-1?(this.position+=Xe+1,_e.slice(0,Xe)):null}isBufferTooLong(ie){return this.position===ie.length&&ie.length>id}}var zc;(function(ge){ge[ge.CONNECTING=0]="CONNECTING",ge[ge.OPEN=1]="OPEN",ge[ge.CLOSED=3]="CLOSED"})(zc||(zc={}));var gs=zc,lh=1;class Sp{constructor(ie,_e){this.hooks=ie,this.session=ul(1e3)+"/"+Tp(8),this.location=ch(_e),this.readyState=gs.CONNECTING,this.openStream()}send(ie){return this.sendRaw(JSON.stringify([ie]))}ping(){this.hooks.sendHeartbeat(this)}close(ie,_e){this.onClose(ie,_e,!0)}sendRaw(ie){if(this.readyState===gs.OPEN)try{return di.createSocketRequest("POST",Fl(Zo(this.location,this.session))).start(ie),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(ie,_e,Xe){this.closeStream(),this.readyState=gs.CLOSED,this.onclose&&this.onclose({code:ie,reason:_e,wasClean:Xe})}onChunk(ie){if(ie.status===200){this.readyState===gs.OPEN&&this.onActivity();var _e,Xe=ie.data.slice(0,1);switch(Xe){case"o":_e=JSON.parse(ie.data.slice(1)||"{}"),this.onOpen(_e);break;case"a":_e=JSON.parse(ie.data.slice(1)||"[]");for(var lt=0;lt<_e.length;lt++)this.onEvent(_e[lt]);break;case"m":_e=JSON.parse(ie.data.slice(1)||"null"),this.onEvent(_e);break;case"h":this.hooks.onHeartbeat(this);break;case"c":_e=JSON.parse(ie.data.slice(1)||"[]"),this.onClose(_e[0],_e[1],!0);break}}}onOpen(ie){this.readyState===gs.CONNECTING?(ie&&ie.hostname&&(this.location.base=Vl(this.location.base,ie.hostname)),this.readyState=gs.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(ie){this.readyState===gs.OPEN&&this.onmessage&&this.onmessage({data:ie})}onActivity(){this.onactivity&&this.onactivity()}onError(ie){this.onerror&&this.onerror(ie)}openStream(){this.stream=di.createSocketRequest("POST",Fl(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",ie=>{this.onChunk(ie)}),this.stream.bind("finished",ie=>{this.hooks.onFinished(this,ie)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(ie){$t.defer(()=>{this.onError(ie),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function ch(ge){var ie=/([^\?]*)\/*(\??.*)/.exec(ge);return{base:ie[1],queryString:ie[2]}}function Zo(ge,ie){return ge.base+"/"+ie+"/xhr_send"}function Fl(ge){var ie=ge.indexOf("?")===-1?"?":"&";return ge+ie+"t="+ +new Date+"&n="+lh++}function Vl(ge,ie){var _e=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(ge);return _e[1]+ie+_e[3]}function ul(ge){return di.randomInt(ge)}function Tp(ge){for(var ie=[],_e=0;_e<ge;_e++)ie.push(ul(32).toString(32));return ie.join("")}var af=Sp,uh={getReceiveURL:function(ge,ie){return ge.base+"/"+ie+"/xhr_streaming"+ge.queryString},onHeartbeat:function(ge){ge.sendRaw("[]")},sendHeartbeat:function(ge){ge.sendRaw("[]")},onFinished:function(ge,ie){ge.onClose(1006,"Connection interrupted ("+ie+")",!1)}},Fr=uh,hl={getReceiveURL:function(ge,ie){return ge.base+"/"+ie+"/xhr"+ge.queryString},onHeartbeat:function(){},sendHeartbeat:function(ge){ge.sendRaw("[]")},onFinished:function(ge,ie){ie===200?ge.reconnect():ge.onClose(1006,"Connection interrupted ("+ie+")",!1)}},jc=hl,pc={getRequest:function(ge){var ie=di.getXHRAPI(),_e=new ie;return _e.onreadystatechange=_e.onprogress=function(){switch(_e.readyState){case 3:_e.responseText&&_e.responseText.length>0&&ge.onChunk(_e.status,_e.responseText);break;case 4:_e.responseText&&_e.responseText.length>0&&ge.onChunk(_e.status,_e.responseText),ge.emit("finished",_e.status),ge.close();break}},_e},abortRequest:function(ge){ge.onreadystatechange=null,ge.abort()}},Bc=pc,pu={createStreamingSocket(ge){return this.createSocket(Fr,ge)},createPollingSocket(ge){return this.createSocket(jc,ge)},createSocket(ge,ie){return new af(ge,ie)},createXHR(ge,ie){return this.createRequest(Bc,ge,ie)},createRequest(ge,ie,_e){return new El(ge,ie,_e)}},Al=pu;Al.createXDR=function(ge,ie){return this.createRequest(Cs,ge,ie)};var mc=Al,Fc={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:m,DependenciesReceivers:M,getDefaultStrategy:Xo,Transports:Ke,transportConnectionInitializer:Bl,HTTPFactory:mc,TimelineTransport:Ua,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(ge){window.Pusher=ge;var ie=()=>{this.onDocumentBody(ge.ready)};window.JSON?ie():P.load("json2",{},ie)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:Ye,jsonp:Ir}},onDocumentBody(ge){document.body?ge():setTimeout(()=>{this.onDocumentBody(ge)},0)},createJSONPRequest(ge,ie){return new Mi(ge,ie)},createScriptRequest(ge){return new mi(ge)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var ge=this.getXHRAPI();return new ge},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return et},createWebSocket(ge){var ie=this.getWebSocketAPI();return new ie(ge)},createSocketRequest(ge,ie){if(this.isXHRSupported())return this.HTTPFactory.createXHR(ge,ie);if(this.isXDRSupported(ie.indexOf("https:")===0))return this.HTTPFactory.createXDR(ge,ie);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var ge=this.getXHRAPI();return!!ge&&new ge().withCredentials!==void 0},isXDRSupported(ge){var ie=ge?"https:":"http:",_e=this.getProtocol();return!!window.XDomainRequest&&_e===ie},addUnloadListener(ge){window.addEventListener!==void 0?window.addEventListener("unload",ge,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",ge)},removeUnloadListener(ge){window.addEventListener!==void 0?window.removeEventListener("unload",ge,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",ge)},randomInt(ge){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*ge)}},di=Fc,mu;(function(ge){ge[ge.ERROR=3]="ERROR",ge[ge.INFO=6]="INFO",ge[ge.DEBUG=7]="DEBUG"})(mu||(mu={}));var jo=mu;class dl{constructor(ie,_e,Xe){this.key=ie,this.session=_e,this.events=[],this.options=Xe||{},this.sent=0,this.uniqueID=0}log(ie,_e){ie<=this.options.level&&(this.events.push(qt({},_e,{timestamp:$t.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(ie){this.log(jo.ERROR,ie)}info(ie){this.log(jo.INFO,ie)}debug(ie){this.log(jo.DEBUG,ie)}isEmpty(){return this.events.length===0}send(ie,_e){var Xe=qt({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],ie(Xe,(lt,fn)=>{lt||this.sent++,_e&&_e(lt,fn)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class Ul{constructor(ie,_e,Xe,lt){this.name=ie,this.priority=_e,this.transport=Xe,this.options=lt||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(ie,_e){if(this.isSupported()){if(this.priority<ie)return gu(new re,_e)}else return gu(new me,_e);var Xe=!1,lt=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),fn=null,Qn=function(){lt.unbind("initialized",Qn),lt.connect()},fr=function(){fn=bi.createHandshake(lt,function(za){Xe=!0,Zi(),_e(null,za)})},Vr=function(za){Zi(),_e(za)},Bi=function(){Zi();var za;za=$n(lt),_e(new fe(za))},Zi=function(){lt.unbind("initialized",Qn),lt.unbind("open",fr),lt.unbind("error",Vr),lt.unbind("closed",Bi)};return lt.bind("initialized",Qn),lt.bind("open",fr),lt.bind("error",Vr),lt.bind("closed",Bi),lt.initialize(),{abort:()=>{Xe||(Zi(),fn?fn.close():lt.close())},forceMinPriority:za=>{Xe||this.priority<za&&(fn?fn.close():lt.close())}}}}function gu(ge,ie){return $t.defer(function(){ie(ge)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:ad}=di;var Vc=function(ge,ie,_e,Xe,lt,fn){var Qn=ad[_e];if(!Qn)throw new ce(_e);var fr=(!ge.enabledTransports||mn(ge.enabledTransports,ie)!==-1)&&(!ge.disabledTransports||mn(ge.disabledTransports,ie)===-1),Vr;return fr?(lt=Object.assign({ignoreNullOrigin:ge.ignoreNullOrigin},lt),Vr=new Ul(ie,Xe,fn?fn.getAssistant(Qn):Qn,lt)):Vr=Cl,Vr},Cl={isSupported:function(){return!1},connect:function(ge,ie){var _e=$t.defer(function(){ie(new me)});return{abort:function(){_e.ensureAborted()},forceMinPriority:function(){}}}};function Yo(ge){if(ge==null)throw"You must pass an options object";if(ge.cluster==null)throw"Options object must provide a cluster";"disableStats"in ge&&An.warn("The disableStats option is deprecated in favor of enableStats")}const hh=(ge,ie)=>{var _e="socket_id="+encodeURIComponent(ge.socketId);for(var Xe in ie.params)_e+="&"+encodeURIComponent(Xe)+"="+encodeURIComponent(ie.params[Xe]);if(ie.paramsProvider!=null){let lt=ie.paramsProvider();for(var Xe in lt)_e+="&"+encodeURIComponent(Xe)+"="+encodeURIComponent(lt[Xe])}return _e};var yu=ge=>{if(typeof di.getAuthorizers()[ge.transport]>"u")throw`'${ge.transport}' is not a recognized auth transport`;return(ie,_e)=>{const Xe=hh(ie,ge);di.getAuthorizers()[ge.transport](di,Xe,ge,q.UserAuthentication,_e)}};const Ms=(ge,ie)=>{var _e="socket_id="+encodeURIComponent(ge.socketId);_e+="&channel_name="+encodeURIComponent(ge.channelName);for(var Xe in ie.params)_e+="&"+encodeURIComponent(Xe)+"="+encodeURIComponent(ie.params[Xe]);if(ie.paramsProvider!=null){let lt=ie.paramsProvider();for(var Xe in lt)_e+="&"+encodeURIComponent(Xe)+"="+encodeURIComponent(lt[Xe])}return _e};var dh=ge=>{if(typeof di.getAuthorizers()[ge.transport]>"u")throw`'${ge.transport}' is not a recognized auth transport`;return(ie,_e)=>{const Xe=Ms(ie,ge);di.getAuthorizers()[ge.transport](di,Xe,ge,q.ChannelAuthorization,_e)}};const Ap=(ge,ie,_e)=>{const Xe={authTransport:ie.transport,authEndpoint:ie.endpoint,auth:{params:ie.params,headers:ie.headers}};return(lt,fn)=>{const Qn=ge.channel(lt.channelName);_e(Qn,Xe).authorize(lt.socketId,fn)}};function pi(ge,ie){let _e={activityTimeout:ge.activityTimeout||w.activityTimeout,cluster:ge.cluster,httpPath:ge.httpPath||w.httpPath,httpPort:ge.httpPort||w.httpPort,httpsPort:ge.httpsPort||w.httpsPort,pongTimeout:ge.pongTimeout||w.pongTimeout,statsHost:ge.statsHost||w.stats_host,unavailableTimeout:ge.unavailableTimeout||w.unavailableTimeout,wsPath:ge.wsPath||w.wsPath,wsPort:ge.wsPort||w.wsPort,wssPort:ge.wssPort||w.wssPort,enableStats:Qm(ge),httpHost:od(ge),useTLS:Gn(ge),wsHost:fh(ge),userAuthenticator:sd(ge),channelAuthorizer:Gs(ge,ie)};return"disabledTransports"in ge&&(_e.disabledTransports=ge.disabledTransports),"enabledTransports"in ge&&(_e.enabledTransports=ge.enabledTransports),"ignoreNullOrigin"in ge&&(_e.ignoreNullOrigin=ge.ignoreNullOrigin),"timelineParams"in ge&&(_e.timelineParams=ge.timelineParams),"nacl"in ge&&(_e.nacl=ge.nacl),_e}function od(ge){return ge.httpHost?ge.httpHost:ge.cluster?`sockjs-${ge.cluster}.pusher.com`:w.httpHost}function fh(ge){return ge.wsHost?ge.wsHost:Jm(ge.cluster)}function Jm(ge){return`ws-${ge}.pusher.com`}function Gn(ge){return di.getProtocol()==="https:"?!0:ge.forceTLS!==!1}function Qm(ge){return"enableStats"in ge?ge.enableStats:"disableStats"in ge?!ge.disableStats:!1}function sd(ge){const ie=Object.assign(Object.assign({},w.userAuthentication),ge.userAuthentication);return"customHandler"in ie&&ie.customHandler!=null?ie.customHandler:yu(ie)}function _u(ge,ie){let _e;return"channelAuthorization"in ge?_e=Object.assign(Object.assign({},w.channelAuthorization),ge.channelAuthorization):(_e={transport:ge.authTransport||w.authTransport,endpoint:ge.authEndpoint||w.authEndpoint},"auth"in ge&&("params"in ge.auth&&(_e.params=ge.auth.params),"headers"in ge.auth&&(_e.headers=ge.auth.headers)),"authorizer"in ge&&(_e.customHandler=Ap(ie,_e,ge.authorizer))),_e}function Gs(ge,ie){const _e=_u(ge,ie);return"customHandler"in _e&&_e.customHandler!=null?_e.customHandler:dh(_e)}class ld extends ci{constructor(ie){super(function(_e,Xe){An.debug(`No callbacks on watchlist events for ${_e}`)}),this.pusher=ie,this.bindWatchlistInternalEvent()}handleEvent(ie){ie.data.events.forEach(_e=>{this.emit(_e.name,_e)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",ie=>{var _e=ie.event;_e==="pusher_internal:watchlist_events"&&this.handleEvent(ie)})}}function ph(){let ge,ie;return{promise:new Promise((Xe,lt)=>{ge=Xe,ie=lt}),resolve:ge,reject:ie}}var Vn=ph;class fi extends ci{constructor(ie){super(function(_e,Xe){An.debug("No callbacks on user for "+_e)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(_e,Xe)=>{if(_e){An.warn(`Error during signin: ${_e}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:Xe.auth,user_data:Xe.user_data})},this.pusher=ie,this.pusher.connection.bind("state_change",({previous:_e,current:Xe})=>{_e!=="connected"&&Xe==="connected"&&this._signin(),_e==="connected"&&Xe!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new ld(ie),this.pusher.connection.bind("message",_e=>{var Xe=_e.event;Xe==="pusher:signin_success"&&this._onSigninSuccess(_e.data),this.serverToUserChannel&&this.serverToUserChannel.name===_e.channel&&this.serverToUserChannel.handleEvent(_e)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(ie){try{this.user_data=JSON.parse(ie.user_data)}catch{An.error(`Failed parsing user data after signin: ${ie.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){An.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const ie=_e=>{_e.subscriptionPending&&_e.subscriptionCancelled?_e.reinstateSubscription():!_e.subscriptionPending&&this.pusher.connection.state==="connected"&&_e.subscribe()};this.serverToUserChannel=new Mr(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((_e,Xe)=>{_e.indexOf("pusher_internal:")===0||_e.indexOf("pusher:")===0||this.emit(_e,Xe)}),ie(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:ie,resolve:_e}=Vn();ie.done=!1;const Xe=()=>{ie.done=!0};ie.then(Xe).catch(Xe),this.signinDonePromise=ie,this._signinDoneResolve=_e}}class xr{static ready(){xr.isReady=!0;for(var ie=0,_e=xr.instances.length;ie<_e;ie++)xr.instances[ie].connect()}static getClientFeatures(){return En(li({ws:di.Transports.ws},function(ie){return ie.isSupported({})}))}constructor(ie,_e){gc(ie),Yo(_e),this.key=ie,this.config=pi(_e,this),this.channels=bi.createChannels(),this.global_emitter=new ci,this.sessionID=di.randomInt(1e9),this.timeline=new dl(this.key,this.sessionID,{cluster:this.config.cluster,features:xr.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:jo.INFO,version:w.VERSION}),this.config.enableStats&&(this.timelineSender=bi.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+di.TimelineTransport.name}));var Xe=lt=>di.getDefaultStrategy(this.config,lt,Vc);this.connection=bi.createConnectionManager(this.key,{getStrategy:Xe,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",lt=>{var fn=lt.event,Qn=fn.indexOf("pusher_internal:")===0;if(lt.channel){var fr=this.channel(lt.channel);fr&&fr.handleEvent(lt)}Qn||this.global_emitter.emit(lt.event,lt.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",lt=>{An.warn(lt)}),xr.instances.push(this),this.timeline.info({instances:xr.instances.length}),this.user=new fi(this),xr.isReady&&this.connect()}channel(ie){return this.channels.find(ie)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var ie=this.connection.isUsingTLS(),_e=this.timelineSender;this.timelineSenderTimer=new gt(6e4,function(){_e.send(ie)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(ie,_e,Xe){return this.global_emitter.bind(ie,_e,Xe),this}unbind(ie,_e,Xe){return this.global_emitter.unbind(ie,_e,Xe),this}bind_global(ie){return this.global_emitter.bind_global(ie),this}unbind_global(ie){return this.global_emitter.unbind_global(ie),this}unbind_all(ie){return this.global_emitter.unbind_all(),this}subscribeAll(){var ie;for(ie in this.channels.channels)this.channels.channels.hasOwnProperty(ie)&&this.subscribe(ie)}subscribe(ie){var _e=this.channels.add(ie,this);return _e.subscriptionPending&&_e.subscriptionCancelled?_e.reinstateSubscription():!_e.subscriptionPending&&this.connection.state==="connected"&&_e.subscribe(),_e}unsubscribe(ie){var _e=this.channels.find(ie);_e&&_e.subscriptionPending?_e.cancelSubscription():(_e=this.channels.remove(ie),_e&&_e.subscribed&&_e.unsubscribe())}send_event(ie,_e,Xe){return this.connection.send_event(ie,_e,Xe)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}xr.instances=[],xr.isReady=!1,xr.logToConsole=!1,xr.Runtime=di,xr.ScriptReceivers=di.ScriptReceivers,xr.DependenciesReceivers=di.DependenciesReceivers,xr.auth_callbacks=di.auth_callbacks;var cs=i.default=xr;function gc(ge){if(ge==null)throw"You must pass your app key when you instantiate Pusher."}di.setup(xr)})])})})(hD)),hD.exports}var _De=yDe();const vDe=Wa(_De),Vd={};class dj{listenForWhisper(t,n){return this.listen(".client-"+t,n)}notification(t){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",t)}stopListeningForWhisper(t,n){return this.stopListening(".client-"+t,n)}}class CJ{constructor(t){this.namespace=t}format(t){return[".","\\"].includes(t.charAt(0))?t.substring(1):(this.namespace&&(t=this.namespace+"."+t),t.replace(/\./g,"\\"))}setNamespace(t){this.namespace=t}}function xDe(e){try{new e}catch(t){if(t instanceof Error&&t.message.includes("is not a constructor"))return!1}return!0}let fj=class extends dj{constructor(t,n,i){super(),this.name=n,this.pusher=t,this.options=i,this.eventFormatter=new CJ(this.options.namespace),this.subscribe()}subscribe(){this.subscription=this.pusher.subscribe(this.name)}unsubscribe(){this.pusher.unsubscribe(this.name)}listen(t,n){return this.on(this.eventFormatter.format(t),n),this}listenToAll(t){return this.subscription.bind_global((n,i)=>{if(n.startsWith("pusher:"))return;let c=String(this.options.namespace??"").replace(/\./g,"\\"),d=n.startsWith(c)?n.substring(c.length+1):"."+n;t(d,i)}),this}stopListening(t,n){return n?this.subscription.unbind(this.eventFormatter.format(t),n):this.subscription.unbind(this.eventFormatter.format(t)),this}stopListeningToAll(t){return t?this.subscription.unbind_global(t):this.subscription.unbind_global(),this}subscribed(t){return this.on("pusher:subscription_succeeded",()=>{t()}),this}error(t){return this.on("pusher:subscription_error",n=>{t(n)}),this}on(t,n){return this.subscription.bind(t,n),this}};class MJ extends fj{whisper(t,n){return this.pusher.channels.channels[this.name].trigger(`client-${t}`,n),this}}class bDe extends fj{whisper(t,n){return this.pusher.channels.channels[this.name].trigger(`client-${t}`,n),this}}let wDe=class extends MJ{here(t){return this.on("pusher:subscription_succeeded",n=>{t(Object.keys(n.members).map(i=>n.members[i]))}),this}joining(t){return this.on("pusher:member_added",n=>{t(n.info)}),this}whisper(t,n){return this.pusher.channels.channels[this.name].trigger(`client-${t}`,n),this}leaving(t){return this.on("pusher:member_removed",n=>{t(n.info)}),this}};class PJ extends dj{constructor(t,n,i){super(),this.events={},this.listeners={},this.name=n,this.socket=t,this.options=i,this.eventFormatter=new CJ(this.options.namespace),this.subscribe()}subscribe(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}unsubscribe(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}listen(t,n){return this.on(this.eventFormatter.format(t),n),this}stopListening(t,n){return this.unbindEvent(this.eventFormatter.format(t),n),this}subscribed(t){return this.on("connect",n=>{t(n)}),this}error(t){return this}on(t,n){return this.listeners[t]=this.listeners[t]||[],this.events[t]||(this.events[t]=(i,c)=>{this.name===i&&this.listeners[t]&&this.listeners[t].forEach(d=>d(c))},this.socket.on(t,this.events[t])),this.listeners[t].push(n),this}unbind(){Object.keys(this.events).forEach(t=>{this.unbindEvent(t)})}unbindEvent(t,n){this.listeners[t]=this.listeners[t]||[],n&&(this.listeners[t]=this.listeners[t].filter(i=>i!==n)),(!n||this.listeners[t].length===0)&&(this.events[t]&&(this.socket.removeListener(t,this.events[t]),delete this.events[t]),delete this.listeners[t])}}class OJ extends PJ{whisper(t,n){return this.socket.emit("client event",{channel:this.name,event:`client-${t}`,data:n}),this}}let SDe=class extends OJ{here(t){return this.on("presence:subscribed",n=>{t(n.map(i=>i.user_info))}),this}joining(t){return this.on("presence:joining",n=>t(n.user_info)),this}whisper(t,n){return this.socket.emit("client event",{channel:this.name,event:`client-${t}`,data:n}),this}leaving(t){return this.on("presence:leaving",n=>t(n.user_info)),this}};class OA extends dj{subscribe(){}unsubscribe(){}listen(t,n){return this}listenToAll(t){return this}stopListening(t,n){return this}subscribed(t){return this}error(t){return this}on(t,n){return this}}let RJ=class extends OA{whisper(t,n){return this}},TDe=class extends OA{whisper(t,n){return this}};class EDe extends RJ{here(t){return this}joining(t){return this}whisper(t,n){return this}leaving(t){return this}}const IJ=class DJ{constructor(t){this.setOptions(t),this.connect()}setOptions(t){this.options={...DJ._defaultOptions,...t,broadcaster:t.broadcaster};let n=this.csrfToken();n&&(this.options.auth.headers["X-CSRF-TOKEN"]=n,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=n),n=this.options.bearerToken,n&&(this.options.auth.headers.Authorization="Bearer "+n,this.options.userAuthentication.headers.Authorization="Bearer "+n)}csrfToken(){var t,n;return typeof window<"u"&&(t=window.Laravel)!=null&&t.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"?((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))??null:null}};IJ._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"};let pj=IJ;class JT extends pj{constructor(){super(...arguments),this.channels={}}connect(){if(typeof this.options.client<"u")this.pusher=this.options.client;else if(this.options.Pusher)this.pusher=new this.options.Pusher(this.options.key,this.options);else if(typeof window<"u"&&typeof window.Pusher<"u")this.pusher=new window.Pusher(this.options.key,this.options);else throw new Error("Pusher client not found. Should be globally available or passed via options.client")}signin(){this.pusher.signin()}listen(t,n,i){return this.channel(t).listen(n,i)}channel(t){return this.channels[t]||(this.channels[t]=new fj(this.pusher,t,this.options)),this.channels[t]}privateChannel(t){return this.channels["private-"+t]||(this.channels["private-"+t]=new MJ(this.pusher,"private-"+t,this.options)),this.channels["private-"+t]}encryptedPrivateChannel(t){return this.channels["private-encrypted-"+t]||(this.channels["private-encrypted-"+t]=new bDe(this.pusher,"private-encrypted-"+t,this.options)),this.channels["private-encrypted-"+t]}presenceChannel(t){return this.channels["presence-"+t]||(this.channels["presence-"+t]=new wDe(this.pusher,"presence-"+t,this.options)),this.channels["presence-"+t]}leave(t){[t,"private-"+t,"private-encrypted-"+t,"presence-"+t].forEach(n=>{this.leaveChannel(n)})}leaveChannel(t){this.channels[t]&&(this.channels[t].unsubscribe(),delete this.channels[t])}socketId(){return this.pusher.connection.socket_id}disconnect(){this.pusher.disconnect()}}let ADe=class extends pj{constructor(){super(...arguments),this.channels={}}connect(){let t=this.getSocketIO();this.socket=t(this.options.host??void 0,this.options),this.socket.io.on("reconnect",()=>{Object.values(this.channels).forEach(n=>{n.subscribe()})})}getSocketIO(){if(typeof this.options.client<"u")return this.options.client;if(typeof window<"u"&&typeof window.io<"u")return window.io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}listen(t,n,i){return this.channel(t).listen(n,i)}channel(t){return this.channels[t]||(this.channels[t]=new PJ(this.socket,t,this.options)),this.channels[t]}privateChannel(t){return this.channels["private-"+t]||(this.channels["private-"+t]=new OJ(this.socket,"private-"+t,this.options)),this.channels["private-"+t]}presenceChannel(t){return this.channels["presence-"+t]||(this.channels["presence-"+t]=new SDe(this.socket,"presence-"+t,this.options)),this.channels["presence-"+t]}leave(t){[t,"private-"+t,"presence-"+t].forEach(n=>{this.leaveChannel(n)})}leaveChannel(t){this.channels[t]&&(this.channels[t].unsubscribe(),delete this.channels[t])}socketId(){return this.socket.id}disconnect(){this.socket.disconnect()}};class DH extends pj{constructor(){super(...arguments),this.channels={}}connect(){}listen(t,n,i){return new OA}channel(t){return new OA}privateChannel(t){return new RJ}encryptedPrivateChannel(t){return new TDe}presenceChannel(t){return new EDe}leave(t){}leaveChannel(t){}socketId(){return"fake-socket-id"}disconnect(){}}class CDe{constructor(t){this.options=t,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}channel(t){return this.connector.channel(t)}connect(){if(this.options.broadcaster==="reverb")this.connector=new JT({...this.options,cluster:""});else if(this.options.broadcaster==="pusher")this.connector=new JT(this.options);else if(this.options.broadcaster==="ably")this.connector=new JT({...this.options,cluster:"",broadcaster:"pusher"});else if(this.options.broadcaster==="socket.io")this.connector=new ADe(this.options);else if(this.options.broadcaster==="null")this.connector=new DH(this.options);else if(typeof this.options.broadcaster=="function"&&xDe(this.options.broadcaster))this.connector=new this.options.broadcaster(this.options);else throw new Error(`Broadcaster ${typeof this.options.broadcaster} ${String(this.options.broadcaster)} is not supported.`)}disconnect(){this.connector.disconnect()}join(t){return this.connector.presenceChannel(t)}leave(t){this.connector.leave(t)}leaveChannel(t){this.connector.leaveChannel(t)}leaveAllChannels(){for(const t in this.connector.channels)this.leaveChannel(t)}listen(t,n,i){return this.connector.listen(t,n,i)}private(t){return this.connector.privateChannel(t)}encryptedPrivate(t){if(this.connectorSupportsEncryptedPrivateChannels(this.connector))return this.connector.encryptedPrivateChannel(t);throw new Error(`Broadcaster ${typeof this.options.broadcaster} ${String(this.options.broadcaster)} does not support encrypted private channels.`)}connectorSupportsEncryptedPrivateChannels(t){return t instanceof JT||t instanceof DH}socketId(){return this.connector.socketId()}registerInterceptors(){typeof Vue<"u"&&Vue!=null&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),typeof Turbo=="object"&&this.registerTurboRequestInterceptor()}registerVueRequestInterceptor(){Vue.http.interceptors.push((t,n)=>{this.socketId()&&t.headers.set("X-Socket-ID",this.socketId()),n()})}registerAxiosRequestInterceptor(){axios.interceptors.request.use(t=>(this.socketId()&&(t.headers["X-Socket-Id"]=this.socketId()),t))}registerjQueryAjaxSetup(){typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter((t,n,i)=>{this.socketId()&&i.setRequestHeader("X-Socket-Id",this.socketId())})}registerTurboRequestInterceptor(){document.addEventListener("turbo:before-fetch-request",t=>{t.detail.fetchOptions.headers["X-Socket-Id"]=this.socketId()})}}let Cx=null,xw=null;const MDe=()=>{if(Cx)return Cx;if(!xw)throw new Error("Echo has not been configured. Please call `configureEcho()`.");return xw.Pusher??(xw.Pusher=vDe),Cx=new CDe(xw),Cx},PDe=e=>{xw={...{reverb:{broadcaster:"reverb",key:void 0,wsHost:void 0,wsPort:void 0,wssPort:void 0,forceTLS:!0,enabledTransports:["ws","wss"]},pusher:{broadcaster:"pusher",key:void 0,cluster:void 0,forceTLS:!0,wsHost:void 0,wsPort:void 0,wssPort:void 0,enabledTransports:["ws","wss"]},"socket.io":{broadcaster:"socket.io",host:void 0},null:{broadcaster:"null"},ably:{broadcaster:"pusher",key:void 0,wsHost:"realtime-pusher.ably.io",wsPort:443,disableStats:!0,encrypted:!0}}[e.broadcaster],...e},Cx&&(Cx=null)},kL=()=>MDe(),ODe=e=>Array.isArray(e)?e:[e],ay={},RDe=e=>{const t=kL();return e.visibility==="presence"?t.join(e.name):e.visibility==="private"?t.private(e.name):t.channel(e.name)},IDe=(e,t)=>{ay[e.id]&&(ay[e.id].count-=1,!(ay[e.id].count>0)&&(t?kL().leave(e.name):kL().leaveChannel(e.id),delete ay[e.id]))},kH=e=>{if(ay[e.id])return ay[e.id].count+=1,ay[e.id].connection;const t=RDe(e);return ay[e.id]={count:1,connection:t},t},DDe=(e,t=[],n=()=>{},i=[],c="private")=>{const d={name:e,id:["private","presence"].includes(c)?`${c}-${e}`:e,visibility:c},m=K.useCallback(n,i),a=K.useRef(!1),w=K.useRef(!1),S=K.useRef(kH(d)),M=ODe(t),P=K.useCallback(()=>{a.current&&(M.forEach(G=>{S.current.stopListening(G,m)}),a.current=!1)},i),N=K.useCallback(()=>{a.current||(M.forEach(G=>{S.current.listen(G,m)}),a.current=!0)},i),$=K.useCallback((G=!1)=>{P(),IDe(d,G)},i);return K.useEffect(()=>(w.current&&(S.current=kH(d)),w.current=!0,N(),$),i),{leaveChannel:$,leave:()=>$(!0),stopListening:P,listen:N,channel:()=>S.current}},j0=(e,t=[],n=()=>{},i=[])=>DDe(e,t,n,i,"public"),Qa={broadcast:{config:()=>PDe({broadcaster:"ably",key:"P4gHEA.Cx6WMg"})},dashboard:{index:()=>ns.get("/api/dashboard")},vehicles:{all:(e={})=>ns.get("/api/vehicles/all",{params:e}),list:(e={})=>ns.get("/api/vehicles",{params:e}),details:(e={})=>ns.get("/api/vehicles/details",{params:e}),register:e=>ns.post("/api/vehicles/register",e),update:e=>ns.put("/api/vehicles/change",e),updateStatus:e=>ns.put("/api/vehicles/change/status",e),changeImage:e=>ns.post("/api/vehicles/change/image",e,{headers:{"Content-Type":"multipart/form-data"}})},vdocuments:{get:(e={})=>ns.get("/api/vdocuments/get",{params:e}),upload:e=>ns.post("/api/vdocuments/upload",e,{headers:{"Content-Type":"multipart/form-data"}})},reservations:{list:(e={})=>ns.get("/api/reserve",{params:e}),details:e=>ns.post("/api/reserve/details",e),submit:e=>ns.post("/api/reserve/submit",e),costDetails:e=>ns.get("/api/reserve/details/cost",{params:{id:e}}),approve:e=>ns.put("/api/reserve/approve",e),reject:e=>ns.put("/api/reserve/cancel",e)},drivers:{list:(e={})=>ns.get("/api/drivers",{params:e}),getDrivers:()=>ns.get("/api/drivers/getDrivers"),dialogDrivers:(e={})=>ns.get("/api/drivers/dialogDrivers",{params:e}),driverDetails:(e={})=>ns.get("/api/drivers/details",{params:e})},dispatches:{list:(e={})=>ns.get("/api/dispatches",{params:e}),details:(e={})=>ns.get("/api/dispatches/details",{params:e}),start:e=>ns.post("/api/dispatches/start",{id:e})}};function kJ(e,t,n="id",i=!0){const c=e.findIndex(d=>d[n]===t[n]);if(c!==-1){if(i){const d=[...e];return d[c]={...d[c],...t},d}return e.map(d=>d[n]===t[n]?t:d)}return console.log(e),[t,...e]}function kDe(){const[e,t]=K.useState(),[n,i]=K.useState(),c=K.useCallback(()=>{i(!0),Qa.dashboard.index().then(d=>{console.log(d),t(d.data)}).catch(d=>{console.error("Error fetching dashboard data:",d)}).finally(()=>{i(!1)})},[]);return K.useEffect(()=>{c()},[c]),D.jsxs(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col gap-3 h-full",children:[D.jsxs("div",{className:"mb-2",children:[D.jsx("h1",{className:"text-1xl font-bold",children:"JOLI Travel and Tours"}),D.jsx("h2",{className:"text-3xl font-medium",children:"Logistics 2 - Fleet Management"})]}),D.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 h-full w-full",children:n?D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-4",children:D.jsxs(Uo,{className:"rounded-md h-full",children:[D.jsxs($o,{children:[D.jsx(Oi,{className:"h-8 w-1/3 mb-2"}),D.jsx(Oi,{className:"h-4 w-1/4"})]}),D.jsx(qo,{className:"p-4 h-64",children:D.jsx(Oi,{className:"h-full w-full"})})]})}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(Oi,{className:"h-6 w-2/3 mb-2"}),D.jsx(Oi,{className:"h-4 w-1/2"})]}),D.jsx(qo,{children:D.jsxs("div",{className:"flex flex-col gap-2",children:[D.jsx(Oi,{className:"h-6 w-full"}),D.jsx(Oi,{className:"h-6 w-full"}),D.jsx(Oi,{className:"h-6 w-full"})]})})]}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(Oi,{className:"h-6 w-2/3 mb-2"}),D.jsx(Oi,{className:"h-4 w-1/2"})]}),D.jsx(qo,{children:D.jsxs("div",{className:"flex flex-col gap-2",children:[D.jsx(Oi,{className:"h-6 w-full"}),D.jsx(Oi,{className:"h-6 w-full"}),D.jsx(Oi,{className:"h-6 w-full"})]})})]}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(Oi,{className:"h-6 w-2/3 mb-2"}),D.jsx(Oi,{className:"h-4 w-1/2"})]}),D.jsxs(qo,{children:[D.jsx(Oi,{className:"h-6 w-full"}),D.jsx(Oi,{className:"h-6 w-full"})]})]}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(Oi,{className:"h-6 w-2/3 mb-2"}),D.jsx(Oi,{className:"h-4 w-1/2"})]}),D.jsxs(qo,{children:[D.jsx(Oi,{className:"h-6 w-full"}),D.jsx(Oi,{className:"h-6 w-full"})]})]})]}):D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-4",children:D.jsxs(Uo,{className:"rounded-md h-full",children:[D.jsxs($o,{children:[D.jsx(il,{className:"text-3xl",children:"Reservation Trend"}),D.jsx(hc,{children:"Last 30 days"})]}),D.jsx(qo,{className:"h-64",children:D.jsx(mDe,{data:e?.reservation_trends})})]})}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(il,{className:"text-2xl",children:"Ongoing Dispatches"}),D.jsx(hc,{})]}),D.jsx(qo,{children:e?.ongoing_dispatches?.length>0?D.jsx("div",{className:"flex flex-col",children:e?.ongoing_dispatches?.map((d,m)=>D.jsxs("div",{children:[D.jsx(fc,{to:`/logisticsII/dispatch/${d?.batch_number}`,className:"p-2",children:D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("span",{children:d?.driver}),D.jsx("span",{children:d?.status})]})},m),D.jsx(Us,{})]},`dispatch-${m}`))}):D.jsx("div",{className:"p-2 text-muted-foreground",children:"No ongoing dispatches"})})]}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(il,{className:"text-2xl",children:"Expiring Documents"}),D.jsx(hc,{})]}),D.jsx(qo,{children:e?.document_expirations?.length>0?D.jsx("div",{className:"flex flex-col",children:e?.document_expirations?.map((d,m)=>D.jsx("div",{className:"p-2 border-b",children:D.jsxs(fc,{to:`/logisticsII/vehicles/${d?.uuid}`,className:"flex justify-between items-center",children:[D.jsx("span",{children:d?.document_name}),D.jsx("span",{children:d?.expiry_date})]})},`document-${m}`))}):D.jsx("div",{className:"p-2 text-muted-foreground",children:"No expiring documents"})})]}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(il,{className:"text-2xl",children:"Driver Updates"}),D.jsx(hc,{})]}),D.jsx(qo,{})]}),D.jsxs(Uo,{className:"rounded-md h-full min-h-40 col-span-1",children:[D.jsxs($o,{children:[D.jsx(il,{className:"text-2xl",children:"Vehicle Updates"}),D.jsx(hc,{})]}),D.jsx(qo,{})]})]})})]})}function oC({...e}){return D.jsx(l2,{"data-slot":"dialog",...e})}function sC({...e}){return D.jsx(s7,{"data-slot":"dialog-trigger",...e})}function LDe({...e}){return D.jsx(c2,{"data-slot":"dialog-portal",...e})}function NDe({...e}){return D.jsx($1,{"data-slot":"dialog-close",...e})}function zDe({className:e,...t}){return D.jsx(u2,{"data-slot":"dialog-overlay",className:bn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function lC({className:e,children:t,showCloseButton:n=!0,...i}){return D.jsxs(LDe,{"data-slot":"dialog-portal",children:[D.jsx(zDe,{}),D.jsxs(h2,{"data-slot":"dialog-content",className:bn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...i,children:[t,n&&D.jsxs($1,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[D.jsx(dW,{}),D.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function cC({className:e,...t}){return D.jsx("div",{"data-slot":"dialog-header",className:bn("flex flex-col gap-2 text-center sm:text-left",e),...t})}function jDe({className:e,...t}){return D.jsx("div",{"data-slot":"dialog-footer",className:bn("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function uC({className:e,...t}){return D.jsx(cN,{"data-slot":"dialog-title",className:bn("text-lg leading-none font-semibold",e),...t})}function hC({className:e,...t}){return D.jsx(uN,{"data-slot":"dialog-description",className:bn("text-muted-foreground text-sm",e),...t})}function ou({className:e,...t}){return D.jsx("div",{"data-slot":"alert-description",className:bn("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var dC="Popover",[LJ,VBe]=ih(dC,[gy]),cS=gy(),[BDe,Ty]=LJ(dC),NJ=e=>{const{__scopePopover:t,children:n,open:i,defaultOpen:c,onOpenChange:d,modal:m=!1}=e,a=cS(t),w=K.useRef(null),[S,M]=K.useState(!1),[P,N]=mp({prop:i,defaultProp:c??!1,onChange:d,caller:dC});return D.jsx(m2,{...a,children:D.jsx(BDe,{scope:t,contentId:ol(),triggerRef:w,open:P,onOpenChange:N,onOpenToggle:K.useCallback(()=>N($=>!$),[N]),hasCustomAnchor:S,onCustomAnchorAdd:K.useCallback(()=>M(!0),[]),onCustomAnchorRemove:K.useCallback(()=>M(!1),[]),modal:m,children:n})})};NJ.displayName=dC;var zJ="PopoverAnchor",FDe=K.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,c=Ty(zJ,n),d=cS(n),{onCustomAnchorAdd:m,onCustomAnchorRemove:a}=c;return K.useEffect(()=>(m(),()=>a()),[m,a]),D.jsx(H1,{...d,...i,ref:t})});FDe.displayName=zJ;var jJ="PopoverTrigger",BJ=K.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,c=Ty(jJ,n),d=cS(n),m=ba(t,c.triggerRef),a=D.jsx(ii.button,{type:"button","aria-haspopup":"dialog","aria-expanded":c.open,"aria-controls":c.contentId,"data-state":qJ(c.open),...i,ref:m,onClick:vr(e.onClick,c.onOpenToggle)});return c.hasCustomAnchor?a:D.jsx(H1,{asChild:!0,...d,children:a})});BJ.displayName=jJ;var mj="PopoverPortal",[VDe,UDe]=LJ(mj,{forceMount:void 0}),FJ=e=>{const{__scopePopover:t,forceMount:n,children:i,container:c}=e,d=Ty(mj,t);return D.jsx(VDe,{scope:t,forceMount:n,children:D.jsx(ah,{present:n||d.open,children:D.jsx(S0,{asChild:!0,container:c,children:i})})})};FJ.displayName=mj;var f0="PopoverContent",VJ=K.forwardRef((e,t)=>{const n=UDe(f0,e.__scopePopover),{forceMount:i=n.forceMount,...c}=e,d=Ty(f0,e.__scopePopover);return D.jsx(ah,{present:i||d.open,children:d.modal?D.jsx(qDe,{...c,ref:t}):D.jsx(HDe,{...c,ref:t})})});VJ.displayName=f0;var $De=cy("PopoverContent.RemoveScroll"),qDe=K.forwardRef((e,t)=>{const n=Ty(f0,e.__scopePopover),i=K.useRef(null),c=ba(t,i),d=K.useRef(!1);return K.useEffect(()=>{const m=i.current;if(m)return o2(m)},[]),D.jsx(U1,{as:$De,allowPinchZoom:!0,children:D.jsx(UJ,{...e,ref:c,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vr(e.onCloseAutoFocus,m=>{m.preventDefault(),d.current||n.triggerRef.current?.focus()}),onPointerDownOutside:vr(e.onPointerDownOutside,m=>{const a=m.detail.originalEvent,w=a.button===0&&a.ctrlKey===!0,S=a.button===2||w;d.current=S},{checkForDefaultPrevented:!1}),onFocusOutside:vr(e.onFocusOutside,m=>m.preventDefault(),{checkForDefaultPrevented:!1})})})}),HDe=K.forwardRef((e,t)=>{const n=Ty(f0,e.__scopePopover),i=K.useRef(!1),c=K.useRef(!1);return D.jsx(UJ,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:d=>{e.onCloseAutoFocus?.(d),d.defaultPrevented||(i.current||n.triggerRef.current?.focus(),d.preventDefault()),i.current=!1,c.current=!1},onInteractOutside:d=>{e.onInteractOutside?.(d),d.defaultPrevented||(i.current=!0,d.detail.originalEvent.type==="pointerdown"&&(c.current=!0));const m=d.target;n.triggerRef.current?.contains(m)&&d.preventDefault(),d.detail.originalEvent.type==="focusin"&&c.current&&d.preventDefault()}})}),UJ=K.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:c,onCloseAutoFocus:d,disableOutsidePointerEvents:m,onEscapeKeyDown:a,onPointerDownOutside:w,onFocusOutside:S,onInteractOutside:M,...P}=e,N=Ty(f0,n),$=cS(n);return i2(),D.jsx(V1,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:c,onUnmountAutoFocus:d,children:D.jsx(w0,{asChild:!0,disableOutsidePointerEvents:m,onInteractOutside:M,onEscapeKeyDown:a,onPointerDownOutside:w,onFocusOutside:S,onDismiss:()=>N.onOpenChange(!1),children:D.jsx(g2,{"data-state":qJ(N.open),role:"dialog",id:N.contentId,...$,...P,ref:t,style:{...P.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),$J="PopoverClose",GDe=K.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,c=Ty($J,n);return D.jsx(ii.button,{type:"button",...i,ref:t,onClick:vr(e.onClick,()=>c.onOpenChange(!1))})});GDe.displayName=$J;var WDe="PopoverArrow",XDe=K.forwardRef((e,t)=>{const{__scopePopover:n,...i}=e,c=cS(n);return D.jsx(y2,{...c,...i,ref:t})});XDe.displayName=WDe;function qJ(e){return e?"open":"closed"}var ZDe=NJ,YDe=BJ,KDe=FJ,JDe=VJ;function uS({...e}){return D.jsx(ZDe,{"data-slot":"popover",...e})}function hS({...e}){return D.jsx(YDe,{"data-slot":"popover-trigger",...e})}function dS({className:e,align:t="center",sideOffset:n=4,...i}){return D.jsx(KDe,{children:D.jsx(JDe,{"data-slot":"popover-content",align:t,sideOffset:n,className:bn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...i})})}var LH=1,QDe=.9,eke=.8,tke=.17,dD=.1,fD=.999,nke=.9999,rke=.99,ike=/[\\\/_+.#"@\[\(\{&]/,ake=/[\\\/_+.#"@\[\(\{&]/g,oke=/[\s-]/,HJ=/[\s-]/g;function LL(e,t,n,i,c,d,m){if(d===t.length)return c===e.length?LH:rke;var a=`${c},${d}`;if(m[a]!==void 0)return m[a];for(var w=i.charAt(d),S=n.indexOf(w,c),M=0,P,N,$,G;S>=0;)P=LL(e,t,n,i,S+1,d+1,m),P>M&&(S===c?P*=LH:ike.test(e.charAt(S-1))?(P*=eke,$=e.slice(c,S-1).match(ake),$&&c>0&&(P*=Math.pow(fD,$.length))):oke.test(e.charAt(S-1))?(P*=QDe,G=e.slice(c,S-1).match(HJ),G&&c>0&&(P*=Math.pow(fD,G.length))):(P*=tke,c>0&&(P*=Math.pow(fD,S-c))),e.charAt(S)!==t.charAt(d)&&(P*=nke)),(P<dD&&n.charAt(S-1)===i.charAt(d+1)||i.charAt(d+1)===i.charAt(d)&&n.charAt(S-1)!==i.charAt(d))&&(N=LL(e,t,n,i,S+1,d+2,m),N*dD>P&&(P=N*dD)),P>M&&(M=P),S=n.indexOf(w,S+1);return m[a]=M,M}function NH(e){return e.toLowerCase().replace(HJ," ")}function ske(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,LL(e,t,NH(e),NH(t),0,0,{})}var lw='[cmdk-group=""]',pD='[cmdk-group-items=""]',lke='[cmdk-group-heading=""]',GJ='[cmdk-item=""]',zH=`${GJ}:not([aria-disabled="true"])`,NL="cmdk-item-select",gx="data-value",cke=(e,t,n)=>ske(e,t,n),WJ=K.createContext(void 0),fS=()=>K.useContext(WJ),XJ=K.createContext(void 0),gj=()=>K.useContext(XJ),ZJ=K.createContext(void 0),YJ=K.forwardRef((e,t)=>{let n=yx(()=>{var nt,gt;return{search:"",value:(gt=(nt=e.value)!=null?nt:e.defaultValue)!=null?gt:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),i=yx(()=>new Set),c=yx(()=>new Map),d=yx(()=>new Map),m=yx(()=>new Set),a=KJ(e),{label:w,children:S,value:M,onValueChange:P,filter:N,shouldFilter:$,loop:G,disablePointerSelection:q=!1,vimBindings:V=!0,...J}=e,ee=ol(),re=ol(),fe=ol(),ne=K.useRef(null),ce=xke();rv(()=>{if(M!==void 0){let nt=M.trim();n.current.value=nt,me.emit()}},[M]),rv(()=>{ce(6,at)},[]);let me=K.useMemo(()=>({subscribe:nt=>(m.current.add(nt),()=>m.current.delete(nt)),snapshot:()=>n.current,setState:(nt,gt,Ut)=>{var $t,qt,Ht,mn;if(!Object.is(n.current[nt],gt)){if(n.current[nt]=gt,nt==="search")tt(),Ye(),ce(1,ze);else if(nt==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let en=document.getElementById(fe);en?en.focus():($t=document.getElementById(ee))==null||$t.focus()}if(ce(7,()=>{var en;n.current.selectedItemId=(en=ct())==null?void 0:en.id,me.emit()}),Ut||ce(5,at),((qt=a.current)==null?void 0:qt.value)!==void 0){let en=gt??"";(mn=(Ht=a.current).onValueChange)==null||mn.call(Ht,en);return}}me.emit()}},emit:()=>{m.current.forEach(nt=>nt())}}),[]),ve=K.useMemo(()=>({value:(nt,gt,Ut)=>{var $t;gt!==(($t=d.current.get(nt))==null?void 0:$t.value)&&(d.current.set(nt,{value:gt,keywords:Ut}),n.current.filtered.items.set(nt,De(gt,Ut)),ce(2,()=>{Ye(),me.emit()}))},item:(nt,gt)=>(i.current.add(nt),gt&&(c.current.has(gt)?c.current.get(gt).add(nt):c.current.set(gt,new Set([nt]))),ce(3,()=>{tt(),Ye(),n.current.value||ze(),me.emit()}),()=>{d.current.delete(nt),i.current.delete(nt),n.current.filtered.items.delete(nt);let Ut=ct();ce(4,()=>{tt(),Ut?.getAttribute("id")===nt&&ze(),me.emit()})}),group:nt=>(c.current.has(nt)||c.current.set(nt,new Set),()=>{d.current.delete(nt),c.current.delete(nt)}),filter:()=>a.current.shouldFilter,label:w||e["aria-label"],getDisablePointerSelection:()=>a.current.disablePointerSelection,listId:ee,inputId:fe,labelId:re,listInnerRef:ne}),[]);function De(nt,gt){var Ut,$t;let qt=($t=(Ut=a.current)==null?void 0:Ut.filter)!=null?$t:cke;return nt?qt(nt,n.current.search,gt):0}function Ye(){if(!n.current.search||a.current.shouldFilter===!1)return;let nt=n.current.filtered.items,gt=[];n.current.filtered.groups.forEach($t=>{let qt=c.current.get($t),Ht=0;qt.forEach(mn=>{let en=nt.get(mn);Ht=Math.max(en,Ht)}),gt.push([$t,Ht])});let Ut=ne.current;ht().sort(($t,qt)=>{var Ht,mn;let en=$t.getAttribute("id"),En=qt.getAttribute("id");return((Ht=nt.get(En))!=null?Ht:0)-((mn=nt.get(en))!=null?mn:0)}).forEach($t=>{let qt=$t.closest(pD);qt?qt.appendChild($t.parentElement===qt?$t:$t.closest(`${pD} > *`)):Ut.appendChild($t.parentElement===Ut?$t:$t.closest(`${pD} > *`))}),gt.sort(($t,qt)=>qt[1]-$t[1]).forEach($t=>{var qt;let Ht=(qt=ne.current)==null?void 0:qt.querySelector(`${lw}[${gx}="${encodeURIComponent($t[0])}"]`);Ht?.parentElement.appendChild(Ht)})}function ze(){let nt=ht().find(Ut=>Ut.getAttribute("aria-disabled")!=="true"),gt=nt?.getAttribute(gx);me.setState("value",gt||void 0)}function tt(){var nt,gt,Ut,$t;if(!n.current.search||a.current.shouldFilter===!1){n.current.filtered.count=i.current.size;return}n.current.filtered.groups=new Set;let qt=0;for(let Ht of i.current){let mn=(gt=(nt=d.current.get(Ht))==null?void 0:nt.value)!=null?gt:"",en=($t=(Ut=d.current.get(Ht))==null?void 0:Ut.keywords)!=null?$t:[],En=De(mn,en);n.current.filtered.items.set(Ht,En),En>0&&qt++}for(let[Ht,mn]of c.current)for(let en of mn)if(n.current.filtered.items.get(en)>0){n.current.filtered.groups.add(Ht);break}n.current.filtered.count=qt}function at(){var nt,gt,Ut;let $t=ct();$t&&(((nt=$t.parentElement)==null?void 0:nt.firstChild)===$t&&((Ut=(gt=$t.closest(lw))==null?void 0:gt.querySelector(lke))==null||Ut.scrollIntoView({block:"nearest"})),$t.scrollIntoView({block:"nearest"}))}function ct(){var nt;return(nt=ne.current)==null?void 0:nt.querySelector(`${GJ}[aria-selected="true"]`)}function ht(){var nt;return Array.from(((nt=ne.current)==null?void 0:nt.querySelectorAll(zH))||[])}function Ie(nt){let gt=ht()[nt];gt&&me.setState("value",gt.getAttribute(gx))}function rt(nt){var gt;let Ut=ct(),$t=ht(),qt=$t.findIndex(mn=>mn===Ut),Ht=$t[qt+nt];(gt=a.current)!=null&&gt.loop&&(Ht=qt+nt<0?$t[$t.length-1]:qt+nt===$t.length?$t[0]:$t[qt+nt]),Ht&&me.setState("value",Ht.getAttribute(gx))}function Qe(nt){let gt=ct(),Ut=gt?.closest(lw),$t;for(;Ut&&!$t;)Ut=nt>0?_ke(Ut,lw):vke(Ut,lw),$t=Ut?.querySelector(zH);$t?me.setState("value",$t.getAttribute(gx)):rt(nt)}let St=()=>Ie(ht().length-1),qe=nt=>{nt.preventDefault(),nt.metaKey?St():nt.altKey?Qe(1):rt(1)},vt=nt=>{nt.preventDefault(),nt.metaKey?Ie(0):nt.altKey?Qe(-1):rt(-1)};return K.createElement(ii.div,{ref:t,tabIndex:-1,...J,"cmdk-root":"",onKeyDown:nt=>{var gt;(gt=J.onKeyDown)==null||gt.call(J,nt);let Ut=nt.nativeEvent.isComposing||nt.keyCode===229;if(!(nt.defaultPrevented||Ut))switch(nt.key){case"n":case"j":{V&&nt.ctrlKey&&qe(nt);break}case"ArrowDown":{qe(nt);break}case"p":case"k":{V&&nt.ctrlKey&&vt(nt);break}case"ArrowUp":{vt(nt);break}case"Home":{nt.preventDefault(),Ie(0);break}case"End":{nt.preventDefault(),St();break}case"Enter":{nt.preventDefault();let $t=ct();if($t){let qt=new Event(NL);$t.dispatchEvent(qt)}}}}},K.createElement("label",{"cmdk-label":"",htmlFor:ve.inputId,id:ve.labelId,style:wke},w),fC(e,nt=>K.createElement(XJ.Provider,{value:me},K.createElement(WJ.Provider,{value:ve},nt))))}),uke=K.forwardRef((e,t)=>{var n,i;let c=ol(),d=K.useRef(null),m=K.useContext(ZJ),a=fS(),w=KJ(e),S=(i=(n=w.current)==null?void 0:n.forceMount)!=null?i:m?.forceMount;rv(()=>{if(!S)return a.item(c,m?.id)},[S]);let M=JJ(c,d,[e.value,e.children,d],e.keywords),P=gj(),N=py(ce=>ce.value&&ce.value===M.current),$=py(ce=>S||a.filter()===!1?!0:ce.search?ce.filtered.items.get(c)>0:!0);K.useEffect(()=>{let ce=d.current;if(!(!ce||e.disabled))return ce.addEventListener(NL,G),()=>ce.removeEventListener(NL,G)},[$,e.onSelect,e.disabled]);function G(){var ce,me;q(),(me=(ce=w.current).onSelect)==null||me.call(ce,M.current)}function q(){P.setState("value",M.current,!0)}if(!$)return null;let{disabled:V,value:J,onSelect:ee,forceMount:re,keywords:fe,...ne}=e;return K.createElement(ii.div,{ref:zm(d,t),...ne,id:c,"cmdk-item":"",role:"option","aria-disabled":!!V,"aria-selected":!!N,"data-disabled":!!V,"data-selected":!!N,onPointerMove:V||a.getDisablePointerSelection()?void 0:q,onClick:V?void 0:G},e.children)}),hke=K.forwardRef((e,t)=>{let{heading:n,children:i,forceMount:c,...d}=e,m=ol(),a=K.useRef(null),w=K.useRef(null),S=ol(),M=fS(),P=py($=>c||M.filter()===!1?!0:$.search?$.filtered.groups.has(m):!0);rv(()=>M.group(m),[]),JJ(m,a,[e.value,e.heading,w]);let N=K.useMemo(()=>({id:m,forceMount:c}),[c]);return K.createElement(ii.div,{ref:zm(a,t),...d,"cmdk-group":"",role:"presentation",hidden:P?void 0:!0},n&&K.createElement("div",{ref:w,"cmdk-group-heading":"","aria-hidden":!0,id:S},n),fC(e,$=>K.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?S:void 0},K.createElement(ZJ.Provider,{value:N},$))))}),dke=K.forwardRef((e,t)=>{let{alwaysRender:n,...i}=e,c=K.useRef(null),d=py(m=>!m.search);return!n&&!d?null:K.createElement(ii.div,{ref:zm(c,t),...i,"cmdk-separator":"",role:"separator"})}),fke=K.forwardRef((e,t)=>{let{onValueChange:n,...i}=e,c=e.value!=null,d=gj(),m=py(S=>S.search),a=py(S=>S.selectedItemId),w=fS();return K.useEffect(()=>{e.value!=null&&d.setState("search",e.value)},[e.value]),K.createElement(ii.input,{ref:t,...i,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":w.listId,"aria-labelledby":w.labelId,"aria-activedescendant":a,id:w.inputId,type:"text",value:c?e.value:m,onChange:S=>{c||d.setState("search",S.target.value),n?.(S.target.value)}})}),pke=K.forwardRef((e,t)=>{let{children:n,label:i="Suggestions",...c}=e,d=K.useRef(null),m=K.useRef(null),a=py(S=>S.selectedItemId),w=fS();return K.useEffect(()=>{if(m.current&&d.current){let S=m.current,M=d.current,P,N=new ResizeObserver(()=>{P=requestAnimationFrame(()=>{let $=S.offsetHeight;M.style.setProperty("--cmdk-list-height",$.toFixed(1)+"px")})});return N.observe(S),()=>{cancelAnimationFrame(P),N.unobserve(S)}}},[]),K.createElement(ii.div,{ref:zm(d,t),...c,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":a,"aria-label":i,id:w.listId},fC(e,S=>K.createElement("div",{ref:zm(m,w.listInnerRef),"cmdk-list-sizer":""},S)))}),mke=K.forwardRef((e,t)=>{let{open:n,onOpenChange:i,overlayClassName:c,contentClassName:d,container:m,...a}=e;return K.createElement(l2,{open:n,onOpenChange:i},K.createElement(c2,{container:m},K.createElement(u2,{"cmdk-overlay":"",className:c}),K.createElement(h2,{"aria-label":e.label,"cmdk-dialog":"",className:d},K.createElement(YJ,{ref:t,...a}))))}),gke=K.forwardRef((e,t)=>py(n=>n.filtered.count===0)?K.createElement(ii.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),yke=K.forwardRef((e,t)=>{let{progress:n,children:i,label:c="Loading...",...d}=e;return K.createElement(ii.div,{ref:t,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},fC(e,m=>K.createElement("div",{"aria-hidden":!0},m)))}),B0=Object.assign(YJ,{List:pke,Item:uke,Input:fke,Group:hke,Separator:dke,Dialog:mke,Empty:gke,Loading:yke});function _ke(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function vke(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function KJ(e){let t=K.useRef(e);return rv(()=>{t.current=e}),t}var rv=typeof window>"u"?K.useEffect:K.useLayoutEffect;function yx(e){let t=K.useRef();return t.current===void 0&&(t.current=e()),t}function py(e){let t=gj(),n=()=>e(t.snapshot());return K.useSyncExternalStore(t.subscribe,n,n)}function JJ(e,t,n,i=[]){let c=K.useRef(),d=fS();return rv(()=>{var m;let a=(()=>{var S;for(let M of n){if(typeof M=="string")return M.trim();if(typeof M=="object"&&"current"in M)return M.current?(S=M.current.textContent)==null?void 0:S.trim():c.current}})(),w=i.map(S=>S.trim());d.value(e,a,w),(m=t.current)==null||m.setAttribute(gx,a),c.current=a}),c}var xke=()=>{let[e,t]=K.useState(),n=yx(()=>new Map);return rv(()=>{n.current.forEach(i=>i()),n.current=new Map},[e]),(i,c)=>{n.current.set(i,c),t({})}};function bke(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function fC({asChild:e,children:t},n){return e&&K.isValidElement(t)?K.cloneElement(bke(t),{ref:t.ref},n(t.props.children)):n(t)}var wke={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function yj({className:e,...t}){return D.jsx(B0,{"data-slot":"command",className:bn("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function _j({className:e,...t}){return D.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[D.jsx(Zse,{className:"size-4 shrink-0 opacity-50"}),D.jsx(B0.Input,{"data-slot":"command-input",className:bn("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function vj({className:e,...t}){return D.jsx(B0.List,{"data-slot":"command-list",className:bn("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function xj({...e}){return D.jsx(B0.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function bj({className:e,...t}){return D.jsx(B0.Group,{"data-slot":"command-group",className:bn("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function wj({className:e,...t}){return D.jsx(B0.Item,{"data-slot":"command-item",className:bn("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function jH(e,[t,n]){return Math.min(n,Math.max(t,e))}function QJ({value:e,onChange:t,startYear:n,endYear:i,descending:c=!0,placeholder:d="Select year",className:m,defaultValue:a,disabled:w}){const[S,M]=K.useState(!1),P=new Date().getFullYear(),N=n??1800,$=i??P,G=K.useMemo(()=>{const V=[];for(let J=N;J<=$;J++)V.push(J);return c?V.reverse():V},[N,$,c]),q=e??a??d;return D.jsxs(uS,{open:S,onOpenChange:M,children:[D.jsx(hS,{asChild:!0,children:D.jsxs(na,{variant:"outline",role:"combobox","aria-expanded":S,className:bn(m,"w-full justify-between"),disabled:w,children:[q,D.jsx(n2,{className:"ml-2 h-4 w-4 opacity-50"})]})}),D.jsx(dS,{className:"p-0",onWheel:V=>V.stopPropagation(),children:D.jsxs(yj,{children:[D.jsx(_j,{placeholder:"Search year..."}),D.jsxs(vj,{className:"max-h-[200px] overflow-y-scroll",children:[D.jsx(xj,{children:"No year found."}),D.jsx(bj,{children:G.map(V=>D.jsxs(wj,{value:V.toString(),onSelect:()=>{t?.(V),M(!1)},children:[D.jsx(e2,{className:bn("mr-2 h-4 w-4",e===V?"opacity-100":"opacity-0")}),V]},V))})]})]})})]})}var pS=e=>e.type==="checkbox",U_=e=>e instanceof Date,Rc=e=>e==null;const eQ=e=>typeof e=="object";var As=e=>!Rc(e)&&!Array.isArray(e)&&eQ(e)&&!U_(e),tQ=e=>As(e)&&e.target?pS(e.target)?e.target.checked:e.target.value:e,Ske=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,nQ=(e,t)=>e.has(Ske(t)),Tke=e=>{const t=e.constructor&&e.constructor.prototype;return As(t)&&t.hasOwnProperty("isPrototypeOf")},Sj=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Lo(e){let t;const n=Array.isArray(e),i=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(Sj&&(e instanceof Blob||i))&&(n||As(e)))if(t=n?[]:Object.create(Object.getPrototypeOf(e)),!n&&!Tke(e))t=e;else for(const c in e)e.hasOwnProperty(c)&&(t[c]=Lo(e[c]));else return e;return t}var pC=e=>/^\w*$/.test(e),zo=e=>e===void 0,mC=e=>Array.isArray(e)?e.filter(Boolean):[],Tj=e=>mC(e.replace(/["|']|\]/g,"").split(/\.|\[/)),cr=(e,t,n)=>{if(!t||!As(e))return n;const i=(pC(t)?[t]:Tj(t)).reduce((c,d)=>Rc(c)?c:c[d],e);return zo(i)||i===e?zo(e[t])?n:e[t]:i},Qu=e=>typeof e=="boolean",ro=(e,t,n)=>{let i=-1;const c=pC(t)?[t]:Tj(t),d=c.length,m=d-1;for(;++i<d;){const a=c[i];let w=n;if(i!==m){const S=e[a];w=As(S)||Array.isArray(S)?S:isNaN(+c[i+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;e[a]=w,e=e[a]}};const RA={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Xh={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Tm={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},rQ=Ce.createContext(null);rQ.displayName="HookFormContext";const gC=()=>Ce.useContext(rQ);var iQ=(e,t,n,i=!0)=>{const c={defaultValues:t._defaultValues};for(const d in e)Object.defineProperty(c,d,{get:()=>{const m=d;return t._proxyFormState[m]!==Xh.all&&(t._proxyFormState[m]=!i||Xh.all),n&&(n[m]=!0),e[m]}});return c};const yC=typeof window<"u"?Ce.useLayoutEffect:Ce.useEffect;function Eke(e){const t=gC(),{control:n=t.control,disabled:i,name:c,exact:d}=e||{},[m,a]=Ce.useState(n._formState),w=Ce.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return yC(()=>n._subscribe({name:c,formState:w.current,exact:d,callback:S=>{!i&&a({...n._formState,...S})}}),[c,i,d]),Ce.useEffect(()=>{w.current.isValid&&n._setValid(!0)},[n]),Ce.useMemo(()=>iQ(m,n,w.current,!1),[m,n])}var op=e=>typeof e=="string",aQ=(e,t,n,i,c)=>op(e)?(i&&t.watch.add(e),cr(n,e,c)):Array.isArray(e)?e.map(d=>(i&&t.watch.add(d),cr(n,d))):(i&&(t.watchAll=!0),n),zL=e=>Rc(e)||!eQ(e);function Em(e,t,n=new WeakSet){if(zL(e)||zL(t))return e===t;if(U_(e)&&U_(t))return e.getTime()===t.getTime();const i=Object.keys(e),c=Object.keys(t);if(i.length!==c.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const d of i){const m=e[d];if(!c.includes(d))return!1;if(d!=="ref"){const a=t[d];if(U_(m)&&U_(a)||As(m)&&As(a)||Array.isArray(m)&&Array.isArray(a)?!Em(m,a,n):m!==a)return!1}}return!0}function Ake(e){const t=gC(),{control:n=t.control,name:i,defaultValue:c,disabled:d,exact:m,compute:a}=e||{},w=Ce.useRef(c),S=Ce.useRef(a),M=Ce.useRef(void 0);S.current=a;const P=Ce.useMemo(()=>n._getWatch(i,w.current),[n,i]),[N,$]=Ce.useState(S.current?S.current(P):P);return yC(()=>n._subscribe({name:i,formState:{values:!0},exact:m,callback:G=>{if(!d){const q=aQ(i,n._names,G.values||n._formValues,!1,w.current);if(S.current){const V=S.current(q);Em(V,M.current)||($(V),M.current=V)}else $(q)}}}),[n,d,i,m]),Ce.useEffect(()=>n._removeUnmounted()),N}function Cke(e){const t=gC(),{name:n,disabled:i,control:c=t.control,shouldUnregister:d,defaultValue:m}=e,a=nQ(c._names.array,n),w=Ce.useMemo(()=>cr(c._formValues,n,cr(c._defaultValues,n,m)),[c,n,m]),S=Ake({control:c,name:n,defaultValue:w,exact:!0}),M=Eke({control:c,name:n,exact:!0}),P=Ce.useRef(e),N=Ce.useRef(c.register(n,{...e.rules,value:S,...Qu(e.disabled)?{disabled:e.disabled}:{}}));P.current=e;const $=Ce.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!cr(M.errors,n)},isDirty:{enumerable:!0,get:()=>!!cr(M.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!cr(M.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!cr(M.validatingFields,n)},error:{enumerable:!0,get:()=>cr(M.errors,n)}}),[M,n]),G=Ce.useCallback(ee=>N.current.onChange({target:{value:tQ(ee),name:n},type:RA.CHANGE}),[n]),q=Ce.useCallback(()=>N.current.onBlur({target:{value:cr(c._formValues,n),name:n},type:RA.BLUR}),[n,c._formValues]),V=Ce.useCallback(ee=>{const re=cr(c._fields,n);re&&ee&&(re._f.ref={focus:()=>ee.focus&&ee.focus(),select:()=>ee.select&&ee.select(),setCustomValidity:fe=>ee.setCustomValidity(fe),reportValidity:()=>ee.reportValidity()})},[c._fields,n]),J=Ce.useMemo(()=>({name:n,value:S,...Qu(i)||M.disabled?{disabled:M.disabled||i}:{},onChange:G,onBlur:q,ref:V}),[n,i,M.disabled,G,q,V,S]);return Ce.useEffect(()=>{const ee=c._options.shouldUnregister||d;c.register(n,{...P.current.rules,...Qu(P.current.disabled)?{disabled:P.current.disabled}:{}});const re=(fe,ne)=>{const ce=cr(c._fields,fe);ce&&ce._f&&(ce._f.mount=ne)};if(re(n,!0),ee){const fe=Lo(cr(c._options.defaultValues,n));ro(c._defaultValues,n,fe),zo(cr(c._formValues,n))&&ro(c._formValues,n,fe)}return!a&&c.register(n),()=>{(a?ee&&!c._state.action:ee)?c.unregister(n):re(n,!1)}},[n,c,a,d]),Ce.useEffect(()=>{c._setDisabledField({disabled:i,name:n})},[i,n,c]),Ce.useMemo(()=>({field:J,formState:M,fieldState:$}),[J,M,$])}const iv=e=>e.render(Cke(e));var Mke=(e,t,n,i,c)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[i]:c||!0}}:{},cu=e=>Array.isArray(e)?e:[e],BH=()=>{let e=[];return{get observers(){return e},next:c=>{for(const d of e)d.next&&d.next(c)},subscribe:c=>(e.push(c),{unsubscribe:()=>{e=e.filter(d=>d!==c)}}),unsubscribe:()=>{e=[]}}},Oc=e=>As(e)&&!Object.keys(e).length,Ej=e=>e.type==="file",Gd=e=>typeof e=="function",IA=e=>{if(!Sj)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},oQ=e=>e.type==="select-multiple",Aj=e=>e.type==="radio",Pke=e=>Aj(e)||pS(e),mD=e=>IA(e)&&e.isConnected;function Oke(e,t){const n=t.slice(0,-1).length;let i=0;for(;i<n;)e=zo(e)?i++:e[t[i++]];return e}function Rke(e){for(const t in e)if(e.hasOwnProperty(t)&&!zo(e[t]))return!1;return!0}function Ts(e,t){const n=Array.isArray(t)?t:pC(t)?[t]:Tj(t),i=n.length===1?e:Oke(e,n),c=n.length-1,d=n[c];return i&&delete i[d],c!==0&&(As(i)&&Oc(i)||Array.isArray(i)&&Rke(i))&&Ts(e,n.slice(0,-1)),e}var sQ=e=>{for(const t in e)if(Gd(e[t]))return!0;return!1};function DA(e,t={}){const n=Array.isArray(e);if(As(e)||n)for(const i in e)Array.isArray(e[i])||As(e[i])&&!sQ(e[i])?(t[i]=Array.isArray(e[i])?[]:{},DA(e[i],t[i])):Rc(e[i])||(t[i]=!0);return t}function lQ(e,t,n){const i=Array.isArray(e);if(As(e)||i)for(const c in e)Array.isArray(e[c])||As(e[c])&&!sQ(e[c])?zo(t)||zL(n[c])?n[c]=Array.isArray(e[c])?DA(e[c],[]):{...DA(e[c])}:lQ(e[c],Rc(t)?{}:t[c],n[c]):n[c]=!Em(e[c],t[c]);return n}var cw=(e,t)=>lQ(e,t,DA(t));const FH={value:!1,isValid:!1},VH={value:!0,isValid:!0};var cQ=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!zo(e[0].attributes.value)?zo(e[0].value)||e[0].value===""?VH:{value:e[0].value,isValid:!0}:VH:FH}return FH},uQ=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:i})=>zo(e)?e:t?e===""?NaN:e&&+e:n&&op(e)?new Date(e):i?i(e):e;const UH={isValid:!1,value:null};var hQ=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,UH):UH;function $H(e){const t=e.ref;return Ej(t)?t.files:Aj(t)?hQ(e.refs).value:oQ(t)?[...t.selectedOptions].map(({value:n})=>n):pS(t)?cQ(e.refs).value:uQ(zo(t.value)?e.ref.value:t.value,e)}var Ike=(e,t,n,i)=>{const c={};for(const d of e){const m=cr(t,d);m&&ro(c,d,m._f)}return{criteriaMode:n,names:[...e],fields:c,shouldUseNativeValidation:i}},kA=e=>e instanceof RegExp,uw=e=>zo(e)?e:kA(e)?e.source:As(e)?kA(e.value)?e.value.source:e.value:e,Mx=e=>({isOnSubmit:!e||e===Xh.onSubmit,isOnBlur:e===Xh.onBlur,isOnChange:e===Xh.onChange,isOnAll:e===Xh.all,isOnTouch:e===Xh.onTouched});const qH="AsyncFunction";var Dke=e=>!!e&&!!e.validate&&!!(Gd(e.validate)&&e.validate.constructor.name===qH||As(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===qH)),kke=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),jL=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const zx=(e,t,n,i)=>{for(const c of n||Object.keys(e)){const d=cr(e,c);if(d){const{_f:m,...a}=d;if(m){if(m.refs&&m.refs[0]&&t(m.refs[0],c)&&!i)return!0;if(m.ref&&t(m.ref,m.name)&&!i)return!0;if(zx(a,t))break}else if(As(a)&&zx(a,t))break}}};function HH(e,t,n){const i=cr(e,n);if(i||pC(n))return{error:i,name:n};const c=n.split(".");for(;c.length;){const d=c.join("."),m=cr(t,d),a=cr(e,d);if(m&&!Array.isArray(m)&&n!==d)return{name:n};if(a&&a.type)return{name:d,error:a};if(a&&a.root&&a.root.type)return{name:`${d}.root`,error:a.root};c.pop()}return{name:n}}var Lke=(e,t,n,i)=>{n(e);const{name:c,...d}=e;return Oc(d)||Object.keys(d).length>=Object.keys(t).length||Object.keys(d).find(m=>t[m]===(!i||Xh.all))},Nke=(e,t,n)=>!e||!t||e===t||cu(e).some(i=>i&&(n?i===t:i.startsWith(t)||t.startsWith(i))),zke=(e,t,n,i,c)=>c.isOnAll?!1:!n&&c.isOnTouch?!(t||e):(n?i.isOnBlur:c.isOnBlur)?!e:(n?i.isOnChange:c.isOnChange)?e:!0,jke=(e,t)=>!mC(cr(e,t)).length&&Ts(e,t),dQ=(e,t,n)=>{const i=cu(cr(e,n));return ro(i,"root",t[n]),ro(e,n,i),e},dE=e=>op(e);function GH(e,t,n="validate"){if(dE(e)||Array.isArray(e)&&e.every(dE)||Qu(e)&&!e)return{type:n,message:dE(e)?e:"",ref:t}}var px=e=>As(e)&&!kA(e)?e:{value:e,message:""},BL=async(e,t,n,i,c,d)=>{const{ref:m,refs:a,required:w,maxLength:S,minLength:M,min:P,max:N,pattern:$,validate:G,name:q,valueAsNumber:V,mount:J}=e._f,ee=cr(n,q);if(!J||t.has(q))return{};const re=a?a[0]:m,fe=tt=>{c&&re.reportValidity&&(re.setCustomValidity(Qu(tt)?"":tt||""),re.reportValidity())},ne={},ce=Aj(m),me=pS(m),ve=ce||me,De=(V||Ej(m))&&zo(m.value)&&zo(ee)||IA(m)&&m.value===""||ee===""||Array.isArray(ee)&&!ee.length,Ye=Mke.bind(null,q,i,ne),ze=(tt,at,ct,ht=Tm.maxLength,Ie=Tm.minLength)=>{const rt=tt?at:ct;ne[q]={type:tt?ht:Ie,message:rt,ref:m,...Ye(tt?ht:Ie,rt)}};if(d?!Array.isArray(ee)||!ee.length:w&&(!ve&&(De||Rc(ee))||Qu(ee)&&!ee||me&&!cQ(a).isValid||ce&&!hQ(a).isValid)){const{value:tt,message:at}=dE(w)?{value:!!w,message:w}:px(w);if(tt&&(ne[q]={type:Tm.required,message:at,ref:re,...Ye(Tm.required,at)},!i))return fe(at),ne}if(!De&&(!Rc(P)||!Rc(N))){let tt,at;const ct=px(N),ht=px(P);if(!Rc(ee)&&!isNaN(ee)){const Ie=m.valueAsNumber||ee&&+ee;Rc(ct.value)||(tt=Ie>ct.value),Rc(ht.value)||(at=Ie<ht.value)}else{const Ie=m.valueAsDate||new Date(ee),rt=qe=>new Date(new Date().toDateString()+" "+qe),Qe=m.type=="time",St=m.type=="week";op(ct.value)&&ee&&(tt=Qe?rt(ee)>rt(ct.value):St?ee>ct.value:Ie>new Date(ct.value)),op(ht.value)&&ee&&(at=Qe?rt(ee)<rt(ht.value):St?ee<ht.value:Ie<new Date(ht.value))}if((tt||at)&&(ze(!!tt,ct.message,ht.message,Tm.max,Tm.min),!i))return fe(ne[q].message),ne}if((S||M)&&!De&&(op(ee)||d&&Array.isArray(ee))){const tt=px(S),at=px(M),ct=!Rc(tt.value)&&ee.length>+tt.value,ht=!Rc(at.value)&&ee.length<+at.value;if((ct||ht)&&(ze(ct,tt.message,at.message),!i))return fe(ne[q].message),ne}if($&&!De&&op(ee)){const{value:tt,message:at}=px($);if(kA(tt)&&!ee.match(tt)&&(ne[q]={type:Tm.pattern,message:at,ref:m,...Ye(Tm.pattern,at)},!i))return fe(at),ne}if(G){if(Gd(G)){const tt=await G(ee,n),at=GH(tt,re);if(at&&(ne[q]={...at,...Ye(Tm.validate,at.message)},!i))return fe(at.message),ne}else if(As(G)){let tt={};for(const at in G){if(!Oc(tt)&&!i)break;const ct=GH(await G[at](ee,n),re,at);ct&&(tt={...ct,...Ye(at,ct.message)},fe(ct.message),i&&(ne[q]=tt))}if(!Oc(tt)&&(ne[q]={ref:re,...tt},!i))return ne}}return fe(!0),ne};const Bke={mode:Xh.onSubmit,reValidateMode:Xh.onChange,shouldFocusError:!0};function Fke(e={}){let t={...Bke,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Gd(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},c=As(t.defaultValues)||As(t.values)?Lo(t.defaultValues||t.values)||{}:{},d=t.shouldUnregister?{}:Lo(c),m={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},w,S=0;const M={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let P={...M};const N={array:BH(),state:BH()},$=t.criteriaMode===Xh.all,G=xt=>Bt=>{clearTimeout(S),S=setTimeout(xt,Bt)},q=async xt=>{if(!t.disabled&&(M.isValid||P.isValid||xt)){const Bt=t.resolver?Oc((await me()).errors):await De(i,!0);Bt!==n.isValid&&N.state.next({isValid:Bt})}},V=(xt,Bt)=>{!t.disabled&&(M.isValidating||M.validatingFields||P.isValidating||P.validatingFields)&&((xt||Array.from(a.mount)).forEach(tn=>{tn&&(Bt?ro(n.validatingFields,tn,Bt):Ts(n.validatingFields,tn))}),N.state.next({validatingFields:n.validatingFields,isValidating:!Oc(n.validatingFields)}))},J=(xt,Bt=[],tn,$n,qn=!0,An=!0)=>{if($n&&tn&&!t.disabled){if(m.action=!0,An&&Array.isArray(cr(i,xt))){const tr=tn(cr(i,xt),$n.argA,$n.argB);qn&&ro(i,xt,tr)}if(An&&Array.isArray(cr(n.errors,xt))){const tr=tn(cr(n.errors,xt),$n.argA,$n.argB);qn&&ro(n.errors,xt,tr),jke(n.errors,xt)}if((M.touchedFields||P.touchedFields)&&An&&Array.isArray(cr(n.touchedFields,xt))){const tr=tn(cr(n.touchedFields,xt),$n.argA,$n.argB);qn&&ro(n.touchedFields,xt,tr)}(M.dirtyFields||P.dirtyFields)&&(n.dirtyFields=cw(c,d)),N.state.next({name:xt,isDirty:ze(xt,Bt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else ro(d,xt,Bt)},ee=(xt,Bt)=>{ro(n.errors,xt,Bt),N.state.next({errors:n.errors})},re=xt=>{n.errors=xt,N.state.next({errors:n.errors,isValid:!1})},fe=(xt,Bt,tn,$n)=>{const qn=cr(i,xt);if(qn){const An=cr(d,xt,zo(tn)?cr(c,xt):tn);zo(An)||$n&&$n.defaultChecked||Bt?ro(d,xt,Bt?An:$H(qn._f)):ct(xt,An),m.mount&&q()}},ne=(xt,Bt,tn,$n,qn)=>{let An=!1,tr=!1;const Ir={name:xt};if(!t.disabled){if(!tn||$n){(M.isDirty||P.isDirty)&&(tr=n.isDirty,n.isDirty=Ir.isDirty=ze(),An=tr!==Ir.isDirty);const mi=Em(cr(c,xt),Bt);tr=!!cr(n.dirtyFields,xt),mi?Ts(n.dirtyFields,xt):ro(n.dirtyFields,xt,!0),Ir.dirtyFields=n.dirtyFields,An=An||(M.dirtyFields||P.dirtyFields)&&tr!==!mi}if(tn){const mi=cr(n.touchedFields,xt);mi||(ro(n.touchedFields,xt,tn),Ir.touchedFields=n.touchedFields,An=An||(M.touchedFields||P.touchedFields)&&mi!==tn)}An&&qn&&N.state.next(Ir)}return An?Ir:{}},ce=(xt,Bt,tn,$n)=>{const qn=cr(n.errors,xt),An=(M.isValid||P.isValid)&&Qu(Bt)&&n.isValid!==Bt;if(t.delayError&&tn?(w=G(()=>ee(xt,tn)),w(t.delayError)):(clearTimeout(S),w=null,tn?ro(n.errors,xt,tn):Ts(n.errors,xt)),(tn?!Em(qn,tn):qn)||!Oc($n)||An){const tr={...$n,...An&&Qu(Bt)?{isValid:Bt}:{},errors:n.errors,name:xt};n={...n,...tr},N.state.next(tr)}},me=async xt=>{V(xt,!0);const Bt=await t.resolver(d,t.context,Ike(xt||a.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return V(xt),Bt},ve=async xt=>{const{errors:Bt}=await me(xt);if(xt)for(const tn of xt){const $n=cr(Bt,tn);$n?ro(n.errors,tn,$n):Ts(n.errors,tn)}else n.errors=Bt;return Bt},De=async(xt,Bt,tn={valid:!0})=>{for(const $n in xt){const qn=xt[$n];if(qn){const{_f:An,...tr}=qn;if(An){const Ir=a.array.has(An.name),mi=qn._f&&Dke(qn._f);mi&&M.validatingFields&&V([$n],!0);const Mi=await BL(qn,a.disabled,d,$,t.shouldUseNativeValidation&&!Bt,Ir);if(mi&&M.validatingFields&&V([$n]),Mi[An.name]&&(tn.valid=!1,Bt))break;!Bt&&(cr(Mi,An.name)?Ir?dQ(n.errors,Mi,An.name):ro(n.errors,An.name,Mi[An.name]):Ts(n.errors,An.name))}!Oc(tr)&&await De(tr,Bt,tn)}}return tn.valid},Ye=()=>{for(const xt of a.unMount){const Bt=cr(i,xt);Bt&&(Bt._f.refs?Bt._f.refs.every(tn=>!mD(tn)):!mD(Bt._f.ref))&&Ht(xt)}a.unMount=new Set},ze=(xt,Bt)=>!t.disabled&&(xt&&Bt&&ro(d,xt,Bt),!Em(qe(),c)),tt=(xt,Bt,tn)=>aQ(xt,a,{...m.mount?d:zo(Bt)?c:op(xt)?{[xt]:Bt}:Bt},tn,Bt),at=xt=>mC(cr(m.mount?d:c,xt,t.shouldUnregister?cr(c,xt,[]):[])),ct=(xt,Bt,tn={})=>{const $n=cr(i,xt);let qn=Bt;if($n){const An=$n._f;An&&(!An.disabled&&ro(d,xt,uQ(Bt,An)),qn=IA(An.ref)&&Rc(Bt)?"":Bt,oQ(An.ref)?[...An.ref.options].forEach(tr=>tr.selected=qn.includes(tr.value)):An.refs?pS(An.ref)?An.refs.forEach(tr=>{(!tr.defaultChecked||!tr.disabled)&&(Array.isArray(qn)?tr.checked=!!qn.find(Ir=>Ir===tr.value):tr.checked=qn===tr.value||!!qn)}):An.refs.forEach(tr=>tr.checked=tr.value===qn):Ej(An.ref)?An.ref.value="":(An.ref.value=qn,An.ref.type||N.state.next({name:xt,values:Lo(d)})))}(tn.shouldDirty||tn.shouldTouch)&&ne(xt,qn,tn.shouldTouch,tn.shouldDirty,!0),tn.shouldValidate&&St(xt)},ht=(xt,Bt,tn)=>{for(const $n in Bt){if(!Bt.hasOwnProperty($n))return;const qn=Bt[$n],An=xt+"."+$n,tr=cr(i,An);(a.array.has(xt)||As(qn)||tr&&!tr._f)&&!U_(qn)?ht(An,qn,tn):ct(An,qn,tn)}},Ie=(xt,Bt,tn={})=>{const $n=cr(i,xt),qn=a.array.has(xt),An=Lo(Bt);ro(d,xt,An),qn?(N.array.next({name:xt,values:Lo(d)}),(M.isDirty||M.dirtyFields||P.isDirty||P.dirtyFields)&&tn.shouldDirty&&N.state.next({name:xt,dirtyFields:cw(c,d),isDirty:ze(xt,An)})):$n&&!$n._f&&!Rc(An)?ht(xt,An,tn):ct(xt,An,tn),jL(xt,a)&&N.state.next({...n,name:xt}),N.state.next({name:m.mount?xt:void 0,values:Lo(d)})},rt=async xt=>{m.mount=!0;const Bt=xt.target;let tn=Bt.name,$n=!0;const qn=cr(i,tn),An=mi=>{$n=Number.isNaN(mi)||U_(mi)&&isNaN(mi.getTime())||Em(mi,cr(d,tn,mi))},tr=Mx(t.mode),Ir=Mx(t.reValidateMode);if(qn){let mi,Mi;const _o=Bt.type?$H(qn._f):tQ(xt),oa=xt.type===RA.BLUR||xt.type===RA.FOCUS_OUT,Ua=!kke(qn._f)&&!t.resolver&&!cr(n.errors,tn)&&!qn._f.deps||zke(oa,cr(n.touchedFields,tn),n.isSubmitted,Ir,tr),lo=jL(tn,a,oa);ro(d,tn,_o),oa?(!Bt||!Bt.readOnly)&&(qn._f.onBlur&&qn._f.onBlur(xt),w&&w(0)):qn._f.onChange&&qn._f.onChange(xt);const eo=ne(tn,_o,oa),co=!Oc(eo)||lo;if(!oa&&N.state.next({name:tn,type:xt.type,values:Lo(d)}),Ua)return(M.isValid||P.isValid)&&(t.mode==="onBlur"?oa&&q():oa||q()),co&&N.state.next({name:tn,...lo?{}:eo});if(!oa&&lo&&N.state.next({...n}),t.resolver){const{errors:vo}=await me([tn]);if(An(_o),$n){const ss=HH(n.errors,i,tn),ir=HH(vo,i,ss.name||tn);mi=ir.error,tn=ir.name,Mi=Oc(vo)}}else V([tn],!0),mi=(await BL(qn,a.disabled,d,$,t.shouldUseNativeValidation))[tn],V([tn]),An(_o),$n&&(mi?Mi=!1:(M.isValid||P.isValid)&&(Mi=await De(i,!0)));$n&&(qn._f.deps&&St(qn._f.deps),ce(tn,Mi,mi,eo))}},Qe=(xt,Bt)=>{if(cr(n.errors,Bt)&&xt.focus)return xt.focus(),1},St=async(xt,Bt={})=>{let tn,$n;const qn=cu(xt);if(t.resolver){const An=await ve(zo(xt)?xt:qn);tn=Oc(An),$n=xt?!qn.some(tr=>cr(An,tr)):tn}else xt?($n=(await Promise.all(qn.map(async An=>{const tr=cr(i,An);return await De(tr&&tr._f?{[An]:tr}:tr)}))).every(Boolean),!(!$n&&!n.isValid)&&q()):$n=tn=await De(i);return N.state.next({...!op(xt)||(M.isValid||P.isValid)&&tn!==n.isValid?{}:{name:xt},...t.resolver||!xt?{isValid:tn}:{},errors:n.errors}),Bt.shouldFocus&&!$n&&zx(i,Qe,xt?qn:a.mount),$n},qe=xt=>{const Bt={...m.mount?d:c};return zo(xt)?Bt:op(xt)?cr(Bt,xt):xt.map(tn=>cr(Bt,tn))},vt=(xt,Bt)=>({invalid:!!cr((Bt||n).errors,xt),isDirty:!!cr((Bt||n).dirtyFields,xt),error:cr((Bt||n).errors,xt),isValidating:!!cr(n.validatingFields,xt),isTouched:!!cr((Bt||n).touchedFields,xt)}),nt=xt=>{xt&&cu(xt).forEach(Bt=>Ts(n.errors,Bt)),N.state.next({errors:xt?n.errors:{}})},gt=(xt,Bt,tn)=>{const $n=(cr(i,xt,{_f:{}})._f||{}).ref,qn=cr(n.errors,xt)||{},{ref:An,message:tr,type:Ir,...mi}=qn;ro(n.errors,xt,{...mi,...Bt,ref:$n}),N.state.next({name:xt,errors:n.errors,isValid:!1}),tn&&tn.shouldFocus&&$n&&$n.focus&&$n.focus()},Ut=(xt,Bt)=>Gd(xt)?N.state.subscribe({next:tn=>"values"in tn&&xt(tt(void 0,Bt),tn)}):tt(xt,Bt,!0),$t=xt=>N.state.subscribe({next:Bt=>{Nke(xt.name,Bt.name,xt.exact)&&Lke(Bt,xt.formState||M,hi,xt.reRenderRoot)&&xt.callback({values:{...d},...n,...Bt,defaultValues:c})}}).unsubscribe,qt=xt=>(m.mount=!0,P={...P,...xt.formState},$t({...xt,formState:P})),Ht=(xt,Bt={})=>{for(const tn of xt?cu(xt):a.mount)a.mount.delete(tn),a.array.delete(tn),Bt.keepValue||(Ts(i,tn),Ts(d,tn)),!Bt.keepError&&Ts(n.errors,tn),!Bt.keepDirty&&Ts(n.dirtyFields,tn),!Bt.keepTouched&&Ts(n.touchedFields,tn),!Bt.keepIsValidating&&Ts(n.validatingFields,tn),!t.shouldUnregister&&!Bt.keepDefaultValue&&Ts(c,tn);N.state.next({values:Lo(d)}),N.state.next({...n,...Bt.keepDirty?{isDirty:ze()}:{}}),!Bt.keepIsValid&&q()},mn=({disabled:xt,name:Bt})=>{(Qu(xt)&&m.mount||xt||a.disabled.has(Bt))&&(xt?a.disabled.add(Bt):a.disabled.delete(Bt))},en=(xt,Bt={})=>{let tn=cr(i,xt);const $n=Qu(Bt.disabled)||Qu(t.disabled);return ro(i,xt,{...tn||{},_f:{...tn&&tn._f?tn._f:{ref:{name:xt}},name:xt,mount:!0,...Bt}}),a.mount.add(xt),tn?mn({disabled:Qu(Bt.disabled)?Bt.disabled:t.disabled,name:xt}):fe(xt,!0,Bt.value),{...$n?{disabled:Bt.disabled||t.disabled}:{},...t.progressive?{required:!!Bt.required,min:uw(Bt.min),max:uw(Bt.max),minLength:uw(Bt.minLength),maxLength:uw(Bt.maxLength),pattern:uw(Bt.pattern)}:{},name:xt,onChange:rt,onBlur:rt,ref:qn=>{if(qn){en(xt,Bt),tn=cr(i,xt);const An=zo(qn.value)&&qn.querySelectorAll&&qn.querySelectorAll("input,select,textarea")[0]||qn,tr=Pke(An),Ir=tn._f.refs||[];if(tr?Ir.find(mi=>mi===An):An===tn._f.ref)return;ro(i,xt,{_f:{...tn._f,...tr?{refs:[...Ir.filter(mD),An,...Array.isArray(cr(c,xt))?[{}]:[]],ref:{type:An.type,name:xt}}:{ref:An}}}),fe(xt,!1,void 0,An)}else tn=cr(i,xt,{}),tn._f&&(tn._f.mount=!1),(t.shouldUnregister||Bt.shouldUnregister)&&!(nQ(a.array,xt)&&m.action)&&a.unMount.add(xt)}}},En=()=>t.shouldFocusError&&zx(i,Qe,a.mount),Xn=xt=>{Qu(xt)&&(N.state.next({disabled:xt}),zx(i,(Bt,tn)=>{const $n=cr(i,tn);$n&&(Bt.disabled=$n._f.disabled||xt,Array.isArray($n._f.refs)&&$n._f.refs.forEach(qn=>{qn.disabled=$n._f.disabled||xt}))},0,!1))},cn=(xt,Bt)=>async tn=>{let $n;tn&&(tn.preventDefault&&tn.preventDefault(),tn.persist&&tn.persist());let qn=Lo(d);if(N.state.next({isSubmitting:!0}),t.resolver){const{errors:An,values:tr}=await me();n.errors=An,qn=Lo(tr)}else await De(i);if(a.disabled.size)for(const An of a.disabled)Ts(qn,An);if(Ts(n.errors,"root"),Oc(n.errors)){N.state.next({errors:{}});try{await xt(qn,tn)}catch(An){$n=An}}else Bt&&await Bt({...n.errors},tn),En(),setTimeout(En);if(N.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Oc(n.errors)&&!$n,submitCount:n.submitCount+1,errors:n.errors}),$n)throw $n},Jr=(xt,Bt={})=>{cr(i,xt)&&(zo(Bt.defaultValue)?Ie(xt,Lo(cr(c,xt))):(Ie(xt,Bt.defaultValue),ro(c,xt,Lo(Bt.defaultValue))),Bt.keepTouched||Ts(n.touchedFields,xt),Bt.keepDirty||(Ts(n.dirtyFields,xt),n.isDirty=Bt.defaultValue?ze(xt,Lo(cr(c,xt))):ze()),Bt.keepError||(Ts(n.errors,xt),M.isValid&&q()),N.state.next({...n}))},mr=(xt,Bt={})=>{const tn=xt?Lo(xt):c,$n=Lo(tn),qn=Oc(xt),An=qn?c:$n;if(Bt.keepDefaultValues||(c=tn),!Bt.keepValues){if(Bt.keepDirtyValues){const tr=new Set([...a.mount,...Object.keys(cw(c,d))]);for(const Ir of Array.from(tr))cr(n.dirtyFields,Ir)?ro(An,Ir,cr(d,Ir)):Ie(Ir,cr(An,Ir))}else{if(Sj&&zo(xt))for(const tr of a.mount){const Ir=cr(i,tr);if(Ir&&Ir._f){const mi=Array.isArray(Ir._f.refs)?Ir._f.refs[0]:Ir._f.ref;if(IA(mi)){const Mi=mi.closest("form");if(Mi){Mi.reset();break}}}}if(Bt.keepFieldsRef)for(const tr of a.mount)Ie(tr,cr(An,tr));else i={}}d=t.shouldUnregister?Bt.keepDefaultValues?Lo(c):{}:Lo(An),N.array.next({values:{...An}}),N.state.next({values:{...An}})}a={mount:Bt.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},m.mount=!M.isValid||!!Bt.keepIsValid||!!Bt.keepDirtyValues,m.watch=!!t.shouldUnregister,N.state.next({submitCount:Bt.keepSubmitCount?n.submitCount:0,isDirty:qn?!1:Bt.keepDirty?n.isDirty:!!(Bt.keepDefaultValues&&!Em(xt,c)),isSubmitted:Bt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:qn?{}:Bt.keepDirtyValues?Bt.keepDefaultValues&&d?cw(c,d):n.dirtyFields:Bt.keepDefaultValues&&xt?cw(c,xt):Bt.keepDirty?n.dirtyFields:{},touchedFields:Bt.keepTouched?n.touchedFields:{},errors:Bt.keepErrors?n.errors:{},isSubmitSuccessful:Bt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:c})},Cr=(xt,Bt)=>mr(Gd(xt)?xt(d):xt,Bt),li=(xt,Bt={})=>{const tn=cr(i,xt),$n=tn&&tn._f;if($n){const qn=$n.refs?$n.refs[0]:$n.ref;qn.focus&&(qn.focus(),Bt.shouldSelect&&Gd(qn.select)&&qn.select())}},hi=xt=>{n={...n,...xt}},ra={control:{register:en,unregister:Ht,getFieldState:vt,handleSubmit:cn,setError:gt,_subscribe:$t,_runSchema:me,_focusError:En,_getWatch:tt,_getDirty:ze,_setValid:q,_setFieldArray:J,_setDisabledField:mn,_setErrors:re,_getFieldArray:at,_reset:mr,_resetDefaultValues:()=>Gd(t.defaultValues)&&t.defaultValues().then(xt=>{Cr(xt,t.resetOptions),N.state.next({isLoading:!1})}),_removeUnmounted:Ye,_disableForm:Xn,_subjects:N,_proxyFormState:M,get _fields(){return i},get _formValues(){return d},get _state(){return m},set _state(xt){m=xt},get _defaultValues(){return c},get _names(){return a},set _names(xt){a=xt},get _formState(){return n},get _options(){return t},set _options(xt){t={...t,...xt}}},subscribe:qt,trigger:St,register:en,handleSubmit:cn,watch:Ut,setValue:Ie,getValues:qe,reset:Cr,resetField:Jr,clearErrors:nt,unregister:Ht,setError:gt,setFocus:li,getFieldState:vt};return{...ra,formControl:ra}}var Yg=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(Math.random()*16+e)%16|0;return(t=="x"?n:n&3|8).toString(16)})},gD=(e,t,n={})=>n.shouldFocus||zo(n.shouldFocus)?n.focusName||`${e}.${zo(n.focusIndex)?t:n.focusIndex}.`:"",yD=(e,t)=>[...e,...cu(t)],_D=e=>Array.isArray(e)?e.map(()=>{}):void 0;function vD(e,t,n){return[...e.slice(0,t),...cu(n),...e.slice(t)]}var xD=(e,t,n)=>Array.isArray(e)?(zo(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[],bD=(e,t)=>[...cu(t),...cu(e)];function Vke(e,t){let n=0;const i=[...e];for(const c of t)i.splice(c-n,1),n++;return mC(i).length?i:[]}var wD=(e,t)=>zo(t)?[]:Vke(e,cu(t).sort((n,i)=>n-i)),SD=(e,t,n)=>{[e[t],e[n]]=[e[n],e[t]]},WH=(e,t,n)=>(e[t]=n,e);function XH(e){const t=gC(),{control:n=t.control,name:i,keyName:c="id",shouldUnregister:d,rules:m}=e,[a,w]=Ce.useState(n._getFieldArray(i)),S=Ce.useRef(n._getFieldArray(i).map(Yg)),M=Ce.useRef(a),P=Ce.useRef(!1);M.current=a,n._names.array.add(i),Ce.useMemo(()=>m&&n.register(i,m),[n,m,i]),yC(()=>n._subjects.array.subscribe({next:({values:ne,name:ce})=>{if(ce===i||!ce){const me=cr(ne,i);Array.isArray(me)&&(w(me),S.current=me.map(Yg))}}}).unsubscribe,[n,i]);const N=Ce.useCallback(ne=>{P.current=!0,n._setFieldArray(i,ne)},[n,i]),$=(ne,ce)=>{const me=cu(Lo(ne)),ve=yD(n._getFieldArray(i),me);n._names.focus=gD(i,ve.length-1,ce),S.current=yD(S.current,me.map(Yg)),N(ve),w(ve),n._setFieldArray(i,ve,yD,{argA:_D(ne)})},G=(ne,ce)=>{const me=cu(Lo(ne)),ve=bD(n._getFieldArray(i),me);n._names.focus=gD(i,0,ce),S.current=bD(S.current,me.map(Yg)),N(ve),w(ve),n._setFieldArray(i,ve,bD,{argA:_D(ne)})},q=ne=>{const ce=wD(n._getFieldArray(i),ne);S.current=wD(S.current,ne),N(ce),w(ce),!Array.isArray(cr(n._fields,i))&&ro(n._fields,i,void 0),n._setFieldArray(i,ce,wD,{argA:ne})},V=(ne,ce,me)=>{const ve=cu(Lo(ce)),De=vD(n._getFieldArray(i),ne,ve);n._names.focus=gD(i,ne,me),S.current=vD(S.current,ne,ve.map(Yg)),N(De),w(De),n._setFieldArray(i,De,vD,{argA:ne,argB:_D(ce)})},J=(ne,ce)=>{const me=n._getFieldArray(i);SD(me,ne,ce),SD(S.current,ne,ce),N(me),w(me),n._setFieldArray(i,me,SD,{argA:ne,argB:ce},!1)},ee=(ne,ce)=>{const me=n._getFieldArray(i);xD(me,ne,ce),xD(S.current,ne,ce),N(me),w(me),n._setFieldArray(i,me,xD,{argA:ne,argB:ce},!1)},re=(ne,ce)=>{const me=Lo(ce),ve=WH(n._getFieldArray(i),ne,me);S.current=[...ve].map((De,Ye)=>!De||Ye===ne?Yg():S.current[Ye]),N(ve),w([...ve]),n._setFieldArray(i,ve,WH,{argA:ne,argB:me},!0,!1)},fe=ne=>{const ce=cu(Lo(ne));S.current=ce.map(Yg),N([...ce]),w([...ce]),n._setFieldArray(i,[...ce],me=>me,{},!0,!1)};return Ce.useEffect(()=>{if(n._state.action=!1,jL(i,n._names)&&n._subjects.state.next({...n._formState}),P.current&&(!Mx(n._options.mode).isOnSubmit||n._formState.isSubmitted)&&!Mx(n._options.reValidateMode).isOnSubmit)if(n._options.resolver)n._runSchema([i]).then(ne=>{const ce=cr(ne.errors,i),me=cr(n._formState.errors,i);(me?!ce&&me.type||ce&&(me.type!==ce.type||me.message!==ce.message):ce&&ce.type)&&(ce?ro(n._formState.errors,i,ce):Ts(n._formState.errors,i),n._subjects.state.next({errors:n._formState.errors}))});else{const ne=cr(n._fields,i);ne&&ne._f&&!(Mx(n._options.reValidateMode).isOnSubmit&&Mx(n._options.mode).isOnSubmit)&&BL(ne,n._names.disabled,n._formValues,n._options.criteriaMode===Xh.all,n._options.shouldUseNativeValidation,!0).then(ce=>!Oc(ce)&&n._subjects.state.next({errors:dQ(n._formState.errors,ce,i)}))}n._subjects.state.next({name:i,values:Lo(n._formValues)}),n._names.focus&&zx(n._fields,(ne,ce)=>{if(n._names.focus&&ce.startsWith(n._names.focus)&&ne.focus)return ne.focus(),1}),n._names.focus="",n._setValid(),P.current=!1},[a,i,n]),Ce.useEffect(()=>(!cr(n._formValues,i)&&n._setFieldArray(i),()=>{const ne=(ce,me)=>{const ve=cr(n._fields,ce);ve&&ve._f&&(ve._f.mount=me)};n._options.shouldUnregister||d?n.unregister(i):ne(i,!1)}),[i,n,c,d]),{swap:Ce.useCallback(J,[N,i,n]),move:Ce.useCallback(ee,[N,i,n]),prepend:Ce.useCallback(G,[N,i,n]),append:Ce.useCallback($,[N,i,n]),remove:Ce.useCallback(q,[N,i,n]),insert:Ce.useCallback(V,[N,i,n]),update:Ce.useCallback(re,[N,i,n]),replace:Ce.useCallback(fe,[N,i,n]),fields:Ce.useMemo(()=>a.map((ne,ce)=>({...ne,[c]:S.current[ce]||Yg()})),[a,c])}}function fv(e={}){const t=Ce.useRef(void 0),n=Ce.useRef(void 0),[i,c]=Ce.useState({isDirty:!1,isValidating:!1,isLoading:Gd(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:Gd(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:i},e.defaultValues&&!Gd(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:m,...a}=Fke(e);t.current={...a,formState:i}}const d=t.current.control;return d._options=e,yC(()=>{const m=d._subscribe({formState:d._proxyFormState,callback:()=>c({...d._formState}),reRenderRoot:!0});return c(a=>({...a,isReady:!0})),d._formState.isReady=!0,m},[d]),Ce.useEffect(()=>d._disableForm(e.disabled),[d,e.disabled]),Ce.useEffect(()=>{e.mode&&(d._options.mode=e.mode),e.reValidateMode&&(d._options.reValidateMode=e.reValidateMode)},[d,e.mode,e.reValidateMode]),Ce.useEffect(()=>{e.errors&&(d._setErrors(e.errors),d._focusError())},[d,e.errors]),Ce.useEffect(()=>{e.shouldUnregister&&d._subjects.state.next({values:d._getWatch()})},[d,e.shouldUnregister]),Ce.useEffect(()=>{if(d._proxyFormState.isDirty){const m=d._getDirty();m!==i.isDirty&&d._subjects.state.next({isDirty:m})}},[d,i.isDirty]),Ce.useEffect(()=>{e.values&&!Em(e.values,n.current)?(d._reset(e.values,{keepFieldsRef:!0,...d._options.resetOptions}),n.current=e.values,c(m=>({...m}))):d._resetDefaultValues()},[d,e.values]),Ce.useEffect(()=>{d._state.mount||(d._setValid(),d._state.mount=!0),d._state.watch&&(d._state.watch=!1,d._subjects.state.next({...d._formState})),d._removeUnmounted()}),t.current.formState=iQ(i,d),t.current}function ZH({}){const{register:e,handleSubmit:t,control:n,reset:i,formState:{errors:c,isSubmitting:d}}=fv({}),[m,a]=K.useState(!1),w=async S=>{const M=new FormData;Object.entries(S).forEach(([P,N])=>{P!=="image"&&M.append(P,N??"")}),S.image?.[0]&&M.append("image",S.image[0]);try{const P=await Qa.vehicles.register(M,{headers:{"Content-Type":"multipart/form-data"}});P.status===200&&(a(!1),i(),ua.success(P.data.message??"Vehicle registered successfully!",{position:"top-center"}))}catch(P){console.log(P),P.response?.status===422?ua.error(P.response.data.message||"Validation error",{position:"top-center"}):P.response?.status===500?ua.error("Server Error",{position:"top-center"}):ua.error("Network error",{position:"top-center"})}};return D.jsxs(oC,{open:m,onOpenChange:a,children:[D.jsx(sC,{asChild:!0,children:D.jsx(na,{onClick:()=>a(!0),children:"Register"})}),D.jsx(lC,{className:"sm:max-w-[425px]",children:D.jsxs("form",{onSubmit:t(w),children:[D.jsxs(cC,{className:"mb-3",children:[D.jsx(uC,{children:"Register Vehicle"}),D.jsx(hC,{children:"Fill all the fields, click register when you're done."})]}),D.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Vehicle Identification Number (VIN)"}),c.vin&&D.jsx(ou,{className:"text-red-500",children:c.vin.message})]}),D.jsx(io,{...e("vin",{required:"VIN is required!",minLength:{value:17,message:"VIN must contain 17 characters!"},maxLength:{value:17,message:"VIN must contain 17 characters!"}}),type:"text",className:c.vin?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsxs("div",{className:"flex gap-2 mb-3",children:[D.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Brand"}),c.make&&D.jsx(ou,{className:"text-red-500",children:c.make.message})]}),D.jsx(io,{...e("make",{required:"Brand is required!"}),type:"text",className:c.make?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Model"}),c.model&&D.jsx(ou,{className:"text-red-500",children:c.model.message})]}),D.jsx(io,{...e("model",{required:"Model is required!"}),type:"text",className:c.model?"border-red-500 focus-visible:ring-red-300":""})]})]}),D.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Year"}),c.year&&D.jsx(ou,{className:"text-red-500",children:c.year.message})]}),D.jsx(iv,{name:"year",control:n,rules:{required:"Year is required!"},render:({field:S})=>D.jsx(QJ,{startYear:1980,value:S.value,onChange:M=>S.onChange(M),className:c.year?"border-red-500 focus-visible:ring-red-300":""})})]}),D.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Type"}),c.type&&D.jsx(ou,{className:"text-red-500",children:c.type.message})]}),D.jsx(io,{...e("type",{rules:{required:"Type is required!"}})})]}),D.jsxs("div",{className:"flex gap-2 mb-3",children:[D.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[D.jsx(Ar,{children:"Height (m)"}),D.jsx(io,{...e("height",{required:"Height is required!",valueAsNumber:!0,min:{value:.5,message:"Too small"},max:{value:10,message:"Too large"}}),type:"number",step:"0.01",placeholder:"e.g. 1.75",className:c.height?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[D.jsx(Ar,{children:"Width (m)"}),D.jsx(io,{...e("width",{required:"Width is required!",valueAsNumber:!0,min:{value:.5,message:"Too small"},max:{value:5,message:"Too large"}}),type:"number",step:"0.01",placeholder:"e.g. 1.85",className:c.width?"border-red-500 focus-visible:ring-red-300":""})]})]}),D.jsxs("div",{className:"flex gap-2 mb-3",children:[D.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Capacity (kg)"}),c.capacity&&D.jsx(ou,{className:"text-red-500",children:c.capacity.message})]}),D.jsx(io,{...e("capacity",{required:"Capacity is required!"}),type:"number",placeholder:"Weight in kg",className:c.capacity?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Seats"}),c.seats&&D.jsx(ou,{className:"text-red-500",children:c.seats.message})]}),D.jsx(io,{...e("seats",{required:"Seats is required!"}),type:"number",placeholder:"Number of passenger seats",className:c.seats?"border-red-500 focus-visible:ring-red-300":""})]})]}),D.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Fuel Efficiency (L/100km)"}),c.fuel_efficiency&&D.jsx(ou,{className:"text-red-500",children:c.fuel_efficiency.message})]}),D.jsx(io,{...e("fuel_efficiency",{required:"Fuel efficiency is required!"}),type:"number",step:"0.01",placeholder:"e.g. 2",className:c.fuel_efficiency?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Vehicle Image (optional)"}),c.image&&D.jsx(ou,{className:"text-red-500",children:c.image.message})]}),D.jsx(io,{...e("image"),type:"file",accept:"image/*",className:c.image?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsxs(jDe,{children:[D.jsx(NDe,{asChild:!0,children:D.jsx(na,{variant:"outline",children:"Cancel"})}),D.jsx(na,{disabled:d,type:"submit",children:d?"Submitting...":"Register"})]})]})})]})}function Uke({className:e,...t}){return D.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:bn("mx-auto flex w-full justify-center",e),...t})}function $ke({className:e,...t}){return D.jsx("ul",{"data-slot":"pagination-content",className:bn("flex flex-row items-center gap-1",e),...t})}function TD({...e}){return D.jsx("li",{"data-slot":"pagination-item",...e})}function Cj({className:e,isActive:t,size:n="icon",...i}){return D.jsx(fc,{"aria-current":t?"page":void 0,"data-slot":"pagination-link","data-active":t,className:bn(Fx({variant:t?"outline":"ghost",size:n}),e),...i})}function qke({className:e,...t}){return D.jsxs(Cj,{"aria-label":"Go to previous page",size:"default",className:bn("gap-1 px-2.5 sm:pl-2.5",e),...t,children:[D.jsx(hW,{}),D.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function Hke({className:e,...t}){return D.jsxs(Cj,{"aria-label":"Go to next page",size:"default",className:bn("gap-1 px-2.5 sm:pr-2.5",e),...t,children:[D.jsx("span",{className:"hidden sm:block",children:"Next"}),D.jsx(v0,{})]})}function Gke({className:e,...t}){return D.jsxs("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:bn("flex size-9 items-center justify-center",e),...t,children:[D.jsx(Ise,{className:"size-4"}),D.jsx("span",{className:"sr-only",children:"More pages"})]})}function Wke(e,t){const i=[],c=[];let d;for(let m=1;m<=t;m++)(m===1||m===t||m>=e-2&&m<=e+2)&&i.push(m);for(let m of i)d&&(m-d===2?c.push(d+1):m-d!==1&&c.push(D.jsx(Gke,{}))),c.push(m),d=m;return c}function _C({totalPage:e,page:t,setPage:n}){return D.jsx(Uke,{children:D.jsxs($ke,{children:[D.jsx(TD,{children:D.jsx(qke,{to:"#",onClick:i=>{i.preventDefault(),n(c=>Math.max(c-1,1))},"aria-disabled":t===1})}),Wke(t,e).map((i,c)=>D.jsx(TD,{children:i==="..."?D.jsx("span",{className:"px-2",children:"..."}):D.jsx(Cj,{to:"#",onClick:d=>{d.preventDefault(),n(i)},isActive:t===i,children:i})},c)),D.jsx(TD,{children:D.jsx(Hke,{to:"#",onClick:i=>{i.preventDefault(),n(c=>Math.min(c+1,e))},"aria-disabled":t===e})})]})})}Qa.broadcast.config();function hw({setSearch:e,text:t}){return D.jsx(na,{className:"rounded-full min-w-[100px]",variant:"outline",onClick:()=>{t=="All"?e(""):e(t)},children:t})}function Xke(){const[e,t]=K.useState([]),[n,i]=K.useState(1),[c,d]=K.useState(),[m,a]=K.useState(""),[w,S]=K.useState(!1),M=K.useCallback(()=>{Qa.vehicles.list({page:n,q:m||void 0}).then(P=>{let N=P.data.vehicles;console.log(N),t(N.data||[]),d(N.last_page)}).catch(P=>{w||(ua.error("Error fetching vehicles"),S(!0))})},[n,m]);return K.useEffect(()=>{let P=setTimeout(M,300);return()=>{clearTimeout(P)}},[M]),j0("vehicle_channel","VehicleEvents",P=>{t(N=>kJ(N,P.record,"uuid"))}),D.jsx(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"h-full",children:D.jsxs("div",{className:"flex flex-col flex-2 h-full gap-2",children:[D.jsxs("div",{className:"flex-4/5",children:[D.jsxs("div",{className:"flex mb-3 gap-2",children:[D.jsx(io,{placeholder:"Search VIN, Status, Brand, and Model",value:m,onChange:P=>a(P.target.value)}),D.jsx(ZH,{})]}),D.jsxs("div",{className:"flex gap-2 mb-3 overflow-x-auto",children:[D.jsx(hw,{setSearch:a,text:"All"}),D.jsx(hw,{setSearch:a,text:"Available"}),D.jsx(hw,{setSearch:a,text:"Reserved"}),D.jsx(hw,{setSearch:a,text:"Under Maintenance"}),D.jsx(hw,{setSearch:a,text:"Retired"})]}),e.length>0?D.jsx("div",{className:"max-h-full min-h-96 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-2",children:e.map((P,N)=>D.jsx(fc,{to:P.uuid,children:D.jsx("div",{className:"border shadow rounded-md h-48 col-span-1 hover:scale-105 bg-background transition-all delay-75 ease-in-out",children:D.jsxs("div",{className:"h-full w-full flex",children:[D.jsx("div",{className:"flex-1 w-1/2",children:D.jsx("img",{src:P.image_url,className:"w-full h-full object-cover rounded-md",alt:"Vehicle",loading:"lazy"})}),D.jsxs("div",{className:"flex-1 p-2 space-y-2",children:[D.jsxs("div",{className:"container justify-between space-x-1 space-y-1",children:[D.jsx(_p,{className:"py-1 items-center",children:D.jsx(Ar,{children:P.make})}),D.jsx(_p,{className:P.status==="Under Maintenance"?"py-1 bg-red-500":P.status==="Retired"?"py-1 bg-gray-500":P.status==="Available"?"py-1 bg-green-700":P.status==="Reserved"?"py-1 bg-amber-600":"py-1",children:D.jsx(Ar,{children:P.status})})]}),D.jsxs(Ar,{children:["Model: ",D.jsx(Ar,{children:P.model})]}),D.jsxs(Ar,{children:["Type: ",D.jsx(Ar,{children:P.type})]}),D.jsxs(Ar,{children:["Capacity: ",D.jsxs(Ar,{children:[P.capacity," Kg"]})]}),D.jsxs(Ar,{children:["Seats: ",D.jsx(Ar,{children:P.seats})]}),D.jsxs(Ar,{children:["Fuel Efficiency: ",D.jsxs(Ar,{children:[P.fuel_efficiency," L/100km"]})]})]})]})})},N))}):D.jsx("div",{className:"flex w-full justify-center max-h-full min-h-96 items-center",children:D.jsxs("div",{className:"flex flex-col justify-center space-y-4",children:[D.jsx("h1",{className:"text-center font-medium text-gray-400 text-shadow text-xl",children:"No vehicle records yet. Do you want to create?"}),D.jsx("div",{className:"w-min mx-auto",children:D.jsx(ZH,{})})]})})]}),D.jsx(_C,{totalPage:c,page:n,setPage:i,className:"flex-2/12"})]})})}const fQ=6048e5,Zke=864e5,YH=Symbol.for("constructDateFrom");function sl(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&YH in e?e[YH](t):e instanceof Date?new e.constructor(t):new Date(t)}function oo(e,t){return sl(t||e,e)}function pQ(e,t,n){const i=oo(e,n?.in);return isNaN(t)?sl(e,NaN):(t&&i.setDate(i.getDate()+t),i)}function mQ(e,t,n){const i=oo(e,n?.in);if(isNaN(t))return sl(e,NaN);if(!t)return i;const c=i.getDate(),d=sl(e,i.getTime());d.setMonth(i.getMonth()+t+1,0);const m=d.getDate();return c>=m?d:(i.setFullYear(d.getFullYear(),d.getMonth(),c),i)}let Yke={};function mS(){return Yke}function p0(e,t){const n=mS(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=oo(e,t?.in),d=c.getDay(),m=(d<i?7:0)+d-i;return c.setDate(c.getDate()-m),c.setHours(0,0,0,0),c}function C1(e,t){return p0(e,{...t,weekStartsOn:1})}function gQ(e,t){const n=oo(e,t?.in),i=n.getFullYear(),c=sl(n,0);c.setFullYear(i+1,0,4),c.setHours(0,0,0,0);const d=C1(c),m=sl(n,0);m.setFullYear(i,0,4),m.setHours(0,0,0,0);const a=C1(m);return n.getTime()>=d.getTime()?i+1:n.getTime()>=a.getTime()?i:i-1}function KH(e){const t=oo(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function F0(e,...t){const n=sl.bind(null,t.find(i=>typeof i=="object"));return t.map(n)}function M1(e,t){const n=oo(e,t?.in);return n.setHours(0,0,0,0),n}function yQ(e,t,n){const[i,c]=F0(n?.in,e,t),d=M1(i),m=M1(c),a=+d-KH(d),w=+m-KH(m);return Math.round((a-w)/Zke)}function Kke(e,t){const n=gQ(e,t),i=sl(e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),C1(i)}function Jke(e,t,n){return pQ(e,t*7,n)}function Qke(e,t,n){return mQ(e,t*12,n)}function eLe(e,t){let n,i=t?.in;return e.forEach(c=>{!i&&typeof c=="object"&&(i=sl.bind(null,c));const d=oo(c,i);(!n||n<d||isNaN(+d))&&(n=d)}),sl(i,n||NaN)}function tLe(e,t){let n,i=t?.in;return e.forEach(c=>{!i&&typeof c=="object"&&(i=sl.bind(null,c));const d=oo(c,i);(!n||n>d||isNaN(+d))&&(n=d)}),sl(i,n||NaN)}function nLe(e,t,n){const[i,c]=F0(n?.in,e,t);return+M1(i)==+M1(c)}function _Q(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function rLe(e){return!(!_Q(e)&&typeof e!="number"||isNaN(+oo(e)))}function iLe(e,t,n){const[i,c]=F0(n?.in,e,t),d=i.getFullYear()-c.getFullYear(),m=i.getMonth()-c.getMonth();return d*12+m}function aLe(e,t){const n=oo(e,t?.in),i=n.getMonth();return n.setFullYear(n.getFullYear(),i+1,0),n.setHours(23,59,59,999),n}function oLe(e,t){const[n,i]=F0(e,t.start,t.end);return{start:n,end:i}}function sLe(e,t){const{start:n,end:i}=oLe(t?.in,e);let c=+n>+i;const d=c?+n:+i,m=c?i:n;m.setHours(0,0,0,0),m.setDate(1);let a=1;const w=[];for(;+m<=d;)w.push(sl(n,m)),m.setMonth(m.getMonth()+a);return c?w.reverse():w}function lLe(e,t){const n=oo(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function cLe(e,t){const n=oo(e,t?.in),i=n.getFullYear();return n.setFullYear(i+1,0,0),n.setHours(23,59,59,999),n}function vQ(e,t){const n=oo(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function xQ(e,t){const n=mS(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=oo(e,t?.in),d=c.getDay(),m=(d<i?-7:0)+6-(d-i);return c.setDate(c.getDate()+m),c.setHours(23,59,59,999),c}function uLe(e,t){return xQ(e,{...t,weekStartsOn:1})}const hLe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},dLe=(e,t,n)=>{let i;const c=hLe[e];return typeof c=="string"?i=c:t===1?i=c.one:i=c.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function ED(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const fLe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pLe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},mLe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},gLe={date:ED({formats:fLe,defaultWidth:"full"}),time:ED({formats:pLe,defaultWidth:"full"}),dateTime:ED({formats:mLe,defaultWidth:"full"})},yLe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},_Le=(e,t,n,i)=>yLe[e];function dw(e){return(t,n)=>{const i=n?.context?String(n.context):"standalone";let c;if(i==="formatting"&&e.formattingValues){const m=e.defaultFormattingWidth||e.defaultWidth,a=n?.width?String(n.width):m;c=e.formattingValues[a]||e.formattingValues[m]}else{const m=e.defaultWidth,a=n?.width?String(n.width):e.defaultWidth;c=e.values[a]||e.values[m]}const d=e.argumentCallback?e.argumentCallback(t):t;return c[d]}}const vLe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xLe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bLe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},wLe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},SLe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},TLe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ELe=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},ALe={ordinalNumber:ELe,era:dw({values:vLe,defaultWidth:"wide"}),quarter:dw({values:xLe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:dw({values:bLe,defaultWidth:"wide"}),day:dw({values:wLe,defaultWidth:"wide"}),dayPeriod:dw({values:SLe,defaultWidth:"wide",formattingValues:TLe,defaultFormattingWidth:"wide"})};function fw(e){return(t,n={})=>{const i=n.width,c=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],d=t.match(c);if(!d)return null;const m=d[0],a=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],w=Array.isArray(a)?MLe(a,P=>P.test(m)):CLe(a,P=>P.test(m));let S;S=e.valueCallback?e.valueCallback(w):w,S=n.valueCallback?n.valueCallback(S):S;const M=t.slice(m.length);return{value:S,rest:M}}}function CLe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function MLe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function PLe(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const c=i[0],d=t.match(e.parsePattern);if(!d)return null;let m=e.valueCallback?e.valueCallback(d[0]):d[0];m=n.valueCallback?n.valueCallback(m):m;const a=t.slice(c.length);return{value:m,rest:a}}}const OLe=/^(\d+)(th|st|nd|rd)?/i,RLe=/\d+/i,ILe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},DLe={any:[/^b/i,/^(a|c)/i]},kLe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},LLe={any:[/1/i,/2/i,/3/i,/4/i]},NLe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zLe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},jLe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BLe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},FLe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},VLe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ULe={ordinalNumber:PLe({matchPattern:OLe,parsePattern:RLe,valueCallback:e=>parseInt(e,10)}),era:fw({matchPatterns:ILe,defaultMatchWidth:"wide",parsePatterns:DLe,defaultParseWidth:"any"}),quarter:fw({matchPatterns:kLe,defaultMatchWidth:"wide",parsePatterns:LLe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:fw({matchPatterns:NLe,defaultMatchWidth:"wide",parsePatterns:zLe,defaultParseWidth:"any"}),day:fw({matchPatterns:jLe,defaultMatchWidth:"wide",parsePatterns:BLe,defaultParseWidth:"any"}),dayPeriod:fw({matchPatterns:FLe,defaultMatchWidth:"any",parsePatterns:VLe,defaultParseWidth:"any"})},Mj={code:"en-US",formatDistance:dLe,formatLong:gLe,formatRelative:_Le,localize:ALe,match:ULe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function $Le(e,t){const n=oo(e,t?.in);return yQ(n,vQ(n))+1}function bQ(e,t){const n=oo(e,t?.in),i=+C1(n)-+Kke(n);return Math.round(i/fQ)+1}function wQ(e,t){const n=oo(e,t?.in),i=n.getFullYear(),c=mS(),d=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??c.firstWeekContainsDate??c.locale?.options?.firstWeekContainsDate??1,m=sl(t?.in||e,0);m.setFullYear(i+1,0,d),m.setHours(0,0,0,0);const a=p0(m,t),w=sl(t?.in||e,0);w.setFullYear(i,0,d),w.setHours(0,0,0,0);const S=p0(w,t);return+n>=+a?i+1:+n>=+S?i:i-1}function qLe(e,t){const n=mS(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=wQ(e,t),d=sl(t?.in||e,0);return d.setFullYear(c,0,i),d.setHours(0,0,0,0),p0(d,t)}function SQ(e,t){const n=oo(e,t?.in),i=+p0(n,t)-+qLe(n,t);return Math.round(i/fQ)+1}function Ja(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const Kg={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return Ja(t==="yy"?i%100:i,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Ja(n+1,2)},d(e,t){return Ja(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Ja(e.getHours()%12||12,t.length)},H(e,t){return Ja(e.getHours(),t.length)},m(e,t){return Ja(e.getMinutes(),t.length)},s(e,t){return Ja(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),c=Math.trunc(i*Math.pow(10,n-3));return Ja(c,t.length)}},mx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},JH={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const i=e.getFullYear(),c=i>0?i:1-i;return n.ordinalNumber(c,{unit:"year"})}return Kg.y(e,t)},Y:function(e,t,n,i){const c=wQ(e,i),d=c>0?c:1-c;if(t==="YY"){const m=d%100;return Ja(m,2)}return t==="Yo"?n.ordinalNumber(d,{unit:"year"}):Ja(d,t.length)},R:function(e,t){const n=gQ(e);return Ja(n,t.length)},u:function(e,t){const n=e.getFullYear();return Ja(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Ja(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Ja(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return Kg.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Ja(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const c=SQ(e,i);return t==="wo"?n.ordinalNumber(c,{unit:"week"}):Ja(c,t.length)},I:function(e,t,n){const i=bQ(e);return t==="Io"?n.ordinalNumber(i,{unit:"week"}):Ja(i,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Kg.d(e,t)},D:function(e,t,n){const i=$Le(e);return t==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Ja(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const c=e.getDay(),d=(c-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(d);case"ee":return Ja(d,2);case"eo":return n.ordinalNumber(d,{unit:"day"});case"eee":return n.day(c,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(c,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(c,{width:"short",context:"formatting"});case"eeee":default:return n.day(c,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const c=e.getDay(),d=(c-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(d);case"cc":return Ja(d,t.length);case"co":return n.ordinalNumber(d,{unit:"day"});case"ccc":return n.day(c,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(c,{width:"narrow",context:"standalone"});case"cccccc":return n.day(c,{width:"short",context:"standalone"});case"cccc":default:return n.day(c,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),c=i===0?7:i;switch(t){case"i":return String(c);case"ii":return Ja(c,t.length);case"io":return n.ordinalNumber(c,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const c=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(c,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(c,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let c;switch(i===12?c=mx.noon:i===0?c=mx.midnight:c=i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(c,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(c,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let c;switch(i>=17?c=mx.evening:i>=12?c=mx.afternoon:i>=4?c=mx.morning:c=mx.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(c,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(c,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Kg.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Kg.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return t==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Ja(i,t.length)},k:function(e,t,n){let i=e.getHours();return i===0&&(i=24),t==="ko"?n.ordinalNumber(i,{unit:"hour"}):Ja(i,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Kg.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Kg.s(e,t)},S:function(e,t){return Kg.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return eG(i);case"XXXX":case"XX":return D_(i);case"XXXXX":case"XXX":default:return D_(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return eG(i);case"xxxx":case"xx":return D_(i);case"xxxxx":case"xxx":default:return D_(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+QH(i,":");case"OOOO":default:return"GMT"+D_(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+QH(i,":");case"zzzz":default:return"GMT"+D_(i,":")}},t:function(e,t,n){const i=Math.trunc(+e/1e3);return Ja(i,t.length)},T:function(e,t,n){return Ja(+e,t.length)}};function QH(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),c=Math.trunc(i/60),d=i%60;return d===0?n+String(c):n+String(c)+t+Ja(d,2)}function eG(e,t){return e%60===0?(e>0?"-":"+")+Ja(Math.abs(e)/60,2):D_(e,t)}function D_(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),c=Ja(Math.trunc(i/60),2),d=Ja(i%60,2);return n+c+t+d}const tG=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},TQ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},HLe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],c=n[2];if(!c)return tG(e,t);let d;switch(i){case"P":d=t.dateTime({width:"short"});break;case"PP":d=t.dateTime({width:"medium"});break;case"PPP":d=t.dateTime({width:"long"});break;case"PPPP":default:d=t.dateTime({width:"full"});break}return d.replace("{{date}}",tG(i,t)).replace("{{time}}",TQ(c,t))},GLe={p:TQ,P:HLe},WLe=/^D+$/,XLe=/^Y+$/,ZLe=["D","DD","YY","YYYY"];function YLe(e){return WLe.test(e)}function KLe(e){return XLe.test(e)}function JLe(e,t,n){const i=QLe(e,t,n);if(console.warn(i),ZLe.includes(e))throw new RangeError(i)}function QLe(e,t,n){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const eNe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tNe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,nNe=/^'([^]*?)'?$/,rNe=/''/g,iNe=/[a-zA-Z]/;function wl(e,t,n){const i=mS(),c=n?.locale??i.locale??Mj,d=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,m=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,a=oo(e,n?.in);if(!rLe(a))throw new RangeError("Invalid time value");let w=t.match(tNe).map(M=>{const P=M[0];if(P==="p"||P==="P"){const N=GLe[P];return N(M,c.formatLong)}return M}).join("").match(eNe).map(M=>{if(M==="''")return{isToken:!1,value:"'"};const P=M[0];if(P==="'")return{isToken:!1,value:aNe(M)};if(JH[P])return{isToken:!0,value:M};if(P.match(iNe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");return{isToken:!1,value:M}});c.localize.preprocessor&&(w=c.localize.preprocessor(a,w));const S={firstWeekContainsDate:d,weekStartsOn:m,locale:c};return w.map(M=>{if(!M.isToken)return M.value;const P=M.value;(!n?.useAdditionalWeekYearTokens&&KLe(P)||!n?.useAdditionalDayOfYearTokens&&YLe(P))&&JLe(P,t,String(e));const N=JH[P[0]];return N(a,P,c.localize,S)}).join("")}function aNe(e){const t=e.match(nNe);return t?t[1].replace(rNe,"'"):e}function oNe(e,t){const n=oo(e,t?.in),i=n.getFullYear(),c=n.getMonth(),d=sl(n,0);return d.setFullYear(i,c+1,0),d.setHours(0,0,0,0),d.getDate()}function sNe(e,t){return oo(e,t?.in).getMonth()}function lNe(e,t){return oo(e,t?.in).getFullYear()}function cNe(e,t){return+oo(e)>+oo(t)}function uNe(e,t){return+oo(e)<+oo(t)}function hNe(e,t,n){const[i,c]=F0(n?.in,e,t);return i.getFullYear()===c.getFullYear()&&i.getMonth()===c.getMonth()}function dNe(e,t,n){const[i,c]=F0(n?.in,e,t);return i.getFullYear()===c.getFullYear()}function fNe(e,t,n){const i=oo(e,n?.in),c=i.getFullYear(),d=i.getDate(),m=sl(e,0);m.setFullYear(c,t,15),m.setHours(0,0,0,0);const a=oNe(m);return i.setMonth(t,Math.min(d,a)),i}function pNe(e,t,n){const i=oo(e,n?.in);return isNaN(+i)?sl(e,NaN):(i.setFullYear(t),i)}function mNe(e){const t=K.useRef({value:e,previous:e});return K.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var gNe=[" ","Enter","ArrowUp","ArrowDown"],yNe=[" ","Enter"],av="Select",[vC,xC,_Ne]=x2(av),[V0,UBe]=ih(av,[_Ne,gy]),bC=gy(),[vNe,Ey]=V0(av),[xNe,bNe]=V0(av),EQ=e=>{const{__scopeSelect:t,children:n,open:i,defaultOpen:c,onOpenChange:d,value:m,defaultValue:a,onValueChange:w,dir:S,name:M,autoComplete:P,disabled:N,required:$,form:G}=e,q=bC(t),[V,J]=K.useState(null),[ee,re]=K.useState(null),[fe,ne]=K.useState(!1),ce=b2(S),[me,ve]=mp({prop:i,defaultProp:c??!1,onChange:d,caller:av}),[De,Ye]=mp({prop:m,defaultProp:a,onChange:w,caller:av}),ze=K.useRef(null),tt=V?G||!!V.closest("form"):!0,[at,ct]=K.useState(new Set),ht=Array.from(at).map(Ie=>Ie.props.value).join(";");return D.jsx(m2,{...q,children:D.jsxs(vNe,{required:$,scope:t,trigger:V,onTriggerChange:J,valueNode:ee,onValueNodeChange:re,valueNodeHasChildren:fe,onValueNodeHasChildrenChange:ne,contentId:ol(),value:De,onValueChange:Ye,open:me,onOpenChange:ve,dir:ce,triggerPointerDownPosRef:ze,disabled:N,children:[D.jsx(vC.Provider,{scope:t,children:D.jsx(xNe,{scope:e.__scopeSelect,onNativeOptionAdd:K.useCallback(Ie=>{ct(rt=>new Set(rt).add(Ie))},[]),onNativeOptionRemove:K.useCallback(Ie=>{ct(rt=>{const Qe=new Set(rt);return Qe.delete(Ie),Qe})},[]),children:n})}),tt?D.jsxs(WQ,{"aria-hidden":!0,required:$,tabIndex:-1,name:M,autoComplete:P,value:De,onChange:Ie=>Ye(Ie.target.value),disabled:N,form:G,children:[De===void 0?D.jsx("option",{value:""}):null,Array.from(at)]},ht):null]})})};EQ.displayName=av;var AQ="SelectTrigger",CQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:i=!1,...c}=e,d=bC(n),m=Ey(AQ,n),a=m.disabled||i,w=ba(t,m.onTriggerChange),S=xC(n),M=K.useRef("touch"),[P,N,$]=ZQ(q=>{const V=S().filter(re=>!re.disabled),J=V.find(re=>re.value===m.value),ee=YQ(V,q,J);ee!==void 0&&m.onValueChange(ee.value)}),G=q=>{a||(m.onOpenChange(!0),$()),q&&(m.triggerPointerDownPosRef.current={x:Math.round(q.pageX),y:Math.round(q.pageY)})};return D.jsx(H1,{asChild:!0,...d,children:D.jsx(ii.button,{type:"button",role:"combobox","aria-controls":m.contentId,"aria-expanded":m.open,"aria-required":m.required,"aria-autocomplete":"none",dir:m.dir,"data-state":m.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":XQ(m.value)?"":void 0,...c,ref:w,onClick:vr(c.onClick,q=>{q.currentTarget.focus(),M.current!=="mouse"&&G(q)}),onPointerDown:vr(c.onPointerDown,q=>{M.current=q.pointerType;const V=q.target;V.hasPointerCapture(q.pointerId)&&V.releasePointerCapture(q.pointerId),q.button===0&&q.ctrlKey===!1&&q.pointerType==="mouse"&&(G(q),q.preventDefault())}),onKeyDown:vr(c.onKeyDown,q=>{const V=P.current!=="";!(q.ctrlKey||q.altKey||q.metaKey)&&q.key.length===1&&N(q.key),!(V&&q.key===" ")&&gNe.includes(q.key)&&(G(),q.preventDefault())})})})});CQ.displayName=AQ;var MQ="SelectValue",PQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:c,children:d,placeholder:m="",...a}=e,w=Ey(MQ,n),{onValueNodeHasChildrenChange:S}=w,M=d!==void 0,P=ba(t,w.onValueNodeChange);return qs(()=>{S(M)},[S,M]),D.jsx(ii.span,{...a,ref:P,style:{pointerEvents:"none"},children:XQ(w.value)?D.jsx(D.Fragment,{children:m}):d})});PQ.displayName=MQ;var wNe="SelectIcon",OQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,children:i,...c}=e;return D.jsx(ii.span,{"aria-hidden":!0,...c,ref:t,children:i||""})});OQ.displayName=wNe;var SNe="SelectPortal",RQ=e=>D.jsx(S0,{asChild:!0,...e});RQ.displayName=SNe;var ov="SelectContent",IQ=K.forwardRef((e,t)=>{const n=Ey(ov,e.__scopeSelect),[i,c]=K.useState();if(qs(()=>{c(new DocumentFragment)},[]),!n.open){const d=i;return d?k1.createPortal(D.jsx(DQ,{scope:e.__scopeSelect,children:D.jsx(vC.Slot,{scope:e.__scopeSelect,children:D.jsx("div",{children:e.children})})}),d):null}return D.jsx(kQ,{...e,ref:t})});IQ.displayName=ov;var $d=10,[DQ,Ay]=V0(ov),TNe="SelectContentImpl",ENe=cy("SelectContent.RemoveScroll"),kQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:c,onEscapeKeyDown:d,onPointerDownOutside:m,side:a,sideOffset:w,align:S,alignOffset:M,arrowPadding:P,collisionBoundary:N,collisionPadding:$,sticky:G,hideWhenDetached:q,avoidCollisions:V,...J}=e,ee=Ey(ov,n),[re,fe]=K.useState(null),[ne,ce]=K.useState(null),me=ba(t,Ht=>fe(Ht)),[ve,De]=K.useState(null),[Ye,ze]=K.useState(null),tt=xC(n),[at,ct]=K.useState(!1),ht=K.useRef(!1);K.useEffect(()=>{if(re)return o2(re)},[re]),i2();const Ie=K.useCallback(Ht=>{const[mn,...en]=tt().map(cn=>cn.ref.current),[En]=en.slice(-1),Xn=document.activeElement;for(const cn of Ht)if(cn===Xn||(cn?.scrollIntoView({block:"nearest"}),cn===mn&&ne&&(ne.scrollTop=0),cn===En&&ne&&(ne.scrollTop=ne.scrollHeight),cn?.focus(),document.activeElement!==Xn))return},[tt,ne]),rt=K.useCallback(()=>Ie([ve,re]),[Ie,ve,re]);K.useEffect(()=>{at&&rt()},[at,rt]);const{onOpenChange:Qe,triggerPointerDownPosRef:St}=ee;K.useEffect(()=>{if(re){let Ht={x:0,y:0};const mn=En=>{Ht={x:Math.abs(Math.round(En.pageX)-(St.current?.x??0)),y:Math.abs(Math.round(En.pageY)-(St.current?.y??0))}},en=En=>{Ht.x<=10&&Ht.y<=10?En.preventDefault():re.contains(En.target)||Qe(!1),document.removeEventListener("pointermove",mn),St.current=null};return St.current!==null&&(document.addEventListener("pointermove",mn),document.addEventListener("pointerup",en,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",mn),document.removeEventListener("pointerup",en,{capture:!0})}}},[re,Qe,St]),K.useEffect(()=>{const Ht=()=>Qe(!1);return window.addEventListener("blur",Ht),window.addEventListener("resize",Ht),()=>{window.removeEventListener("blur",Ht),window.removeEventListener("resize",Ht)}},[Qe]);const[qe,vt]=ZQ(Ht=>{const mn=tt().filter(Xn=>!Xn.disabled),en=mn.find(Xn=>Xn.ref.current===document.activeElement),En=YQ(mn,Ht,en);En&&setTimeout(()=>En.ref.current.focus())}),nt=K.useCallback((Ht,mn,en)=>{const En=!ht.current&&!en;(ee.value!==void 0&&ee.value===mn||En)&&(De(Ht),En&&(ht.current=!0))},[ee.value]),gt=K.useCallback(()=>re?.focus(),[re]),Ut=K.useCallback((Ht,mn,en)=>{const En=!ht.current&&!en;(ee.value!==void 0&&ee.value===mn||En)&&ze(Ht)},[ee.value]),$t=i==="popper"?FL:LQ,qt=$t===FL?{side:a,sideOffset:w,align:S,alignOffset:M,arrowPadding:P,collisionBoundary:N,collisionPadding:$,sticky:G,hideWhenDetached:q,avoidCollisions:V}:{};return D.jsx(DQ,{scope:n,content:re,viewport:ne,onViewportChange:ce,itemRefCallback:nt,selectedItem:ve,onItemLeave:gt,itemTextRefCallback:Ut,focusSelectedItem:rt,selectedItemText:Ye,position:i,isPositioned:at,searchRef:qe,children:D.jsx(U1,{as:ENe,allowPinchZoom:!0,children:D.jsx(V1,{asChild:!0,trapped:ee.open,onMountAutoFocus:Ht=>{Ht.preventDefault()},onUnmountAutoFocus:vr(c,Ht=>{ee.trigger?.focus({preventScroll:!0}),Ht.preventDefault()}),children:D.jsx(w0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:Ht=>Ht.preventDefault(),onDismiss:()=>ee.onOpenChange(!1),children:D.jsx($t,{role:"listbox",id:ee.contentId,"data-state":ee.open?"open":"closed",dir:ee.dir,onContextMenu:Ht=>Ht.preventDefault(),...J,...qt,onPlaced:()=>ct(!0),ref:me,style:{display:"flex",flexDirection:"column",outline:"none",...J.style},onKeyDown:vr(J.onKeyDown,Ht=>{const mn=Ht.ctrlKey||Ht.altKey||Ht.metaKey;if(Ht.key==="Tab"&&Ht.preventDefault(),!mn&&Ht.key.length===1&&vt(Ht.key),["ArrowUp","ArrowDown","Home","End"].includes(Ht.key)){let En=tt().filter(Xn=>!Xn.disabled).map(Xn=>Xn.ref.current);if(["ArrowUp","End"].includes(Ht.key)&&(En=En.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ht.key)){const Xn=Ht.target,cn=En.indexOf(Xn);En=En.slice(cn+1)}setTimeout(()=>Ie(En)),Ht.preventDefault()}})})})})})})});kQ.displayName=TNe;var ANe="SelectItemAlignedPosition",LQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:i,...c}=e,d=Ey(ov,n),m=Ay(ov,n),[a,w]=K.useState(null),[S,M]=K.useState(null),P=ba(t,me=>M(me)),N=xC(n),$=K.useRef(!1),G=K.useRef(!0),{viewport:q,selectedItem:V,selectedItemText:J,focusSelectedItem:ee}=m,re=K.useCallback(()=>{if(d.trigger&&d.valueNode&&a&&S&&q&&V&&J){const me=d.trigger.getBoundingClientRect(),ve=S.getBoundingClientRect(),De=d.valueNode.getBoundingClientRect(),Ye=J.getBoundingClientRect();if(d.dir!=="rtl"){const Xn=Ye.left-ve.left,cn=De.left-Xn,Jr=me.left-cn,mr=me.width+Jr,Cr=Math.max(mr,ve.width),li=window.innerWidth-$d,hi=jH(cn,[$d,Math.max($d,li-Cr)]);a.style.minWidth=mr+"px",a.style.left=hi+"px"}else{const Xn=ve.right-Ye.right,cn=window.innerWidth-De.right-Xn,Jr=window.innerWidth-me.right-cn,mr=me.width+Jr,Cr=Math.max(mr,ve.width),li=window.innerWidth-$d,hi=jH(cn,[$d,Math.max($d,li-Cr)]);a.style.minWidth=mr+"px",a.style.right=hi+"px"}const ze=N(),tt=window.innerHeight-$d*2,at=q.scrollHeight,ct=window.getComputedStyle(S),ht=parseInt(ct.borderTopWidth,10),Ie=parseInt(ct.paddingTop,10),rt=parseInt(ct.borderBottomWidth,10),Qe=parseInt(ct.paddingBottom,10),St=ht+Ie+at+Qe+rt,qe=Math.min(V.offsetHeight*5,St),vt=window.getComputedStyle(q),nt=parseInt(vt.paddingTop,10),gt=parseInt(vt.paddingBottom,10),Ut=me.top+me.height/2-$d,$t=tt-Ut,qt=V.offsetHeight/2,Ht=V.offsetTop+qt,mn=ht+Ie+Ht,en=St-mn;if(mn<=Ut){const Xn=ze.length>0&&V===ze[ze.length-1].ref.current;a.style.bottom="0px";const cn=S.clientHeight-q.offsetTop-q.offsetHeight,Jr=Math.max($t,qt+(Xn?gt:0)+cn+rt),mr=mn+Jr;a.style.height=mr+"px"}else{const Xn=ze.length>0&&V===ze[0].ref.current;a.style.top="0px";const Jr=Math.max(Ut,ht+q.offsetTop+(Xn?nt:0)+qt)+en;a.style.height=Jr+"px",q.scrollTop=mn-Ut+q.offsetTop}a.style.margin=`${$d}px 0`,a.style.minHeight=qe+"px",a.style.maxHeight=tt+"px",i?.(),requestAnimationFrame(()=>$.current=!0)}},[N,d.trigger,d.valueNode,a,S,q,V,J,d.dir,i]);qs(()=>re(),[re]);const[fe,ne]=K.useState();qs(()=>{S&&ne(window.getComputedStyle(S).zIndex)},[S]);const ce=K.useCallback(me=>{me&&G.current===!0&&(re(),ee?.(),G.current=!1)},[re,ee]);return D.jsx(MNe,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:$,onScrollButtonChange:ce,children:D.jsx("div",{ref:w,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:fe},children:D.jsx(ii.div,{...c,ref:P,style:{boxSizing:"border-box",maxHeight:"100%",...c.style}})})})});LQ.displayName=ANe;var CNe="SelectPopperPosition",FL=K.forwardRef((e,t)=>{const{__scopeSelect:n,align:i="start",collisionPadding:c=$d,...d}=e,m=bC(n);return D.jsx(g2,{...m,...d,ref:t,align:i,collisionPadding:c,style:{boxSizing:"border-box",...d.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});FL.displayName=CNe;var[MNe,Pj]=V0(ov,{}),VL="SelectViewport",NQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:i,...c}=e,d=Ay(VL,n),m=Pj(VL,n),a=ba(t,d.onViewportChange),w=K.useRef(0);return D.jsxs(D.Fragment,{children:[D.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),D.jsx(vC.Slot,{scope:n,children:D.jsx(ii.div,{"data-radix-select-viewport":"",role:"presentation",...c,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...c.style},onScroll:vr(c.onScroll,S=>{const M=S.currentTarget,{contentWrapper:P,shouldExpandOnScrollRef:N}=m;if(N?.current&&P){const $=Math.abs(w.current-M.scrollTop);if($>0){const G=window.innerHeight-$d*2,q=parseFloat(P.style.minHeight),V=parseFloat(P.style.height),J=Math.max(q,V);if(J<G){const ee=J+$,re=Math.min(G,ee),fe=ee-re;P.style.height=re+"px",P.style.bottom==="0px"&&(M.scrollTop=fe>0?fe:0,P.style.justifyContent="flex-end")}}}w.current=M.scrollTop})})})]})});NQ.displayName=VL;var zQ="SelectGroup",[PNe,ONe]=V0(zQ),RNe=K.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,c=ol();return D.jsx(PNe,{scope:n,id:c,children:D.jsx(ii.div,{role:"group","aria-labelledby":c,...i,ref:t})})});RNe.displayName=zQ;var jQ="SelectLabel",INe=K.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,c=ONe(jQ,n);return D.jsx(ii.div,{id:c.id,...i,ref:t})});INe.displayName=jQ;var LA="SelectItem",[DNe,BQ]=V0(LA),FQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,value:i,disabled:c=!1,textValue:d,...m}=e,a=Ey(LA,n),w=Ay(LA,n),S=a.value===i,[M,P]=K.useState(d??""),[N,$]=K.useState(!1),G=ba(t,ee=>w.itemRefCallback?.(ee,i,c)),q=ol(),V=K.useRef("touch"),J=()=>{c||(a.onValueChange(i),a.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return D.jsx(DNe,{scope:n,value:i,disabled:c,textId:q,isSelected:S,onItemTextChange:K.useCallback(ee=>{P(re=>re||(ee?.textContent??"").trim())},[]),children:D.jsx(vC.ItemSlot,{scope:n,value:i,disabled:c,textValue:M,children:D.jsx(ii.div,{role:"option","aria-labelledby":q,"data-highlighted":N?"":void 0,"aria-selected":S&&N,"data-state":S?"checked":"unchecked","aria-disabled":c||void 0,"data-disabled":c?"":void 0,tabIndex:c?void 0:-1,...m,ref:G,onFocus:vr(m.onFocus,()=>$(!0)),onBlur:vr(m.onBlur,()=>$(!1)),onClick:vr(m.onClick,()=>{V.current!=="mouse"&&J()}),onPointerUp:vr(m.onPointerUp,()=>{V.current==="mouse"&&J()}),onPointerDown:vr(m.onPointerDown,ee=>{V.current=ee.pointerType}),onPointerMove:vr(m.onPointerMove,ee=>{V.current=ee.pointerType,c?w.onItemLeave?.():V.current==="mouse"&&ee.currentTarget.focus({preventScroll:!0})}),onPointerLeave:vr(m.onPointerLeave,ee=>{ee.currentTarget===document.activeElement&&w.onItemLeave?.()}),onKeyDown:vr(m.onKeyDown,ee=>{w.searchRef?.current!==""&&ee.key===" "||(yNe.includes(ee.key)&&J(),ee.key===" "&&ee.preventDefault())})})})})});FQ.displayName=LA;var bw="SelectItemText",VQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:c,...d}=e,m=Ey(bw,n),a=Ay(bw,n),w=BQ(bw,n),S=bNe(bw,n),[M,P]=K.useState(null),N=ba(t,J=>P(J),w.onItemTextChange,J=>a.itemTextRefCallback?.(J,w.value,w.disabled)),$=M?.textContent,G=K.useMemo(()=>D.jsx("option",{value:w.value,disabled:w.disabled,children:$},w.value),[w.disabled,w.value,$]),{onNativeOptionAdd:q,onNativeOptionRemove:V}=S;return qs(()=>(q(G),()=>V(G)),[q,V,G]),D.jsxs(D.Fragment,{children:[D.jsx(ii.span,{id:w.textId,...d,ref:N}),w.isSelected&&m.valueNode&&!m.valueNodeHasChildren?k1.createPortal(d.children,m.valueNode):null]})});VQ.displayName=bw;var UQ="SelectItemIndicator",$Q=K.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return BQ(UQ,n).isSelected?D.jsx(ii.span,{"aria-hidden":!0,...i,ref:t}):null});$Q.displayName=UQ;var UL="SelectScrollUpButton",qQ=K.forwardRef((e,t)=>{const n=Ay(UL,e.__scopeSelect),i=Pj(UL,e.__scopeSelect),[c,d]=K.useState(!1),m=ba(t,i.onScrollButtonChange);return qs(()=>{if(n.viewport&&n.isPositioned){let a=function(){const S=w.scrollTop>0;d(S)};const w=n.viewport;return a(),w.addEventListener("scroll",a),()=>w.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),c?D.jsx(GQ,{...e,ref:m,onAutoScroll:()=>{const{viewport:a,selectedItem:w}=n;a&&w&&(a.scrollTop=a.scrollTop-w.offsetHeight)}}):null});qQ.displayName=UL;var $L="SelectScrollDownButton",HQ=K.forwardRef((e,t)=>{const n=Ay($L,e.__scopeSelect),i=Pj($L,e.__scopeSelect),[c,d]=K.useState(!1),m=ba(t,i.onScrollButtonChange);return qs(()=>{if(n.viewport&&n.isPositioned){let a=function(){const S=w.scrollHeight-w.clientHeight,M=Math.ceil(w.scrollTop)<S;d(M)};const w=n.viewport;return a(),w.addEventListener("scroll",a),()=>w.removeEventListener("scroll",a)}},[n.viewport,n.isPositioned]),c?D.jsx(GQ,{...e,ref:m,onAutoScroll:()=>{const{viewport:a,selectedItem:w}=n;a&&w&&(a.scrollTop=a.scrollTop+w.offsetHeight)}}):null});HQ.displayName=$L;var GQ=K.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:i,...c}=e,d=Ay("SelectScrollButton",n),m=K.useRef(null),a=xC(n),w=K.useCallback(()=>{m.current!==null&&(window.clearInterval(m.current),m.current=null)},[]);return K.useEffect(()=>()=>w(),[w]),qs(()=>{a().find(M=>M.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[a]),D.jsx(ii.div,{"aria-hidden":!0,...c,ref:t,style:{flexShrink:0,...c.style},onPointerDown:vr(c.onPointerDown,()=>{m.current===null&&(m.current=window.setInterval(i,50))}),onPointerMove:vr(c.onPointerMove,()=>{d.onItemLeave?.(),m.current===null&&(m.current=window.setInterval(i,50))}),onPointerLeave:vr(c.onPointerLeave,()=>{w()})})}),kNe="SelectSeparator",LNe=K.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return D.jsx(ii.div,{"aria-hidden":!0,...i,ref:t})});LNe.displayName=kNe;var qL="SelectArrow",NNe=K.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,c=bC(n),d=Ey(qL,n),m=Ay(qL,n);return d.open&&m.position==="popper"?D.jsx(y2,{...c,...i,ref:t}):null});NNe.displayName=qL;var zNe="SelectBubbleInput",WQ=K.forwardRef(({__scopeSelect:e,value:t,...n},i)=>{const c=K.useRef(null),d=ba(i,c),m=mNe(t);return K.useEffect(()=>{const a=c.current;if(!a)return;const w=window.HTMLSelectElement.prototype,M=Object.getOwnPropertyDescriptor(w,"value").set;if(m!==t&&M){const P=new Event("change",{bubbles:!0});M.call(a,t),a.dispatchEvent(P)}},[m,t]),D.jsx(ii.select,{...n,style:{...P7,...n.style},ref:d,defaultValue:t})});WQ.displayName=zNe;function XQ(e){return e===""||e===void 0}function ZQ(e){const t=Yd(e),n=K.useRef(""),i=K.useRef(0),c=K.useCallback(m=>{const a=n.current+m;t(a),(function w(S){n.current=S,window.clearTimeout(i.current),S!==""&&(i.current=window.setTimeout(()=>w(""),1e3))})(a)},[t]),d=K.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return K.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,c,d]}function YQ(e,t,n){const c=t.length>1&&Array.from(t).every(S=>S===t[0])?t[0]:t,d=n?e.indexOf(n):-1;let m=jNe(e,Math.max(d,0));c.length===1&&(m=m.filter(S=>S!==n));const w=m.find(S=>S.textValue.toLowerCase().startsWith(c.toLowerCase()));return w!==n?w:void 0}function jNe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var BNe=EQ,FNe=CQ,VNe=PQ,UNe=OQ,$Ne=RQ,qNe=IQ,HNe=NQ,GNe=FQ,WNe=VQ,XNe=$Q,ZNe=qQ,YNe=HQ;function KNe({...e}){return D.jsx(BNe,{"data-slot":"select",...e})}function JNe({...e}){return D.jsx(VNe,{"data-slot":"select-value",...e})}function QNe({className:e,size:t="default",children:n,...i}){return D.jsxs(FNe,{"data-slot":"select-trigger","data-size":t,className:bn("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...i,children:[n,D.jsx(UNe,{asChild:!0,children:D.jsx(t2,{className:"size-4 opacity-50"})})]})}function eze({className:e,children:t,position:n="popper",...i}){return D.jsx($Ne,{children:D.jsxs(qNe,{"data-slot":"select-content",className:bn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...i,children:[D.jsx(tze,{}),D.jsx(HNe,{className:bn("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),D.jsx(nze,{})]})})}function QT({className:e,children:t,...n}){return D.jsxs(GNe,{"data-slot":"select-item",className:bn("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[D.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:D.jsx(XNe,{children:D.jsx(e2,{className:"size-4"})})}),D.jsx(WNe,{children:t})]})}function tze({className:e,...t}){return D.jsx(ZNe,{"data-slot":"select-scroll-up-button",className:bn("flex cursor-default items-center justify-center py-1",e),...t,children:D.jsx(Pse,{className:"size-4"})})}function nze({className:e,...t}){return D.jsx(YNe,{"data-slot":"select-scroll-down-button",className:bn("flex cursor-default items-center justify-center py-1",e),...t,children:D.jsx(t2,{className:"size-4"})})}var rf="Accordion",rze=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Oj,ize,aze]=x2(rf),[wC,$Be]=ih(rf,[aze,gW]),Rj=gW(),KQ=Ce.forwardRef((e,t)=>{const{type:n,...i}=e,c=i,d=i;return D.jsx(Oj.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?D.jsx(cze,{...d,ref:t}):D.jsx(lze,{...c,ref:t})})});KQ.displayName=rf;var[JQ,oze]=wC(rf),[QQ,sze]=wC(rf,{collapsible:!1}),lze=Ce.forwardRef((e,t)=>{const{value:n,defaultValue:i,onValueChange:c=()=>{},collapsible:d=!1,...m}=e,[a,w]=mp({prop:n,defaultProp:i??"",onChange:c,caller:rf});return D.jsx(JQ,{scope:e.__scopeAccordion,value:Ce.useMemo(()=>a?[a]:[],[a]),onItemOpen:w,onItemClose:Ce.useCallback(()=>d&&w(""),[d,w]),children:D.jsx(QQ,{scope:e.__scopeAccordion,collapsible:d,children:D.jsx(eee,{...m,ref:t})})})}),cze=Ce.forwardRef((e,t)=>{const{value:n,defaultValue:i,onValueChange:c=()=>{},...d}=e,[m,a]=mp({prop:n,defaultProp:i??[],onChange:c,caller:rf}),w=Ce.useCallback(M=>a((P=[])=>[...P,M]),[a]),S=Ce.useCallback(M=>a((P=[])=>P.filter(N=>N!==M)),[a]);return D.jsx(JQ,{scope:e.__scopeAccordion,value:m,onItemOpen:w,onItemClose:S,children:D.jsx(QQ,{scope:e.__scopeAccordion,collapsible:!0,children:D.jsx(eee,{...d,ref:t})})})}),[uze,SC]=wC(rf),eee=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:i,dir:c,orientation:d="vertical",...m}=e,a=Ce.useRef(null),w=ba(a,t),S=ize(n),P=b2(c)==="ltr",N=vr(e.onKeyDown,$=>{if(!rze.includes($.key))return;const G=$.target,q=S().filter(ve=>!ve.ref.current?.disabled),V=q.findIndex(ve=>ve.ref.current===G),J=q.length;if(V===-1)return;$.preventDefault();let ee=V;const re=0,fe=J-1,ne=()=>{ee=V+1,ee>fe&&(ee=re)},ce=()=>{ee=V-1,ee<re&&(ee=fe)};switch($.key){case"Home":ee=re;break;case"End":ee=fe;break;case"ArrowRight":d==="horizontal"&&(P?ne():ce());break;case"ArrowDown":d==="vertical"&&ne();break;case"ArrowLeft":d==="horizontal"&&(P?ce():ne());break;case"ArrowUp":d==="vertical"&&ce();break}const me=ee%J;q[me].ref.current?.focus()});return D.jsx(uze,{scope:n,disabled:i,direction:c,orientation:d,children:D.jsx(Oj.Slot,{scope:n,children:D.jsx(ii.div,{...m,"data-orientation":d,ref:w,onKeyDown:i?void 0:N})})})}),NA="AccordionItem",[hze,Ij]=wC(NA),tee=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,value:i,...c}=e,d=SC(NA,n),m=oze(NA,n),a=Rj(n),w=ol(),S=i&&m.value.includes(i)||!1,M=d.disabled||e.disabled;return D.jsx(hze,{scope:n,open:S,disabled:M,triggerId:w,children:D.jsx(wle,{"data-orientation":d.orientation,"data-state":see(S),...a,...c,ref:t,disabled:M,open:S,onOpenChange:P=>{P?m.onItemOpen(i):m.onItemClose(i)}})})});tee.displayName=NA;var nee="AccordionHeader",ree=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,...i}=e,c=SC(rf,n),d=Ij(nee,n);return D.jsx(ii.h3,{"data-orientation":c.orientation,"data-state":see(d.open),"data-disabled":d.disabled?"":void 0,...i,ref:t})});ree.displayName=nee;var HL="AccordionTrigger",iee=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,...i}=e,c=SC(rf,n),d=Ij(HL,n),m=sze(HL,n),a=Rj(n);return D.jsx(Oj.ItemSlot,{scope:n,children:D.jsx(Sle,{"aria-disabled":d.open&&!m.collapsible||void 0,"data-orientation":c.orientation,id:d.triggerId,...a,...i,ref:t})})});iee.displayName=HL;var aee="AccordionContent",oee=Ce.forwardRef((e,t)=>{const{__scopeAccordion:n,...i}=e,c=SC(rf,n),d=Ij(aee,n),m=Rj(n);return D.jsx(Tle,{role:"region","aria-labelledby":d.triggerId,"data-orientation":c.orientation,...m,...i,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});oee.displayName=aee;function see(e){return e?"open":"closed"}var dze=KQ,fze=tee,pze=ree,mze=iee,gze=oee;function yze({...e}){return D.jsx(dze,{"data-slot":"accordion",...e})}function _ze({className:e,...t}){return D.jsx(fze,{"data-slot":"accordion-item",className:bn("border-b last:border-b-0",e),...t})}function vze({className:e,children:t,...n}){return D.jsx(pze,{className:"flex",children:D.jsxs(mze,{"data-slot":"accordion-trigger",className:bn("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,D.jsx(t2,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function xze({className:e,children:t,...n}){return D.jsx(gze,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...n,children:D.jsx("div",{className:bn("pt-0 pb-4",e),children:t})})}var lee="AlertDialog",[bze,qBe]=ih(lee,[HW]),Zm=HW(),cee=e=>{const{__scopeAlertDialog:t,...n}=e,i=Zm(t);return D.jsx(l2,{...i,...n,modal:!0})};cee.displayName=lee;var wze="AlertDialogTrigger",uee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...i}=e,c=Zm(n);return D.jsx(s7,{...c,...i,ref:t})});uee.displayName=wze;var Sze="AlertDialogPortal",hee=e=>{const{__scopeAlertDialog:t,...n}=e,i=Zm(t);return D.jsx(c2,{...i,...n})};hee.displayName=Sze;var Tze="AlertDialogOverlay",dee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...i}=e,c=Zm(n);return D.jsx(u2,{...c,...i,ref:t})});dee.displayName=Tze;var jx="AlertDialogContent",[Eze,Aze]=bze(jx),Cze=pW("AlertDialogContent"),fee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:i,...c}=e,d=Zm(n),m=K.useRef(null),a=ba(t,m),w=K.useRef(null);return D.jsx(yue,{contentName:jx,titleName:pee,docsSlug:"alert-dialog",children:D.jsx(Eze,{scope:n,cancelRef:w,children:D.jsxs(h2,{role:"alertdialog",...d,...c,ref:a,onOpenAutoFocus:vr(c.onOpenAutoFocus,S=>{S.preventDefault(),w.current?.focus({preventScroll:!0})}),onPointerDownOutside:S=>S.preventDefault(),onInteractOutside:S=>S.preventDefault(),children:[D.jsx(Cze,{children:i}),D.jsx(Pze,{contentRef:m})]})})})});fee.displayName=jx;var pee="AlertDialogTitle",mee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...i}=e,c=Zm(n);return D.jsx(cN,{...c,...i,ref:t})});mee.displayName=pee;var gee="AlertDialogDescription",yee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...i}=e,c=Zm(n);return D.jsx(uN,{...c,...i,ref:t})});yee.displayName=gee;var Mze="AlertDialogAction",_ee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...i}=e,c=Zm(n);return D.jsx($1,{...c,...i,ref:t})});_ee.displayName=Mze;var vee="AlertDialogCancel",xee=K.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...i}=e,{cancelRef:c}=Aze(vee,n),d=Zm(n),m=ba(t,c);return D.jsx($1,{...d,...i,ref:m})});xee.displayName=vee;var Pze=({contentRef:e})=>{const t=`\`${jx}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${jx}\` by passing a \`${gee}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${jx}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return K.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Oze=cee,Rze=uee,Ize=hee,Dze=dee,kze=fee,Lze=_ee,Nze=xee,zze=mee,jze=yee;function zA({...e}){return D.jsx(Oze,{"data-slot":"alert-dialog",...e})}function jA({...e}){return D.jsx(Rze,{"data-slot":"alert-dialog-trigger",...e})}function Bze({...e}){return D.jsx(Ize,{"data-slot":"alert-dialog-portal",...e})}function Fze({className:e,...t}){return D.jsx(Dze,{"data-slot":"alert-dialog-overlay",className:bn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function BA({className:e,...t}){return D.jsxs(Bze,{children:[D.jsx(Fze,{}),D.jsx(kze,{"data-slot":"alert-dialog-content",className:bn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t})]})}function FA({className:e,...t}){return D.jsx("div",{"data-slot":"alert-dialog-header",className:bn("flex flex-col gap-2 text-center sm:text-left",e),...t})}function VA({className:e,...t}){return D.jsx("div",{"data-slot":"alert-dialog-footer",className:bn("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function UA({className:e,...t}){return D.jsx(zze,{"data-slot":"alert-dialog-title",className:bn("text-lg font-semibold",e),...t})}function $A({className:e,...t}){return D.jsx(jze,{"data-slot":"alert-dialog-description",className:bn("text-muted-foreground text-sm",e),...t})}function nG({className:e,...t}){return D.jsx(Lze,{className:bn(Fx(),e),...t})}function qA({className:e,...t}){return D.jsx(Nze,{className:bn(Fx({variant:"outline"}),e),...t})}function Vze(e,t,n="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:n}).format(t).split(/\s/g).slice(2).join(" ")}const Uze={},ww={};function $_(e,t){try{const i=(Uze[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(t).split("GMT")[1];return i in ww?ww[i]:rG(i,i.split(":"))}catch{if(e in ww)return ww[e];const n=e?.match($ze);return n?rG(e,n.slice(1)):NaN}}const $ze=/([+-]\d\d):?(\d\d)?/;function rG(e,t){const n=+(t[0]||0),i=+(t[1]||0),c=+(t[2]||0)/60;return ww[e]=n*60+i>0?n*60+i+c:n*60-i-c}class sp extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN($_(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),bee(this),GL(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new sp(...n,t):new sp(Date.now(),t)}withTimeZone(t){return new sp(+this,t)}getTimezoneOffset(){const t=-$_(this.timeZone,this);return t>0?Math.floor(t):Math.ceil(t)}setTime(t){return Date.prototype.setTime.apply(this,arguments),GL(this),+this}[Symbol.for("constructDateFrom")](t){return new sp(+new Date(t),this.timeZone)}}const iG=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!iG.test(e))return;const t=e.replace(iG,"$1UTC");sp.prototype[t]&&(e.startsWith("get")?sp.prototype[e]=function(){return this.internal[t]()}:(sp.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),qze(this),+this},sp.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),GL(this),+this}))});function GL(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-$_(e.timeZone,e)*60))}function qze(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),bee(e)}function bee(e){const t=$_(e.timeZone,e),n=t>0?Math.floor(t):Math.ceil(t),i=new Date(+e);i.setUTCHours(i.getUTCHours()-1);const c=-new Date(+e).getTimezoneOffset(),d=-new Date(+i).getTimezoneOffset(),m=c-d,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();m&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+m);const w=c-n;w&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+w);const S=new Date(+e);S.setUTCSeconds(0);const M=c>0?S.getSeconds():(S.getSeconds()-60)%60,P=Math.round(-($_(e.timeZone,e)*60))%60;(P||M)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+P),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+P+M));const N=$_(e.timeZone,e),$=N>0?Math.floor(N):Math.ceil(N),q=-new Date(+e).getTimezoneOffset()-$,V=$!==n,J=q-w;if(V&&J){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+J);const ee=$_(e.timeZone,e),re=ee>0?Math.floor(ee):Math.ceil(ee),fe=$-re;fe&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+fe),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+fe))}}class sc extends sp{static tz(t,...n){return n.length?new sc(...n,t):new sc(Date.now(),t)}toISOString(){const[t,n,i]=this.tzComponents(),c=`${t}${n}:${i}`;return this.internal.toISOString().slice(0,-1)+c}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,i,c]=this.internal.toUTCString().split(" ");return`${t?.slice(0,-1)} ${i} ${n} ${c}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,i,c]=this.tzComponents();return`${t} GMT${n}${i}${c} (${Vze(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:n?.timeZone||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:n?.timeZone||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:n?.timeZone||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",i=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),c=String(Math.abs(t)%60).padStart(2,"0");return[n,i,c]}withTimeZone(t){return new sc(+this,t)}[Symbol.for("constructDateFrom")](t){return new sc(+new Date(t),this.timeZone)}}var ni;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(ni||(ni={}));var rs;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(rs||(rs={}));var Xd;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(Xd||(Xd={}));var Ju;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(Ju||(Ju={}));const aG=5,Hze=4;function Gze(e,t){const n=t.startOfMonth(e),i=n.getDay()>0?n.getDay():7,c=t.addDays(e,-i+1),d=t.addDays(c,aG*7-1);return t.getMonth(e)===t.getMonth(d)?aG:Hze}function wee(e,t){const n=t.startOfMonth(e),i=n.getDay();return i===1?n:i===0?t.addDays(n,-6):t.addDays(n,-1*(i-1))}function Wze(e,t){const n=wee(e,t),i=Gze(e,t);return t.addDays(n,i*7-1)}class Ym{constructor(t,n){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?sc.tz(this.options.timeZone):new this.Date,this.newDate=(i,c,d)=>this.overrides?.newDate?this.overrides.newDate(i,c,d):this.options.timeZone?new sc(i,c,d,this.options.timeZone):new Date(i,c,d),this.addDays=(i,c)=>this.overrides?.addDays?this.overrides.addDays(i,c):pQ(i,c),this.addMonths=(i,c)=>this.overrides?.addMonths?this.overrides.addMonths(i,c):mQ(i,c),this.addWeeks=(i,c)=>this.overrides?.addWeeks?this.overrides.addWeeks(i,c):Jke(i,c),this.addYears=(i,c)=>this.overrides?.addYears?this.overrides.addYears(i,c):Qke(i,c),this.differenceInCalendarDays=(i,c)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(i,c):yQ(i,c),this.differenceInCalendarMonths=(i,c)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(i,c):iLe(i,c),this.eachMonthOfInterval=i=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(i):sLe(i),this.endOfBroadcastWeek=i=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(i):Wze(i,this),this.endOfISOWeek=i=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(i):uLe(i),this.endOfMonth=i=>this.overrides?.endOfMonth?this.overrides.endOfMonth(i):aLe(i),this.endOfWeek=(i,c)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(i,c):xQ(i,this.options),this.endOfYear=i=>this.overrides?.endOfYear?this.overrides.endOfYear(i):cLe(i),this.format=(i,c,d)=>{const m=this.overrides?.format?this.overrides.format(i,c,this.options):wl(i,c,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(m):m},this.getISOWeek=i=>this.overrides?.getISOWeek?this.overrides.getISOWeek(i):bQ(i),this.getMonth=(i,c)=>this.overrides?.getMonth?this.overrides.getMonth(i,this.options):sNe(i,this.options),this.getYear=(i,c)=>this.overrides?.getYear?this.overrides.getYear(i,this.options):lNe(i,this.options),this.getWeek=(i,c)=>this.overrides?.getWeek?this.overrides.getWeek(i,this.options):SQ(i,this.options),this.isAfter=(i,c)=>this.overrides?.isAfter?this.overrides.isAfter(i,c):cNe(i,c),this.isBefore=(i,c)=>this.overrides?.isBefore?this.overrides.isBefore(i,c):uNe(i,c),this.isDate=i=>this.overrides?.isDate?this.overrides.isDate(i):_Q(i),this.isSameDay=(i,c)=>this.overrides?.isSameDay?this.overrides.isSameDay(i,c):nLe(i,c),this.isSameMonth=(i,c)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(i,c):hNe(i,c),this.isSameYear=(i,c)=>this.overrides?.isSameYear?this.overrides.isSameYear(i,c):dNe(i,c),this.max=i=>this.overrides?.max?this.overrides.max(i):eLe(i),this.min=i=>this.overrides?.min?this.overrides.min(i):tLe(i),this.setMonth=(i,c)=>this.overrides?.setMonth?this.overrides.setMonth(i,c):fNe(i,c),this.setYear=(i,c)=>this.overrides?.setYear?this.overrides.setYear(i,c):pNe(i,c),this.startOfBroadcastWeek=(i,c)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(i,this):wee(i,this),this.startOfDay=i=>this.overrides?.startOfDay?this.overrides.startOfDay(i):M1(i),this.startOfISOWeek=i=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(i):C1(i),this.startOfMonth=i=>this.overrides?.startOfMonth?this.overrides.startOfMonth(i):lLe(i),this.startOfWeek=(i,c)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(i,this.options):p0(i,this.options),this.startOfYear=i=>this.overrides?.startOfYear?this.overrides.startOfYear(i):vQ(i),this.options={locale:Mj,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),i={};for(let c=0;c<10;c++)i[c.toString()]=n.format(c);return i}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,i=>n[i]||i)}formatNumber(t){return this.replaceDigits(t.toString())}}const wp=new Ym;class See{constructor(t,n,i=wp){this.date=t,this.displayMonth=n,this.outside=!!(n&&!i.isSameMonth(t,n)),this.dateLib=i}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class Xze{constructor(t,n){this.date=t,this.weeks=n}}class Zze{constructor(t,n){this.days=n,this.weekNumber=t}}function Pm(e,t,n=!1,i=wp){let{from:c,to:d}=e;const{differenceInCalendarDays:m,isSameDay:a}=i;return c&&d?(m(d,c)<0&&([c,d]=[d,c]),m(t,c)>=(n?1:0)&&m(d,t)>=(n?1:0)):!n&&d?a(d,t):!n&&c?a(c,t):!1}function Tee(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Dj(e){return!!(e&&typeof e=="object"&&"from"in e)}function Eee(e){return!!(e&&typeof e=="object"&&"after"in e)}function Aee(e){return!!(e&&typeof e=="object"&&"before"in e)}function Cee(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Mee(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Om(e,t,n=wp){const i=Array.isArray(t)?t:[t],{isSameDay:c,differenceInCalendarDays:d,isAfter:m}=n;return i.some(a=>{if(typeof a=="boolean")return a;if(n.isDate(a))return c(e,a);if(Mee(a,n))return a.includes(e);if(Dj(a))return Pm(a,e,!1,n);if(Cee(a))return Array.isArray(a.dayOfWeek)?a.dayOfWeek.includes(e.getDay()):a.dayOfWeek===e.getDay();if(Tee(a)){const w=d(a.before,e),S=d(a.after,e),M=w>0,P=S<0;return m(a.before,a.after)?P&&M:M||P}return Eee(a)?d(e,a.after)>0:Aee(a)?d(a.before,e)>0:typeof a=="function"?a(e):!1})}function Yze(e,t,n,i,c){const{disabled:d,hidden:m,modifiers:a,showOutsideDays:w,broadcastCalendar:S,today:M}=t,{isSameDay:P,isSameMonth:N,startOfMonth:$,isBefore:G,endOfMonth:q,isAfter:V}=c,J=n&&$(n),ee=i&&q(i),re={[rs.focused]:[],[rs.outside]:[],[rs.disabled]:[],[rs.hidden]:[],[rs.today]:[]},fe={};for(const ne of e){const{date:ce,displayMonth:me}=ne,ve=!!(me&&!N(ce,me)),De=!!(J&&G(ce,J)),Ye=!!(ee&&V(ce,ee)),ze=!!(d&&Om(ce,d,c)),tt=!!(m&&Om(ce,m,c))||De||Ye||!S&&!w&&ve||S&&w===!1&&ve,at=P(ce,M??c.today());ve&&re.outside.push(ne),ze&&re.disabled.push(ne),tt&&re.hidden.push(ne),at&&re.today.push(ne),a&&Object.keys(a).forEach(ct=>{const ht=a?.[ct];ht&&Om(ce,ht,c)&&(fe[ct]?fe[ct].push(ne):fe[ct]=[ne])})}return ne=>{const ce={[rs.focused]:!1,[rs.disabled]:!1,[rs.hidden]:!1,[rs.outside]:!1,[rs.today]:!1},me={};for(const ve in re){const De=re[ve];ce[ve]=De.some(Ye=>Ye===ne)}for(const ve in fe)me[ve]=fe[ve].some(De=>De===ne);return{...ce,...me}}}function Kze(e,t,n={}){return Object.entries(e).filter(([,c])=>c===!0).reduce((c,[d])=>(n[d]?c.push(n[d]):t[rs[d]]?c.push(t[rs[d]]):t[Xd[d]]&&c.push(t[Xd[d]]),c),[t[ni.Day]])}function Jze(e){return Ce.createElement("button",{...e})}function Qze(e){return Ce.createElement("span",{...e})}function eje(e){const{size:t=24,orientation:n="left",className:i}=e;return Ce.createElement("svg",{className:i,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&Ce.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&Ce.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&Ce.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&Ce.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function tje(e){const{day:t,modifiers:n,...i}=e;return Ce.createElement("td",{...i})}function nje(e){const{day:t,modifiers:n,...i}=e,c=Ce.useRef(null);return Ce.useEffect(()=>{n.focused&&c.current?.focus()},[n.focused]),Ce.createElement("button",{ref:c,...i})}function rje(e){const{options:t,className:n,components:i,classNames:c,...d}=e,m=[c[ni.Dropdown],n].join(" "),a=t?.find(({value:w})=>w===d.value);return Ce.createElement("span",{"data-disabled":d.disabled,className:c[ni.DropdownRoot]},Ce.createElement(i.Select,{className:m,...d},t?.map(({value:w,label:S,disabled:M})=>Ce.createElement(i.Option,{key:w,value:w,disabled:M},S))),Ce.createElement("span",{className:c[ni.CaptionLabel],"aria-hidden":!0},a?.label,Ce.createElement(i.Chevron,{orientation:"down",size:18,className:c[ni.Chevron]})))}function ije(e){return Ce.createElement("div",{...e})}function aje(e){return Ce.createElement("div",{...e})}function oje(e){const{calendarMonth:t,displayIndex:n,...i}=e;return Ce.createElement("div",{...i},e.children)}function sje(e){const{calendarMonth:t,displayIndex:n,...i}=e;return Ce.createElement("div",{...i})}function lje(e){return Ce.createElement("table",{...e})}function cje(e){return Ce.createElement("div",{...e})}const Pee=K.createContext(void 0);function gS(){const e=K.useContext(Pee);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function uje(e){const{components:t}=gS();return Ce.createElement(t.Dropdown,{...e})}function hje(e){const{onPreviousClick:t,onNextClick:n,previousMonth:i,nextMonth:c,...d}=e,{components:m,classNames:a,labels:{labelPrevious:w,labelNext:S}}=gS(),M=K.useCallback(N=>{c&&n?.(N)},[c,n]),P=K.useCallback(N=>{i&&t?.(N)},[i,t]);return Ce.createElement("nav",{...d},Ce.createElement(m.PreviousMonthButton,{type:"button",className:a[ni.PreviousMonthButton],tabIndex:i?void 0:-1,"aria-disabled":i?void 0:!0,"aria-label":w(i),onClick:P},Ce.createElement(m.Chevron,{disabled:i?void 0:!0,className:a[ni.Chevron],orientation:"left"})),Ce.createElement(m.NextMonthButton,{type:"button",className:a[ni.NextMonthButton],tabIndex:c?void 0:-1,"aria-disabled":c?void 0:!0,"aria-label":S(c),onClick:M},Ce.createElement(m.Chevron,{disabled:c?void 0:!0,orientation:"right",className:a[ni.Chevron]})))}function dje(e){const{components:t}=gS();return Ce.createElement(t.Button,{...e})}function fje(e){return Ce.createElement("option",{...e})}function pje(e){const{components:t}=gS();return Ce.createElement(t.Button,{...e})}function mje(e){const{rootRef:t,...n}=e;return Ce.createElement("div",{...n,ref:t})}function gje(e){return Ce.createElement("select",{...e})}function yje(e){const{week:t,...n}=e;return Ce.createElement("tr",{...n})}function _je(e){return Ce.createElement("th",{...e})}function vje(e){return Ce.createElement("thead",{"aria-hidden":!0},Ce.createElement("tr",{...e}))}function xje(e){const{week:t,...n}=e;return Ce.createElement("th",{...n})}function bje(e){return Ce.createElement("th",{...e})}function wje(e){return Ce.createElement("tbody",{...e})}function Sje(e){const{components:t}=gS();return Ce.createElement(t.Dropdown,{...e})}const Tje=Object.freeze(Object.defineProperty({__proto__:null,Button:Jze,CaptionLabel:Qze,Chevron:eje,Day:tje,DayButton:nje,Dropdown:rje,DropdownNav:ije,Footer:aje,Month:oje,MonthCaption:sje,MonthGrid:lje,Months:cje,MonthsDropdown:uje,Nav:hje,NextMonthButton:dje,Option:fje,PreviousMonthButton:pje,Root:mje,Select:gje,Week:yje,WeekNumber:xje,WeekNumberHeader:bje,Weekday:_je,Weekdays:vje,Weeks:wje,YearsDropdown:Sje},Symbol.toStringTag,{value:"Module"}));function Eje(e){return{...Tje,...e}}function Aje(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,i])=>{n.startsWith("data-")&&(t[n]=i)}),t}function kj(){const e={};for(const t in ni)e[ni[t]]=`rdp-${ni[t]}`;for(const t in rs)e[rs[t]]=`rdp-${rs[t]}`;for(const t in Xd)e[Xd[t]]=`rdp-${Xd[t]}`;for(const t in Ju)e[Ju[t]]=`rdp-${Ju[t]}`;return e}function Oee(e,t,n){return(n??new Ym(t)).format(e,"LLLL y")}const Cje=Oee;function Mje(e,t,n){return(n??new Ym(t)).format(e,"d")}function Pje(e,t=wp){return t.format(e,"LLLL")}function Oje(e,t=wp){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function Rje(){return""}function Ije(e,t,n){return(n??new Ym(t)).format(e,"cccccc")}function Ree(e,t=wp){return t.format(e,"yyyy")}const Dje=Ree,kje=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Oee,formatDay:Mje,formatMonthCaption:Cje,formatMonthDropdown:Pje,formatWeekNumber:Oje,formatWeekNumberHeader:Rje,formatWeekdayName:Ije,formatYearCaption:Dje,formatYearDropdown:Ree},Symbol.toStringTag,{value:"Module"}));function Lje(e){return e?.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e?.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...kje,...e}}function Nje(e,t,n,i,c){const{startOfMonth:d,startOfYear:m,endOfYear:a,eachMonthOfInterval:w,getMonth:S}=c;return w({start:m(e),end:a(e)}).map(N=>{const $=i.formatMonthDropdown(N,c),G=S(N),q=t&&N<d(t)||n&&N>d(n)||!1;return{value:G,label:$,disabled:q}})}function zje(e,t={},n={}){let i={...t?.[ni.Day]};return Object.entries(e).filter(([,c])=>c===!0).forEach(([c])=>{i={...i,...n?.[c]}}),i}function jje(e,t,n){const i=e.today(),c=t?e.startOfISOWeek(i):e.startOfWeek(i),d=[];for(let m=0;m<7;m++){const a=e.addDays(c,m);d.push(a)}return d}function Bje(e,t,n,i){if(!e||!t)return;const{startOfYear:c,endOfYear:d,addYears:m,getYear:a,isBefore:w,isSameYear:S}=i,M=c(e),P=d(t),N=[];let $=M;for(;w($,P)||S($,P);)N.push($),$=m($,1);return N.map(G=>{const q=n.formatYearDropdown(G,i);return{value:a(G),label:q,disabled:!1}})}function Iee(e,t,n){return(n??new Ym(t)).format(e,"LLLL y")}const Fje=Iee;function Vje(e,t,n,i){let c=(i??new Ym(n)).format(e,"PPPP");return t?.today&&(c=`Today, ${c}`),c}function Dee(e,t,n,i){let c=(i??new Ym(n)).format(e,"PPPP");return t.today&&(c=`Today, ${c}`),t.selected&&(c=`${c}, selected`),c}const Uje=Dee;function $je(){return""}function qje(e){return"Choose the Month"}function Hje(e){return"Go to the Next Month"}function Gje(e){return"Go to the Previous Month"}function Wje(e,t,n){return(n??new Ym(t)).format(e,"cccc")}function Xje(e,t){return`Week ${e}`}function Zje(e){return"Week Number"}function Yje(e){return"Choose the Year"}const Kje=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:Fje,labelDay:Uje,labelDayButton:Dee,labelGrid:Iee,labelGridcell:Vje,labelMonthDropdown:qje,labelNav:$je,labelNext:Hje,labelPrevious:Gje,labelWeekNumber:Xje,labelWeekNumberHeader:Zje,labelWeekday:Wje,labelYearDropdown:Yje},Symbol.toStringTag,{value:"Module"})),yS=e=>e instanceof HTMLElement?e:null,AD=e=>[...e.querySelectorAll("[data-animated-month]")??[]],Jje=e=>yS(e.querySelector("[data-animated-month]")),CD=e=>yS(e.querySelector("[data-animated-caption]")),MD=e=>yS(e.querySelector("[data-animated-weeks]")),Qje=e=>yS(e.querySelector("[data-animated-nav]")),e3e=e=>yS(e.querySelector("[data-animated-weekdays]"));function t3e(e,t,{classNames:n,months:i,focused:c,dateLib:d}){const m=K.useRef(null),a=K.useRef(i),w=K.useRef(!1);K.useLayoutEffect(()=>{const S=a.current;if(a.current=i,!t||!e.current||!(e.current instanceof HTMLElement)||i.length===0||S.length===0||i.length!==S.length)return;const M=d.isSameMonth(i[0].date,S[0].date),P=d.isAfter(i[0].date,S[0].date),N=P?n[Ju.caption_after_enter]:n[Ju.caption_before_enter],$=P?n[Ju.weeks_after_enter]:n[Ju.weeks_before_enter],G=m.current,q=e.current.cloneNode(!0);if(q instanceof HTMLElement?(AD(q).forEach(re=>{if(!(re instanceof HTMLElement))return;const fe=Jje(re);fe&&re.contains(fe)&&re.removeChild(fe);const ne=CD(re);ne&&ne.classList.remove(N);const ce=MD(re);ce&&ce.classList.remove($)}),m.current=q):m.current=null,w.current||M||c)return;const V=G instanceof HTMLElement?AD(G):[],J=AD(e.current);if(J&&J.every(ee=>ee instanceof HTMLElement)&&V&&V.every(ee=>ee instanceof HTMLElement)){w.current=!0,e.current.style.isolation="isolate";const ee=Qje(e.current);ee&&(ee.style.zIndex="1"),J.forEach((re,fe)=>{const ne=V[fe];if(!ne)return;re.style.position="relative",re.style.overflow="hidden";const ce=CD(re);ce&&ce.classList.add(N);const me=MD(re);me&&me.classList.add($);const ve=()=>{w.current=!1,e.current&&(e.current.style.isolation=""),ee&&(ee.style.zIndex=""),ce&&ce.classList.remove(N),me&&me.classList.remove($),re.style.position="",re.style.overflow="",re.contains(ne)&&re.removeChild(ne)};ne.style.pointerEvents="none",ne.style.position="absolute",ne.style.overflow="hidden",ne.setAttribute("aria-hidden","true");const De=e3e(ne);De&&(De.style.opacity="0");const Ye=CD(ne);Ye&&(Ye.classList.add(P?n[Ju.caption_before_exit]:n[Ju.caption_after_exit]),Ye.addEventListener("animationend",ve));const ze=MD(ne);ze&&ze.classList.add(P?n[Ju.weeks_before_exit]:n[Ju.weeks_after_exit]),re.insertBefore(ne,re.firstChild)})}})}function n3e(e,t,n,i){const c=e[0],d=e[e.length-1],{ISOWeek:m,fixedWeeks:a,broadcastCalendar:w}=n??{},{addDays:S,differenceInCalendarDays:M,differenceInCalendarMonths:P,endOfBroadcastWeek:N,endOfISOWeek:$,endOfMonth:G,endOfWeek:q,isAfter:V,startOfBroadcastWeek:J,startOfISOWeek:ee,startOfWeek:re}=i,fe=w?J(c,i):m?ee(c):re(c),ne=w?N(d):m?$(G(d)):q(G(d)),ce=M(ne,fe),me=P(d,c)+1,ve=[];for(let ze=0;ze<=ce;ze++){const tt=S(fe,ze);if(t&&V(tt,t))break;ve.push(tt)}const Ye=(w?35:42)*me;if(a&&ve.length<Ye){const ze=Ye-ve.length;for(let tt=0;tt<ze;tt++){const at=S(ve[ve.length-1],1);ve.push(at)}}return ve}function r3e(e){const t=[];return e.reduce((n,i)=>{const c=i.weeks.reduce((d,m)=>[...d,...m.days],t);return[...n,...c]},t)}function i3e(e,t,n,i){const{numberOfMonths:c=1}=n,d=[];for(let m=0;m<c;m++){const a=i.addMonths(e,m);if(t&&a>t)break;d.push(a)}return d}function oG(e,t,n,i){const{month:c,defaultMonth:d,today:m=i.today(),numberOfMonths:a=1}=e;let w=c||d||m;const{differenceInCalendarMonths:S,addMonths:M,startOfMonth:P}=i;if(n&&S(n,w)<a-1){const N=-1*(a-1);w=M(n,N)}return t&&S(w,t)<0&&(w=t),P(w)}function a3e(e,t,n,i){const{addDays:c,endOfBroadcastWeek:d,endOfISOWeek:m,endOfMonth:a,endOfWeek:w,getISOWeek:S,getWeek:M,startOfBroadcastWeek:P,startOfISOWeek:N,startOfWeek:$}=i,G=e.reduce((q,V)=>{const J=n.broadcastCalendar?P(V,i):n.ISOWeek?N(V):$(V),ee=n.broadcastCalendar?d(V):n.ISOWeek?m(a(V)):w(a(V)),re=t.filter(me=>me>=J&&me<=ee),fe=n.broadcastCalendar?35:42;if(n.fixedWeeks&&re.length<fe){const me=t.filter(ve=>{const De=fe-re.length;return ve>ee&&ve<=c(ee,De)});re.push(...me)}const ne=re.reduce((me,ve)=>{const De=n.ISOWeek?S(ve):M(ve),Ye=me.find(tt=>tt.weekNumber===De),ze=new See(ve,V,i);return Ye?Ye.days.push(ze):me.push(new Zze(De,[ze])),me},[]),ce=new Xze(V,ne);return q.push(ce),q},[]);return n.reverseMonths?G.reverse():G}function o3e(e,t){let{startMonth:n,endMonth:i}=e;const{startOfYear:c,startOfDay:d,startOfMonth:m,endOfMonth:a,addYears:w,endOfYear:S,newDate:M,today:P}=t,{fromYear:N,toYear:$,fromMonth:G,toMonth:q}=e;!n&&G&&(n=G),!n&&N&&(n=t.newDate(N,0,1)),!i&&q&&(i=q),!i&&$&&(i=M($,11,31));const V=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=m(n):N?n=M(N,0,1):!n&&V&&(n=c(w(e.today??P(),-100))),i?i=a(i):$?i=M($,11,31):!i&&V&&(i=S(e.today??P())),[n&&d(n),i&&d(i)]}function s3e(e,t,n,i){if(n.disableNavigation)return;const{pagedNavigation:c,numberOfMonths:d=1}=n,{startOfMonth:m,addMonths:a,differenceInCalendarMonths:w}=i,S=c?d:1,M=m(e);if(!t)return a(M,S);if(!(w(t,e)<d))return a(M,S)}function l3e(e,t,n,i){if(n.disableNavigation)return;const{pagedNavigation:c,numberOfMonths:d}=n,{startOfMonth:m,addMonths:a,differenceInCalendarMonths:w}=i,S=c?d??1:1,M=m(e);if(!t)return a(M,-S);if(!(w(M,t)<=0))return a(M,-S)}function c3e(e){const t=[];return e.reduce((n,i)=>[...n,...i.weeks],t)}function TC(e,t){const[n,i]=K.useState(e);return[t===void 0?n:t,i]}function u3e(e,t){const[n,i]=o3e(e,t),{startOfMonth:c,endOfMonth:d}=t,m=oG(e,n,i,t),[a,w]=TC(m,e.month?m:void 0);K.useEffect(()=>{const ce=oG(e,n,i,t);w(ce)},[e.timeZone]);const S=i3e(a,i,e,t),M=n3e(S,e.endMonth?d(e.endMonth):void 0,e,t),P=a3e(S,M,e,t),N=c3e(P),$=r3e(P),G=l3e(a,n,e,t),q=s3e(a,i,e,t),{disableNavigation:V,onMonthChange:J}=e,ee=ce=>N.some(me=>me.days.some(ve=>ve.isEqualTo(ce))),re=ce=>{if(V)return;let me=c(ce);n&&me<c(n)&&(me=c(n)),i&&me>c(i)&&(me=c(i)),w(me),J?.(me)};return{months:P,weeks:N,days:$,navStart:n,navEnd:i,previousMonth:G,nextMonth:q,goToMonth:re,goToDay:ce=>{ee(ce)||re(ce.date)}}}var ep;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(ep||(ep={}));function sG(e){return!e[rs.disabled]&&!e[rs.hidden]&&!e[rs.outside]}function h3e(e,t,n,i){let c,d=-1;for(const m of e){const a=t(m);sG(a)&&(a[rs.focused]&&d<ep.FocusedModifier?(c=m,d=ep.FocusedModifier):i?.isEqualTo(m)&&d<ep.LastFocused?(c=m,d=ep.LastFocused):n(m.date)&&d<ep.Selected?(c=m,d=ep.Selected):a[rs.today]&&d<ep.Today&&(c=m,d=ep.Today))}return c||(c=e.find(m=>sG(t(m)))),c}function d3e(e,t,n,i,c,d,m){const{ISOWeek:a,broadcastCalendar:w}=d,{addDays:S,addMonths:M,addWeeks:P,addYears:N,endOfBroadcastWeek:$,endOfISOWeek:G,endOfWeek:q,max:V,min:J,startOfBroadcastWeek:ee,startOfISOWeek:re,startOfWeek:fe}=m;let ce={day:S,week:P,month:M,year:N,startOfWeek:me=>w?ee(me,m):a?re(me):fe(me),endOfWeek:me=>w?$(me):a?G(me):q(me)}[e](n,t==="after"?1:-1);return t==="before"&&i?ce=V([i,ce]):t==="after"&&c&&(ce=J([c,ce])),ce}function kee(e,t,n,i,c,d,m,a=0){if(a>365)return;const w=d3e(e,t,n.date,i,c,d,m),S=!!(d.disabled&&Om(w,d.disabled,m)),M=!!(d.hidden&&Om(w,d.hidden,m)),P=w,N=new See(w,P,m);return!S&&!M?N:kee(e,t,N,i,c,d,m,a+1)}function f3e(e,t,n,i,c){const{autoFocus:d}=e,[m,a]=K.useState(),w=h3e(t.days,n,i||(()=>!1),m),[S,M]=K.useState(d?w:void 0);return{isFocusTarget:q=>!!w?.isEqualTo(q),setFocused:M,focused:S,blur:()=>{a(S),M(void 0)},moveFocus:(q,V)=>{if(!S)return;const J=kee(q,V,S,t.navStart,t.navEnd,e,c);J&&(t.goToDay(J),M(J))}}}function p3e(e,t){const{selected:n,required:i,onSelect:c}=e,[d,m]=TC(n,c?n:void 0),a=c?n:d,{isSameDay:w}=t,S=$=>a?.some(G=>w(G,$))??!1,{min:M,max:P}=e;return{selected:a,select:($,G,q)=>{let V=[...a??[]];if(S($)){if(a?.length===M||i&&a?.length===1)return;V=a?.filter(J=>!w(J,$))}else a?.length===P?V=[$]:V=[...V,$];return c||m(V),c?.(V,$,G,q),V},isSelected:S}}function m3e(e,t,n=0,i=0,c=!1,d=wp){const{from:m,to:a}=t||{},{isSameDay:w,isAfter:S,isBefore:M}=d;let P;if(!m&&!a)P={from:e,to:n>0?void 0:e};else if(m&&!a)w(m,e)?c?P={from:m,to:void 0}:P=void 0:M(e,m)?P={from:e,to:m}:P={from:m,to:e};else if(m&&a)if(w(m,e)&&w(a,e))c?P={from:m,to:a}:P=void 0;else if(w(m,e))P={from:m,to:n>0?void 0:e};else if(w(a,e))P={from:e,to:n>0?void 0:e};else if(M(e,m))P={from:e,to:a};else if(S(e,m))P={from:m,to:e};else if(S(e,a))P={from:m,to:e};else throw new Error("Invalid range");if(P?.from&&P?.to){const N=d.differenceInCalendarDays(P.to,P.from);i>0&&N>i?P={from:e,to:void 0}:n>1&&N<n&&(P={from:e,to:void 0})}return P}function g3e(e,t,n=wp){const i=Array.isArray(t)?t:[t];let c=e.from;const d=n.differenceInCalendarDays(e.to,e.from),m=Math.min(d,6);for(let a=0;a<=m;a++){if(i.includes(c.getDay()))return!0;c=n.addDays(c,1)}return!1}function lG(e,t,n=wp){return Pm(e,t.from,!1,n)||Pm(e,t.to,!1,n)||Pm(t,e.from,!1,n)||Pm(t,e.to,!1,n)}function y3e(e,t,n=wp){const i=Array.isArray(t)?t:[t];if(i.filter(a=>typeof a!="function").some(a=>typeof a=="boolean"?a:n.isDate(a)?Pm(e,a,!1,n):Mee(a,n)?a.some(w=>Pm(e,w,!1,n)):Dj(a)?a.from&&a.to?lG(e,{from:a.from,to:a.to},n):!1:Cee(a)?g3e(e,a.dayOfWeek,n):Tee(a)?n.isAfter(a.before,a.after)?lG(e,{from:n.addDays(a.after,1),to:n.addDays(a.before,-1)},n):Om(e.from,a,n)||Om(e.to,a,n):Eee(a)||Aee(a)?Om(e.from,a,n)||Om(e.to,a,n):!1))return!0;const m=i.filter(a=>typeof a=="function");if(m.length){let a=e.from;const w=n.differenceInCalendarDays(e.to,e.from);for(let S=0;S<=w;S++){if(m.some(M=>M(a)))return!0;a=n.addDays(a,1)}}return!1}function _3e(e,t){const{disabled:n,excludeDisabled:i,selected:c,required:d,onSelect:m}=e,[a,w]=TC(c,m?c:void 0),S=m?c:a;return{selected:S,select:(N,$,G)=>{const{min:q,max:V}=e,J=N?m3e(N,S,q,V,d,t):void 0;return i&&n&&J?.from&&J.to&&y3e({from:J.from,to:J.to},n,t)&&(J.from=N,J.to=void 0),m||w(J),m?.(J,N,$,G),J},isSelected:N=>S&&Pm(S,N,!1,t)}}function v3e(e,t){const{selected:n,required:i,onSelect:c}=e,[d,m]=TC(n,c?n:void 0),a=c?n:d,{isSameDay:w}=t;return{selected:a,select:(P,N,$)=>{let G=P;return!i&&a&&a&&w(P,a)&&(G=void 0),c||m(G),c?.(G,P,N,$),G},isSelected:P=>a?w(a,P):!1}}function x3e(e,t){const n=v3e(e,t),i=p3e(e,t),c=_3e(e,t);switch(e.mode){case"single":return n;case"multiple":return i;case"range":return c;default:return}}function b3e(e){let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new sc(t.today,t.timeZone)),t.month&&(t.month=new sc(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new sc(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new sc(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new sc(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new sc(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=t.selected?.map(ir=>new sc(ir,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new sc(t.selected.from,t.timeZone):void 0,to:t.selected.to?new sc(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:i,labels:c,dateLib:d,locale:m,classNames:a}=K.useMemo(()=>{const ir={...Mj,...t.locale};return{dateLib:new Ym({locale:ir,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:Eje(t.components),formatters:Lje(t.formatters),labels:{...Kje,...t.labels},locale:ir,classNames:{...kj(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:w,mode:S,navLayout:M,numberOfMonths:P=1,onDayBlur:N,onDayClick:$,onDayFocus:G,onDayKeyDown:q,onDayMouseEnter:V,onDayMouseLeave:J,onNextClick:ee,onPrevClick:re,showWeekNumber:fe,styles:ne}=t,{formatCaption:ce,formatDay:me,formatMonthDropdown:ve,formatWeekNumber:De,formatWeekNumberHeader:Ye,formatWeekdayName:ze,formatYearDropdown:tt}=i,at=u3e(t,d),{days:ct,months:ht,navStart:Ie,navEnd:rt,previousMonth:Qe,nextMonth:St,goToMonth:qe}=at,vt=Yze(ct,t,Ie,rt,d),{isSelected:nt,select:gt,selected:Ut}=x3e(t,d)??{},{blur:$t,focused:qt,isFocusTarget:Ht,moveFocus:mn,setFocused:en}=f3e(t,at,vt,nt??(()=>!1),d),{labelDayButton:En,labelGridcell:Xn,labelGrid:cn,labelMonthDropdown:Jr,labelNav:mr,labelPrevious:Cr,labelNext:li,labelWeekday:hi,labelWeekNumber:so,labelWeekNumberHeader:ra,labelYearDropdown:xt}=c,Bt=K.useMemo(()=>jje(d,t.ISOWeek),[d,t.ISOWeek]),tn=S!==void 0||$!==void 0,$n=K.useCallback(()=>{Qe&&(qe(Qe),re?.(Qe))},[Qe,qe,re]),qn=K.useCallback(()=>{St&&(qe(St),ee?.(St))},[qe,St,ee]),An=K.useCallback((ir,xi)=>ci=>{ci.preventDefault(),ci.stopPropagation(),en(ir),gt?.(ir.date,xi,ci),$?.(ir.date,xi,ci)},[gt,$,en]),tr=K.useCallback((ir,xi)=>ci=>{en(ir),G?.(ir.date,xi,ci)},[G,en]),Ir=K.useCallback((ir,xi)=>ci=>{$t(),N?.(ir.date,xi,ci)},[$t,N]),mi=K.useCallback((ir,xi)=>ci=>{const Ra={ArrowLeft:[ci.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[ci.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[ci.shiftKey?"year":"week","after"],ArrowUp:[ci.shiftKey?"year":"week","before"],PageUp:[ci.shiftKey?"year":"month","before"],PageDown:[ci.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(Ra[ci.key]){ci.preventDefault(),ci.stopPropagation();const[ya,Tl]=Ra[ci.key];mn(ya,Tl)}q?.(ir.date,xi,ci)},[mn,q,t.dir]),Mi=K.useCallback((ir,xi)=>ci=>{V?.(ir.date,xi,ci)},[V]),_o=K.useCallback((ir,xi)=>ci=>{J?.(ir.date,xi,ci)},[J]),oa=K.useCallback(ir=>xi=>{const ci=Number(xi.target.value),Ra=d.setMonth(d.startOfMonth(ir),ci);qe(Ra)},[d,qe]),Ua=K.useCallback(ir=>xi=>{const ci=Number(xi.target.value),Ra=d.setYear(d.startOfMonth(ir),ci);qe(Ra)},[d,qe]),{className:lo,style:eo}=K.useMemo(()=>({className:[a[ni.Root],t.className].filter(Boolean).join(" "),style:{...ne?.[ni.Root],...t.style}}),[a,t.className,t.style,ne]),co=Aje(t),vo=K.useRef(null);t3e(vo,!!t.animate,{classNames:a,months:ht,focused:qt,dateLib:d});const ss={dayPickerProps:t,selected:Ut,select:gt,isSelected:nt,months:ht,nextMonth:St,previousMonth:Qe,goToMonth:qe,getModifiers:vt,components:n,classNames:a,styles:ne,labels:c,formatters:i};return Ce.createElement(Pee.Provider,{value:ss},Ce.createElement(n.Root,{rootRef:t.animate?vo:void 0,className:lo,style:eo,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...co},Ce.createElement(n.Months,{className:a[ni.Months],style:ne?.[ni.Months]},!t.hideNavigation&&!M&&Ce.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:a[ni.Nav],style:ne?.[ni.Nav],"aria-label":mr(),onPreviousClick:$n,onNextClick:qn,previousMonth:Qe,nextMonth:St}),ht.map((ir,xi)=>{const ci=Nje(ir.date,Ie,rt,i,d),Ra=Bje(Ie,rt,i,d);return Ce.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:a[ni.Month],style:ne?.[ni.Month],key:xi,displayIndex:xi,calendarMonth:ir},M==="around"&&!t.hideNavigation&&xi===0&&Ce.createElement(n.PreviousMonthButton,{type:"button",className:a[ni.PreviousMonthButton],tabIndex:Qe?void 0:-1,"aria-disabled":Qe?void 0:!0,"aria-label":Cr(Qe),onClick:$n,"data-animated-button":t.animate?"true":void 0},Ce.createElement(n.Chevron,{disabled:Qe?void 0:!0,className:a[ni.Chevron],orientation:t.dir==="rtl"?"right":"left"})),Ce.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:a[ni.MonthCaption],style:ne?.[ni.MonthCaption],calendarMonth:ir,displayIndex:xi},w?.startsWith("dropdown")?Ce.createElement(n.DropdownNav,{className:a[ni.Dropdowns],style:ne?.[ni.Dropdowns]},w==="dropdown"||w==="dropdown-months"?Ce.createElement(n.MonthsDropdown,{className:a[ni.MonthsDropdown],"aria-label":Jr(),classNames:a,components:n,disabled:!!t.disableNavigation,onChange:oa(ir.date),options:ci,style:ne?.[ni.Dropdown],value:d.getMonth(ir.date)}):Ce.createElement("span",null,ve(ir.date,d)),w==="dropdown"||w==="dropdown-years"?Ce.createElement(n.YearsDropdown,{className:a[ni.YearsDropdown],"aria-label":xt(d.options),classNames:a,components:n,disabled:!!t.disableNavigation,onChange:Ua(ir.date),options:Ra,style:ne?.[ni.Dropdown],value:d.getYear(ir.date)}):Ce.createElement("span",null,tt(ir.date,d)),Ce.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},ce(ir.date,d.options,d))):Ce.createElement(n.CaptionLabel,{className:a[ni.CaptionLabel],role:"status","aria-live":"polite"},ce(ir.date,d.options,d))),M==="around"&&!t.hideNavigation&&xi===P-1&&Ce.createElement(n.NextMonthButton,{type:"button",className:a[ni.NextMonthButton],tabIndex:St?void 0:-1,"aria-disabled":St?void 0:!0,"aria-label":li(St),onClick:qn,"data-animated-button":t.animate?"true":void 0},Ce.createElement(n.Chevron,{disabled:St?void 0:!0,className:a[ni.Chevron],orientation:t.dir==="rtl"?"left":"right"})),xi===P-1&&M==="after"&&!t.hideNavigation&&Ce.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:a[ni.Nav],style:ne?.[ni.Nav],"aria-label":mr(),onPreviousClick:$n,onNextClick:qn,previousMonth:Qe,nextMonth:St}),Ce.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":S==="multiple"||S==="range","aria-label":cn(ir.date,d.options,d)||void 0,className:a[ni.MonthGrid],style:ne?.[ni.MonthGrid]},!t.hideWeekdays&&Ce.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:a[ni.Weekdays],style:ne?.[ni.Weekdays]},fe&&Ce.createElement(n.WeekNumberHeader,{"aria-label":ra(d.options),className:a[ni.WeekNumberHeader],style:ne?.[ni.WeekNumberHeader],scope:"col"},Ye()),Bt.map((ya,Tl)=>Ce.createElement(n.Weekday,{"aria-label":hi(ya,d.options,d),className:a[ni.Weekday],key:Tl,style:ne?.[ni.Weekday],scope:"col"},ze(ya,d.options,d)))),Ce.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:a[ni.Weeks],style:ne?.[ni.Weeks]},ir.weeks.map((ya,Tl)=>Ce.createElement(n.Week,{className:a[ni.Week],key:ya.weekNumber,style:ne?.[ni.Week],week:ya},fe&&Ce.createElement(n.WeekNumber,{week:ya,style:ne?.[ni.WeekNumber],"aria-label":so(ya.weekNumber,{locale:m}),className:a[ni.WeekNumber],scope:"row",role:"rowheader"},De(ya.weekNumber,d)),ya.days.map(dr=>{const{date:kt}=dr,Dr=vt(dr);if(Dr[rs.focused]=!Dr.hidden&&!!qt?.isEqualTo(dr),Dr[Xd.selected]=nt?.(kt)||Dr.selected,Dj(Ut)){const{from:ot,to:he}=Ut;Dr[Xd.range_start]=!!(ot&&he&&d.isSameDay(kt,ot)),Dr[Xd.range_end]=!!(ot&&he&&d.isSameDay(kt,he)),Dr[Xd.range_middle]=Pm(Ut,kt,!0,d)}const to=zje(Dr,ne,t.modifiersStyles),Hs=Kze(Dr,a,t.modifiersClassNames),hr=!tn&&!Dr.hidden?Xn(kt,Dr,d.options,d):void 0;return Ce.createElement(n.Day,{key:`${d.format(kt,"yyyy-MM-dd")}_${d.format(dr.displayMonth,"yyyy-MM")}`,day:dr,modifiers:Dr,className:Hs.join(" "),style:to,role:"gridcell","aria-selected":Dr.selected||void 0,"aria-label":hr,"data-day":d.format(kt,"yyyy-MM-dd"),"data-month":dr.outside?d.format(kt,"yyyy-MM"):void 0,"data-selected":Dr.selected||void 0,"data-disabled":Dr.disabled||void 0,"data-hidden":Dr.hidden||void 0,"data-outside":dr.outside||void 0,"data-focused":Dr.focused||void 0,"data-today":Dr.today||void 0},!Dr.hidden&&tn?Ce.createElement(n.DayButton,{className:a[ni.DayButton],style:ne?.[ni.DayButton],type:"button",day:dr,modifiers:Dr,disabled:Dr.disabled||void 0,tabIndex:Ht(dr)?0:-1,"aria-label":En(kt,Dr,d.options,d),onClick:An(dr,Dr),onBlur:Ir(dr,Dr),onFocus:tr(dr,Dr),onKeyDown:mi(dr,Dr),onMouseEnter:Mi(dr,Dr),onMouseLeave:_o(dr,Dr)},me(kt,d.options,d)):!Dr.hidden&&me(dr.date,d.options,d))}))))))})),t.footer&&Ce.createElement(n.Footer,{className:a[ni.Footer],style:ne?.[ni.Footer],role:"status","aria-live":"polite"},t.footer)))}function Lee({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:i="label",buttonVariant:c="ghost",formatters:d,components:m,...a}){const w=kj();return D.jsx(b3e,{showOutsideDays:n,className:bn("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:i,formatters:{formatMonthDropdown:S=>S.toLocaleString("default",{month:"short"}),...d},classNames:{root:bn("w-fit",w.root),months:bn("flex gap-4 flex-col md:flex-row relative",w.months),month:bn("flex flex-col w-full gap-4",w.month),nav:bn("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",w.nav),button_previous:bn(Fx({variant:c}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",w.button_previous),button_next:bn(Fx({variant:c}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",w.button_next),month_caption:bn("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",w.month_caption),dropdowns:bn("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",w.dropdowns),dropdown_root:bn("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",w.dropdown_root),dropdown:bn("absolute bg-popover inset-0 opacity-0",w.dropdown),caption_label:bn("select-none font-medium",i==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",w.caption_label),table:"w-full border-collapse",weekdays:bn("flex",w.weekdays),weekday:bn("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",w.weekday),week:bn("flex w-full mt-2",w.week),week_number_header:bn("select-none w-(--cell-size)",w.week_number_header),week_number:bn("text-[0.8rem] select-none text-muted-foreground",w.week_number),day:bn("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",w.day),range_start:bn("rounded-l-md bg-accent",w.range_start),range_middle:bn("rounded-none",w.range_middle),range_end:bn("rounded-r-md bg-accent",w.range_end),today:bn("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",w.today),outside:bn("text-muted-foreground aria-selected:text-muted-foreground",w.outside),disabled:bn("text-muted-foreground opacity-50",w.disabled),hidden:bn("invisible",w.hidden),...t},components:{Root:({className:S,rootRef:M,...P})=>D.jsx("div",{"data-slot":"calendar",ref:M,className:bn(S),...P}),Chevron:({className:S,orientation:M,...P})=>M==="left"?D.jsx(hW,{className:bn("size-4",S),...P}):M==="right"?D.jsx(v0,{className:bn("size-4",S),...P}):D.jsx(t2,{className:bn("size-4",S),...P}),DayButton:w3e,WeekNumber:({children:S,...M})=>D.jsx("td",{...M,children:D.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:S})}),...m},...a})}function w3e({className:e,day:t,modifiers:n,...i}){const c=kj(),d=K.useRef(null);return K.useEffect(()=>{n.focused&&d.current?.focus()},[n.focused]),D.jsx(na,{ref:d,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:bn("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",c.day,e),...i})}function cG({value:e,onChange:t}){return D.jsxs(uS,{children:[D.jsx(hS,{asChild:!0,children:D.jsxs(na,{variant:"outline","data-empty":!e,className:"data-[empty=true]:text-muted-foreground w-full justify-start text-left font-normal",children:[D.jsx(uW,{}),e?wl(e,"PPP"):D.jsx("span",{children:"Pick a date"})]})}),D.jsx(dS,{className:"w-auto p-0",children:D.jsx(Lee,{mode:"single",selected:e,onSelect:t,initialFocus:!0})})]})}function S3e({item:e}){const{register:t,handleSubmit:n,control:i,reset:c,formState:{errors:d,isSubmitting:m}}=fv({});K.useEffect(()=>{e&&c({id:e.id,vin:e.vin,make:e.make,model:e.model,year:e.year,type:e.type,capacity:e.capacity,seats:e.seats,fuel_efficiency:e.fuel_efficiency,height:e.height,width:e.width,status:e.status})},[e,c]);const[a,w]=K.useState(!1),S=async P=>{try{let N=await Qa.vehicles.update(P);N.status===200&&(ua.success(N.data,{position:"top-center"}),w(!1))}catch(N){N.response?.status===422?ua.error(N.response.data.message):ua.error("Server Error")}},M=()=>{c({id:e.id,vin:e.vin,make:e.make,model:e.model,year:e.year,type:e.type,capacity:e.capacity,seats:e.seats,fuel_efficiency:e.fuel_efficiency,height:e.height,width:e.width,status:e.status}),w(!1)};return D.jsxs(D.Fragment,{children:[D.jsxs("div",{className:"w-full py-2 px-6 flex justify-between",children:[D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Details"}),a?D.jsxs("div",{className:"flex justify-between gap-2",children:[D.jsx(na,{type:"submit",form:"vehicle_form",disabled:m,children:m?"Saving...":"Save Changes"}),D.jsx(na,{variant:"outline",type:"button",onClick:M,disabled:m,children:"Cancel"})]}):D.jsx(na,{type:"button",onClick:()=>w(!0),children:"Edit"})]}),D.jsx(Us,{}),D.jsx("div",{className:"py-3 px-8",children:D.jsxs("form",{onSubmit:n(S),id:"vehicle_form",children:[D.jsx("input",{...t("id"),type:"hidden"}),D.jsxs("div",{className:"grid gap-3 mb-3",children:[D.jsxs("div",{className:"flex flex-col gap-2",children:[D.jsx(Ar,{children:"VIN"}),D.jsx(io,{...t("vin",{required:"VIN is required",minLength:{value:17,message:"VIN must be 17 characters"},maxLength:{value:17,message:"VIN must be 17 characters"}}),type:"text",disabled:!a}),d.vin&&D.jsx("p",{className:"text-red-500",children:d.vin.message})]}),D.jsxs("div",{className:"flex gap-2",children:[D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Brand"}),D.jsx(io,{...t("make",{required:"Brand is required!"}),type:"text",disabled:!a}),d.make&&D.jsx("p",{className:"text-red-500",children:d.make.message})]}),D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Model"}),D.jsx(io,{...t("model",{required:"Model is required!"}),type:"text",disabled:!a}),d.model&&D.jsx("p",{className:"text-red-500",children:d.model.message})]})]}),D.jsxs("div",{children:[D.jsx(Ar,{children:"Year"}),D.jsx(iv,{name:"year",control:i,rules:{required:"Year is required!"},render:({field:P})=>D.jsx(QJ,{startYear:1990,value:P.value?.toString(),onChange:N=>P.onChange(String(N)),disabled:!a})}),d.year&&D.jsx("p",{className:"text-red-500",children:d.year.message})]}),D.jsx("div",{className:"flex gap-2",children:D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Type"}),D.jsx(io,{...t("type",{required:"Type is required!"}),disabled:!a,className:"w-full"}),d.type&&D.jsx("p",{className:"text-red-500",children:d.type.message})]})}),D.jsxs("div",{className:"flex gap-2",children:[D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Capacity (kg)"}),D.jsx(io,{...t("capacity"),type:"number",disabled:!a}),d.capacity&&D.jsx("p",{className:"text-red-500",children:d.capacity.message})]}),D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Seats"}),D.jsx(io,{...t("seats"),type:"number",disabled:!a}),d.seats&&D.jsx("p",{className:"text-red-500",children:d.seats.message})]})]}),D.jsxs("div",{children:[D.jsx(Ar,{children:"Fuel Efficiency (L/100km)"}),D.jsx(io,{...t("fuel_efficiency",{required:"Required"}),type:"number",step:"0.01",disabled:!a}),d.fuel_efficiency&&D.jsx("p",{className:"text-red-500",children:d.fuel_efficiency.message})]}),D.jsxs("div",{className:"flex gap-2",children:[D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Height (m)"}),D.jsx(io,{...t("height"),type:"number",step:"0.01",disabled:!a}),d.height&&D.jsx("p",{className:"text-red-500",children:d.height.message})]}),D.jsxs("div",{className:"flex flex-col flex-1",children:[D.jsx(Ar,{children:"Width (m)"}),D.jsx(io,{...t("width"),type:"number",step:"0.01",disabled:!a}),d.width&&D.jsx("p",{className:"text-red-500",children:d.width.message})]})]})]})]})})]})}function T3e({id:e}){const{register:t,handleSubmit:n,reset:i,formState:{errors:c,isSubmitting:d}}=fv({}),m=async a=>{if(!a.id)return;if(!a.image||a.image.length===0){ua.error("Please select an image to upload");return}const w=new FormData;w.append("id",a.id),w.append("image",a.image[0]),console.log(a);try{const S=await Qa.vehicles.changeImage(w);ua.success("Image uploaded successfully!"),i()}catch(S){console.error(S),ua.error(S.response?.data?.message||"Failed to upload image")}};return D.jsxs(oC,{children:[D.jsx(sC,{asChild:!0,children:D.jsx(na,{children:"Edit"})}),D.jsxs(lC,{children:[D.jsxs(cC,{children:[D.jsx(uC,{children:"Upload an Image"}),D.jsx(hC,{children:"Image size should be less than 2MB"})]}),D.jsxs("form",{onSubmit:n(m),children:[D.jsx("input",{...t("id",{rules:{required:!0}}),type:"hidden",defaultValue:e}),D.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsx(Ar,{children:"Vehicle Image"}),c.image&&D.jsx(ou,{className:"text-red-500",children:c.image.message})]}),D.jsx(io,{...t("image",{rules:{required:"Image is required"}}),type:"file",accept:"image/*",className:c.image?"border-red-500 focus-visible:ring-red-300":""})]}),D.jsx(na,{type:"submit",disabled:d,children:d?"Uploading":"Upload"})]})]})]})}function E3e({id:e}){const{register:t,handleSubmit:n,reset:i,setValue:c,control:d,formState:{errors:m,isSubmitting:a}}=fv(),w=async S=>{const M=new FormData;M.append("vehicle_id",e),M.append("document_type",S.document_type),M.append("document_name",S.document_name),S.provider&&M.append("provider",S.provider),S.issue_date&&M.append("issue_date",S.issue_date),S.expiry_date&&M.append("expiry_date",S.expiry_date),S.document_file?.[0]&&M.append("document_file",S.document_file[0]);try{(await Qa.vdocuments.upload(M)).status===200&&(ua.success("Document uploaded successfully"),i())}catch(P){P.response?.status===422?ua.error(P.response.data.message||"Validation failed"):ua.error("Upload failed")}};return D.jsxs(oC,{children:[D.jsx(sC,{asChild:!0,children:D.jsx(na,{children:"Add"})}),D.jsxs(lC,{children:[D.jsxs(cC,{children:[D.jsx(uC,{children:"Upload document"}),D.jsx(hC,{children:"Supported formats: PDF, DOC/DOCX, Images (jpg/png)."})]}),D.jsxs("form",{onSubmit:n(w),className:"space-y-3",children:[D.jsxs("div",{children:[D.jsx(Ar,{className:"mb-2",children:"Document Type"}),D.jsxs(KNe,{onValueChange:S=>c("document_type",S),className:"w-full",children:[D.jsx(QNe,{children:D.jsx(JNe,{placeholder:"Select type"})}),D.jsxs(eze,{children:[D.jsx(QT,{value:"Registration",children:"Registration"}),D.jsx(QT,{value:"Insurance",children:"Insurance"}),D.jsx(QT,{value:"Inspection",children:"Inspection"}),D.jsx(QT,{value:"Other",children:"Other"})]})]}),m.document_type&&D.jsx("p",{className:"text-red-500",children:m.document_type.message})]}),D.jsxs("div",{className:"w-full",children:[D.jsx(Ar,{className:"mb-2",children:"Document Name"}),D.jsx(io,{...t("document_name",{required:"Document name is required"}),type:"text"}),m.document_name&&D.jsx("p",{className:"text-red-500",children:m.document_name.message})]}),D.jsxs("div",{children:[D.jsx(Ar,{className:"mb-2",children:"Provider"}),D.jsx(io,{...t("provider"),type:"text"})]}),D.jsxs("div",{className:"flex gap-2",children:[D.jsxs("div",{className:"flex-1",children:[D.jsx(Ar,{className:"mb-2",children:"Issue Date"}),D.jsx(iv,{name:"issue_date",control:d,render:({field:S})=>D.jsx(cG,{className:"w-full",value:S.value?new Date(S.value):void 0,onChange:M=>S.onChange(M?M.toISOString().split("T")[0]:"")})}),m.issue_date&&D.jsx("p",{className:"text-red-500",children:m.issue_date.message})]}),D.jsxs("div",{className:"flex-1",children:[D.jsx(Ar,{className:"mb-2",children:"Expiry Date"}),D.jsx(iv,{name:"expiry_date",control:d,render:({field:S})=>D.jsx(cG,{value:S.value?new Date(S.value):void 0,onChange:M=>S.onChange(M?M.toISOString().split("T")[0]:"")})}),m.expiry_date&&D.jsx("p",{className:"text-red-500",children:m.expiry_date.message})]})]}),D.jsxs("div",{className:"",children:[D.jsx(Ar,{className:"mb-2",children:"Upload File"}),D.jsx(io,{...t("document_file",{required:"File is required"}),type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),m.document_file&&D.jsx("p",{className:"text-red-500",children:m.document_file.message})]}),D.jsx("div",{className:"flex justify-end gap-2",children:D.jsx(na,{type:"submit",disabled:a,children:a?"Uploading...":"Submit"})})]})]})]})}function A3e({id:e}){Qa.broadcast.config();const[t,n]=K.useState(),i=K.useCallback(()=>{e&&Qa.vdocuments.get({vehicle_id:e}).then(c=>{n(c.data.documents)}).catch(c=>{console.log(c)})},[e]);return K.useEffect(()=>{i()},[i]),j0("vehicle_document_channel","VehicleDocumentEvents",c=>{c.record&&n(d=>c.action==="deleted"?d.filter(m=>m.id!==c.record.id):kJ(d,c.record,"id"))}),D.jsxs(D.Fragment,{children:[D.jsxs("div",{className:"w-full py-2 px-6 flex justify-between",children:[D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Documents"}),D.jsx(E3e,{id:e})]}),D.jsx(Us,{}),D.jsx("div",{className:"py-4 px-8",children:!t||t.length===0?D.jsx("div",{className:"p-4",children:D.jsx("p",{className:"block text-center font-medium text-xl text-secondary-foreground",children:"No vehicle documents found."})}):D.jsx(yze,{type:"single",collapsible:!0,className:"w-full",children:t.map((c,d)=>D.jsxs(_ze,{value:`item-${d}`,children:[D.jsx(vze,{className:"flex justify-between px-2 py-1",children:D.jsxs("div",{className:"flex gap-2",children:[D.jsx(_p,{children:c.document_type}),D.jsx("h2",{className:"mb-0 font-medium",children:c.document_name})]})}),D.jsxs(xze,{className:"px-4 py-2 space-y-1",children:[D.jsx("div",{className:"flex",children:D.jsxs(Ar,{children:["Provider ",D.jsx(Ar,{className:"font-normal",children:c.provider})]})}),D.jsx("div",{className:"flex",children:D.jsxs(Ar,{children:["Issue Date: ",D.jsx(Ar,{className:"font-normal",children:wl(c.issue_date,"PPP")})]})}),D.jsx("div",{className:"flex",children:D.jsxs(Ar,{children:["Expiry Date: ",D.jsx(Ar,{className:"font-normal",children:wl(c.expiry_date,"PPP")})]})}),D.jsxs("div",{className:"flex",children:[D.jsx(Ar,{children:"File: "}),D.jsx("a",{href:c.document_url,target:"_blank",className:"px-4 decoration-1",children:c.document_file.replace("vehicle_documents/","")})]})]})]},d))})})]})}function C3e({item:e}){return D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Maintenance Details"})}),D.jsx(Us,{}),D.jsxs("div",{className:"py-4 px-8",children:[D.jsx("h4",{children:"Last Maintenance Date: 9/24/2025"}),D.jsx("h4",{children:"Overall Status: Good"}),D.jsx("h4",{children:"Known Issues: None"}),D.jsx("h4",{children:"Verified By: Logistics 1"})]})]})}function uG({id:e,main_message:t,message:n,buttonTitle:i,type:c,status:d}){const{handleSubmit:m,formState:{isSubmitting:a}}=fv(),[w,S]=K.useState(!1),M=async()=>{const P={id:e,status:d};await Qa.vehicles.updateStatus(P).then(N=>{N.status==200&&ua.success("Request Sent"),S(!1)}).catch(N=>{ua.error("Something went wrong"),console.log(N.message)})};return D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Danger Zone"})}),D.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-4 rounded-md border",children:[D.jsx("p",{className:"text-sm leading-relaxed max-w-[70%]",children:t}),D.jsxs(zA,{open:w,onOpenChange:S,children:[D.jsx(jA,{asChild:!0,children:D.jsx(na,{className:(c==="danger"?"bg-destructive ":"")+"ml-6 shrink-0 px-4 py-2",children:i})}),D.jsx(BA,{children:D.jsxs("form",{onSubmit:m(M),children:[D.jsxs(FA,{children:[D.jsx(UA,{children:"Are you absolutely sure?"}),D.jsx($A,{children:n})]}),D.jsxs(VA,{children:[D.jsx(qA,{type:"button",children:"Cancel"}),D.jsx(na,{type:"submit",variant:"destructive",disabled:a,children:a?"Processing...":"Continue"})]})]})})]})]})]})}Qa.broadcast.config();function M3e(){const{uuid:e}=WA(),[t,n]=K.useState(),[i,c]=K.useState(!1),[d,m]=K.useState(!1),a=K.useCallback(()=>{!e&&!Qa||Qa.vehicles.details({uuid:e}).then(M=>{console.log(M.data.record),n(M.data.record)}).catch(M=>{d||(ua.error("Failed to vehicle details"),m(!0))}).finally(()=>c(!1))},[e,d,Qa]);return K.useEffect(()=>{c(!0),e&&a()},[a]),j0("vehicle_channel","VehicleEvents",M=>{const P=M.record;P&&P.uuid===e&&n(N=>({...N,...P}))}),i&&!t?D.jsxs("div",{className:"p-4 space-y-2",children:[D.jsx(Oi,{className:"h-6 w-1/3"}),D.jsx(Oi,{className:"h-6 w-2/3"}),D.jsx(Oi,{className:"h-48 w-full"})]}):t?D.jsxs(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"w-full mb-16",children:[D.jsxs("div",{className:"w-full relative max-h-[200px] h-1/4 mb-2",children:[D.jsx("img",{src:t.image_url,alt:"",className:"h-full w-full object-contain z-10",loading:"lazy"}),D.jsx("div",{className:"absolute bottom-10 right-10",children:D.jsx(T3e,{id:t.id})}),D.jsxs("div",{className:"absolute top-10 left-10",children:[D.jsx(_p,{children:D.jsx("h2",{className:"text-xl mb-0",children:t?.status})}),D.jsx("h1",{className:"text-3xl mb-0",children:t?.vin})]})]}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:D.jsx(C3e,{item:t})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:D.jsx(S3e,{item:t})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:t?.id?D.jsx(A3e,{id:t.id}):D.jsx(D.Fragment,{})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5",children:t?.status!=="Retired"&&t?.status!=="Reserved"?D.jsx(uG,{id:t.id,main_message:"This will prevent the system from suggesting the vehicles in any trip.",message:"Are you sure you want to retire this vehicle? This will prevent the system from suggesting the vehicles in any trip.",buttonTitle:"Retire",type:"danger",status:"Retired"}):t?.status==="Retired"?D.jsx(uG,{id:t.id,main_message:"Make this vehicle available again, system will include it in trip vehicles.",message:"Are you sure to make this vehicle available again?",buttonTitle:"Enable",type:"normal",status:"Available"}):D.jsx("div",{className:"flex w-full items-center justify-between px-6 py-4 rounded-md border",children:D.jsx("p",{className:"text-sm leading-relaxed max-w-[70%]",children:"This is danger zone, Nothing to show to you, come back later"})})})]}):D.jsx("div",{className:"p-4",children:D.jsx("p",{className:"block text-center font-medium text-4xl text-secondary",children:"No vehicle details found."})})}function Lj({className:e,...t}){return D.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:D.jsx("table",{"data-slot":"table",className:bn("w-full caption-bottom text-sm",e),...t})})}function Nj({className:e,...t}){return D.jsx("thead",{"data-slot":"table-header",className:bn("[&_tr]:border-b",e),...t})}function zj({className:e,...t}){return D.jsx("tbody",{"data-slot":"table-body",className:bn("[&_tr:last-child]:border-0",e),...t})}function P1({className:e,...t}){return D.jsx("tr",{"data-slot":"table-row",className:bn("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function oy({className:e,...t}){return D.jsx("th",{"data-slot":"table-head",className:bn("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Rm({className:e,...t}){return D.jsx("td",{"data-slot":"table-cell",className:bn("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function P3e({className:e,...t}){return D.jsx("caption",{"data-slot":"table-caption",className:bn("text-muted-foreground mt-4 text-sm",e),...t})}function Nee({list:e=[],recordName:t="record",columns:n=[]}){const i=c=>{if(c==null)return"";const d=new Date(c);return!isNaN(d.getTime())&&typeof c=="string"&&/\d{4}-\d{2}-\d{2}/.test(c)?wl(d,"PPpp"):c};return D.jsxs(Lj,{children:[e.length===0&&D.jsxs(P3e,{children:["No ",t," found in the records."]}),D.jsx(Nj,{children:D.jsx(P1,{children:n.map((c,d)=>D.jsx(oy,{className:c.cellClassName||"",children:c.title},d))})}),D.jsx(zj,{children:e.map((c,d)=>D.jsx(oh.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:d*.05},children:n.map((m,a)=>{const w=m.render?m.render(c):c[m.accessor];return D.jsx(Rm,{className:m.cellClassName||"",children:i(w)},a)})},d))})]})}Qa.broadcast.config();const O3e=[{title:"Batch",accessor:"batch_number",cellClassName:"font-medium h-1"},{title:"Requestor",accessor:"requestor_uuid",cellClassName:"h-1"},{title:"Status",accessor:"status",cellClassName:"h-1"},{title:"Created",accessor:"created_at",cellClassName:"h-1"},{render:e=>D.jsx(fc,{to:`${e.batch_number}`,children:D.jsx(na,{variant:"",size:"sm",children:D.jsx(v0,{})})})}];function R3e(){const[e,t]=K.useState(),[n,i]=K.useState(1),[c,d]=K.useState(),[m,a]=K.useState(""),w=K.useCallback(()=>{Qa.reservations.list({q:m||void 0}).then(S=>{let M=S.data.reservations;t(M.data||[]),d(M.last_page)}).catch(()=>{ua.error("Error fetching reservations",{position:"top-center"})})},[n,m]);return K.useEffect(()=>{let S=setTimeout(w,300);return()=>{clearTimeout(S)}},[w]),K.useEffect(()=>{let S=setInterval(w,2e3);return()=>{clearInterval(S)}},[w]),j0("reservation_channel","ReservationUpdates",S=>{let M=S.reservations;t(P=>P.find($=>$.id===M.id)?P.map($=>$.id===M.id?M:$):[...P,M])}),D.jsx(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-2 h-full px-4",children:D.jsxs("div",{className:"flex flex-col flex-2 h-full",children:[D.jsxs("div",{className:"flex-4/5",children:[D.jsxs("div",{className:"flex mb-3 gap-2",children:[D.jsx(io,{placeholder:"Search Reservations",value:m,onChange:S=>a(S.target.value)}),D.jsx(fc,{to:"make",children:D.jsx(na,{children:"Make Reservation"})})]}),D.jsx("div",{className:"min-h-96",children:D.jsx(Nee,{list:e,recordName:"reservations",columns:O3e})})]}),D.jsx(_C,{className:"flex-2/12",totalPage:c,page:n,setPage:i})]})})}function I3e(){const[e,t]=K.useState([]),[n,i]=K.useState(1),[c,d]=K.useState(1),[m,a]=K.useState(""),w=K.useCallback(()=>{Qa.dispatches.list({page:n,q:m||void 0}).then(S=>{const M=S.data.dispatches;t(M),d(M.last_page||1)}).catch(()=>{ua.error("Error fetching dispatch records",{position:"top-center"})})},[n,m]);return K.useEffect(()=>{const S=setTimeout(w,300);return()=>clearTimeout(S)},[w]),K.useEffect(()=>{const S=setInterval(w,5e3);return()=>clearInterval(S)},[w]),console.log(e),D.jsxs(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col gap-4 h-full px-4",children:[D.jsxs("div",{className:"flex-4/5",children:[D.jsx("div",{className:"flex mb-3 gap-2",children:D.jsx(io,{placeholder:"Search Dispatch",value:m,onChange:S=>a(S.target.value)})}),D.jsx("div",{className:"flex flex-col gap-6 min-h-96",children:e.length===0?D.jsx("p",{className:"text-gray-500 text-center",children:"No dispatch records found."}):e.map(S=>D.jsxs("div",{className:"border rounded p-4 shadow-sm",children:[D.jsxs("div",{className:"flex justify-between",children:[D.jsx("h3",{className:"font-bold mb-2 text-lg",children:S.batch_number}),D.jsx(fc,{to:S.batch_number,children:D.jsx(na,{children:D.jsx(pse,{})})})]}),D.jsx("div",{className:"space-y-1",children:S.reservations&&S.reservations.length>0?S.reservations.map(M=>D.jsxs("div",{className:"px-4 py-2 flex w-full rounded-md p-2",children:[D.jsx(Ar,{className:"font-light flex-1",children:M.dispatch_uuid}),D.jsx("div",{className:"flex-1",children:D.jsx(_p,{className:"rounded-full p-2 w-[100px]",children:M.dispatch_status})})]},M.dispatch_id)):D.jsx("p",{className:"text-gray-500",children:"No reservations in this batch."})})]},S.batch_number))})]}),D.jsx(_C,{totalPage:c,page:n,setPage:i,className:"flex-2/12"})]})}function D3e({cost:e,distance:t,duration:n}){return D.jsxs("div",{className:"flex w-full gap-2",children:[D.jsxs(Uo,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Dispatch spend"}),D.jsx(hc,{children:"Live dispatch cost"})]}),D.jsxs(qo,{children:[D.jsx(Ar,{className:"text-xl text-gray-500",children:"Philippine Peso"}),D.jsx(Ar,{className:"text-3xl font-semibold",children:e??"N/A"})]})]}),D.jsxs(Uo,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Travel Distance"}),D.jsx(hc,{children:"Live distance taken"})]}),D.jsxs(qo,{children:[D.jsx(Ar,{className:"text-xl text-gray-500",children:"Kilometer"}),D.jsx(Ar,{className:"text-3xl font-semibold",children:t??"N/A"})]})]}),D.jsxs(Uo,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Travel Duration"}),D.jsx(hc,{children:"Live duration taken"})]}),D.jsxs(qo,{children:[D.jsx(Ar,{className:"text-xl text-gray-500",children:"Minutes"}),D.jsx(Ar,{className:"text-3xl font-semibold",children:n??"N/A"})]})]})]})}function k3e({record:e}){return D.jsxs(Uo,{className:"rounded-md bg-card/80 backdrop-blur-md",children:[D.jsx($o,{children:D.jsx(il,{className:"text-2xl",children:e?.reservation?.batch_number??"N/A"})}),D.jsxs(qo,{children:[D.jsx("div",{className:"mb-4 grid grid-cols-1 gap-2",children:D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-semibold",children:"Requested By:"}),D.jsx("h3",{className:"font-bold",children:e?.reservation?.requestor_uuid})]})}),D.jsxs("div",{className:"my-4 w-full",children:[D.jsx("h3",{className:"font-semibold text-lg",children:"Date and Time"}),D.jsx(Us,{className:"my-2"}),D.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-medium",children:"Start:"}),D.jsx("span",{className:"font-bold",children:e?.reservation?.start_date?wl(new Date(e.reservation.start_date),"PPp"):"N/A"})]}),D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-medium",children:"End:"}),D.jsx("span",{className:"font-bold",children:e?.reservation?.end_date?wl(new Date(e.reservation.end_date),"PPp"):"N/A"})]})]})]}),D.jsxs("div",{className:"my-4 w-full",children:[D.jsx("h3",{className:"font-semibold text-lg",children:"Trip Routes"}),D.jsx(Us,{className:"my-2"}),D.jsx("div",{className:"flex flex-col gap-3 w-full",children:e?.trip_routes?.length>0?e.trip_routes.map((t,n)=>D.jsx("div",{className:"flex flex-col gap-1",children:D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-medium",children:n===0?"Start":n===e.trip_routes.length-1?"End":`Stop ${n}`}),D.jsx("span",{className:"font-bold",children:t.full_address})]})},t.id)):D.jsx("h3",{className:"text-gray-500",children:"No trip routes available"})})]})]})]})}function L3e({record:e}){return D.jsx(D.Fragment,{})}function zee({onSelect:e,assignments:t,defaultValue:n}){const[i,c]=K.useState(!1),[d,m]=K.useState([]),[a,w]=K.useState(null);return K.useEffect(()=>{let S;return S=setInterval(async()=>{try{const P=await Qa.drivers.dialogDrivers({q:"Available"});P.status===200&&m(P.data?.drivers||[])}catch(P){console.error("Failed to fetch drivers",P)}},5e3),()=>clearInterval(S)},[]),D.jsxs(uS,{open:i,onOpenChange:c,children:[D.jsx(hS,{asChild:!0,children:D.jsxs(na,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[D.jsx("span",{className:"truncate",children:n||(a?d.find(S=>S.id===a)?.name:"Select Driver...")}),D.jsx(n2,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),D.jsx(dS,{className:"w-[250px] p-0 max-h-[30vh]",children:D.jsxs(yj,{children:[D.jsx(_j,{placeholder:"Search driver..."}),D.jsxs(vj,{children:[D.jsx(xj,{children:"No driver found."}),D.jsx(bj,{children:d.map(S=>D.jsxs(wj,{value:S.id,disabled:t?.some(M=>M.driver_uuid===S.uuid)||n,onSelect:()=>{w(S.id),c(!1),e?.(S)},children:[D.jsx(e2,{className:bn("mr-2 h-4 w-4",a===S.id?"opacity-100":"opacity-0")}),S.name," (",S.status,")"]},S.id))})]})]})})]})}function N3e({record:e}){return D.jsxs(Uo,{className:"w-full bg-gradient-to-br from-card/80 to-muted/60 backdrop-blur-md rounded-md",children:[D.jsx($o,{children:D.jsx(il,{className:"text-2xl font-bold",children:"Dispatch Orders"})}),D.jsx(qo,{className:"space-y-6",children:e?.dispatches?.length===0?D.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No dispatches found."}):e?.dispatches?.map((t,n)=>D.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-center bg-background/80 rounded-md border p-4",children:[D.jsxs("div",{className:"w-full h-40 relative overflow-hidden rounded-md border",children:[D.jsx("img",{src:t?.image_url,className:"w-full h-full object-cover",alt:"Vehicle",loading:"lazy"}),D.jsx(_p,{className:"absolute top-2 left-2",children:t?.vehicle_status})]}),D.jsxs("div",{className:"space-y-2",children:[D.jsxs("h3",{className:"font-semibold text-lg",children:["Type: ",D.jsx("span",{className:"font-normal",children:t?.type})]}),D.jsxs("h3",{className:"font-semibold text-lg",children:["Capacity: ",D.jsx("span",{className:"font-normal",children:t?.capacity})]}),e?.status==="Rejected"?null:t?.driver_name?D.jsxs("h3",{className:"font-semibold text-lg",children:["Driver: ",D.jsx("span",{className:"font-normal",children:t?.driver_name})]}):D.jsx(zee,{assignments,onSelect:i=>onAssign(t?.vehicle_id,i?.uuid),defaultValue:t?.driver_name})]}),D.jsxs("div",{className:"flex flex-col justify-between h-full col-span-2",children:[D.jsxs("div",{className:"flex justify-between items-center mb-2",children:[D.jsx("h2",{className:"font-bold text-xl",children:"Dispatch Information"}),D.jsx(_p,{className:"font-medium",children:t?.status})]}),D.jsxs("div",{className:"space-y-1",children:[D.jsx(Us,{}),D.jsxs("div",{children:["Scheduled Time:"," ",D.jsx("span",{className:"font-medium",children:t?.scheduled_time?wl(new Date(t?.scheduled_time),"PPpp"):""})]}),D.jsxs("div",{children:["Return Time:"," ",D.jsx("span",{className:"font-medium",children:t?.return_time?wl(new Date(t?.return_time),"PPpp"):""})]}),D.jsx(Us,{}),D.jsxs("div",{children:["Acknowledged At:"," ",D.jsx("span",{className:"font-medium",children:t?.acknowledged_at?wl(new Date(t?.acknowledged_at),"PPpp"):""})]}),t?.status==="Completed"?D.jsxs(D.Fragment,{children:[D.jsxs("div",{children:["Dispatched At:"," ",D.jsx("span",{className:"font-medium",children:t?.dispatched_at?wl(new Date(t?.dispatched_at),"PPpp"):""})]}),D.jsxs("div",{children:["Completed At:"," ",D.jsx("span",{className:"font-medium",children:t?.completed_at?wl(new Date(t?.completed_at),"PPpp"):""})]})]}):t?.status==="Closed"?D.jsx(D.Fragment,{children:D.jsxs("div",{children:["Closed At:"," ",D.jsx("span",{className:"font-medium",children:t?.closed_at?wl(new Date(t?.closed_at),"PPpp"):""})]})}):t?.status==="Cancelled"?D.jsx(D.Fragment,{children:D.jsxs("div",{children:["Cancelled At:"," ",D.jsx("span",{className:"font-medium",children:t?.cancelled_at?wl(new Date(t?.cancelled_at),"PPpp"):""})]})}):D.jsxs("div",{children:["Dispatched At:"," ",D.jsx("span",{className:"font-medium",children:t?.dispatched_at?wl(new Date(t?.dispatched_at),"PPpp"):""})]}),D.jsxs("div",{children:["Remarks: ",D.jsx("span",{className:"font-medium"})]}),D.jsx("div",{className:"rounded-md border w-full p-2",children:t?.remarks??"N/A"})]})]})]},n))})]})}function z3e(){const{batch_number:e}=WA(),[t,n]=K.useState(),[i,c]=K.useState(!1),[d,m]=K.useState(!1),a=K.useCallback(()=>{e&&(c(!0),Qa.dispatches.details({batch_number:e}).then(w=>{console.log(w),n(w.data)}).catch(w=>{console.log(w)}).finally(()=>c(!1)))},[e]);return K.useEffect(()=>{a()},[a]),D.jsx(oh.div,{className:"flex flex-col h-full w-full px-4 pb-4",children:i?D.jsx("div",{className:"w-full h-full px-4",children:D.jsx(Oi,{})}):D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"h-[70vh]"}),D.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[D.jsx(D3e,{record:t}),D.jsx(k3e,{record:t}),D.jsx(N3e,{record:t}),D.jsx(L3e,{})]})]})})}function hG(e){const t=N=>String(N).padStart(2,"0"),n=e.getFullYear(),i=t(e.getMonth()+1),c=t(e.getDate()),d=t(e.getHours()),m=t(e.getMinutes()),a=t(e.getSeconds()),w=-e.getTimezoneOffset(),S=w>=0?"+":"-",M=t(Math.floor(Math.abs(w)/60)),P=t(Math.abs(w)%60);return`${n}-${i}-${c}T${d}:${m}:${a}${S}${M}:${P}`}function pw(e){return e?/[Z+\-]\d{2}(:?\d{2})?$/.test(e)||e.endsWith("Z")?new Date(e):/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(e)?new Date(`${e}:00`):new Date(e):null}function dG({control:e,name:t,label:n,min:i,max:c,className:d,rules:m}){return D.jsxs("div",{className:bn("flex flex-col gap-2 mb-3",d),children:[D.jsx(Ar,{htmlFor:t,className:"font-normal text-secondary-foreground",children:n}),D.jsx(iv,{name:t,rules:m,control:e,render:({field:a})=>D.jsxs(uS,{children:[D.jsx(hS,{asChild:!0,children:D.jsxs(na,{variant:"outline",className:bn("w-full justify-start text-left font-normal",!a.value&&"text-muted-foreground"),children:[D.jsx(uW,{className:"mr-2 h-4 w-4"}),a.value?(()=>{const w=pw(a.value);return w&&!isNaN(w)?wl(w,"PPP p"):"Pick a date & time"})():D.jsx("span",{children:"Pick a date & time"})]})}),D.jsxs(dS,{className:"w-auto p-0",children:[D.jsx(Lee,{mode:"single",selected:a.value?pw(a.value):void 0,onSelect:w=>{if(!w)return;const S=a.value?pw(a.value):new Date,M=S&&!isNaN(S)?S:new Date;w.setHours(M.getHours(),M.getMinutes(),M.getSeconds()||0,0),a.onChange(hG(w))},disabled:w=>i&&w<new Date(i)||c&&w>new Date(c)}),D.jsx("div",{className:"flex items-center justify-center p-3 border-t",children:D.jsx("input",{type:"time",className:"border rounded px-2 py-1 text-sm",value:a.value?(()=>{const w=pw(a.value);return w&&!isNaN(w)?`${String(w.getHours()).padStart(2,"0")}:${String(w.getMinutes()).padStart(2,"0")}`:"00:00"})():"00:00",onChange:w=>{const S=a.value?pw(a.value):new Date,P=S&&!isNaN(S)?S:new Date,[N,$]=w.target.value.split(":");P.setHours(+N,+$,P.getSeconds()||0,0),a.onChange(hG(P))}})})]})]})})]})}const kl=[];for(let e=0;e<256;++e)kl.push((e+256).toString(16).slice(1));function j3e(e,t=0){return(kl[e[t+0]]+kl[e[t+1]]+kl[e[t+2]]+kl[e[t+3]]+"-"+kl[e[t+4]]+kl[e[t+5]]+"-"+kl[e[t+6]]+kl[e[t+7]]+"-"+kl[e[t+8]]+kl[e[t+9]]+"-"+kl[e[t+10]]+kl[e[t+11]]+kl[e[t+12]]+kl[e[t+13]]+kl[e[t+14]]+kl[e[t+15]]).toLowerCase()}let PD;const B3e=new Uint8Array(16);function F3e(){if(!PD){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");PD=crypto.getRandomValues.bind(crypto)}return PD(B3e)}const V3e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fG={randomUUID:V3e};function U3e(e,t,n){e=e||{};const i=e.random??e.rng?.()??F3e();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,j3e(i)}function $3e(e,t,n){return fG.randomUUID&&!e?fG.randomUUID():U3e(e)}const pG="pk.eyJ1IjoiY2hyaXN0aWFubWFwYm94Y29tIiwiYSI6ImNtZXJ1bTcweTBhYjcya3EwZjloOG5vMjIifQ.KPbfNzCPPimuiUecFEZxCA";function q3e({label:e,name:t,register:n,setValue:i,errors:c,className:d}){const[m,a]=K.useState(""),[w,S]=K.useState([]),[M,P]=K.useState(null),[N,$]=K.useState(!1),[G,q]=K.useState(!1),[V,J]=K.useState(!1),[ee,re]=K.useState(-1),[fe]=K.useState(()=>$3e()),ne=async De=>{if(!De||De.length<3){S([]);return}q(!0);try{const Ye=await Wo.get("https://api.mapbox.com/search/searchbox/v1/suggest",{params:{q:De,access_token:pG,session_token:fe,limit:5,proximity:"121.0437,14.6760",country:"ph"}});console.log(Ye.data.suggestions),S(Ye.data.suggestions||[]),re(-1)}catch(Ye){console.error("Mapbox suggest error:",Ye)}finally{q(!1)}},ce=async De=>{try{const ze=(await Wo.get(`https://api.mapbox.com/search/searchbox/v1/retrieve/${De.mapbox_id}`,{params:{access_token:pG,session_token:fe}})).data.features[0];if(!ze)return;let tt="";ze.properties?.name&&ze.properties?.full_address?tt=`${ze.properties.name}, ${ze.properties.full_address}`:ze.properties?.name?tt=ze.properties.name:tt=ze.properties?.full_address||"";const at=ze.geometry?.coordinates||[],[ct,ht]=at;a(tt),S([]),$(!0),i(t,{address_name:tt,longitude:ct,latitude:ht})}catch(Ye){console.error("Mapbox retrieve error:",Ye)}},me=De=>{const Ye=De.target.value;a(Ye),$(!1),i(t,""),M&&clearTimeout(M),P(setTimeout(()=>ne(Ye),300))},ve=De=>{!V||w.length===0||(De.key==="ArrowDown"?(De.preventDefault(),re(Ye=>(Ye+1)%w.length)):De.key==="ArrowUp"?(De.preventDefault(),re(Ye=>Ye<=0?w.length-1:Ye-1)):De.key==="Enter"&&ee>=0&&(De.preventDefault(),ce(w[ee])))};return D.jsxs("div",{className:"relative flex flex-col gap-2 w-full",children:[D.jsx(Ar,{className:"font-normal text-secondary-foreground",children:e}),D.jsxs("div",{className:"relative",children:[D.jsx(io,{...n(t,{required:"Address is required"}),placeholder:e,value:m,onChange:me,onKeyDown:ve,onFocus:()=>{J(!0),ne(m)},onBlur:()=>setTimeout(()=>J(!1),200),autoComplete:"off",className:d}),G&&D.jsx(Fse,{className:"absolute right-2 top-2.5 h-4 w-4 animate-spin text-gray-400"})]}),!N&&m&&D.jsx(ou,{className:"text-red-500 text-xs",children:"Please select a valid address from suggestions"}),c[t]&&D.jsx(ou,{className:"text-red-500 text-xs",children:c[t].message}),V&&w.length>0&&D.jsx("div",{className:bn("absolute top-full left-0 z-10 w-full rounded-md mt-1 max-h-56 bg-white overflow-y-auto border shadow-sm"),children:D.jsx("ul",{children:w.map((De,Ye)=>D.jsx("li",{className:bn("p-2 cursor-pointer text-sm hover:bg-gray-100",ee===Ye&&"bg-gray-100 font-medium"),onMouseDown:()=>ce(De),children:De.name&&De.full_address?`${De.name}, ${De.full_address}`:De.name?`${De.name}`:De.full_address},De.mapbox_id||Ye))})})]})}function jee({className:e,...t}){return D.jsx("textarea",{"data-slot":"textarea",className:bn("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}function H3e(){const{auth:e}=K.useContext(B1),t=I1(),{control:n,handleSubmit:i,watch:c,register:d,formState:{errors:m,isSubmitting:a},setValue:w}=fv({defaultValues:{vehicle_ids:[{vehicle_id:""}],trip_plan:[]}}),{fields:S,append:M,remove:P}=XH({control:n,name:"vehicle_ids"}),{fields:N,append:$,remove:G}=XH({control:n,name:"trip_plan"}),[q,V]=K.useState([]),[J,ee]=K.useState(null);K.useEffect(()=>{(async()=>{try{const De=await Qa.vehicles.all({q:"Available"});console.log(De),De.status===200&&V(De.data?.vehicles||[])}catch{ua.error("Failed to fetch available vehicles")}})()},[]);const re=c("vehicle_ids").filter(ve=>ve.vehicle_id).map(ve=>ve.vehicle_id),fe=c("trip_plan"),ne=new Date;ne.setDate(ne.getDate()+1),ne.setHours(0,0,0,0);const ce=ne.toISOString().slice(0,16),me=async ve=>{if(re.length===0){ua.error("Please select at least 1 vehicle",{position:"top-center"});return}if(fe.length<2||fe.some(Ye=>!Ye.latitude||!Ye.longitude)){ua.error("Please provide at least 2 valid locations");return}const De={...ve,requestor_uuid:e.uuid,vehicle_ids:ve.vehicle_ids.map(Ye=>Ye.vehicle_id),trip_plan:ve.trip_plan.map((Ye,ze)=>({sequence:ze+1,address_name:Ye.address_name,latitude:Ye.latitude,longitude:Ye.longitude}))};try{const Ye=await Qa.reservations.submit(De);Ye.status===200&&(ua.success("Reservation submitted!"),e.role==="LogisticsII Admin"?t(`/logisticsII/reservation/${Ye.data.batch_number}`):t("/logisticsII/success"))}catch(Ye){ua.error(`Reservation failed: ${Ye.response.data}`)}};return D.jsx("div",{className:"px-1",children:D.jsxs("form",{onSubmit:i(me),className:"flex flex-col gap-4",children:[D.jsx("input",{type:"hidden",...d("requestor_uuid"),defaultValue:e.uuid}),D.jsxs("div",{className:"flex flex-col gap-4",children:[D.jsx(Ar,{className:"font-medium",children:"Vehicles"}),S.map((ve,De)=>D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx(iv,{name:`vehicle_ids.${De}.vehicle_id`,control:n,rules:{required:"Vehicle is required"},render:({field:Ye})=>D.jsxs(uS,{open:J===De,onOpenChange:ze=>ee(ze?De:null),children:[D.jsx(hS,{asChild:!0,children:D.jsxs(na,{variant:"outline",role:"combobox",className:"flex-1 justify-between",children:[Ye.value?`${q.find(ze=>ze.id===Ye.value)?.type} (${q.find(ze=>ze.id===Ye.value)?.capacity})`:"Select Vehicle...",D.jsx(n2,{className:"ml-2 h-4 w-4 opacity-50"})]})}),D.jsx(dS,{className:"w-[200px] p-0",children:D.jsxs(yj,{children:[D.jsx(_j,{placeholder:"Search Vehicle..."}),D.jsxs(vj,{children:[D.jsx(xj,{children:"No Vehicle found."}),D.jsx(bj,{children:q.map(ze=>D.jsxs(wj,{disabled:re.includes(ze.id),value:ze.id,onSelect:()=>{Ye.onChange(ze.id),ee(null)},children:[D.jsx(e2,{className:bn("mr-2 h-4 w-4",Ye.value===ze.id?"opacity-100":"opacity-0")}),ze.type," (",ze.vin,")"]},ze.id))})]})]})})]})}),S.length>1&&D.jsx(na,{type:"button",variant:"ghost",size:"icon",onClick:()=>P(De),children:D.jsx(ZF,{className:"h-4 w-4 text-red-500"})})]},ve.id)),D.jsxs(na,{type:"button",variant:"secondary",onClick:()=>M({vehicle_id:""}),children:[D.jsx(XF,{className:"h-4 w-4 mr-1"})," Add Vehicle"]})]}),D.jsxs("div",{className:"flex flex-col gap-2",children:[D.jsx(Ar,{className:"font-medium",children:"Date & Time"}),D.jsxs("div",{className:"flex gap-2",children:[D.jsxs("div",{className:"flex-1 w-full",children:[D.jsx(dG,{control:n,rules:{required:"Start Time"},className:"w-full",name:"start_dt",min:ce,label:"Start Time"}),m.start_dt&&D.jsx(ou,{className:"text-red-500",children:m.start_dt.message})]}),D.jsxs("div",{className:"flex-1 w-full",children:[D.jsx(dG,{control:n,rules:{required:"Start Time"},className:"w-full",name:"end_dt",min:c("start_dt"),label:"End Time"}),m.end_dt&&D.jsx(ou,{className:"text-red-500",children:m.end_dt.message})]})]})]}),D.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[D.jsx(Ar,{className:"font-medium",children:"Trip Plan (Locations)"}),N.map((ve,De)=>D.jsxs("div",{className:"flex items-center gap-2 w-full",children:[D.jsx(q3e,{className:"w-full flex-1",name:`trip_plan.${De}`,label:`Location ${De+1}`,setValue:w,register:d,errors:m}),N.length>1&&D.jsx(na,{type:"button",variant:"ghost",size:"icon",onClick:()=>G(De),children:D.jsx(ZF,{className:"h-4 w-4 text-red-500"})})]},ve.id)),D.jsxs(na,{type:"button",variant:"secondary",onClick:()=>$({address_name:"",latitude:"",longitude:""}),children:[D.jsx(XF,{className:"h-4 w-4 mr-1"})," Add Location"]})]}),D.jsxs("div",{children:[D.jsx(Ar,{className:"font-medium",children:"Purpose"}),D.jsx(iv,{name:"purpose",control:n,rules:{required:!0,message:"Please state this reservation purpose"},render:({field:ve})=>D.jsx(jee,{className:"break-all",...ve})})]}),D.jsx(na,{disabled:a,type:"submit",children:"Submit Reservation"})]})})}function G3e(){return D.jsx(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex gap-2 h-full px-4",children:D.jsxs("div",{className:"flex flex-col w-full",children:[D.jsx(Ar,{className:"text-xl mb-2",children:"Make Reservation"}),D.jsx("section",{children:D.jsx(H3e,{})})]})})}function W3e({record:e,onApprove:t,onReject:n,isSubmitting:i,setIsSubmitting:c}){return D.jsxs(Uo,{className:"flex-1 py-4 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsx($o,{children:D.jsxs(il,{className:"flex justify-between items-center",children:[D.jsxs("span",{className:"font-bold text-2xl tracking-tight",children:["RESERVATION ",D.jsx("span",{className:"",children:e?.batch_number})]}),e?.status==="Pending"&&e?.assignments?.length>0?D.jsxs("div",{className:"flex gap-2 items-center h-full",children:[D.jsxs(zA,{children:[D.jsx(jA,{asChild:!0,children:D.jsx(na,{disabled:i,size:"sm",children:i?"Submitting":"Approve"})}),D.jsxs(BA,{children:[D.jsxs(FA,{children:[D.jsx(UA,{children:"Approve Reservation"}),D.jsx($A,{children:"Are you sure you want to approve this reservation?"})]}),D.jsxs(VA,{children:[D.jsx(qA,{disabled:i,children:"Cancel"}),D.jsx(nG,{disabled:i,onClick:()=>t(c),children:i?"Submitting":"Approve"})]})]})]}),D.jsxs(zA,{children:[D.jsx(jA,{asChild:!0,children:D.jsx(na,{variant:"destructive",disabled:i,size:"sm",children:i?"Submitting":"Reject"})}),D.jsxs(BA,{children:[D.jsxs(FA,{children:[D.jsx(UA,{children:"Reject Reservation"}),D.jsx($A,{children:"Are you sure you want to reject this reservation?"})]}),D.jsxs(VA,{children:[D.jsx(qA,{disabled:i,children:"Cancel"}),D.jsx(nG,{disabled:i,onClick:()=>n(c),children:i?"Submitting":"Reject"})]})]})]})]}):D.jsx(_p,{className:`rounded-full py-2 px-3 flex items-center text-base font-semibold ${e?.status==="Rejected"?"bg-destructive":e?.status==="Confirmed"?"bg-green-700":""}`,children:e?.status})]})}),D.jsxs(qo,{children:[D.jsx("div",{className:"mb-4 grid grid-cols-1 gap-2",children:D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-semibold",children:"Requested By:"}),D.jsx("span",{className:"font-bold ",children:e?.requestor_uuid})]})}),D.jsxs("div",{className:"my-4 w-full",children:[D.jsx("h3",{className:"font-semibold text-lg",children:"Date and Time"}),D.jsx(Us,{className:"my-2"}),D.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-medium",children:"Start:"}),D.jsx("span",{className:"font-bold",children:e?.start_date?wl(new Date(e.start_date),"PPp"):"N/A"})]}),D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-medium",children:"End:"}),D.jsx("span",{className:"font-bold",children:e?.end_date?wl(new Date(e.end_date),"PPp"):"N/A"})]})]})]}),D.jsxs("div",{className:"my-4 w-full",children:[D.jsx("h3",{className:"font-semibold text-lg",children:"Trip Routes"}),D.jsx(Us,{className:"my-2"}),D.jsx("div",{className:"flex flex-col gap-3 w-full",children:e?.trip_routes?.length>0?e.trip_routes.map((d,m)=>D.jsx("div",{className:"flex flex-col gap-1",children:D.jsxs("div",{className:"flex justify-between items-center",children:[D.jsx("h3",{className:"text-muted-foreground font-medium",children:m===0?"Start":m===e.trip_routes.length-1?"End":`Stop ${m}`}),D.jsx("span",{className:"font-bold ",children:d.full_address})]})},d.id)):D.jsx("h3",{className:"text-gray-500",children:"No trip routes available"})})]}),D.jsxs("div",{className:"my-4 w-full",children:[D.jsx("h3",{className:"font-semibold text-lg",children:"Reservation Purpose"}),D.jsx(Us,{className:"my-2"}),D.jsx(jee,{disabled:"true",className:"break-all text-primary text-lg",children:e?.purpose??"N/A"})]})]})]})}function X3e({record:e,assignments:t,onAssign:n}){return D.jsxs(Uo,{className:"w-full bg-card/80 backdrop-blur-md rounded-md",children:[D.jsxs($o,{children:[D.jsx(il,{children:"Vehicles and Drivers"}),D.jsx(hc,{children:"Please assign drivers to the vehicles below."})]}),D.jsx(qo,{children:e?.assignments?.map((i,c)=>D.jsxs("div",{className:"flex justify-end h-48 lg:max-w-xl border",children:[D.jsx("div",{className:"w-full h-full flex-1",children:D.jsx("img",{src:i.image_url,className:"w-full h-full object-cover rounded-md",alt:"Vehicle",loading:"lazy"})}),D.jsx(Us,{orientation:"vertical"}),D.jsxs("div",{className:"flex flex-1 flex-col p-2 gap-2",children:[D.jsxs("div",{className:"flex justify-between",children:[D.jsxs("h3",{className:"font-semibold",children:["Type: ",i.type]}),D.jsx(_p,{children:i.vehicle_status})]}),D.jsxs("h3",{className:"font-semibold",children:["Capacity: ",i.capacity]}),e.status==="Rejected"?null:i.driver_name?D.jsxs("h3",{className:"font-semibold",children:["Driver: ",i.driver_name]}):D.jsx(zee,{assignments:t,onSelect:d=>n(i.vehicle_id,d.uuid),defaultValue:i.driver_name})]})]},c))})]})}function Z3e({totalCost:e,totalDistance:t,totalDuration:n}){return D.jsxs("div",{className:"flex w-full gap-2",children:[D.jsxs(Uo,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Estimated Cost"}),D.jsx(hc,{children:"Pre-trip estimated cost"})]}),D.jsxs(qo,{children:[D.jsx(Ar,{className:"text-xl text-gray-500",children:"Philippine Peso"}),D.jsx(Ar,{className:"text-3xl font-semibold",children:e??"N/A"})]})]}),D.jsxs(Uo,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Travel Distance"}),D.jsx(hc,{children:"Total distance"})]}),D.jsxs(qo,{children:[D.jsx(Ar,{className:"text-xl text-gray-500",children:"Kilometer"}),D.jsx(Ar,{className:"text-3xl font-semibold",children:t??"N/A"})]})]}),D.jsxs(Uo,{className:"flex-1 rounded-md bg-card/80 backdrop-blur-md",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Travel Duration"}),D.jsx(hc,{children:"Total duration"})]}),D.jsxs(qo,{children:[D.jsx(Ar,{className:"text-xl text-gray-500",children:"Minutes"}),D.jsx(Ar,{className:"text-3xl font-semibold",children:n??"N/A"})]})]})]})}var fE={exports:{}},Y3e=fE.exports,mG;function K3e(){return mG||(mG=1,(function(e,t){(function(n,i){e.exports=i()})(Y3e,(function(){var n,i,c;function d(a,w){if(!n)n=w;else if(!i)i=w;else{var S="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",M={};n(M),c=w(M),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([S],{type:"text/javascript"})))}}d(["exports"],(function(a){var w=1e-6,S=typeof Float32Array<"u"?Float32Array:Array;function M(l,r){var s=r[0],h=r[1],p=r[2],_=r[3],x=s*_-p*h;return x?(l[0]=_*(x=1/x),l[1]=-h*x,l[2]=-p*x,l[3]=s*x,l):null}function P(){var l=new S(9);return S!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function N(l,r){var s=r[0],h=r[1],p=r[2],_=r[3],x=r[4],E=r[5],O=r[6],R=r[7],z=r[8];return l[0]=x*z-E*R,l[1]=p*R-h*z,l[2]=h*E-p*x,l[3]=E*O-_*z,l[4]=s*z-p*O,l[5]=p*_-s*E,l[6]=_*R-x*O,l[7]=h*O-s*R,l[8]=s*x-h*_,l}function $(l,r,s){var h=r[0],p=r[1],_=r[2],x=r[3],E=r[4],O=r[5],R=r[6],z=r[7],j=r[8],B=s[0],X=s[1],Z=s[2],ae=s[3],se=s[4],pe=s[5],we=s[6],be=s[7],Ee=s[8];return l[0]=B*h+X*x+Z*R,l[1]=B*p+X*E+Z*z,l[2]=B*_+X*O+Z*j,l[3]=ae*h+se*x+pe*R,l[4]=ae*p+se*E+pe*z,l[5]=ae*_+se*O+pe*j,l[6]=we*h+be*x+Ee*R,l[7]=we*p+be*E+Ee*z,l[8]=we*_+be*O+Ee*j,l}function G(){var l=new S(16);return S!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l}function q(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function V(l,r){var s=r[0],h=r[1],p=r[2],_=r[3],x=r[4],E=r[5],O=r[6],R=r[7],z=r[8],j=r[9],B=r[10],X=r[11],Z=r[12],ae=r[13],se=r[14],pe=r[15],we=s*E-h*x,be=s*O-p*x,Ee=s*R-_*x,Ge=h*O-p*E,Ue=h*R-_*E,$e=p*R-_*O,Je=z*ae-j*Z,it=z*se-B*Z,Mt=z*pe-X*Z,ut=j*se-B*ae,Dt=j*pe-X*ae,ln=B*pe-X*se,Vt=we*ln-be*Dt+Ee*ut+Ge*Mt-Ue*it+$e*Je;return Vt?(l[0]=(E*ln-O*Dt+R*ut)*(Vt=1/Vt),l[1]=(p*Dt-h*ln-_*ut)*Vt,l[2]=(ae*$e-se*Ue+pe*Ge)*Vt,l[3]=(B*Ue-j*$e-X*Ge)*Vt,l[4]=(O*Mt-x*ln-R*it)*Vt,l[5]=(s*ln-p*Mt+_*it)*Vt,l[6]=(se*Ee-Z*$e-pe*be)*Vt,l[7]=(z*$e-B*Ee+X*be)*Vt,l[8]=(x*Dt-E*Mt+R*Je)*Vt,l[9]=(h*Mt-s*Dt-_*Je)*Vt,l[10]=(Z*Ue-ae*Ee+pe*we)*Vt,l[11]=(j*Ee-z*Ue-X*we)*Vt,l[12]=(E*it-x*ut-O*Je)*Vt,l[13]=(s*ut-h*it+p*Je)*Vt,l[14]=(ae*be-Z*Ge-se*we)*Vt,l[15]=(z*Ge-j*be+B*we)*Vt,l):null}function J(l,r,s){var h=r[0],p=r[1],_=r[2],x=r[3],E=r[4],O=r[5],R=r[6],z=r[7],j=r[8],B=r[9],X=r[10],Z=r[11],ae=r[12],se=r[13],pe=r[14],we=r[15],be=s[0],Ee=s[1],Ge=s[2],Ue=s[3];return l[0]=be*h+Ee*E+Ge*j+Ue*ae,l[1]=be*p+Ee*O+Ge*B+Ue*se,l[2]=be*_+Ee*R+Ge*X+Ue*pe,l[3]=be*x+Ee*z+Ge*Z+Ue*we,l[4]=(be=s[4])*h+(Ee=s[5])*E+(Ge=s[6])*j+(Ue=s[7])*ae,l[5]=be*p+Ee*O+Ge*B+Ue*se,l[6]=be*_+Ee*R+Ge*X+Ue*pe,l[7]=be*x+Ee*z+Ge*Z+Ue*we,l[8]=(be=s[8])*h+(Ee=s[9])*E+(Ge=s[10])*j+(Ue=s[11])*ae,l[9]=be*p+Ee*O+Ge*B+Ue*se,l[10]=be*_+Ee*R+Ge*X+Ue*pe,l[11]=be*x+Ee*z+Ge*Z+Ue*we,l[12]=(be=s[12])*h+(Ee=s[13])*E+(Ge=s[14])*j+(Ue=s[15])*ae,l[13]=be*p+Ee*O+Ge*B+Ue*se,l[14]=be*_+Ee*R+Ge*X+Ue*pe,l[15]=be*x+Ee*z+Ge*Z+Ue*we,l}function ee(l,r,s){var h,p,_,x,E,O,R,z,j,B,X,Z,ae=s[0],se=s[1],pe=s[2];return r===l?(l[12]=r[0]*ae+r[4]*se+r[8]*pe+r[12],l[13]=r[1]*ae+r[5]*se+r[9]*pe+r[13],l[14]=r[2]*ae+r[6]*se+r[10]*pe+r[14],l[15]=r[3]*ae+r[7]*se+r[11]*pe+r[15]):(p=r[1],_=r[2],x=r[3],E=r[4],O=r[5],R=r[6],z=r[7],j=r[8],B=r[9],X=r[10],Z=r[11],l[0]=h=r[0],l[1]=p,l[2]=_,l[3]=x,l[4]=E,l[5]=O,l[6]=R,l[7]=z,l[8]=j,l[9]=B,l[10]=X,l[11]=Z,l[12]=h*ae+E*se+j*pe+r[12],l[13]=p*ae+O*se+B*pe+r[13],l[14]=_*ae+R*se+X*pe+r[14],l[15]=x*ae+z*se+Z*pe+r[15]),l}function re(l,r,s){var h=s[0],p=s[1],_=s[2];return l[0]=r[0]*h,l[1]=r[1]*h,l[2]=r[2]*h,l[3]=r[3]*h,l[4]=r[4]*p,l[5]=r[5]*p,l[6]=r[6]*p,l[7]=r[7]*p,l[8]=r[8]*_,l[9]=r[9]*_,l[10]=r[10]*_,l[11]=r[11]*_,l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15],l}function fe(l,r,s){var h=Math.sin(s),p=Math.cos(s),_=r[4],x=r[5],E=r[6],O=r[7],R=r[8],z=r[9],j=r[10],B=r[11];return r!==l&&(l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=r[3],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[4]=_*p+R*h,l[5]=x*p+z*h,l[6]=E*p+j*h,l[7]=O*p+B*h,l[8]=R*p-_*h,l[9]=z*p-x*h,l[10]=j*p-E*h,l[11]=B*p-O*h,l}function ne(l,r,s){var h=Math.sin(s),p=Math.cos(s),_=r[0],x=r[1],E=r[2],O=r[3],R=r[8],z=r[9],j=r[10],B=r[11];return r!==l&&(l[4]=r[4],l[5]=r[5],l[6]=r[6],l[7]=r[7],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[0]=_*p-R*h,l[1]=x*p-z*h,l[2]=E*p-j*h,l[3]=O*p-B*h,l[8]=_*h+R*p,l[9]=x*h+z*p,l[10]=E*h+j*p,l[11]=O*h+B*p,l}function ce(l,r,s){var h=Math.sin(s),p=Math.cos(s),_=r[0],x=r[1],E=r[2],O=r[3],R=r[4],z=r[5],j=r[6],B=r[7];return r!==l&&(l[8]=r[8],l[9]=r[9],l[10]=r[10],l[11]=r[11],l[12]=r[12],l[13]=r[13],l[14]=r[14],l[15]=r[15]),l[0]=_*p+R*h,l[1]=x*p+z*h,l[2]=E*p+j*h,l[3]=O*p+B*h,l[4]=R*p-_*h,l[5]=z*p-x*h,l[6]=j*p-E*h,l[7]=B*p-O*h,l}function me(l,r){return l[0]=r[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=r[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=r[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function ve(l,r,s){var h,p,_,x=s[0],E=s[1],O=s[2],R=Math.hypot(x,E,O);return R<w?null:(x*=R=1/R,E*=R,O*=R,h=Math.sin(r),p=Math.cos(r),l[0]=x*x*(_=1-p)+p,l[1]=E*x*_+O*h,l[2]=O*x*_-E*h,l[3]=0,l[4]=x*E*_-O*h,l[5]=E*E*_+p,l[6]=O*E*_+x*h,l[7]=0,l[8]=x*O*_+E*h,l[9]=E*O*_-x*h,l[10]=O*O*_+p,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}function De(l,r){var s=r[0],h=r[1],p=r[2],_=r[3],x=s+s,E=h+h,O=p+p,R=s*x,z=h*x,j=h*E,B=p*x,X=p*E,Z=p*O,ae=_*x,se=_*E,pe=_*O;return l[0]=1-j-Z,l[1]=z+pe,l[2]=B-se,l[3]=0,l[4]=z-pe,l[5]=1-R-Z,l[6]=X+ae,l[7]=0,l[8]=B+se,l[9]=X-ae,l[10]=1-R-j,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}Math.hypot||(Math.hypot=function(){for(var l=0,r=arguments.length;r--;)l+=arguments[r]*arguments[r];return Math.sqrt(l)});var Ye=J;function ze(){var l=new S(3);return S!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function tt(l){var r=new S(3);return r[0]=l[0],r[1]=l[1],r[2]=l[2],r}function at(l){return Math.hypot(l[0],l[1],l[2])}function ct(l,r,s){var h=new S(3);return h[0]=l,h[1]=r,h[2]=s,h}function ht(l,r,s,h){return l[0]=r,l[1]=s,l[2]=h,l}function Ie(l,r,s){return l[0]=r[0]+s[0],l[1]=r[1]+s[1],l[2]=r[2]+s[2],l}function rt(l,r,s){return l[0]=r[0]-s[0],l[1]=r[1]-s[1],l[2]=r[2]-s[2],l}function Qe(l,r,s){return l[0]=r[0]*s[0],l[1]=r[1]*s[1],l[2]=r[2]*s[2],l}function St(l,r,s){return l[0]=Math.min(r[0],s[0]),l[1]=Math.min(r[1],s[1]),l[2]=Math.min(r[2],s[2]),l}function qe(l,r,s){return l[0]=Math.max(r[0],s[0]),l[1]=Math.max(r[1],s[1]),l[2]=Math.max(r[2],s[2]),l}function vt(l,r,s){return l[0]=r[0]*s,l[1]=r[1]*s,l[2]=r[2]*s,l}function nt(l,r,s,h){return l[0]=r[0]+s[0]*h,l[1]=r[1]+s[1]*h,l[2]=r[2]+s[2]*h,l}function gt(l,r){var s=r[0]-l[0],h=r[1]-l[1],p=r[2]-l[2];return s*s+h*h+p*p}function Ut(l){var r=l[0],s=l[1],h=l[2];return r*r+s*s+h*h}function $t(l,r){return l[0]=-r[0],l[1]=-r[1],l[2]=-r[2],l}function qt(l,r){var s=r[0],h=r[1],p=r[2],_=s*s+h*h+p*p;return _>0&&(_=1/Math.sqrt(_)),l[0]=r[0]*_,l[1]=r[1]*_,l[2]=r[2]*_,l}function Ht(l,r){return l[0]*r[0]+l[1]*r[1]+l[2]*r[2]}function mn(l,r,s){var h=r[0],p=r[1],_=r[2],x=s[0],E=s[1],O=s[2];return l[0]=p*O-_*E,l[1]=_*x-h*O,l[2]=h*E-p*x,l}function en(l,r,s,h){var p=r[0],_=r[1],x=r[2];return l[0]=p+h*(s[0]-p),l[1]=_+h*(s[1]-_),l[2]=x+h*(s[2]-x),l}function En(l,r,s){var h=r[0],p=r[1],_=r[2],x=s[3]*h+s[7]*p+s[11]*_+s[15];return l[0]=(s[0]*h+s[4]*p+s[8]*_+s[12])/(x=x||1),l[1]=(s[1]*h+s[5]*p+s[9]*_+s[13])/x,l[2]=(s[2]*h+s[6]*p+s[10]*_+s[14])/x,l}function Xn(l,r,s){var h=r[0],p=r[1],_=r[2];return l[0]=h*s[0]+p*s[3]+_*s[6],l[1]=h*s[1]+p*s[4]+_*s[7],l[2]=h*s[2]+p*s[5]+_*s[8],l}function cn(l,r,s){var h=s[0],p=s[1],_=s[2],x=r[0],E=r[1],O=r[2],R=p*O-_*E,z=_*x-h*O,j=h*E-p*x,B=p*j-_*z,X=_*R-h*j,Z=h*z-p*R,ae=2*s[3];return z*=ae,j*=ae,X*=2,Z*=2,l[0]=x+(R*=ae)+(B*=2),l[1]=E+z+X,l[2]=O+j+Z,l}function Jr(l){return l[0]=0,l[1]=0,l[2]=0,l}function mr(l,r){return l[0]===r[0]&&l[1]===r[1]&&l[2]===r[2]}var Cr=rt,li=Qe,hi=at;function so(){var l=new S(4);return S!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0,l[3]=0),l}function ra(l,r,s){return l[0]=r[0]*s,l[1]=r[1]*s,l[2]=r[2]*s,l[3]=r[3]*s,l}function xt(l,r){var s=r[0],h=r[1],p=r[2],_=r[3],x=s*s+h*h+p*p+_*_;return x>0&&(x=1/Math.sqrt(x)),l[0]=s*x,l[1]=h*x,l[2]=p*x,l[3]=_*x,l}function Bt(l,r,s){var h=r[0],p=r[1],_=r[2],x=r[3];return l[0]=s[0]*h+s[4]*p+s[8]*_+s[12]*x,l[1]=s[1]*h+s[5]*p+s[9]*_+s[13]*x,l[2]=s[2]*h+s[6]*p+s[10]*_+s[14]*x,l[3]=s[3]*h+s[7]*p+s[11]*_+s[15]*x,l}function tn(){var l=new S(4);return S!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function $n(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function qn(l,r,s){s*=.5;var h=r[0],p=r[1],_=r[2],x=r[3],E=Math.sin(s),O=Math.cos(s);return l[0]=h*O+x*E,l[1]=p*O+_*E,l[2]=_*O-p*E,l[3]=x*O-h*E,l}function An(l,r,s){s*=.5;var h=r[0],p=r[1],_=r[2],x=r[3],E=Math.sin(s),O=Math.cos(s);return l[0]=h*O-_*E,l[1]=p*O+x*E,l[2]=_*O+h*E,l[3]=x*O-p*E,l}ze(),so();var tr,Ir,mi,Mi=xt,_o=(tr=ze(),Ir=ct(1,0,0),mi=ct(0,1,0),function(l,r,s){var h=Ht(r,s);return h<-.999999?(mn(tr,Ir,r),hi(tr)<1e-6&&mn(tr,mi,r),qt(tr,tr),(function(p,_,x){x*=.5;var E=Math.sin(x);p[0]=E*_[0],p[1]=E*_[1],p[2]=E*_[2],p[3]=Math.cos(x)})(l,tr,Math.PI),l):h>.999999?(l[0]=0,l[1]=0,l[2]=0,l[3]=1,l):(mn(tr,r,s),l[0]=tr[0],l[1]=tr[1],l[2]=tr[2],l[3]=1+h,Mi(l,l))});function oa(){var l=new S(2);return S!=Float32Array&&(l[0]=0,l[1]=0),l}function Ua(l,r){var s=new S(2);return s[0]=l,s[1]=r,s}function lo(l,r,s){return l[0]=r[0]+s[0],l[1]=r[1]+s[1],l}function eo(l,r,s){return l[0]=r[0]-s[0],l[1]=r[1]-s[1],l}function co(l,r,s){return l[0]=r[0]*s,l[1]=r[1]*s,l}function vo(l){return Math.hypot(l[0],l[1])}function ss(l,r){var s=r[0],h=r[1],p=s*s+h*h;return p>0&&(p=1/Math.sqrt(p)),l[0]=r[0]*p,l[1]=r[1]*p,l}function ir(l,r){return l[0]*r[0]+l[1]*r[1]}tn(),tn(),P();var xi,ci,Ra=eo;function ya(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}oa();var Tl=(function(){if(ci)return xi;function l(r,s,h,p){this.cx=3*r,this.bx=3*(h-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=h,this.p2y=p}return ci=1,xi=l,l.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var h=r,p=0;p<8;p++){var _=this.sampleCurveX(h)-r;if(Math.abs(_)<s)return h;var x=this.sampleCurveDerivativeX(h);if(Math.abs(x)<1e-6)break;h-=_/x}var E=0,O=1;for(h=r,p=0;p<20&&(_=this.sampleCurveX(h),!(Math.abs(_-r)<s));p++)r>_?E=h:O=h,h=.5*(O-E)+E;return h},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},xi})(),dr=ya(Tl);function kt(l,r){this.x=l,this.y=r}function Dr(l,r){if(Array.isArray(l)){if(!Array.isArray(r)||l.length!==r.length)return!1;for(let s=0;s<l.length;s++)if(!Dr(l[s],r[s]))return!1;return!0}if(typeof l=="object"&&l!==null&&r!==null){if(typeof r!="object"||Object.keys(l).length!==Object.keys(r).length)return!1;for(const s in l)if(!Dr(l[s],r[s]))return!1;return!0}return l===r}kt.prototype={clone(){return new kt(this.x,this.y)},add(l){return this.clone()._add(l)},sub(l){return this.clone()._sub(l)},multByPoint(l){return this.clone()._multByPoint(l)},divByPoint(l){return this.clone()._divByPoint(l)},mult(l){return this.clone()._mult(l)},div(l){return this.clone()._div(l)},rotate(l){return this.clone()._rotate(l)},rotateAround(l,r){return this.clone()._rotateAround(l,r)},matMult(l){return this.clone()._matMult(l)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(l){return this.x===l.x&&this.y===l.y},dist(l){return Math.sqrt(this.distSqr(l))},distSqr(l){const r=l.x-this.x,s=l.y-this.y;return r*r+s*s},angle(){return Math.atan2(this.y,this.x)},angleTo(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith(l){return this.angleWithSep(l.x,l.y)},angleWithSep(l,r){return Math.atan2(this.x*r-this.y*l,this.x*l+this.y*r)},_matMult(l){const r=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=r,this},_add(l){return this.x+=l.x,this.y+=l.y,this},_sub(l){return this.x-=l.x,this.y-=l.y,this},_mult(l){return this.x*=l,this.y*=l,this},_div(l){return this.x/=l,this.y/=l,this},_multByPoint(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint(l){return this.x/=l.x,this.y/=l.y,this},_unit(){return this._div(this.mag()),this},_perp(){const l=this.y;return this.y=this.x,this.x=-l,this},_rotate(l){const r=Math.cos(l),s=Math.sin(l),h=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=h,this},_rotateAround(l,r){const s=Math.cos(l),h=Math.sin(l),p=r.y+h*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-h*(this.y-r.y),this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:kt},kt.convert=function(l){if(l instanceof kt)return l;if(Array.isArray(l))return new kt(+l[0],+l[1]);if(l.x!==void 0&&l.y!==void 0)return new kt(+l.x,+l.y);throw new Error("Expected [x, y] or {x, y} point format")};const to=Math.PI/180,Hs=180/Math.PI;function hr(l){return l*to}function ot(l){return l*Hs}const he=[[0,0],[1,0],[1,1],[0,1]];function ye(l){if(l<=0)return 0;if(l>=1)return 1;const r=l*l,s=r*l;return 4*(l<.5?s:3*(l-r)+s-.75)}function Ae(l,r,s,h){const p=new dr(l,r,s,h);return function(_){return p.solve(_)}}const He=Ae(.25,.1,.25,1);function Pe(l,r,s){return Math.min(s,Math.max(r,l))}function Ke(l,r,s){return(s=Pe((s-l)/(r-l),0,1))*s*(3-2*s)}function wt(l,r,s){const h=s-r,p=((l-r)%h+h)%h+r;return p===r?s:p}function et(l,r,s){if(!l.length)return s(null,[]);let h=l.length;const p=new Array(l.length);let _=null;l.forEach(((x,E)=>{r(x,((O,R)=>{O&&(_=O),p[E]=R,--h==0&&s(_,p)}))}))}function yt(l,...r){for(const s of r)for(const h in s)l[h]=s[h];return l}let Zt=1;function zt(){return Zt++}function Fn(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Yn(l,r){l.forEach((s=>{r[s]&&(r[s]=r[s].bind(r))}))}function Hn(l,r,s){const h={};for(const p in l)h[p]=r.call(this,l[p],p,l);return h}function Mr(l,r,s){const h={};for(const p in l)r.call(this,l[p],p,l)&&(h[p]=l[p]);return h}function gr(l){return Array.isArray(l)?l.map(gr):typeof l=="object"&&l?Hn(l,gr):l}function Sr(l,r){for(let s=0;s<l.length;s++)if(r.indexOf(l[s])>=0)return!0;return!1}const gi={};function jr(l){gi[l]||(typeof console<"u"&&console.warn(l),gi[l]=!0)}function da(l,r,s){return(s.y-l.y)*(r.x-l.x)>(r.y-l.y)*(s.x-l.x)}function Ia(l){let r=0;for(let s,h,p=0,_=l.length,x=_-1;p<_;x=p++)s=l[p],h=l[x],r+=(h.x-s.x)*(s.y+h.y);return r}function $a([l,r,s]){const h=hr(r+90),p=hr(s);return{x:l*Math.cos(h)*Math.sin(p),y:l*Math.sin(h)*Math.sin(p),z:l*Math.cos(p),azimuthal:r,polar:s}}function yi(l){return(typeof self<"u"||l!==void 0)&&typeof WorkerGlobalScope<"u"&&(l!==void 0?l:self)instanceof WorkerGlobalScope}function Qr(l){const r={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((s,h,p,_)=>{const x=p||_;return r[h]=!x||x.toLowerCase(),""})),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r}let Ri=null;function Gi(l,r){return[l[4*r],l[4*r+1],l[4*r+2],l[4*r+3]]}function bi(l,r,s,h){for(;r<s;){const p=r+s>>1;l[p]<h?r=p+1:s=p}return r}function Da(l,r,s,h){for(;r<s;){const p=r+s>>1;l[p]<=h?r=p+1:s=p}return r}function Xa(l){return l>0?1/(1.001-l):1+l}function uo(l){return l>0?1-1/(1.001-l):-l}function td(l,r,s){return(l-r.min)*(s.max-s.min)/(r.max-r.min)+s.min}const xo={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!xo.API_URL)return null;try{const l=new URL(xo.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.1.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ro(l){return xo.API_URL_REGEX.test(l)}function nd(l){return xo.API_SPRITE_REGEX.test(l)}let fu,Lc,rd,Nc,jl,bo;function sh(){return fu==null&&(fu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),fu}const ls={now:()=>Nc!==void 0?Nc:performance.now(),setNow(l){Nc=l},restoreNow(){Nc=void 0},frame(l){const r=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(l,r=0){const{width:s,height:h}=l;jl||(jl=document.createElement("canvas"));const p=jl.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(s>jl.width||h>jl.height)&&(jl.width=s,jl.height=h),p.clearRect(-r,-r,s+2*r,h+2*r),p.drawImage(l,0,0,s,h),p.getImageData(-r,-r,s+2*r,h+2*r)},resolveURL:l=>(Lc||(Lc=document.createElement("a")),Lc.href=l,Lc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(rd==null&&(rd=window.matchMedia("(prefers-reduced-motion: reduce)")),rd.matches)},hasCanvasFingerprintNoise(){if(bo!==void 0)return bo;if(!sh())return bo=!1,!1;const l=new OffscreenCanvas(85,1),r=l.getContext("2d",{willReadFrequently:!0});let s=0;for(let p=0;p<l.width;++p)r.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,r.fillRect(p,0,1,1);const h=r.getImageData(0,0,l.width,l.height);s=0;for(let p=0;p<h.data.length;++p)if(p%4!=3&&s++!==h.data[p])return bo=!0,!0;return bo=!1,!1}};function ms(l,r){const s=l.indexOf("?");if(s<0)return`${l}?${new URLSearchParams(r).toString()}`;const h=new URLSearchParams(l.slice(s));for(const p in r)h.set(p,r[p]);return`${l.slice(0,s)}?${h.toString()}`}function Xo(l,r={persistentParams:[]}){const s=l.indexOf("?");if(s<0)return l;const h=new URLSearchParams,p=new URLSearchParams(l.slice(s));for(const x of r.persistentParams){const E=p.get(x);E&&h.set(x,E)}const _=h.toString();return`${l.slice(0,s)}${_.length>0?`?${_}`:""}`}const Bl="mapbox-tiles";let cl=500,Cs=50;const id=["language","worldview","jobid"];let El,zc;function gs(){try{return caches}catch{}}function lh(){const l=gs();l&&El==null&&(El=l.open(Bl))}let Sp=1/0;const ch={supported:!1,testSupport:function(l){!Vl&&Fl&&(ul?af(l):Zo=l)}};let Zo,Fl,Vl=!1,ul=!1;const Tp=typeof self<"u"?self:{};function af(l){const r=l.createTexture();l.bindTexture(l.TEXTURE_2D,r);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Fl),l.isContextLost())return;ch.supported=!0}catch{}l.deleteTexture(r),Vl=!0}Tp.document&&(Fl=Tp.document.createElement("img"),Fl.onload=function(){Zo&&af(Zo),Zo=null,ul=!0},Fl.onerror=function(){Vl=!0,Zo=null},Fl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const uh={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(uh);class Fr extends Error{constructor(r,s,h){s===401&&Ro(h)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=s,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const hl=yi()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,jc=function(l,r){if(!(/^file:/.test(s=l.url)||/^file:/.test(hl())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return(function(h,p){const _=new AbortController,x=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:hl(),referrerPolicy:h.referrerPolicy,signal:_.signal});let E=!1,O=!1;const R=(z=x.url).indexOf("sku=")>0&&Ro(z);var z;h.type==="json"&&x.headers.set("Accept","application/json");const j=(X,Z,ae)=>{if(O)return;if(X&&X.message!=="SecurityError"&&jr(X.toString()),Z&&ae)return B(Z);const se=Date.now();fetch(x).then((pe=>{if(pe.ok){const we=R?pe.clone():null;return B(pe,we,se)}return p(new Fr(pe.statusText,pe.status,h.url))})).catch((pe=>{pe.name!=="AbortError"&&p(new Error(`${pe.message} ${h.url}`))}))},B=(X,Z,ae)=>{(h.type==="arrayBuffer"?X.arrayBuffer():h.type==="json"?X.json():X.text()).then((se=>{O||(Z&&ae&&(function(pe,we,be){if(lh(),El==null)return;const Ee=Qr(we.headers.get("Cache-Control")||"");if(Ee["no-store"])return;const Ge={status:we.status,statusText:we.statusText,headers:new Headers};we.headers.forEach(((Je,it)=>Ge.headers.set(it,Je))),Ee["max-age"]&&Ge.headers.set("Expires",new Date(be+1e3*Ee["max-age"]).toUTCString());const Ue=Ge.headers.get("Expires");if(!Ue||new Date(Ue).getTime()-be<42e4)return;let $e=Xo(pe.url,{persistentParams:id});if(we.status===206){const Je=pe.headers.get("Range");if(!Je)return;Ge.status=200,$e=ms($e,{range:Je})}(function(Je,it){if(zc===void 0)try{new Response(new ReadableStream),zc=!0}catch{zc=!1}zc?it(Je.body):Je.blob().then(it).catch((Mt=>jr(Mt.message)))})(we,(Je=>{const it=new Response((Mt=we.status)!==200&&Mt!==404&&[101,103,204,205,304].includes(Mt)?null:Je,Ge);var Mt;lh(),El?.then((ut=>ut.put($e,it))).catch((ut=>jr(ut.message)))}))})(x,Z,ae),E=!0,p(null,se,X.headers.get("Cache-Control"),X.headers.get("Expires")))})).catch((se=>{O||p(new Error(se.message))}))};return R?(function(X,Z){if(lh(),El==null)return Z(null);El.then((ae=>{let se=Xo(X.url,{persistentParams:id});const pe=X.headers.get("Range");pe&&(se=ms(se,{range:pe})),ae.match(se).then((we=>{const be=(function(Ee){if(!Ee)return!1;const Ge=new Date(Ee.headers.get("Expires")||0),Ue=Qr(Ee.headers.get("Cache-Control")||"");return Number(Ge)>Date.now()&&!Ue["no-cache"]})(we);ae.delete(se).catch(Z),be&&ae.put(se,we.clone()).catch(Z),Z(null,we,be)})).catch(Z)})).catch(Z)})(x,j):j(null,null),{cancel:()=>{O=!0,E||_.abort()}}})(l,r);if(yi(self)&&self.worker.actor)return self.worker.actor.send("getResource",l,r,void 0,!0)}var s;return(function(h,p){const _=new XMLHttpRequest;_.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const x in h.headers)_.setRequestHeader(x,h.headers[x]);return h.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=h.credentials==="include",_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let x=_.response;if(h.type==="json")try{x=JSON.parse(_.response)}catch(E){return p(E)}p(null,x,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new Fr(_.statusText,_.status,h.url))},_.send(h.body),{cancel:()=>_.abort()}})(l,r)},pc=function(l,r){return jc(yt(l,{type:"arrayBuffer"}),r)};function Bc(l){const r=document.createElement("a");return r.href=l,r.protocol===location.protocol&&r.host===location.host}const pu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Al,mc;Al=[],mc=0;const Fc=function(l,r){if(ch.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),mc>=xo.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:l,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Al.push(_),_}mc++;let s=!1;const h=()=>{if(!s)for(s=!0,mc--;Al.length&&mc<xo.MAX_PARALLEL_IMAGE_REQUESTS;){const _=Al.shift(),{requestParameters:x,callback:E,cancelled:O}=_;O||(_.cancel=Fc(x,E).cancel)}},p=pc(l,((_,x,E,O)=>{h(),_?r(_):x&&(self.createImageBitmap?(function(R,z){const j=new Blob([new Uint8Array(R)],{type:"image/png"});createImageBitmap(j).then((B=>{z(null,B)})).catch((B=>{z(new Error(`Could not load image because of ${B.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(x,((R,z)=>r(R,z,E,O))):(function(R,z){const j=new Image;j.onload=()=>{z(null,j),URL.revokeObjectURL(j.src),j.onload=null,requestAnimationFrame((()=>{j.src=pu}))},j.onerror=()=>z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new Blob([new Uint8Array(R)],{type:"image/png"});j.src=R.byteLength?URL.createObjectURL(B):pu})(x,((R,z)=>r(R,z,E,O))))}));return{cancel:()=>{p.cancel(),h()}}};var di,mu,jo,dl={exports:{}},Ul={exports:{}},gu={exports:{}},ad=(function(){if(jo)return dl.exports;jo=1;var l=(di||(di=1,Ul.exports=function(s,h){var p,_,x,E,O,R,z,j;for(_=s.length-(p=3&s.length),x=h,O=3432918353,R=461845907,j=0;j<_;)z=255&s.charCodeAt(j)|(255&s.charCodeAt(++j))<<8|(255&s.charCodeAt(++j))<<16|(255&s.charCodeAt(++j))<<24,++j,x=27492+(65535&(E=5*(65535&(x=(x^=z=(65535&(z=(z=(65535&z)*O+(((z>>>16)*O&65535)<<16)&4294967295)<<15|z>>>17))*R+(((z>>>16)*R&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(z=0,p){case 3:z^=(255&s.charCodeAt(j+2))<<16;case 2:z^=(255&s.charCodeAt(j+1))<<8;case 1:x^=z=(65535&(z=(z=(65535&(z^=255&s.charCodeAt(j)))*O+(((z>>>16)*O&65535)<<16)&4294967295)<<15|z>>>17))*R+(((z>>>16)*R&65535)<<16)&4294967295}return x^=s.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),Ul.exports),r=(mu||(mu=1,gu.exports=function(s,h){for(var p,_=s.length,x=h^_,E=0;_>=4;)p=1540483477*(65535&(p=255&s.charCodeAt(E)|(255&s.charCodeAt(++E))<<8|(255&s.charCodeAt(++E))<<16|(255&s.charCodeAt(++E))<<24))+((1540483477*(p>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),_-=4,++E;switch(_){case 3:x^=(255&s.charCodeAt(E+2))<<16;case 2:x^=(255&s.charCodeAt(E+1))<<8;case 1:x=1540483477*(65535&(x^=255&s.charCodeAt(E)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),gu.exports);return dl.exports=l,dl.exports.murmur3=l,dl.exports.murmur2=r,dl.exports})(),Vc=ya(ad);class Cl{constructor(r,...s){yt(this,s[0]||{}),this.type=r}}class Yo extends Cl{constructor(r,s={}){super("error",yt({error:r},s))}}function hh(l,r,s){s[l]&&s[l].indexOf(r)!==-1||(s[l]=s[l]||[],s[l].push(r))}function Ep(l,r,s){if(s&&s[l]){const h=s[l].indexOf(r);h!==-1&&s[l].splice(h,1)}}class yu{on(r,s){return this._listeners=this._listeners||{},hh(r,s,this._listeners),this}off(r,s){return Ep(r,s,this._listeners),Ep(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},hh(r,s,this._oneTimeListeners),this):new Promise((h=>{this.once(r,h)}))}fire(r,s){const h=typeof r=="string"?new Cl(r,s):r,p=h.type;if(this.listens(p)){h.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const O of _)O.call(this,h);const x=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const O of x)Ep(p,O,this._oneTimeListeners),O.call(this,h);const E=this._eventedParent;E&&(yt(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(h))}else h instanceof Yo&&console.error(h.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}class Ms{constructor(r){typeof r=="string"?this.name=r:(this.name=r.name,this.iconsetId=r.iconsetId)}static from(r){return new Ms(r)}static toString(r){return r.iconsetId?`${r.name}${r.iconsetId}`:r.name}static parse(r){const[s,h]=r.split("");return new Ms({name:s,iconsetId:h})}static isEqual(r,s){return r.name===s.name&&r.iconsetId===s.iconsetId}toString(){return Ms.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Km,dh={},Ap=(function(){if(Km)return dh;Km=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(_){return(_=Math.round(_))<0?0:_>255?255:_}function s(_){return r(_[_.length-1]==="%"?parseFloat(_)/100*255:parseInt(_))}function h(_){return(x=_[_.length-1]==="%"?parseFloat(_)/100:parseFloat(_))<0?0:x>1?1:x;var x}function p(_,x,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?_+(x-_)*E*6:2*E<1?x:3*E<2?_+(x-_)*(2/3-E)*6:_}try{dh.parseCSSColor=function(_){var x,E=_.replace(/ /g,"").toLowerCase();if(E in l)return l[E].slice();if(E[0]==="#")return E.length===4?(x=parseInt(E.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:E.length===7&&(x=parseInt(E.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var O=E.indexOf("("),R=E.indexOf(")");if(O!==-1&&R+1===E.length){var z=E.substr(0,O),j=E.substr(O+1,R-(O+1)).split(","),B=1;switch(z){case"rgba":if(j.length!==4)return null;B=h(j.pop());case"rgb":return j.length!==3?null:[s(j[0]),s(j[1]),s(j[2]),B];case"hsla":if(j.length!==4)return null;B=h(j.pop());case"hsl":if(j.length!==3)return null;var X=(parseFloat(j[0])%360+360)%360/360,Z=h(j[1]),ae=h(j[2]),se=ae<=.5?ae*(Z+1):ae+Z-ae*Z,pe=2*ae-se;return[r(255*p(pe,se,X+1/3)),r(255*p(pe,se,X)),r(255*p(pe,se,X-1/3)),B];default:return null}}return null}}catch{}return dh})();class pi{constructor(r,s,h,p=1){this.r=r,this.g=s,this.b=h,this.a=p}static parse(r){if(!r)return;if(r instanceof pi)return r;if(typeof r!="string")return;const s=Ap.parseCSSColor(r);return s?new pi(s[0]/255,s[1]/255,s[2]/255,s[3]):void 0}toString(){const[r,s,h,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*r)},${Math.round(255*s)},${Math.round(255*h)},${p})`}toNonPremultipliedRenderColor(r){const{r:s,g:h,b:p,a:_}=this;return new fh(r,s,h,p,_)}toPremultipliedRenderColor(r){const{r:s,g:h,b:p,a:_}=this;return new Jm(r,s*_,h*_,p*_,_)}clone(){return new pi(this.r,this.g,this.b,this.a)}}class od{constructor(r,s,h,p,_,x=!1){if(this.premultiplied=!1,this.premultiplied=x,r){const E=r.image.height,O=E*E;this.premultiplied?(s=_===0?0:s/_*(E-1),h=_===0?0:h/_*(E-1),p=_===0?0:p/_*(E-1)):(s*=E-1,h*=E-1,p*=E-1);const R=Math.floor(s),z=Math.floor(h),j=Math.floor(p),B=Math.ceil(s),X=Math.ceil(h),Z=Math.ceil(p),ae=s-R,se=h-z,pe=p-j,we=r.image.data,be=4*(R+z*O+j*E),Ee=4*(R+z*O+Z*E),Ge=4*(R+X*O+j*E),Ue=4*(R+X*O+Z*E),$e=4*(B+z*O+j*E),Je=4*(B+z*O+Z*E),it=4*(B+X*O+j*E),Mt=4*(B+X*O+Z*E);if(be<0||Mt>=we.length)throw new Error("out of range");this.r=Gn(Gn(Gn(we[be],we[Ee],pe),Gn(we[Ge],we[Ue],pe),se),Gn(Gn(we[$e],we[Je],pe),Gn(we[it],we[Mt],pe),se),ae)/255*(this.premultiplied?_:1),this.g=Gn(Gn(Gn(we[be+1],we[Ee+1],pe),Gn(we[Ge+1],we[Ue+1],pe),se),Gn(Gn(we[$e+1],we[Je+1],pe),Gn(we[it+1],we[Mt+1],pe),se),ae)/255*(this.premultiplied?_:1),this.b=Gn(Gn(Gn(we[be+2],we[Ee+2],pe),Gn(we[Ge+2],we[Ue+2],pe),se),Gn(Gn(we[$e+2],we[Je+2],pe),Gn(we[it+2],we[Mt+2],pe),se),ae)/255*(this.premultiplied?_:1),this.a=_}else this.r=s,this.g=h,this.b=p,this.a=_}toArray(){const{r,g:s,b:h,a:p}=this;return[255*r,255*s,255*h,p]}toHslaArray(){let{r,g:s,b:h,a:p}=this;if(this.premultiplied){if(p===0)return[0,0,0,0];r/=p,s/=p,h/=p}const _=Math.min(Math.max(r,0),1),x=Math.min(Math.max(s,0),1),E=Math.min(Math.max(h,0),1),O=Math.min(_,x,E),R=Math.max(_,x,E),z=(O+R)/2;if(O===R)return[0,0,100*z,p];const j=R-O,B=z>.5?j/(2-R-O):j/(R+O);let X=0;return R===_?X=(x-E)/j+(x<E?6:0):R===x?X=(E-_)/j+2:R===E&&(X=(_-x)/j+4),X*=60,[Math.min(Math.max(X,0),360),Math.min(Math.max(100*B,0),100),Math.min(Math.max(100*z,0),100),p]}toArray01(){const{r,g:s,b:h,a:p}=this;return[r,s,h,p]}toArray01Scaled(r){const{r:s,g:h,b:p}=this;return[s*r,h*r,p*r]}toArray01Linear(){const{r,g:s,b:h,a:p}=this;return[Math.pow(r,2.2),Math.pow(s,2.2),Math.pow(h,2.2),p]}}class fh extends od{constructor(r,s,h,p,_){super(r,s,h,p,_,!1)}}class Jm extends od{constructor(r,s,h,p,_){super(r,s,h,p,_,!0)}}function Gn(l,r,s){return l*(1-s)+r*s}function Qm(l,r,s){return l.map(((h,p)=>Gn(h,r[p],s)))}pi.black=new pi(0,0,0,1),pi.white=new pi(1,1,1,1),pi.transparent=new pi(0,0,0,0),pi.red=new pi(1,0,0,1),pi.blue=new pi(0,0,1,1);var sd=Object.freeze({__proto__:null,array:Qm,color:function(l,r,s){return new pi(Gn(l.r,r.r,s),Gn(l.g,r.g,s),Gn(l.b,r.b,s),Gn(l.a,r.a,s))},number:Gn});function _u(l,...r){for(const s of r)for(const h in s)l[h]=s[h];return l}class Gs extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class ld{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[h,p]of s)this.bindings[h]=p}concat(r){return new ld(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const ph={kind:"null"},Vn={kind:"number"},fi={kind:"string"},xr={kind:"boolean"},cs={kind:"color"},gc={kind:"object"},ge={kind:"value"},ie={kind:"collator"},_e={kind:"formatted"},Xe={kind:"resolvedImage"};function lt(l,r){return{kind:"array",itemType:l,N:r}}function fn(l){if(l.kind==="array"){const r=fn(l.itemType);return typeof l.N=="number"?`array<${r}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${r}>`}return l.kind}const Qn=[ph,Vn,fi,xr,cs,_e,gc,lt(ge),Xe];function fr(l,r){if(r.kind==="error")return null;if(l.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!fr(l.itemType,r.itemType))&&(typeof l.N!="number"||l.N===r.N))return null}else{if(l.kind===r.kind)return null;if(l.kind==="value"){for(const s of Qn)if(!fr(s,r))return null}}return`Expected ${fn(l)} but found ${fn(r)} instead.`}function Vr(l,r){return r.some((s=>s.kind===l.kind))}function Bi(l,r){return r.some((s=>s==="null"?l===null:s==="array"?Array.isArray(l):s==="object"?l&&!Array.isArray(l)&&typeof l=="object":s===typeof l))}function Zi(l,r){return l.kind==="array"&&r.kind==="array"?l.N===r.N&&Zi(l.itemType,r.itemType):l.kind===r.kind}class za{constructor(r,s,h){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Uc{constructor(r,s,h,p,_){this.text=r.normalize?r.normalize():r,this.image=s,this.scale=h,this.fontStack=p,this.textColor=_}}class Ko{constructor(r){this.sections=r}static fromString(r){return new Ko([new Uc(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((r=>r.text.length!==0||!!r.image&&r.image.hasPrimary()))}static factory(r){return r instanceof Ko?r:Ko.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map((r=>r.text)).join("")}serialize(){const r=["format"];for(const s of this.sections){if(s.image){const p=s.image.getPrimary().id.toString();r.push(["image",p]);continue}r.push(s.text);const h={};s.fontStack&&(h["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(h["font-scale"]=s.scale),s.textColor&&(h["text-color"]=["rgba"].concat(s.textColor.toNonPremultipliedRenderColor(null).toArray())),r.push(h)}return r}}class Ml{constructor(r,s={}){if(this.id=Ms.from(r),this.options=Object.assign({},s),s.transform){const{a:h,b:p,c:_,d:x,e:E,f:O}=s.transform;this.options.transform=new DOMMatrix([h,p,_,x,E,O])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:r,b:s,c:h,d:p,e:_,f:x}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:r,b:s,c:h,d:p,e:_,f:x}})}static parse(r){let s,h,p,_;try{({name:s,iconsetId:h,params:p,transform:_}=JSON.parse(r)||{})}catch{return null}if(!s)return null;const{a:x,b:E,c:O,d:R,e:z,f:j}=_||{};return new Ml({name:s,iconsetId:h},{params:p,transform:new DOMMatrix([x,E,O,R,z,j])})}scaleSelf(r,s){return this.options.transform.scaleSelf(r,s),this}}class wo{constructor(r,s,h,p,_=!1){this.primaryId=Ms.from(r),this.primaryOptions=s,h&&(this.secondaryId=Ms.from(h)),this.secondaryOptions=p,this.available=_}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Ml(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Ml(this.secondaryId,this.secondaryOptions):null}static from(r){return typeof r=="string"?wo.build({name:r}):r}static build(r,s,h,p){return!r||typeof r=="object"&&!("name"in r)?null:new wo(r,h,s,p)}}function $c(l,r,s,h){return typeof l=="number"&&l>=0&&l<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[l,r,s,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[l,r,s,h]:[l,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yr(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof pi||l instanceof za||l instanceof Ko||l instanceof wo)return!0;if(Array.isArray(l)){for(const r of l)if(!yr(r))return!1;return!0}if(typeof l=="object"){for(const r in l)if(!yr(l[r]))return!1;return!0}return!1}function Tn(l){if(l===null)return ph;if(typeof l=="string")return fi;if(typeof l=="boolean")return xr;if(typeof l=="number")return Vn;if(l instanceof pi)return cs;if(l instanceof za)return ie;if(l instanceof Ko)return _e;if(l instanceof wo)return Xe;if(Array.isArray(l)){const r=l.length;let s;for(const h of l){const p=Tn(h);if(s){if(s===p)continue;s=ge;break}s=p}return lt(s||ge,r)}return gc}function Ws(l){const r=typeof l;return l===null?"":r==="string"||r==="number"||r==="boolean"?String(l):l instanceof Ko||l instanceof wo||l instanceof pi?l.toString():JSON.stringify(l)}class er{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!yr(r[1]))return s.error("invalid value");const h=r[1];let p=Tn(h);const _=s.expectedType;return p.kind!=="array"||p.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(p=_),new er(p,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof pi?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof Ko?this.value.serialize():this.value}}class fa{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const $l={string:fi,number:Vn,boolean:xr,object:gc};class Wn{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let h,p=1;const _=r[0];if(_==="array"){let E,O;if(r.length>2){const R=r[1];if(typeof R!="string"||!(R in $l)||R==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);E=$l[R],p++}else E=ge;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);O=r[2],p++}h=lt(E,O)}else h=$l[_];const x=[];for(;p<r.length;p++){const E=s.parse(r[p],p,ge);if(!E)return null;x.push(E)}return new Wn(h,x)}evaluate(r){for(let s=0;s<this.args.length;s++){const h=this.args[s].evaluate(r);if(!fr(this.type,Tn(h)))return h;if(s===this.args.length-1)throw new fa(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${fn(Tn(h))} but was expected to be of type ${fn(this.type)}.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){const r=this.type,s=[r.kind];if(r.kind==="array"){const h=r.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){s.push(h.kind);const p=r.N;(typeof p=="number"||this.args.length>1)&&s.push(p)}}return s.concat(this.args.map((h=>h.serialize())))}}class Pl{constructor(r){this.type=_e,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const h=r[1];if(!Array.isArray(h)&&typeof h=="object")return s.error("First argument must be an image or text section.");const p=[];let _=!1;for(let x=1;x<=r.length-1;++x){const E=r[x];if(_&&typeof E=="object"&&!Array.isArray(E)){_=!1;let O=null;if(E["font-scale"]&&(O=s.parseObjectValue(E["font-scale"],x,"font-scale",Vn),!O))return null;let R=null;if(E["text-font"]&&(R=s.parseObjectValue(E["text-font"],x,"text-font",lt(fi)),!R))return null;let z=null;if(E["text-color"]&&(z=s.parseObjectValue(E["text-color"],x,"text-color",cs),!z))return null;const j=p[p.length-1];j.scale=O,j.font=R,j.textColor=z}else{const O=s.parse(r[x],x,ge);if(!O)return null;const R=O.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:O,scale:null,font:null,textColor:null})}}return new Pl(p)}evaluate(r){return new Ko(this.sections.map((s=>{const h=s.content.evaluate(r);return Zi(Tn(h),Xe)?new Uc("",h,null,null,null):new Uc(Ws(h),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null)})))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const s of this.sections){r.push(s.content.serialize());const h={};s.scale&&(h["font-scale"]=s.scale.serialize()),s.font&&(h["text-font"]=s.font.serialize()),s.textColor&&(h["text-color"]=s.textColor.serialize()),r.push(h)}return r}}class yc{constructor(r,s,h,p){this._imageWarnHistory={},this.type=Xe,this.namePrimary=r,this.nameSecondary=s,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(r,s){if(r.length<2)return s.error("Expected two or more arguments.");let h=1;const p=[];function _(){if(h<r.length){const E=s.parse(r[h],h++,fi);return E?(p.push({image:E,options:{}}),!0):(s.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function x(){if(h<r.length){const O=r[h];if((E=O)===null||typeof E!="object"||Array.isArray(E))return!0;const R=O.params,z=O.iconset,j=s.concat(h);if(!R&&!z)return h++,!0;if(R){if(typeof R!="object"||R.constructor!==Object)return j.error('Image options "params" should be an object'),!1;const B={},X=j.concat(void 0,"params");for(const Z in R){if(!Z)return X.error("Image parameter name should be non-empty"),!1;const ae=X.concat(void 0,Z).parse(R[Z],void 0,cs,void 0,{typeAnnotation:"coerce"});if(!ae)return!1;B[Z]=ae}p[p.length-1].options.params=B}if(z){if(typeof z!="object"||z.constructor!==Object)return j.error('Image options "iconset" should be an object'),!1;if(!z.id)return j.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=z}return h++,!0}var E;return!0}for(let E=0;E<2;E++)if(!_()||!x())return;return new yc(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(r,s){const h={};if(s){for(const p in s)if(s[p])try{h[p]=s[p].evaluate(r)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(r){const s={name:this.namePrimary.evaluate(r),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(r),iconsetId:this.iconsetIdSecondary}:void 0,p=wo.build(s,h,this.paramsPrimary?this.evaluateParams(r,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(r,this.paramsSecondary):void 0);if(p&&r.availableImages){const _=p.getPrimary().id;if(p.available=r.availableImages.some((x=>Ms.isEqual(x,_))),p.available){const x=p.getSecondary()?p.getSecondary().id:null;x&&(p.available=r.availableImages.some((E=>Ms.isEqual(E,x))))}}return p}eachChild(r){if(r(this.namePrimary),this.paramsPrimary)for(const s in this.paramsPrimary)this.paramsPrimary[s]&&r(this.paramsPrimary[s]);if(this.nameSecondary&&(r(this.nameSecondary),this.paramsSecondary))for(const s in this.paramsSecondary)this.paramsSecondary[s]&&r(this.paramsSecondary[s])}outputDefined(){return!1}serializeOptions(r,s){const h={};if(s&&(h.iconset={id:s}),r){h.params={};for(const p in r)r[p]&&(h.params[p]=r[p].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const r=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const s=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);s&&r.push(s)}if(this.nameSecondary&&(r.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const s=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);s&&r.push(s)}return r}}function ql(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const of={"to-boolean":xr,"to-color":cs,"to-number":Vn,"to-string":fi};class Ps{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const h=r[0],p=[];let _=ph;if(h==="to-array"){if(!Array.isArray(r[1]))return null;const x=r[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);_=lt(s.expectedType.itemType,x)}else{if(!(x>0&&yr(r[1][0])))return null;_=lt(Tn(r[1][0]),x)}for(let E=0;E<x;E++){const O=r[1][E];let R;if(ql(O)==="array")R=s.parse(O,void 0,_.itemType);else{const z=ql(O);if(z!==_.itemType.kind)return s.error(`Expected ${_.itemType.kind} but found ${z}.`);R=s.registry.literal.parse(["literal",O===void 0?null:O],s)}if(!R)return null;p.push(R)}}else{if((h==="to-boolean"||h==="to-string")&&r.length!==2)return s.error("Expected one argument.");_=of[h];for(let x=1;x<r.length;x++){const E=s.parse(r[x],x,ge);if(!E)return null;p.push(E)}}return new Ps(_,p)}evaluate(r){if(this.type.kind==="boolean")return!!this.args[0].evaluate(r);if(this.type.kind==="color"){let s,h;for(const p of this.args){if(s=p.evaluate(r),h=null,s instanceof pi)return s;if(typeof s=="string"){const _=r.parseColor(s);if(_)return _}else if(Array.isArray(s)&&(h=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:$c(s[0],s[1],s[2],s[3]),!h))return new pi(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new fa(h||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const h of this.args){if(s=h.evaluate(r),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new fa(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Ko.fromString(Ws(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?wo.build(Ws(this.args[0].evaluate(r))):this.type.kind==="array"?this.args.map((s=>s.evaluate(r))):Ws(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new Pl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new yc(this.args[0]).serialize();const r=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild((s=>{r.push(s.serialize())})),r}}const Jo=["Unknown","Point","LineString","Polygon"];class mh{constructor(r,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Jo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:h,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*s-r[0])+this.featureDistanceData.bearing[1]*(p*s-r[1])}return 0}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=pi.parse(r)),s}getConfig(r){return this.options?this.options.get(r):null}}class no{constructor(r,s,h,p,_){this.name=r,this.type=s,this._evaluate=h,this.args=p,this._overloadIndex=_}evaluate(r){if(!this._evaluate){const s=no.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((r=>r.serialize())))}static parse(r,s){const h=r[0],p=no.definitions[h];if(!p)return s.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,E=[];let O=null,R=-1;for(const[z,j]of x){if(Array.isArray(z)&&z.length!==r.length-1)continue;E.push(z),R++,O=new Dp(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const B=[];let X=!1;for(let Z=1;Z<r.length;Z++){const ae=r[Z],se=Array.isArray(z)?z[Z-1]:z.type,pe=O.parse(ae,1+B.length,se);if(!pe){X=!0;break}B.push(pe)}if(!X)if(Array.isArray(z)&&z.length!==B.length)O.error(`Expected ${z.length} arguments, but found ${B.length} instead.`);else{for(let Z=0;Z<B.length;Z++){const ae=Array.isArray(z)?z[Z]:z.type,se=B[Z];O.concat(Z+1).checkSubtype(ae,se.type)}if(O.errors.length===0)return new no(h,_,j,B,R)}}if(E.length===1)s.errors.push(...O.errors);else{const z=(E.length?E:x.map((([B])=>B))).map(Cy).join(" | "),j=[];for(let B=1;B<r.length;B++){const X=s.parse(r[B],1+j.length);if(!X)return null;j.push(fn(X.type))}s.error(`Expected arguments of type ${z}, but found (${j.join(", ")}) instead.`)}return null}static register(r,s){no.definitions=s;for(const h in s)r[h]=no}}function Cy(l){return Array.isArray(l)?`(${l.map(fn).join(", ")})`:`(${fn(l.type)}...)`}class qc{constructor(r,s,h){this.type=ie,this.locale=h,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const h=r[1];if(typeof h!="object"||Array.isArray(h))return s.error("Collator options argument must be an object.");const p=h["case-sensitive"]===void 0?s.parse(!1,1,xr):s.parseObjectValue(h["case-sensitive"],1,"case-sensitive",xr);if(!p)return null;const _=h["diacritic-sensitive"]===void 0?s.parse(!1,1,xr):s.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",xr);if(!_)return null;let x=null;return h.locale&&(x=s.parseObjectValue(h.locale,1,"locale",fi),!x)?null:new qc(p,_,x)}evaluate(r){return new za(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}function ys(l,r,s=0,h=l.length-1,p=U0){for(;h>s;){if(h-s>600){const O=h-s+1,R=r-s+1,z=Math.log(O),j=.5*Math.exp(2*z/3),B=.5*Math.sqrt(z*j*(O-j)/O)*(R-O/2<0?-1:1);ys(l,r,Math.max(s,Math.floor(r-R*j/O+B)),Math.min(h,Math.floor(r+(O-R)*j/O+B)),p)}const _=l[r];let x=s,E=h;for(Cp(l,s,r),p(l[h],_)>0&&Cp(l,s,h);x<E;){for(Cp(l,x,E),x++,E--;p(l[x],_)<0;)x++;for(;p(l[E],_)>0;)E--}p(l[s],_)===0?Cp(l,s,E):(E++,Cp(l,E,h)),E<=r&&(s=E+1),r<=E&&(h=E-1)}}function Cp(l,r,s){const h=l[r];l[r]=l[s],l[s]=h}function U0(l,r){return l<r?-1:l>r?1:0}function Ol(l){let r=0;for(let s,h,p=0,_=l.length,x=_-1;p<_;x=p++)s=l[p],h=l[x],r+=(h.x-s.x)*(s.y+h.y);return r}function Hl(l,r){l[0]=Math.min(l[0],r[0]),l[1]=Math.min(l[1],r[1]),l[2]=Math.max(l[2],r[0]),l[3]=Math.max(l[3],r[1])}function cd(l,r){return!(l[0]<=r[0]||l[2]>=r[2]||l[1]<=r[1]||l[3]>=r[3])}function gh(l,r,s){const h=l[0]-r[0],p=l[1]-r[1],_=l[0]-s[0],x=l[1]-s[1];return h*x-_*p==0&&h*_<=0&&p*x<=0}function ud(l,r,s=!1){let h=!1;for(let E=0,O=r.length;E<O;E++){const R=r[E];for(let z=0,j=R.length,B=j-1;z<j;B=z++){const X=R[B],Z=R[z];if(gh(l,X,Z))return s;(_=X)[1]>(p=l)[1]!=(x=Z)[1]>p[1]&&p[0]<(x[0]-_[0])*(p[1]-_[1])/(x[1]-_[1])+_[0]&&(h=!h)}}var p,_,x;return h}function My(l,r,s,h){const p=h[0]-s[0],_=h[1]-s[1],x=(l[0]-s[0])*_-p*(l[1]-s[1]),E=(r[0]-s[0])*_-p*(r[1]-s[1]);return x>0&&E<0||x<0&&E>0}function sf(l,r,s,h){return(p=[h[0]-s[0],h[1]-s[1]])[0]*(_=[r[0]-l[0],r[1]-l[1]])[1]-p[1]*_[0]!=0&&!(!My(l,r,s,h)||!My(s,h,l,r));var p,_}function Py(l){const r=new kt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=new kt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of l[0])r.x>h.x&&(r.x=h.x),r.y>h.y&&(r.y=h.y),s.x<h.x&&(s.x=h.x),s.y<h.y&&(s.y=h.y);return{min:r,max:s}}const Rl=8192;function Oy(l,r){const s=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(s*p*Rl),Math.round(h*p*Rl)]}function lf(l,r){for(let s=0;s<r.length;s++)if(ud(l,r[s]))return!0;return!1}function Ry(l,r,s){for(const h of s)for(let p=0,_=h.length,x=_-1;p<_;x=p++)if(sf(l,r,h[x],h[p]))return!0;return!1}function Iy(l,r){for(let s=0;s<l.length;++s)if(!ud(l[s],r))return!1;for(let s=0;s<l.length-1;++s)if(Ry(l[s],l[s+1],r))return!1;return!0}function yh(l,r){for(let s=0;s<r.length;s++)if(Iy(l,r[s]))return!0;return!1}function _h(l,r,s){const h=[];for(let p=0;p<l.length;p++){const _=[];for(let x=0;x<l[p].length;x++){const E=Oy(l[p][x],s);Hl(r,E),_.push(E)}h.push(_)}return h}function Hc(l,r,s){const h=[];for(let p=0;p<l.length;p++){const _=_h(l[p],r,s);h.push(_)}return h}function Dy(l,r,s,h){if(l[0]<s[0]||l[0]>s[2]){const p=.5*h;let _=l[0]-s[0]>p?-h:s[0]-l[0]>p?h:0;_===0&&(_=l[0]-s[2]>p?-h:s[2]-l[0]>p?h:0),l[0]+=_}Hl(r,l)}function vh(l,r,s,h){const p=Math.pow(2,h.z)*Rl,_=[h.x*Rl,h.y*Rl],x=[];if(!l)return x;for(const E of l)for(const O of E){const R=[O.x+_[0],O.y+_[1]];Dy(R,r,s,p),x.push(R)}return x}function Mp(l,r,s,h){const p=Math.pow(2,h.z)*Rl,_=[h.x*Rl,h.y*Rl],x=[];if(!l)return x;for(const O of l){const R=[];for(const z of O){const j=[z.x+_[0],z.y+_[1]];Hl(r,j),R.push(j)}x.push(R)}if(r[2]-r[0]<=p/2){(E=r)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const O of x)for(const R of O)Dy(R,r,s,p)}var E;return x}class vu{constructor(r,s){this.type=xr,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(yr(r[1])){const h=r[1];if(h.type==="FeatureCollection")for(let p=0;p<h.features.length;++p){const _=h.features[p].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new vu(h,h.features[p].geometry)}else if(h.type==="Feature"){const p=h.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new vu(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new vu(h,h)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(s,h){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const E=_h(h.coordinates,_,x),O=vh(s.geometry(),p,_,x);if(!cd(p,_))return!1;for(const R of O)if(!ud(R,E))return!1}if(h.type==="MultiPolygon"){const E=Hc(h.coordinates,_,x),O=vh(s.geometry(),p,_,x);if(!cd(p,_))return!1;for(const R of O)if(!lf(R,E))return!1}return!0})(r,this.geometries);if(r.geometryType()==="LineString")return(function(s,h){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const E=_h(h.coordinates,_,x),O=Mp(s.geometry(),p,_,x);if(!cd(p,_))return!1;for(const R of O)if(!Iy(R,E))return!1}if(h.type==="MultiPolygon"){const E=Hc(h.coordinates,_,x),O=Mp(s.geometry(),p,_,x);if(!cd(p,_))return!1;for(const R of O)if(!yh(R,E))return!1}return!0})(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const cf={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Gl=1/298.257223563,ky=Gl*(2-Gl),uf=Math.PI/180;class hd{static fromTile(r,s,h){const p=Math.PI*(1-2*(r+.5)/Math.pow(2,s)),_=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/uf;return new hd(_,h)}static get units(){return cf}constructor(r,s){if(r===void 0)throw new Error("No latitude given.");if(s&&!cf[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(cf).join(", ")}`);const h=6378.137*uf*(s?cf[s]:1),p=Math.cos(r*uf),_=1/(1-ky*(1-p*p)),x=Math.sqrt(_);this.kx=h*x*p,this.ky=h*x*_*(1-ky)}distance(r,s){const h=ho(r[0]-s[0])*this.kx,p=(r[1]-s[1])*this.ky;return Math.sqrt(h*h+p*p)}bearing(r,s){const h=ho(s[0]-r[0])*this.kx;return Math.atan2(h,(s[1]-r[1])*this.ky)/uf}destination(r,s,h){const p=h*uf;return this.offset(r,Math.sin(p)*s,Math.cos(p)*s)}offset(r,s,h){return[r[0]+s/this.kx,r[1]+h/this.ky]}lineDistance(r){let s=0;for(let h=0;h<r.length-1;h++)s+=this.distance(r[h],r[h+1]);return s}area(r){let s=0;for(let h=0;h<r.length;h++){const p=r[h];for(let _=0,x=p.length,E=x-1;_<x;E=_++)s+=ho(p[_][0]-p[E][0])*(p[_][1]+p[E][1])*(h?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(r,s){let h=0;if(s<=0)return r[0];for(let p=0;p<r.length-1;p++){const _=r[p],x=r[p+1],E=this.distance(_,x);if(h+=E,h>s)return hf(_,x,(s-(h-E))/E)}return r[r.length-1]}pointToSegmentDistance(r,s,h){let[p,_]=s,x=ho(h[0]-p)*this.kx,E=(h[1]-_)*this.ky;if(x!==0||E!==0){const O=(ho(r[0]-p)*this.kx*x+(r[1]-_)*this.ky*E)/(x*x+E*E);O>1?(p=h[0],_=h[1]):O>0&&(p+=x/this.kx*O,_+=E/this.ky*O)}return x=ho(r[0]-p)*this.kx,E=(r[1]-_)*this.ky,Math.sqrt(x*x+E*E)}pointOnLine(r,s){let h=1/0,p=r[0][0],_=r[0][1],x=0,E=0;for(let O=0;O<r.length-1;O++){let R=r[O][0],z=r[O][1],j=ho(r[O+1][0]-R)*this.kx,B=(r[O+1][1]-z)*this.ky,X=0;j===0&&B===0||(X=(ho(s[0]-R)*this.kx*j+(s[1]-z)*this.ky*B)/(j*j+B*B),X>1?(R=r[O+1][0],z=r[O+1][1]):X>0&&(R+=j/this.kx*X,z+=B/this.ky*X)),j=ho(s[0]-R)*this.kx,B=(s[1]-z)*this.ky;const Z=j*j+B*B;Z<h&&(h=Z,p=R,_=z,x=O,E=X)}return{point:[p,_],index:x,t:Math.max(0,Math.min(1,E))}}lineSlice(r,s,h){let p=this.pointOnLine(h,r),_=this.pointOnLine(h,s);if(p.index>_.index||p.index===_.index&&p.t>_.t){const R=p;p=_,_=R}const x=[p.point],E=p.index+1,O=_.index;!eg(h[E],x[0])&&E<=O&&x.push(h[E]);for(let R=E+1;R<=O;R++)x.push(h[R]);return eg(h[O],_.point)||x.push(_.point),x}lineSliceAlong(r,s,h){let p=0;const _=[];for(let x=0;x<h.length-1;x++){const E=h[x],O=h[x+1],R=this.distance(E,O);if(p+=R,p>r&&_.length===0&&_.push(hf(E,O,(r-(p-R))/R)),p>=s)return _.push(hf(E,O,(s-(p-R))/R)),_;p>r&&_.push(O)}return _}bufferPoint(r,s){const h=s/this.ky,p=s/this.kx;return[r[0]-p,r[1]-h,r[0]+p,r[1]+h]}bufferBBox(r,s){const h=s/this.ky,p=s/this.kx;return[r[0]-p,r[1]-h,r[2]+p,r[3]+h]}insideBBox(r,s){return ho(r[0]-s[0])>=0&&ho(r[0]-s[2])<=0&&r[1]>=s[1]&&r[1]<=s[3]}}function eg(l,r){return l[0]===r[0]&&l[1]===r[1]}function hf(l,r,s){const h=ho(r[0]-l[0]);return[l[0]+h*s,l[1]+(r[1]-l[1])*s]}function ho(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class Pp{constructor(r=[],s=((h,p)=>h<p?-1:h>p?1:0)){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:h}=this,p=s[r];for(;r>0;){const _=r-1>>1,x=s[_];if(h(p,x)>=0)break;s[r]=x,r=_}s[r]=p}_down(r){const{data:s,compare:h}=this,p=this.length>>1,_=s[r];for(;r<p;){let x=1+(r<<1);const E=x+1;if(E<this.length&&h(s[E],s[x])<0&&(x=E),h(s[x],_)>=0)break;s[r]=s[x],r=x}s[r]=_}}var nn=8192;function fl(l,r){return r.dist-l.dist}const xu=100,df=50;function xh(l){const r=[1/0,1/0,-1/0,-1/0];if(r.length!==l.length)return!1;for(let s=0;s<r.length;s++)if(r[s]!==l[s])return!1;return!0}function Gc(l){return l[1]-l[0]+1}function pl(l,r){const s=l[1]>=l[0]&&l[1]<r;return s||console.warn("Distance Expression: Index is out of range"),s}function bu(l,r){if(l[0]>l[1])return[null,null];const s=Gc(l);if(r){if(s===2)return[l,null];const h=Math.floor(s/2);return[[l[0],l[0]+h],[l[0]+h,l[1]]]}{if(s===1)return[l,null];const h=Math.floor(s/2)-1;return[[l[0],l[0]+h],[l[0]+h+1,l[1]]]}}function wu(l,r){const s=[1/0,1/0,-1/0,-1/0];if(!pl(r,l.length))return s;for(let h=r[0];h<=r[1];++h)Hl(s,l[h]);return s}function bh(l){const r=[1/0,1/0,-1/0,-1/0];for(let s=0;s<l.length;++s)for(let h=0;h<l[s].length;++h)Hl(r,l[s][h]);return r}function Os(l,r,s){if(xh(l)||xh(r))return NaN;let h=0,p=0;return l[2]<r[0]&&(h=r[0]-l[2]),l[0]>r[2]&&(h=l[0]-r[2]),l[1]>r[3]&&(p=l[1]-r[3]),l[3]<r[1]&&(p=r[1]-l[3]),s.distance([0,0],[h,p])}function Wr(l){return 360*l-180}function Il(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Op(l,r){const s=Math.pow(2,r.z),h=(l.y/nn+r.y)/s;return[Wr((l.x/nn+r.x)/s),Il(h)]}function Su(l,r){const s=[];for(let h=0;h<l.length;++h)s.push(Op(l[h],r));return s}function tg(l,r,s){const h=s.pointOnLine(r,l).point;return s.distance(l,h)}function Rp(l,r,s,h,p){const _=s.slice(h[0],h[1]+1);let x=1/0;for(let E=r[0];E<=r[1];++E)if((x=Math.min(x,tg(l[E],_,p)))===0)return 0;return x}function Ii(l,r,s,h,p){const _=Math.min(p.pointToSegmentDistance(l,s,h),p.pointToSegmentDistance(r,s,h)),x=Math.min(p.pointToSegmentDistance(s,l,r),p.pointToSegmentDistance(h,l,r));return Math.min(_,x)}function Ly(l,r,s,h,p){if(!pl(r,l.length)||!pl(h,s.length))return NaN;let _=1/0;for(let x=r[0];x<r[1];++x)for(let E=h[0];E<h[1];++E){if(sf(l[x],l[x+1],s[E],s[E+1]))return 0;_=Math.min(_,Ii(l[x],l[x+1],s[E],s[E+1],p))}return _}function Ny(l,r,s,h,p){if(!pl(r,l.length)||!pl(h,s.length))return NaN;let _=1/0;for(let x=r[0];x<=r[1];++x)for(let E=h[0];E<=h[1];++E)if((_=Math.min(_,p.distance(l[x],s[E])))===0)return _;return _}function ff(l,r,s){if(ud(l,r,!0))return 0;let h=1/0;for(const p of r){const _=p.length;if(_<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[_-1]&&(h=Math.min(h,s.pointToSegmentDistance(l,p[_-1],p[0])))===0||(h=Math.min(h,tg(l,p,s)))===0)return h}return h}function pf(l,r,s,h){if(!pl(r,l.length))return NaN;for(let _=r[0];_<=r[1];++_)if(ud(l[_],s,!0))return 0;let p=1/0;for(let _=r[0];_<r[1];++_)for(const x of s)for(let E=0,O=x.length,R=O-1;E<O;R=E++){if(sf(l[_],l[_+1],x[R],x[E]))return 0;p=Math.min(p,Ii(l[_],l[_+1],x[R],x[E],h))}return p}function Ip(l,r){for(const s of l)for(let h=0;h<=s.length-1;++h)if(ud(s[h],r,!0))return!0;return!1}function ng(l,r,s,h=1/0){const p=bh(l),_=bh(r);if(h!==1/0&&Os(p,_,s)>=h)return h;if(cd(p,_)){if(Ip(l,r))return 0}else if(Ip(r,l))return 0;let x=h;for(const E of l)for(let O=0,R=E.length,z=R-1;O<R;z=O++)for(const j of r)for(let B=0,X=j.length,Z=X-1;B<X;Z=B++){if(sf(E[z],E[O],j[Z],j[B]))return 0;x=Math.min(x,Ii(E[z],E[O],j[Z],j[B],s))}return x}function Xs(l,r,s,h,p,_,x){if(_===null||x===null)return;const E=Os(wu(h,_),wu(p,x),s);E<r&&l.push({dist:E,range1:_,range2:x})}function Wl(l,r,s,h,p=1/0){let _=Math.min(h.distance(l[0],s[0][0]),p);if(_===0)return _;const x=new Pp([{dist:0,range1:[0,l.length-1],range2:[0,0]}],fl),E=r?df:xu,O=bh(s);for(;x.length;){const R=x.pop();if(R.dist>=_)continue;const z=R.range1;if(Gc(z)<=E){if(!pl(z,l.length))return NaN;if(r){const j=pf(l,z,s,h);if((_=Math.min(_,j))===0)return _}else for(let j=z[0];j<=z[1];++j){const B=ff(l[j],s,h);if((_=Math.min(_,B))===0)return _}}else{const j=bu(z,r);if(j[0]!==null){const B=Os(wu(l,j[0]),O,h);B<_&&x.push({dist:B,range1:j[0],range2:[0,0]})}if(j[1]!==null){const B=Os(wu(l,j[1]),O,h);B<_&&x.push({dist:B,range1:j[1],range2:[0,0]})}}}return _}function wh(l,r,s,h,p,_=1/0){let x=Math.min(_,p.distance(l[0],s[0]));if(x===0)return x;const E=new Pp([{dist:0,range1:[0,l.length-1],range2:[0,s.length-1]}],fl),O=r?df:xu,R=h?df:xu;for(;E.length;){const z=E.pop();if(z.dist>=x)continue;const j=z.range1,B=z.range2;if(Gc(j)<=O&&Gc(B)<=R){if(!pl(j,l.length)||!pl(B,s.length))return NaN;if(r&&h?x=Math.min(x,Ly(l,j,s,B,p)):r||h?r&&!h?x=Math.min(x,Rp(s,B,l,j,p)):!r&&h&&(x=Math.min(x,Rp(l,j,s,B,p))):x=Math.min(x,Ny(l,j,s,B,p)),x===0)return x}else{const X=bu(j,r),Z=bu(B,h);Xs(E,x,p,l,s,X[0],Z[0]),Xs(E,x,p,l,s,X[0],Z[1]),Xs(E,x,p,l,s,X[1],Z[0]),Xs(E,x,p,l,s,X[1],Z[1])}}return x}function _c(l,r,s,h,p=1/0){let _=p;const x=wu(l,[0,l.length-1]);for(const E of s)if(!(_!==1/0&&Os(x,wu(E,[0,E.length-1]),h)>=_)&&(_=Math.min(_,wh(l,r,E,!0,h,_)),_===0))return _;return _}function Xl(l,r,s,h,p=1/0){let _=p;const x=wu(l,[0,l.length-1]);for(const E of s){if(_!==1/0&&Os(x,bh(E),h)>=_)continue;const O=Wl(l,r,E,h,_);if(isNaN(O))return O;if((_=Math.min(_,O))===0)return _}return _}function Tu(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class Sh{constructor(r,s){this.type=Vn,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${r.length-1} instead.`);if(yr(r[1])){const h=r[1];if(h.type==="FeatureCollection"){for(let p=0;p<h.features.length;++p)if(Tu(h.features[p].geometry.type))return new Sh(h,h.features[p].geometry)}else if(h.type==="Feature"){if(Tu(h.geometry.type))return new Sh(h,h.geometry)}else if(Tu(h.type))return new Sh(h,h)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(r){const s=r.geometry(),h=r.canonicalID();if(s!=null&&h!=null){if(r.geometryType()==="Point")return(function(p,_,x){const E=[];for(const R of p)for(const z of R)E.push(Op(z,_));const O=new hd(E[0][1],"meters");return x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString"?wh(E,!1,x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",O):x.type==="MultiLineString"?_c(E,!1,x.coordinates,O):x.type==="Polygon"||x.type==="MultiPolygon"?Xl(E,!1,x.type==="Polygon"?[x.coordinates]:x.coordinates,O):null})(s,h,this.geometries);if(r.geometryType()==="LineString")return(function(p,_,x){const E=[];for(const R of p){const z=[];for(const j of R)z.push(Op(j,_));E.push(z)}const O=new hd(E[0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return _c(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",E,O);if(x.type==="MultiLineString"){let R=1/0;for(let z=0;z<x.coordinates.length;z++){const j=_c(x.coordinates[z],!0,E,O,R);if(isNaN(j))return j;if((R=Math.min(R,j))===0)return R}return R}if(x.type==="Polygon"||x.type==="MultiPolygon"){let R=1/0;for(let z=0;z<E.length;z++){const j=Xl(E[z],!0,x.type==="Polygon"?[x.coordinates]:x.coordinates,O,R);if(isNaN(j))return j;if((R=Math.min(R,j))===0)return R}return R}return null})(s,h,this.geometries);if(r.geometryType()==="Polygon")return(function(p,_,x){const E=[];for(const R of(function(z,j){const B=z.length;if(B<=1)return[z];const X=[];let Z,ae;for(let se=0;se<B;se++){const pe=Ol(z[se]);pe!==0&&(z[se].area=Math.abs(pe),ae===void 0&&(ae=pe<0),ae===pe<0?(Z&&X.push(Z),Z=[z[se]]):Z.push(z[se]))}return Z&&X.push(Z),X})(p)){const z=[];for(let j=0;j<R.length;++j)z.push(Su(R[j],_));E.push(z)}const O=new hd(E[0][0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return Xl(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",E,O);if(x.type==="MultiLineString"){let R=1/0;for(let z=0;z<x.coordinates.length;z++){const j=Xl(x.coordinates[z],!0,E,O,R);if(isNaN(j))return j;if((R=Math.min(R,j))===0)return R}return R}return x.type==="Polygon"||x.type==="MultiPolygon"?(function(R,z,j){let B=1/0;for(const X of R)for(const Z of z){const ae=ng(X,Z,j,B);if(isNaN(ae))return ae;if((B=Math.min(B,ae))===0)return B}return B})(x.type==="Polygon"?[x.coordinates]:x.coordinates,E,O):null})(s,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Th(l){if(l instanceof no&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof vu||l instanceof Sh)return!1;if(l instanceof Eh)return l.featureConstant;let r=!0;return l.eachChild((s=>{r&&!Th(s)&&(r=!1)})),r}function mf(l){if(l instanceof no&&l.name==="feature-state")return!1;let r=!0;return l.eachChild((s=>{r&&!mf(s)&&(r=!1)})),r}function us(l){if(l instanceof Eh)return new Set([l.key]);let r=new Set;return l.eachChild((s=>{r=new Set([...r,...us(s)])})),r}function ja(l,r){if(l instanceof no&&r.indexOf(l.name)>=0)return!1;let s=!0;return l.eachChild((h=>{s&&!ja(h,r)&&(s=!1)})),s}function pa(l,r,s){return[l,r,s].filter(Boolean).join("")}function Eu(l,r){switch(l){case"string":return Ws(r);case"number":return+r;case"boolean":return!!r;case"color":return pi.parse(r);case"formatted":return Ko.fromString(Ws(r));case"resolvedImage":return wo.build(Ws(r))}return r}function vc(l,r,s,h){return h!==void 0&&(l=h*Math.round(l/h)),r!==void 0&&l<r&&(l=r),s!==void 0&&l>s&&(l=s),l}class Eh{constructor(r,s,h,p=!1){this.type=r,this.key=s,this.scope=h,this.featureConstant=p}static parse(r,s){let h=s.expectedType;if(h==null&&(h=ge),r.length<2||r.length>3)return s.error("Invalid number of arguments for 'config' expression.");const p=s.parse(r[1],1);if(!(p instanceof er))return s.error("Key name of 'config' expression must be a string literal.");let _,x=!0;const E=Ws(p.value);if(r.length>=3){const O=s.parse(r[2],2);if(!(O instanceof er))return s.error("Scope of 'config' expression must be a string literal.");_=Ws(O.value)}if(s.options){const O=pa(E,_,s._scope),R=s.options.get(O);R&&(x=Th(R.value||R.default))}return new Eh(h,E,_,x)}evaluate(r){const s=pa(this.key,this.scope,r.scope),h=r.getConfig(s);if(!h)return null;const{type:p,value:_,values:x,minValue:E,maxValue:O,stepValue:R}=h,z=h.default.evaluate(r);let j=z;if(_){const B=r.scope;r.scope=(B||"").split("").slice(1).join(""),j=_.evaluate(r),r.scope=B}return p&&(j=Eu(p,j)),j===void 0||E===void 0&&O===void 0&&R===void 0||(typeof j=="number"?j=vc(j,E,O,R):Array.isArray(j)&&(j=j.map((B=>typeof B=="number"?vc(B,E,O,R):B)))),_!==void 0&&j!==void 0&&x&&!x.includes(j)&&(j=z,p&&(j=Eu(p,j))),(p&&p!==this.type||j!==void 0&&!Zi(Tn(j),this.type))&&(j=Eu(this.type.kind,j)),j}eachChild(){}outputDefined(){return!1}serialize(){const r=["config",this.key];return this.scope&&r.concat(this.scope),r}}class Wc{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const h=r[1];return s.scope.has(h)?new Wc(h,s.scope.get(h)):s.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Dp{constructor(r,s=[],h,p=new ld,_=[],x,E){this.registry=r,this.path=s,this.key=s.map((O=>typeof O=="string"?`['${O}']`:`[${O}]`)).join(""),this.scope=p,this.errors=_,this.expectedType=h,this._scope=x,this.options=E}parse(r,s,h,p,_={}){return s||h?this.concat(s,null,h,p)._parse(r,_):this._parse(r,_)}parseObjectValue(r,s,h,p,_,x={}){return this.concat(s,h,p,_)._parse(r,x)}_parse(r,s){function h(p,_,x){return x==="assert"?new Wn(_,[p]):x==="coerce"?new Ps(_,[p]):p}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof r[0]=="string"?this.registry[r[0]]:void 0;if(p){let _=p.parse(r,this);if(!_)return null;if(this.expectedType){const x=this.expectedType,E=_.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||E.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(x,E))return null}else _=h(_,x,s.typeAnnotation||"coerce");else _=h(_,x,s.typeAnnotation||"assert")}if(!(_ instanceof er)&&_.type.kind!=="resolvedImage"&&rg(_)){const x=new mh(this._scope,this.options);try{_=new er(_.type,_.evaluate(x))}catch(E){return this.error(E.message),null}}return _}return Ps.parse(["to-array",r],this)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,h,p){let _=typeof r=="number"?this.path.concat(r):this.path;_=typeof s=="string"?_.concat(s):_;const x=p?this.scope.concat(p):this.scope;return new Dp(this.registry,_,h||null,x,this.errors,this._scope,this.options)}error(r,...s){const h=`${this.key}${s.map((p=>`[${p}]`)).join("")}`;this.errors.push(new Gs(h,r))}checkSubtype(r,s){const h=fr(r,s);return h&&this.error(h),h}}function rg(l){if(l instanceof Wc)return rg(l.boundExpression);if(l instanceof no&&l.name==="error"||l instanceof qc||l instanceof vu||l instanceof Sh||l instanceof Eh)return!1;const r=l instanceof Ps||l instanceof Wn;let s=!0;return l.eachChild((h=>{s=r?s&&rg(h):s&&h instanceof er})),!!s&&Th(l)&&ja(l,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Ah(l,r){const s=l.length-1;let h,p,_=0,x=s,E=0;for(;_<=x;)if(E=Math.floor((_+x)/2),h=l[E],p=l[E+1],h<=r){if(E===s||r<p)return E;_=E+1}else{if(!(h>r))throw new fa("Input is not a number.");x=E-1}return 0}class Au{constructor(r,s,h){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[p,_]of h)this.labels.push(p),this.outputs.push(_)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const h=s.parse(r[1],1,Vn);if(!h)return null;const p=[];let _=null;s.expectedType&&s.expectedType.kind!=="value"&&(_=s.expectedType);for(let x=1;x<r.length;x+=2){const E=x===1?-1/0:r[x],O=r[x+1],R=x,z=x+1;if(typeof E!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(p.length&&p[p.length-1][0]>=E)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const j=s.parse(O,z,_);if(!j)return null;_=_||j.type,p.push([E,j])}return new Au(_,h,p)}evaluate(r){const s=this.labels,h=this.outputs;if(s.length===1)return h[0].evaluate(r);const p=this.input.evaluate(r);if(p<=s[0])return h[0].evaluate(r);const _=s.length;return p>=s[_-1]?h[_-1].evaluate(r):h[Ah(s,p)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}serialize(){const r=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r}}const zy=.95047,gf=1.08883,ig=4/29,Zl=6/29,Xc=3*Zl*Zl,Zc=Zl*Zl*Zl,Cu=Math.PI/180,ag=180/Math.PI;function kp(l){return l>Zc?Math.pow(l,1/3):l/Xc+ig}function dd(l){return l>Zl?l*l*l:Xc*(l-ig)}function yf(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Yc(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function hs(l){const r=Yc(l.r),s=Yc(l.g),h=Yc(l.b),p=kp((.4124564*r+.3575761*s+.1804375*h)/zy),_=kp((.2126729*r+.7151522*s+.072175*h)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-kp((.0193339*r+.119192*s+.9503041*h)/gf)),alpha:l.a}}function Kc(l){let r=(l.l+16)/116,s=isNaN(l.a)?r:r+l.a/500,h=isNaN(l.b)?r:r-l.b/200;return r=1*dd(r),s=zy*dd(s),h=gf*dd(h),new pi(yf(3.2404542*s-1.5371385*r-.4985314*h),yf(-.969266*s+1.8760108*r+.041556*h),yf(.0556434*s-.2040259*r+1.0572252*h),l.alpha)}function jy(l,r,s){const h=r-l;return l+s*(h>180||h<-180?h-360*Math.round(h/360):h)}const _f={forward:hs,reverse:Kc,interpolate:function(l,r,s){return{l:Gn(l.l,r.l,s),a:Gn(l.a,r.a,s),b:Gn(l.b,r.b,s),alpha:Gn(l.alpha,r.alpha,s)}}},Lp={forward:function(l){const{l:r,a:s,b:h}=hs(l),p=Math.atan2(h,s)*ag;return{h:p<0?p+360:p,c:Math.sqrt(s*s+h*h),l:r,alpha:l.a}},reverse:function(l){const r=l.h*Cu,s=l.c;return Kc({l:l.l,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:l.alpha})},interpolate:function(l,r,s){return{h:jy(l.h,r.h,s),c:Gn(l.c,r.c,s),l:Gn(l.l,r.l,s),alpha:Gn(l.alpha,r.alpha,s)}}};var og=Object.freeze({__proto__:null,hcl:Lp,lab:_f});class sa{constructor(r,s,h,p,_){this.type=r,this.operator=s,this.interpolation=h,this.input=p,this.labels=[],this.outputs=[];for(const[x,E]of _)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(r,s,h,p){let _=0;if(r.name==="exponential")_=Np(s,r.base,h,p);else if(r.name==="linear")_=Np(s,1,h,p);else if(r.name==="cubic-bezier"){const x=r.controlPoints;_=new dr(x[0],x[1],x[2],x[3]).solve(Np(s,1,h,p))}return _}static parse(r,s){let[h,p,_,...x]=r;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const R=p[1];if(typeof R!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:R}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const R=p.slice(1);if(R.length!==4||R.some((z=>typeof z!="number"||z<0||z>1)))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:R}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length-1>3&&(r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(_=s.parse(_,2,Vn),!_)return null;const E=[];let O=null;h==="interpolate-hcl"||h==="interpolate-lab"?O=cs:s.expectedType&&s.expectedType.kind!=="value"&&(O=s.expectedType);for(let R=0;R<x.length;R+=2){const z=x[R],j=x[R+1],B=R+3,X=R+4;if(typeof z!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(E.length&&E[E.length-1][0]>=z)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const Z=s.parse(j,X,O);if(!Z)return null;O=O||Z.type,E.push([z,Z])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new sa(O,h,p,_,E):s.error(`Type ${fn(O)} is not interpolatable.`)}evaluate(r){const s=this.labels,h=this.outputs;if(s.length===1)return h[0].evaluate(r);const p=this.input.evaluate(r);if(p<=s[0])return h[0].evaluate(r);const _=s.length;if(p>=s[_-1])return h[_-1].evaluate(r);const x=Ah(s,p),E=sa.interpolationFactor(this.interpolation,p,s[x],s[x+1]),O=h[x].evaluate(r),R=h[x+1].evaluate(r);return this.operator==="interpolate"?sd[this.type.kind.toLowerCase()](O,R,E):this.operator==="interpolate-hcl"?Lp.reverse(Lp.interpolate(Lp.forward(O),Lp.forward(R),E)):_f.reverse(_f.interpolate(_f.forward(O),_f.forward(R),E))}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const s=[this.operator,r,this.input.serialize()];for(let h=0;h<this.labels.length;h++)s.push(this.labels[h],this.outputs[h].serialize());return s}}function Np(l,r,s,h){const p=h-s,_=l-s;return p===0?0:r===1?_/p:(Math.pow(r,_)-1)/(Math.pow(r,p)-1)}class Ch{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let h=null;const p=s.expectedType;p&&p.kind!=="value"&&(h=p);const _=[];for(const E of r.slice(1)){const O=s.parse(E,1+_.length,h,void 0,{typeAnnotation:"omit"});if(!O)return null;h=h||O.type,_.push(O)}const x=p&&_.some((E=>fr(p,E.type)));return new Ch(x?ge:h,_)}evaluate(r){let s,h=null,p=0;for(const _ of this.args){if(p++,h=_.evaluate(r),h&&h instanceof wo&&!h.available&&(s||(s=h),h=null,p===this.args.length))return s;if(h!==null)break}return h}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){const r=["coalesce"];return this.eachChild((s=>{r.push(s.serialize())})),r}}class Mu{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const h=[];for(let _=1;_<r.length-1;_+=2){const x=r[_];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",_);const E=s.parse(r[_+1],_+1);if(!E)return null;h.push([x,E])}const p=s.parse(r[r.length-1],r.length-1,s.expectedType,h);return p?new Mu(h,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[s,h]of this.bindings)r.push(s,h.serialize());return r.push(this.result.serialize()),r}}class vf{constructor(r,s,h){this.type=r,this.index=s,this.input=h}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=s.parse(r[1],1,Vn),p=s.parse(r[2],2,lt(s.expectedType||ge));return h&&p?new vf(p.type.itemType,h,p):null}evaluate(r){const s=this.index.evaluate(r),h=this.input.evaluate(r);if(s<0)throw new fa(`Array index out of bounds: ${s} < 0.`);if(s>=h.length)throw new fa(`Array index out of bounds: ${s} > ${h.length-1}.`);if(s!==Math.floor(s))throw new fa(`Array index must be an integer, but found ${s} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return h[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Mh{constructor(r,s,h){this.type=r,this.index=s,this.input=h}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=s.parse(r[1],1,Vn),p=s.parse(r[2],2,lt(s.expectedType||ge));return h&&p?new Mh(p.type.itemType,h,p):null}evaluate(r){const s=this.index.evaluate(r),h=this.input.evaluate(r);if(s<0)throw new fa(`Array index out of bounds: ${s} < 0.`);if(s>h.length-1)throw new fa(`Array index out of bounds: ${s} > ${h.length-1}.`);if(s===Math.floor(s))return h[s];const p=Math.floor(s),_=Math.ceil(s),x=h[p],E=h[_];if(typeof x!="number"||typeof E!="number")throw new fa(`Cannot interpolate between non-number values at index ${s}.`);const O=s-p;return x*(1-O)+E*O}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Ph{constructor(r,s){this.type=xr,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=s.parse(r[1],1,ge),p=s.parse(r[2],2,ge);return h&&p?Vr(h.type,[xr,fi,Vn,ph,ge])?new Ph(h,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${fn(h.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(h==null)return!1;if(!Bi(s,["boolean","string","number","null"]))throw new fa(`Expected first argument to be of type boolean, string, number or null, but found ${fn(Tn(s))} instead.`);if(!Bi(h,["string","array"]))throw new fa(`Expected second argument to be of type array or string, but found ${fn(Tn(h))} instead.`);return h.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class sg{constructor(r,s,h){this.type=Vn,this.needle=r,this.haystack=s,this.fromIndex=h}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=s.parse(r[1],1,ge),p=s.parse(r[2],2,ge);if(!h||!p)return null;if(!Vr(h.type,[xr,fi,Vn,ph,ge]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${fn(h.type)} instead`);if(r.length===4){const _=s.parse(r[3],3,Vn);return _?new sg(h,p,_):null}return new sg(h,p)}evaluate(r){const s=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!Bi(s,["boolean","string","number","null"]))throw new fa(`Expected first argument to be of type boolean, string, number or null, but found ${fn(Tn(s))} instead.`);if(!Bi(h,["string","array"]))throw new fa(`Expected second argument to be of type array or string, but found ${fn(Tn(h))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(r);return h.indexOf(s,p)}return h.indexOf(s)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class zp{constructor(r,s,h,p,_,x){this.inputType=r,this.type=s,this.input=h,this.cases=p,this.outputs=_,this.otherwise=x}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let h,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const _={},x=[];for(let R=2;R<r.length-1;R+=2){let z=r[R];const j=r[R+1];Array.isArray(z)||(z=[z]);const B=s.concat(R);if(z.length===0)return B.error("Expected at least one branch label.");for(const Z of z){if(typeof Z!="number"&&typeof Z!="string")return B.error("Branch labels must be numbers or strings.");if(typeof Z=="number"&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Z=="number"&&Math.floor(Z)!==Z)return B.error("Numeric branch labels must be integer values.");if(h){if(B.checkSubtype(h,Tn(Z)))return null}else h=Tn(Z);if(_[String(Z)]!==void 0)return B.error("Branch labels must be unique.");_[String(Z)]=x.length}const X=s.parse(j,R,p);if(!X)return null;p=p||X.type,x.push(X)}const E=s.parse(r[1],1,ge);if(!E)return null;const O=s.parse(r[r.length-1],r.length-1,p);return O?E.type.kind!=="value"&&s.concat(1).checkSubtype(h,E.type)?null:new zp(h,p,E,_,x,O):null}evaluate(r){const s=this.input.evaluate(r);return(Zi(Tn(s),this.inputType)&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),h=[],p={};for(const x of s){const E=p[this.cases[x]];E===void 0?(p[this.cases[x]]=h.length,h.push([this.cases[x],[x]])):h[E][1].push(x)}const _=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,E]of h)r.push(E.length===1?_(E[0]):E.map(_)),r.push(this.outputs[x].serialize());return r.push(this.otherwise.serialize()),r}}class lg{constructor(r,s,h){this.type=r,this.branches=s,this.otherwise=h}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const p=[];for(let x=1;x<r.length-1;x+=2){const E=s.parse(r[x],x,xr);if(!E)return null;const O=s.parse(r[x+1],x+1,h);if(!O)return null;p.push([E,O]),h=h||O.type}const _=s.parse(r[r.length-1],r.length-1,h);return _?new lg(h,p,_):null}evaluate(r){for(const[s,h]of this.branches)if(s.evaluate(r))return h.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,h]of this.branches)r(s),r(h);r(this.otherwise)}outputDefined(){return this.branches.every((([r,s])=>s.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild((s=>{r.push(s.serialize())})),r}}class Oh{constructor(r,s,h,p){this.type=r,this.input=s,this.beginIndex=h,this.endIndex=p}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=s.parse(r[1],1,ge),p=s.parse(r[2],2,Vn);if(!h||!p)return null;if(!Vr(h.type,[lt(ge),fi,ge]))return s.error(`Expected first argument to be of type array or string, but found ${fn(h.type)} instead`);if(r.length===4){const _=s.parse(r[3],3,Vn);return _?new Oh(h.type,h,p,_):null}return new Oh(h.type,h,p)}evaluate(r){const s=this.input.evaluate(r),h=this.beginIndex.evaluate(r);if(!Bi(s,["string","array"]))throw new fa(`Expected first argument to be of type array or string, but found ${fn(Tn(s))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(r);return s.slice(h,p)}return s.slice(h)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class Pu{constructor(r,s){this.type=lt(fi),this.str=r,this.delimiter=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=s.parse(r[1],1,fi),p=s.parse(r[2],2,fi);return h&&p?new Pu(h,p):void 0}evaluate(r){const s=this.str.evaluate(r),h=this.delimiter.evaluate(r);return s.split(h)}eachChild(r){r(this.str),r(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function jp(l,r){return l==="=="||l==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Bp(l,r,s,h){return h.compare(r,s)===0}function fd(l,r,s){const h=l!=="=="&&l!=="!=";return class Bee{constructor(_,x,E){this.type=xr,this.lhs=_,this.rhs=x,this.collator=E,this.hasUntypedArgument=_.type.kind==="value"||x.type.kind==="value"}static parse(_,x){if(_.length!==3&&_.length!==4)return x.error("Expected two or three arguments.");const E=_[0];let O=x.parse(_[1],1,ge);if(!O)return null;if(!jp(E,O.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${fn(O.type)}'.`);let R=x.parse(_[2],2,ge);if(!R)return null;if(!jp(E,R.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${fn(R.type)}'.`);if(O.type.kind!==R.type.kind&&O.type.kind!=="value"&&R.type.kind!=="value")return x.error(`Cannot compare types '${fn(O.type)}' and '${fn(R.type)}'.`);h&&(O.type.kind==="value"&&R.type.kind!=="value"?O=new Wn(R.type,[O]):O.type.kind!=="value"&&R.type.kind==="value"&&(R=new Wn(O.type,[R])));let z=null;if(_.length===4){if(O.type.kind!=="string"&&R.type.kind!=="string"&&O.type.kind!=="value"&&R.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(z=x.parse(_[3],3,ie),!z)return null}return new Bee(O,R,z)}evaluate(_){const x=this.lhs.evaluate(_),E=this.rhs.evaluate(_);if(h&&this.hasUntypedArgument){const O=Tn(x),R=Tn(E);if(O.kind!==R.kind||O.kind!=="string"&&O.kind!=="number")throw new fa(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${O.kind}, ${R.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const O=Tn(x),R=Tn(E);if(O.kind!=="string"||R.kind!=="string")return r(_,x,E)}return this.collator?s(_,x,E,this.collator.evaluate(_)):r(_,x,E)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[l];return this.eachChild((x=>{_.push(x.serialize())})),_}}}const xf=fd("==",(function(l,r,s){return r===s}),Bp),By=fd("!=",(function(l,r,s){return r!==s}),(function(l,r,s,h){return!Bp(0,r,s,h)})),cg=fd("<",(function(l,r,s){return r<s}),(function(l,r,s,h){return h.compare(r,s)<0})),Fy=fd(">",(function(l,r,s){return r>s}),(function(l,r,s,h){return h.compare(r,s)>0})),pv=fd("<=",(function(l,r,s){return r<=s}),(function(l,r,s,h){return h.compare(r,s)<=0})),pd=fd(">=",(function(l,r,s){return r>=s}),(function(l,r,s,h){return h.compare(r,s)>=0}));class ug{constructor(r,s,h,p,_,x){this.type=fi,this.number=r,this.locale=s,this.currency=h,this.unit=p,this.minFractionDigits=_,this.maxFractionDigits=x}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const h=s.parse(r[1],1,Vn);if(!h)return null;const p=r[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=s.parseObjectValue(p.locale,2,"locale",fi),!_))return null;let x=null;if(p.currency&&(x=s.parseObjectValue(p.currency,2,"currency",fi),!x))return null;let E=null;if(p.unit&&(E=s.parseObjectValue(p.unit,2,"unit",fi),!E))return null;let O=null;if(p["min-fraction-digits"]&&(O=s.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",Vn),!O))return null;let R=null;return p["max-fraction-digits"]&&(R=s.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",Vn),!R)?null:new ug(h,_,x,E,O,R)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class md{constructor(r){this.type=Vn,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const h=s.parse(r[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${fn(h.type)} instead.`):new md(h):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string"||Array.isArray(s))return s.length;throw new fa(`Expected value to be of type string or array, but found ${fn(Tn(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild((s=>{r.push(s.serialize())})),r}}function Vy(l){return function(){l=1831565813+(l|=0)|0;let r=Math.imul(l^l>>>15,1|l);return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296}}const gd={"==":xf,"!=":By,">":Fy,"<":cg,">=":pd,"<=":pv,array:Wn,at:vf,"at-interpolated":Mh,boolean:Wn,case:lg,coalesce:Ch,collator:qc,format:Pl,image:yc,in:Ph,"index-of":sg,interpolate:sa,"interpolate-hcl":sa,"interpolate-lab":sa,length:md,let:Mu,literal:er,match:zp,number:Wn,"number-format":ug,object:Wn,slice:Oh,step:Au,string:Wn,"to-boolean":Ps,"to-color":Ps,"to-number":Ps,"to-string":Ps,var:Wc,within:vu,distance:Sh,config:Eh,split:Pu};function Jc(l,[r,s,h,p]){r=r.evaluate(l),s=s.evaluate(l),h=h.evaluate(l);const _=p?p.evaluate(l):1,x=$c(r,s,h,_);if(x)throw new fa(x);return new pi(r/255,s/255,h/255,_)}function hg(l,[r,s,h,p]){r=r.evaluate(l),s=s.evaluate(l),h=h.evaluate(l);const _=p?p.evaluate(l):1,x=(function(R,z,j,B){return typeof R=="number"&&R>=0&&R<=360?typeof z=="number"&&z>=0&&z<=100&&typeof j=="number"&&j>=0&&j<=100?B===void 0||typeof B=="number"&&B>=0&&B<=1?null:`Invalid hsla value [${[R,z,j,B].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof B=="number"?[R,z,j,B]:[R,z,j]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof B=="number"?[R,z,j,B]:[R,z,j]).join(", ")}]: 'h' must be between 0 and 360.`})(r,s,h,_);if(x)throw new fa(x);const E=`hsla(${r}, ${s}%, ${h}%, ${_})`,O=pi.parse(E);if(!O)throw new fa(`Failed to parse HSLA color: ${E}`);return O}function dg(l,r){return l in r}function xc(l,r){const s=r[l];return s===void 0?null:s}function Zs(l){return{type:l}}function yd(l){return{result:"success",value:l}}function Qc(l){return{result:"error",value:l}}function eu(l,r){return!!l&&!!l.parameters&&l.parameters.indexOf(r)>-1}function Rh(l){return l["property-type"]==="data-driven"}function bf(l){return eu(l.expression,"measure-light")}function Uy(l){return eu(l.expression,"zoom")}function Fp(l){return!!l.expression&&l.expression.interpolated}function Ou(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function Vp(l){return l}function fg(l,r){const s=r.type==="color",h=l.stops&&typeof l.stops[0][0]=="object",p=h||!(h||l.property!==void 0),_=l.type||(Fp(r)?"exponential":"interval");if(s&&((l=_u({},l)).stops&&(l.stops=l.stops.map((R=>[R[0],pi.parse(R[1])]))),l.default=pi.parse(l.default?l.default:r.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!og[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let x,E,O;if(_==="exponential")x=Di;else if(_==="interval")x=Iu;else if(_==="categorical"){x=Up,E=Object.create(null);for(const R of l.stops)E[R[0]]=R[1];O=typeof l.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);x=Yi}if(h){const R={},z=[];for(let X=0;X<l.stops.length;X++){const Z=l.stops[X],ae=Z[0].zoom;R[ae]===void 0&&(R[ae]={zoom:ae,type:l.type,property:l.property,default:l.default,stops:[]},z.push(ae)),R[ae].stops.push([Z[0].value,Z[1]])}const j=[];for(const X of z)j.push([R[X].zoom,fg(R[X],r)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:sa.interpolationFactor.bind(void 0,B),zoomStops:j.map((X=>X[0])),evaluate:({zoom:X},Z)=>Di({stops:j,base:l.base},r,X).evaluate(X,Z)}}if(p){const R=_==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:sa.interpolationFactor.bind(void 0,R),zoomStops:l.stops.map((z=>z[0])),evaluate:({zoom:z})=>x(l,r,z,E,O)}}return{kind:"source",evaluate(R,z){const j=z&&z.properties?z.properties[l.property]:void 0;return j===void 0?Ru(l.default,r.default):x(l,r,j,E,O)}}}function Ru(l,r,s){return l!==void 0?l:r!==void 0?r:s!==void 0?s:void 0}function Up(l,r,s,h,p){return Ru(typeof s===p?h[s]:void 0,l.default,r.default)}function Iu(l,r,s){if(ql(s)!=="number")return Ru(l.default,r.default);const h=l.stops.length;if(h===1||s<=l.stops[0][0])return l.stops[0][1];if(s>=l.stops[h-1][0])return l.stops[h-1][1];const p=Ah(l.stops.map((_=>_[0])),s);return l.stops[p][1]}function Di(l,r,s){const h=l.base!==void 0?l.base:1;if(ql(s)!=="number")return Ru(l.default,r.default);const p=l.stops.length;if(p===1||s<=l.stops[0][0])return l.stops[0][1];if(s>=l.stops[p-1][0])return l.stops[p-1][1];const _=Ah(l.stops.map((z=>z[0])),s),x=(function(z,j,B,X){const Z=X-B,ae=z-B;return Z===0?0:j===1?ae/Z:(Math.pow(j,ae)-1)/(Math.pow(j,Z)-1)})(s,h,l.stops[_][0],l.stops[_+1][0]),E=l.stops[_][1],O=l.stops[_+1][1];let R=sd[r.type]||Vp;if(l.colorSpace&&l.colorSpace!=="rgb"){const z=og[l.colorSpace];R=(j,B)=>z.reverse(z.interpolate(z.forward(j),z.forward(B),x))}return typeof E.evaluate=="function"?{evaluate(...z){const j=E.evaluate.apply(void 0,z),B=O.evaluate.apply(void 0,z);if(j!==void 0&&B!==void 0)return R(j,B,x)}}:R(E,O,x)}function Yi(l,r,s){return r.type==="color"?s=pi.parse(s):r.type==="formatted"?s=Ko.fromString(s.toString()):r.type==="resolvedImage"?s=wo.build(s.toString()):ql(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0),Ru(s,l.default,r.default)}no.register(gd,{error:[{kind:"error"},[fi],(l,[r])=>{throw new fa(r.evaluate(l))}],typeof:[fi,[ge],(l,[r])=>fn(Tn(r.evaluate(l)))],"to-rgba":[lt(Vn,4),[cs],(l,[r])=>r.evaluate(l).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[lt(Vn,4),[cs],(l,[r])=>r.evaluate(l).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[cs,[Vn,Vn,Vn],Jc],rgba:[cs,[Vn,Vn,Vn,Vn],Jc],hsl:[cs,[Vn,Vn,Vn],hg],hsla:[cs,[Vn,Vn,Vn,Vn],hg],has:{type:xr,overloads:[[[fi],(l,[r])=>dg(r.evaluate(l),l.properties())],[[fi,gc],(l,[r,s])=>dg(r.evaluate(l),s.evaluate(l))]]},get:{type:ge,overloads:[[[fi],(l,[r])=>xc(r.evaluate(l),l.properties())],[[fi,gc],(l,[r,s])=>xc(r.evaluate(l),s.evaluate(l))]]},"feature-state":[ge,[fi],(l,[r])=>xc(r.evaluate(l),l.featureState||{})],properties:[gc,[],l=>l.properties()],"geometry-type":[fi,[],l=>l.geometryType()],worldview:[fi,[],l=>l.globals.worldview||""],id:[ge,[],l=>l.id()],zoom:[Vn,[],l=>l.globals.zoom],pitch:[Vn,[],l=>l.globals.pitch||0],"distance-from-center":[Vn,[],l=>l.distanceFromCenter()],"measure-light":[Vn,[fi],(l,[r])=>l.measureLight(r.evaluate(l))],"heatmap-density":[Vn,[],l=>l.globals.heatmapDensity||0],"line-progress":[Vn,[],l=>l.globals.lineProgress||0],"raster-value":[Vn,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[Vn,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[Vn,[],l=>l.globals.skyRadialProgress||0],accumulated:[ge,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[Vn,Zs(Vn),(l,r)=>{let s=0;for(const h of r)s+=h.evaluate(l);return s}],"*":[Vn,Zs(Vn),(l,r)=>{let s=1;for(const h of r)s*=h.evaluate(l);return s}],"-":{type:Vn,overloads:[[[Vn,Vn],(l,[r,s])=>r.evaluate(l)-s.evaluate(l)],[[Vn],(l,[r])=>-r.evaluate(l)]]},"/":[Vn,[Vn,Vn],(l,[r,s])=>r.evaluate(l)/s.evaluate(l)],"%":[Vn,[Vn,Vn],(l,[r,s])=>r.evaluate(l)%s.evaluate(l)],ln2:[Vn,[],()=>Math.LN2],pi:[Vn,[],()=>Math.PI],e:[Vn,[],()=>Math.E],"^":[Vn,[Vn,Vn],(l,[r,s])=>Math.pow(r.evaluate(l),s.evaluate(l))],sqrt:[Vn,[Vn],(l,[r])=>Math.sqrt(r.evaluate(l))],log10:[Vn,[Vn],(l,[r])=>Math.log(r.evaluate(l))/Math.LN10],ln:[Vn,[Vn],(l,[r])=>Math.log(r.evaluate(l))],log2:[Vn,[Vn],(l,[r])=>Math.log(r.evaluate(l))/Math.LN2],sin:[Vn,[Vn],(l,[r])=>Math.sin(r.evaluate(l))],cos:[Vn,[Vn],(l,[r])=>Math.cos(r.evaluate(l))],tan:[Vn,[Vn],(l,[r])=>Math.tan(r.evaluate(l))],asin:[Vn,[Vn],(l,[r])=>Math.asin(r.evaluate(l))],acos:[Vn,[Vn],(l,[r])=>Math.acos(r.evaluate(l))],atan:[Vn,[Vn],(l,[r])=>Math.atan(r.evaluate(l))],min:[Vn,Zs(Vn),(l,r)=>Math.min(...r.map((s=>s.evaluate(l))))],max:[Vn,Zs(Vn),(l,r)=>Math.max(...r.map((s=>s.evaluate(l))))],abs:[Vn,[Vn],(l,[r])=>Math.abs(r.evaluate(l))],round:[Vn,[Vn],(l,[r])=>{const s=r.evaluate(l);return s<0?-Math.round(-s):Math.round(s)}],floor:[Vn,[Vn],(l,[r])=>Math.floor(r.evaluate(l))],ceil:[Vn,[Vn],(l,[r])=>Math.ceil(r.evaluate(l))],"filter-==":[xr,[fi,ge],(l,[r,s])=>l.properties()[r.value]===s.value],"filter-id-==":[xr,[ge],(l,[r])=>l.id()===r.value],"filter-type-==":[xr,[fi],(l,[r])=>l.geometryType()===r.value],"filter-<":[xr,[fi,ge],(l,[r,s])=>{const h=l.properties()[r.value],p=s.value;return typeof h==typeof p&&h<p}],"filter-id-<":[xr,[ge],(l,[r])=>{const s=l.id(),h=r.value;return typeof s==typeof h&&s<h}],"filter->":[xr,[fi,ge],(l,[r,s])=>{const h=l.properties()[r.value],p=s.value;return typeof h==typeof p&&h>p}],"filter-id->":[xr,[ge],(l,[r])=>{const s=l.id(),h=r.value;return typeof s==typeof h&&s>h}],"filter-<=":[xr,[fi,ge],(l,[r,s])=>{const h=l.properties()[r.value],p=s.value;return typeof h==typeof p&&h<=p}],"filter-id-<=":[xr,[ge],(l,[r])=>{const s=l.id(),h=r.value;return typeof s==typeof h&&s<=h}],"filter->=":[xr,[fi,ge],(l,[r,s])=>{const h=l.properties()[r.value],p=s.value;return typeof h==typeof p&&h>=p}],"filter-id->=":[xr,[ge],(l,[r])=>{const s=l.id(),h=r.value;return typeof s==typeof h&&s>=h}],"filter-has":[xr,[ge],(l,[r])=>r.value in l.properties()],"filter-has-id":[xr,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[xr,[lt(fi)],(l,[r])=>r.value.indexOf(l.geometryType())>=0],"filter-id-in":[xr,[lt(ge)],(l,[r])=>r.value.indexOf(l.id())>=0],"filter-in-small":[xr,[fi,lt(ge)],(l,[r,s])=>s.value.indexOf(l.properties()[r.value])>=0],"filter-in-large":[xr,[fi,lt(ge)],(l,[r,s])=>(function(h,p,_,x){for(;_<=x;){const E=_+x>>1;if(p[E]===h)return!0;p[E]>h?x=E-1:_=E+1}return!1})(l.properties()[r.value],s.value,0,s.value.length-1)],all:{type:xr,overloads:[[[xr,xr],(l,[r,s])=>r.evaluate(l)&&s.evaluate(l)],[Zs(xr),(l,r)=>{for(const s of r)if(!s.evaluate(l))return!1;return!0}]]},any:{type:xr,overloads:[[[xr,xr],(l,[r,s])=>r.evaluate(l)||s.evaluate(l)],[Zs(xr),(l,r)=>{for(const s of r)if(s.evaluate(l))return!0;return!1}]]},"!":[xr,[xr],(l,[r])=>!r.evaluate(l)],"is-supported-script":[xr,[fi],(l,[r])=>{const s=l.globals&&l.globals.isSupportedScript;return!s||s(r.evaluate(l))}],upcase:[fi,[fi],(l,[r])=>r.evaluate(l).toUpperCase()],downcase:[fi,[fi],(l,[r])=>r.evaluate(l).toLowerCase()],concat:[fi,Zs(ge),(l,r)=>r.map((s=>Ws(s.evaluate(l)))).join("")],"resolved-locale":[fi,[ie],(l,[r])=>r.evaluate(l).resolvedLocale()],random:[Vn,[Vn,Vn,ge],(l,r)=>{const[s,h,p]=r.map((x=>x.evaluate(l)));if(s>h||s===h)return s;let _;if(typeof p=="string")_=(function(x){let E=0;if(x.length===0)return E;for(let O=0;O<x.length;O++)E=(E<<5)-E+x.charCodeAt(O),E|=0;return E})(p);else{if(typeof p!="number")throw new fa(`Invalid seed input: ${p}`);_=p}return s+Vy(_)()*(h-s)}]});class So{constructor(r,s,h,p){this.expression=r,this._warningHistory={},this._evaluator=new mh(h,p),this._defaultValue=s?(function(_){return _.type==="color"&&(Ou(_.default)||Array.isArray(_.default))?new pi(0,0,0,0):_.type==="color"?pi.parse(_.default)||null:_.default===void 0?null:_.default})(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=us(r)}evaluateWithoutErrorHandling(r,s,h,p,_,x,E,O){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=h,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(r,s,h,p,_,x,E,O){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=h||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new fa(`Expected value to be one of ${Object.keys(this._enumValues).map((z=>JSON.stringify(z))).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${R.message}`)),this._defaultValue}}}function wf(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in gd}function Yl(l,r,s,h){const p=new Dp(gd,[],r?(function(x){const E={color:cs,string:fi,number:Vn,enum:fi,boolean:xr,formatted:_e,resolvedImage:Xe};return x.type==="array"?lt(E[x.value]||ge,x.length):E[x.type]})(r):void 0,void 0,void 0,s,h),_=p.parse(l,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?yd(new So(_,r,s,h)):Qc(p.errors)}class tu{constructor(r,s,h,p){this.kind=r,this._styleExpression=s,this.isLightConstant=h,this.isLineProgressConstant=p,this.isStateDependent=r!=="constant"&&!mf(s.expression),this.configDependencies=us(s.expression)}evaluateWithoutErrorHandling(r,s,h,p,_,x){return this._styleExpression.evaluateWithoutErrorHandling(r,s,h,p,_,x)}evaluate(r,s,h,p,_,x){return this._styleExpression.evaluate(r,s,h,p,_,x)}}class bc{constructor(r,s,h,p,_,x){this.kind=r,this.zoomStops=h,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!mf(s.expression),this.isLightConstant=_,this.isLineProgressConstant=x,this.configDependencies=us(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(r,s,h,p,_,x){return this._styleExpression.evaluateWithoutErrorHandling(r,s,h,p,_,x)}evaluate(r,s,h,p,_,x){return this._styleExpression.evaluate(r,s,h,p,_,x)}interpolationFactor(r,s,h){return this.interpolationType?sa.interpolationFactor(this.interpolationType,r,s,h):0}}function _d(l,r,s,h){if((l=Yl(l,r,s,h)).result==="error")return l;const p=l.value.expression,_=Th(p);if(!_&&!Rh(r))return Qc([new Gs("","data expressions not supported")]);const x=ja(p,["zoom","pitch","distance-from-center"]);if(!x&&!Uy(r))return Qc([new Gs("","zoom expressions not supported")]);const E=ja(p,["measure-light"]);if(!E&&!bf(r))return Qc([new Gs("","measure-light expression not supported")]);const O=ja(p,["line-progress"]);if(!O&&!(function(j){return eu(j.expression,"line-progress")})(r))return Qc([new Gs("","line-progress expression not supported")]);const R=r.expression&&r.expression.relaxZoomRestriction,z=$p(p);return z||x||R?z instanceof Gs?Qc([z]):z instanceof sa&&!Fp(r)?Qc([new Gs("",'"interpolate" expressions cannot be used with this property')]):yd(z?new bc(_&&O?"camera":"composite",l.value,z.labels,z instanceof sa?z.interpolation:void 0,E,O):new tu(_&&O?"constant":"source",l.value,E,O)):Qc([new Gs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Kl{constructor(r,s){this._parameters=r,this._specification=s,_u(this,fg(this._parameters,this._specification))}static deserialize(r){return new Kl(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function $p(l){let r=null;if(l instanceof Mu)r=$p(l.result);else if(l instanceof Ch){for(const s of l.args)if(r=$p(s),r)break}else(l instanceof Au||l instanceof sa)&&l.input instanceof no&&l.input.name==="zoom"&&(r=l);return r instanceof Gs||l.eachChild((s=>{const h=$p(s);h instanceof Gs?r=h:r&&h&&r!==h&&(r=new Gs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}var fo,pg,qp=(function(){if(pg)return fo;pg=1,fo=r;var l=3;function r(s,h,p){var _=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var x=new Int32Array(this.arrayBuffer);s=x[0],this.d=(h=x[1])+2*(p=x[2]);for(var E=0;E<this.d*this.d;E++){var O=x[l+E],R=x[l+E+1];_.push(O===R?null:x.subarray(O,R))}var z=x[l+_.length+1];this.keys=x.subarray(x[l+_.length],z),this.bboxes=x.subarray(z),this.insert=this._insertReadonly}else{this.d=h+2*p;for(var j=0;j<this.d*this.d;j++)_.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=s,this.padding=p,this.scale=h/s,this.uid=0;var B=p/h*s;this.min=-B,this.max=s+B}return r.prototype.insert=function(s,h,p,_,x){this._forEachCell(h,p,_,x,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(x)},r.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},r.prototype._insertCell=function(s,h,p,_,x,E){this.cells[x].push(E)},r.prototype.query=function(s,h,p,_,x){var E=this.min,O=this.max;if(s<=E&&h<=E&&O<=p&&O<=_&&!x)return Array.prototype.slice.call(this.keys);var R=[];return this._forEachCell(s,h,p,_,this._queryCell,R,{},x),R},r.prototype._queryCell=function(s,h,p,_,x,E,O,R){var z=this.cells[x];if(z!==null)for(var j=this.keys,B=this.bboxes,X=0;X<z.length;X++){var Z=z[X];if(O[Z]===void 0){var ae=4*Z;(R?R(B[ae+0],B[ae+1],B[ae+2],B[ae+3]):s<=B[ae+2]&&h<=B[ae+3]&&p>=B[ae+0]&&_>=B[ae+1])?(O[Z]=!0,E.push(j[Z])):O[Z]=!1}}},r.prototype._forEachCell=function(s,h,p,_,x,E,O,R){for(var z=this._convertToCellCoord(s),j=this._convertToCellCoord(h),B=this._convertToCellCoord(p),X=this._convertToCellCoord(_),Z=z;Z<=B;Z++)for(var ae=j;ae<=X;ae++){var se=this.d*ae+Z;if((!R||R(this._convertFromCellCoord(Z),this._convertFromCellCoord(ae),this._convertFromCellCoord(Z+1),this._convertFromCellCoord(ae+1)))&&x.call(this,s,h,p,_,se,E,O,R))return}},r.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},r.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},r.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,h=l+this.cells.length+1+1,p=0,_=0;_<this.cells.length;_++)p+=this.cells[_].length;var x=new Int32Array(h+p+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var E=h,O=0;O<s.length;O++){var R=s[O];x[l+O]=E,x.set(R,E),E+=R.length}return x[l+s.length]=E,x.set(this.keys,E),x[l+s.length+1]=E+=this.keys.length,x.set(this.bboxes,E),E+=this.bboxes.length,x.buffer},fo})(),Du=ya(qp);const Sf={};function Rn(l,r,s={}){Object.defineProperty(l,"_classRegistryKey",{value:r,writable:!1}),Sf[r]={klass:l,omit:s.omit||[]}}Rn(Object,"Object"),Du.serialize=function(l,r){const s=l.toArrayBuffer();return r&&r.add(s),{buffer:s}},Du.deserialize=function(l){return new Du(l.buffer)},Object.defineProperty(Du,"name",{value:"Grid"}),Rn(Du,"Grid"),delete kt.prototype.constructor,typeof DOMMatrix<"u"&&Rn(DOMMatrix,"DOMMatrix"),Rn(pi,"Color"),Rn(Error,"Error"),Rn(Ko,"Formatted"),Rn(Uc,"FormattedSection"),Rn(Fr,"AJAXError"),Rn(wo,"ResolvedImage"),Rn(Kl,"StylePropertyFunction"),Rn(So,"StyleExpression",{omit:["_evaluator"]}),Rn(Ms,"ImageId"),Rn(Ml,"ImageVariant"),Rn(bc,"ZoomDependentExpression"),Rn(tu,"ZoomConstantExpression"),Rn(no,"CompoundExpression",{omit:["_evaluate"]});for(const l in gd)Sf[gd[l]._classRegistryKey]||Rn(gd[l],`Expression${l}`);function Tf(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function vd(l){return self.ImageBitmap&&l instanceof ImageBitmap}function wc(l,r){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(Tf(l)||vd(l))return r&&r.add(l),l;if(ArrayBuffer.isView(l))return r&&r.add(l.buffer),l;if(l instanceof ImageData)return r&&r.add(l.data.buffer),l;if(Array.isArray(l)){const s=[];for(const h of l)s.push(wc(h,r));return s}if(l instanceof Map){const s={$name:"Map",entries:[]};for(const[h,p]of l.entries())s.entries.push(wc(h),wc(p,r));return s}if(l instanceof Set){const s={$name:"Set"};let h=0;for(const p of l.values())s[++h]=wc(p);return s}if(l instanceof DOMMatrix){const s={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of h)s[p]=l[p];return s}if(typeof l=="bigint")return{$name:"BigInt",value:l.toString()};if(typeof l=="object"){const s=l.constructor,h=s._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${s.name}".`);const p=s.serialize?s.serialize(l,r):{};if(!s.serialize){for(const _ in l)l.hasOwnProperty(_)&&(Sf[h].omit.indexOf(_)>=0||(p[_]=wc(l[_],r)));l instanceof Error&&(p.message=l.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(p.$name=h),p}throw new Error("can't serialize object of type "+typeof l)}function ka(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||Tf(l)||vd(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(ka);if(typeof l=="object"){const r=l.$name||"Object";if(r==="Map"){const p=l.entries||[],_=new Map;for(let x=0;x<p.length;x+=2)_.set(ka(p[x]),ka(p[x+1]));return _}if(r==="Set"){const p=new Set;for(const _ of Object.keys(l))_!=="$name"&&p.add(ka(l[_]));return p}if(r==="DOMMatrix"){let p;return p=l.is2D?[l.a,l.b,l.c,l.d,l.e,l.f]:[l.m11,l.m12,l.m13,l.m14,l.m21,l.m22,l.m23,l.m24,l.m31,l.m32,l.m33,l.m34,l.m41,l.m42,l.m43,l.m44],new DOMMatrix(p)}if(r==="BigInt")return BigInt(l.value);const{klass:s}=Sf[r];if(!s)throw new Error(`Can't deserialize unregistered class "${r}".`);if(s.deserialize)return s.deserialize(l);const h=Object.create(s.prototype);for(const p of Object.keys(l))p!=="$name"&&(h[p]=ka(l[p]));return h}throw new Error("can't deserialize object of type "+typeof l)}const jn={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function Hp(l){for(const r of l)if(Ef(r.charCodeAt(0)))return!0;return!1}function Gp(l){for(const r of l)if(!mg(r.charCodeAt(0)))return!1;return!0}function mg(l){return!(jn.Arabic(l)||jn["Arabic Supplement"](l)||jn["Arabic Extended-A"](l)||jn["Arabic Presentation Forms-A"](l)||jn["Arabic Presentation Forms-B"](l))}function Ef(l){return!(l!==746&&l!==747&&(l<4352||!(jn["Bopomofo Extended"](l)||jn.Bopomofo(l)||jn["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||jn["CJK Compatibility Ideographs"](l)||jn["CJK Compatibility"](l)||jn["CJK Radicals Supplement"](l)||jn["CJK Strokes"](l)||!(!jn["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||jn["CJK Unified Ideographs Extension A"](l)||jn["CJK Unified Ideographs"](l)||jn["Enclosed CJK Letters and Months"](l)||jn["Hangul Compatibility Jamo"](l)||jn["Hangul Jamo Extended-A"](l)||jn["Hangul Jamo Extended-B"](l)||jn["Hangul Jamo"](l)||jn["Hangul Syllables"](l)||jn.Hiragana(l)||jn["Ideographic Description Characters"](l)||jn.Kanbun(l)||jn["Kangxi Radicals"](l)||jn["Katakana Phonetic Extensions"](l)||jn.Katakana(l)&&l!==12540||!(!jn["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!jn["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||jn["Unified Canadian Aboriginal Syllabics"](l)||jn["Unified Canadian Aboriginal Syllabics Extended"](l)||jn["Vertical Forms"](l)||jn["Yijing Hexagram Symbols"](l)||jn["Yi Syllables"](l)||jn["Yi Radicals"](l))))}function Jl(l){return!(Ef(l)||(function(r){return!!(jn["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||jn["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||jn["Letterlike Symbols"](r)||jn["Number Forms"](r)||jn["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||jn["Control Pictures"](r)&&r!==9251||jn["Optical Character Recognition"](r)||jn["Enclosed Alphanumerics"](r)||jn["Geometric Shapes"](r)||jn["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||jn["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||jn["CJK Symbols and Punctuation"](r)||jn.Katakana(r)||jn["Private Use Area"](r)||jn["CJK Compatibility Forms"](r)||jn["Small Form Variants"](r)||jn["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)})(l))}function Wp(l){return jn.Arabic(l)||jn["Arabic Supplement"](l)||jn["Arabic Extended-A"](l)||jn["Arabic Presentation Forms-A"](l)||jn["Arabic Presentation Forms-B"](l)}function Af(l){return l>=1424&&l<=2303||jn["Arabic Presentation Forms-A"](l)||jn["Arabic Presentation Forms-B"](l)}function $y(l,r){return!(!r&&Af(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||jn.Khmer(l))}function mv(l){for(const r of l)if(Af(r.charCodeAt(0)))return!0;return!1}const Ys={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let gg=null,_s=Ys.unavailable,ku=null;const qy=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(_s=Ys.error),gg&&gg(l)};function Xp(){yg.fire(new Cl("pluginStateChange",{pluginStatus:_s,pluginURL:ku}))}const yg=new yu,Hy=function(){return _s},Gy=function(){if(_s!==Ys.deferred||!ku)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_s=Ys.loading,Xp(),ku&&pc({url:ku},(l=>{l?qy(l):(_s=Ys.loaded,Xp())}))},Sc={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_s===Ys.loaded||Sc.applyArabicShaping!=null,isLoading:()=>_s===Ys.loading,setState(l){_s=l.pluginStatus,ku=l.pluginURL},isParsing:()=>_s===Ys.parsing,isParsed:()=>_s===Ys.parsed,getPluginURL:()=>ku};class Ei{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness,this.worldview=s.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(r){return(function(s,h){for(const p of s)if(!$y(p.charCodeAt(0),h))return!1;return!0})(r,Sc.isLoaded())}}class xd{constructor(r,s,h,p){this.property=r,this.value=s,this.expression=(function(_,x,E,O){if(Ou(_))return new Kl(_,x);if(wf(_)||Array.isArray(_)&&_.length>0){const R=_d(_,x,E,O);if(R.result==="error")throw new Error(R.value.map((z=>`${z.key}: ${z.message}`)).join(", "));return R.value}{let R=_;return typeof _=="string"&&x.type==="color"&&(R=pi.parse(_)),{kind:"constant",configDependencies:new Set,evaluate:()=>R}}})(s===void 0?r.specification.default:s,r.specification,h,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,h){return this.property.possiblyEvaluate(this,r,s,h)}}class Zp{constructor(r,s,h){this.property=r,this.value=new xd(r,void 0,s,h)}transitioned(r,s){return new Wy(this.property,this.value,s,yt({},r.transition,this.transition),r.now)}untransitioned(){return new Wy(this.property,this.value,null,{},0)}}class Cf{constructor(r,s,h){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._scope=s,this._options=h,this.configDependencies=new Set}getValue(r){return gr(this._values[r].value.value)}setValue(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Zp(this._values[r].property,this._scope,this._options)),this._values[r].value=new xd(this._values[r].property,s===null?void 0:gr(s),this._scope,this._options),this._values[r].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[r].value.expression.configDependencies]))}setTransitionOrValue(r,s){s&&(this._options=s);const h=this._properties.properties;if(r)for(const p in r){const _=r[p];if(p.endsWith("-transition")){const x=p.slice(0,-11);h[x]&&this.setTransition(x,_)}else h.hasOwnProperty(p)&&this.setValue(p,_)}}getTransition(r){return gr(this._values[r].transition)}setTransition(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Zp(this._values[r].property)),this._values[r].transition=gr(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const h=this.getValue(s);h!==void 0&&(r[s]=h);const p=this.getTransition(s);p!==void 0&&(r[`${s}-transition`]=p)}return r}transitioned(r,s){const h=new Xy(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].transitioned(r,s._values[p]);return h}untransitioned(){const r=new Xy(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class Wy{constructor(r,s,h,p,_){const x=p.delay||0,E=p.duration||0;_=_||0,this.property=r,this.value=s,this.begin=_+x,this.end=this.begin+E,r.specification.transition&&(p.delay||p.duration)&&(this.prior=h)}possiblyEvaluate(r,s,h){const p=r.now||0,_=this.value.possiblyEvaluate(r,s,h),x=this.prior;if(x){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return x.possiblyEvaluate(r,s,h);{const E=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,s,h),_,ye(E))}}return _}}class Xy{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,h){const p=new Ql(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(r,s,h);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Lu{constructor(r,s,h){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._scope=s,this._options=h,this.configDependencies=new Set}getValue(r){return gr(this._values[r].value)}setValue(r,s){this._values[r]=new xd(this._values[r].property,s===null?void 0:gr(s),this._scope,this._options),this._values[r].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[r].expression.configDependencies]))}serialize(){const r={};for(const s of Object.keys(this._values)){const h=this.getValue(s);h!==void 0&&(r[s]=h)}return r}possiblyEvaluate(r,s,h){const p=new Ql(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(r,s,h);return p}}class bd{constructor(r,s,h){this.property=r,this.value=s,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,h,p){return this.property.evaluate(this.value,this.parameters,r,s,h,p)}}class Ql{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Jt{constructor(r){this.specification=r}possiblyEvaluate(r,s){return r.expression.evaluate(s)}interpolate(r,s,h){const p=sd[this.specification.type];return p?p(r,s,h):r}}class wn{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,h,p){return new bd(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},h,p)}:r.expression,s)}interpolate(r,s,h){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new bd(this,{kind:"constant",value:void 0},r.parameters);const p=sd[this.specification.type];return p?new bd(this,{kind:"constant",value:p(r.value.value,s.value.value,h)},r.parameters):r}evaluate(r,s,h,p,_,x){return r.kind==="constant"?r.value:r.evaluate(s,h,p,_,x)}}class wd{constructor(r){this.specification=r}possiblyEvaluate(r,s,h,p){return!!r.expression.evaluate(s,null,{},h,p)}interpolate(){return!1}}class la{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Ei(0,{});for(const h in r){const p=r[h];p.specification.overridable&&this.overridableProperties.push(h);const _=this.defaultPropertyValues[h]=new xd(p,void 0),x=this.defaultTransitionablePropertyValues[h]=new Zp(p);this.defaultTransitioningPropertyValues[h]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=_.possiblyEvaluate(s)}}}Rn(wn,"DataDrivenProperty"),Rn(Jt,"DataConstantProperty"),Rn(wd,"ColorRampProperty");var st=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"expression"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function Zy(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Mf(l){if(Array.isArray(l))return l.map(Mf);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const r={};for(const s in l)r[s]=Mf(l[s]);return r}return Zy(l)}function Pf(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const r of l.slice(1))if(!Pf(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function Sd(l,r="",s=null,h="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Pf(l)||(l=Jp(l));const p=l;let _=!0;try{_=(function(z){if(!Ih(z))return z;let j=Mf(z);return Yp(j),j=_g(j),j})(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let x=null,E=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){E=st[`filter_${h}`];const z=Yl(_,E,r,s);if(z.result==="error")throw new Error(z.value.map((j=>`${j.key}: ${j.message}`)).join(", "));x=(j,B,X)=>z.value.evaluate(j,B,{},X)}let O=null,R=null;if(_!==p){const z=Yl(p,E,r,s);if(z.result==="error")throw new Error(z.value.map((j=>`${j.key}: ${j.message}`)).join(", "));O=(j,B,X,Z,ae)=>z.value.evaluate(j,B,{},X,void 0,void 0,Z,ae),R=!Th(z.value.expression)}return{filter:x,dynamicFilter:O||void 0,needGeometry:Kp(_),needFeature:!!R}}function _g(l){if(!Array.isArray(l))return l;const r=(function(s){if(Tc.has(s[0])){for(let h=1;h<s.length;h++)if(Ih(s[h]))return!0}return s})(l);return r===!0?r:r.map((s=>_g(s)))}function Yp(l){let r=!1;const s=[];if(l[0]==="case"){for(let h=1;h<l.length-1;h+=2)r=r||Ih(l[h]),s.push(l[h+1]);s.push(l[l.length-1])}else if(l[0]==="match"){r=r||Ih(l[1]);for(let h=2;h<l.length-1;h+=2)s.push(l[h+1]);s.push(l[l.length-1])}else if(l[0]==="step"){r=r||Ih(l[1]);for(let h=1;h<l.length-1;h+=2)s.push(l[h+1])}r&&(l.length=0,l.push("any",...s));for(let h=1;h<l.length;h++)Yp(l[h])}function Ih(l){if(!Array.isArray(l))return!1;if((r=l[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let s=1;s<l.length;s++)if(Ih(l[s]))return!0;return!1}const Tc=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function gv(l,r){return l<r?-1:l>r?1:0}function Kp(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let r=1;r<l.length;r++)if(Kp(l[r]))return!0;return!1}function Jp(l){if(!l)return!0;const r=l[0];return l.length<=1?r!=="any":r==="=="?vg(l[1],l[2],"=="):r==="!="?Qp(vg(l[1],l[2],"==")):r==="<"||r===">"||r==="<="||r===">="?vg(l[1],l[2],r):r==="any"?(s=l.slice(1),["any"].concat(s.map(Jp))):r==="all"?["all"].concat(l.slice(1).map(Jp)):r==="none"?["all"].concat(l.slice(1).map(Jp).map(Qp)):r==="in"?yv(l[1],l.slice(2)):r==="!in"?Qp(yv(l[1],l.slice(2))):r==="has"?xg(l[1]):r!=="!has"||Qp(xg(l[1]));var s}function vg(l,r,s){switch(l){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,l,r]}}function yv(l,r){if(r.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some((s=>typeof s!=typeof r[0]))?["filter-in-large",l,["literal",r.sort(gv)]]:["filter-in-small",l,["literal",r]]}}function xg(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Qp(l){return["!",l]}const Of="";function Dh(l,r){return r?`${l}${Of}${r}`:l}const Yy="-transition",_v=new Set(["fill","line","background","hillshade","raster"]);class vs extends yu{constructor(r,s,h,p,_){if(super(),this.id=r.id,this.fqid=Dh(this.id,h),this.type=r.type,this.scope=h,this.lut=p,this.options=_,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,r.type!=="custom"){if(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type&&r.type!=="background"&&r.type!=="sky"&&r.type!=="slot"){this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter;const x=Yl(this.filter,st[`filter_${r.type}`]);x.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...x.value.configDependencies]))}if(r.slot&&(this.slot=r.slot),s.layout&&(this._unevaluatedLayout=new Lu(s.layout,this.scope,_),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new Cf(s.paint,this.scope,_);for(const x in r.paint)this.setPaintProperty(x,r.paint[x]);for(const x in r.layout)this.setLayoutProperty(x,r.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ql(s.paint)}}}onAdd(r){}onRemove(r){}isDraped(r){return!this.is3D(!0)&&_v.has(this.type)}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s){if(this.type==="custom"&&r==="visibility")return void(this.visibility=s);const h=this._unevaluatedLayout;h._properties.properties[r]&&(h.setValue(r,s),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),r==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(r){return r.endsWith(Yy)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s){const h=this._transitionablePaint,p=h._properties.properties;if(r.endsWith(Yy)){const j=r.slice(0,-11);return p[j]&&h.setTransition(j,s||void 0),!1}if(!p[r])return!1;const _=h._values[r],x=_.value.isDataDriven(),E=_.value;h.setValue(r,s),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(r);const O=h._values[r].value,R=O.isDataDriven(),z=r.endsWith("pattern")||r==="line-dasharray";return R||x||z||this._handleOverridablePaintPropertyUpdate(r,E,O)}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getDefaultProgramParams(r,s,h){return null}_handleOverridablePaintPropertyUpdate(r,s,h){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){return Mr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((r,s)=>!(r===void 0||s==="layout"&&!Object.keys(r).length||s==="paint"&&!Object.keys(r).length)))}is3D(r){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof bd&&Rh(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(r){this._filterCompiled||(this._featureFilter=Sd(this.filter,this.scope,r),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(r){this._stats&&(r.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(r){}queryIntersectsFeature(r,s,h,p,_,x,E,O,R){}}const $0={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Rf{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ki{constructor(){this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&s.add(r.arrayBuffer),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...r){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...r){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ur(l,r=1){let s=0,h=0;return{members:l.map((p=>{const _=$0[p.type].BYTES_PER_ELEMENT,x=s=If(s,Math.max(r,_)),E=p.components||1;return h=Math.max(h,_),s+=_*E,{name:p.name,type:p.type,components:E,offset:x}})),size:If(s,Math.max(h,r)),alignment:r}}function If(l,r){return Math.ceil(l/r)*r}class Rs extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const h=this.length;return this.resize(h+1),this.emplace(h,r,s)}emplace(r,s,h){const p=2*r;return this.int16[p+0]=s,this.int16[p+1]=h,r}}Rs.prototype.bytesPerElement=4,Rn(Rs,"StructArrayLayout2i4");class Td extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,h)}emplace(r,s,h,p){const _=3*r;return this.int16[_+0]=s,this.int16[_+1]=h,this.int16[_+2]=p,r}}Td.prototype.bytesPerElement=6,Rn(Td,"StructArrayLayout3i6");class Nu extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,h,p)}emplace(r,s,h,p,_){const x=4*r;return this.int16[x+0]=s,this.int16[x+1]=h,this.int16[x+2]=p,this.int16[x+3]=_,r}}Nu.prototype.bytesPerElement=8,Rn(Nu,"StructArrayLayout4i8");class kh extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}kh.prototype.bytesPerElement=4,Rn(kh,"StructArrayLayout1f4");class bg extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,h)}emplace(r,s,h,p){const _=4*r,x=2*r;return this.int16[_+0]=s,this.int16[_+1]=h,this.float32[x+1]=p,r}}bg.prototype.bytesPerElement=8,Rn(bg,"StructArrayLayout2i1f8");class Ky extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,h)}emplace(r,s,h,p){const _=4*r;return this.int16[_+0]=s,this.int16[_+1]=h,this.int16[_+2]=p,r}}Ky.prototype.bytesPerElement=8,Rn(Ky,"StructArrayLayout3i8");class zu extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,h,p,_)}emplace(r,s,h,p,_,x){const E=5*r;return this.int16[E+0]=s,this.int16[E+1]=h,this.int16[E+2]=p,this.int16[E+3]=_,this.int16[E+4]=x,r}}zu.prototype.bytesPerElement=10,Rn(zu,"StructArrayLayout5i10");class Lh extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,r,s,h,p,_,x,E)}emplace(r,s,h,p,_,x,E,O){const R=6*r,z=12*r,j=3*r;return this.int16[R+0]=s,this.int16[R+1]=h,this.uint8[z+4]=p,this.uint8[z+5]=_,this.uint8[z+6]=x,this.uint8[z+7]=E,this.float32[j+2]=O,r}}Lh.prototype.bytesPerElement=12,Rn(Lh,"StructArrayLayout2i4ub1f12");class Is extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,h)}emplace(r,s,h,p){const _=3*r;return this.float32[_+0]=s,this.float32[_+1]=h,this.float32[_+2]=p,r}}Is.prototype.bytesPerElement=12,Rn(Is,"StructArrayLayout3f12");class ec extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,h,p,_)}emplace(r,s,h,p,_,x){const E=6*r,O=3*r;return this.uint16[E+0]=s,this.uint16[E+1]=h,this.uint16[E+2]=p,this.uint16[E+3]=_,this.float32[O+2]=x,r}}ec.prototype.bytesPerElement=12,Rn(ec,"StructArrayLayout4ui1f12");class ju extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,h,p)}emplace(r,s,h,p,_){const x=4*r;return this.uint16[x+0]=s,this.uint16[x+1]=h,this.uint16[x+2]=p,this.uint16[x+3]=_,r}}ju.prototype.bytesPerElement=8,Rn(ju,"StructArrayLayout4ui8");class em extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,r,s,h,p,_,x)}emplace(r,s,h,p,_,x,E){const O=6*r;return this.int16[O+0]=s,this.int16[O+1]=h,this.int16[O+2]=p,this.int16[O+3]=_,this.int16[O+4]=x,this.int16[O+5]=E,r}}em.prototype.bytesPerElement=12,Rn(em,"StructArrayLayout6i12");class tm extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R,z,j,B){const X=this.length;return this.resize(X+1),this.emplace(X,r,s,h,p,_,x,E,O,R,z,j,B)}emplace(r,s,h,p,_,x,E,O,R,z,j,B,X){const Z=12*r;return this.int16[Z+0]=s,this.int16[Z+1]=h,this.int16[Z+2]=p,this.int16[Z+3]=_,this.uint16[Z+4]=x,this.uint16[Z+5]=E,this.uint16[Z+6]=O,this.uint16[Z+7]=R,this.int16[Z+8]=z,this.int16[Z+9]=j,this.int16[Z+10]=B,this.int16[Z+11]=X,r}}tm.prototype.bytesPerElement=24,Rn(tm,"StructArrayLayout4i4ui4i24");class Ec extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,r,s,h,p,_,x)}emplace(r,s,h,p,_,x,E){const O=10*r,R=5*r;return this.int16[O+0]=s,this.int16[O+1]=h,this.int16[O+2]=p,this.float32[R+2]=_,this.float32[R+3]=x,this.float32[R+4]=E,r}}Ec.prototype.bytesPerElement=20,Rn(Ec,"StructArrayLayout3i3f20");class Bu extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,h,p)}emplace(r,s,h,p,_){const x=4*r;return this.float32[x+0]=s,this.float32[x+1]=h,this.float32[x+2]=p,this.float32[x+3]=_,r}}Bu.prototype.bytesPerElement=16,Rn(Bu,"StructArrayLayout4f16");class ml extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}ml.prototype.bytesPerElement=4,Rn(ml,"StructArrayLayout1ul4");class Qo extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const h=this.length;return this.resize(h+1),this.emplace(h,r,s)}emplace(r,s,h){const p=2*r;return this.uint16[p+0]=s,this.uint16[p+1]=h,r}}Qo.prototype.bytesPerElement=4,Rn(Qo,"StructArrayLayout2ui4");class nu extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R,z,j,B,X){const Z=this.length;return this.resize(Z+1),this.emplace(Z,r,s,h,p,_,x,E,O,R,z,j,B,X)}emplace(r,s,h,p,_,x,E,O,R,z,j,B,X,Z){const ae=20*r,se=10*r;return this.int16[ae+0]=s,this.int16[ae+1]=h,this.int16[ae+2]=p,this.int16[ae+3]=_,this.int16[ae+4]=x,this.float32[se+3]=E,this.float32[se+4]=O,this.float32[se+5]=R,this.float32[se+6]=z,this.int16[ae+14]=j,this.uint32[se+8]=B,this.uint16[ae+18]=X,this.uint16[ae+19]=Z,r}}nu.prototype.bytesPerElement=40,Rn(nu,"StructArrayLayout5i4f1i1ul2ui40");class nm extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,r,s,h,p,_,x,E)}emplace(r,s,h,p,_,x,E,O){const R=8*r;return this.int16[R+0]=s,this.int16[R+1]=h,this.int16[R+2]=p,this.int16[R+4]=_,this.int16[R+5]=x,this.int16[R+6]=E,this.int16[R+7]=O,r}}nm.prototype.bytesPerElement=16,Rn(nm,"StructArrayLayout3i2i2i16");class Dl extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,h,p,_)}emplace(r,s,h,p,_,x){const E=4*r,O=8*r;return this.float32[E+0]=s,this.float32[E+1]=h,this.float32[E+2]=p,this.int16[O+6]=_,this.int16[O+7]=x,r}}Dl.prototype.bytesPerElement=16,Rn(Dl,"StructArrayLayout2f1f2i16");class gl extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,r,s,h,p,_,x)}emplace(r,s,h,p,_,x,E){const O=20*r,R=5*r;return this.uint8[O+0]=s,this.uint8[O+1]=h,this.float32[R+1]=p,this.float32[R+2]=_,this.float32[R+3]=x,this.float32[R+4]=E,r}}gl.prototype.bytesPerElement=20,Rn(gl,"StructArrayLayout2ub4f20");class Zr extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,h){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,h)}emplace(r,s,h,p){const _=3*r;return this.uint16[_+0]=s,this.uint16[_+1]=h,this.uint16[_+2]=p,r}}Zr.prototype.bytesPerElement=6,Rn(Zr,"StructArrayLayout3ui6");class Fu extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be,Ee,Ge){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be,Ee,Ge)}emplace(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be,Ee,Ge,Ue){const $e=30*r,Je=15*r,it=60*r;return this.int16[$e+0]=s,this.int16[$e+1]=h,this.int16[$e+2]=p,this.float32[Je+2]=_,this.float32[Je+3]=x,this.uint16[$e+8]=E,this.uint16[$e+9]=O,this.uint32[Je+5]=R,this.uint32[Je+6]=z,this.uint32[Je+7]=j,this.uint16[$e+16]=B,this.uint16[$e+17]=X,this.uint16[$e+18]=Z,this.float32[Je+10]=ae,this.float32[Je+11]=se,this.uint8[it+48]=pe,this.uint8[it+49]=we,this.uint8[it+50]=be,this.uint32[Je+13]=Ee,this.int16[$e+28]=Ge,this.uint8[it+58]=Ue,r}}Fu.prototype.bytesPerElement=60,Rn(Fu,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class rm extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be,Ee,Ge,Ue,$e,Je,it,Mt,ut,Dt,ln,Vt,Yt,on,At){const Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be,Ee,Ge,Ue,$e,Je,it,Mt,ut,Dt,ln,Vt,Yt,on,At)}emplace(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be,Ee,Ge,Ue,$e,Je,it,Mt,ut,Dt,ln,Vt,Yt,on,At,Kt){const pt=20*r,Ct=40*r,un=80*r;return this.float32[pt+0]=s,this.float32[pt+1]=h,this.int16[Ct+4]=p,this.int16[Ct+5]=_,this.int16[Ct+6]=x,this.int16[Ct+7]=E,this.int16[Ct+8]=O,this.int16[Ct+9]=R,this.int16[Ct+10]=z,this.int16[Ct+11]=j,this.int16[Ct+12]=B,this.uint16[Ct+13]=X,this.uint16[Ct+14]=Z,this.uint16[Ct+15]=ae,this.uint16[Ct+16]=se,this.uint16[Ct+17]=pe,this.uint16[Ct+18]=we,this.uint16[Ct+19]=be,this.uint16[Ct+20]=Ee,this.uint16[Ct+21]=Ge,this.uint16[Ct+22]=Ue,this.uint16[Ct+23]=$e,this.uint16[Ct+24]=Je,this.uint16[Ct+25]=it,this.uint16[Ct+26]=Mt,this.uint16[Ct+27]=ut,this.uint32[pt+14]=Dt,this.float32[pt+15]=ln,this.float32[pt+16]=Vt,this.float32[pt+17]=Yt,this.float32[pt+18]=on,this.uint8[un+76]=At,this.uint16[Ct+39]=Kt,r}}rm.prototype.bytesPerElement=80,Rn(rm,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class im extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x){const E=this.length;return this.resize(E+1),this.emplace(E,r,s,h,p,_,x)}emplace(r,s,h,p,_,x,E){const O=6*r;return this.float32[O+0]=s,this.float32[O+1]=h,this.float32[O+2]=p,this.float32[O+3]=_,this.float32[O+4]=x,this.float32[O+5]=E,r}}im.prototype.bytesPerElement=24,Rn(im,"StructArrayLayout6f24");class Nh extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,h,p,_)}emplace(r,s,h,p,_,x){const E=5*r;return this.float32[E+0]=s,this.float32[E+1]=h,this.float32[E+2]=p,this.float32[E+3]=_,this.float32[E+4]=x,r}}Nh.prototype.bytesPerElement=20,Rn(Nh,"StructArrayLayout5f20");class wg extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,r,s,h,p,_,x,E)}emplace(r,s,h,p,_,x,E,O){const R=7*r;return this.float32[R+0]=s,this.float32[R+1]=h,this.float32[R+2]=p,this.float32[R+3]=_,this.float32[R+4]=x,this.float32[R+5]=E,this.float32[R+6]=O,r}}wg.prototype.bytesPerElement=28,Rn(wg,"StructArrayLayout7f28");class Ac extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R,z,j){const B=this.length;return this.resize(B+1),this.emplace(B,r,s,h,p,_,x,E,O,R,z,j)}emplace(r,s,h,p,_,x,E,O,R,z,j,B){const X=11*r;return this.float32[X+0]=s,this.float32[X+1]=h,this.float32[X+2]=p,this.float32[X+3]=_,this.float32[X+4]=x,this.float32[X+5]=E,this.float32[X+6]=O,this.float32[X+7]=R,this.float32[X+8]=z,this.float32[X+9]=j,this.float32[X+10]=B,r}}Ac.prototype.bytesPerElement=44,Rn(Ac,"StructArrayLayout11f44");class Df extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R){const z=this.length;return this.resize(z+1),this.emplace(z,r,s,h,p,_,x,E,O,R)}emplace(r,s,h,p,_,x,E,O,R,z){const j=9*r;return this.float32[j+0]=s,this.float32[j+1]=h,this.float32[j+2]=p,this.float32[j+3]=_,this.float32[j+4]=x,this.float32[j+5]=E,this.float32[j+6]=O,this.float32[j+7]=R,this.float32[j+8]=z,r}}Df.prototype.bytesPerElement=36,Rn(Df,"StructArrayLayout9f36");class Vu extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const h=this.length;return this.resize(h+1),this.emplace(h,r,s)}emplace(r,s,h){const p=2*r;return this.float32[p+0]=s,this.float32[p+1]=h,r}}Vu.prototype.bytesPerElement=8,Rn(Vu,"StructArrayLayout2f8");class Sg extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,h,p){const _=this.length;return this.resize(_+1),this.emplace(_,r,s,h,p)}emplace(r,s,h,p,_){const x=6*r;return this.uint32[3*r+0]=s,this.uint16[x+2]=h,this.uint16[x+3]=p,this.uint16[x+4]=_,r}}Sg.prototype.bytesPerElement=12,Rn(Sg,"StructArrayLayout1ul3ui12");class Tg extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}Tg.prototype.bytesPerElement=2,Rn(Tg,"StructArrayLayout1ui2");class Ed extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se){const pe=this.length;return this.resize(pe+1),this.emplace(pe,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se)}emplace(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe){const we=16*r;return this.float32[we+0]=s,this.float32[we+1]=h,this.float32[we+2]=p,this.float32[we+3]=_,this.float32[we+4]=x,this.float32[we+5]=E,this.float32[we+6]=O,this.float32[we+7]=R,this.float32[we+8]=z,this.float32[we+9]=j,this.float32[we+10]=B,this.float32[we+11]=X,this.float32[we+12]=Z,this.float32[we+13]=ae,this.float32[we+14]=se,this.float32[we+15]=pe,r}}Ed.prototype.bytesPerElement=64,Rn(Ed,"StructArrayLayout16f64");class Ad extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,h,p,_,x,E){const O=this.length;return this.resize(O+1),this.emplace(O,r,s,h,p,_,x,E)}emplace(r,s,h,p,_,x,E,O){const R=10*r,z=5*r;return this.uint16[R+0]=s,this.uint16[R+1]=h,this.uint16[R+2]=p,this.uint16[R+3]=_,this.float32[z+2]=x,this.float32[z+3]=E,this.float32[z+4]=O,r}}Ad.prototype.bytesPerElement=20,Rn(Ad,"StructArrayLayout4ui3f20");class am extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.int16[1*r+0]=s,r}}am.prototype.bytesPerElement=2,Rn(am,"StructArrayLayout1i2");class om extends ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint8[1*r+0]=s,r}}om.prototype.bytesPerElement=1,Rn(om,"StructArrayLayout1ub1");class Eg extends Rf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Eg.prototype.size=40;class vv extends nu{get(r){return new Eg(this,r)}}Rn(vv,"CollisionBoxArray");class sm extends Rf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}sm.prototype.size=60;class To extends Fu{get(r){return new sm(this,r)}}Rn(To,"PlacedSymbolArray");class es extends Rf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(r){this._structArray.uint32[this._pos4+14]=r}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(r){this._structArray.float32[this._pos4+18]=r}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}es.prototype.size=80;class Jy extends rm{get(r){return new es(this,r)}}Rn(Jy,"SymbolInstanceArray");class Ag extends kh{getoffsetX(r){return this.float32[1*r+0]}}Rn(Ag,"GlyphOffsetArray");class Qy extends Rs{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}Rn(Qy,"SymbolLineVertexArray");class lm extends Rf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}lm.prototype.size=12;class e_ extends Sg{get(r){return new lm(this,r)}}Rn(e_,"FeatureIndexArray");class cm extends Qo{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}Rn(cm,"FillExtrusionCentroidArray");class Cg extends Rf{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Cg.prototype.size=6;class t_ extends Td{get(r){return new Cg(this,r)}}Rn(t_,"FillExtrusionWallArray");const n_=Ur([{name:"a_pos",components:2,type:"Int16"}],4),xv=Ur([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),r_=Ur([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ki{constructor(r=[]){this.segments=r}_prepareSegment(r,s,h,p){let _=this.segments[this.segments.length-1];return r>Ki.MAX_VERTEX_ARRAY_LENGTH&&jr(`Max vertices per segment is ${Ki.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!_||_.vertexLength+r>Ki.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:s,primitiveOffset:h,vertexLength:0,primitiveLength:0},p!==void 0&&(_.sortKey=p),this.segments.push(_)),_}prepareSegment(r,s,h,p){return this._prepareSegment(r,s.length,h.length,p)}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,h,p){return new Ki([{vertexOffset:r,primitiveOffset:s,vertexLength:h,primitiveLength:p,vaos:{},sortKey:0}])}}function Mg(l,r){return 256*(l=Pe(Math.floor(l),0,255))+Pe(Math.floor(r),0,255)}Ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn(Ki,"SegmentVector");const bv=Ur([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),um=Ur([{name:"a_pattern_b",components:4,type:"Uint16"}]),Pg=Ur([{name:"a_dash",components:4,type:"Uint16"}]);class Cd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(r,s,h,p){this.ids.push(kf(r)),this.positions.push(s,h,p)}eachPosition(r,s){const h=kf(r);let p=0,_=this.ids.length-1;for(;p<_;){const x=p+_>>1;this.ids[x]>=h?_=x:p=x+1}for(;this.ids[p]===h;)s(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(r,s){const h=new Float64Array(r.ids),p=new Uint32Array(r.positions);return hm(h,p,0,h.length-1),s&&(s.add(h.buffer),s.add(p.buffer)),{ids:h,positions:p}}static deserialize(r){const s=new Cd;let h;s.ids=r.ids,s.positions=r.positions;for(const p of s.ids)p!==h&&s.uniqueIds.push(p),h=p;return s.indexed=!0,s}}function kf(l){const r=+l;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:Vc(String(l))}function hm(l,r,s,h){for(;s<h;){const p=l[s+h>>1];let _=s-1,x=h+1;for(;;){do _++;while(l[_]<p);do x--;while(l[x]>p);if(_>=x)break;dm(l,_,x),dm(r,3*_,3*x),dm(r,3*_+1,3*x+1),dm(r,3*_+2,3*x+2)}x-s<h-x?(hm(l,r,s,x),s=x+1):(hm(l,r,x+1,h),h=x)}}function dm(l,r,s){const h=l[r];l[r]=l[s],l[s]=h}Rn(Cd,"FeaturePositionMap");class Bo{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,s),this.initialized=!0),!!this.location}set(r,s,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Lf extends Bo{constructor(r){super(r),this.current=0}set(r,s,h){this.fetchUniformLocation(r,s)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class Ba extends Bo{constructor(r){super(r),this.current=0}set(r,s,h){this.fetchUniformLocation(r,s)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Cc extends Bo{constructor(r){super(r),this.current=[0,0]}set(r,s,h){this.fetchUniformLocation(r,s)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class yl extends Bo{constructor(r){super(r),this.current=[0,0,0]}set(r,s,h){this.fetchUniformLocation(r,s)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class Nf extends Bo{constructor(r){super(r),this.current=[0,0,0,0]}set(r,s,h){this.fetchUniformLocation(r,s)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class zf extends Bo{constructor(r){super(r),this.current=pi.transparent.toPremultipliedRenderColor(null)}set(r,s,h){this.fetchUniformLocation(r,s)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const jf=new Float32Array(16);class Fa extends Bo{constructor(r){super(r),this.current=jf}set(r,s,h){if(this.fetchUniformLocation(r,s)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let p=1;p<16;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const q0=new Float32Array(9),wv=new Float32Array(4);class Og extends Bo{constructor(r){super(r),this.current=wv}set(r,s,h){if(this.fetchUniformLocation(r,s)){for(let p=0;p<4;p++)if(h[p]!==this.current[p]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function Md(l){return[Mg(255*l.r,255*l.g),Mg(255*l.b,255*l.a)]}class tc{constructor(r,s,h,p){this.value=r,this.uniformNames=s.map((_=>`u_${_}`)),this.type=h,this.context=p}setUniform(r,s,h,p,_){const x=p.constantOr(this.value);s.set(r,_,x instanceof pi?x.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):x)}getBinding(r,s){return this.type==="color"?new zf(r):new Ba(r)}}class Pd{constructor(r,s){this.uniformNames=s.map((h=>`u_${h}`)),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(r,s){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br),this.patternTransition=s?s.tl.concat(s.br):this.pattern}setUniform(r,s,h,p,_){let x=null;_!=="u_pattern"&&_!=="u_dash"||(x=this.pattern),_==="u_pattern_b"&&(x=this.patternTransition),_==="u_pixel_ratio"&&(x=this.pixelRatio),x&&s.set(r,_,x)}getBinding(r,s){return s==="u_pattern"||s==="u_pattern_b"||s==="u_dash"?new Nf(r):new Ba(r)}}class ru{constructor(r,s,h,p){this.expression=r,this.type=h,this.maxValue=0,this.paintVertexAttributes=s.map((_=>({name:`a_${_}`,type:"Float32",components:h==="color"?2:1,offset:0}))),this.paintVertexArray=new p}populatePaintArray(r,s,h,p,_,x,E,O){const R=this.paintVertexArray.length,z=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new Ei(0,{brightness:x,worldview:O}),s,{},_,p,E):this.expression.kind==="constant"&&this.expression.value,j=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ei(0,{brightness:x,worldview:O}),s,{},_,p,E):this.lutExpression.value)==="none";this.paintVertexArray.resize(r),this._setPaintValue(R,r,z,j?null:this.context.lut)}updatePaintArray(r,s,h,p,_,x,E,O){const R=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:E,worldview:O},h,p,void 0,_):this.expression.kind==="constant"&&this.expression.value,z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ei(0,{brightness:E,worldview:O}),h,p,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(r,s,R,z?null:this.context.lut)}_setPaintValue(r,s,h,p){if(this.type==="color"){const _=Md(h.toPremultipliedRenderColor(p));for(let x=r;x<s;x++)this.paintVertexArray.emplace(x,_[0],_[1])}else{for(let _=r;_<s;_++)this.paintVertexArray.emplace(_,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ds{constructor(r,s,h,p,_,x){this.expression=r,this.uniformNames=s.map((E=>`u_${E}_t`)),this.type=h,this.useIntegerZoom=p,this.context=_,this.maxValue=0,this.paintVertexAttributes=s.map((E=>({name:`a_${E}`,type:"Float32",components:h==="color"?4:2,offset:0}))),this.paintVertexArray=new x}populatePaintArray(r,s,h,p,_,x,E,O){const R=this.expression.evaluate(new Ei(this.context.zoom,{brightness:x,worldview:O}),s,{},_,p,E),z=this.expression.evaluate(new Ei(this.context.zoom+1,{brightness:x,worldview:O}),s,{},_,p,E),j=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ei(0,{brightness:x,worldview:O}),s,{},_,p,E):this.lutExpression.value)==="none",B=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(B,r,R,z,j?null:this.context.lut)}updatePaintArray(r,s,h,p,_,x,E,O){const R=this.expression.evaluate({zoom:this.context.zoom,brightness:E,worldview:O},h,p,void 0,_),z=this.expression.evaluate({zoom:this.context.zoom+1,brightness:E,worldview:O},h,p,void 0,_),j=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new Ei(0,{brightness:E,worldview:O}),h,p,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(r,s,R,z,j?null:this.context.lut)}_setPaintValue(r,s,h,p,_){if(this.type==="color"){const x=Md(h.toPremultipliedRenderColor(_)),E=Md(h.toPremultipliedRenderColor(_));for(let O=r;O<s;O++)this.paintVertexArray.emplace(O,x[0],x[1],E[0],E[1])}else{for(let x=r;x<s;x++)this.paintVertexArray.emplace(x,h,p);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s,h,p,_){const x=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,E=Pe(this.expression.interpolationFactor(x,this.context.zoom,this.context.zoom+1),0,1);s.set(r,_,E)}getBinding(r,s){return new Ba(r)}}class Eo{constructor(r,s,h,p,_){this.expression=r,this.layerId=_,this.paintVertexAttributes=(h==="array"?Pg:bv).members;for(let x=0;x<s.length;++x);this.paintVertexArray=new p,this.paintTransitionVertexArray=new ju}populatePaintArray(r,s,h,p){const _=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(_,r,s.patterns&&s.patterns[this.layerId],h)}updatePaintArray(r,s,h,p,_,x,E){this._setPaintValues(r,s,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(r,s,h,p){if(!p||!h)return;const _=p[h[0]],x=p[h[1]];if(_){if(_){const{tl:E,br:O,pixelRatio:R}=_;for(let z=r;z<s;z++)this.paintVertexArray.emplace(z,E[0],E[1],O[0],O[1],R)}if(x){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:E,br:O}=x;for(let R=r;R<s;R++)this.paintTransitionVertexArray.emplace(R,E[0],E[1],O[0],O[1])}}}upload(r){const s=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,s)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=r.createVertexBuffer(this.paintTransitionVertexArray,um.members,s))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class xs{constructor(r,s,h=(()=>!0)){this.binders={},this._buffers=[],this.context=s;const p=[];for(const _ in r.paint._values){const x=r.paint.get(_);if(_.endsWith("-use-theme")||!h(_)||!(x instanceof bd&&Rh(x.property.specification)))continue;const E=i_(_,r.type),O=x.value,R=x.property.specification.type,z=!!x.property.useIntegerZoom,j=_==="line-dasharray"||_.endsWith("pattern"),B=r.paint.get(`${_}-use-theme`),X=_==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant"||B&&B.value.kind!=="constant";if(O.kind!=="constant"||X)if(O.kind==="source"||X||j){const Z=o_(_,R,"source");this.binders[_]=j?new Eo(O,E,R,Z,r.id):new ru(O,E,R,Z),p.push(`/a_${_}`)}else{const Z=o_(_,R,"composite");this.binders[_]=new Ds(O,E,R,z,s,Z),p.push(`/z_${_}`)}else this.binders[_]=j?new Pd(O.value,E):new tc(O.value,E,R,s),p.push(`/u_${_}`);B&&(this.binders[_].lutExpression=B.value)}this.cacheKey=p.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof ru||s instanceof Ds?s.maxValue:0}populatePaintArrays(r,s,h,p,_,x,E,O){for(const R in this.binders){const z=this.binders[R];z.context=this.context,(z instanceof ru||z instanceof Ds||z instanceof Eo)&&z.populatePaintArray(r,s,h,p,_,x,E,O)}}setConstantPatternPositions(r,s){for(const h in this.binders){const p=this.binders[h];p instanceof Pd&&p.setConstantPatternPositions(r,s)}}getPatternTransitionVertexBuffer(r){const s=this.binders[r];return s instanceof Eo?s.paintTransitionVertexBuffer:null}updatePaintArrays(r,s,h,p,_,x,E,O,R,z){let j=!1;const B=Object.keys(r),X=B.length!==0&&!O,Z=X?B:s.uniqueIds;this.context.lut=_.lut;for(const ae in this.binders){const se=this.binders[ae];if(se.context=this.context,(se instanceof ru||se instanceof Ds||se instanceof Eo)&&se.expression&&se.expression.kind&&se.expression.kind!=="constant"&&(se.expression.isStateDependent===!0||se.expression.isLightConstant===!1)){const pe=_.paint.get(ae);se.expression=pe.value;for(const we of Z){const be=r[we.toString()];s.eachPosition(we,((Ee,Ge,Ue)=>{const $e=p.feature(Ee);se.updatePaintArray(Ge,Ue,$e,be,x,E,R,z)}))}if(!X)for(const we of h.uniqueIds){const be=r[we.toString()];h.eachPosition(we,((Ee,Ge,Ue)=>{const $e=p.feature(Ee);se.updatePaintArray(Ge,Ue,$e,be,x,E,R,z)}))}j=!0}}return j}defines(){const r=[];for(const s in this.binders){const h=this.binders[s];(h instanceof tc||h instanceof Pd)&&r.push(...h.uniformNames.map((p=>`#define HAS_UNIFORM_${p}`)))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof ru||h instanceof Ds||h instanceof Eo)for(let p=0;p<h.paintVertexAttributes.length;p++)r.push(h.paintVertexAttributes[p].name);if(h instanceof Eo)for(let p=0;p<um.members.length;p++)r.push(um.members[p].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof tc||h instanceof Pd||h instanceof Ds)for(const p of h.uniformNames)r.push(p)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const s=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof tc||p instanceof Pd||p instanceof Ds)for(const _ of p.uniformNames)s.push({name:_,property:h,binding:p.getBinding(r,_)})}return s}setUniforms(r,s,h,p,_){for(const{name:x,property:E,binding:O}of h)this.binders[E].setUniform(r,O,_,p.get(E),x)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const s=this.binders[r];(s instanceof ru||s instanceof Ds||s instanceof Eo)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer),s instanceof Eo&&s.paintTransitionVertexBuffer&&this._buffers.push(s.paintTransitionVertexBuffer)}}upload(r){for(const s in this.binders){const h=this.binders[s];(h instanceof ru||h instanceof Ds||h instanceof Eo)&&h.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof ru||s instanceof Ds||s instanceof Eo)&&s.destroy()}}}class Ks{constructor(r,s,h=(()=>!0)){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new xs(p,s,h);this.needsUpload=!1,this._featureMap=new Cd,this._featureMapWithoutIds=new Cd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(r,s,h,p,_,x,E,O,R){for(const z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(r,s,p,_,x,E,O,R);s.id!==void 0?this._featureMap.add(s.id,h,this._bufferOffset,r):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,r),this._idlessCounter+=1),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,h,p,_,x,E,O){for(const R of h)this.needsUpload=this.programConfigurations[R.id].updatePaintArrays(r,this._featureMap,this._featureMapWithoutIds,s,R,p,_,x,E||0,O)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const Sv={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function i_(l,r){return Sv[l]||[l.replace(`${r}-`,"").replace(/-/g,"_")]}const a_={"line-pattern":{source:ec,composite:ec},"fill-pattern":{source:ec,composite:ec},"fill-extrusion-pattern":{source:ec,composite:ec},"line-dasharray":{source:ju,composite:ju}},Rg={color:{source:Vu,composite:Bu},number:{source:kh,composite:Vu}};function o_(l,r,s){const h=a_[l];return h&&h[s]||Rg[r][s]}Rn(tc,"ConstantBinder"),Rn(Pd,"PatternConstantBinder"),Rn(ru,"SourceExpressionBinder"),Rn(Eo,"PatternCompositeBinder"),Rn(Ds,"CompositeExpressionBinder"),Rn(xs,"ProgramConfiguration",{omit:["_buffers"]}),Rn(Ks,"ProgramConfigurationSet");const Za=nn/Math.PI/2,Ao=5,g=6,o=16383,u=64,y=[u,32,16],b=-Za,T=Za;function C(l,r,s,h=Za){return s=hr(s),[l*Math.sin(s)*h,-r*h,l*Math.cos(s)*h]}function I(l,r,s){return C(Math.cos(hr(l)),Math.sin(hr(l)),r,s)}const L=63710088e-1,F=2*Math.PI*L;class U{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new U(wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,h=this.lat*s,p=r.lat*s,_=Math.sin(h)*Math.sin(p)+Math.cos(h)*Math.cos(p)*Math.cos((r.lng-this.lng)*s);return L*Math.acos(Math.min(_,1))}toBounds(r=0){const s=360*r/40075017,h=s/Math.cos(Math.PI/180*this.lat);return new Y({lng:this.lng-h,lat:this.lat-s},{lng:this.lng+h,lat:this.lat+s})}toEcef(r){return I(this.lat,this.lng,Za+r*Za/L)}static convert(r){if(r instanceof U)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new U(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new U(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Y{constructor(r,s){if(r)if(s)this.setSouthWest(r).setNorthEast(s);else if(r.length===4){const h=r;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=r;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(r){return this._ne=r instanceof U?new U(r.lng,r.lat):U.convert(r),this}setSouthWest(r){return this._sw=r instanceof U?new U(r.lng,r.lat):U.convert(r),this}extend(r){const s=this._sw,h=this._ne;let p,_;if(r instanceof U)p=r,_=r;else{if(!(r instanceof Y))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Y.convert(r)):this.extend(U.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(U.convert(r)):this;if(p=r._sw,_=r._ne,!p||!_)return this}return s||h?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),h.lng=Math.max(_.lng,h.lng),h.lat=Math.max(_.lat,h.lat)):(this._sw=new U(p.lng,p.lat),this._ne=new U(_.lng,_.lat)),this}getCenter(){return new U((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new U(this.getWest(),this.getNorth())}getSouthEast(){return new U(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:s,lat:h}=U.convert(r);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(r){if(r)return r instanceof Y?r:new Y(r)}}const W=0,Q=25.5;function le(l){return F*Math.cos(l*Math.PI/180)}function oe(l){return(180+l)/360}function ue(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function de(l,r){return l/le(r)}function xe(l){return 360*l-180}function Te(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Me(l,r){return l*le(Te(r))}const ke=85.051129;function Fe(l){return Math.cos(hr(Pe(l,-ke,ke)))}function Ve(l,r){const s=Pe(r,W,Q),h=Math.pow(2,s);return Fe(l)*F/(512*h)}function Le(l){return 1/Math.cos(l*Math.PI/180)}function Ne(l,r=0){const s=Math.exp(Math.PI*(1-(l.y+r/nn)/(1<<l.z)*2));return 80150034*s/(s*s+1)/nn/(1<<l.z)}class je{constructor(r,s,h=0){this.x=+r,this.y=+s,this.z=+h}static fromLngLat(r,s=0){const h=U.convert(r);return new je(oe(h.lng),ue(h.lat),de(s,h.lat))}toLngLat(){return new U(xe(this.x),Te(this.y))}toAltitude(){return Me(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/F*Le(Te(this.y))}}function dt(l,r,s,h,p,_,x,E,O){const R=(r+h)/2,z=(s+p)/2,j=new kt(R,z);E(j),(function(B,X,Z,ae,se,pe){const we=Z-se,be=ae-pe;return Math.abs((ae-X)*we-(Z-B)*be)/Math.hypot(we,be)})(j.x,j.y,_.x,_.y,x.x,x.y)>=O?(dt(l,r,s,R,z,_,j,E,O),dt(l,R,z,h,p,j,x,E,O)):l.push(x)}function Ze(l,r,s){let h=l[0],p=h.x,_=h.y;r(h);const x=[h];for(let E=1;E<l.length;E++){const O=l[E],{x:R,y:z}=O;r(O),dt(x,p,_,R,z,h,O,r,s),p=R,_=z,h=O}return x}function Pt(l,r,s,h){if(h(r,s)){const p=r.add(s)._mult(.5);Pt(l,r,p,h),Pt(l,p,s,h)}else l.push(s)}function _t(l,r){let s=l[0];const h=[s];for(let p=1;p<l.length;p++){const _=l[p];Pt(h,s,_,r),s=_}return h}const Lt=Math.pow(2,14)-1,rn=-Lt-1;function ft(l,r){const s=Math.round(l.x*r),h=Math.round(l.y*r);return l.x=Pe(s,rn,Lt),l.y=Pe(h,rn,Lt),(s<l.x||s>l.x+1||h<l.y||h>l.y+1)&&jr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function We(l,r,s){const h=l.loadGeometry(),p=l.extent,_=nn/p;if(r&&s&&s.projection.isReprojectedInTileSpace){const x=1<<r.z,{scale:E,x:O,y:R,projection:z}=s,j=B=>{const X=xe((r.x+B.x/p)/x),Z=Te((r.y+B.y/p)/x),ae=z.project(X,Z);B.x=(ae.x*E-O)*p,B.y=(ae.y*E-R)*p};for(let B=0;B<h.length;B++)if(l.type!==1)h[B]=Ze(h[B],j,1);else{const X=[];for(const Z of h[B])Z.x<0||Z.x>=p||Z.y<0||Z.y>=p||(j(Z),X.push(Z));h[B]=X}}for(const x of h)for(const E of x)ft(E,_);return h}function Tt(l,r){return{type:l.type,id:l.id,properties:l.properties,geometry:r?We(l):[]}}class mt{constructor(r,s,h,p,_){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=p,this._values=_,r.readFields(It,this,s)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const s=r.readVarint()+r.pos,h=[];let p,_=1,x=0,E=0,O=0;for(;r.pos<s;){if(x<=0){const R=r.readVarint();_=7&R,x=R>>3}if(x--,_===1||_===2)E+=r.readSVarint(),O+=r.readSVarint(),_===1&&(p&&h.push(p),p=[]),p&&p.push(new kt(E,O));else{if(_!==7)throw new Error(`unknown command ${_}`);p&&p.push(p[0].clone())}}return p&&h.push(p),h}bbox(){const r=this._pbf;r.pos=this._geometry;const s=r.readVarint()+r.pos;let h=1,p=0,_=0,x=0,E=1/0,O=-1/0,R=1/0,z=-1/0;for(;r.pos<s;){if(p<=0){const j=r.readVarint();h=7&j,p=j>>3}if(p--,h===1||h===2)_+=r.readSVarint(),x+=r.readSVarint(),_<E&&(E=_),_>O&&(O=_),x<R&&(R=x),x>z&&(z=x);else if(h!==7)throw new Error(`unknown command ${h}`)}return[E,R,O,z]}toGeoJSON(r,s,h){const p=this.extent*Math.pow(2,h),_=this.extent*r,x=this.extent*s,E=this.loadGeometry();function O(B){return[360*(B.x+_)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(B.y+x)/p)*Math.PI))-90]}function R(B){return B.map(O)}let z;if(this.type===1){const B=[];for(const Z of E)B.push(Z[0]);const X=R(B);z=B.length===1?{type:"Point",coordinates:X[0]}:{type:"MultiPoint",coordinates:X}}else if(this.type===2){const B=E.map(R);z=B.length===1?{type:"LineString",coordinates:B[0]}:{type:"MultiLineString",coordinates:B}}else{if(this.type!==3)throw new Error("unknown feature type");{const B=(function(Z){const ae=Z.length;if(ae<=1)return[Z];const se=[];let pe,we;for(let be=0;be<ae;be++){const Ee=Nt(Z[be]);Ee!==0&&(we===void 0&&(we=Ee<0),we===Ee<0?(pe&&se.push(pe),pe=[Z[be]]):pe&&pe.push(Z[be]))}return pe&&se.push(pe),se})(E),X=[];for(const Z of B)X.push(Z.map(R));z=X.length===1?{type:"Polygon",coordinates:X[0]}:{type:"MultiPolygon",coordinates:X}}}const j={type:"Feature",geometry:z,properties:this.properties};return this.id!=null&&(j.id=this.id),j}}function It(l,r,s){l===1?r.id=s.readVarint():l===2?(function(h,p){const _=h.readVarint()+h.pos;for(;h.pos<_;){const x=p._keys[h.readVarint()],E=p._values[h.readVarint()];p.properties[x]=E}})(s,r):l===3?r.type=s.readVarint():l===4&&(r._geometry=s.pos)}function Nt(l){let r=0;for(let s,h,p=0,_=l.length,x=_-1;p<_;x=p++)s=l[p],h=l[x],r+=(h.x-s.x)*(s.y+h.y);return r}mt.types=["Unknown","Point","LineString","Polygon"];class Rt{constructor(r,s){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Ft,this,s),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const s=this._pbf.readVarint()+this._pbf.pos;return new mt(this._pbf,s,this.extent,this._keys,this._values)}}function Ft(l,r,s){l===15?r.version=s.readVarint():l===1?r.name=s.readString():l===5?r.extent=s.readVarint():l===2?r._features.push(s.pos):l===3?r._keys.push(s.readString()):l===4&&r._values.push((function(h){let p=null;const _=h.readVarint()+h.pos;for(;h.pos<_;){const x=h.readVarint()>>3;p=x===1?h.readString():x===2?h.readFloat():x===3?h.readDouble():x===4?h.readVarint64():x===5?h.readVarint():x===6?h.readSVarint():x===7?h.readBoolean():null}if(p==null)throw new Error("unknown feature value");return p})(s))}class gn{constructor(r,s){this.layers=r.readFields(Dn,{},s)}}function Dn(l,r,s){if(l===3){const h=new Rt(s,s.readVarint()+s.pos);h.length&&(r[h.name]=h)}}const xn="3d_elevation_id",zn="level";class Bn{constructor(){this._valid=!1}reset(r){return this.feature=r,this._valid=!0,this._geometry=r.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(r,s){return this._valid&&r(s(this._geometry)),this}require(r,s,h){return this.get(r,!0,s,h)}optional(r,s,h){return this.get(r,!1,s,h)}success(){return this._valid}get(r,s,h,p){const _=this.feature.properties.hasOwnProperty(r)?+this.feature.properties[r]:void 0;return this._valid&&_!==void 0&&!Number.isNaN(_)?h(p?p(_):_):s&&(this._valid=!1),this}}class Kn{constructor(r,s){this.featureFunc=r,this.vertexFunc=s}parseFeature(r,s,h){return this.featureFunc(r,s,h)}parseVertex(r,s,h){return this.vertexFunc(r,s,h)}}const Zn=new Kn(((l,r,s)=>l.reset(r).require(xn,(h=>{s.id=h})).optional("fixed_height_relative",(h=>{s.constantHeight=h}),$r.decodeRelativeHeight).geometry((h=>{s.bounds=h}),Py).success()),((l,r,s)=>l.reset(r).require(xn,(h=>{s.id=h})).require("elevation_idx",(h=>{s.idx=h})).require("extent",(h=>{s.extent=h})).require("height_relative",(h=>{s.height=h}),$r.decodeRelativeHeight).geometry((h=>{s.position=h}),$r.getPoint).success())),pr=new Kn(((l,r,s)=>l.reset(r).require(xn,(h=>{s.id=h})).optional("fixed_height",(h=>{s.constantHeight=h}),$r.decodeMetricHeight).geometry((h=>{s.bounds=h}),Py).success()),((l,r,s)=>l.reset(r).require(xn,(h=>{s.id=h})).require("elevation_idx",(h=>{s.idx=h})).require("extent",(h=>{s.extent=h})).require("height",(h=>{s.height=h}),$r.decodeMetricHeight).geometry((h=>{s.position=h}),$r.getPoint).success()));class $r{static getPoint(r){return Ua(r[0][0].x,r[0][0].y)}static decodeRelativeHeight(r){return 1e-4*r*5}static decodeMetricHeight(r){return 1e-4*r}static parse(r){const s=[],h=[],p=r.length,_=new Bn;for(let E=0;E<p;E++){const O=r.feature(E),R=O.properties.version,z=(x=R)?x==="1.0.1"?pr:void 0:Zn;if(z===void 0){jr(`Unknown elevation feature version number ${R||"(unknown)"}`);continue}const j=O.properties.hasOwnProperty("type")?O.properties.type:void 0;if(j){if(mt.types[O.type]==="Point"&&j==="curve_point"){const B={};z.parseVertex(_,O,B)&&s.push(B)}else if(mt.types[O.type]==="Polygon"&&j==="curve_meta"){const B={};z.parseFeature(_,O,B)&&h.push(B)}}}var x;return{vertices:s,features:h}}}class sr{constructor(r,s){this.pos=r,this.dir=s}intersectsPlane(r,s,h){const p=ir(s,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((r[0]-this.pos[0])*s[0]+(r[1]-this.pos[1])*s[1])/p;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,!0}}class kr{constructor(r,s){this.pos=r,this.dir=s}intersectsPlane(r,s,h){const p=Ht(s,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((r[0]-this.pos[0])*s[0]+(r[1]-this.pos[1])*s[1]+(r[2]-this.pos[2])*s[2])/p;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,h[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(r,s,h){if((function(X,Z){var ae=X[0],se=X[1],pe=X[2],we=Z[0],be=Z[1],Ee=Z[2];return Math.abs(ae-we)<=w*Math.max(1,Math.abs(ae),Math.abs(we))&&Math.abs(se-be)<=w*Math.max(1,Math.abs(se),Math.abs(be))&&Math.abs(pe-Ee)<=w*Math.max(1,Math.abs(pe),Math.abs(Ee))})(this.pos,r)||s===0)return h[0]=h[1]=h[2]=0,!1;const[p,_,x]=this.dir,E=this.pos[0]-r[0],O=this.pos[1]-r[1],R=this.pos[2]-r[2],z=p*p+_*_+x*x,j=2*(E*p+O*_+R*x),B=j*j-4*z*(E*E+O*O+R*R-s*s);if(B<0){const X=Math.max(-j/2,0),Z=E+p*X,ae=O+_*X,se=R+x*X,pe=Math.hypot(Z,ae,se);return h[0]=Z*s/pe,h[1]=ae*s/pe,h[2]=se*s/pe,!1}{const X=(-j-Math.sqrt(B))/(2*z);if(X<0){const Z=Math.hypot(E,O,R);return h[0]=E*s/Z,h[1]=O*s/Z,h[2]=R*s/Z,!1}return h[0]=E+p*X,h[1]=O+_*X,h[2]=R+x*X,!0}}}class Yr{constructor(r,s,h,p,_){this.TL=r,this.TR=s,this.BR=h,this.BL=p,this.horizon=_}static fromInvProjectionMatrix(r,s,h){const p=[-1,1,1],_=[1,1,1],x=[1,-1,1],E=[-1,-1,1],O=En(p,p,r),R=En(_,_,r),z=En(x,x,r),j=En(E,E,r);return new Yr(O,R,z,j,s/h)}}function wi(l,r,s){let h=1/0,p=-1/0;const _=[];for(const x of l){Cr(_,x,r);const E=Ht(_,s);h=Math.min(h,E),p=Math.max(p,E)}return[h,p]}function lr(l,r){let s=!0;for(let h=0;h<l.planes.length;h++){const p=l.planes[h];let _=0;for(let x=0;x<r.length;x++)_+=Ht(p,r[x])+p[3]>=0;if(_===0)return 0;_!==r.length&&(s=!1)}return s?2:1}function ei(l,r){for(const s of l.projections){const h=wi(r,l.points[0],s.axis);if(s.projection[1]<h[0]||s.projection[0]>h[1])return 0}return 1}function ri(l,r){let s=0;const h=[0,0,0,0];for(let x=0;x<l.length;x++)h[0]=l[x][0],h[1]=l[x][1],h[2]=l[x][2],h[3]=1,(p=h)[0]*(_=r)[0]+p[1]*_[1]+p[2]*_[2]+p[3]*_[3]>=0&&s++;var p,_;return s}class ai{constructor(r,s){this.points=r||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=br.fromPoints(this.points),this.projections=[],this.frustumEdges=[Cr([],this.points[2],this.points[3]),Cr([],this.points[0],this.points[3]),Cr([],this.points[4],this.points[0]),Cr([],this.points[5],this.points[1]),Cr([],this.points[6],this.points[2]),Cr([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const p=[0,-h[2],h[1]],_=[h[2],0,-h[0]];this.projections.push({axis:p,projection:wi(this.points,this.points[0],p)}),this.projections.push({axis:_,projection:wi(this.points,this.points[0],_)})}}static fromInvProjectionMatrix(r,s,h,p){const _=Math.pow(2,h),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((R=>{const z=Bt([],R,r),j=1/z[3]/s*_;return(B=z)[0]=(X=z)[0]*(Z=[j,j,p?1/z[3]:j,j])[0],B[1]=X[1]*Z[1],B[2]=X[2]*Z[2],B[3]=X[3]*Z[3],B;var B,X,Z})),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((R=>{const z=qt([],mn([],Cr([],x[R[0]],x[R[1]]),Cr([],x[R[2]],x[R[1]]))),j=-Ht(z,x[R[1]]);return z.concat(j)})),O=[];for(let R=0;R<x.length;R++)O.push([x[R][0],x[R][1],x[R][2]]);return new ai(O,E)}intersectsPrecise(r,s,h){for(let p=0;p<s.length;p++)if(!ri(r,s[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!ri(r,this.planes[p]))return 0;for(const p of h)for(const _ of this.frustumEdges){const x=mn([],p,_),E=at(x);if(E===0)continue;vt(x,x,1/E);const O=wi(this.points,this.points[0],x),R=wi(r,this.points[0],x);if(O[0]>R[1]||R[0]>O[1])return 0}return 1}containsPoint(r){for(const s of this.planes){const h=s[3];if(Ht([s[0],s[1],s[2]],r)+h<0)return!1}return!0}}class br{static fromPoints(r){const s=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const p of r)St(s,s,p),qe(h,h,p);return new br(s,h)}static fromTileIdAndHeight(r,s,h){const p=1<<r.canonical.z,_=r.canonical.x,x=r.canonical.y;return new br([_/p,x/p,s],[(_+1)/p,(x+1)/p,h])}static applyTransform(r,s){const h=r.getCorners();for(let p=0;p<h.length;++p)En(h[p],h[p],s);return br.fromPoints(h)}static applyTransformFast(r,s){const h=[s[12],s[13],s[14]],p=[...h];for(let _=0;_<3;_++)for(let x=0;x<3;x++){const E=s[4*x+_],O=E*r.min[x],R=E*r.max[x];h[_]+=Math.min(O,R),p[_]+=Math.max(O,R)}return new br(h,p)}static projectAabbCorners(r,s){const h=r.getCorners();for(let p=0;p<h.length;++p)En(h[p],h[p],s);return h}constructor(r,s){this.min=r,this.max=s,this.center=vt([],Ie([],this.min,this.max),.5)}quadrant(r){const s=[r%2==0,r<2],h=tt(this.min),p=tt(this.max);for(let _=0;_<s.length;_++)h[_]=s[_]?this.min[_]:this.center[_],p[_]=s[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new br(h,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,s=this.max;return[[r[0],r[1],r[2]],[s[0],r[1],r[2]],[s[0],s[1],r[2]],[r[0],s[1],r[2]],[r[0],r[1],s[2]],[s[0],r[1],s[2]],[s[0],s[1],s[2]],[r[0],s[1],s[2]]]}intersects(r){return this.intersectsAabb(r.bounds)?lr(r,this.getCorners()):0}intersectsFlat(r){return this.intersectsAabb(r.bounds)?lr(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(r,s){return s||this.intersects(r)?ei(r,this.getCorners()):0}intersectsPreciseFlat(r,s){return s||this.intersectsFlat(r)?ei(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(r){for(let s=0;s<3;++s)if(this.min[s]>r.max[s]||r.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(r){return!(this.min[0]>r.max[0]||r.min[0]>this.max[0]||this.min[1]>r.max[1]||r.min[1]>this.max[1])}encapsulate(r){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],r.min[s]),this.max[s]=Math.max(this.max[s],r.max[s])}encapsulatePoint(r){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],r[s]),this.max[s]=Math.max(this.max[s],r[s])}closestPoint(r){return[Math.max(Math.min(this.max[0],r[0]),this.min[0]),Math.max(Math.min(this.max[1],r[1]),this.min[1]),Math.max(Math.min(this.max[2],r[2]),this.min[2])]}}Rn(br,"Aabb");class oi{constructor(r,s){this.feature=r,this.metersToTile=s,this.index=0}get(){const r=this.feature.vertices[this.index],s=this.feature.vertexProps[this.index].dir,h=s[1],p=-s[0],_=(r.extent+1)*this.metersToTile;return[new kt(Math.trunc(r.position[0]+h*_),Math.trunc(r.position[1]+p*_)),new kt(Math.trunc(r.position[0]-h*_),Math.trunc(r.position[1]-p*_))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Tr{constructor(r,s,h,p,_,x){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=r,this.heightRange={min:h,max:h},this.safeArea=s,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=_,this.edges=this.edges.filter((E=>{return E.a<this.vertices.length&&E.b<this.vertices.length&&!((O=this.vertices[E.a].position)[0]===(R=this.vertices[E.b].position)[0]&&O[1]===R[1]);var O,R})),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const E of this.vertices)this.vertexProps.push({dir:Ua(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,E.height),this.heightRange.max=Math.max(this.heightRange.max,E.height);for(const E of this.edges){const O=this.vertices[E.a].position,R=this.vertices[E.b].position,z=eo(oa(),R,O),j=vo(z),B=co(oa(),z,1/j);this.edgeProps.push({vec:z,dir:B,len:j});const X=this.vertexProps[E.a].dir,Z=this.vertexProps[E.b].dir;lo(X,X,B),lo(Z,Z,B)}for(const E of this.vertexProps)E.dir[0]===0&&E.dir[1]===0||ss(E.dir,E.dir);this.tessellate(x)}}pointElevation(r){if(this.constantHeight!=null)return this.constantHeight;const s=this.getClosestEdge(r);if(s==null)return 0;const[h,p]=s;return Gn(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,p)}computeSlopeNormal(r,s){const h=this.getClosestEdge(r);if(!h)return ct(0,0,1);const p=h[0],_=this.edges[p],x=this.edgeProps[p].vec,E=ct(x[0],x[1],(this.vertices[_.b].height-this.vertices[_.a].height)*s),O=ct(E[1],-E[0],0);mn(O,O,E);const R=at(O);return R>0?vt(O,O,1/R):ct(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(r){if(this.edges.length===0)return;let s=0,h=Number.POSITIVE_INFINITY,p=0;const _=Ua(r.x,r.y);for(let x=0;x<this.edges.length;x++){const E=this.edges[x],O=this.edgeProps[x].dir,R=new sr(_,this.edgeProps[x].dir),z=this.vertices[E.a].position,j=this.vertices[E.b].position,B=oa(),X=oa(),Z=R.intersectsPlane(z,this.vertexProps[E.a].dir,B),ae=R.intersectsPlane(j,this.vertexProps[E.b].dir,X);if(!Z||!ae)continue;const se=eo(oa(),X,B),pe=eo(oa(),_,B),we=ir(se,se),be=we>0?ir(pe,se)/we:0,Ee=Pe(be,0,1),Ge=Math.abs((be-Ee)*this.edgeProps[x].len),Ue=eo(oa(),_,z),$e=Ge+Math.abs(ir(Ue,Ua(O[1],-O[0])));$e<h&&(s=x,h=$e,p=Ee)}return[s,p]}tessellate(r){for(let s=this.edges.length-1;s>=0;--s){const h=this.edges[s].a,p=this.edges[s].b,{position:_,height:x,extent:E}=this.vertices[h],{position:O,height:R,extent:z}=this.vertices[p],j=this.vertexProps[h].dir,B=this.vertexProps[p].dir,X=ct(_[0]/r,_[1]/r,x),Z=ct(O[0]/r,O[1]/r,R),ae=ct(j[1],-j[0],0);vt(ae,ae,E);const se=ct(B[1],-B[0],0);if(vt(se,se,z),this.distSqLines(ct(X[0]+.5*ae[0],X[1]+.5*ae[1],X[2]+.5*ae[2]),ct(Z[0]-.5*se[0],Z[1]-.5*se[1],Z[2]-.5*se[2]),ct(X[0]-.5*ae[0],X[1]-.5*ae[1],X[2]-.5*ae[2]),ct(Z[0]+.5*se[0],Z[1]+.5*se[1],Z[2]+.5*se[2]))<=.0025000000000000005)continue;const pe=this.vertices.length,we=lo(oa(),_,O);this.vertices.push({position:co(we,we,.5),height:.5*(x+R),extent:.5*(E+z)});const be=lo(oa(),j,B);this.vertexProps.push({dir:ss(be,be)}),this.edges.splice(s,1),this.edgeProps.splice(s,1),this.edges.push({a:h,b:pe}),this.edges.push({a:pe,b:p});const Ee=eo(oa(),this.vertices[pe].position,_),Ge=vo(Ee),Ue={vec:Ee,dir:co(oa(),Ee,1/Ge),len:Ge};this.edgeProps.push(Ue),this.edgeProps.push(Ue)}}distSqLines(r,s,h,p){const _=rt(ze(),s,r),x=rt(ze(),p,h),E=rt(ze(),r,h),O=Ht(_,_),R=Ht(_,x),z=Ht(_,E),j=Ht(x,x),B=Ht(x,E),X=O*j-R*R;if(X===0){const se=Ht(E,x)/Ht(x,x);return gt(en(ze(),h,p,se),r)}const Z=(R*B-z*j)/X,ae=(O*B-R*z)/X;return gt(en(ze(),r,s,Z),en(ze(),h,p,ae))}}class Li{static parseFrom(r,s){const h=$r.parse(r);if(!h)return[];let{vertices:p,features:_}=h;const x=1/Ne(s);_.sort(((z,j)=>z.id-j.id)),p.sort(((z,j)=>z.id-j.id||z.idx-j.idx)),p=p.filter(((z,j,B)=>j===B.findIndex((X=>X.id===z.id&&X.idx===z.idx))));const E=new Array;let O=0;const R=p.length;for(const z of _){if(z.constantHeight){E.push(new Tr(z.id,z.bounds,z.constantHeight));continue}for(;O!==R&&p[O].id<z.id;)O++;if(O===R||p[O].id!==z.id)continue;const j=new Array,B=new Array,X=O;for(;O!==R&&p[O].id===z.id;){const Z=p[O];if(j.push({position:Z.position,height:Z.height,extent:Z.extent}),O!==X&&p[O-1].idx===Z.idx-1){const ae=O-X;B.push({a:ae-1,b:ae})}O++}E.push(new Tr(z.id,z.bounds,void 0,j,B,x))}return E}static getElevationFeature(r,s){if(!s)return;const h=+r.properties[xn];return Number.isNaN(h)?void 0:s.find((p=>p.id===h))}}class qr{constructor(r,s){this.zScale=1,this.xOffset=0,this.yOffset=0,r.equals(s)||(this.zScale=Math.pow(2,s.z-r.z),this.xOffset=(r.x*this.zScale-s.x)*nn,this.yOffset=(r.y*this.zScale-s.y)*nn)}constantElevation(r,s){if(r.constantHeight!=null)return this.computeBiasedHeight(r.constantHeight,s)}pointElevation(r,s,h){const p=this.constantElevation(s,h);return p??(r.x=r.x*this.zScale+this.xOffset,r.y=r.y*this.zScale+this.yOffset,this.computeBiasedHeight(s.pointElevation(r),h))}computeBiasedHeight(r,s){return s<=0?r:r+s*Ke(0,s,r>=0?r:Math.abs(.5*r))}}Rn(Tr,"ElevationFeature");class ti{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.fqid)),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Rs,this.indexArray=new Zr,this.segments=new Ki,this.programConfigurations=new Ks(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new kh),this.worldview=r.worldview}updateFootprints(r,s){}populate(r,s,h,p){const _=this.layers[0],x=[];let E=null;_.type==="circle"&&(E=_.layout.get("circle-sort-key"));for(const{feature:R,id:z,index:j,sourceLayerIndex:B}of r){const X=this.layers[0]._featureFilter.needGeometry,Z=Tt(R,X);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom,{worldview:this.worldview}),Z,h))continue;const ae=E?E.evaluate(Z,{},h):void 0,se={id:z,properties:R.properties,type:R.type,sourceLayerIndex:B,index:j,geometry:X?Z.geometry:We(R,h,p),patterns:{},sortKey:ae};x.push(se)}E&&x.sort(((R,z)=>R.sortKey-z.sortKey));let O=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new em,O=p.projection);for(const R of x){const{geometry:z,index:j,sourceLayerIndex:B}=R,X=r[j].feature;this.addFeature(R,z,j,s.availableImages,h,O,s.brightness,s.elevationFeatures),s.featureIndex.insert(X,z,j,B,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(r,s,h,p,_,x,E){this.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,n_.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,r_.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=r.createVertexBuffer(this.elevatedLayoutVertexArray,xv.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(r,s,h,p,_,x,E,O){let R;this.elevationMode!=="none"&&(R=Li.getElevationFeature(r,O));for(const z of s)for(const j of z){const B=j.x,X=j.y;if(B<0||B>=nn||X<0||X>=nn)continue;if(x){const se=x.projectTilePoint(B,X,_),pe=x.upVector(_,B,X);this.addGlobeExtVertex(se,pe),this.addGlobeExtVertex(se,pe),this.addGlobeExtVertex(se,pe),this.addGlobeExtVertex(se,pe)}const Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),ae=Z.vertexLength;if(this.addCircleVertex(B,X,-1,-1),this.addCircleVertex(B,X,1,-1),this.addCircleVertex(B,X,1,1),this.addCircleVertex(B,X,-1,1),this.elevationMode!=="none"){const se=R?R.pointElevation(new kt(B,X)):0;this.hasElevation=this.hasElevation||se!==0;for(let pe=0;pe<4;pe++)this.elevatedLayoutVertexArray.emplaceBack(se)}this.indexArray.emplaceBack(ae,ae+1,ae+2),this.indexArray.emplaceBack(ae,ae+2,ae+3),Z.vertexLength+=4,Z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,{},p,_,E,void 0,this.worldview)}addCircleVertex(r,s,h,p){this.layoutVertexArray.emplaceBack(2*r+(h+1)/2,2*s+(p+1)/2)}addGlobeExtVertex(r,s){this.globeExtVertexArray.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}}function Ai(l,r){for(let s=0;s<l.length;s++)if(Ya(r,l[s]))return!0;for(let s=0;s<r.length;s++)if(Ya(l,r[s]))return!0;return!!Co(l,r)}function Ca(l,r,s){return!!Ya(l,r)||!!ts(r,l,s)}function Ma(l,r){if(l.length===1)return nc(r,l[0]);for(let s=0;s<r.length;s++){const h=r[s];for(let p=0;p<h.length;p++)if(Ya(l,h[p]))return!0}for(let s=0;s<l.length;s++)if(nc(r,l[s]))return!0;for(let s=0;s<r.length;s++)if(Co(l,r[s]))return!0;return!1}function wa(l,r,s){if(l.length>1){if(Co(l,r))return!0;for(let h=0;h<r.length;h++)if(ts(r[h],l,s))return!0}for(let h=0;h<l.length;h++)if(ts(l[h],r,s))return!0;return!1}function Co(l,r){if(l.length===0||r.length===0)return!1;for(let s=0;s<l.length-1;s++){const h=l[s],p=l[s+1];for(let _=0;_<r.length-1;_++)if(po(h,p,r[_],r[_+1]))return!0}return!1}function po(l,r,s,h){return da(l,s,h)!==da(r,s,h)&&da(l,r,s)!==da(l,r,h)}function bs(l,r,s){return(l.x-s.x)*(r.y-s.y)-(l.y-s.y)*(r.x-s.x)}function qa(l,r,s,h){const p=bs(l,r,h),_=bs(l,r,s);if(Math.sign(p)===Math.sign(_))return;const x=bs(s,h,l),E=x+_-p;return Math.sign(x)!==Math.sign(E)?[x/(x-E),_/(_-p)]:void 0}function ts(l,r,s){const h=s*s;if(r.length===1)return l.distSqr(r[0])<h;for(let p=1;p<r.length;p++)if(_l(l,r[p-1],r[p])<h)return!0;return!1}function _l(l,r,s){const h=r.distSqr(s);if(h===0)return l.distSqr(r);const p=((l.x-r.x)*(s.x-r.x)+(l.y-r.y)*(s.y-r.y))/h;return l.distSqr(p<0?r:p>1?s:s.sub(r)._mult(p)._add(r))}function nc(l,r){let s,h,p,_=!1;for(let x=0;x<l.length;x++){s=l[x];for(let E=0,O=s.length-1;E<s.length;O=E++)h=s[E],p=s[O],h.y>r.y!=p.y>r.y&&r.x<(p.x-h.x)*(r.y-h.y)/(p.y-h.y)+h.x&&(_=!_)}return _}function Ya(l,r){let s=!1;for(let h=0,p=l.length-1;h<l.length;p=h++){const _=l[h],x=l[p];_.y>r.y!=x.y>r.y&&r.x<(x.x-_.x)*(r.y-_.y)/(x.y-_.y)+_.x&&(s=!s)}return s}function ma(l,r,s,h,p){for(const x of l)if(r<=x.x&&s<=x.y&&h>=x.x&&p>=x.y)return!0;const _=[new kt(r,s),new kt(r,p),new kt(h,p),new kt(h,s)];if(l.length>2){for(const x of _)if(Ya(l,x))return!0}for(let x=0;x<l.length-1;x++)if(ca(l[x],l[x+1],_))return!0;return!1}function ca(l,r,s){const h=s[0],p=s[2];if(l.x<h.x&&r.x<h.x||l.x>p.x&&r.x>p.x||l.y<h.y&&r.y<h.y||l.y>p.y&&r.y>p.y)return!1;const _=da(l,r,s[0]);return _!==da(l,r,s[1])||_!==da(l,r,s[2])||_!==da(l,r,s[3])}function Si(l,r,s,h,p,_){let x=r.y-l.y,E=l.x-r.x;if(_=_||0){const O=x*x+E*E;if(O===0)return!0;const R=Math.sqrt(O);x/=R,E/=R}return!((s.x-l.x)*x+(s.y-l.y)*E-_<0||(h.x-l.x)*x+(h.y-l.y)*E-_<0||(p.x-l.x)*x+(p.y-l.y)*E-_<0)}function Ka(l,r,s,h,p,_,x){return!(Si(l,r,h,p,_,x)||Si(r,s,h,p,_,x)||Si(s,l,h,p,_,x)||Si(h,p,l,r,s,x)||Si(p,_,l,r,s,x)||Si(_,h,l,r,s,x))}function Io(l,r,s){const h=r.paint.get(l).value;return h.kind==="constant"?h.value:s.programConfigurations.get(r.id).getMaxValue(l)}function Sa(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Js(l,r,s,h,p){if(!r[0]&&!r[1])return l;const _=kt.convert(r)._mult(p);s==="viewport"&&_._rotate(-h);const x=[];for(let E=0;E<l.length;E++)x.push(l[E].sub(_));return x}function Uu(l,r,s,h){const p=kt.convert(l)._mult(h);return r==="viewport"&&p._rotate(-s),p}let zh,Bf;function Ff(l,r,s){var h=2*Math.PI*6378137/256/Math.pow(2,s);return[l*h-2*Math.PI*6378137/2,r*h-2*Math.PI*6378137/2]}Rn(ti,"CircleBucket",{omit:["layers"]});class vl{constructor(r,s,h){this.z=r,this.x=s,this.y=h,this.key=ks(0,r,r,s,h)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}isChildOf(r){const s=this.z-r.z;return r.z===0||r.z<this.z&&r.x===this.x>>s&&r.y===this.y>>s}url(r,s){const h=(function(_,x,E){var O=Ff(256*_,256*(x=Math.pow(2,E)-x-1),E),R=Ff(256*(_+1),256*(x+1),E);return O[0]+","+O[1]+","+R[0]+","+R[1]})(this.x,this.y,this.z),p=(function(_,x,E){let O,R="";for(let z=_;z>0;z--)O=1<<z-1,R+=(x&O?1:0)+(E&O?2:0);return R})(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Mc{constructor(r,s){this.wrap=r,this.canonical=s,this.key=ks(r,s.z,s.z,s.x,s.y)}}class Pa{constructor(r,s,h,p,_){this.overscaledZ=r,this.wrap=s,this.canonical=new vl(h,+p,+_),this.key=s===0&&r===h?this.canonical.key:ks(s,r,h,p,_)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const s=this.canonical.z-r;return r>this.canonical.z?new Pa(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pa(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s=!0){if(this.overscaledZ===r&&s)return this.key;if(r>this.canonical.z)return ks(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-r;return ks(this.wrap*+s,r,r,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.z<this.canonical.z&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Pa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,h=2*this.canonical.x,p=2*this.canonical.y;return[new Pa(s,this.wrap,s,h,p),new Pa(s,this.wrap,s,h+1,p),new Pa(s,this.wrap,s,h,p+1),new Pa(s,this.wrap,s,h+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Pa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Pa(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Mc(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ks(l,r,s,h,p){const _=1<<Math.min(s,22);let x=_*(p%_)+h%_;return l&&s<22&&(x+=_*_*((l<0?-2*l-1:2*l)%(1<<2*(22-s)))),16*(32*x+s)+(r-s)}const jh=[l=>{let r=l.canonical.x-1,s=l.wrap;return r<0&&(r=(1<<l.canonical.z)-1,s--),new Pa(l.overscaledZ,s,l.canonical.z,r,l.canonical.y)},l=>{let r=l.canonical.x+1,s=l.wrap;return r===1<<l.canonical.z&&(r=0,s++),new Pa(l.overscaledZ,s,l.canonical.z,r,l.canonical.y)},l=>new Pa(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new Pa(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];Rn(vl,"CanonicalTileID"),Rn(Pa,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const _S=Ur([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:s_}=_S,vS=Ur([{name:"a_pos_3",components:3,type:"Int16"}]);var H0=Ur([{name:"a_pos",type:"Int16",components:2}]);function l_(l){return l*Za/L}const Tv=[new br([b,b,b],[T,T,T]),new br([b,b,b],[0,0,T]),new br([0,b,b],[T,0,T]),new br([b,0,b],[0,T,T]),new br([0,0,b],[T,T,T])];function G0(l,r,s,h=!0){const p=vt([],l._camera.position,l.worldSize),_=[r,s,1,1];Bt(_,_,l.pixelMatrixInverse),ra(_,_,1/_[3]);const x=qt([],Cr([],_,p)),E=l.globeMatrix,O=[E[12],E[13],E[14]],R=Cr([],O,p),z=at(R),j=qt([],R),B=l.worldSize/(2*Math.PI),X=Ht(j,x),Z=Math.asin(B/z);if(Z<Math.acos(X)){if(!h)return null;const Mt=[],ut=[];vt(Mt,x,z/X),qt(ut,Cr(ut,Mt,R)),qt(x,Ie(x,R,vt(x,ut,Math.tan(Z)*z)))}const ae=[];new kr(p,x).closestPointOnSphere(O,B,ae);const se=qt([],Gi(E,0)),pe=qt([],Gi(E,1)),we=qt([],Gi(E,2)),be=Ht(se,ae),Ee=Ht(pe,ae),Ge=Ht(we,ae),Ue=ot(Math.asin(-Ee/B));let $e=ot(Math.atan2(be,Ge));$e=l.center.lng+(function(Mt,ut){const Dt=(ut-Mt+180)%360-180;return Dt<-180?Dt+360:Dt})(l.center.lng,$e);const Je=oe($e),it=Pe(ue(Ue),0,1);return new je(Je,it)}class xS{constructor(r,s,h){this.a=Cr([],r,h),this.b=Cr([],s,h),this.center=h;const p=qt([],this.a),_=qt([],this.b);this.angle=Math.acos(Ht(p,_))}}function Va(l,r){if(l.angle===0)return null;let s;return s=l.a[r]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[r]/l.a[r]/Math.sin(l.angle)-1/Math.tan(l.angle)),s<0||s>1?null:(function(h,p,_,x){const E=Math.sin(_);return h*(Math.sin((1-x)*_)/E)+p*(Math.sin(x*_)/E)})(l.a[r],l.b[r],l.angle,Pe(s,0,1))+l.center[r]}function iu(l){if(l.z<=1)return Tv[l.z+2*l.y+l.x];const r=X0(Ev(l));return br.fromPoints(r)}function Od(l,r,s){return vt(l,l,1-s),nt(l,l,r,s)}function W0(l,r,s){for(const h of l)En(h,h,r),vt(h,h,s)}function bS(l,r,s,h){const p=r/l.worldSize,_=l.globeMatrix;if(s.z<=1){const it=iu(s).getCorners();return W0(it,_,p),br.fromPoints(it)}const x=Ev(s,h),E=X0(x,Za+l_(l._tileCoverLift));W0(E,_,p);const O=Number.MAX_VALUE,R=[-O,-O,-O],z=[O,O,O];if(x.contains(l.center)){for(const ut of E)St(z,z,ut),qe(R,R,ut);R[2]=0;const it=l.point,Mt=[it.x*p,it.y*p,0];return St(z,z,Mt),qe(R,R,Mt),new br(z,R)}if(l._tileCoverLift>0){for(const it of E)St(z,z,it),qe(R,R,it);return new br(z,R)}const j=[_[12]*p,_[13]*p,_[14]*p],B=x.getCenter(),X=Pe(l.center.lat,-ke,ke),Z=Pe(B.lat,-ke,ke),ae=oe(l.center.lng),se=ue(X);let pe=ae-oe(B.lng);const we=se-ue(Z);pe>.5?pe-=1:pe<-.5&&(pe+=1);let be=0;Math.abs(pe)>Math.abs(we)?be=pe>=0?1:3:(be=we>=0?0:2,nt(j,j,[_[4]*p,_[5]*p,_[6]*p],-Math.sin(hr(we>=0?x.getSouth():x.getNorth()))*Za));const Ee=E[be],Ge=E[(be+1)%4],Ue=new xS(Ee,Ge,j),$e=[Va(Ue,0)||Ee[0],Va(Ue,1)||Ee[1],Va(Ue,2)||Ee[2]],Je=Uf(l.zoom);if(Je>0){const it=(function({x:ut,y:Dt,z:ln},Vt,Yt,on,At){const Kt=1/(1<<ln);let pt=ut*Kt,Ct=pt+Kt,un=Dt*Kt,Qt=un+Kt,Un=0;const kn=(pt+Ct)/2-on;return kn>.5?Un=-1:kn<-.5&&(Un=1),pt=((pt+Un)*Vt-(on*=Vt))*Yt+on,Ct=((Ct+Un)*Vt-on)*Yt+on,un=(un*Vt-(At*=Vt))*Yt+At,Qt=(Qt*Vt-At)*Yt+At,[[pt,Qt,0],[Ct,Qt,0],[Ct,un,0],[pt,un,0]]})(s,r,l._pixelsPerMercatorPixel,ae,se);for(let ut=0;ut<E.length;ut++)Od(E[ut],it[ut],Je);const Mt=Ie([],it[be],it[(be+1)%4]);vt(Mt,Mt,.5),Od($e,Mt,Je)}for(const it of E)St(z,z,it),qe(R,R,it);return z[2]=Math.min(Ee[2],Ge[2]),St(z,z,$e),qe(R,R,$e),new br(z,R)}function Ev({x:l,y:r,z:s},h=!1){const p=1/(1<<s),_=new U(xe(l*p),r===(1<<s)-1&&h?-90:Te((r+1)*p)),x=new U(xe((l+1)*p),r===0&&h?90:Te(r*p));return new Y(_,x)}function X0(l,r=Za){const s=hr(l.getNorth()),h=hr(l.getSouth()),p=Math.cos(s),_=Math.cos(h),x=Math.sin(s),E=Math.sin(h),O=l.getWest(),R=l.getEast();return[C(_,E,O,r),C(_,E,R,r),C(p,x,R,r),C(p,x,O,r)]}function Vf(l,r,s,h){const p=1<<s.z,_=(l/nn+s.x)/p;return I(Te((r/nn+s.y)/p),xe(_),h)}function Rd({min:l,max:r}){return o/Math.max(r[0]-l[0],r[1]-l[1],r[2]-l[2])}const Av=new Float64Array(16);function fm(l){const r=Rd(l),s=me(Av,[r,r,r]);return ee(s,s,$t([],l.min))}function c_(l){const r=(h=l.min,(s=Av)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=h[0],s[13]=h[1],s[14]=h[2],s[15]=1,s);var s,h;const p=1/Rd(l);return re(r,r,[p,p,p])}function Id(l){const r=nn/(2*Math.PI);return l/(2*Math.PI)/r}function $u(l,r){return nn/(512*Math.pow(2,l))*Rd(iu(r))}function Ig(l,r,s,h,p){const _=Id(s),x=[l,r,-s/(2*Math.PI)],E=q(new Float64Array(16));return ee(E,E,x),re(E,E,[_,_,_]),fe(E,E,hr(-p)),ne(E,E,hr(-h)),E}function Uf(l){return Ke(Ao,g,l)}function Z0(l,r){const s=I(r.lat,r.lng),h=(function(Z){const ae=I(Z._center.lat,Z._center.lng);let se=mn([],ct(0,1,0),ae);const pe=ve([],-Z.angle,ae);se=En(se,se,pe),ve(pe,-Z._pitch,se);const we=qt([],ae);return vt(we,we,l_(Z.cameraToCenterDistance/Z.pixelsPerMeter)),En(we,we,pe),Ie([],ae,we)})(l);return x=(p=rt([],h,s))[0],E=p[1],O=p[2],R=(_=s)[0],z=_[1],j=_[2],X=(B=Math.sqrt(x*x+E*E+O*O)*Math.sqrt(R*R+z*z+j*j))&&Ht(p,_)/B,Math.acos(Math.min(Math.max(X,-1),1));var p,_,x,E,O,R,z,j,B,X}function Cv(l,r){return Z0(l,r)>Math.PI/2*1.01}const Y0=hr(85),wS=Math.cos(Y0),EC=Math.sin(Y0),K0=G(),J0=l=>{const r=[];return l.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r};function Q0(l,r,s,h,p,_,x,E,O){if(_&&l.queryGeometry.isAboveHorizon)return!1;_&&(O*=l.pixelToTileUnitsFactor);const R=l.tileID.canonical,z=s.projection.upVectorScale(R,s.center.lat,s.worldSize).metersToTile;for(const j of r)for(const B of j){const X=B.add(E),Z=p&&s.elevation?s.elevation.exaggeration()*p.getElevationAt(X.x,X.y,!0):0,ae=s.projection.projectTilePoint(X.x,X.y,R);if(Z>0){const be=s.projection.upVector(R,X.x,X.y);ae.x+=be[0]*z*Z,ae.y+=be[1]*z*Z,ae.z+=be[2]*z*Z}const se=_?X:AC(ae.x,ae.y,ae.z,h),pe=_?l.tilespaceRays.map((be=>CC(be,Z))):l.queryGeometry.screenGeometry,we=Bt([],[ae.x,ae.y,ae.z,1],h);if(!x&&_?O*=we[3]/s.cameraToCenterDistance:x&&!_&&(O*=s.cameraToCenterDistance/we[3]),_){const be=Te((B.y/nn+R.y)/(1<<R.z));O/=s.projection.pixelsPerMeter(be,1)/de(1,be)}if(Ca(pe,se,O))return!0}return!1}function AC(l,r,s,h){const p=Bt([],[l,r,s,1],h);return new kt(p[0]/p[3],p[1]/p[3])}const Mv=ct(0,0,0),eb=ct(0,0,1);function CC(l,r){const s=ze();return Mv[2]=r,l.intersectsPlane(Mv,eb,s),new kt(s[0],s[1])}class SS extends ti{}let Dg,TS,tb,Wi;function Pv(l,{width:r,height:s},h,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*s*h)throw new RangeError("mismatched image size")}else p=new Uint8Array(r*s*h);return l.width=r,l.height=s,l.data=p,l}function u_(l,r,s){const{width:h,height:p}=r;h===l.width&&p===l.height||(h_(l,r,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,h),height:Math.min(l.height,p)},s,null),l.width=h,l.height=p,l.data=r.data)}function h_(l,r,s,h,p,_,x,E){if(p.width===0||p.height===0)return r;if(p.width>l.width||p.height>l.height||s.x>l.width-p.width||s.y>l.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||h.x>r.width-p.width||h.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const O=l.data,R=r.data,z=_===4&&E;for(let j=0;j<p.height;j++){const B=((s.y+j)*l.width+s.x)*_,X=((h.y+j)*r.width+h.x)*_;if(z)for(let Z=0;Z<p.width;Z++){const ae=B+Z*_+3,se=X+Z*_;R[se+0]=255,R[se+1]=255,R[se+2]=255,R[se+3]=O[ae]}else if(x)for(let Z=0;Z<p.width;Z++){const ae=B+Z*_,se=X+Z*_,pe=new pi(O[ae+0]/255,O[ae+1]/255,O[ae+2]/255,O[ae+3]).toNonPremultipliedRenderColor(x).toArray();R[se+0]=pe[0],R[se+1]=pe[1],R[se+2]=pe[2],R[se+3]=pe[3]}else for(let Z=0;Z<p.width*_;Z++)R[X+Z]=O[B+Z]}return r}Rn(SS,"HeatmapBucket",{omit:["layers"]});class Dd{constructor(r,s){Pv(this,r,1,s)}resize(r){u_(this,new Dd(r),1)}clone(){return new Dd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,h,p,_){h_(r,s,h,p,_,1,null)}}class Fo{constructor(r,s){Pv(this,r,4,s)}resize(r){u_(this,new Fo(r),4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Fo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,h,p,_,x,E){h_(r,s,h,p,_,4,x,E)}}class kg{constructor(r,s){this.width=r.width,this.height=r.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function $f(l){const r={},s=l.resolution||256,h=l.clips?l.clips.length:1,p=l.image||new Fo({width:s,height:h}),_=(x,E,O)=>{r[l.evaluationKey]=O;const R=l.expression.evaluate(r),z=R?R.toNonPremultipliedRenderColor(null):null;z&&(p.data[x+E+0]=Math.floor(255*z.r),p.data[x+E+1]=Math.floor(255*z.g),p.data[x+E+2]=Math.floor(255*z.b),p.data[x+E+3]=Math.floor(255*z.a))};if(l.clips)for(let x=0,E=0;x<h;++x,E+=4*s)for(let O=0,R=0;O<s;O++,R+=4){const z=O/(s-1),{start:j,end:B}=l.clips[x];_(E,R,j*(1-z)+B*z)}else for(let x=0,E=0;x<s;x++,E+=4)_(0,E,x/(s-1));return p}Rn(Dd,"AlphaImage"),Rn(Fo,"RGBAImage");const Lg=Ur([{name:"a_pos",components:2,type:"Int16"}],4),ES=Ur([{name:"a_road_z_offset",components:1,type:"Float32"}],4),MC=Ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),PC=Ur([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function pm(l,r,s=2){const h=r&&r.length,p=h?r[0]*s:l.length;let _=nb(l,0,p,s,!0);const x=[];if(!_||_.next===_.prev)return x;let E,O,R;if(h&&(_=(function(z,j,B,X){const Z=[];for(let ae=0,se=j.length;ae<se;ae++){const pe=nb(z,j[ae]*X,ae<se-1?j[ae+1]*X:z.length,X,!1);pe===pe.next&&(pe.steiner=!0),Z.push(ob(pe))}Z.sort(ab);for(let ae=0;ae<Z.length;ae++)B=Ov(Z[ae],B);return B})(l,r,_,s)),l.length>80*s){E=l[0],O=l[1];let z=E,j=O;for(let B=s;B<p;B+=s){const X=l[B],Z=l[B+1];X<E&&(E=X),Z<O&&(O=Z),X>z&&(z=X),Z>j&&(j=Z)}R=Math.max(z-E,j-O),R=R!==0?32767/R:0}return Ta(_,x,s,E,O,R,0),x}function nb(l,r,s,h,p){let _;if(p===(function(x,E,O,R){let z=0;for(let j=E,B=O-R;j<O;j+=R)z+=(x[B]-x[j])*(x[j+1]+x[B+1]),B=j;return z})(l,r,s,h)>0)for(let x=r;x<s;x+=h)_=PS(x/h|0,l[x],l[x+1],_);else for(let x=s-h;x>=r;x-=h)_=PS(x/h|0,l[x],l[x+1],_);return _&&mm(_,_.next)&&(f_(_),_=_.next),_}function Bh(l,r){if(!l)return l;r||(r=l);let s,h=l;do if(s=!1,h.steiner||!mm(h,h.next)&&Do(h.prev,h,h.next)!==0)h=h.next;else{if(f_(h),h=r=h.prev,h===h.next)break;s=!0}while(s||h!==r);return r}function Ta(l,r,s,h,p,_,x){if(!l)return;!x&&_&&(function(O,R,z,j){let B=O;do B.z===0&&(B.z=Rv(B.x,B.y,R,z,j)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==O);B.prevZ.nextZ=null,B.prevZ=null,(function(X){let Z,ae=1;do{let se,pe=X;X=null;let we=null;for(Z=0;pe;){Z++;let be=pe,Ee=0;for(let Ue=0;Ue<ae&&(Ee++,be=be.nextZ,be);Ue++);let Ge=ae;for(;Ee>0||Ge>0&&be;)Ee!==0&&(Ge===0||!be||pe.z<=be.z)?(se=pe,pe=pe.nextZ,Ee--):(se=be,be=be.nextZ,Ge--),we?we.nextZ=se:X=se,se.prevZ=we,we=se;pe=be}we.nextZ=null,ae*=2}while(Z>1)})(B)})(l,h,p,_);let E=l;for(;l.prev!==l.next;){const O=l.prev,R=l.next;if(_?Qs(l,h,p,_):rb(l))r.push(O.i,l.i,R.i),f_(l),l=R.next,E=R.next;else if((l=R)===E){x?x===1?Ta(l=OC(Bh(l),r),r,s,h,p,_,2):x===2&&ib(l,r,s,h,p,_):Ta(Bh(l),r,s,h,p,_,1);break}}}function rb(l){const r=l.prev,s=l,h=l.next;if(Do(r,s,h)>=0)return!1;const p=r.x,_=s.x,x=h.x,E=r.y,O=s.y,R=h.y,z=Math.min(p,_,x),j=Math.min(E,O,R),B=Math.max(p,_,x),X=Math.max(E,O,R);let Z=h.next;for(;Z!==r;){if(Z.x>=z&&Z.x<=B&&Z.y>=j&&Z.y<=X&&d_(p,E,_,O,x,R,Z.x,Z.y)&&Do(Z.prev,Z,Z.next)>=0)return!1;Z=Z.next}return!0}function Qs(l,r,s,h){const p=l.prev,_=l,x=l.next;if(Do(p,_,x)>=0)return!1;const E=p.x,O=_.x,R=x.x,z=p.y,j=_.y,B=x.y,X=Math.min(E,O,R),Z=Math.min(z,j,B),ae=Math.max(E,O,R),se=Math.max(z,j,B),pe=Rv(X,Z,r,s,h),we=Rv(ae,se,r,s,h);let be=l.prevZ,Ee=l.nextZ;for(;be&&be.z>=pe&&Ee&&Ee.z<=we;){if(be.x>=X&&be.x<=ae&&be.y>=Z&&be.y<=se&&be!==p&&be!==x&&d_(E,z,O,j,R,B,be.x,be.y)&&Do(be.prev,be,be.next)>=0||(be=be.prevZ,Ee.x>=X&&Ee.x<=ae&&Ee.y>=Z&&Ee.y<=se&&Ee!==p&&Ee!==x&&d_(E,z,O,j,R,B,Ee.x,Ee.y)&&Do(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;be&&be.z>=pe;){if(be.x>=X&&be.x<=ae&&be.y>=Z&&be.y<=se&&be!==p&&be!==x&&d_(E,z,O,j,R,B,be.x,be.y)&&Do(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;Ee&&Ee.z<=we;){if(Ee.x>=X&&Ee.x<=ae&&Ee.y>=Z&&Ee.y<=se&&Ee!==p&&Ee!==x&&d_(E,z,O,j,R,B,Ee.x,Ee.y)&&Do(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function OC(l,r){let s=l;do{const h=s.prev,p=s.next.next;!mm(h,p)&&MS(h,s,s.next,p)&&Ng(h,p)&&Ng(p,h)&&(r.push(h.i,s.i,p.i),f_(s),f_(s.next),s=l=p),s=s.next}while(s!==l);return Bh(s)}function ib(l,r,s,h,p,_){let x=l;do{let E=x.next.next;for(;E!==x.prev;){if(x.i!==E.i&&CS(x,E)){let O=kv(x,E);return x=Bh(x,x.next),O=Bh(O,O.next),Ta(x,r,s,h,p,_,0),void Ta(O,r,s,h,p,_,0)}E=E.next}x=x.next}while(x!==l)}function ab(l,r){let s=l.x-r.x;return s===0&&(s=l.y-r.y,s===0)&&(s=(l.next.y-l.y)/(l.next.x-l.x)-(r.next.y-r.y)/(r.next.x-r.x)),s}function Ov(l,r){const s=(function(p,_){let x=_;const E=p.x,O=p.y;let R,z=-1/0;if(mm(p,x))return x;do{if(mm(p,x.next))return x.next;if(O<=x.y&&O>=x.next.y&&x.next.y!==x.y){const ae=x.x+(O-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(ae<=E&&ae>z&&(z=ae,R=x.x<x.next.x?x:x.next,ae===E))return R}x=x.next}while(x!==_);if(!R)return null;const j=R,B=R.x,X=R.y;let Z=1/0;x=R;do{if(E>=x.x&&x.x>=B&&E!==x.x&&Iv(O<X?E:z,O,B,X,O<X?z:E,O,x.x,x.y)){const ae=Math.abs(O-x.y)/(E-x.x);Ng(x,p)&&(ae<Z||ae===Z&&(x.x>R.x||x.x===R.x&&AS(R,x)))&&(R=x,Z=ae)}x=x.next}while(x!==j);return R})(l,r);if(!s)return r;const h=kv(s,l);return Bh(h,h.next),Bh(s,s.next)}function AS(l,r){return Do(l.prev,l,r.prev)<0&&Do(r.next,l,l.next)<0}function Rv(l,r,s,h,p){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-s)*p|0)|l<<8))|l<<4))|l<<2))|l<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-h)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function ob(l){let r=l,s=l;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==l);return s}function Iv(l,r,s,h,p,_,x,E){return(p-x)*(r-E)>=(l-x)*(_-E)&&(l-x)*(h-E)>=(s-x)*(r-E)&&(s-x)*(_-E)>=(p-x)*(h-E)}function d_(l,r,s,h,p,_,x,E){return!(l===x&&r===E)&&Iv(l,r,s,h,p,_,x,E)}function CS(l,r){return l.next.i!==r.i&&l.prev.i!==r.i&&!(function(s,h){let p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==h.i&&p.next.i!==h.i&&MS(p,p.next,s,h))return!0;p=p.next}while(p!==s);return!1})(l,r)&&(Ng(l,r)&&Ng(r,l)&&(function(s,h){let p=s,_=!1;const x=(s.x+h.x)/2,E=(s.y+h.y)/2;do p.y>E!=p.next.y>E&&p.next.y!==p.y&&x<(p.next.x-p.x)*(E-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==s);return _})(l,r)&&(Do(l.prev,l,r.prev)||Do(l,r.prev,r))||mm(l,r)&&Do(l.prev,l,l.next)>0&&Do(r.prev,r,r.next)>0)}function Do(l,r,s){return(r.y-l.y)*(s.x-r.x)-(r.x-l.x)*(s.y-r.y)}function mm(l,r){return l.x===r.x&&l.y===r.y}function MS(l,r,s,h){const p=qu(Do(l,r,s)),_=qu(Do(l,r,h)),x=qu(Do(s,h,l)),E=qu(Do(s,h,r));return p!==_&&x!==E||!(p!==0||!Dv(l,s,r))||!(_!==0||!Dv(l,h,r))||!(x!==0||!Dv(s,l,h))||!(E!==0||!Dv(s,r,h))}function Dv(l,r,s){return r.x<=Math.max(l.x,s.x)&&r.x>=Math.min(l.x,s.x)&&r.y<=Math.max(l.y,s.y)&&r.y>=Math.min(l.y,s.y)}function qu(l){return l>0?1:l<0?-1:0}function Ng(l,r){return Do(l.prev,l,l.next)<0?Do(l,r,l.next)>=0&&Do(l,l.prev,r)>=0:Do(l,r,l.prev)<0||Do(l,l.next,r)<0}function kv(l,r){const s=p_(l.i,l.x,l.y),h=p_(r.i,r.x,r.y),p=l.next,_=r.prev;return l.next=r,r.prev=l,s.next=p,p.prev=s,h.next=s,s.prev=h,_.next=h,h.prev=_,h}function PS(l,r,s,h){const p=p_(l,r,s);return h?(p.next=h.next,p.prev=h,h.next.prev=p,h.next=p):(p.prev=p,p.next=p),p}function f_(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function p_(l,r,s){return{i:l,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function m_(l,r){const s=l.length;if(s<=1)return[l];const h=[];let p,_;for(let x=0;x<s;x++){const E=Ia(l[x]);E!==0&&(l[x].area=Math.abs(E),_===void 0&&(_=E<0),_===E<0?(p&&h.push(p),p=[l[x]]):p.push(l[x]))}if(p&&h.push(p),r>1)for(let x=0;x<h.length;x++)h[x].length<=r||(ys(h[x],r,1,h[x].length-1,Hu),h[x]=h[x].slice(0,r));return h}function Hu(l,r){return r.area-l.area}function Lv(l,r,s=1){if(!l)return null;const h=typeof l=="string"?wo.from(l).getPrimary():l.getPrimary(),p=typeof l=="string"?null:l.getSecondary();for(const _ of[h,p]){if(!_)continue;const x=_.id.toString();r.has(x)||r.set(x,[]),_.scaleSelf(s),r.get(x).push(_)}return{primary:h.toString(),secondary:p?p.toString():null}}function Nv(l,r,s,h){const p=h.patternDependencies;let _=!1;for(const x of r){const E=x.paint.get(`${l}-pattern`);E.isConstant()||(_=!0),Lv(E.constantOr(null),p,s)&&(_=!0)}return _}function zv(l,r,s,h,p,_){const x=_.patternDependencies;for(const E of r){const O=E.paint.get(`${l}-pattern`).value;if(O.kind!=="constant"){let R=O.evaluate({zoom:h},s,{},_.availableImages);R=R&&R.name?R.name:R;const z=Lv(R,x,p);if(!z)continue;const{primary:j,secondary:B}=z;j&&(s.patterns[E.id]=[j,B].filter(Boolean))}}return s}class zg{constructor(){this.polygons=new Map}add(r,...s){this.polygons.has(r)?this.polygons.get(r).push(...s):this.polygons.set(r,s)}merge(r){for(const[s,h]of r.polygons)this.add(s,...h)}}class Ls{constructor(){this.portals=[]}static evaluate(r){if(r.length===0)return new Ls;let s=[];for(const R of r)s.push(...R.portals);if(s.length===0)return new Ls;const h=(R,z)=>R<=0&&z<=0||R>=nn&&z>=nn;for(const R of s){const z=R.va,j=R.vb;(h(z.x,j.x)||h(z.y,j.y))&&(R.type="border")}const p=s.filter((R=>R.type!=="unevaluated")),_=s.filter((R=>R.type==="unevaluated"));if(_.length===0)return new Ls;_.sort(((R,z)=>R.hash===z.hash?R.isTunnel===z.isTunnel?0:R.isTunnel?-1:1:R.hash<z.hash?1:-1)),s=p.concat(_);let x=p.length,E=x,O=x;do if(E++,E===s.length||s[x].hash!==s[E].hash){if(E-x==2){O<x&&(s[O]=s[x],s[x]=null);const R=s[O],z=s[E-1];R.type=R.isTunnel!==z.isTunnel?"tunnel":"polygon",R.connection={a:R.connection.a,b:z.connection.a},O++}x=E}while(x!==s.length);return s.splice(O),s.sort(((R,z)=>R.hash<z.hash?1:-1)),{portals:s}}}Rn(Ls,"ElevationPortalGraph"),Rn(zg,"ElevationPolygons");class OS{constructor(r,s,h){this.outPositions=r,this.outNormals=s,this.outIndices=h,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(r,s,h){let p=r[2];h!=null&&(p*=h);const _=this.getVec3Bits(r)<<96n|this.getVec3Bits(s),x=this.vertexLookup.get(_);if(x!=null)return x;const E=this.outPositions.length;this.vertexLookup.set(_,E);const O=Math.trunc(16384*s[0]),R=Math.trunc(16384*s[1]),z=Math.trunc(16384*s[2]);return this.outPositions.emplaceBack(r[0],r[1],p),this.outNormals.emplaceBack(O,R,z),E}addTriangle(r,s,h){this.outIndices.emplaceBack(r,s,h)}addTriangles(r,s,h){if(r.length===0)return;const p=h.length===1,_=ze(),x=ze();for(let E=0;E<r.length;E+=3){const O=s[r[E+0]],R=s[r[E+1]],z=s[r[E+2]],j=p?h[0]:h[r[E+1]],B=p?h[0]:h[r[E+2]];ht(_,O.x,O.y,p?h[0]:h[r[E+0]]);const X=this.addVertex(_,x);ht(_,R.x,R.y,j);const Z=this.addVertex(_,x);ht(_,z.x,z.y,B);const ae=this.addVertex(_,x);this.outIndices.emplaceBack(X,Z,ae)}}addQuad(r,s,h,p,_,x){const E=this.addVertex(r,_,x),O=this.addVertex(s,_,x),R=this.addVertex(h,_,x),z=this.addVertex(p,_,x);this.addTriangle(E,O,R),this.addTriangle(R,z,E)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(r){return this.view.setFloat32(0,r),BigInt(this.view.getUint32(0))}getVec3Bits(r){return this.getBits(r[0])<<64n|this.getBits(r[1])<<32n|this.getBits(r[2])}}class Ns{constructor(r,s,h,p){this.unevaluatedPortals=new Ls,this.portalPolygons=new zg,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new bg,this.vertexNormals=new Ky,this.indexArray=new Zr,this.tileToMeters=Ne(r),this.bridgeProgramConfigurations=new Ks(s,{zoom:h,lut:p},(_=>_!=="fill-tunnel-structure-color")),this.tunnelProgramConfigurations=new Ks(s,{zoom:h,lut:p},(_=>_!=="fill-bridge-guard-rail-color"))}addVertices(r,s){const h=this.unevalVertices.length;for(let p=0;p<r.length;p++)this.unevalVertices.push(r[p]),this.unevalHeights.push(s[p]);return h}addTriangles(r,s,h){const p=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const _ of r)p.push(_+s)}addRenderableRing(r,s,h,p,_,x){const E=[new kt(_.min.x,_.min.y),new kt(_.max.x,_.min.y),new kt(_.max.x,_.max.y),new kt(_.min.x,_.max.y)];for(let O=0;O<h-1;O++){const R=s+O,z=R+1,j=this.unevalVertices[R],B=this.unevalVertices[z];if(!(j.x>=_.min.x&&j.x<=_.max.x&&j.y>=_.min.y&&j.y<=_.max.y||B.x>=_.min.x&&B.x<=_.max.x&&B.y>=_.min.y&&B.y<=_.max.y||ca(j,B,E))||this.isOnBorder(j.x,B.x)||this.isOnBorder(j.y,B.y))continue;const X=Ns.computeEdgeHash(this.unevalVertices[R],this.unevalVertices[z]);let Z,ae=this.vertexHashLookup.get(Ns.computePosHash(j));ae!=null?Z=ae.next:(ae=this.vertexHashLookup.get(Ns.computePosHash(B)),Z=ae!=null?ae.prev:X),this.unevalEdges.push({polygonIdx:r,a:R,b:z,hash:X,portalHash:Z,isTunnel:p,type:"unevaluated",featureInfo:x})}}addPortalCandidates(r,s,h,p,_){if(s.length===0)return;this.portalPolygons.add(r,{geometry:s,zLevel:_});const x=s[0];this.vertexHashLookup.clear();let E=Ns.computeEdgeHash(x[x.length-2],x[x.length-1]);for(let O=0;O<x.length-1;O++){const R=x[O+0],z=x[O+1],j=Ua(z.x-R.x,z.y-R.y),B=vo(j);if(B===0)continue;let X="unevaluated";const Z=p.pointElevation(R),ae=p.pointElevation(z);Math.abs(Z)<.01&&Math.abs(ae)<.01?X="entrance":(this.isOnBorder(R.x,z.x)||this.isOnBorder(R.y,z.y))&&(X="border");const se=Ns.computeEdgeHash(R,z);this.unevaluatedPortals.portals.push({connection:{a:r,b:void 0},va:R,vb:z,vab:j,length:B,hash:se,isTunnel:h,type:X});const pe=Ns.computePosHash(R);this.vertexHashLookup.set(pe,{prev:E,next:se}),E=se}}construct(r){if(this.unevalVertices.length===0)return;const s=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=B=>{B.primitiveLength=this.indexArray.length-B.primitiveOffset},p=new OS(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(r.portals,this.unevalEdges);const _=s(),x=s(),E=s(),O=(B,X)=>{B.sort(((ae,se)=>ae.type===X&&se.type!==X?-1:ae.type!==X&&se.type===X?1:0));const Z=B.findIndex((ae=>ae.type!==X));return Z>=0?Z:B.length};let R=0;this.unevalEdges.length>0&&(R=O(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:R},this.tileToMeters)),h(E);const z=s(),j=s();if(this.unevalEdges.length>0){const B=this.unevalEdges.splice(R),X=O(B,"tunnel")+R;this.unevalEdges.push(...B),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:R},{min:R,max:X})}h(z),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(j),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(x),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(_),this.maskSegments=Ki.simpleSegment(0,j.primitiveOffset,0,j.primitiveLength),this.depthSegments=Ki.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.renderableBridgeSegments=Ki.simpleSegment(0,E.primitiveOffset,0,E.primitiveLength),this.renderableTunnelSegments=Ki.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.shadowCasterSegments=Ki.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength)}update(r,s,h,p,_,x,E,O){this.bridgeProgramConfigurations.updatePaintArrays(r,s,_,h,p,x,E,O),this.tunnelProgramConfigurations.updatePaintArrays(r,s,_,h,p,x,E,O)}upload(r){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=r.createVertexBuffer(this.vertexPositions,MC.members),this.vertexBufferNormal=r.createVertexBuffer(this.vertexNormals,PC.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(r),this.tunnelProgramConfigurations.upload(r))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(r,s,h,p,_){const x=(E,O)=>{for(let R=0;R<O.length-1;R++){const z=O[R].featureIndex,j=O[R+1].vertexStart,B=r.feature(z);E.populatePaintArrays(j,B,z,{},h,s,p,void 0,_)}};x(this.bridgeProgramConfigurations,this.bridgeFeatureSections),x(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(r,s,h,p,_){const x=new Map;for(let E=p;E<_;E++){const O=h[E],R=O.a,z=O.b,j=Ns.computePosHash(r[R]),B=Ns.computePosHash(r[z]);let X=x.get(j);X||(X={},x.set(j,X));let Z=x.get(B);Z||(Z={},x.set(B,Z)),s[R]<=0&&s[z]<=0||(X.to=z,Z.from=R)}return x}isTerminalVertex(r,s){const h=Ns.computePosHash(this.unevalVertices[r]),p=s.get(h);return!p||!p.from||!p.to}constructBridgeStructures(r,s,h,p,_,x){r.clearVertexLookup();const E=this.computeVertexConnections(s,h,p,_.min,_.max),O=1/x,R=.5*O,z=(Yt,on)=>ht(Yt,s[on].x,s[on].y,h[on]*O),j=ze(),B=ze(),X=ze(),Z=ze(),ae=ze(),se=(Yt,on)=>{const At=E.get(Ns.computePosHash(s[on])),Kt=At.from,pt=At.to;if(!Kt||!pt)return;z(j,Kt),z(B,on),z(X,pt),Jr(Z),mr(j,B)||(Cr(ae,B,j),qt(Z,ae)),mr(X,B)||(Cr(ae,X,B),Ie(Z,Z,qt(ae,ae)));const Ct=hi(Z);return Ct>0?vt(Yt,Z,1/Ct):void 0};let pe=Number.POSITIVE_INFINITY;this.sortSubarray(p,_.min,_.max,((Yt,on)=>Yt.featureInfo.featureIndex-on.featureInfo.featureIndex));const we=ze(),be=ze(),Ee=ze(),Ge=ze(),Ue=ze(),$e=ze(),Je=ze(),it=ze(),Mt=ze(),ut=[ze(),ze(),ze(),ze()],Dt=[ze(),ze(),ze(),ze()],ln=[{coord:new kt(0,0),height:0},{coord:new kt(0,0),height:0}],Vt=(Yt,on)=>Yt>on;for(let Yt=_.min;Yt<_.max;Yt++){const on=p[Yt];if(!on.featureInfo.guardRailEnabled||!this.prepareEdgePoints(ln,s,h,on,Vt))continue;const[At,Kt]=ln;if(ht(we,At.coord.x,At.coord.y,O*At.height),ht(be,Kt.coord.x,Kt.coord.y,O*Kt.height),mr(we,be))continue;Cr(Ee,be,we),qt(Ee,Ee);const pt=se(it,on.a)||Ee,Ct=se(Mt,on.b)||Ee;ht(Ge,pt[1],-pt[0],0),qt(Ge,Ge),ht(Ue,Ct[1],-Ct[0],0),qt(Ue,Ue),mn(it,Ge,pt),qt($e,it),mn(it,Ue,Ct),qt(Je,it),Ie(ut[0],we,vt(it,Cr(it,Ge,$e),R)),Ie(ut[1],we,vt(it,Ie(it,Ge,$e),R)),Ie(ut[2],we,vt(it,$e,R)),ut[3]=we,Ie(Dt[0],be,vt(it,Cr(it,Ue,Je),R)),Ie(Dt[1],be,vt(it,Ie(it,Ue,Je),R)),Ie(Dt[2],be,vt(it,Je,R)),Dt[3]=be,pe=this.addFeatureSection(on.featureInfo.featureIndex,pe,this.bridgeFeatureSections,r);const un=r.addVertex(ut[0],Ge,x),Qt=r.addVertex(ut[1],Ge,x),Un=r.addVertex(Dt[0],Ue,x),kn=r.addVertex(Dt[1],Ue,x);r.addTriangle(un,Qt,Un),r.addTriangle(Qt,kn,Un);const Xt=r.addVertex(ut[1],$e,x),an=r.addVertex(ut[2],$e,x),Nn=r.addVertex(Dt[1],Je,x),Cn=r.addVertex(Dt[2],Je,x);r.addTriangle(Xt,an,Nn),r.addTriangle(an,Cn,Nn),$t(Ge,Ge),$t(Ue,Ue);const pn=r.addVertex(ut[2],Ge,x),On=r.addVertex(ut[3],Ge,x),Jn=r.addVertex(Dt[2],Ue,x),or=r.addVertex(Dt[3],Ue,x);r.addTriangle(pn,On,Jn),r.addTriangle(On,or,Jn);const wr=this.isTerminalVertex(on.a,E),ur=this.isTerminalVertex(on.b,E);At.height<.01&&wr&&r.addQuad(ut[3],ut[2],ut[1],ut[0],$t(pt,pt),x),Kt.height<.01&&ur&&r.addQuad(Dt[0],Dt[1],Dt[2],Dt[3],Ct,x)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:r.getVertexCount()})}constructTunnelStructures(r,s,h,p,_,x){r.clearVertexLookup();let E=Number.POSITIVE_INFINITY;const O=(pe,we)=>pe.featureInfo.featureIndex-we.featureInfo.featureIndex;this.sortSubarray(p,_.min,_.max,O),this.sortSubarray(p,x.min,x.max,O);const R=pe=>qt(pe,pe),z=[{coord:new kt(0,0),height:0},{coord:new kt(0,0),height:0}],j=(pe,we)=>pe<we,B=ze(),X=ze(),Z=ze(),ae=ze(),se=ze();for(let pe=_.min;pe<_.max;pe++){if(!this.prepareEdgePoints(z,s,h,p[pe],j))continue;const[we,be]=z,Ee=R(ht(se,-(be.coord.y-we.coord.y),be.coord.x-we.coord.x,0));E=this.addFeatureSection(p[pe].featureInfo.featureIndex,E,this.tunnelFeatureSections,r),r.addQuad(ht(B,we.coord.x,we.coord.y,we.height),ht(X,be.coord.x,be.coord.y,be.height),ht(Z,be.coord.x,be.coord.y,p[pe].isTunnel?-.1:0),ht(ae,we.coord.x,we.coord.y,p[pe].isTunnel?-.1:0),Ee)}for(let pe=x.min;pe<x.max;pe++){const we=p[pe];we.isTunnel&&([we.a,we.b]=[we.b,we.a]);const be=s[we.a],Ee=s[we.b],Ge=R(ht(se,-(Ee.y-be.y),Ee.x-be.x,0));E=this.addFeatureSection(we.featureInfo.featureIndex,E,this.tunnelFeatureSections,r),r.addQuad(ht(B,Ee.x,Ee.y,0),ht(X,be.x,be.y,0),ht(Z,be.x,be.y,h[we.a]+4),ht(ae,Ee.x,Ee.y,h[we.b]+4),Ge),r.addQuad(ht(B,be.x,be.y,0),ht(X,Ee.x,Ee.y,0),ht(Z,Ee.x,Ee.y,h[we.b]+4),ht(ae,be.x,be.y,h[we.a]+4),Ge)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:r.getVertexCount()})}setElevatedPoint(r,s,h,p){r.coord.x=s,r.coord.y=h,r.height=p}prepareEdgePoints(r,s,h,p,_){let x=s[p.a].x,E=s[p.a].y,O=s[p.b].x,R=s[p.b].y,z=h[p.a],j=h[p.b];const B=_(z,0),X=_(j,0);if(B&&X)return this.setElevatedPoint(r[0],x,E,z),this.setElevatedPoint(r[1],O,R,j),!0;if(!B&&!X)return!1;if(B){if(!X){const Z=j/(j-z);O=Gn(O,x,Z),R=Gn(R,E,Z),j=Gn(j,z,Z)}}else{const Z=z/(z-j);x=Gn(x,O,Z),E=Gn(E,R,Z),z=Gn(z,j,Z)}return this.setElevatedPoint(r[0],x,E,z),this.setElevatedPoint(r[1],O,R,j),!0}prepareEdges(r,s){if(s.length===0)return;s.sort(((E,O)=>E.hash===O.hash?O.polygonIdx-E.polygonIdx:O.hash>E.hash?1:-1));let h=0,p=0,_=0,x=s[h].polygonIdx;do p++,(p===s.length||s[h].hash!==s[p].hash)&&((p-h==1||s[p-1].polygonIdx!==x)&&(_<h&&(s[_]=s[h],s[h]=null),s[_].type="none",_++),h=p,h!==s.length&&(x=s[h].polygonIdx));while(h!==s.length);if(s.splice(_),s.length!==0&&r.length!==0){s.sort(((R,z)=>R.portalHash<z.portalHash?1:-1));let E=0,O=0;for(;E!==s.length&&O!==r.length;){const R=s[E],z=r[O];R.portalHash>z.hash?E++:z.hash>R.portalHash?O++:(R.type=z.type,E++)}}}isOnBorder(r,s){return r<=0&&s<=0||r>=nn&&s>=nn}addFeatureSection(r,s,h,p){return r!==s&&(s=r,h.push({featureIndex:r,vertexStart:p.getVertexCount()}),p.clearVertexLookup()),s}sortSubarray(r,s,h,p){const _=r.slice(s,h);_.sort(p),r.splice(s,_.length,..._)}static computeEdgeHash(r,s){return(r.y===s.y&&r.x>s.x||r.y>s.y)&&([r,s]=[s,r]),BigInt(Ns.computePosHash(r))<<32n|BigInt(Ns.computePosHash(s))}static computePosHash(r){return((65535&r.x)<<16|65535&r.y)>>>0}}var Fh,RS={exports:{}},IS=(Fh||(Fh=1,(function(l,r){(function(s){function h(Oe,Re){return Oe>Re?1:Oe<Re?-1:0}var p=function(Oe,Re){Oe===void 0&&(Oe=h),Re===void 0&&(Re=!1),this._compare=Oe,this._root=null,this._size=0,this._noDuplicates=!!Re},_={size:{configurable:!0}};function x(Oe,Re,Et,hn,vn){var _n=vn-hn;if(_n>0){var Ln=hn+Math.floor(_n/2),ar={key:Re[Ln],data:Et[Ln],parent:Oe};return ar.left=x(ar,Re,Et,hn,Ln),ar.right=x(ar,Re,Et,Ln+1,vn),ar}return null}function E(Oe,Re,Et,hn,vn){if(!(Et>=hn)){for(var _n=Oe[Et+hn>>1],Ln=Et-1,ar=hn+1;;){do Ln++;while(vn(Oe[Ln],_n)<0);do ar--;while(vn(Oe[ar],_n)>0);if(Ln>=ar)break;var Hr=Oe[Ln];Oe[Ln]=Oe[ar],Oe[ar]=Hr,Hr=Re[Ln],Re[Ln]=Re[ar],Re[ar]=Hr}E(Oe,Re,Et,ar,vn),E(Oe,Re,ar+1,hn,vn)}}p.prototype.rotateLeft=function(Oe){var Re=Oe.right;Re&&(Oe.right=Re.left,Re.left&&(Re.left.parent=Oe),Re.parent=Oe.parent),Oe.parent?Oe===Oe.parent.left?Oe.parent.left=Re:Oe.parent.right=Re:this._root=Re,Re&&(Re.left=Oe),Oe.parent=Re},p.prototype.rotateRight=function(Oe){var Re=Oe.left;Re&&(Oe.left=Re.right,Re.right&&(Re.right.parent=Oe),Re.parent=Oe.parent),Oe.parent?Oe===Oe.parent.left?Oe.parent.left=Re:Oe.parent.right=Re:this._root=Re,Re&&(Re.right=Oe),Oe.parent=Re},p.prototype._splay=function(Oe){for(;Oe.parent;){var Re=Oe.parent;Re.parent?Re.left===Oe&&Re.parent.left===Re?(this.rotateRight(Re.parent),this.rotateRight(Re)):Re.right===Oe&&Re.parent.right===Re?(this.rotateLeft(Re.parent),this.rotateLeft(Re)):Re.left===Oe&&Re.parent.right===Re?(this.rotateRight(Re),this.rotateLeft(Re)):(this.rotateLeft(Re),this.rotateRight(Re)):Re.left===Oe?this.rotateRight(Re):this.rotateLeft(Re)}},p.prototype.splay=function(Oe){for(var Re,Et,hn,vn,_n;Oe.parent;)(Et=(Re=Oe.parent).parent)&&Et.parent?((hn=Et.parent).left===Et?hn.left=Oe:hn.right=Oe,Oe.parent=hn):(Oe.parent=null,this._root=Oe),vn=Oe.left,_n=Oe.right,Oe===Re.left?(Et&&(Et.left===Re?(Re.right?(Et.left=Re.right,Et.left.parent=Et):Et.left=null,Re.right=Et,Et.parent=Re):(vn?(Et.right=vn,vn.parent=Et):Et.right=null,Oe.left=Et,Et.parent=Oe)),_n?(Re.left=_n,_n.parent=Re):Re.left=null,Oe.right=Re,Re.parent=Oe):(Et&&(Et.right===Re?(Re.left?(Et.right=Re.left,Et.right.parent=Et):Et.right=null,Re.left=Et,Et.parent=Re):(_n?(Et.left=_n,_n.parent=Et):Et.left=null,Oe.right=Et,Et.parent=Oe)),vn?(Re.right=vn,vn.parent=Re):Re.right=null,Oe.left=Re,Re.parent=Oe)},p.prototype.replace=function(Oe,Re){Oe.parent?Oe===Oe.parent.left?Oe.parent.left=Re:Oe.parent.right=Re:this._root=Re,Re&&(Re.parent=Oe.parent)},p.prototype.minNode=function(Oe){if(Oe===void 0&&(Oe=this._root),Oe)for(;Oe.left;)Oe=Oe.left;return Oe},p.prototype.maxNode=function(Oe){if(Oe===void 0&&(Oe=this._root),Oe)for(;Oe.right;)Oe=Oe.right;return Oe},p.prototype.insert=function(Oe,Re){var Et=this._root,hn=null,vn=this._compare;if(this._noDuplicates)for(;Et;){if(hn=Et,vn(Et.key,Oe)===0)return;Et=vn(Et.key,Oe)<0?Et.right:Et.left}else for(;Et;)hn=Et,Et=vn(Et.key,Oe)<0?Et.right:Et.left;return Et={key:Oe,data:Re,left:null,right:null,parent:hn},hn?vn(hn.key,Et.key)<0?hn.right=Et:hn.left=Et:this._root=Et,this.splay(Et),this._size++,Et},p.prototype.find=function(Oe){for(var Re=this._root,Et=this._compare;Re;){var hn=Et(Re.key,Oe);if(hn<0)Re=Re.right;else{if(!(hn>0))return Re;Re=Re.left}}return null},p.prototype.contains=function(Oe){for(var Re=this._root,Et=this._compare;Re;){var hn=Et(Oe,Re.key);if(hn===0)return!0;Re=hn<0?Re.left:Re.right}return!1},p.prototype.remove=function(Oe){var Re=this.find(Oe);if(!Re)return!1;if(this.splay(Re),Re.left)if(Re.right){var Et=this.minNode(Re.right);Et.parent!==Re&&(this.replace(Et,Et.right),Et.right=Re.right,Et.right.parent=Et),this.replace(Re,Et),Et.left=Re.left,Et.left.parent=Et}else this.replace(Re,Re.left);else this.replace(Re,Re.right);return this._size--,!0},p.prototype.removeNode=function(Oe){if(!Oe)return!1;if(this.splay(Oe),Oe.left)if(Oe.right){var Re=this.minNode(Oe.right);Re.parent!==Oe&&(this.replace(Re,Re.right),Re.right=Oe.right,Re.right.parent=Re),this.replace(Oe,Re),Re.left=Oe.left,Re.left.parent=Re}else this.replace(Oe,Oe.left);else this.replace(Oe,Oe.right);return this._size--,!0},p.prototype.erase=function(Oe){var Re=this.find(Oe);if(Re){this.splay(Re);var Et=Re.left,hn=Re.right,vn=null;Et&&(Et.parent=null,vn=this.maxNode(Et),this.splay(vn),this._root=vn),hn&&(Et?vn.right=hn:this._root=hn,hn.parent=vn),this._size--}},p.prototype.pop=function(){var Oe=this._root,Re=null;if(Oe){for(;Oe.left;)Oe=Oe.left;Re={key:Oe.key,data:Oe.data},this.remove(Oe.key)}return Re},p.prototype.next=function(Oe){var Re=Oe;if(Re)if(Re.right)for(Re=Re.right;Re&&Re.left;)Re=Re.left;else for(Re=Oe.parent;Re&&Re.right===Oe;)Oe=Re,Re=Re.parent;return Re},p.prototype.prev=function(Oe){var Re=Oe;if(Re)if(Re.left)for(Re=Re.left;Re&&Re.right;)Re=Re.right;else for(Re=Oe.parent;Re&&Re.left===Oe;)Oe=Re,Re=Re.parent;return Re},p.prototype.forEach=function(Oe){for(var Re=this._root,Et=[],hn=!1,vn=0;!hn;)Re?(Et.push(Re),Re=Re.left):Et.length>0?(Oe(Re=Et.pop(),vn++),Re=Re.right):hn=!0;return this},p.prototype.range=function(Oe,Re,Et,hn){for(var vn=[],_n=this._compare,Ln=this._root;vn.length!==0||Ln;)if(Ln)vn.push(Ln),Ln=Ln.left;else{if(_n((Ln=vn.pop()).key,Re)>0)break;if(_n(Ln.key,Oe)>=0&&Et.call(hn,Ln))return this;Ln=Ln.right}return this},p.prototype.keys=function(){for(var Oe=this._root,Re=[],Et=[],hn=!1;!hn;)Oe?(Re.push(Oe),Oe=Oe.left):Re.length>0?(Oe=Re.pop(),Et.push(Oe.key),Oe=Oe.right):hn=!0;return Et},p.prototype.values=function(){for(var Oe=this._root,Re=[],Et=[],hn=!1;!hn;)Oe?(Re.push(Oe),Oe=Oe.left):Re.length>0?(Oe=Re.pop(),Et.push(Oe.data),Oe=Oe.right):hn=!0;return Et},p.prototype.at=function(Oe){for(var Re=this._root,Et=[],hn=!1,vn=0;!hn;)if(Re)Et.push(Re),Re=Re.left;else if(Et.length>0){if(Re=Et.pop(),vn===Oe)return Re;vn++,Re=Re.right}else hn=!0;return null},p.prototype.load=function(Oe,Re,Et){if(Oe===void 0&&(Oe=[]),Re===void 0&&(Re=[]),Et===void 0&&(Et=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var hn=Oe.length;return Et&&E(Oe,Re,0,hn-1,this._compare),this._root=x(null,Oe,Re,0,hn),this._size=hn,this},p.prototype.min=function(){var Oe=this.minNode(this._root);return Oe?Oe.key:null},p.prototype.max=function(){var Oe=this.maxNode(this._root);return Oe?Oe.key:null},p.prototype.isEmpty=function(){return this._root===null},_.size.get=function(){return this._size},p.createTree=function(Oe,Re,Et,hn,vn){return new p(Et,vn).load(Oe,Re,hn)},Object.defineProperties(p.prototype,_);var O=0,R=1,z=2,j=3,B=0,X=1,Z=2,ae=3;function se(Oe,Re,Et){Re===null?(Oe.inOut=!1,Oe.otherInOut=!0):(Oe.isSubject===Re.isSubject?(Oe.inOut=!Re.inOut,Oe.otherInOut=Re.otherInOut):(Oe.inOut=!Re.otherInOut,Oe.otherInOut=Re.isVertical()?!Re.inOut:Re.inOut),Re&&(Oe.prevInResult=!pe(Re,Et)||Re.isVertical()?Re.prevInResult:Re));var hn=pe(Oe,Et);Oe.resultTransition=hn?(function(vn,_n){var Ln,ar=!vn.inOut,Hr=!vn.otherInOut;switch(_n){case B:Ln=ar&&Hr;break;case X:Ln=ar||Hr;break;case ae:Ln=ar^Hr;break;case Z:Ln=vn.isSubject?ar&&!Hr:Hr&&!ar}return Ln?1:-1})(Oe,Et):0}function pe(Oe,Re){switch(Oe.type){case O:switch(Re){case B:return!Oe.otherInOut;case X:return Oe.otherInOut;case Z:return Oe.isSubject&&Oe.otherInOut||!Oe.isSubject&&!Oe.otherInOut;case ae:return!0}break;case z:return Re===B||Re===X;case j:return Re===Z;case R:return!1}return!1}var we=function(Oe,Re,Et,hn,vn){this.left=Re,this.point=Oe,this.otherEvent=Et,this.isSubject=hn,this.type=vn||O,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},be={inResult:{configurable:!0}};function Ee(Oe,Re){return Oe[0]===Re[0]&&Oe[1]===Re[1]}we.prototype.isBelow=function(Oe){var Re=this.point,Et=this.otherEvent.point;return this.left?(Re[0]-Oe[0])*(Et[1]-Oe[1])-(Et[0]-Oe[0])*(Re[1]-Oe[1])>0:(Et[0]-Oe[0])*(Re[1]-Oe[1])-(Re[0]-Oe[0])*(Et[1]-Oe[1])>0},we.prototype.isAbove=function(Oe){return!this.isBelow(Oe)},we.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},be.inResult.get=function(){return this.resultTransition!==0},we.prototype.clone=function(){var Oe=new we(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Oe.contourId=this.contourId,Oe.resultTransition=this.resultTransition,Oe.prevInResult=this.prevInResult,Oe.isExteriorRing=this.isExteriorRing,Oe.inOut=this.inOut,Oe.otherInOut=this.otherInOut,Oe},Object.defineProperties(we.prototype,be);var Ge=11102230246251565e-32,Ue=134217729,$e=(3+8*Ge)*Ge;function Je(Oe,Re,Et,hn,vn){var _n,Ln,ar,Hr,Gr=Re[0],Pr=hn[0],Ni=0,Aa=0;Pr>Gr==Pr>-Gr?(_n=Gr,Gr=Re[++Ni]):(_n=Pr,Pr=hn[++Aa]);var Er=0;if(Ni<Oe&&Aa<Et)for(Pr>Gr==Pr>-Gr?(ar=_n-((Ln=Gr+_n)-Gr),Gr=Re[++Ni]):(ar=_n-((Ln=Pr+_n)-Pr),Pr=hn[++Aa]),_n=Ln,ar!==0&&(vn[Er++]=ar);Ni<Oe&&Aa<Et;)Pr>Gr==Pr>-Gr?(ar=_n-((Ln=_n+Gr)-(Hr=Ln-_n))+(Gr-Hr),Gr=Re[++Ni]):(ar=_n-((Ln=_n+Pr)-(Hr=Ln-_n))+(Pr-Hr),Pr=hn[++Aa]),_n=Ln,ar!==0&&(vn[Er++]=ar);for(;Ni<Oe;)ar=_n-((Ln=_n+Gr)-(Hr=Ln-_n))+(Gr-Hr),Gr=Re[++Ni],_n=Ln,ar!==0&&(vn[Er++]=ar);for(;Aa<Et;)ar=_n-((Ln=_n+Pr)-(Hr=Ln-_n))+(Pr-Hr),Pr=hn[++Aa],_n=Ln,ar!==0&&(vn[Er++]=ar);return _n===0&&Er!==0||(vn[Er++]=_n),Er}function it(Oe){return new Float64Array(Oe)}var Mt=33306690738754716e-32,ut=22204460492503146e-32,Dt=11093356479670487e-47,ln=it(4),Vt=it(8),Yt=it(12),on=it(16),At=it(4);function Kt(Oe,Re,Et){var hn=(function(vn,_n,Ln,ar,Hr,Gr){var Pr=(_n-Gr)*(Ln-Hr),Ni=(vn-Hr)*(ar-Gr),Aa=Pr-Ni;if(Pr===0||Ni===0||Pr>0!=Ni>0)return Aa;var Er=Math.abs(Pr+Ni);return Math.abs(Aa)>=Mt*Er?Aa:-(function(ia,Ui,Ci,_a,Qi,$i,Xi){var Pi,Or,zi,va,nr,si,ea,Oa,aa,Mo,ji,mo,rc,zs,Ss,ic,Kf,Po,Vo=ia-Qi,js=Ci-Qi,xl=Ui-$i,el=_a-$i;ln[0]=(Ss=(Oa=Vo-(ea=(si=Ue*Vo)-(si-Vo)))*(Mo=el-(aa=(si=Ue*el)-(si-el)))-((zs=Vo*el)-ea*aa-Oa*aa-ea*Mo))-((ji=Ss-(Kf=(Oa=xl-(ea=(si=Ue*xl)-(si-xl)))*(Mo=js-(aa=(si=Ue*js)-(si-js)))-((ic=xl*js)-ea*aa-Oa*aa-ea*Mo)))+(nr=Ss-ji))+(nr-Kf),ln[1]=(rc=zs-((mo=zs+ji)-(nr=mo-zs))+(ji-nr))-((ji=rc-ic)+(nr=rc-ji))+(nr-ic),ln[2]=mo-((Po=mo+ji)-(nr=Po-mo))+(ji-nr),ln[3]=Po;var Xg=(function(hBe,dF){for(var fF=dF[0],TM=1;TM<4;TM++)fF+=dF[TM];return fF})(0,ln),Gb=ut*Xi;if(Xg>=Gb||-Xg>=Gb||(Pi=ia-(Vo+(nr=ia-Vo))+(nr-Qi),zi=Ci-(js+(nr=Ci-js))+(nr-Qi),Or=Ui-(xl+(nr=Ui-xl))+(nr-$i),va=_a-(el+(nr=_a-el))+(nr-$i),Pi===0&&Or===0&&zi===0&&va===0)||(Gb=Dt*Xi+$e*Math.abs(Xg),(Xg+=Vo*va+el*Pi-(xl*zi+js*Or))>=Gb||-Xg>=Gb))return Xg;At[0]=(Ss=(Oa=Pi-(ea=(si=Ue*Pi)-(si-Pi)))*(Mo=el-(aa=(si=Ue*el)-(si-el)))-((zs=Pi*el)-ea*aa-Oa*aa-ea*Mo))-((ji=Ss-(Kf=(Oa=Or-(ea=(si=Ue*Or)-(si-Or)))*(Mo=js-(aa=(si=Ue*js)-(si-js)))-((ic=Or*js)-ea*aa-Oa*aa-ea*Mo)))+(nr=Ss-ji))+(nr-Kf),At[1]=(rc=zs-((mo=zs+ji)-(nr=mo-zs))+(ji-nr))-((ji=rc-ic)+(nr=rc-ji))+(nr-ic),At[2]=mo-((Po=mo+ji)-(nr=Po-mo))+(ji-nr),At[3]=Po;var mre=Je(4,ln,4,At,Vt);At[0]=(Ss=(Oa=Vo-(ea=(si=Ue*Vo)-(si-Vo)))*(Mo=va-(aa=(si=Ue*va)-(si-va)))-((zs=Vo*va)-ea*aa-Oa*aa-ea*Mo))-((ji=Ss-(Kf=(Oa=xl-(ea=(si=Ue*xl)-(si-xl)))*(Mo=zi-(aa=(si=Ue*zi)-(si-zi)))-((ic=xl*zi)-ea*aa-Oa*aa-ea*Mo)))+(nr=Ss-ji))+(nr-Kf),At[1]=(rc=zs-((mo=zs+ji)-(nr=mo-zs))+(ji-nr))-((ji=rc-ic)+(nr=rc-ji))+(nr-ic),At[2]=mo-((Po=mo+ji)-(nr=Po-mo))+(ji-nr),At[3]=Po;var gre=Je(mre,Vt,4,At,Yt);At[0]=(Ss=(Oa=Pi-(ea=(si=Ue*Pi)-(si-Pi)))*(Mo=va-(aa=(si=Ue*va)-(si-va)))-((zs=Pi*va)-ea*aa-Oa*aa-ea*Mo))-((ji=Ss-(Kf=(Oa=Or-(ea=(si=Ue*Or)-(si-Or)))*(Mo=zi-(aa=(si=Ue*zi)-(si-zi)))-((ic=Or*zi)-ea*aa-Oa*aa-ea*Mo)))+(nr=Ss-ji))+(nr-Kf),At[1]=(rc=zs-((mo=zs+ji)-(nr=mo-zs))+(ji-nr))-((ji=rc-ic)+(nr=rc-ji))+(nr-ic),At[2]=mo-((Po=mo+ji)-(nr=Po-mo))+(ji-nr),At[3]=Po;var yre=Je(gre,Yt,4,At,on);return on[yre-1]})(vn,_n,Ln,ar,Hr,Gr,Er)})(Oe[0],Oe[1],Re[0],Re[1],Et[0],Et[1]);return hn>0?-1:hn<0?1:0}function pt(Oe,Re){var Et=Oe.point,hn=Re.point;return Et[0]>hn[0]?1:Et[0]<hn[0]?-1:Et[1]!==hn[1]?Et[1]>hn[1]?1:-1:(function(vn,_n,Ln,ar){return vn.left!==_n.left?vn.left?1:-1:Kt(Ln,vn.otherEvent.point,_n.otherEvent.point)!==0?vn.isBelow(_n.otherEvent.point)?-1:1:!vn.isSubject&&_n.isSubject?1:-1})(Oe,Re,Et)}function Ct(Oe,Re,Et){var hn=new we(Re,!1,Oe,Oe.isSubject),vn=new we(Re,!0,Oe.otherEvent,Oe.isSubject);return Ee(Oe.point,Oe.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Oe),hn.contourId=vn.contourId=Oe.contourId,pt(vn,Oe.otherEvent)>0&&(Oe.otherEvent.left=!0,vn.left=!1),Oe.otherEvent.otherEvent=vn,Oe.otherEvent=hn,Et.push(vn),Et.push(hn),Et}function un(Oe,Re){return Oe[0]*Re[1]-Oe[1]*Re[0]}function Qt(Oe,Re){return Oe[0]*Re[0]+Oe[1]*Re[1]}function Un(Oe,Re,Et){var hn=(function(Hr,Gr,Pr,Ni,Aa){var Er=[Gr[0]-Hr[0],Gr[1]-Hr[1]],ia=[Ni[0]-Pr[0],Ni[1]-Pr[1]];function Ui(si,ea,Oa){return[si[0]+ea*Oa[0],si[1]+ea*Oa[1]]}var Ci=[Pr[0]-Hr[0],Pr[1]-Hr[1]],_a=un(Er,ia),Qi=_a*_a,$i=Qt(Er,Er);if(Qi>0){var Xi=un(Ci,ia)/_a;if(Xi<0||Xi>1)return null;var Pi=un(Ci,Er)/_a;return Pi<0||Pi>1?null:Xi===0||Xi===1?[Ui(Hr,Xi,Er)]:Pi===0||Pi===1?[Ui(Pr,Pi,ia)]:[Ui(Hr,Xi,Er)]}if((Qi=(_a=un(Ci,Er))*_a)>0)return null;var Or=Qt(Er,Ci)/$i,zi=Or+Qt(Er,ia)/$i,va=Math.min(Or,zi),nr=Math.max(Or,zi);return va<=1&&nr>=0?va===1?[Ui(Hr,va>0?va:0,Er)]:nr===0?[Ui(Hr,nr<1?nr:1,Er)]:[Ui(Hr,va>0?va:0,Er),Ui(Hr,nr<1?nr:1,Er)]:null})(Oe.point,Oe.otherEvent.point,Re.point,Re.otherEvent.point),vn=hn?hn.length:0;if(vn===0||vn===1&&(Ee(Oe.point,Re.point)||Ee(Oe.otherEvent.point,Re.otherEvent.point))||vn===2&&Oe.isSubject===Re.isSubject)return 0;if(vn===1)return Ee(Oe.point,hn[0])||Ee(Oe.otherEvent.point,hn[0])||Ct(Oe,hn[0],Et),Ee(Re.point,hn[0])||Ee(Re.otherEvent.point,hn[0])||Ct(Re,hn[0],Et),1;var _n=[],Ln=!1,ar=!1;return Ee(Oe.point,Re.point)?Ln=!0:pt(Oe,Re)===1?_n.push(Re,Oe):_n.push(Oe,Re),Ee(Oe.otherEvent.point,Re.otherEvent.point)?ar=!0:pt(Oe.otherEvent,Re.otherEvent)===1?_n.push(Re.otherEvent,Oe.otherEvent):_n.push(Oe.otherEvent,Re.otherEvent),Ln&&ar||Ln?(Re.type=R,Oe.type=Re.inOut===Oe.inOut?z:j,Ln&&!ar&&Ct(_n[1].otherEvent,_n[0].point,Et),2):ar?(Ct(_n[0],_n[1].point,Et),3):_n[0]!==_n[3].otherEvent?(Ct(_n[0],_n[1].point,Et),Ct(_n[1],_n[2].point,Et),3):(Ct(_n[0],_n[1].point,Et),Ct(_n[3].otherEvent,_n[2].point,Et),3)}function kn(Oe,Re){if(Oe===Re)return 0;if(Kt(Oe.point,Oe.otherEvent.point,Re.point)!==0||Kt(Oe.point,Oe.otherEvent.point,Re.otherEvent.point)!==0)return Ee(Oe.point,Re.point)?Oe.isBelow(Re.otherEvent.point)?-1:1:Oe.point[0]===Re.point[0]?Oe.point[1]<Re.point[1]?-1:1:pt(Oe,Re)===1?Re.isAbove(Oe.point)?-1:1:Oe.isBelow(Re.point)?-1:1;if(Oe.isSubject!==Re.isSubject)return Oe.isSubject?-1:1;var Et=Oe.point,hn=Re.point;return Et[0]===hn[0]&&Et[1]===hn[1]?(Et=Oe.otherEvent.point)[0]===(hn=Re.otherEvent.point)[0]&&Et[1]===hn[1]?0:Oe.contourId>Re.contourId?1:-1:pt(Oe,Re)===1?1:-1}var Xt=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function an(Oe,Re,Et,hn){var vn,_n=Oe+1,Ln=Re[Oe].point,ar=Re.length;for(_n<ar&&(vn=Re[_n].point);_n<ar&&vn[0]===Ln[0]&&vn[1]===Ln[1];){if(!Et[_n])return _n;++_n<ar&&(vn=Re[_n].point)}for(_n=Oe-1;Et[_n]&&_n>hn;)_n--;return _n}Xt.prototype.isExterior=function(){return this.holeOf==null};var Nn=pn,Cn=pn;function pn(Oe,Re){if(!(this instanceof pn))return new pn(Oe,Re);if(this.data=Oe||[],this.length=this.data.length,this.compare=Re||On,this.length>0)for(var Et=(this.length>>1)-1;Et>=0;Et--)this._down(Et)}function On(Oe,Re){return Oe<Re?-1:Oe>Re?1:0}pn.prototype={push:function(Oe){this.data.push(Oe),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Oe=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Oe}},peek:function(){return this.data[0]},_up:function(Oe){for(var Re=this.data,Et=this.compare,hn=Re[Oe];Oe>0;){var vn=Oe-1>>1,_n=Re[vn];if(Et(hn,_n)>=0)break;Re[Oe]=_n,Oe=vn}Re[Oe]=hn},_down:function(Oe){for(var Re=this.data,Et=this.compare,hn=this.length>>1,vn=Re[Oe];Oe<hn;){var _n=1+(Oe<<1),Ln=_n+1,ar=Re[_n];if(Ln<this.length&&Et(Re[Ln],ar)<0&&(_n=Ln,ar=Re[Ln]),Et(ar,vn)>=0)break;Re[Oe]=ar,Oe=_n}Re[Oe]=vn}},Nn.default=Cn;var Jn=Math.max,or=Math.min,wr=0;function ur(Oe,Re,Et,hn,vn,_n){var Ln,ar,Hr,Gr,Pr,Ni;for(Ln=0,ar=Oe.length-1;Ln<ar;Ln++)if(Gr=Oe[Ln+1],Pr=new we(Hr=Oe[Ln],!1,void 0,Re),Ni=new we(Gr,!1,Pr,Re),Pr.otherEvent=Ni,Hr[0]!==Gr[0]||Hr[1]!==Gr[1]){Pr.contourId=Ni.contourId=Et,_n||(Pr.isExteriorRing=!1,Ni.isExteriorRing=!1),pt(Pr,Ni)>0?Ni.left=!0:Pr.left=!0;var Aa=Hr[0],Er=Hr[1];vn[0]=or(vn[0],Aa),vn[1]=or(vn[1],Er),vn[2]=Jn(vn[2],Aa),vn[3]=Jn(vn[3],Er),hn.push(Pr),hn.push(Ni)}}var Xr=[];function Lr(Oe,Re,Et){typeof Oe[0][0][0]=="number"&&(Oe=[Oe]),typeof Re[0][0][0]=="number"&&(Re=[Re]);var hn=(function(Er,ia,Ui){var Ci=null;return Er.length*ia.length==0&&(Ui===B?Ci=Xr:Ui===Z?Ci=Er:Ui!==X&&Ui!==ae||(Ci=Er.length===0?ia:Er)),Ci})(Oe,Re,Et);if(hn)return hn===Xr?null:hn;var vn=[1/0,1/0,-1/0,-1/0],_n=[1/0,1/0,-1/0,-1/0],Ln=(function(Er,ia,Ui,Ci,_a){var Qi,$i,Xi,Pi,Or,zi,va=new Nn(null,pt);for(Xi=0,Pi=Er.length;Xi<Pi;Xi++)for(Or=0,zi=(Qi=Er[Xi]).length;Or<zi;Or++)($i=Or===0)&&wr++,ur(Qi[Or],!0,wr,va,Ui,$i);for(Xi=0,Pi=ia.length;Xi<Pi;Xi++)for(Or=0,zi=(Qi=ia[Xi]).length;Or<zi;Or++)$i=Or===0,_a===Z&&($i=!1),$i&&wr++,ur(Qi[Or],!1,wr,va,Ci,$i);return va})(Oe,Re,vn,_n,Et);if(hn=(function(Er,ia,Ui,Ci,_a){var Qi=null;return(Ui[0]>Ci[2]||Ci[0]>Ui[2]||Ui[1]>Ci[3]||Ci[1]>Ui[3])&&(_a===B?Qi=Xr:_a===Z?Qi=Er:_a!==X&&_a!==ae||(Qi=Er.concat(ia))),Qi})(Oe,Re,vn,_n,Et))return hn===Xr?null:hn;for(var ar=(function(Er){var ia,Ui,Ci=(function(Xi){var Pi,Or,zi,va,nr=[];for(Or=0,zi=Xi.length;Or<zi;Or++)((Pi=Xi[Or]).left&&Pi.inResult||!Pi.left&&Pi.otherEvent.inResult)&&nr.push(Pi);for(var si=!1;!si;)for(si=!0,Or=0,zi=nr.length;Or<zi;Or++)Or+1<zi&&pt(nr[Or],nr[Or+1])===1&&(va=nr[Or],nr[Or]=nr[Or+1],nr[Or+1]=va,si=!1);for(Or=0,zi=nr.length;Or<zi;Or++)(Pi=nr[Or]).otherPos=Or;for(Or=0,zi=nr.length;Or<zi;Or++)(Pi=nr[Or]).left||(va=Pi.otherPos,Pi.otherPos=Pi.otherEvent.otherPos,Pi.otherEvent.otherPos=va);return nr})(Er),_a={},Qi=[],$i=function(){if(!_a[ia]){var Xi=Qi.length,Pi=(function(nr,si,ea){var Oa=new Xt;if(nr.prevInResult!=null){var aa=nr.prevInResult,Mo=aa.outputContourId;if(aa.resultTransition>0){var ji=si[Mo];if(ji.holeOf!=null){var mo=ji.holeOf;si[mo].holeIds.push(ea),Oa.holeOf=mo,Oa.depth=si[Mo].depth}else si[Mo].holeIds.push(ea),Oa.holeOf=Mo,Oa.depth=si[Mo].depth+1}else Oa.holeOf=null,Oa.depth=si[Mo].depth}else Oa.holeOf=null,Oa.depth=0;return Oa})(Ci[ia],Qi,Xi),Or=function(nr){_a[nr]=!0,nr<Ci.length&&Ci[nr]&&(Ci[nr].outputContourId=Xi)},zi=ia,va=ia;for(Pi.points.push(Ci[ia].point);Or(zi),Or(zi=Ci[zi].otherPos),Pi.points.push(Ci[zi].point),!((zi=an(zi,Ci,_a,va))==va||zi>=Ci.length)&&Ci[zi];);Qi.push(Pi)}};for(ia=0,Ui=Ci.length;ia<Ui;ia++)$i();return Qi})((function(Er,ia,Ui,Ci,_a,Qi){for(var $i,Xi,Pi,Or=new p(kn),zi=[],va=Math.min(Ci[2],_a[2]);Er.length!==0;){var nr=Er.pop();if(zi.push(nr),Qi===B&&nr.point[0]>va||Qi===Z&&nr.point[0]>Ci[2])break;if(nr.left){Xi=$i=Or.insert(nr),$i=$i!==(Pi=Or.minNode())?Or.prev($i):null,Xi=Or.next(Xi);var si=$i?$i.key:null;if(se(nr,si,Qi),Xi&&Un(nr,Xi.key,Er)===2&&(se(nr,si,Qi),se(Xi.key,nr,Qi)),$i&&Un($i.key,nr,Er)===2){var ea=$i;se(si,(ea=ea!==Pi?Or.prev(ea):null)?ea.key:null,Qi),se(nr,si,Qi)}}else Xi=$i=Or.find(nr=nr.otherEvent),$i&&Xi&&($i=$i!==Pi?Or.prev($i):null,Xi=Or.next(Xi),Or.remove(nr),Xi&&$i&&Un($i.key,Xi.key,Er))}return zi})(Ln,0,0,vn,_n,Et)),Hr=[],Gr=0;Gr<ar.length;Gr++){var Pr=ar[Gr];if(Pr.isExterior()){for(var Ni=[Pr.points],Aa=0;Aa<Pr.holeIds.length;Aa++)Ni.push(ar[Pr.holeIds[Aa]].points);Hr.push(Ni)}}return Hr}var Ji={UNION:X,DIFFERENCE:Z,INTERSECTION:B,XOR:ae};s.diff=function(Oe,Re){return Lr(Oe,Re,Z)},s.intersection=function(Oe,Re){return Lr(Oe,Re,B)},s.operations=Ji,s.union=function(Oe,Re){return Lr(Oe,Re,X)},s.xor=function(Oe,Re){return Lr(Oe,Re,ae)},Object.defineProperty(s,"__esModule",{value:!0})})(r)})(0,RS.exports)),RS.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function kd(l,r,s,h){const p=[],_=h===0?(x,E,O,R,z,j)=>{x.push(new kt(j,O+(j-E)/(R-E)*(z-O)))}:(x,E,O,R,z,j)=>{x.push(new kt(E+(j-O)/(z-O)*(R-E),j))};for(const x of l){const E=[];for(const O of x){if(O.length<=2)continue;const R=[];for(let B=0;B<O.length-1;B++){const X=O[B].x,Z=O[B].y,ae=O[B+1].x,se=O[B+1].y,pe=h===0?X:Z,we=h===0?ae:se;pe<r?we>r&&_(R,X,Z,ae,se,r):pe>s?we<s&&_(R,X,Z,ae,se,s):R.push(O[B]),we<r&&pe>=r&&_(R,X,Z,ae,se,r),we>s&&pe<=s&&_(R,X,Z,ae,se,s)}let z=O[O.length-1];const j=h===0?z.x:z.y;j>=r&&j<=s&&R.push(z),R.length&&(z=R[R.length-1],R[0].x===z.x&&R[0].y===z.y||R.push(R[0]),E.push(R))}E.length&&p.push(E)}return p}function DS(l,r){const s=sb(l),h=sb([r]),p=IS.intersection(s,h);return p==null?[]:kS(p)}function RC(l,r){let h=sb(l,65536);for(;r.valid();r.next()){const[p,_]=r.get(),x=p.x*65536,E=p.y*65536,O=_.x*65536,R=_.y*65536,z=O-x,j=R-E,B=Math.hypot(z,j),X=Math.trunc(j/B*3),Z=-Math.trunc(z/B*3);h=IS.diff(h,[[[x,E],[O,R],[O+X,R+Z],[x+X,E+Z],[x,E]]])}return kS(h,1/65536)}function sb(l,r=1){return[l.map((s=>s.map((h=>[h.x*r,h.y*r]))))]}function kS(l,r=1){return l.map((s=>s.map(((h,p)=>{const _=h.map((x=>new kt(x[0]*r,x[1]*r).round()));return p>0&&_.reverse(),_}))))}class lb{constructor(r,s){this.layoutVertexArray=new Rs,this.indexArray=new Zr,this.lineIndexArray=new Qo,this.triangleSegments=new Ki,this.lineSegments=new Ki,this.programConfigurations=new Ks(r.layers,{zoom:r.zoom,lut:r.lut}),this.uploaded=!1,s&&(this.elevatedLayoutVertexArray=new kh)}update(r,s,h,p,_,x,E,O){this.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E,O)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Lg.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.lineIndexBuffer=r.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=r.createVertexBuffer(this.elevatedLayoutVertexArray,ES.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(r,s,h,p,_,x,E){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,s,h,p,_,x,void 0,E)}}class cb{constructor(r){this.zoom=r.zoom,this.pixelRatio=r.pixelRatio,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.fqid)),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=r.lut,this.bufferData=new lb(r,!1),this.elevationBufferData=new lb(r,!0),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.projection=r.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=r.sourceLayerIndex,this.worldview=r.worldview}updateFootprints(r,s){}populate(r,s,h,p){this.hasPattern=Nv("fill",this.layers,this.pixelRatio,s);const _=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:E,id:O,index:R,sourceLayerIndex:z}of r){const j=this.layers[0]._featureFilter.needGeometry,B=Tt(E,j);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom,{worldview:this.worldview}),B,h))continue;const X=_?_.evaluate(B,{},h,s.availableImages):void 0,Z={id:O,properties:E.properties,type:E.type,sourceLayerIndex:z,index:R,geometry:j?B.geometry:We(E,h,p),patterns:{},sortKey:X};x.push(Z)}_&&x.sort(((E,O)=>E.sortKey-O.sortKey));for(const E of x){const{geometry:O,index:R,sourceLayerIndex:z}=E;if(this.hasPattern){const j=zv("fill",this.layers,E,this.zoom,this.pixelRatio,s);this.patternFeatures.push(j)}else this.addFeature(E,O,R,h,{},s.availableImages,s.brightness,s.elevationFeatures);s.featureIndex.insert(r[R].feature,O,R,z,this.index)}}update(r,s,h,p,_,x,E){this.bufferData.update(r,s,h,p,_,x,E,this.worldview),this.elevationBufferData.update(r,s,h,p,_,x,E,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(r,s,h,p,_,x,E,this.worldview)}addFeatures(r,s,h,p,_,x){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,s,h,p,x,r.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(r){this.bufferData.upload(r),this.elevationBufferData.upload(r),this.elevatedStructures&&this.elevatedStructures.upload(r)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(r,s,h,p,_,x=[],E,O){const R=m_(s,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(r,R,p,h,O):this.addGeometry(R,this.bufferData),this.bufferData.populatePaintArrays(r,h,_,x,p,E,this.worldview),this.elevationBufferData.populatePaintArrays(r,h,_,x,p,E,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(r,s,h,p,_){this.elevatedStructures&&(this.elevatedStructures.construct(r),this.elevatedStructures.populatePaintArrays(s,h,p,_,this.worldview))}addElevatedRoadFeature(r,s,h,p,_){const x=new Array,E=Li.getElevationFeature(r,_);if(!E)return void this.addGeometry(s,this.bufferData);{const R=this.clipPolygonsToTile(s,1);R.length>0&&x.push({polygons:R,elevationFeature:E,elevationTileID:h})}const O={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(r,{},h),featureIndex:p};for(const R of x)if(R.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Ns(R.elevationTileID,this.layers,this.zoom,this.lut));const j=R.elevationFeature.isTunnel();let B=0;r.properties.hasOwnProperty(zn)&&(B=+r.properties[zn]);for(const X of R.polygons)this.elevatedStructures.addPortalCandidates(R.elevationFeature.id,X,j,R.elevationFeature,B)}R.elevationFeature.constantHeight==null&&(R.polygons=this.prepareElevatedPolygons(R.polygons,R.elevationFeature,R.elevationTileID));const z=new qr(h,R.elevationTileID);this.addElevatedGeometry(R.polygons,z,R.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p,O)}}addElevatedGeometry(r,s,h,p,_,x){const E={elevation:h,elevationSampler:s,bias:p,index:_,featureInfo:x},[O,R]=this.addGeometry(r,this.elevationBufferData,E);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:O,max:R}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,O),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,R))}addGeometry(r,s,h){let p=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,x=null;h&&(x=h.elevationSampler.constantElevation(h.elevation,h.bias),x!=null&&(p=x,_=x));const E=(O,R,z)=>{if(h!=null)if(R.push(O),x!=null)s.elevatedLayoutVertexArray.emplaceBack(x),z.push(x);else{const j=h.elevationSampler.pointElevation(O,h.elevation,h.bias);s.elevatedLayoutVertexArray.emplaceBack(j),z.push(j),p=Math.min(p,j),_=Math.max(_,j)}};for(const O of r){let R=0;for(const be of O)R+=be.length;const z=s.triangleSegments.prepareSegment(R,s.layoutVertexArray,s.indexArray),j=z.vertexLength,B=[],X=[],Z=[],ae=[],se=[],pe=s.layoutVertexArray.length;for(const be of O){if(be.length===0)continue;be!==O[0]&&X.push(B.length/2);const Ee=s.lineSegments.prepareSegment(be.length,s.layoutVertexArray,s.lineIndexArray),Ge=Ee.vertexLength;h&&se.push(s.layoutVertexArray.length-pe),E(be[0],Z,ae),s.layoutVertexArray.emplaceBack(be[0].x,be[0].y),s.lineIndexArray.emplaceBack(Ge+be.length-1,Ge),B.push(be[0].x),B.push(be[0].y);for(let Ue=1;Ue<be.length;Ue++)E(be[Ue],Z,ae),s.layoutVertexArray.emplaceBack(be[Ue].x,be[Ue].y),s.lineIndexArray.emplaceBack(Ge+Ue-1,Ge+Ue),B.push(be[Ue].x),B.push(be[Ue].y);Ee.vertexLength+=be.length,Ee.primitiveLength+=be.length}const we=pm(B,X);for(let be=0;be<we.length;be+=3)s.indexArray.emplaceBack(j+we[be],j+we[be+1],j+we[be+2]);if(we.length>0&&h&&this.elevationMode==="hd-road-base"){const be=h.elevation.isTunnel(),Ee=h.elevation.safeArea,Ge=this.elevatedStructures.addVertices(Z,ae);this.elevatedStructures.addTriangles(we,Ge,be);const Ue=se.length;if(Ue>0){for(let $e=0;$e<Ue-1;$e++)this.elevatedStructures.addRenderableRing(h.index,se[$e]+Ge,se[$e+1]-se[$e],be,Ee,h.featureInfo);this.elevatedStructures.addRenderableRing(h.index,se[Ue-1]+Ge,Z.length-se[Ue-1],be,Ee,h.featureInfo)}}z.vertexLength+=R,z.primitiveLength+=we.length/3}return[p,_]}prepareElevatedPolygons(r,s,h){const p=1/Ne(h),_=[];for(const x of r){const E=RC(x,new oi(s,p));_.push(...E)}return _}clipPolygonsToTile(r,s){const h=-s,p=-s,_=nn+s,x=nn+s;let E=0;const O=[],R=[];for(;E<r.length;E++){const B=r[E],X=Py(B);(X.min.x>=h&&X.max.x<=_&&X.min.y>=p&&X.max.y<=x?O:R).push(B)}if(O.length===r.length)return r;const z=[new kt(h,p),new kt(_,p),new kt(_,x),new kt(h,x),new kt(h,p)],j=O;for(const B of R)j.push(...DS(B,z));return j}}let LS,NS,ub,gm;Rn(cb,"FillBucket",{omit:["layers","patternFeatures"]}),Rn(lb,"FillBufferData"),Rn(Ns,"ElevatedStructures");class qf{constructor(r,s,h,p){if(this.triangleCount=s.length/3,this.min=new kt(0,0),this.max=new kt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||r.length===0)return;const[_,x]=[r[0].clone(),r[0].clone()];for(let j=1;j<r.length;++j){const B=r[j];_.x=Math.min(_.x,B.x),_.y=Math.min(_.y,B.y),x.x=Math.max(x.x,B.x),x.y=Math.max(x.y,B.y)}if(p){const j=Math.ceil(Math.max(x.x-_.x,x.y-_.y)/p);h=Math.max(h,j)}if(h===0)return;this.min=_,this.max=x;const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const O=Math.max(E.x,E.y)/h;this.cellsX=Math.max(1,Math.ceil(E.x/O)),this.cellsY=Math.max(1,Math.ceil(E.y/O)),this.xScale=1/O,this.yScale=1/O;const R=[];for(let j=0;j<this.triangleCount;j++){const B=r[s[3*j+0]].sub(this.min),X=r[s[3*j+1]].sub(this.min),Z=r[s[3*j+2]].sub(this.min),ae=Gu(Math.floor(Math.min(B.x,X.x,Z.x)),this.xScale,this.cellsX),se=Gu(Math.floor(Math.max(B.x,X.x,Z.x)),this.xScale,this.cellsX),pe=Gu(Math.floor(Math.min(B.y,X.y,Z.y)),this.yScale,this.cellsY),we=Gu(Math.floor(Math.max(B.y,X.y,Z.y)),this.yScale,this.cellsY),be=new kt(0,0),Ee=new kt(0,0),Ge=new kt(0,0),Ue=new kt(0,0);for(let $e=pe;$e<=we;++$e){be.y=Ee.y=$e*O,Ge.y=Ue.y=($e+1)*O;for(let Je=ae;Je<=se;++Je)be.x=Ge.x=Je*O,Ee.x=Ue.x=(Je+1)*O,(Ka(B,X,Z,be,Ee,Ue)||Ka(B,X,Z,be,Ue,Ge))&&R.push({cellIdx:$e*this.cellsX+Je,triIdx:j})}}if(R.length===0)return;R.sort(((j,B)=>j.cellIdx-B.cellIdx||j.triIdx-B.triIdx));let z=0;for(;z<R.length;){const j=R[z].cellIdx,B={start:this.payload.length,len:0};for(;z<R.length&&R[z].cellIdx===j;)++B.len,this.payload.push(R[z++].triIdx);this.cells[j]=B}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(r,s){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>r.x||r.y>this.max.y||this.min.y>r.y)return;const h=Gu(r.x-this.min.x,this.xScale,this.cellsX),p=Gu(r.y-this.min.y,this.yScale,this.cellsY),_=this.cells[p*this.cellsX+h];if(_){this._lazyInitLookup();for(let x=0;x<_.len;x++){const E=this.payload[_.start+x],O=Math.floor(E/8),R=1<<E%8;if(!(this.lookup[O]&R)&&(this.lookup[O]|=R,s.push(E),s.length===this.triangleCount))return}}}query(r,s,h){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>s.x||r.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const p=Gu(r.x-this.min.x,this.xScale,this.cellsX),_=Gu(s.x-this.min.x,this.xScale,this.cellsX),x=Gu(r.y-this.min.y,this.yScale,this.cellsY),E=Gu(s.y-this.min.y,this.yScale,this.cellsY);for(let O=x;O<=E;O++)for(let R=p;R<=_;R++){const z=this.cells[O*this.cellsX+R];if(z)for(let j=0;j<z.len;j++){const B=this.payload[z.start+j],X=Math.floor(B/8),Z=1<<B%8;if(!(this.lookup[X]&Z)&&(this.lookup[X]|=Z,h.push(B),h.length===this.triangleCount))return}}}}function Gu(l,r,s){return Math.max(0,Math.min(s-1,Math.floor(l*r)))}Rn(qf,"TriangleGridIndex");class zS{constructor(r){this.zoom=r.zoom,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.fqid)),this.index=r.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.footprints=[],this.worldview=r.worldview}updateFootprints(r,s){for(const h of this.footprints)s.push({footprint:h,id:r})}populate(r,s,h,p){const _=[];for(const{feature:x,id:E,index:O,sourceLayerIndex:R}of r){const z=this.layers[0]._featureFilter.needGeometry,j=Tt(x,z);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom,{worldview:this.worldview}),j,h))continue;const B={id:E,properties:x.properties,type:x.type,sourceLayerIndex:R,index:O,geometry:z?j.geometry:We(x,h,p),patterns:{}};_.push(B)}for(const x of _){const{geometry:E,index:O,sourceLayerIndex:R}=x;this.addFeature(x,E,O,h,{},s.availableImages,s.brightness),s.featureIndex.insert(r[O].feature,E,O,R,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(r){}update(r,s,h,p,_,x,E){}destroy(){}addFeature(r,s,h,p,_,x=[],E){for(const O of m_(s,2)){const R=[],z=[],j=[],B=new kt(1/0,1/0),X=new kt(-1/0,-1/0);for(const se of O)if(se.length!==0){se!==O[0]&&j.push(z.length/2);for(let pe=0;pe<se.length;pe++)z.push(se[pe].x),z.push(se[pe].y),R.push(se[pe]),B.x=Math.min(B.x,se[pe].x),B.y=Math.min(B.y,se[pe].y),X.x=Math.max(X.x,se[pe].x),X.y=Math.max(X.y,se[pe].y)}const Z=pm(z,j),ae=new qf(R,Z,8,256);this.footprints.push({vertices:R,indices:Z,grid:ae,min:B,max:X})}}}Rn(zS,"ClipBucket",{omit:["layers"]});const jg=Ur([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),g_=Ur([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),jS=Ur([{name:"a_centroid_pos",components:2,type:"Uint16"}]),jv=Ur([{name:"a_join_normal_inside",components:3,type:"Int16"}]),hb=Ur([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),db=Ur([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Bv}=jg,Bg=Number.MAX_SAFE_INTEGER,fb=Bg-1;function BS(l,r,s,h){return l.order<r||l.order===Bg||!(l.clipMask&s)||(function(p,_){return _.length!==0&&_.find((x=>x===p))===void 0})(h,l.clipScope)}function y_(l,r){return l.x-r.x||l.y-r.y}function Fg(l,r){return y_(l.min,r.min)===0&&y_(l.max,r.max)===0}function pb(l,r){return!(l.min.x>r.max.x||l.max.x<r.min.x||l.min.y>r.max.y||l.max.y<r.min.y)}function Fv(l,r){if(l.length!==r.length)return!1;for(let s=0;s<l.length;s++)if(l[s].sourceId!==r[s].sourceId||!Fg(l[s],r[s])||l[s].order!==r[s].order||l[s].clipMask!==r[s].clipMask||!Dr(l[s].clipScope,r[s].clipScope))return!1;return!0}function FS(l,r,s){const h=1/nn,p=1/(1<<s.canonical.z),_=(r.x*h+s.canonical.x)*p+s.wrap,x=(r.y*h+s.canonical.y)*p;return{min:new kt((l.x*h+s.canonical.x)*p+s.wrap,(l.y*h+s.canonical.y)*p),max:new kt(_,x)}}function Vv(l,r,s){const h=1<<s.canonical.z,p=((r.x-s.wrap)*h-s.canonical.x)*nn,_=(r.y*h-s.canonical.y)*nn;return{min:new kt(((l.x-s.wrap)*h-s.canonical.x)*nn,(l.y*h-s.canonical.y)*nn),max:new kt(p,_)}}function Vg(l,r,s,h,p,_,x){const E=l.indices,O=l.vertices,R=[];for(let z=h;z<h+p;z+=3){const j=r[s[z+0]+_],B=r[s[z+1]+_],X=r[s[z+2]+_],Z=Math.min(j.x,B.x,X.x),ae=Math.max(j.x,B.x,X.x),se=Math.min(j.y,B.y,X.y),pe=Math.max(j.y,B.y,X.y);R.length=0,l.grid.query(new kt(Z,se),new kt(ae,pe),R);for(let we=0;we<R.length;we++){const be=R[we];if(Ka(O[E[3*be+0]],O[E[3*be+1]],O[E[3*be+2]],j,B,X,x))return!0}}return!1}function Uv(l,r,s,h){if(!l||!s)return!1;let p=l.vertices;if(!r.canonical.equals(h.canonical)||r.wrap!==h.wrap){if(s.vertices.length<l.vertices.length)return Uv(s,h,l,r);const _=r.canonical,x=h.canonical,E=Math.pow(2,x.z-_.z);p=l.vertices.map((O=>new kt((O.x+_.x*nn)*E-x.x*nn,(O.y+_.y*nn)*E-x.y*nn)))}return Vg(s,p,l.indices,0,l.indices.length,0,0)}function VS(l,r,s,h){const p=Math.pow(2,h.z-s.z);return new kt((l+s.x*nn)*p-h.x*nn,(r+s.y*nn)*p-h.y*nn)}function ym(l,r){const s=[];r.grid.queryPoint(l,s);const h=r.indices,p=r.vertices;for(let _=0;_<s.length;_++){const x=s[_];if(Ya([p[h[3*x+0]],p[h[3*x+1]],p[h[3*x+2]]],l))return!0}return!1}const mb=[new kt(0,0),new kt(nn,0),new kt(nn,nn),new kt(0,nn)];function gb(l,r){const s=[];let h=[];if(!r||l.length<2)return[l];if(l.length===2)return ca(l[0],l[1],mb)?[l]:[];for(let p=0;p<l.length+2;p++){const _=l[p%l.length],x=l[(p+1)%l.length],E=ca(p===0?l[l.length-1]:l[(p-1)%l.length],_,mb),O=ca(_,x,mb),R=E||O;R&&h.push(_),R&&O||h.length>0&&(h.length>1&&s.push(h),h=[])}return h.length>1&&s.push(h),s}const $v=mt.types,US=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],$S=["fill-extrusion-flood-light-ground-radius"],yb=Math.pow(2,13),qS=Math.pow(2,15)-1,__=new kt(0,1),Hf=2147483648;function v_(l,r,s,h,p,_,x,E){l.emplaceBack((r<<1)+x,(s<<1)+_,(Math.floor(h*yb)<<1)+p,Math.round(E))}function _m(l,r,s){l.emplaceBack(r.x*nn,r.y*nn,s?1:0)}function Ug(l,r,s,h,p,_){l.emplaceBack(r.x,r.y,(s.x<<1)+h,(s.y<<1)+p,_)}function Gf(l,r,s){l.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class qv{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class _b{constructor(){this.centroidXY=new kt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new kt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new kt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new kt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Hv{constructor(){this.acc=new kt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(r,s){r.min.x===Number.MAX_VALUE&&(r.min.x=r.max.x=s.x,r.min.y=r.max.y=s.y)}appendEdge(r,s,h){this.accCount++,this.acc._add(s);let p=!!this.borders;s.x<r.min.x?(r.min.x=s.x,p=!0):s.x>r.max.x&&(r.max.x=s.x,p=!0),s.y<r.min.y?(r.min.y=s.y,p=!0):s.y>r.max.y&&(r.max.y=s.y,p=!0),((s.x===0||s.x===nn)&&s.x===h.x)!=((s.y===0||s.y===nn)&&s.y===h.y)&&this.processBorderOverlap(s,h),p&&this.checkBorderIntersection(s,h)}checkBorderIntersection(r,s){s.x<0!=r.x<0&&this.addBorderIntersection(0,Gn(s.y,r.y,(0-s.x)/(r.x-s.x))),s.x>nn!=r.x>nn&&this.addBorderIntersection(1,Gn(s.y,r.y,(nn-s.x)/(r.x-s.x))),s.y<0!=r.y<0&&this.addBorderIntersection(2,Gn(s.x,r.x,(0-s.y)/(r.y-s.y))),s.y>nn!=r.y>nn&&this.addBorderIntersection(3,Gn(s.x,r.x,(nn-s.y)/(r.y-s.y)))}addBorderIntersection(r,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[r];s<h[0]&&(h[0]=s),s>h[1]&&(h[1]=s)}processBorderOverlap(r,s){if(r.x===s.x){if(r.y===s.y)return;const h=r.x===0?0:1;this.addBorderIntersection(h,s.y),this.addBorderIntersection(h,r.y)}else{const h=r.y===0?2:3;this.addBorderIntersection(h,s.x),this.addBorderIntersection(h,r.x)}}centroid(){return this.accCount===0?new kt(0,0):new kt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((r,s)=>r+ +(s[0]!==Number.MAX_VALUE)),0):0}}function Ld(l,r){const s=l.add(r)._unit(),h=Pe(l.x*s.x+l.y*s.y,-1,1);var p,_,x;return p=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(p)))/4*qS*((_=l).x*(x=r).y-_.y*x.x<0?-1:1)}const Wf=[l=>l.x<0,l=>l.x>nn,l=>l.y<0,l=>l.y>nn];function Xf(l,r,s,h){const p=[4];if(h===0)return p;s._mult(h);const _=l.sub(s),x=r.sub(s),E=[l,r,_,x];for(let O=0;O<4;O++)for(const R of E)if(Wf[O](R)){p.push(O);break}return p}class vm{constructor(r){this.vertexArray=new zu,this.indexArray=new Zr,this.programConfigurations=new Ks(r.layers,{zoom:r.zoom,lut:r.lut},(s=>$S.includes(s))),this._segments=new Ki,this.hiddenByLandmarkVertexArray=new om,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ki}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(r,s,h,p=!1){const _=r.length;if(_>2){let x=Math.max(0,this._segments.get().length-1);const E=this._segments._prepareSegment(4*_,this.vertexArray.length,2*this._segmentToGroundQuads[x].length);let O;x!==this._segments.get().length-1&&(x++,this._segmentToGroundQuads[x]=[],this._segmentToRegionTriCounts[x]=[0,0,0,0,0]);{const R=r[0],z=r[1];O=Ld(R.sub(r[_-1])._perp()._unit(),z.sub(R)._perp()._unit())}for(let R=0;R<_;R++){const z=R===_-1?0:R+1,j=r[R],B=r[z],X=r[z===_-1?0:z+1],Z=B.sub(j)._perp()._unit(),ae=Ld(Z,X.sub(B)._perp()._unit()),se=O,pe=ae;if(xm(j,B,s)||p&&HS(j,s)&&HS(B,s)){O=ae;continue}const we=E.vertexLength;Ug(this.vertexArray,j,B,1,1,se),Ug(this.vertexArray,j,B,1,0,se),Ug(this.vertexArray,j,B,0,1,pe),Ug(this.vertexArray,j,B,0,0,pe),E.vertexLength+=4;const be=Xf(j,B,Z,h);for(const Ee of be)this._segmentToGroundQuads[x].push({id:we,region:Ee}),this._segmentToRegionTriCounts[x][Ee]+=2,E.primitiveLength+=2;O=ae}}}prepareBorderSegments(){if(!this.hasData())return;const r=this._segments.get(),s=r.length;for(let h=0;h<s;h++)this._segmentToGroundQuads[h].sort(((p,_)=>p.region-_.region));for(let h=0;h<s;h++){const p=this._segmentToGroundQuads[h],_=r[h],x=this._segmentToRegionTriCounts[h];x.reduce(((O,R)=>O+R),0);let E=0;for(let O=0;O<=4;O++){const R=x[O];if(R!==0){let z=this.regionSegments[O];z||(z=this.regionSegments[O]=new Ki);const j={vertexOffset:_.vertexOffset,primitiveOffset:_.primitiveOffset+E,vertexLength:_.vertexLength,primitiveLength:R};z.get().push(j)}E+=R}for(let O=0;O<p.length;O++){const R=p[O].id;this.indexArray.emplaceBack(R,R+1,R+3),this.indexArray.emplaceBack(R,R+3,R+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(r,s,h,p,_,x,E){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,r,s,h,p,_,x,void 0,E)}upload(r){this.hasData()&&(this.vertexBuffer=r.createVertexBuffer(this.vertexArray,g_.members),this.indexBuffer=r.createIndexBuffer(this.indexArray))}uploadPaintProperties(r){this.hasData()&&this.programConfigurations.upload(r)}update(r,s,h,p,_,x,E,O){this.hasData()&&this.programConfigurations.updatePaintArrays(r,s,h,p,_,x,E,O)}updateHiddenByLandmark(r){this.updateHiddenByLandmarkRange(r.groundVertexArrayOffset,r.groundVertexCount,!!(r.flags&Hf))}updateHiddenByLandmarkRange(r,s,h){if(!this.hasData())return;const p=s+r;if(s!==0){for(let _=r;_<p;++_)this.hiddenByLandmarkVertexArray.emplace(_,h?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(r){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=r.createVertexBuffer(this.hiddenByLandmarkVertexArray,hb.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let r=0;r<=4;r++){const s=this.regionSegments[r];s&&s.destroy()}}}}class Zf{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.pixelRatio=r.pixelRatio,this.layerIds=this.layers.map((s=>s.fqid)),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Zr,this.footprintVertices=new Rs,this.footprintSegments=[],this.layoutVertexArray=new Nu,this.centroidVertexArray=new cm,this.wallVertexArray=new t_,this.indexArray=new Zr,this.programConfigurations=new Ks(r.layers,{zoom:r.zoom,lut:r.lut},(s=>US.includes(s))),this.segments=new Ki,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.groundEffect=new vm(r),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=r.worldview}updateFootprints(r,s){}populate(r,s,h,p){this.features=[],this.hasPattern=Nv("fill-extrusion",this.layers,this.pixelRatio,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Ne(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:_,id:x,index:E,sourceLayerIndex:O}of r){const R=this.layers[0]._featureFilter.needGeometry,z=Tt(_,R);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom,{worldview:this.worldview}),z,h))continue;const j={id:x,sourceLayerIndex:O,index:E,geometry:R?z.geometry:We(_,h,p),properties:_.properties,type:_.type,patterns:{}},B=this.layoutVertexArray.length,X=$v[j.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:_.id,feature:zv("fill-extrusion",this.layers,j,this.zoom,this.pixelRatio,s)});else if(this.wallMode)for(const Z of j.geometry)for(const ae of gb(Z,X))this.addFeature(_.id,j,[ae],E,h,{},s.availableImages,p,s.brightness);else this.addFeature(_.id,j,j.geometry,E,h,{},s.availableImages,p,s.brightness);s.featureIndex.insert(_,j.geometry,E,O,this.index,B)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(r,s,h,p,_,x){for(const{featureId:E,feature:O}of this.features){const R=$v[O.type]==="Polygon",{geometry:z}=O;if(this.wallMode)for(const j of z)for(const B of gb(j,R))this.addFeature(E,O,[B],O.index,s,h,p,_,x);else this.addFeature(E,O,z,O.index,s,h,p,_,x)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(r,s,h,p,_,x,E){this.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E,this.worldview),this.groundEffect.update(r,s,_,h,p,x,E,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Bv),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.wallVertexBuffer=r.createVertexBuffer(this.wallVertexArray,jv.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,db.members,!0)),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.groundEffect.uploadHiddenByLandmark(r),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,jS.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,h,p,_,x,E,O,R){const z=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,j=[new kt(0,0),new kt(nn,nn)],B=O.projection,X=B.name==="globe",Z=this.wallMode||$v[s.type]==="Polygon",ae=new Hv;ae.centroidDataIndex=this.centroidData.length;const se=new _b;se.buildingId=r,s.properties&&s.properties.hasOwnProperty("building_id")&&(se.buildingId=s.properties.building_id);const pe=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},_)<=0,we=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},_);let be;if(se.height=we,se.vertexArrayOffset=this.layoutVertexArray.length,se.groundVertexArrayOffset=this.groundEffect.vertexArray.length,X&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new em),this.wallMode){if(X)return void jr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(h.length!==1)return;be=(function(ut){const Dt=ut[0].x===ut[ut.length-1].x&&ut[0].y===ut[ut.length-1].y;(function(an){let Nn=0;const Cn=an.length;for(let pn=0;pn<Cn;pn++)Nn+=(an[(pn+1)%Cn].x-an[pn].x)*(an[(pn+1)%Cn].y+an[pn].y);return Nn>=0})(ut)||(ut=ut.reverse());const Vt={geometry:[],joinNormals:[],indices:[]},Yt=[],on=[],At=[];let Kt=ut.length;for(;Kt>=2&&ut[Kt-1].equals(ut[Kt-2]);)Kt--;if(Kt<(Dt?3:2))return Vt;let pt,Ct,un,Qt,Un,kn=0;for(;kn<Kt-1&&ut[kn].equals(ut[kn+1]);)kn++;Dt&&(pt=ut[Kt-2],Un=ut[kn].sub(pt)._unit()._perp());for(let an=kn;an<Kt;an++){if(un=an===Kt-1?Dt?ut[kn+1]:void 0:ut[an+1],un&&ut[an].equals(un))continue;Un&&(Qt=Un),pt&&(Ct=pt),pt=ut[an],Un=un?un.sub(pt)._unit()._perp():Qt,Qt=Qt||Un;let Nn=Qt.add(Un);Nn.x===0&&Nn.y===0||Nn._unit();const Cn=Nn.x*Un.x+Nn.y*Un.y,pn=Cn!==0?1/Cn:1/0,On=Qt.x*Un.y-Qt.y*Un.x>0;let Jn="miter";const or=2;Jn==="miter"&&pn>or&&(Jn="bevel"),Jn==="bevel"&&(pn>100&&(Jn="flipbevel"),pn<or&&(Jn="miter"));const wr=(ur,Xr,Lr,Ji)=>{const Oe=new kt(ur.x,ur.y),Re=new kt(ur.x,ur.y);Oe.x+=Xr.x*Ji,Oe.y+=Xr.y*Ji,Re.x-=Xr.x*Math.max(Lr,1),Re.y-=Xr.y*Math.max(Lr,1),At.push(Xr),Yt.push(Oe),on.push(Re)};if(Jn==="miter")Nn._mult(pn),wr(pt,Nn,0,0);else if(Jn==="flipbevel")Nn=Un.mult(-1),wr(pt,Nn,0,0),wr(pt,Nn.mult(-1),0,0);else{const ur=-Math.sqrt(pn*pn-1),Xr=On?ur:0,Lr=On?0:ur;Ct&&wr(pt,Qt,Xr,Lr),un&&wr(pt,Un,Xr,Lr)}}Vt.geometry=[...Yt,...on.reverse(),Yt[0]],Vt.joinNormals=[...At,...At.reverse(),At[At.length-1]];const Xt=Vt.geometry.length-1;for(let an=0;an<Xt/2;an++)if(an+1<Xt/2){let Nn=an,Cn=an+1,pn=Xt-1-an,On=Xt-2-an;Nn=Nn===0?Xt-1:Nn-1,Cn=Cn===0?Xt-1:Cn-1,pn=pn===0?Xt-1:pn-1,On=On===0?Xt-1:On-1,Vt.indices.push(pn),Vt.indices.push(Cn),Vt.indices.push(Nn),Vt.indices.push(pn),Vt.indices.push(On),Vt.indices.push(Cn)}return Vt})(h[0]),h=[be.geometry]}const Ee=(ut,Dt)=>ut<(Dt.length-1)/2||ut===Dt.length-1,Ge=this.wallMode?[h]:m_(h,500);for(let ut=Ge.length-1;ut>=0;ut--){const Dt=Ge[ut];(Dt.length===0||(Ue=Dt[0]).every((ln=>ln.x<=0))||Ue.every((ln=>ln.x>=nn))||Ue.every((ln=>ln.y<=0))||Ue.every((ln=>ln.y>=nn)))&&Ge.splice(ut,1)}var Ue;let $e;if(X)$e=GS(Ge,j,_);else{$e=[];for(const ut of Ge)$e.push({polygon:ut,bounds:j})}const Je=Z?this.edgeRadius:0,it=Je>0&&this.zoom<17,Mt=(ut,Dt)=>{if(ut.length===0)return!1;const ln=ut[ut.length-1];return Dt.x===ln.x&&Dt.y===ln.y};for(const{polygon:ut,bounds:Dt}of $e){let ln=0,Vt=0;for(const Kt of ut)Z&&!Kt[0].equals(Kt[Kt.length-1])&&Kt.push(Kt[0]),Vt+=Z?Kt.length-1:Kt.length;const Yt=this.segments.prepareSegment((Z?5:4)*Vt,this.layoutVertexArray,this.indexArray);se.footprintSegIdx<0&&(se.footprintSegIdx=this.footprintSegments.length),se.polygonSegIdx<0&&(se.polygonSegIdx=this.polygonSegments.length);const on={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},At=new qv;if(At.vertexOffset=this.footprintVertices.length,At.indexOffset=3*this.footprintIndices.length,At.ringIndices=[],Z){const Kt=[],pt=[];ln=Yt.vertexLength;for(let un=0;un<ut.length;un++){const Qt=ut[un];Qt.length&&un!==0&&pt.push(Kt.length/2);const Un=[];let kn,Xt;kn=Qt[1].sub(Qt[0])._perp()._unit(),At.ringIndices.push(Qt.length-1);for(let an=1;an<Qt.length;an++){const Nn=Qt[an],Cn=Qt[an===Qt.length-1?1:an+1],pn=Nn.clone();if(Je){Xt=Cn.sub(Nn)._perp()._unit();const On=kn.add(Xt)._unit(),Jn=Je*Math.min(4,1/(kn.x*On.x+kn.y*On.y));pn.x+=Jn*On.x,pn.y+=Jn*On.y,pn.x=Math.round(pn.x),pn.y=Math.round(pn.y),kn=Xt}if(!pe||Je!==0&&!it||Mt(Un,pn)||Un.push(pn),v_(this.layoutVertexArray,pn.x,pn.y,0,0,1,1,0),this.wallMode){const On=Ee(an,Qt);_m(this.wallVertexArray,be.joinNormals[an],!On)}Yt.vertexLength++,this.footprintVertices.emplaceBack(Nn.x,Nn.y),Kt.push(Nn.x,Nn.y),X&&Gf(this.layoutVertexExtArray,B.projectTilePoint(pn.x,pn.y,_),B.upVector(_,pn.x,pn.y))}pe&&(Je===0||it)&&(Un.length!==0&&Mt(Un,Un[0])&&Un.pop(),this.groundEffect.addData(Un,Dt,z))}const Ct=this.wallMode?be.indices:pm(Kt,pt);for(let un=0;un<Ct.length;un+=3)this.footprintIndices.emplaceBack(At.vertexOffset+Ct[un+0],At.vertexOffset+Ct[un+1],At.vertexOffset+Ct[un+2]),this.indexArray.emplaceBack(ln+Ct[un],ln+Ct[un+2],ln+Ct[un+1]),Yt.primitiveLength++;At.indexCount+=Ct.length,At.vertexCount+=this.footprintVertices.length-At.vertexOffset}for(let Kt=0;Kt<ut.length;Kt++){const pt=ut[Kt];ae.startRing(se,pt[0]);let Ct=pt.length>4&&xb(pt[pt.length-2],pt[0],pt[1]),un=Je?IC(pt[pt.length-2],pt[0],pt[1],Je):0;const Qt=[];let Un,kn,Xt;kn=pt[1].sub(pt[0])._perp()._unit();let an=!0;for(let Nn=1,Cn=0;Nn<pt.length;Nn++){let pn=pt[Nn-1],On=pt[Nn];const Jn=pt[Nn===pt.length-1?1:Nn+1];if(ae.appendEdge(se,On,pn),xm(On,pn,Dt)){Je&&(kn=Jn.sub(On)._perp()._unit(),an=!an);continue}const or=On.sub(pn)._perp(),wr=or.x/(Math.abs(or.x)+Math.abs(or.y)),ur=or.y>0?1:0,Xr=pn.dist(On);if(Cn+Xr>32768&&(Cn=0),Je){Xt=Jn.sub(On)._perp()._unit();let Re=vb(pn,On,Jn,Nd(kn,Xt),Je);isNaN(Re)&&(Re=0);const Et=On.sub(pn)._unit();pn=pn.add(Et.mult(un))._round(),On=On.add(Et.mult(-Re))._round(),un=Re,kn=Xt,pe&&this.zoom>=17&&(Mt(Qt,pn)||Qt.push(pn),Mt(Qt,On)||Qt.push(On))}const Lr=Yt.vertexLength,Ji=pt.length>4&&xb(pn,On,Jn);let Oe=x_(Cn,Ct,an);if(v_(this.layoutVertexArray,pn.x,pn.y,wr,ur,0,0,Oe),v_(this.layoutVertexArray,pn.x,pn.y,wr,ur,0,1,Oe),this.wallMode){const Re=Ee(Nn-1,pt),Et=be.joinNormals[Nn-1];_m(this.wallVertexArray,Et,Re),_m(this.wallVertexArray,Et,Re)}if(Cn+=Xr,Oe=x_(Cn,Ji,!an),Ct=Ji,v_(this.layoutVertexArray,On.x,On.y,wr,ur,0,0,Oe),v_(this.layoutVertexArray,On.x,On.y,wr,ur,0,1,Oe),this.wallMode){const Re=Ee(Nn,pt),Et=be.joinNormals[Nn];_m(this.wallVertexArray,Et,Re),_m(this.wallVertexArray,Et,Re)}if(Yt.vertexLength+=4,this.indexArray.emplaceBack(Lr+0,Lr+1,Lr+2),this.indexArray.emplaceBack(Lr+1,Lr+3,Lr+2),Yt.primitiveLength+=2,Je){const Re=ln+(Nn===1?pt.length-2:Nn-2),Et=Nn===1?ln:Re+1;if(this.indexArray.emplaceBack(Lr+1,Re,Lr+3),this.indexArray.emplaceBack(Re,Et,Lr+3),Yt.primitiveLength+=2,Un===void 0&&(Un=Lr),!xm(Jn,pt[Nn],Dt)){const hn=Nn===pt.length-1?Un:Yt.vertexLength;this.indexArray.emplaceBack(Lr+2,Lr+3,hn),this.indexArray.emplaceBack(Lr+3,hn+1,hn),this.indexArray.emplaceBack(Lr+3,Et,hn+1),Yt.primitiveLength+=3}an=!an}if(X){const Re=this.layoutVertexExtArray,Et=B.projectTilePoint(pn.x,pn.y,_),hn=B.projectTilePoint(On.x,On.y,_),vn=B.upVector(_,pn.x,pn.y),_n=B.upVector(_,On.x,On.y);Gf(Re,Et,vn),Gf(Re,Et,vn),Gf(Re,hn,_n),Gf(Re,hn,_n)}}Z&&(ln+=pt.length-1),pe&&Je&&this.zoom>=17&&(Qt.length!==0&&Mt(Qt,Qt[0])&&Qt.pop(),this.groundEffect.addData(Qt,Dt,z,Je>0))}this.footprintSegments.push(At),on.triangleCount=this.indexArray.length-on.triangleArrayOffset,this.polygonSegments.push(on),++se.footprintSegLen,++se.polygonSegLen}if(se.vertexCount=this.layoutVertexArray.length-se.vertexArrayOffset,se.groundVertexCount=this.groundEffect.vertexArray.length-se.groundVertexArrayOffset,se.vertexCount!==0){if(se.centroidXY=ae.borders?__:this.encodeCentroid(ae,se),this.centroidData.push(se),ae.borders){this.featuresOnBorder.push(ae);const ut=this.featuresOnBorder.length-1;for(let Dt=0;Dt<ae.borders.length;Dt++)ae.borders[Dt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Dt].push(ut)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,x,E,_,R,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(s,p,x,E,_,R,this.worldview),this.maxHeight=Math.max(this.maxHeight,we)}}sortBorders(){for(let r=0;r<this.borderFeatureIndices.length;r++)this.borderFeatureIndices[r].sort(((s,h)=>this.featuresOnBorder[s].borders[r][0]-this.featuresOnBorder[h].borders[r][0]))}splitToSubtiles(){const r=[];for(let E=0;E<this.centroidData.length;E++){const O=this.centroidData[E],R=+(O.min.y+O.max.y>nn),z=2*R+(+(O.min.x+O.max.x>nn)^R);for(let j=0;j<O.polygonSegLen;j++){const B=O.polygonSegIdx+j;r.push({centroidIdx:E,subtile:z,polygonSegmentIdx:B,triangleSegmentIdx:this.polygonSegments[B].triangleSegIdx})}}const s=new Zr;r.sort(((E,O)=>E.triangleSegmentIdx===O.triangleSegmentIdx?E.subtile-O.subtile:E.triangleSegmentIdx-O.triangleSegmentIdx));let h=0,p=0,_=0;for(const E of r){if(E.triangleSegmentIdx!==h)break;_++}const x=r.length;for(;p!==r.length;){h=r[p].triangleSegmentIdx;let E=0,O=p,R=p;for(let z=O;z<_&&r[z].subtile===E;z++)R++;for(;O!==_;){const z=r[O];E=z.subtile;const j=this.centroidData[z.centroidIdx].min.clone(),B=this.centroidData[z.centroidIdx].max.clone(),X={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Z=O;Z<R;Z++){const ae=r[Z],se=this.polygonSegments[ae.polygonSegmentIdx],pe=this.centroidData[ae.centroidIdx].min,we=this.centroidData[ae.centroidIdx].max,be=this.indexArray.uint16;for(let Ee=se.triangleArrayOffset;Ee<se.triangleArrayOffset+se.triangleCount;Ee++)s.emplaceBack(be[3*Ee],be[3*Ee+1],be[3*Ee+2]);X.primitiveLength+=se.triangleCount,j.x=Math.min(j.x,pe.x),j.y=Math.min(j.y,pe.y),B.x=Math.max(B.x,we.x),B.y=Math.max(B.y,we.y)}X.primitiveLength>0&&this.triangleSubSegments.push({segment:X,min:j,max:B}),O=R;for(let Z=O;Z<_&&r[Z].subtile===r[O].subtile;Z++)R++}p=_;for(let z=p;z<x&&r[z].triangleSegmentIdx===r[p].triangleSegmentIdx;z++)_++}s._trim(),this.indexArray=s}getVisibleSegments(r,s,h){const p=new Ki;if(this.wallMode){for(const ae of this.triangleSubSegments)p.segments.push(ae.segment);return p}let _=0,x=0;const E=1<<r.canonical.z;if(s){const ae=s.getMinMaxForTile(r);ae&&(_=ae.min,x=ae.max)}x+=this.maxHeight;const O=r.toUnwrapped();let R;const z=[O.canonical.x/E+O.wrap,O.canonical.y/E],j=[(O.canonical.x+1)/E+O.wrap,(O.canonical.y+1)/E],B=(ae,se,pe)=>[ae[0]*(1-pe[0])+se[0]*pe[0],ae[1]*(1-pe[1])+se[1]*pe[1]],X=[],Z=[];for(const ae of this.triangleSubSegments){X[0]=ae.min.x/nn,X[1]=ae.min.y/nn,Z[0]=ae.max.x/nn,Z[1]=ae.max.y/nn;const se=B(z,j,X),pe=B(z,j,Z);if(new br([se[0],se[1],_],[pe[0],pe[1],x]).intersectsPrecise(h)===0){R&&(p.segments.push(R),R=void 0);continue}const we=ae.segment;R&&R.vertexOffset!==we.vertexOffset&&(p.segments.push(R),R=void 0),R?(R.vertexLength+=we.vertexLength,R.primitiveLength+=we.primitiveLength):R={vertexOffset:we.vertexOffset,primitiveLength:we.primitiveLength,vertexLength:we.vertexLength,primitiveOffset:we.primitiveOffset,sortKey:void 0,vaos:{}}}return R&&p.segments.push(R),p}encodeCentroid(r,s){const h=r.centroid(),p=s.span(),_=Math.min(7,Math.round(p.x*this.tileToMeter/10)),x=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new kt(Pe(h.x,1,nn-1)<<3|_,Pe(h.y,1,nn-1)<<3|x)}encodeBorderCentroid(r){if(!r.borders)return new kt(0,0);const s=r.borders,h=Number.MAX_VALUE;if(s[0][0]!==h||s[1][0]!==h){const p=s[0][0]!==h?0:1;return new kt(6|(s[0][0]!==h?0:65528),(s[p][0]+s[p][1])/2<<3|6)}{const p=s[2][0]!==h?2:3;return new kt((s[p][0]+s[p][1])/2<<3|6,6|(s[2][0]!==h?0:65528))}}showCentroid(r){const s=this.centroidData[r.centroidDataIndex];s.flags&=2147483647,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(r){this.groundEffect.updateHiddenByLandmark(r);const s=r.vertexArrayOffset,h=r.vertexCount+r.vertexArrayOffset,p=r.flags&Hf?__:r.centroidXY,_=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==p.y||_!==p.x){for(let x=s;x<h;++x)this.centroidVertexArray.emplace(x,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const r of this.centroidData)this.writeCentroidToBuffer(r)}updateReplacement(r,s,h){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const p=s.getReplacementRegionsForTile(r.toUnwrapped());if(Fv(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const x of this.centroidData)x.flags&=2147483647;const _=[];for(const x of this.activeReplacements){if(x.order<h)continue;const E=Math.max(1,Math.pow(2,x.footprintTileId.canonical.z-r.canonical.z));if(x.footprint.buildingId){const O=x.footprint.buildingId;for(const R of this.centroidData)R.buildingId===O&&(R.flags|=Hf)}else for(const O of this.centroidData)if(!(O.flags&Hf||x.min.x>O.max.x||O.min.x>x.max.x||x.min.y>O.max.y||O.min.y>x.max.y))for(let R=0;R<O.footprintSegLen;R++){const z=this.footprintSegments[O.footprintSegIdx+R];if(_.length=0,Gv(this.footprintVertices,z.vertexOffset,z.vertexCount,x.footprintTileId.canonical,r.canonical,_),Vg(x.footprint,_,this.footprintIndices.uint16,z.indexOffset,z.indexCount,-z.vertexOffset,-E)){O.flags|=Hf;break}}}for(const x of this.centroidData)this.writeCentroidToBuffer(x);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(r,s,h){let p=!1;for(let _=0;_<h.footprintSegLen;_++){const x=this.footprintSegments[h.footprintSegIdx+_];let E=0;for(const O of x.ringIndices){for(let R=E,z=O+E-1;R<O+E;z=R++){const j=this.footprintVertices.int16[2*(R+x.vertexOffset)+0],B=this.footprintVertices.int16[2*(R+x.vertexOffset)+1],X=this.footprintVertices.int16[2*(z+x.vertexOffset)+1];B>s!=X>s&&r<(this.footprintVertices.int16[2*(z+x.vertexOffset)+0]-j)*(s-B)/(X-B)+j&&(p=!p)}E=O}}return p}getHeightAtTileCoord(r,s){let h=Number.NEGATIVE_INFINITY,p=!0;const _=4*(r+nn)*nn+(s+nn);if(this.partLookup.hasOwnProperty(_)){const x=this.partLookup[_];return x?{height:x.height,hidden:!!(x.flags&Hf)}:void 0}for(const x of this.centroidData)r>x.max.x||x.min.x>r||s>x.max.y||x.min.y>s||x.height<=h||this.footprintContainsPoint(r,s,x)&&(h=x.height,this.partLookup[_]=x,p=!!(x.flags&Hf));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:p};this.partLookup[_]=void 0}}function Nd(l,r){const s=l.add(r)._unit();return l.x*s.x+l.y*s.y}function IC(l,r,s,h){const p=r.sub(l)._perp()._unit(),_=s.sub(r)._perp()._unit();return vb(l,r,s,Nd(p,_),h)}function vb(l,r,s,h,p){const _=Math.sqrt(1-h*h);return Math.min(l.dist(r)/3,r.dist(s)/3,p*_/h)}function xm(l,r,s){return l.x<s[0].x&&r.x<s[0].x||l.x>s[1].x&&r.x>s[1].x||l.y<s[0].y&&r.y<s[0].y||l.y>s[1].y&&r.y>s[1].y}function HS(l,r){return l.x<r[0].x||l.x>r[1].x||l.y<r[0].y||l.y>r[1].y}function xb(l,r,s){if(l.x<0||l.x>=nn||r.x<0||r.x>=nn||s.x<0||s.x>=nn)return!1;const h=s.sub(r),p=h.perp(),_=l.sub(r);return(h.x*_.x+h.y*_.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(_.x*_.x+_.y*_.y))>-.866&&p.x*_.x+p.y*_.y<0}function x_(l,r,s){const h=r?2|l:-3&l;return s?1|h:-2&h}function bb(){const l=Math.PI/32,r=Math.tan(l),s=L;return s*Math.sqrt(1+2*r*r)-s}function GS(l,r,s){const h=1<<s.z,p=xe(s.x/h),_=xe((s.x+1)/h),x=Te(s.y/h),E=Te((s.y+1)/h);return(function(O,R,z,j,B=0,X){const Z=[];if(!O.length||!z||!j)return Z;const ae=(Ue,$e)=>{for(const Je of Ue)Z.push({polygon:Je,bounds:$e})},se=Math.ceil(Math.log2(z)),pe=Math.ceil(Math.log2(j)),we=se-pe,be=[];for(let Ue=0;Ue<Math.abs(we);Ue++)be.push(we>0?0:1);for(let Ue=0;Ue<Math.min(se,pe);Ue++)be.push(0),be.push(1);let Ee=O;if(Ee=kd(Ee,R[0].y-B,R[1].y+B,1),Ee=kd(Ee,R[0].x-B,R[1].x+B,0),!Ee.length)return Z;const Ge=[];for(be.length?Ge.push({polygons:Ee,bounds:R,depth:0}):ae(Ee,R);Ge.length;){const Ue=Ge.pop(),$e=Ue.depth,Je=be[$e],it=Ue.bounds[0],Mt=Ue.bounds[1],ut=Je===0?it.x:it.y,Dt=Je===0?Mt.x:Mt.y,ln=X?X(Je,ut,Dt):.5*(ut+Dt),Vt=kd(Ue.polygons,ut-B,ln+B,Je),Yt=kd(Ue.polygons,ln-B,Dt+B,Je);if(Vt.length){const on=[it,new kt(Je===0?ln:Mt.x,Je===1?ln:Mt.y)];be.length>$e+1?Ge.push({polygons:Vt,bounds:on,depth:$e+1}):ae(Vt,on)}if(Yt.length){const on=[new kt(Je===0?ln:it.x,Je===1?ln:it.y),Mt];be.length>$e+1?Ge.push({polygons:Yt,bounds:on,depth:$e+1}):ae(Yt,on)}}return Z})(l,r,Math.ceil((_-p)/11.25),Math.ceil((x-E)/11.25),1,((O,R,z)=>{if(O===0)return .5*(R+z);{const j=Te((s.y+R/nn)/h);return(ue(.5*(Te((s.y+z/nn)/h)+j))*h-s.y)*nn}}))}function Gv(l,r,s,h,p,_){const x=Math.pow(2,h.z-p.z);for(let E=0;E<s;E++){let O=l.int16[2*(E+r)+0],R=l.int16[2*(E+r)+1];O=(O+p.x*nn)*x-h.x*nn,R=(R+p.y*nn)*x-h.y*nn,_.push(new kt(O,R))}}let b_,wb;Rn(Zf,"FillExtrusionBucket",{omit:["layers","features"]}),Rn(_b,"PartData"),Rn(qv,"FootprintSegment"),Rn(Hv,"BorderCentroidData"),Rn(vm,"GroundEffect");class Wu extends kt{constructor(r,s,h){super(r,s),this.z=h}}class Wv extends Wu{constructor(r,s,h,p){super(r,s,h),this.w=p}}function w_(l,r,s,h){const p=s==="x"?"y":"x",_=(h-l[s])/(r[s]-l[s]);l[p]=Math.round(l[p]+(r[p]-l[p])*_),l[s]=h,l.hasOwnProperty("z")&&(l.z=Gn(l.z,r.z,_)),l.hasOwnProperty("w")&&(l.w=Gn(l.w,r.w,_))}function Sb(l,r,s,h){const p=s,_=h;for(const x of["x","y"]){let E=l,O=r;E[x]>=O[x]&&(E=r,O=l),E[x]<p&&O[x]>p&&w_(E,O,x,p),E[x]<_&&O[x]>_&&w_(O,E,x,_)}}function Xv(l,r,s,h,p,_){const x=[];for(let E=0;E<l.length;E++){const O=l[E];let R;const z=x.length;let j=0;for(let B=0;B<O.length-1;B++){let X=O[B],Z=O[B+1],ae=0;const se=j;let pe,we;_&&(ae=Math.hypot(Z.x-X.x,Z.y-X.y),j+=ae,pe=X,we=Z),X.x<r&&Z.x<r||(X.x<r?X=new kt(r,X.y+(r-X.x)/(Z.x-X.x)*(Z.y-X.y))._round():Z.x<r&&(Z=new kt(r,X.y+(r-X.x)/(Z.x-X.x)*(Z.y-X.y))._round()),X.y<s&&Z.y<s||(X.y<s?X=new kt(X.x+(s-X.y)/(Z.y-X.y)*(Z.x-X.x),s)._round():Z.y<s&&(Z=new kt(X.x+(s-X.y)/(Z.y-X.y)*(Z.x-X.x),s)._round()),X.x>=h&&Z.x>=h||(X.x>=h?X=new kt(h,X.y+(h-X.x)/(Z.x-X.x)*(Z.y-X.y))._round():Z.x>=h&&(Z=new kt(h,X.y+(h-X.x)/(Z.x-X.x)*(Z.y-X.y))._round()),X.y>=p&&Z.y>=p||(X.y>=p?X=new kt(X.x+(p-X.y)/(Z.y-X.y)*(Z.x-X.x),p)._round():Z.y>=p&&(Z=new kt(X.x+(p-X.y)/(Z.y-X.y)*(Z.x-X.x),p)._round()),R&&X.equals(R[R.length-1])||(R=[X],x.push(R),_&&_.push({progress:{min:se+f(pe,we,X)*ae,max:1},parentIndex:E,prevPoint:pe,nextPoint:we})),R.push(Z),_&&(_[_.length-1].progress.max=se+f(pe,we,Z)*ae,_[_.length-1].nextPoint=we)))))}if(_&&j>0)for(let B=z;B<x.length;B++)_[B].progress.min/=j,_[B].progress.max/=j}return x}function Zv(l,r,s,h,p){if(l.length<2)return void h.push(l);const _=[];for(;r.valid();){const[R,z]=r.get();for(let j=0;j<l.length-1;j++){const B=l[j],X=l[j+1],Z=qa(B,X,R,z);if(Z){const[ae]=Z,se=new kt(Gn(B.x,X.x,ae),Gn(B.y,X.y,ae));_.push({t:j+ae,distance:0,point:se})}}r.next()}if(_.length===0)return void h.push(l);_.sort(((R,z)=>R.t-z.t));let x=0,E=0,O=[];for(h.push(O);x!==l.length;){if(E===_.length){for(;x!==l.length;)O.length!==0&&O[O.length-1].equals(l[x])||O.push(l[x]),x++;break}_[E].t<=x?(O.length!==0&&O[O.length-1].equals(_[E].point)||O.push(_[E].point),Math.trunc(_[E].t),E++):(O.length!==0&&O[O.length-1].equals(l[x])||O.push(l[x]),x++)}}function f(l,r,s){return l.x!==r.x?(s.x-l.x)/(r.x-l.x):l.y!==r.y?(s.y-l.y)/(r.y-l.y):0}function v(l,r){return l.x*r.x+l.y*r.y}function A(l,r){if(l.length===1){let s=0;const h=r[s++];let p;for(;!p||h.equals(p);)if(p=r[s++],!p)return 1/0;for(;s<r.length;s++){const _=r[s],x=l[0],E=p.sub(h),O=_.sub(h),R=x.sub(h),z=v(E,E),j=v(E,O),B=v(O,O),X=v(R,E),Z=v(R,O),ae=z*B-j*j,se=(B*X-j*Z)/ae,pe=(z*Z-j*X)/ae,we=h.z*(1-se-pe)+p.z*se+_.z*pe;if(isFinite(we))return we}return 1/0}{let s=1/0;for(const h of r)s=Math.min(s,h.z);return s}}function k(l,r,s,h,p,_,x,E){const O=x*p.getElevationAt(l,r,!0,!0),R=_[0]!==0,z=R?_[1]===0?x*(_[0]/7-450):x*(function(j,B,X){const Z=Math.floor(B[0]/8),ae=Math.floor(B[1]/8),se=10*(B[0]-8*Z),pe=10*(B[1]-8*ae),we=j.getElevationAt(Z,ae,!0,!0),be=j.getMeterToDEM(X),Ee=Math.floor(.5*(se*be-1)),Ge=Math.floor(.5*(pe*be-1)),Ue=j.tileCoordToPixel(Z,ae),$e=2*Ee+1,Je=2*Ge+1,it=(function(Yt,on,At,Kt,pt){return[Yt.getElevationAtPixel(on,At,!0),Yt.getElevationAtPixel(on+pt,At,!0),Yt.getElevationAtPixel(on,At+pt,!0),Yt.getElevationAtPixel(on+Kt,At+pt,!0)]})(j,Ue.x-Ee,Ue.y-Ge,$e,Je),Mt=Math.abs(it[0]-it[1]),ut=Math.abs(it[2]-it[3]),Dt=Math.abs(it[0]-it[2])+Math.abs(it[1]-it[3]),ln=Math.min(.25,.5*be*(Mt+ut)/$e),Vt=Math.min(.25,.5*be*Dt/Je);return we+Math.max(ln*se,Vt*pe)})(p,_,E):O;return{base:O+(s===0?-1:s),top:R?Math.max(z+h,O+s+2):O+h}}class H{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class te{constructor(){this.tasks={},this.taskQueue=[],Yn(["process"],this),this.invoker=new H(this.process),this.nextId=0}add(r,s){const h=this.nextId++,p=(function({type:_,isSymbolTile:x,zoom:E}){return E=E||0,_==="message"?0:_!=="maybePrepare"||x?_!=="parseTile"||x?_==="parseTile"&&x?300-E:_==="maybePrepare"&&x?400-E:500:200-E:100-E})(s);if(p===0){try{r()}finally{}return null}return this.tasks[h]={fn:r,metadata:s,priority:p,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((h=>!!this.tasks[h])),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const s=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let r=null,s=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<s&&(s=_.priority,r=p)}if(r===null)return null;const h=this.taskQueue[r];return this.taskQueue.splice(r,1),h}remove(){this.invoker.remove()}}class Se{constructor(r,s,h){this.target=r,this.parent=s,this.mapId=h,this.callbacks={},this.cancelCallbacks={},Yn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new te}send(r,s,h,p,_=!1,x){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=x,this.callbacks[E]=h);const O=new Set;return this.target.postMessage({id:E,type:r,hasCallback:!!h,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:wc(s,O)},O),{cancel:()=>{h&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(r){const s=r.data;if(!s)return;const h=s.id;if(h&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const p=this.cancelCallbacks[h];delete this.cancelCallbacks[h],p&&p.cancel()}else if(s.mustQueue||yi(self)){const p=this.callbacks[h],_=this.scheduler.add((()=>this.processTask(h,s)),p&&p.metadata||{type:"message"});_&&(this.cancelCallbacks[h]=_)}else this.processTask(h,s)}processTask(r,s){if(delete this.cancelCallbacks[r],s.type==="<response>"){const h=this.callbacks[r];delete this.callbacks[r],h&&(s.error?h(ka(s.error)):h(null,ka(s.data)))}else{const h=new Set,p=s.hasCallback?(x,E)=>{this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:x?wc(x):null,data:wc(E,h)},h)}:()=>{},_=ka(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,_,p);else if(this.parent.getWorkerSource){const x=s.type.split("."),{source:E,scope:O}=_;this.parent.getWorkerSource(s.sourceMapId,x[0],E,O)[x[1]](_,p)}else p(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Be={workerUrl:"",workerClass:null,workerParams:void 0};const bt="mapboxgl_preloaded_worker_pool";class Gt{constructor(){this.active={}}acquire(r,s=Gt.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(Be.workerClass!=null?new Be.workerClass:new self.Worker(Be.workerUrl,Be.workerParams));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.workers&&this.numActive()===0&&(this.workers.forEach((s=>{s.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[bt]}numActive(){return Object.keys(this.active).length}}Gt.workerCount=2;class Sn{constructor(r,s,h="Worker",p=Gt.workerCount){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=zt();const _=this.workerPool.acquire(this.id,p);for(let x=0;x<_.length;x++){const E=new Sn.Actor(_[x],s,this.id);E.name=`${h} ${x}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(r,s,h){et(this.actors,((p,_)=>{p.send(r,s,_)}),h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((r=>{r.remove()})),this.actors=[],this.workerPool.release(this.id)}}let In,sn;function dn(){return In||(In=new Gt),In}Sn.Actor=Se;class _i{constructor(r){this.module=r}createIntArray(r){const s=new Int32Array(r),h=this.module.malloc(s.length*s.BYTES_PER_ELEMENT);return this.module.heap32.set(s,h/s.BYTES_PER_ELEMENT),h}createFloatArray(r){const s=new Float32Array(r),h=this.module.malloc(s.length*s.BYTES_PER_ELEMENT);return this.module.heapF32.set(s,h/s.BYTES_PER_ELEMENT),h}createStringBuffer(r){const s=this.module.malloc(r.length+1);for(let h=0;h<r.length;++h)this.module.heapU8[s+h]=r.charCodeAt(h);return this.module.heapU8[s+r.length]=0,s}readStringBuffer(r){let s="";for(;this.module.heapU8[r]!==0;)s+=String.fromCharCode(this.module.heapU8[r]),++r;return s}setStyle(r){const s=r.entranceColorRgb,h=r.facadeGlazingColorRgb,p=r.roofColorRgb,_=r.wallColorRgb,x=r.normalScale;this.module.setStyle(s[0],s[1],s[2],h[0],h[1],h[2],p[0],p[1],p[2],_[0],_[1],_[2],x[0],x[1],x[2],r.tileToMeters)}setAOOptions(r,s){this.module.setAOOptions(r?1:0,s)}setMetricOptions(r,s){this.module.setMetricOptions(r?1:0,s)}setStructuralOptions(r){this.module.setStructuralOptions(r?1:0)}setFacadeOptions(r,s){this.module.setFacadeOptions(r,s?1:0)}setFauxFacadeOptions(r,s,h){this.module.setFauxFacadeOptions(r?1:0,s?1:0,h)}setFacadeClassifierOptions(r){this.module.setFacadeClassifierOptions(r)}generateMesh(r,s){for(const E of r){const O=this.createStringBuffer(E.roofType),R=[0],z=[];for(const X of E.coordinates)if(Array.isArray(X)){for(const Z of X)z.push(Z.x),z.push(Z.y);R.push(z.length)}const j=this.createIntArray(R),B=this.createFloatArray(z);this.module.addFeature(E.id,E.sourceId,E.minHeight,E.height,O,E.roofType.length,B,j,R.length-1),this.module.free(O),this.module.free(j),this.module.free(B)}for(const E of s){let O;O=E.entrances?JSON.parse(E.entrances):[];const R=this.createFloatArray(O),z=[];for(const B of E.coordinates)z.push(B.x),z.push(B.y);const j=this.createFloatArray(z);this.module.addFacade(E.sourceId,E.crossPerc,E.distanceToRoad,R,O.length,j,z.length),this.module.free(R),this.module.free(j)}if(!this.module.generateMesh()){const E=this.module.getLastError();return this.readStringBuffer(E)}const h=this.module.getMeshCount(),p=new Array(h);for(let E=0;E<h;E++){const O=this.module.getPositionsPtr(E),R=this.module.getPositionsLength(E),z=new Float32Array(this.module.heapF32.buffer,O,R),j=this.module.getNormalsPtr(E),B=this.module.getNormalsLength(E),X=new Float32Array(this.module.heapF32.buffer,j,B),Z=this.module.getColorsPtr(E),ae=this.module.getColorsLength(E),se=new Uint8Array(this.module.heapU8.buffer,Z,ae),pe=this.module.getAOPtr(E),we=this.module.getAOLength(E),be=new Float32Array(this.module.heapF32.buffer,pe,we),Ee=this.module.getUVPtr(E),Ge=this.module.getUVLength(E),Ue=new Float32Array(this.module.heapF32.buffer,Ee,Ge),$e=this.module.getFauxFacadePtr(E),Je=this.module.getFauxFacadeLength(E),it=new Uint8Array(this.module.heapU8.buffer,$e,Je),Mt=this.module.getIndicesPtr(E),ut=this.module.getIndicesLength(E),Dt=new Int32Array(this.module.heap32.buffer,Mt,ut),ln=this.module.getBuildingPart(E),Vt=this.readStringBuffer(ln);p[E]={positions:z,normals:X,colors:se,ao:be,uv:Ue,isFauxFacade:it,indices:Dt,buildingPart:Vt}}const _=this.module.getRingCount(),x=[];for(let E=0;E<_;E++){const O=this.module.getRingPtr(E),R=this.module.getRingLength(E),z=new Float32Array(this.module.heapF32.buffer,O,R);x.push(z)}return{meshes:p,modifiedPolygonRings:x}}}let Kr,La,jt,Ot,Wt,Pn=null,_r=null,Vi=null,Br=null;function ui(){return yi(self)&&self.worker.dracoUrl?self.worker.dracoUrl:La||xo.DRACO_URL}function ws(){if(yi(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Ot)return Ot;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Ot=WebAssembly.validate(l)?xo.MESHOPT_SIMD_URL:xo.MESHOPT_URL,Ot}function Ea(){return Br}const Xu={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},DC={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Tb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function jj(l,r,s){const h=s.json.bufferViews.length,p=s.buffers.length;r.bufferView=h,s.json.bufferViews[h]={buffer:p,byteLength:l.byteLength},s.buffers[p]=l}const kC="KHR_draco_mesh_compression";function Fee(l,r){const s=l.extensions&&l.extensions[kC];if(!s)return;const h=new jt.Decoder,p=Uj(r,s.bufferView),_=new jt.Mesh;if(!h.DecodeArrayToMesh(p,p.byteLength,_))throw new Error("Failed to decode Draco mesh");const x=r.json.accessors[l.indices],E=Xu[x.componentType],O=x.count*E.BYTES_PER_ELEMENT,R=jt._malloc(O);E===Uint16Array?h.GetTrianglesUInt16Array(_,O,R):h.GetTrianglesUInt32Array(_,O,R),jj(jt.memory.buffer.slice(R,R+O),x,r),jt._free(R);for(const z of Object.keys(s.attributes)){const j=h.GetAttributeByUniqueId(_,s.attributes[z]),B=r.json.accessors[l.attributes[z]],X=DC[B.componentType],Z=B.count*Tb[B.type]*Xu[B.componentType].BYTES_PER_ELEMENT,ae=jt._malloc(Z);h.GetAttributeDataArrayForAllPoints(_,j,jt[X],Z,ae),jj(jt.memory.buffer.slice(ae,ae+Z),B,r),jt._free(ae)}h.destroy(),_.destroy(),delete l.extensions[kC]}const WS="EXT_meshopt_compression";function Vee(l,r){if(!l.extensions||!l.extensions[WS])return;const s=l.extensions[WS],h=new Uint8Array(r.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),p=new Uint8Array(s.count*s.byteStride);Wt.decodeGltfBuffer(p,s.count,s.byteStride,h,s.mode,s.filter),l.buffer=r.buffers.length,l.byteOffset=0,r.buffers[l.buffer]=p.buffer,delete l.extensions[WS]}const Bj=1179937895,Fj=new TextDecoder("utf8");function Vj(l,r){return new URL(l,r).href}function Uee(l,r,s,h){return fetch(Vj(l.uri,h)).then((p=>p.arrayBuffer())).then((p=>{r.buffers[s]=p}))}function Uj(l,r){const s=l.json.bufferViews[r];return new Uint8Array(l.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function $ee(l,r,s,h){if(l.uri){const p=Vj(l.uri,h);return fetch(p).then((_=>_.blob())).then((_=>createImageBitmap(_))).then((_=>{r.images[s]=_}))}if(l.bufferView!==void 0){const p=Uj(r,l.bufferView),_=new Blob([p],{type:l.mimeType});return createImageBitmap(_).then((x=>{r.images[s]=x}))}}function $j(l,r=0,s){const h={json:null,images:[],buffers:[]};if(new Uint32Array(l,r,1)[0]===Bj){const z=new Uint32Array(l,r);let j=2;const B=(z[j++]>>2)-3,X=z[j++]>>2;if(j++,h.json=JSON.parse(Fj.decode(z.subarray(j,j+X))),j+=X,j<B){const Z=z[j++];j++;const ae=r+(j<<2);h.buffers[0]=l.slice(ae,ae+Z)}}else h.json=JSON.parse(Fj.decode(new Uint8Array(l,r)));const{buffers:p,images:_,meshes:x,extensionsUsed:E,bufferViews:O}=h.json;let R=Promise.resolve();if(p){const z=[];for(let j=0;j<p.length;j++){const B=p[j];B.uri?z.push(Uee(B,h,j,s)):h.buffers[j]||(h.buffers[j]=null)}R=Promise.all(z)}return R.then((()=>{const z=[],j=E&&E.includes(kC),B=E&&E.includes(WS);if(j&&z.push((function(){if(!jt)return Kr??(Kr=(function(X){let Z,ae=null;function se(){Z=new Uint8Array(ae.buffer)}function pe(){throw new Error("Unexpected Draco error.")}const we={a:{a:pe,d:function(be,Ee,Ge){return Z.copyWithin(be,Ee,Ee+Ge)},c:function(be){const Ee=Z.length,Ge=Math.max(be>>>0,Math.ceil(1.2*Ee)),Ue=Math.ceil((Ge-Ee)/65536);try{return ae.grow(Ue),se(),!0}catch{return!1}},b:pe}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(X,we):X.then((be=>be.arrayBuffer())).then((be=>WebAssembly.instantiate(be,we)))).then((be=>{const{Rb:Ee,Qb:Ge,P:Ue,T:$e,X:Je,Ja:it,La:Mt,Qa:ut,Va:Dt,Wa:ln,eb:Vt,jb:Yt,f:on,e:At,yb:Kt,zb:pt,Ab:Ct,Bb:un,Db:Qt,Gb:Un}=be.instance.exports;ae=At;const kn=(()=>{let Xt=0,an=0,Nn=0,Cn=0;return pn=>{Nn&&(Ee(Cn),Ee(Xt),an+=Nn,Nn=Xt=0),Xt||(an+=128,Xt=Ge(an));const On=pn.length+7&-8;let Jn=Xt;On>=an&&(Nn=On,Jn=Cn=Ge(On));for(let or=0;or<pn.length;or++)Z[Jn+or]=pn[or];return Jn}})();return se(),on(),{memory:At,_free:Ee,_malloc:Ge,Mesh:class{constructor(){this.ptr=Ue()}destroy(){$e(this.ptr)}},Decoder:class{constructor(){this.ptr=it()}destroy(){Yt(this.ptr)}DecodeArrayToMesh(Xt,an,Nn){const Cn=kn(Xt),pn=Mt(this.ptr,Cn,an,Nn.ptr);return!!Je(pn)}GetAttributeByUniqueId(Xt,an){return{ptr:ut(this.ptr,Xt.ptr,an)}}GetTrianglesUInt16Array(Xt,an,Nn){Dt(this.ptr,Xt.ptr,an,Nn)}GetTrianglesUInt32Array(Xt,an,Nn){ln(this.ptr,Xt.ptr,an,Nn)}GetAttributeDataArrayForAllPoints(Xt,an,Nn,Cn,pn){Vt(this.ptr,Xt.ptr,an.ptr,Nn,Cn,pn)}},DT_INT8:Kt(),DT_UINT8:pt(),DT_INT16:Ct(),DT_UINT16:un(),DT_UINT32:Qt(),DT_FLOAT32:Un()}}))})(fetch(ui())),Kr.then((X=>{jt=X,Kr=void 0})))})()),B&&z.push((function(){if(Wt)return;const X=(function(Z){let ae;const se=WebAssembly.instantiateStreaming(Z,{}).then((be=>{ae=be.instance,ae.exports.__wasm_call_ctors()})),pe={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},we={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:se,supported:!0,decodeGltfBuffer(be,Ee,Ge,Ue,$e,Je){(function(it,Mt,ut,Dt,ln,Vt,Yt){const on=it.exports.sbrk,At=Dt+3&-4,Kt=on(At*ln),pt=on(Vt.length),Ct=new Uint8Array(it.exports.memory.buffer);Ct.set(Vt,pt);const un=Mt(Kt,Dt,ln,pt,Vt.length);if(un===0&&Yt&&Yt(Kt,At,ln),ut.set(Ct.subarray(Kt,Kt+Dt*ln)),on(Kt-on(0)),un!==0)throw new Error(`Malformed buffer data: ${un}`)})(ae,ae.exports[we[$e]],be,Ee,Ge,Ue,ae.exports[pe[Je]])}}})(fetch(ws()));return X.ready.then((()=>{Wt=X}))})()),_)for(let X=0;X<_.length;X++)z.push($ee(_[X],h,X,s));return(z.length?Promise.all(z):Promise.resolve()).then((()=>{if(j&&x)for(const{primitives:X}of x)for(const Z of X)Fee(Z,h);if(B&&x&&O)for(const X of O)Vee(X,h);return h}))}))}function LC(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function NC(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class zC{constructor(r,s,h,p){this.context=r,this.format=h,this.useMipmap=p&&p.useMipmap,this.texture=r.gl.createTexture(),this.update(s,{premultiply:p&&p.premultiply})}update(r,s){const h=r&&r instanceof HTMLVideoElement&&r.width===0?r.videoWidth:r.width,p=r&&r instanceof HTMLVideoElement&&r.height===0?r.videoHeight:r.height,{context:_}=this,{gl:x}=_,{x:E,y:O}=s&&s.position?s.position:{x:0,y:0},R=E+h,z=O+p;!this.size||this.size[0]===R&&this.size[1]===z||(x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(this.texture),this.texture=x.createTexture(),this.size=null),x.bindTexture(x.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA8&&(!s||s.premultiply!==!1));const j=r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap;if(!this.size&&R>0&&z>0){const B=this.useMipmap?Math.floor(Math.log2(Math.max(R,z)))+1:1;x.texStorage2D(x.TEXTURE_2D,B,this.format,R,z),this.size=[R,z]}if(this.size)if(j)x.texSubImage2D(x.TEXTURE_2D,0,E,O,LC(this.format),NC(this.format),r);else{const B=r.data;B&&x.texSubImage2D(x.TEXTURE_2D,0,E,O,h,p,LC(this.format),NC(this.format),B)}this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(r,s,h=!1){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),r!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,r),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap&&!h?r===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),s!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(r,s,h,p,_){const{context:x}=this,{gl:E}=x;E.bindTexture(E.TEXTURE_2D,this.texture),s!==this.magFilter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,s),this.magFilter=s),r!==this.minFilter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,this.useMipmap?r===E.NEAREST?E.NEAREST_MIPMAP_NEAREST:E.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),h!==this.wrapS&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,h),this.wrapS=h),p!==this.wrapT&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,p),this.wrapT=p),_!==this.compareMode&&(_?(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_COMPARE_MODE,E.COMPARE_REF_TO_TEXTURE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_COMPARE_FUNC,_)):E.texParameteri(E.TEXTURE_2D,E.TEXTURE_COMPARE_MODE,E.NONE),this.compareMode=_)}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class Eb{constructor(r,s){this.context=r,this.texture=s}bind(r,s){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,r),this.minFilter=r),s!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,s),this.wrapS=s)}}const qee=Ur([{name:"a_pos_3f",components:3,type:"Float32"}]),Hee=Ur([{name:"a_color_3f",components:3,type:"Float32"}]),Gee=Ur([{name:"a_color_4f",components:4,type:"Float32"}]),Wee=Ur([{name:"a_uv_2f",components:2,type:"Float32"}]),Xee=Ur([{name:"a_normal_3f",components:3,type:"Float32"}]),Zee=Ur([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Yee=Ur([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function qj(l,r){const s=XS(l.projection,l.zoom,l.width,l.height),h=(function(_,x,E,O,R){const z=new U(E.lng-180*$g,E.lat),j=new U(E.lng+180*$g,E.lat),B=_.project(z.lng,z.lat),X=_.project(j.lng,j.lat),Z=-Math.atan2(X.y-B.y,X.x-B.x),ae=je.fromLngLat(E);ae.y=Pe(ae.y,-1+$g,1-$g);const se=ae.toLngLat(),pe=_.project(se.lng,se.lat),we=je.fromLngLat(se);we.x+=$g;const be=we.toLngLat(),Ee=_.project(be.lng,be.lat),Ge=Gj(Ee.x-pe.x,Ee.y-pe.y,Z),Ue=je.fromLngLat(se);Ue.y+=$g;const $e=Ue.toLngLat(),Je=_.project($e.lng,$e.lat),it=Gj(Je.x-pe.x,Je.y-pe.y,Z),Mt=Math.abs(Ge.x)/Math.abs(it.y),ut=q([]);ce(ut,ut,-Z*(1-(R?0:O)));const Dt=q([]);return re(Dt,Dt,[1,1-(1-Mt)*O,1]),Dt[4]=-it.x/it.y*O,ce(Dt,Dt,Z),J(Dt,ut,Dt),Dt})(l.projection,0,l.center,s,r),p=Hj(l);return re(h,h,[p,p,1]),h}function Hj(l){const r=l.projection,s=XS(l.projection,l.zoom,l.width,l.height),h=jC(r,l.center),p=jC(r,U.convert(r.center));return Math.pow(2,h*s+(1-s)*p)}function XS(l,r,s,h,p=1/0){const _=l.range;if(!_)return 0;const x=Math.min(p,Math.max(s,h)),E=Math.log(x/1024)/Math.LN2;return Ke(_[0]+E,_[1]+E,r)}const $g=1/4e4;function jC(l,r){const s=Pe(r.lat,-ke,ke),h=new U(r.lng-180*$g,s),p=new U(r.lng+180*$g,s),_=l.project(h.lng,s),x=l.project(p.lng,s),E=je.fromLngLat(h),O=je.fromLngLat(p),R=x.x-_.x,z=x.y-_.y,j=O.x-E.x,B=O.y-E.y,X=Math.sqrt((j*j+B*B)/(R*R+z*z));return Math.log(X)/Math.LN2}function Gj(l,r,s){const h=Math.cos(s),p=Math.sin(s);return{x:l*h-r*p,y:l*p+r*h}}function Wj(l,r,s){q(l),ce(l,l,hr(r[2])),fe(l,l,hr(r[0])),ne(l,l,hr(r[1])),re(l,l,s),J(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function ZS(l,r,s,h,p,_,x,E){const O=[s[0]-r[0],s[1]-r[1],0],R=[h[0]-r[0],h[1]-r[1],0];if(at(O)<1e-12||at(R)<1e-12)return $n(l);const z=mn([],O,R);qt(z,z),rt(R,h,r),O[2]=(_-p)*E,R[2]=(x-p)*E;const j=O;return mn(j,O,R),qt(j,j),_o(l,z,j)}function BC(l,r,s=!1){const h=Uf(r.zoom),p=(function(_,x,E){const O=x.worldSize,R=[_[12],_[13],_[14]],z=Te(R[1]/O),j=xe(R[0]/O),B=q([]),X=de(1,z)*O,Z=de(1,0)*O*Ve(z,x.zoom),ae=1/Id(O);let se=Z*ae;if(E){const Ee=XS(x.projection,x.zoom,x.width,x.height,1024);se=ae*x.projection.pixelSpaceConversion(x.center.lat,O,Ee)}const pe=I(z,j);Ie(pe,pe,vt([],qt([],pe),X*se*R[2]));const we=(function(Ee){const Ge=[Ee[0],Ee[1],Ee[2]];let Ue=[0,1,0];const $e=mn([],Ue,Ge);return mn(Ue,Ge,$e),Ut(Ue)===0&&(Ue=[0,1,0],mn($e,Ge,Ue)),qt($e,$e),qt(Ue,Ue),qt(Ge,Ge),[$e[0],$e[1],$e[2],0,Ue[0],Ue[1],Ue[2],0,Ge[0],Ge[1],Ge[2],0,Ee[0],Ee[1],Ee[2],1]})(pe);re(B,B,[se,se,se*X]),ee(B,B,[-R[0],-R[1],-R[2]]);const be=J([],x.globeMatrix,we);return J(be,be,B),J(be,be,_),be})(l,r,s);if(h>0){const _=(function(x,E){const O=E.worldSize,R=de(1,0)*O*Ve(E.center.lat,E.zoom)/Id(O),z=de(1,E.center.lat)*O,j=q([]);return ne(j,j,hr(E.center.lng)),fe(j,j,hr(E.center.lat)),ee(j,j,[0,0,Za]),re(j,j,[R,R,R*z]),ee(j,j,[E.point.x-.5*O,E.point.y-.5*O,0]),J(j,j,x),J(j,E.globeMatrix,j)})(l,r);return(function(x,E,O){const R=(Z,ae,se)=>{const pe=at(Z),we=at(ae),be=Od(Z,ae,se);return vt(be,be,1/at(be)*Gn(pe,we,se))},z=R([x[0],x[1],x[2]],[E[0],E[1],E[2]],O),j=R([x[4],x[5],x[6]],[E[4],E[5],E[6]],O),B=R([x[8],x[9],x[10]],[E[8],E[9],E[10]],O),X=Od([x[12],x[13],x[14]],[E[12],E[13],E[14]],O);return[z[0],z[1],z[2],0,j[0],j[1],j[2],0,B[0],B[1],B[2],0,X[0],X[1],X[2],1]})(p,_,h)}return p}function Xj(l,r,s,h){const p=br.projectAabbCorners(h,s);let _=Number.MAX_VALUE,x=-1;for(let R=0;R<p.length;++R){const z=p[R];z[0]=(.5*z[0]+.5)*r.width,z[1]=(.5-.5*z[1])*r.height,z[2]<_&&(x=R,_=z[2])}const E=R=>new kt(p[R][0],p[R][1]);let O;switch(x){case 0:case 6:O=[E(1),E(5),E(4),E(7),E(3),E(2),E(1)];break;case 1:case 7:O=[E(0),E(4),E(5),E(6),E(2),E(3),E(0)];break;case 3:case 5:O=[E(1),E(0),E(4),E(7),E(6),E(2),E(1)];break;default:O=[E(1),E(5),E(6),E(7),E(3),E(0),E(1)]}if(Ai(l,O))return _}const S_=64,Yv={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function Zj(l,r,s,h,p,_,x,E,O,R=!1){const z=s.zoom,j=s.project(h),B=Ve(h.lat,z),X=1/B;q(l),ee(l,l,[j.x+x[0]*X,j.y+x[1]*X,x[2]]);let Z=1,ae=1;const se=s.worldSize;if(R){if(s.projection.name==="mercator"){let Ee=0;s.elevation&&(Ee=s.elevation.getAtPointOrZero(new je(j.x/se,j.y/se),0));const Ge=Bt([],[j.x,j.y,Ee,1],s.projMatrix)[3]/s.cameraToCenterDistance;Z=Ge,ae=Ge*Ve(s.center.lat,z)}else if(s.projection.name==="globe"){const Ee=BC(l,s),Ge=[0,0,0,1];Bt(Ge,Ge,J([],s.projMatrix,Ee));const Ue=Ge[3]/s.cameraToCenterDistance,$e=Uf(z),Je=s.projection.pixelsPerMeter(h.lat,se)*Ve(h.lat,z),it=s.projection.pixelsPerMeter(s.center.lat,se)*Ve(s.center.lat,z);Z=Ue/Gn(Je,Fe(s.center.lat),$e),ae=Ue*B/Je,Z*=it,ae*=it}}else Z=X;re(l,l,[Z,Z,ae]);const pe=[...l],we=r.orientation,be=[];if(Wj(be,[we[0]+p[0],we[1]+p[1],we[2]+p[2]],_),J(l,pe,be),E&&s.elevation){let Ee=0;const Ge=[];if(O&&s.elevation){Ee=(function($e,Je,it,Mt,ut){const Dt=Je.elevation;if(!Dt)return 0;const ln=br.projectAabbCorners(it,Mt),Vt=de(1,ut.lat)*Je.worldSize,Yt=(function(an,Nn){const Cn=[0,0,1],pn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const On of pn){const Jn=an[On.corners[0]],or=an[On.corners[1]],wr=an[On.corners[2]],ur=[or[0]-Jn[0],or[1]-Jn[1],Nn*(or[2]-Jn[2])],Xr=mn(ur,ur,[wr[0]-Jn[0],wr[1]-Jn[1],Nn*(wr[2]-Jn[2])]);qt(Xr,Xr),On.dotProductWithUp=Ht(Xr,Cn)}return pn.sort(((On,Jn)=>On.dotProductWithUp-Jn.dotProductWithUp)),pn[0].corners})(ln,Vt),on=ln[Yt[0]],At=ln[Yt[1]],Kt=ln[Yt[2]],pt=ln[Yt[3]],Ct=Dt.getAtPointOrZero(new je(on[0]/Je.worldSize,on[1]/Je.worldSize),0),un=Dt.getAtPointOrZero(new je(At[0]/Je.worldSize,At[1]/Je.worldSize),0),Qt=Dt.getAtPointOrZero(new je(Kt[0]/Je.worldSize,Kt[1]/Je.worldSize),0),Un=Dt.getAtPointOrZero(new je(pt[0]/Je.worldSize,pt[1]/Je.worldSize),0),kn=(Ct+Un)/2,Xt=(un+Qt)/2;return kn>Xt?un<Qt?ZS($e,At,pt,on,un,Un,Ct,Vt):ZS($e,Kt,on,pt,Qt,Ct,Un,Vt):Ct<Un?ZS($e,on,At,Kt,Ct,un,Qt,Vt):ZS($e,pt,Kt,At,Un,Qt,un,Vt),Math.max(kn,Xt)})(Ge,s,r.aabb,l,h);const Ue=J([],De([],Ge),be);J(l,pe,Ue)}else Ee=s.elevation.getAtPointOrZero(new je(j.x/se,j.y/se),0);Ee!==0&&(l[14]+=Ee)}}function Ab(l,r,s=!1){l.uploaded||(l.gfxTexture=new zC(r,l.image,s?r.gl.R8:r.gl.RGBA8,{useMipmap:l.sampler.minFilter>=r.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function Kee(l,r,s){l.indexBuffer=r.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=r.createVertexBuffer(l.vertexArray,qee.members,!1,!0),l.normalArray&&(l.normalBuffer=r.createVertexBuffer(l.normalArray,Xee.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=r.createVertexBuffer(l.texcoordArray,Wee.members,!1,!0)),l.colorArray&&(l.colorBuffer=r.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?Hee:Gee).members,!1,!0)),l.featureArray&&(l.pbrBuffer=r.createVertexBuffer(l.featureArray,Yee.members,!0)),l.segments=Ki.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const h=l.material;h.pbrMetallicRoughness.baseColorTexture&&Ab(h.pbrMetallicRoughness.baseColorTexture,r),h.pbrMetallicRoughness.metallicRoughnessTexture&&Ab(h.pbrMetallicRoughness.metallicRoughnessTexture,r),h.normalTexture&&Ab(h.normalTexture,r),h.occlusionTexture&&Ab(h.occlusionTexture,r,s),h.emissionTexture&&Ab(h.emissionTexture,r)}function FC(l,r,s){if(l.meshes)for(const h of l.meshes)Kee(h,r,s);if(l.children)for(const h of l.children)FC(h,r,s)}function YS(l){if(l.meshes)for(const r of l.meshes)r.indexArray.destroy(),r.vertexArray.destroy(),r.colorArray&&r.colorArray.destroy(),r.normalArray&&r.normalArray.destroy(),r.texcoordArray&&r.texcoordArray.destroy(),r.featureArray&&r.featureArray.destroy();if(l.children)for(const r of l.children)YS(r)}function VC(l){if(l.meshes)for(const s of l.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((r=s.material).pbrMetallicRoughness.baseColorTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),r.pbrMetallicRoughness.metallicRoughnessTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),r.normalTexture&&r.normalTexture.gfxTexture&&r.normalTexture.gfxTexture.destroy(),r.emissionTexture&&r.emissionTexture.gfxTexture&&r.emissionTexture.gfxTexture.destroy(),r.occlusionTexture&&r.occlusionTexture.gfxTexture&&r.occlusionTexture.gfxTexture.destroy()));var r;if(l.children)for(const s of l.children)VC(s)}function T_(l,r){const s=l.json.bufferViews[r.bufferView],h=Xu[r.componentType];return new h(l.buffers[s.buffer],(r.byteOffset||0)+(s.byteOffset||0),r.count*(s.byteStride&&s.byteStride!==Tb[r.type]*h.BYTES_PER_ELEMENT?s.byteStride/h.BYTES_PER_ELEMENT:Tb[r.type]))}function UC(l,r,s,h){const p=Xu[r.componentType],_=(function(z){switch(z){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}})(p),x=l.json.bufferViews[r.bufferView],E=x.byteStride?x.byteStride/p.BYTES_PER_ELEMENT:Tb[r.type],O=s.float32,R=O.length/s.capacity;for(let z=0,j=0;z<r.count*E;z+=E,j+=R)for(let B=0;B<R;B++)O[j+B]=h[z+B]*_;s._trim()}function Jee(l,r,s){const h=l.indices,p=l.attributes,_={};_.indexArray=new Zr;const x=r.json.accessors[h],E=x.count/3;_.indexArray.reserve(E);const O=T_(r,x);for(let B=0;B<E;B++)_.indexArray.emplaceBack(O[3*B],O[3*B+1],O[3*B+2]);_.indexArray._trim(),_.vertexArray=new Is;const R=r.json.accessors[p.POSITION];_.vertexArray.reserve(R.count);const z=T_(r,R);for(let B=0;B<R.count;B++)_.vertexArray.emplaceBack(z[3*B],z[3*B+1],z[3*B+2]);if(_.vertexArray._trim(),_.aabb=new br(R.min,R.max),_.centroid=(function(B,X){const Z=[0,0,0],ae=B.length;if(ae>0){for(let se=0;se<ae;se++){const pe=3*B[se];Z[0]+=X[pe],Z[1]+=X[pe+1],Z[2]+=X[pe+2]}Z[0]/=ae,Z[1]/=ae,Z[2]/=ae}return Z})(O,z),p.COLOR_0!==void 0){const B=r.json.accessors[p.COLOR_0],X=Tb[B.type],Z=T_(r,B);_.colorArray=X===3?new Is:new Bu,_.colorArray.resize(B.count),UC(r,B,_.colorArray,Z)}if(p.NORMAL!==void 0){_.normalArray=new Is;const B=r.json.accessors[p.NORMAL];_.normalArray.resize(B.count);const X=T_(r,B);UC(r,B,_.normalArray,X)}if(p.TEXCOORD_0!==void 0&&s.length>0){_.texcoordArray=new Vu;const B=r.json.accessors[p.TEXCOORD_0];_.texcoordArray.resize(B.count);const X=T_(r,B);UC(r,B,_.texcoordArray,X)}if(p._FEATURE_ID_RGBA4444!==void 0){const B=r.json.accessors[p._FEATURE_ID_RGBA4444];r.json.extensionsUsed&&r.json.extensionsUsed.includes("EXT_meshopt_compression")&&(_.featureData=T_(r,B))}p._FEATURE_RGBA4444!==void 0&&(_.featureData=new Uint32Array(T_(r,r.json.accessors[p._FEATURE_RGBA4444]).buffer));const j=l.material;return _.material=(function(B,X){const{emissiveFactor:Z=[0,0,0],alphaMode:ae="OPAQUE",alphaCutoff:se=.5,normalTexture:pe,occlusionTexture:we,emissiveTexture:be,doubleSided:Ee}=B,{baseColorFactor:Ge=[1,1,1,1],metallicFactor:Ue=1,roughnessFactor:$e=1,baseColorTexture:Je,metallicRoughnessTexture:it}=B.pbrMetallicRoughness||{},Mt=we?X[we.index]:void 0;if(we&&we.extensions&&we.extensions.KHR_texture_transform&&Mt){const ut=we.extensions.KHR_texture_transform;Mt.offsetScale=[ut.offset[0],ut.offset[1],ut.scale[0],ut.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new pi(...Ge),metallicFactor:Ue,roughnessFactor:$e,baseColorTexture:Je?X[Je.index]:void 0,metallicRoughnessTexture:it?X[it.index]:void 0},doubleSided:Ee,emissiveFactor:new pi(...Z),alphaMode:ae,alphaCutoff:se,normalTexture:pe?X[pe.index]:void 0,occlusionTexture:Mt,emissionTexture:be?X[be.index]:void 0,defined:B.defined===void 0}})(j!==void 0?r.json.materials[j]:{defined:!1},s),_}function Yj(l,r,s){const{matrix:h,rotation:p,translation:_,scale:x,mesh:E,extras:O,children:R}=l,z={};if(z.matrix=h||(function(j,B,X,Z){var ae=B[0],se=B[1],pe=B[2],we=B[3],be=ae+ae,Ee=se+se,Ge=pe+pe,Ue=ae*be,$e=ae*Ee,Je=ae*Ge,it=se*Ee,Mt=se*Ge,ut=pe*Ge,Dt=we*be,ln=we*Ee,Vt=we*Ge,Yt=Z[0],on=Z[1],At=Z[2];return j[0]=(1-(it+ut))*Yt,j[1]=($e+Vt)*Yt,j[2]=(Je-ln)*Yt,j[3]=0,j[4]=($e-Vt)*on,j[5]=(1-(Ue+ut))*on,j[6]=(Mt+Dt)*on,j[7]=0,j[8]=(Je+ln)*At,j[9]=(Mt-Dt)*At,j[10]=(1-(Ue+it))*At,j[11]=0,j[12]=X[0],j[13]=X[1],j[14]=X[2],j[15]=1,j})([],p||[0,0,0,1],_||[0,0,0],x||[1,1,1]),E!==void 0){z.meshes=s[E];const j=z.anchor=[0,0];for(const B of z.meshes){const{min:X,max:Z}=B.aabb;j[0]+=X[0]+Z[0],j[1]+=X[1]+Z[1]}j[0]=Math.floor(j[0]/z.meshes.length/2),j[1]=Math.floor(j[1]/z.meshes.length/2)}if(O&&(O.id&&(z.id=O.id),O.lights&&(z.lights=(function(j){if(!j.length)return[];const B=(function(pe){const we=atob(pe),be=new Uint8Array(we.length);for(let Ee=0;Ee<we.length;Ee++)be[Ee]=we.codePointAt(Ee);return be})(j),X=[],Z=B.length/24,ae=new Uint16Array(B.buffer),se=new Float32Array(B.buffer);for(let pe=0;pe<Z;pe++){const we=ae[2*pe*6]/30,be=ae[2*pe*6+1]/30,Ee=ae[2*pe*6+10]/100,Ge=se[6*pe+1],Ue=se[6*pe+2],$e=se[6*pe+3],Je=se[6*pe+4],it=$e-Ge,Mt=Je-Ue,ut=Math.hypot(it,Mt);X.push({pos:[Ge+.5*it,Ue+.5*Mt,be],normal:[Mt/ut,-it/ut,0],width:ut,height:we,depth:Ee,points:[Ge,Ue,$e,Je]})}return X})(O.lights))),R){const j=[];for(const B of R)j.push(Yj(r.json.nodes[B],r,s));z.children=j}return z}function Qee(l){if(l.vertices.length===0||l.indices.length===0)return null;const r=new qf(l.vertices,l.indices,8,256),[s,h]=[r.min.clone(),r.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:r,min:s,max:h}}function ete(l){if(!l.extras||!l.extras.ground)return null;const r=l.extras.ground;if(!r||!Array.isArray(r)||r.length===0)return null;const s=r[0];if(!s||!Array.isArray(s)||s.length===0)return null;const h=[];for(const x of s){if(!Array.isArray(x)||x.length!==2)continue;const E=x[0],O=x[1];typeof E=="number"&&typeof O=="number"&&h.push(new kt(E,O))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let p=0;for(let x=0;x<h.length;x++){const E=h[x],O=h[(x+1)%h.length],R=h[(x+2)%h.length];p+=(E.x-O.x)*(R.y-O.y)-(R.x-O.x)*(E.y-O.y)}p>0&&h.reverse();const _=pm(h.flatMap((x=>[x.x,x.y])),[]);return _.length===0?null:{vertices:h,indices:_}}function tte(l,r){const s=[],h=[];let p=0;const _=[];for(const x of l){p=s.length;const E=x.vertexArray.float32,O=x.indexArray.uint16;for(let R=0;R<x.vertexArray.length;R++)_[0]=E[3*R+0],_[1]=E[3*R+1],_[2]=E[3*R+2],En(_,_,r),s.push(new kt(_[0],_[1]));for(let R=0;R<3*x.indexArray.length;R++)h.push(O[R]+p)}if(h.length%3!=0)return null;for(let x=0;x<h.length;x+=3){const E=s[h[x+0]],O=s[h[x+1]],R=s[h[x+2]];(E.x-O.x)*(R.y-O.y)-(R.x-O.x)*(E.y-O.y)>0&&([h[x+1],h[x+2]]=[h[x+2],h[x+1]])}return{vertices:s,indices:h}}function Kj(l){const r=(function(O,R){const z=[],j=WebGL2RenderingContext;if(O.json.textures)for(const B of O.json.textures){const X={magFilter:j.LINEAR,minFilter:j.NEAREST,wrapS:j.REPEAT,wrapT:j.REPEAT};B.sampler!==void 0&&Object.assign(X,O.json.samplers[B.sampler]),z.push({image:R[B.source],sampler:X,uploaded:!1})}return z})(l,l.images),s=(function(O,R){const z=[];for(const j of O.json.meshes){const B=[];for(const X of j.primitives)B.push(Jee(X,O,R));z.push(B)}return z})(l,r),{scenes:h,scene:p,nodes:_}=l.json,x=h?h[p||0].nodes:_,E=[];for(const O of x)E.push(Yj(_[O],l,s));return(function(O,R,z){const j={},B=new Set;for(let X=0;X<O.length;X++){const Z=z[R[X]];if(!Z.extras)continue;const ae=Z.extras["mapbox:footprint:version"],se=Z.extras["mapbox:footprint:id"];(ae||se)&&B.add(X),ae==="1.0.0"&&se&&(j[se]=X)}for(let X=0;X<O.length;X++){if(B.has(X))continue;const Z=O[X],ae=z[R[X]];if(!ae.extras)continue;let se=null;Z.id in j&&(se=tte(O[j[Z.id]].meshes,Z.matrix)),se||(se=ete(ae)),se&&(Z.footprint=Qee(se))}if(B.size>0){const X=Array.from(B.values()).sort(((Z,ae)=>Z-ae));for(let Z=X.length-1;Z>=0;Z--)O.splice(X[Z],1)}})(E,x,l.json.nodes),E}function nte(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const r=l.vertexArray.float32,s=l.aabb.min[0]-1,h=l.aabb.min[1]-1,p=S_/(l.aabb.max[0]-s+2),_=S_/(l.aabb.max[1]-h+2);for(let x=0;x<r.length;x+=3){const E=r[x+2],O=(r[x+0]-s)*p|0,R=(r[x+1]-h)*_|0;E>l.heightmap[R*S_+O]&&(l.heightmap[R*S_+O]=E)}}function Jj(l,r,s,h,p){s.reserve(s.length+4*l.length),h.reserve(h.length+10*l.length),p.reserve(p.length+10*l.length);let _=h.length;for(const x of l){const E=Math.min(10,Math.max(4,1.3*x.height))*r,O=[-x.normal[1],x.normal[0],0],R=Math.min(.29,.1*x.width/x.depth),z=x.width-2*x.depth*r*(R+.01),j=nt([],x.pos,O,z/2),B=nt([],x.pos,O,-z/2),X=[j[0],j[1],j[2]+x.height],Z=[B[0],B[1],B[2]+x.height],ae=nt([],x.normal,O,R);vt(ae,ae,E);const se=nt([],x.normal,O,-R);vt(se,se,E),Ie(ae,j,ae),Ie(se,B,se),j[2]+=.1,B[2]+=.1,h.emplaceBack(ae[0],ae[1],ae[2]),h.emplaceBack(se[0],se[1],se[2]),h.emplaceBack(j[0],j[1],j[2]),h.emplaceBack(B[0],B[1],B[2]),h.emplaceBack(X[0],X[1],X[2]),h.emplaceBack(Z[0],Z[1],Z[2]),h.emplaceBack(j[0],j[1],j[2]),h.emplaceBack(B[0],B[1],B[2]),h.emplaceBack(ae[0],ae[1],ae[2]),h.emplaceBack(se[0],se[1],se[2]);const pe=z/E/2;p.emplaceBack(-pe-R,-1,pe,.8),p.emplaceBack(pe+R,-1,pe,.8),p.emplaceBack(-pe,0,pe,1.3),p.emplaceBack(pe,0,pe,1.3),p.emplaceBack(pe+R,-.8,pe,.7),p.emplaceBack(pe+R,-.8,pe,.7),p.emplaceBack(0,0,pe,1.3),p.emplaceBack(0,0,pe,1.3),p.emplaceBack(pe+R,-1.2,pe,.8),p.emplaceBack(pe+R,-1.2,pe,.8),s.emplaceBack(6+_,4+_,8+_),s.emplaceBack(7+_,9+_,5+_),s.emplaceBack(0+_,1+_,2+_),s.emplaceBack(1+_,3+_,2+_),_+=10}}function rte(l,r){const s={};s.indexArray=new Zr,s.vertexArray=new Is,s.colorArray=new Bu,Jj(l,r,s.indexArray,s.vertexArray,s.colorArray);const h={defined:!0};h.emissiveFactor=pi.black;const p={};return p.baseColorFactor=pi.white,h.pbrMetallicRoughness=p,s.material=h,s.aabb=new br([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}const Qj=Ur([{name:"a_pos_3f",components:3,type:"Float32"}]),ite=Ur([{name:"a_normal_3",components:3,type:"Int16"}]),e3=Ur([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),ate=Ur([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),t3=mt.types,$C=32767;function ote(l,r){const s=nn+r;for(const h of l)for(const p of h)if(p.x<-r||p.x>s||p.y<-r||p.y>s)return!1;return!0}class n3{constructor(r){this.layoutAOArray=[],this.indexArrayForConflationUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.footprintLookup={},this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.fqid)),this.index=r.index,this.hasPattern=!1,this.worldview=r.worldview,this.layoutVertexArray=new Is,this.layoutNormalArray=new Td,this.layoutColorArray=new Qo,this.indexArray=new Zr,this.indexArrayForConflation=new Zr,this.entranceBloom={layoutVertexArray:new Is,layoutVertexBuffer:null,layoutAttenuationArray:new Bu,layoutAttenuationBuffer:null,layoutColorArray:new Qo,layoutColorBuffer:null,indexArray:new Zr,indexArrayForConflation:new Zr,indexBuffer:null,segmentsBucket:new Ki},this.programConfigurations=new Ks(r.layers,{zoom:r.zoom,lut:r.lut}),this.segmentsBucket=new Ki,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.projection=r.projection,this.groundEffect=new vm(r)}get segments(){return this.segmentsBucket}get bloomGeometry(){return this.entranceBloom}updateFootprints(r,s){for(const h of this.footprints)s.push({footprint:h,id:r})}prepare(){return(function(){if(Br!=null||Vi!=null)return null;if(_r!=null)return _r;const r=fetch(xo.BUILDING_GEN_URL);return _r=(function(s){let h,p,_,x;function E(){h=new Uint8Array(x.buffer),p=new Int32Array(x.buffer),_=new Float32Array(x.buffer)}function O(){throw new Error("Unexpected BuildingGen error.")}const R=()=>{},z={a:{a:O,f:function(j){const B=h.length,X=Math.max(j>>>0,Math.ceil(1.2*B)),Z=Math.ceil((X-B)/65536);try{return x.grow(Z),E(),!0}catch{return!1}},g:O,b:R,c:R,d:R,e:R}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(s,z):s.then((j=>j.arrayBuffer())).then((j=>WebAssembly.instantiate(j,z)))).then((j=>{const B=j.instance.exports;return(0,B.g)(),x=B.f,E(),new _i({setStyle:B.h,setAOOptions:B.i,setMetricOptions:B.j,setStructuralOptions:B.k,setFacadeOptions:B.l,setFauxFacadeOptions:B.m,setFacadeClassifierOptions:B.n,addFeature:B.o,addFacade:B.p,generateMesh:B.q,getLastError:B.r,getMeshCount:B.s,getPositionsPtr:B.t,getPositionsLength:B.u,getNormalsPtr:B.v,getNormalsLength:B.w,getColorsPtr:B.x,getColorsLength:B.y,getAOPtr:B.z,getAOLength:B.A,getUVPtr:B.B,getUVLength:B.C,getFauxFacadePtr:B.D,getFauxFacadeLength:B.E,getIndicesPtr:B.F,getIndicesLength:B.G,getBuildingPart:B.H,getRingCount:B.I,getRingPtr:B.J,getRingLength:B.K,free:B.L,malloc:B.M,heapU8:h,heap32:p,heapF32:_})}))})(r).then((s=>(_r=null,Br=s,Br))).catch((s=>{jr("Could not load building-gen"),_r=null,Vi=s})),_r})()}populate(r,s,h,p){const _=Ea();if(!_)return;const x=Ne(h);this.tileToMeter=x,this.brightness=s.brightness,_.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,x],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:x,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),_.setAOOptions(!1,.3),_.setMetricOptions(!1,16),_.setStructuralOptions(!0),_.setFacadeOptions(4,!0),_.setFauxFacadeOptions(!1,!1,1),_.setFacadeClassifierOptions(3);const E=new Map;for(const{feature:O}of r){if(t3[O.type]!=="LineString")continue;const R=this.layers[0]._featureFilter.needGeometry,z=Tt(O,R);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),z,h))continue;const j=R?z.geometry:We(O,h,p),B=[];for(const se of j)for(const pe of se)B.push({x:pe.x,y:pe.y});const X={coordinates:B,crossPerc:O.properties.cross_perc,distanceToRoad:O.properties.distance_to_road,entrances:O.properties.entrances,sourceId:0},Z=O.properties.source_id;let ae=E.get(Z);ae||(ae=[],E.set(Z,ae)),ae.push(X)}this.maxHeight=0;for(const{feature:O,index:R}of r){if(t3[O.type]==="LineString")continue;const z=this.layers[0]._featureFilter.needGeometry,j=Tt(O,z);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom),j,h))continue;const B=z?j.geometry:We(O,h,p),X=m_(B,500);if(!ote(B,163))continue;const Z=this.layers[0],ae=Z.layout.get("building-base").evaluate(O,{},h),se=Z.layout.get("building-height").evaluate(O,{},h),pe=Z.layout.get("building-roof-shape").evaluate(O,{},h),we=Z.paint.get("building-ambient-occlusion-intensity"),be=Z.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(pe==="flat")continue;const Ee=O.properties.source_id;let Ge;Ge=E.has(Ee)?E.get(Ee):[];const Ue=[],$e=new kt(1/0,1/0),Je=new kt(-1/0,-1/0);for(const Xt of X)if(Xt.length>0){const an=[];for(const Nn of Xt){const Cn=[];for(let pn=Nn.length-1;pn>=0;pn--){const On=Nn[pn];Cn.push({x:On.x,y:On.y}),$e.x=Math.min($e.x,On.x),$e.y=Math.min($e.y,On.y),Je.x=Math.max(Je.x,On.x),Je.y=Math.max(Je.y,On.y)}an.push(Cn)}Ue.push({id:O.id,height:se,minHeight:ae,sourceId:0,roofType:pe,coordinates:an})}const it=_.generateMesh(Ue,Ge);if(typeof it=="string"||it.meshes.length===0||it.modifiedPolygonRings.length===0)continue;let Mt=0;for(const Xt of it.meshes)Mt+=Xt.positions.length/3;const ut=this.segmentsBucket.prepareSegment(Mt,this.layoutVertexArray,this.indexArray),Dt=[];let ln=null,Vt=0,Yt=-1;const on=this.indexArray.length;let At=0;for(const Xt of it.meshes){const an=this.layoutVertexArray.length;if(Xt.buildingPart==="entrance"){const Cn=new Array;for(let or=0;or<Xt.indices.length;or+=12){const wr=Xt.positions[or+0],ur=Xt.positions[or+1],Xr=Xt.positions[or+3],Lr=Xt.positions[or+4],Ji=Xt.positions[or+2],Oe=Xt.positions[or+8]-Ji,Re=1,Et=Xr-wr,hn=Lr-ur,vn=Math.hypot(Et,hn);Cn.push({pos:[wr+.5*Et,ur+.5*hn,Ji],normal:[hn/vn,-Et/vn,0],width:vn,height:Oe,depth:Re,points:[wr,ur,Xr,Lr]})}const pn=this.entranceBloom.segmentsBucket.prepareSegment(10*Cn.length,this.entranceBloom.layoutVertexArray,this.entranceBloom.indexArray),On=this.entranceBloom.layoutVertexArray.length;Vt=this.entranceBloom.indexArray.length,Jj(Cn,.5/this.tileToMeter,this.entranceBloom.indexArray,this.entranceBloom.layoutVertexArray,this.entranceBloom.layoutAttenuationArray);const Jn=this.entranceBloom.layoutVertexArray.length-On;Yt=this.entranceBloom.indexArray.length-Vt;for(let or=0;or<Jn;or++)this.entranceBloom.layoutColorArray.emplaceBack(65535,65535);pn.vertexLength+=Jn,pn.primitiveLength+=Yt,ln={part:Xt.buildingPart,vertexOffset:On,vertexLength:Jn}}for(let Cn=0;Cn<Xt.positions.length;Cn+=3)At=Math.max(At,Xt.positions[Cn+2]),this.layoutVertexArray.emplaceBack(Xt.positions[Cn],Xt.positions[Cn+1],Xt.positions[Cn+2]);for(let Cn=0;Cn<Xt.normals.length;Cn+=3)this.layoutNormalArray.emplaceBack(Xt.normals[Cn+0]*$C,Xt.normals[Cn+1]*$C,Xt.normals[Cn+2]*$C);for(let Cn=0;Cn<Xt.ao.length;Cn++)this.layoutAOArray.push(Xt.ao[Cn]);for(let Cn=0;Cn<Xt.colors.length;Cn+=3){const pn=1+(Xt.ao[Cn/3]-1)*we;this.layoutColorArray.emplaceBack(Xt.colors[Cn]*pn<<8|Xt.colors[Cn+1]*pn,Xt.colors[Cn+2]*pn<<8)}const Nn=ut.vertexLength;for(let Cn=0;Cn<Xt.indices.length;Cn+=3)this.indexArray.emplaceBack(Nn+Xt.indices[Cn],Nn+Xt.indices[Cn+1],Nn+Xt.indices[Cn+2]);ut.vertexLength+=Xt.positions.length/3,ut.primitiveLength+=Xt.indices.length/3,(Xt.buildingPart==="roof"||Xt.buildingPart==="wall"||Xt.buildingPart==="facade_glazing"||Xt.buildingPart==="entrance")&&Dt.push({part:Xt.buildingPart,vertexOffset:an,vertexLength:Xt.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,At),this.buildingFeatures.push({feature:j,segment:ut,parts:Dt,buildingBloom:ln});const Kt=this.indexArray.length-on,pt=[],Ct=[],un=new kt(1/0,1/0),Qt=new kt(-1/0,-1/0),Un=this.groundEffect.vertexArray.length;for(const Xt of it.modifiedPolygonRings){const an=[],Nn=new kt(1/0,1/0),Cn=new kt(-1/0,-1/0);for(let pn=0;pn<Xt.length;pn+=2){const On=Xt.length-pn-2;Nn.x=Math.min(Nn.x,Xt[On]),Nn.y=Math.min(Nn.y,Xt[On+1]),Cn.x=Math.max(Cn.x,Xt[On]),Cn.y=Math.max(Cn.y,Xt[On+1]);const Jn=new kt(Xt[On],Xt[On+1]);an.push(Jn),pt.push(Jn.x,Jn.y),Ct.push(Jn.clone())}un.x=Math.min(un.x,Nn.x),un.y=Math.min(un.y,Nn.y),Qt.x=Math.max(Qt.x,Cn.x),Qt.y=Math.max(Qt.y,Cn.y),this.groundEffect.addData(an,[Nn,Cn],be)}const kn=this.groundEffect.vertexArray.length-Un;($e.x<0||Je.x>nn||$e.y<0||Je.y>nn)&&this.featuresOnBorder.push({featureId:O.id,footprintIndex:this.footprints.length});{const Xt=pm(pt,null,2),an=new qf(Ct,Xt,8,256);let Nn=O.id;O.properties&&O.properties.hasOwnProperty("building_id")&&(Nn=O.properties.building_id),this.footprints.push({vertices:Ct,indices:Xt,grid:an,min:un,max:Qt,buildingId:Nn,hiddenFlags:0,indicesOffset:on,indicesLength:Kt,bloomIndicesOffset:Vt,bloomIndicesLength:Yt,groundEffectVertexOffset:Un,groundEffectVertexLength:kn,segment:ut,height:At})}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,O,R,{},s.availableImages,h,s.brightness),this.groundEffect.addPaintPropertiesData(O,R,{},s.availableImages,h,s.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0])}update(r,s,h,p,_,x,E){this.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E),this.groundEffect.update(r,s,_,h,p,x,E)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Qj.members),this.layoutNormalBuffer=r.createVertexBuffer(this.layoutNormalArray,ite.members),this.entranceBloom.layoutVertexBuffer=r.createVertexBuffer(this.entranceBloom.layoutVertexArray,Qj.members),this.entranceBloom.layoutAttenuationBuffer=r.createVertexBuffer(this.entranceBloom.layoutAttenuationArray,ate.members),this.uploadUpdatedColorBuffer(r),this.uploadUpdatedIndexBuffer(r),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.layoutNormalBuffer.destroy(),this.layoutColorBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segmentsBucket.destroy(),this.entranceBloom.layoutVertexBuffer.destroy(),this.entranceBloom.layoutColorBuffer.destroy(),this.entranceBloom.layoutAttenuationBuffer.destroy(),this.entranceBloom.indexBuffer.destroy(),this.entranceBloom.segmentsBucket.destroy())}updateFootprintHiddenFlags(r,s,h=!0){let p=!1;const _=h?s:0,x=0|(h?-1:~s);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const E of r){const O=this.footprints[E],R=O.hiddenFlags&x|_;O.hiddenFlags!==R&&(O.hiddenFlags=R,p=!0,this.groundEffect.updateHiddenByLandmarkRange(O.groundEffectVertexOffset,O.groundEffectVertexLength,O.hiddenFlags!==0))}return p&&(this.indexArrayForConflationUploaded=!1),p}uploadUpdatedIndexBuffer(r){if(this.groundEffect.uploadHiddenByLandmark(r),!this.indexArrayForConflationUploaded&&this.indexArray.length!==0){this.indexArrayForConflation.resize(this.indexArray.length),this.indexArrayForConflation.uint16.set(this.indexArray.uint16),this.entranceBloom.indexArrayForConflation.resize(this.entranceBloom.indexArray.length),this.entranceBloom.indexArrayForConflation.uint16.set(this.entranceBloom.indexArray.uint16);for(const s of this.footprints){const h=s.indicesOffset+s.indicesLength;if(s.hiddenFlags!==0){for(let _=s.indicesOffset;_<h;_++)this.indexArrayForConflation.uint16[3*_+0]=0,this.indexArrayForConflation.uint16[3*_+1]=0,this.indexArrayForConflation.uint16[3*_+2]=0;const p=s.bloomIndicesOffset+s.bloomIndicesLength;for(let _=s.bloomIndicesOffset;_<p;_++)this.entranceBloom.indexArrayForConflation.uint16[3*_+0]=0,this.entranceBloom.indexArrayForConflation.uint16[3*_+1]=0,this.entranceBloom.indexArrayForConflation.uint16[3*_+2]=0}}this.indexBuffer?this.indexBuffer.updateData(this.indexArrayForConflation):this.indexBuffer=r.createIndexBuffer(this.indexArrayForConflation,!0),this.entranceBloom.indexBuffer?this.entranceBloom.indexBuffer.updateData(this.entranceBloom.indexArrayForConflation):this.entranceBloom.indexBuffer=r.createIndexBuffer(this.entranceBloom.indexArrayForConflation,!0),this.indexArrayForConflationUploaded=!0}}uploadUpdatedColorBuffer(r){this.layoutColorBuffer?this.layoutColorBuffer.updateData(this.layoutColorArray):this.layoutColorBuffer=r.createVertexBuffer(this.layoutColorArray,e3.members,!0),this.entranceBloom.layoutColorBuffer?this.entranceBloom.layoutColorBuffer.updateData(this.entranceBloom.layoutColorArray):this.entranceBloom.layoutColorBuffer=r.createVertexBuffer(this.entranceBloom.layoutColorArray,e3.members,!0)}evaluate(r){const s=r.paint.get("building-ambient-occlusion-intensity");for(const h of this.buildingFeatures){const p=h.feature;p.properties["building-part"]="roof";const _=r.paint.get("building-color").evaluate(p,{},this.canonical),x=r.paint.get("building-emissive-strength").evaluate(p,{},this.canonical);p.properties["building-part"]="wall";const E=r.paint.get("building-color").evaluate(p,{},this.canonical),O=r.paint.get("building-emissive-strength").evaluate(p,{},this.canonical);p.properties["building-part"]="window";const R=r.paint.get("building-color").evaluate(p,{},this.canonical),z=r.paint.get("building-emissive-strength").evaluate(p,{},this.canonical);p.properties["building-part"]="door";const j=r.paint.get("building-color").evaluate(p,{},this.canonical),B=r.paint.get("building-emissive-strength").evaluate(p,{},this.canonical);for(const Z of h.parts){let ae,se=_;Z.part==="roof"?(se=_,ae=x):Z.part==="wall"?(se=E,ae=O):Z.part==="facade_glazing"?(se=R,ae=z):Z.part==="entrance"&&(se=j,ae=B),ae=Pe(ae,0,1);for(let pe=0;pe<Z.vertexLength;pe++){const we=Z.vertexOffset+pe,be=1+(this.layoutAOArray[we]-1)*s;this.layoutColorArray.emplace(we,se.r*be*255<<8|se.g*be*255,se.b*be*255<<8|255*ae)}}const X=h.buildingBloom;if(X)for(let Z=0;Z<X.vertexLength;Z++)this.bloomGeometry.layoutColorArray.emplace(X.vertexOffset+Z,255*j.r<<8|255*j.g,255*j.b<<8|51*B)}}needsEvaluation(r,s){const h=r.transform.projectionOptions,p=r.style.getBrightness();return!(this.uploaded&&h.name===this.projection.name&&this.brightness===p||(this.projection=h,this.brightness=p,0))}updateReplacement(r,s,h){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const p=s.getReplacementRegionsForTile(r.toUnwrapped());if(Fv(this.activeReplacements,p))return;this.activeReplacements=p;for(const x of this.footprints)x.hiddenFlags&=-2;const _=[];for(const x of this.activeReplacements){if(x.order<=fb)continue;const E=Math.max(1,Math.pow(2,x.footprintTileId.canonical.z-r.canonical.z));for(const O of this.footprints)O.min.x>x.max.x||O.max.x<x.min.x||O.min.y>x.max.y||O.max.y<x.min.y||(_.length=0,ste(O.vertices,0,O.vertices.length,x.footprintTileId.canonical,r.canonical,_),Vg(x.footprint,_,O.indices,0,O.indices.length,0,-E)&&(O.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const x of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(x.groundEffectVertexOffset,x.groundEffectVertexLength,x.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(r,s){let h=Number.NEGATIVE_INFINITY,p=!0;const _=4*(r+nn)*nn+(s+nn);if(this.footprintLookup.hasOwnProperty(_)){const E=this.footprintLookup[_];return E?{height:E.height,hidden:E.hiddenFlags!==0}:void 0}const x=new kt(r,s);for(const E of this.footprints)r>E.max.x||E.min.x>r||s>E.max.y||E.min.y>s||E.height<=h||ym(x,E)&&(h=E.height,this.footprintLookup[_]=E,p=E.hiddenFlags!==0);if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:p};this.footprintLookup[_]=void 0}}function ste(l,r,s,h,p,_){const x=Math.pow(2,h.z-p.z);for(let E=0;E<s;E++){let O=l[E+r].x,R=l[E+r].y;O=(O+p.x*nn)*x-h.x*nn,R=(R+p.y*nn)*x-h.y*nn,_.push(new kt(O,R))}}let r3,i3;Rn(n3,"BuildingBucket",{omit:["layers"]});const lte=Ur([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),cte=Ur([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:ute}=lte,hte=Ur([{name:"a_packed",components:3,type:"Float32"}]),{members:dte}=hte,fte=Ur([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:pte}=fte;class a3{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.image=new Dd({width:r,height:s}),this.positions={},this.uploaded=!1}getDash(r,s){const h=this.getKey(r,s);return this.positions[h]}trim(){const r=this.width,s=this.height=Fn(this.nextRow);this.image.resize({width:r,height:s})}getKey(r,s){return r.join(",")+s}getDashRanges(r,s,h){const p=[];let _=r.length%2==1?-r[r.length-1]*h:0,x=r[0]*h,E=!0;p.push({left:_,right:x,isDash:E,zeroLength:r[0]===0});let O=r[0];for(let R=1;R<r.length;R++){E=!E;const z=r[R];_=O*h,O+=z,x=O*h,p.push({left:_,right:x,isDash:E,zeroLength:z===0})}return p}addRoundDash(r,s,h){const p=s/2;for(let _=-h;_<=h;_++){const x=this.width*(this.nextRow+h+_);let E=0,O=r[E];for(let R=0;R<this.width;R++){R/O.right>1&&(O=r[++E]);const z=Math.abs(R-O.left),j=Math.abs(R-O.right),B=Math.min(z,j);let X;const Z=_/h*(p+1);if(O.isDash){const ae=p-Math.abs(Z);X=Math.sqrt(B*B+ae*ae)}else X=p-Math.sqrt(B*B+Z*Z);this.image.data[x+R]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(r,s){for(let O=r.length-1;O>=0;--O){const R=r[O],z=r[O+1];R.zeroLength?r.splice(O,1):z&&z.isDash===R.isDash&&(z.left=R.left,r.splice(O,1))}const h=r[0],p=r[r.length-1];h.isDash===p.isDash&&(h.left=p.left-this.width,p.right=h.right+this.width);const _=this.width*this.nextRow;let x=0,E=r[x];for(let O=0;O<this.width;O++){O/E.right>1&&(E=r[++x]);const R=Math.abs(O-E.left),z=Math.abs(O-E.right),j=Math.min(R,z);this.image.data[_+O]=Math.max(0,Math.min(255,(E.isDash?j:-j)+s+128))}}addDash(r,s){const h=this.getKey(r,s);if(this.positions[h])return this.positions[h];const p=s==="round",_=p?7:0,x=2*_+1;if(this.nextRow+x>this.height)return jr("LineAtlas out of space"),null;r.length===0&&r.push(1);let E=0;for(let z=0;z<r.length;z++)r[z]<0&&(jr("Negative value is found in line dasharray, replacing values with 0"),r[z]=0),E+=r[z];if(E!==0){const z=this.width/E,j=this.getDashRanges(r,this.width,z);p?this.addRoundDash(j,z,_):this.addRegularDash(j,s==="square"?.5*z:0)}const O=this.nextRow+_;this.nextRow+=x;const R={tl:[O,_],br:[E,0]};return this.positions[h]=R,R}}Rn(a3,"LineAtlas");const mte=mt.types,gte=Math.cos(Math.PI/180*37.5),yte=Math.cos(Math.PI/180*5);class qC{constructor(r){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=r.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=r.overscaling,this.pixelRatio=r.pixelRatio,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.fqid)),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((s=>{this.gradients[s.id]={}})),this.layoutVertexArray=new Lh,this.layoutVertexArray2=new Is,this.patternVertexArray=new Is,this.indexArray=new Zr,this.programConfigurations=new Ks(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new Ki,this.maxLineLength=0,this.zOffsetVertexArray=new Is,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.tessellationStep=r.tessellationStep?r.tessellationStep:nn/64,this.worldview=r.worldview}updateFootprints(r,s){}populate(r,s,h,p){this.hasPattern=Nv("line",this.layers,this.pixelRatio,s);const _=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Ne(h);const x=this.layers[0].layout.get("line-elevation-reference");if(x==="hd-road-markup")this.elevationType="road";else{const B=this.layers[0].layout.get("line-z-offset"),X=B.isConstant()&&!B.constantOr(0);this.elevationType=x!=="sea"&&x!=="ground"&&X?"none":"offset",this.elevationType==="offset"&&x==="none"&&jr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const E=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&E!==void 0;const O=[];for(const{feature:B,id:X,index:Z,sourceLayerIndex:ae}of r){const se=this.layers[0]._featureFilter.needGeometry,pe=Tt(B,se);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom,{worldview:this.worldview}),pe,h))continue;const we=_?_.evaluate(pe,{},h):void 0,be={id:X,properties:B.properties,type:B.type,sourceLayerIndex:ae,index:Z,geometry:se?pe.geometry:We(B,h,p),patterns:{},sortKey:we};O.push(be)}_&&O.sort(((B,X)=>B.sortKey-X.sortKey));const{lineAtlas:R,featureIndex:z}=s,j=this.addConstantDashes(R);for(const B of O){const{geometry:X,index:Z,sourceLayerIndex:ae}=B;if(j&&this.addFeatureDashes(B,R),this.hasPattern){const se=zv("line",this.layers,B,this.zoom,this.pixelRatio,s);this.patternFeatures.push(se)}else this.addFeature(B,X,Z,h,R.positions,s.availableImages,s.brightness,s.elevationFeatures);z.insert(r[Z].feature,X,Z,ae,this.index)}}addConstantDashes(r){let s=!1;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(p.kind!=="constant"||_.kind!=="constant")s=!0;else{const x=_.value,E=p.value;if(!E)continue;r.addDash(E,x)}}return s}addFeatureDashes(r,s){const h=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,x=p.layout.get("line-cap").value;if(_.kind==="constant"&&x.kind==="constant")continue;let E,O;if(_.kind==="constant"){if(E=_.value,!E)continue}else E=_.evaluate({zoom:h},r);O=x.kind==="constant"?x.value:x.evaluate({zoom:h},r),s.addDash(E,O),r.patterns[p.id]=[s.getKey(E,O)]}}update(r,s,h,p,_,x,E,O){this.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E,O)}addFeatures(r,s,h,p,_,x){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,s,h,p,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,dte)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=r.createVertexBuffer(this.patternVertexArray,pte)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,cte.members,!0)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ute),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,h,p,_,x,E,O){const R=this.layers[0].layout,z=R.get("line-join").evaluate(r,{}),j=R.get("line-cap").evaluate(r,{}),B=R.get("line-miter-limit"),X=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(r),this.lineFeature=r,this.zOffsetValue=R.get("line-z-offset").value;const Z=this.layers[0].paint.get("line-width").value;if(Z.kind!=="constant"&&Z.isLineProgressConstant===!1&&(this.variableWidthValue=Z),this.elevationType==="road"){const ae=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(r,s,p,O,z,j,B,X)){const[se,pe]=this.clipRuntimeLinesToTile(s,1);for(let we=0;we<se.length;we++){const be=se[we],Ee=pe[we],Ge={progress:{min:Ee.progress.min,max:Ee.progress.max},nextDir:this.computeSegNextDir(Ee,be),prevDir:this.computeSegPrevDir(Ee,be)};this.addLine(be,r,p,z,j,B,X,Ge)}this.fillNonElevatedRoadSegment(ae)}}else for(const ae of s)this.addLine(ae,r,p,z,j,B,X);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,_,x,p,E,void 0,this.worldview)}computeSegNextDir(r,s){return r.nextPoint.sub(s.at(-2)).unit()}computeSegPrevDir(r,s){return s[1].sub(r.prevPoint).unit()}clipLinesToTile(r,s){return Xv(r,-s,-s,nn+s,nn+s)}clipRuntimeLinesToTile(r,s){const h=[];return[Xv(r,-s,-s,nn+s,nn+s,h),h]}addElevatedRoadFeature(r,s,h,p,_,x,E,O){const R=[],z=Li.getElevationFeature(r,p);if(z){const j=this.clipLinesToTile(s,1),B=this.prepareElevatedLines(j,z,h);for(const X of B)R.push({geometry:X,elevation:z,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(R.length===0)return!1;for(const j of R){const B=this.layoutVertexArray.length;this.addLine(j.geometry,r,h,_,x,E,O);const X=new qr(h,j.elevationTileID);if(j.elevation)for(let Z=B;Z<this.layoutVertexArray.length;Z++){const ae=new kt(this.layoutVertexArray.int16[6*Z]>>1,this.layoutVertexArray.int16[6*Z+1]>>1),se=X.pointElevation(ae,j.elevation,.05);this.updateHeightRange(se),this.zOffsetVertexArray.emplaceBack(se,0,0)}else this.fillNonElevatedRoadSegment(B)}return!0}prepareElevatedLines(r,s,h){if(s.constantHeight!=null)return r;const p=[],_=1/Ne(h);for(const x of r)Zv(x,new oi(s,_),0,p);return p}fillNonElevatedRoadSegment(r){for(let s=r;s<this.layoutVertexArray.length;s++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(r){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,r),this.heightRange.max=Math.max(this.heightRange.max,r)):this.heightRange={min:r,max:r}}addLine(r,s,h,p,_,x,E,O){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const R=p==="none";this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const z=O&&O.progress.min>0,j=O&&O.progress.max<1;if(this.lineClips){let Je={min:this.lineClips.start,max:this.lineClips.end},it=1;if(O){const Dt=this.lineClips.end-this.lineClips.start;Je=(function(ln,Vt,Yt){return{min:td(ln.min,Vt,Yt),max:td(ln.max,Vt,Yt)}})(O.progress,{min:0,max:1},Je),Dt>0&&(it=(Je.max-Je.min)/Dt)}const Mt=+s.properties.mapbox_clip_feature_len,ut=+s.properties.mapbox_clip_seg_len;if(Number.isNaN(Mt)||Number.isNaN(ut)){for(let ln=0;ln<r.length-1;ln++)this.totalDistance+=r[ln].dist(r[ln+1]);const Dt=this.totalDistance/(Je.max-Je.min);this.totalFeatureLength=Number.isFinite(Dt)?Dt:0,this.lineClips.start=Je.min,this.lineClips.end=Je.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Mt,this.distance=ut*it,this.lineClips.start=Je.min,this.lineClips.end=Je.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const B=mte[s.type]==="Polygon";let X=r.length;for(;X>=2&&r[X-1].equals(r[X-2]);)X--;let Z=0;for(;Z<X-1&&r[Z].equals(r[Z+1]);)Z++;if(X<(B?3:2))return;p==="bevel"&&(x=1.05);const ae=this.segments.prepareSegment(10*X,this.layoutVertexArray,this.indexArray);let se,pe,we,be,Ee,Ge,Ue,$e;O&&O.prevDir&&(Ge=O.prevDir.perp()),O&&O.nextDir&&(Ue=O.nextDir.perp()),this.e1=this.e2=-1,B&&(se=r[X-2],Ee=r[Z].sub(se)._unit()._perp());for(let Je=Z;Je<X;Je++){if(we=Je===X-1?B?r[Z+1]:void 0:r[Je+1],we&&r[Je].equals(we))continue;Ee&&(be=Ee),se&&(pe=se),se=r[Je],$e=this.evaluateLineProgressFeatures(pe?pe.dist(se):0),Ee=we?we.sub(se)._unit()._perp():be,be=be||Ee;const it=pe&&we;let Mt=it?p:B||R?"butt":_;const ut=be.x*Ee.x+be.y*Ee.y;if(R){const pt=function(Ct){if(Ct.patternJoinNone){const un=Ct.segmentPoints.length/2,Qt=Ct.lineSoFar-Ct.segmentStart;for(let Un=0;Un<un;++Un){const kn=Ct.segmentPoints[2*Un+1],Xt=Math.round(Ct.segmentPoints[2*Un])+.5+.25*kn;Ct.patternVertexArray.emplaceBack(Xt,Qt,Ct.segmentStart),Ct.patternVertexArray.emplaceBack(Xt,Qt,Ct.segmentStart)}Ct.segmentPoints.length=0}Ct.e1=Ct.e2=-1};if(it&&ut<yte){this.updateDistance(pe,se),this.addCurrentVertex(se,be,1,1,ae,$e),pt(this),this.addCurrentVertex(se,Ee,-1,-1,ae,$e);continue}if(pe){if(!we){this.updateDistance(pe,se),this.addCurrentVertex(se,be,1,1,ae,$e),pt(this);continue}Mt="miter"}}let Dt=be.add(Ee);Dt.x===0&&Dt.y===0||Dt._unit();const ln=Dt.x*Ee.x+Dt.y*Ee.y,Vt=ln!==0?1/ln:1/0,Yt=2*Math.sqrt(2-2*ln),on=ln<gte&&pe&&we,At=be.x*Ee.y-be.y*Ee.x>0,Kt=this.overscaling<=16?15*nn/(512*this.overscaling):0;if(it&&Mt==="round"){if(Vt<E)Mt="miter";else if(Vt<=2){const pt=HC(se,-10,nn+10);Mt=this.elevationType==="offset"&&(pt||this.hasCrossSlope)?"miter":"fakeround"}}if(Mt==="miter"&&Vt>x&&(Mt="bevel"),Mt==="bevel"&&(Vt>2&&(Mt="flipbevel"),Vt<x&&(Mt="miter")),pe&&!(Mt==="miter"&&on)&&this.updateDistance(pe,se),Mt==="miter")if(on){const pt=se.dist(pe);if(pt>2*Kt){const un=se.sub(se.sub(pe)._mult(Kt/pt)._round());this.updateDistance(pe,un),this.addCurrentVertex(un,be,0,0,ae,$e),pe=un}this.updateDistance(pe,se),Dt._mult(Vt),this.addCurrentVertex(se,Dt,0,0,ae,$e);const Ct=se.dist(we);if(Ct>2*Kt){const un=se.add(we.sub(se)._mult(Kt/Ct)._round());this.updateDistance(se,un),this.addCurrentVertex(un,Ee,0,0,ae,$e),se=un}}else Dt._mult(Vt),this.addCurrentVertex(se,Dt,0,0,ae,$e);else if(Mt==="flipbevel"){if(Vt>100)Dt=Ee.mult(-1);else{const pt=Vt*be.add(Ee).mag()/be.sub(Ee).mag();Dt._perp()._mult(pt*(At?-1:1))}this.addCurrentVertex(se,Dt,0,0,ae,$e),this.addCurrentVertex(se,Dt.mult(-1),0,0,ae,$e)}else if(Mt==="bevel"||Mt==="fakeround"){$e!=null&&pe&&this.addCurrentVertex(se,Ue||be,-1,-1,ae,$e);const pt=se.dist(pe)<=2*Kt&&Mt!=="bevel",Ct=Dt.mult(At?1:-1);Ct._mult(Vt);const un=Ee.mult(At?-1:1),Qt=be.mult(At?-1:1),Un=this.evaluateLineProgressFeatures(this.distance);if($e==null&&(this.addHalfVertex(se,Ct.x,Ct.y,!1,!At,0,ae,Un),pt||this.addHalfVertex(se,Ct.x+2*Qt.x,Ct.y+2*Qt.y,!1,At,0,ae,Un)),Mt==="fakeround"){const kn=Math.round(180*Yt/Math.PI/20);this.addHalfVertex(se,Qt.x,Qt.y,!1,At,0,ae,Un);for(let Xt=0;Xt<kn;Xt++){let an=Xt/kn;if(an!==.5){const Cn=an-.5;an+=an*Cn*(an-1)*((1.0904+ut*(ut*(3.55645-1.43519*ut)-3.2452))*Cn*Cn+(.848013+ut*(.215638*ut-1.06021)))}const Nn=un.sub(Qt)._mult(an)._add(Qt)._unit();this.addHalfVertex(se,Nn.x,Nn.y,!1,At,0,ae,Un)}this.addHalfVertex(se,un.x,un.y,!1,At,0,ae,Un)}pt||$e!=null||this.addHalfVertex(se,Ct.x+2*un.x,Ct.y+2*un.y,!1,At,0,ae,Un),$e!=null&&we&&this.addCurrentVertex(se,Ge||Ee,1,1,ae,$e)}else if(Mt==="butt")this.addCurrentVertex(se,Dt,0,0,ae,$e);else if(Mt==="square"){if(!pe){const pt=z?0:-1;this.addCurrentVertex(se,Dt,pt,pt,ae,$e)}if(this.addCurrentVertex(se,Dt,0,0,ae,$e),pe){const pt=j?0:1;this.addCurrentVertex(se,Dt,pt,pt,ae,$e)}}else if(Mt==="round"){if(pe){const pt=!it&&Ue?Ue:be;this.addCurrentVertex(se,pt,0,0,ae,$e),!it&&j||this.addCurrentVertex(se,pt,1,1,ae,$e,!0)}if(we){const pt=!it&&Ge?Ge:Ee;!it&&z||this.addCurrentVertex(se,pt,-1,-1,ae,$e,!0),this.addCurrentVertex(se,pt,0,0,ae,$e)}}}}addVerticesTo(r,s,h,p,_,x,E,O,R,z){const j=(s.w-r.w)/this.tessellationStep|0;let B=0;const X=this.scaledDistance;if(j>1){this.lineSoFar=r.w;const ae=(s.x-r.x)/j,se=(s.y-r.y)/j,pe=(s.z-r.z)/j,we=(s.w-r.w)/j;for(let be=1;be<j;++be){r.x+=ae,r.y+=se,r.z+=pe,this.lineSoFar+=we,B+=we;const Ee=this.evaluateLineProgressFeatures(this.prevDistance+B);this.scaledDistance=(this.prevDistance+B)/this.totalDistance,this.addHalfVertex(r,h,p,z,!1,E,R,Ee),this.addHalfVertex(r,_,x,z,!0,-O,R,Ee)}}this.lineSoFar=s.w,this.scaledDistance=X;const Z=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,h,p,z,!1,E,R,Z),this.addHalfVertex(s,_,x,z,!0,-O,R,Z)}evaluateLineProgressFeatures(r){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+r)/this.totalFeatureLength):jr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:s}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}}addCurrentVertex(r,s,h,p,_,x,E=!1){const O=s.x+s.y*h,R=s.y-s.x*h,z=s.y*p-s.x,j=-s.y-s.x*p;if(x!=null){const B=this.elevationType==="offset",X=-10,Z=nn+10,ae=x.zOffset,se=new Wv(r.x,r.y,ae,this.lineSoFar),pe=!!B&&HC(r,X,Z),we=this.lineSoFar,be=this.distance;if(this.currentVertex)if(pe){const Ee=this.currentVertexIsOutside,Ge=this.currentVertex,Ue=new Wv(r.x,r.y,ae,this.lineSoFar);if(Sb(Ge,Ue,X,Z),!HC(Ue,X,Z)){if(Ee){this.e1=this.e2=-1,this.distance-=Ge.dist(se),this.lineSoFar=Ge.w;const $e=this.evaluateLineProgressFeatures(Ge.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ge,O,R,E,!1,h,_,$e),this.addHalfVertex(Ge,z,j,E,!0,-p,_,$e),this.prevDistance=this.distance}this.distance=this.prevDistance+Ge.dist(Ue),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ge,Ue,O,R,z,j,h,p,_,E),this.distance=be,this.scaledDistance=this.distance/this.totalDistance}}else{const Ee=this.currentVertex;if(this.currentVertexIsOutside){Sb(Ee,se,X,Z),this.e1=this.e2=-1,this.distance-=Ee.dist(se),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Ee.w;const Ge=this.evaluateLineProgressFeatures(Ee.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ee,O,R,E,!1,h,_,Ge),this.addHalfVertex(Ee,z,j,E,!0,-p,_,Ge),this.prevDistance=this.distance,this.distance=be,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Ee,se,O,R,z,j,h,p,_,E)}else pe||(this.addHalfVertex(r,O,R,E,!1,h,_,x),this.addHalfVertex(r,z,j,E,!0,-p,_,x));this.currentVertex=se,this.currentVertexIsOutside=pe,this.lineSoFar=we}else this.addHalfVertex(r,O,R,E,!1,h,_,x),this.addHalfVertex(r,z,j,E,!0,-p,_,x)}addHalfVertex({x:r,y:s},h,p,_,x,E,O,R){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),x||this.segmentPoints.push(this.lineSoFar-this.segmentStart,E)),this.layoutVertexArray.emplaceBack((r<<1)+(_?1:0),(s<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*p)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const j=Gn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,j)}const z=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),O.primitiveLength++),x?this.e2=z:this.e1=z,R!=null&&this.zOffsetVertexArray.emplaceBack(R.zOffset,R.variableWidth,R.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(r,s){this.prevDistance=this.distance,this.distance+=r.dist(s),this.updateScaledDistance()}}function HC(l,r,s){return l.x<r||l.x>s||l.y<r||l.y>s}let o3,s3;function l3(l,r,s){return r*(nn/(l.tileSize*Math.pow(2,s-l.tileID.overscaledZ)))}Rn(qC,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const c3=(l,r,s)=>(1-s)*l+s*r;function u3(l,r){return 1/l3(l,1,r.tileZoom)}function h3(l,r,s,h){return l.translatePosMatrix(h||r.tileID.projMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const d3=l=>{const r=[];f3(l)&&r.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT");const s=l.paint.get("line-trim-offset");s[0]===0&&s[1]===0||r.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&r.push("RENDER_LINE_BORDER");const h=l.layout.get("line-join").constantOr("miter")==="none",p=!!l.paint.get("line-pattern").constantOr(1);return h&&p&&r.push("LINE_JOIN_NONE"),r};function f3(l){const r=l.paint.get("line-dasharray").value;return r.value||r.kind!=="constant"}let GC;const p3=()=>GC||(GC={layout:o3||(o3=new la({"line-cap":new wn(st.layout_line["line-cap"]),"line-join":new wn(st.layout_line["line-join"]),"line-miter-limit":new Jt(st.layout_line["line-miter-limit"]),"line-round-limit":new Jt(st.layout_line["line-round-limit"]),"line-sort-key":new wn(st.layout_line["line-sort-key"]),"line-z-offset":new wn(st.layout_line["line-z-offset"]),"line-elevation-reference":new Jt(st.layout_line["line-elevation-reference"]),"line-cross-slope":new Jt(st.layout_line["line-cross-slope"]),visibility:new Jt(st.layout_line.visibility),"line-width-unit":new Jt(st.layout_line["line-width-unit"])})),paint:s3||(s3=new la({"line-opacity":new wn(st.paint_line["line-opacity"]),"line-color":new wn(st.paint_line["line-color"]),"line-translate":new Jt(st.paint_line["line-translate"]),"line-translate-anchor":new Jt(st.paint_line["line-translate-anchor"]),"line-width":new wn(st.paint_line["line-width"]),"line-gap-width":new wn(st.paint_line["line-gap-width"]),"line-offset":new wn(st.paint_line["line-offset"]),"line-blur":new wn(st.paint_line["line-blur"]),"line-dasharray":new wn(st.paint_line["line-dasharray"]),"line-pattern":new wn(st.paint_line["line-pattern"]),"line-pattern-cross-fade":new Jt(st.paint_line["line-pattern-cross-fade"]),"line-gradient":new wd(st.paint_line["line-gradient"]),"line-trim-offset":new Jt(st.paint_line["line-trim-offset"]),"line-trim-fade-range":new Jt(st.paint_line["line-trim-fade-range"]),"line-trim-color":new Jt(st.paint_line["line-trim-color"]),"line-emissive-strength":new Jt(st.paint_line["line-emissive-strength"]),"line-border-width":new wn(st.paint_line["line-border-width"]),"line-border-color":new wn(st.paint_line["line-border-color"]),"line-occlusion-opacity":new Jt(st.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},GC);class _te extends wn{possiblyEvaluate(r,s){return s=new Ei(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition,worldview:s.worldview}),super.possiblyEvaluate(r,s)}evaluate(r,s,h,p){return s=yt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,h,p)}}let Cb;function m3(l,r){return r>0?r+2*l:l}const vte=Ur([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),xte=Ur([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),bte=Ur([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ur([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const wte=Ur([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Ste=Ur([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),Tte=Ur([{name:"a_texb",components:2,type:"Uint16"}]),Ete=Ur([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Ate=Ur([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Ur([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const g3=Ur([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Cte=Ur([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ur([{name:"triangle",components:3,type:"Uint16"}]),Ur([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ur([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Ur([{type:"Float32",name:"offsetX"}]),Ur([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ds=24;function Mte(l,r,s){return l.sections.forEach((h=>{h.text=(function(p,_,x){const E=_.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?p=p.toLocaleUpperCase():E==="lowercase"&&(p=p.toLocaleLowerCase()),Sc.applyArabicShaping&&(p=Sc.applyArabicShaping(p)),p})(h.text,r,s)})),l}const Mb={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Pte(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function Ote(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}const WC=4294967296,y3=1/WC,_3=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let KS=class{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,r,s=this.length){for(;this.pos<s;){const h=this.readVarint(),p=h>>3,_=this.pos;this.type=7&h,l(p,r,this),this.pos===_&&this.skip(h)}return r}readMessage(l,r){return this.readFields(l,r,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*WC;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*WC;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const r=this.buf;let s,h;return h=r[this.pos++],s=127&h,h<128?s:(h=r[this.pos++],s|=(127&h)<<7,h<128?s:(h=r[this.pos++],s|=(127&h)<<14,h<128?s:(h=r[this.pos++],s|=(127&h)<<21,h<128?s:(h=r[this.pos],s|=(15&h)<<28,(function(p,_,x){const E=x.buf;let O,R;if(R=E[x.pos++],O=(112&R)>>4,R<128||(R=E[x.pos++],O|=(127&R)<<3,R<128)||(R=E[x.pos++],O|=(127&R)<<10,R<128)||(R=E[x.pos++],O|=(127&R)<<17,R<128)||(R=E[x.pos++],O|=(127&R)<<24,R<128)||(R=E[x.pos++],O|=(1&R)<<31,R<128))return Kv(p,O,_);throw new Error("Expected varint not more than 10 bytes")})(s,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,r=this.pos;return this.pos=l,l-r>=12&&_3?_3.decode(this.buf.subarray(r,l)):(function(s,h,p){let _="",x=h;for(;x<p;){const E=s[x];let O,R,z,j=null,B=E>239?4:E>223?3:E>191?2:1;if(x+B>p)break;B===1?E<128&&(j=E):B===2?(O=s[x+1],(192&O)==128&&(j=(31&E)<<6|63&O,j<=127&&(j=null))):B===3?(O=s[x+1],R=s[x+2],(192&O)==128&&(192&R)==128&&(j=(15&E)<<12|(63&O)<<6|63&R,(j<=2047||j>=55296&&j<=57343)&&(j=null))):B===4&&(O=s[x+1],R=s[x+2],z=s[x+3],(192&O)==128&&(192&R)==128&&(192&z)==128&&(j=(15&E)<<18|(63&O)<<12|(63&R)<<6|63&z,(j<=65535||j>=1114112)&&(j=null))),j===null?(j=65533,B=1):j>65535&&(j-=65536,_+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),_+=String.fromCharCode(j),x+=B}return _})(this.buf,r,l)}readBytes(){const l=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,l);return this.pos=l,r}readPackedVarint(l=[],r){const s=this.readPackedEnd();for(;this.pos<s;)l.push(this.readVarint(r));return l}readPackedSVarint(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const r=this.readPackedEnd();for(;this.pos<r;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const r=7&l;if(r===0)for(;this.buf[this.pos++]>127;);else if(r===2)this.pos=this.readVarint()+this.pos;else if(r===5)this.pos+=4;else{if(r!==1)throw new Error(`Unimplemented type: ${r}`);this.pos+=8}}writeTag(l,r){this.writeVarint(l<<3|r)}realloc(l){let r=this.length||16;for(;r<this.pos+l;)r*=2;if(r!==this.length){const s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.dataView=new DataView(s.buffer),this.length=r}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*y3),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*y3),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?(function(r,s){let h,p;if(r>=0?(h=r%4294967296|0,p=r/4294967296|0):(h=~(-r%4294967296),p=~(-r/4294967296),4294967295^h?h=h+1|0:(h=0,p=p+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(_,x,E){E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,E.buf[E.pos]=127&(_>>>=7)})(h,0,s),(function(_,x){const E=(7&_)<<4;x.buf[x.pos++]|=E|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))})(p,s)})(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const r=this.pos;this.pos=(function(h,p,_){for(let x,E,O=0;O<p.length;O++){if(x=p.charCodeAt(O),x>55295&&x<57344){if(!E){x>56319||O+1===p.length?(h[_++]=239,h[_++]=191,h[_++]=189):E=x;continue}if(x<56320){h[_++]=239,h[_++]=191,h[_++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(h[_++]=239,h[_++]=191,h[_++]=189,E=null);x<128?h[_++]=x:(x<2048?h[_++]=x>>6|192:(x<65536?h[_++]=x>>12|224:(h[_++]=x>>18|240,h[_++]=x>>12&63|128),h[_++]=x>>6&63|128),h[_++]=63&x|128)}return _})(this.buf,l,this.pos);const s=this.pos-r;s>=128&&v3(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const r=l.length;this.writeVarint(r),this.realloc(r);for(let s=0;s<r;s++)this.buf[this.pos++]=l[s]}writeRawMessage(l,r){this.pos++;const s=this.pos;l(r,this);const h=this.pos-s;h>=128&&v3(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h}writeMessage(l,r,s){this.writeTag(l,2),this.writeRawMessage(r,s)}writePackedVarint(l,r){r.length&&this.writeMessage(l,Rte,r)}writePackedSVarint(l,r){r.length&&this.writeMessage(l,Ite,r)}writePackedBoolean(l,r){r.length&&this.writeMessage(l,Lte,r)}writePackedFloat(l,r){r.length&&this.writeMessage(l,Dte,r)}writePackedDouble(l,r){r.length&&this.writeMessage(l,kte,r)}writePackedFixed32(l,r){r.length&&this.writeMessage(l,Nte,r)}writePackedSFixed32(l,r){r.length&&this.writeMessage(l,zte,r)}writePackedFixed64(l,r){r.length&&this.writeMessage(l,jte,r)}writePackedSFixed64(l,r){r.length&&this.writeMessage(l,Bte,r)}writeBytesField(l,r){this.writeTag(l,2),this.writeBytes(r)}writeFixed32Field(l,r){this.writeTag(l,5),this.writeFixed32(r)}writeSFixed32Field(l,r){this.writeTag(l,5),this.writeSFixed32(r)}writeFixed64Field(l,r){this.writeTag(l,1),this.writeFixed64(r)}writeSFixed64Field(l,r){this.writeTag(l,1),this.writeSFixed64(r)}writeVarintField(l,r){this.writeTag(l,0),this.writeVarint(r)}writeSVarintField(l,r){this.writeTag(l,0),this.writeSVarint(r)}writeStringField(l,r){this.writeTag(l,2),this.writeString(r)}writeFloatField(l,r){this.writeTag(l,5),this.writeFloat(r)}writeDoubleField(l,r){this.writeTag(l,1),this.writeDouble(r)}writeBooleanField(l,r){this.writeVarintField(l,+r)}};function Kv(l,r,s){return s?4294967296*r+(l>>>0):4294967296*(r>>>0)+(l>>>0)}function v3(l,r,s){const h=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(h);for(let p=s.pos-1;p>=l;p--)s.buf[p+h]=s.buf[p]}function Rte(l,r){for(let s=0;s<l.length;s++)r.writeVarint(l[s])}function Ite(l,r){for(let s=0;s<l.length;s++)r.writeSVarint(l[s])}function Dte(l,r){for(let s=0;s<l.length;s++)r.writeFloat(l[s])}function kte(l,r){for(let s=0;s<l.length;s++)r.writeDouble(l[s])}function Lte(l,r){for(let s=0;s<l.length;s++)r.writeBoolean(l[s])}function Nte(l,r){for(let s=0;s<l.length;s++)r.writeFixed32(l[s])}function zte(l,r){for(let s=0;s<l.length;s++)r.writeSFixed32(l[s])}function jte(l,r){for(let s=0;s<l.length;s++)r.writeFixed64(l[s])}function Bte(l,r){for(let s=0;s<l.length;s++)r.writeSFixed64(l[s])}const XC=3;function Fte(l,r,s){r.glyphs=[],l===1&&s.readMessage(Vte,r)}function Vte(l,r,s){if(l===3){const{id:h,bitmap:p,width:_,height:x,left:E,top:O,advance:R}=s.readMessage(Ute,{});r.glyphs.push({id:h,bitmap:new Dd({width:_+2*XC,height:x+2*XC},p),metrics:{width:_,height:x,left:E,top:O,advance:R}})}else l===4?r.ascender=s.readSVarint():l===5&&(r.descender=s.readSVarint())}function Ute(l,r,s){l===1?r.id=s.readVarint():l===2?r.bitmap=s.readBytes():l===3?r.width=s.readVarint():l===4?r.height=s.readVarint():l===5?r.left=s.readSVarint():l===6?r.top=s.readSVarint():l===7&&(r.advance=s.readVarint())}const x3=XC,Pc={horizontal:1,vertical:2,horizontalOnly:3};class Pb{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(r,s){const h=new Pb;return h.scale=r||1,h.fontStack=s,h}static forImage(r){const s=new Pb;return s.image=r,s}}class Jv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s,h){const p=new Jv;for(let _=0;_<r.sections.length;_++){const x=r.sections[_];x.image?p.addImageSection(x,h):p.addTextSection(x,s)}return p}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCodePoint(r){return this.text.codePointAt(r)}verticalizePunctuation(r){this.text=(function(s,h){let p="";for(let _=0;_<s.length;_++){const x=s.charCodeAt(_+1)||null,E=s.charCodeAt(_-1)||null;p+=!h&&(x&&Jl(x)&&!Mb[s[_+1]]||E&&Jl(E)&&!Mb[s[_-1]])||!Mb[s[_]]?s[_]:Mb[s[_]]}return p})(this.text,r)}trim(){let r=0;for(let h=0;h<this.text.length&&JS[this.text.charCodeAt(h)];h++)r++;let s=this.text.length;for(let h=this.text.length-1;h>=0&&h>=r&&JS[this.text.charCodeAt(h)];h--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const h=new Jv;return h.text=this.text.substring(r,s),h.sectionIndex=this.sectionIndex.slice(r,s),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((r,s)=>Math.max(r,this.sections[s].scale)),0)}addTextSection(r,s){this.text+=r.text,this.sections.push(Pb.forText(r.scale,r.fontStack||s));const h=this.sections.length-1;for(let p=0;p<r.text.length;++p)this.sectionIndex.push(h)}addImageSection(r,s){const h=r.image?r.image.getPrimary():null;if(!h)return void jr("Can't add FormattedSection with an empty image.");h.scaleSelf(s);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(Pb.forImage(h)),this.sectionIndex.push(this.sections.length-1)):jr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ZC(l,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae=1){const se=Jv.fromFeature(l,p,ae);j===Pc.vertical&&se.verticalizePunctuation(B);let pe=[];const we=(function($e,Je,it,Mt,ut,Dt){if(!$e)return[];const ln=[],Vt=(function(Kt,pt,Ct,un,Qt,Un){let kn=0;for(let Xt=0;Xt<Kt.length();Xt++){const an=Kt.getSection(Xt);kn+=b3(Kt.getCodePoint(Xt),an,un,Qt,pt,Un)}return kn/Math.max(1,Math.ceil(kn/Ct))})($e,Je,it,Mt,ut,Dt),Yt=$e.text.indexOf("")>=0;let on=0;for(let Kt=0;Kt<$e.length();Kt++){const pt=$e.getSection(Kt),Ct=$e.getCodePoint(Kt);if(JS[Ct]||(on+=b3(Ct,pt,Mt,ut,Je,Dt)),Kt<$e.length()-1){const un=!((At=Ct)<11904||!(jn["Bopomofo Extended"](At)||jn.Bopomofo(At)||jn["CJK Compatibility Forms"](At)||jn["CJK Compatibility Ideographs"](At)||jn["CJK Compatibility"](At)||jn["CJK Radicals Supplement"](At)||jn["CJK Strokes"](At)||jn["CJK Symbols and Punctuation"](At)||jn["CJK Unified Ideographs Extension A"](At)||jn["CJK Unified Ideographs"](At)||jn["Enclosed CJK Letters and Months"](At)||jn["Halfwidth and Fullwidth Forms"](At)||jn.Hiragana(At)||jn["Ideographic Description Characters"](At)||jn["Kangxi Radicals"](At)||jn["Katakana Phonetic Extensions"](At)||jn.Katakana(At)||jn["Vertical Forms"](At)||jn["Yi Radicals"](At)||jn["Yi Syllables"](At)));($te[Ct]||un||pt.image)&&ln.push(S3(Kt+1,on,Vt,ln,qte(Ct,$e.getCodePoint(Kt+1),un&&Yt),!1))}}var At;return T3(S3($e.length(),on,Vt,ln,0,!0))})(se,R,_,r,h,X),{processBidirectionalText:be,processStyledBidirectionalText:Ee}=Sc;if(be&&se.sections.length===1){const $e=be(se.toString(),we);for(const Je of $e){const it=new Jv;it.text=Je,it.sections=se.sections;for(let Mt=0;Mt<Je.length;Mt++)it.sectionIndex.push(0);pe.push(it)}}else if(Ee){const $e=Ee(se.text,se.sectionIndex,we);for(const Je of $e){const it=new Jv;it.text=Je[0],it.sectionIndex=Je[1],it.sections=se.sections,pe.push(it)}}else pe=(function($e,Je){const it=[],Mt=$e.text;let ut=0;for(const Dt of Je)it.push($e.substring(ut,Dt)),ut=Dt;return ut<Mt.length&&it.push($e.substring(ut,Mt.length)),it})(se,we);const Ge=[],Ue={positionedLines:Ge,text:se.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:j,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if((function($e,Je,it,Mt,ut,Dt,ln,Vt,Yt,on,At,Kt){let pt=0,Ct=0,un=0;const Qt=Vt==="right"?1:Vt==="left"?0:.5;let Un=!1;for(const pn of ut){const On=pn.getSections();for(const Jn of On){if(Jn.image)continue;const or=Je[Jn.fontStack];if(or&&(Un=or.ascender!==void 0&&or.descender!==void 0,!Un))break}if(!Un)break}let kn=0;for(const pn of ut){pn.trim();const On=pn.getMaxScale(),Jn=(On-1)*ds,or={positionedGlyphs:[],lineOffset:0};$e.positionedLines[kn]=or;const wr=or.positionedGlyphs;let ur=0;if(!pn.length()){Ct+=Dt,++kn;continue}let Xr=0,Lr=0;for(let Oe=0;Oe<pn.length();Oe++){const Re=pn.getSection(Oe),Et=pn.getSectionIndex(Oe),hn=pn.getCodePoint(Oe);let vn=Re.scale,_n=null,Ln=null,ar=null,Hr=ds,Gr=0,Pr=Yt;Pr===Pc.vertical&&((Xt=hn)===12312||Xt===12313||Xt===12316||Xt===12540||Xt===12448)&&(Pr=Pc.horizontal);const Ni=!(Pr===Pc.horizontal||!At&&!Ef(hn)||At&&(JS[hn]||Wp(hn)));if(Re.image){const Aa=Mt.get(Re.image.toString());if(!Aa)continue;ar=Re.image,$e.iconsInText=$e.iconsInText||!0,Ln=Aa.paddedRect;const Er=Aa.displaySize;vn=vn*ds/Kt,_n={width:Er[0],height:Er[1],left:0,top:-x3,advance:Ni?Er[1]:Er[0],localGlyph:!1},Gr=Un?-_n.height*vn:On*ds-17-Er[1]*vn,Hr=_n.advance;const ia=(Ni?Er[0]:Er[1])*vn-ds*On;ia>0&&ia>ur&&(ur=ia)}else{const Aa=it[Re.fontStack];if(!Aa)continue;Aa[hn]&&(Ln=Aa[hn]);const Er=Je[Re.fontStack];if(!Er)continue;const ia=Er.glyphs[hn];if(!ia)continue;if(_n=ia.metrics,Hr=hn!==8203?ds:0,Un){const Ui=Er.ascender!==void 0?Math.abs(Er.ascender):0,Ci=Er.descender!==void 0?Math.abs(Er.descender):0,_a=(Ui+Ci)*vn;Xr<_a&&(Xr=_a,Lr=(Ui-Ci)/2*vn),Gr=-Ui*vn}else Gr=(On-vn)*ds-17}Ni?($e.verticalizable=!0,wr.push({glyph:hn,image:ar,x:pt,y:Ct+Gr,vertical:Ni,scale:vn,localGlyph:_n.localGlyph,fontStack:Re.fontStack,sectionIndex:Et,metrics:_n,rect:Ln}),pt+=Hr*vn+on):(wr.push({glyph:hn,image:ar,x:pt,y:Ct+Gr,vertical:Ni,scale:vn,localGlyph:_n.localGlyph,fontStack:Re.fontStack,sectionIndex:Et,metrics:_n,rect:Ln}),pt+=_n.advance*vn+on)}wr.length!==0&&(un=Math.max(pt-on,un),Un?E3(wr,Qt,ur,Lr,Dt*On/2):E3(wr,Qt,ur,0,Dt/2)),pt=0;const Ji=Dt*On+ur;or.lineOffset=Math.max(ur,Jn),Ct+=Ji,++kn}var Xt;const an=Ct,{horizontalAlign:Nn,verticalAlign:Cn}=YC(ln);(function(pn,On,Jn,or,wr,ur){const Xr=(On-Jn)*wr,Lr=-ur*or;for(const Ji of pn)for(const Oe of Ji.positionedGlyphs)Oe.x+=Xr,Oe.y+=Lr})($e.positionedLines,Qt,Nn,Cn,un,an),$e.top+=-Cn*an,$e.bottom=$e.top+an,$e.left+=-Nn*un,$e.right=$e.left+un,$e.hasBaseline=Un})(Ue,r,s,h,pe,x,E,O,j,R,B,Z),!(function($e){for(const Je of $e)if(Je.positionedGlyphs.length!==0)return!1;return!0})(Ge))return Ue}const JS={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},$te={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function b3(l,r,s,h,p,_){if(r.image){const x=h.get(r.image.toString());return x?x.displaySize[0]*r.scale*ds/_+p:0}{const x=s[r.fontStack],E=x&&x.glyphs[l];return E?E.metrics.advance*r.scale+p:0}}function w3(l,r,s,h){const p=Math.pow(l-r,2);return h?l<r?p/2:2*p:p+Math.abs(s)*s}function qte(l,r,s){let h=0;return l===10&&(h-=1e4),s&&(h+=150),l!==40&&l!==65288||(h+=50),r!==41&&r!==65289||(h+=50),h}function S3(l,r,s,h,p,_){let x=null,E=w3(r,s,p,_);for(const O of h){const R=w3(r-O.x,s,p,_)+O.badness;R<=E&&(x=O,E=R)}return{index:l,x:r,priorBreak:x,badness:E}}function T3(l){return l?T3(l.priorBreak).concat(l.index):[]}function YC(l){let r=.5,s=.5;switch(l){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function E3(l,r,s,h,p){if(!(r||s||h||p))return;const _=l.length-1,x=l[_],E=(x.x+x.metrics.advance*x.scale)*r;for(let O=0;O<=_;O++)l[O].x-=E,l[O].y+=s+h+p}function A3(l){return l.imagePrimary!==void 0&&l.top!==void 0&&l.bottom!==void 0&&l.left!==void 0&&l.right!==void 0}function Hte(l,r,s,h){const{horizontalAlign:p,verticalAlign:_}=YC(h),x=s[0]-l.displaySize[0]*p,E=s[1]-l.displaySize[1]*_;return{imagePrimary:l,imageSecondary:r,top:E,bottom:E+l.displaySize[1],left:x,right:x+l.displaySize[0]}}function C3(l,r,s,h,p,_){const x=l.imagePrimary;let E;if(x.content){const se=x.content,pe=x.pixelRatio||1;E=[se[0]/pe,se[1]/pe,x.displaySize[0]-se[2]/pe,x.displaySize[1]-se[3]/pe]}const O=r.left*_,R=r.right*_;let z,j,B,X;s==="width"||s==="both"?(X=p[0]+O-h[3],j=p[0]+R+h[1]):(X=p[0]+(O+R-x.displaySize[0])/2,j=X+x.displaySize[0]);const Z=r.top*_,ae=r.bottom*_;return s==="height"||s==="both"?(z=p[1]+Z-h[0],B=p[1]+ae+h[2]):(z=p[1]+(Z+ae-x.displaySize[1])/2,B=z+x.displaySize[1]),{imagePrimary:x,imageSecondary:void 0,top:z,right:j,bottom:B,left:X,collisionPadding:E}}function M3(l){return!l.imagePrimary.stretchX}function P3(l){return!l.imagePrimary.stretchY}function O3(l){return{width:l.right-l.left,height:l.bottom-l.top}}const Yf=128;function R3(l,r,s){const{expression:h}=r;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Ei(l+1,{worldview:s}))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=h;let x=0;for(;x<p.length&&p[x]<=l;)x++;x=Math.max(0,x-1);let E=x;for(;E<p.length&&p[E]<l+1;)E++;E=Math.min(p.length-1,E);const O=p[x],R=p[E];return h.kind==="composite"?{kind:"composite",minZoom:O,maxZoom:R,interpolationType:_}:{kind:"camera",minZoom:O,maxZoom:R,minSize:h.evaluate(new Ei(O,{worldview:s})),maxSize:h.evaluate(new Ei(R,{worldview:s})),interpolationType:_}}}function KC(l,{uSize:r,uSizeT:s},{lowerSize:h,upperSize:p}){return l.kind==="source"?h/Yf:l.kind==="composite"?Gn(h/Yf,p/Yf,s):r}function Ob(l,r,s=1){let h=0,p=0;if(l.kind==="constant")p=l.layoutSize*s;else if(l.kind!=="source"){const{interpolationType:_,minZoom:x,maxZoom:E}=l,O=_?Pe(sa.interpolationFactor(_,r,x,E),0,1):0;l.kind==="camera"?p=Gn(l.minSize,l.maxSize,O)*s:h=O*s}return{uSizeT:h,uSize:p}}class bm extends kt{constructor(r,s,h,p,_){super(r,s),this.angle=p,this.z=h,_!==void 0&&(this.segment=_)}clone(){return new bm(this.x,this.y,this.z,this.angle,this.segment)}}function I3(l,r,s,h,p){if(r.segment===void 0)return!0;let _=r,x=r.segment+1,E=0;for(;E>-s/2;){if(x--,x<0)return!1;E-=l[x].dist(_),_=l[x]}E+=l[x].dist(l[x+1]),x++;const O=[];let R=0;for(;E<s/2;){const z=l[x],j=l[x+1];if(!j)return!1;let B=l[x-1].angleTo(z)-z.angleTo(j);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:E,angleDelta:B}),R+=B;E-O[0].distance>h;)R-=O.shift().angleDelta;if(R>p)return!1;x++,E+=z.dist(j)}return!0}function D3(l){let r=0;for(let s=0;s<l.length-1;s++)r+=l[s].dist(l[s+1]);return r}function k3(l,r,s){return l?.6*r*s:0}function L3(l,r){return Math.max(l?l.right-l.left:0,r?r.right-r.left:0)}function Gte(l,r,s,h,p,_){const x=k3(s,p,_),E=L3(s,h)*_;let O=0;const R=D3(l)/2;for(let z=0;z<l.length-1;z++){const j=l[z],B=l[z+1],X=j.dist(B);if(O+X>R){const Z=(R-O)/X,ae=Gn(j.x,B.x,Z),se=Gn(j.y,B.y,Z),pe=new bm(ae,se,0,B.angleTo(j),z);return!x||I3(l,pe,E,x,r)?pe:void 0}O+=X}}function Wte(l,r,s,h,p,_,x,E,O){const R=k3(h,_,x),z=L3(h,p),j=z*x,B=l[0].x===0||l[0].x===O||l[0].y===0||l[0].y===O;return r-j<r/4&&(r=j+r/4),N3(l,B?r/2*E%r:(z/2+2*_)*x*E%r,r,R,s,j,B,!1,O)}function N3(l,r,s,h,p,_,x,E,O){const R=_/2,z=D3(l);let j=0,B=r-s,X=[];for(let Z=0;Z<l.length-1;Z++){const ae=l[Z],se=l[Z+1],pe=ae.dist(se),we=se.angleTo(ae);for(;B+s<j+pe;){B+=s;const be=(B-j)/pe,Ee=Gn(ae.x,se.x,be),Ge=Gn(ae.y,se.y,be);if(Ee>=0&&Ee<O&&Ge>=0&&Ge<O&&B-R>=0&&B+R<=z){const Ue=new bm(Ee,Ge,0,we,Z);h&&!I3(l,Ue,_,h,p)||X.push(Ue)}}j+=pe}return E||X.length||x||(X=N3(l,j/2,s,h,p,_,x,!0,O)),X}function z3(l){let r=0,s=0;for(const x of l)r+=x.w*x.h,s=Math.max(s,x.w);l.sort(((x,E)=>E.h-x.h));const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let p=0,_=0;for(const x of l)for(let E=h.length-1;E>=0;E--){const O=h[E];if(!(x.w>O.w||x.h>O.h)){if(x.x=O.x,x.y=O.y,_=Math.max(_,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===O.w&&x.h===O.h){const R=h.pop();R&&E<h.length&&(h[E]=R)}else x.h===O.h?(O.x+=x.w,O.w-=x.w):x.w===O.w?(O.y+=x.h,O.h-=x.h):(h.push({x:O.x+x.w,y:O.y,w:O.w-x.w,h:x.h}),O.y+=x.h,O.h-=x.h);break}}return{w:p,h:_,fill:r/(p*_)||0}}Rn(bm,"Anchor");const E_=1;class Rb{static getImagePositionScale(r,s,h){if(s&&r&&r.options&&r.options.transform){const p=r.options.transform;return{x:p.a,y:p.d}}return{x:h,y:h}}constructor(r,s,h,p){this.paddedRect=r;const{pixelRatio:_,version:x,stretchX:E,stretchY:O,content:R,sdf:z,usvg:j}=s;this.pixelRatio=_,this.stretchX=E,this.stretchY=O,this.content=R,this.version=x,this.padding=h,this.sdf=z,this.usvg=j,this.scale=Rb.getImagePositionScale(p,j,_)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function JC(l,r,s){const h=Ml.parse(l),p=(function(_,x,E=[1,1]){return{x:0,y:0,w:(_.data?_.data.width:_.width*E[0])+2*x,h:(_.data?_.data.height:_.height*E[1])+2*x}})(r,s,[h.options.transform.a,h.options.transform.d]);return{bin:p,imagePosition:new Rb(p,r,s,h),imageVariant:h}}class j3{constructor(r,s,h){const p=new Map,_=new Map;this.haveRenderCallbacks=[];const x=[];this.addImages(r,p,E_,x),this.addImages(s,_,2,x);const{w:E,h:O}=z3(x),R=new Fo({width:E||1,height:O||1});for(const[z,j]of r.entries()){const B=p.get(z).paddedRect;Fo.copy(j.data,R,{x:0,y:0},{x:B.x+E_,y:B.y+E_},j.data,h,j.sdf)}for(const[z,j]of s.entries()){const B=_.get(z),X=B.paddedRect;let Z=B.padding;const ae=X.x+Z,se=X.y+Z,pe=j.data.width,we=j.data.height;Z=Z>1?Z-1:Z,Fo.copy(j.data,R,{x:0,y:0},{x:ae,y:se},j.data,h),Fo.copy(j.data,R,{x:0,y:we-Z},{x:ae,y:se-Z},{width:pe,height:Z},h),Fo.copy(j.data,R,{x:0,y:0},{x:ae,y:se+we},{width:pe,height:Z},h),Fo.copy(j.data,R,{x:pe-Z,y:0},{x:ae-Z,y:se},{width:Z,height:we},h),Fo.copy(j.data,R,{x:0,y:0},{x:ae+pe,y:se},{width:Z,height:we},h),Fo.copy(j.data,R,{x:pe-Z,y:we-Z},{x:ae-Z,y:se-Z},{width:Z,height:Z},h),Fo.copy(j.data,R,{x:0,y:we-Z},{x:ae+pe,y:se-Z},{width:Z,height:Z},h),Fo.copy(j.data,R,{x:0,y:0},{x:ae+pe,y:se+we},{width:Z,height:Z},h),Fo.copy(j.data,R,{x:pe-Z,y:0},{x:ae-Z,y:se+we},{width:Z,height:Z},h)}this.lut=h,this.image=R,this.iconPositions=p,this.patternPositions=_}addImages(r,s,h,p){for(const[_,x]of r.entries()){const{bin:E,imagePosition:O,imageVariant:R}=JC(_,x,h);s.set(_,O),p.push(E),x.hasRenderCallback&&this.haveRenderCallbacks.push(R.id)}}patchUpdatedImages(r,s,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((p=>r.hasImage(p,h))),r.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const p of r.getUpdatedImages(h)){for(const _ of this.iconPositions.keys()){const x=Ml.parse(_);if(Ms.isEqual(x.id,p)){const E=r.getImage(p,h);this.patchUpdatedImage(this.iconPositions.get(_),E,s)}}for(const _ of this.patternPositions.keys()){const x=Ml.parse(_);if(Ms.isEqual(x.id,p)){const E=r.getImage(p,h);this.patchUpdatedImage(this.patternPositions.get(_),E,s)}}}}patchUpdatedImage(r,s,h){if(!r||!s||r.version===s.version)return;r.version=s.version;const[p,_]=r.tl,x=r.sdf;if(this.lut||x){const E={width:s.data.width,height:s.data.height},O=new Fo(E);Fo.copy(s.data,O,{x:0,y:0},{x:0,y:0},E,this.lut,x),h.update(O,{position:{x:p,y:_}})}else h.update(s.data,{position:{x:p,y:_}})}}Rn(Rb,"ImagePosition"),Rn(j3,"ImageAtlas");const Ib=1e20;function B3(l,r,s,h,p,_,x,E,O){for(let R=r;R<r+h;R++)F3(l,s*_+R,_,p,x,E,O);for(let R=s;R<s+p;R++)F3(l,R*_+r,1,h,x,E,O)}function F3(l,r,s,h,p,_,x){_[0]=0,x[0]=-Ib,x[1]=Ib,p[0]=l[r];for(let E=1,O=0,R=0;E<h;E++){p[E]=l[r+E*s];const z=E*E;do{const j=_[O];R=(p[E]-p[j]+z-j*j)/(E-j)/2}while(R<=x[O]&&--O>-1);O++,_[O]=E,x[O]=R,x[O+1]=Ib}for(let E=0,O=0;E<h;E++){for(;x[O+1]<E;)O++;const R=_[O],z=E-R;l[r+E*s]=p[R]+z*z}}const zd=2,QC={none:0,ideographs:1,all:2};class Qv{constructor(r,s,h){this.requestManager=r,this.localGlyphMode=s,this.localFontFamily=h,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,s){const h=[],p=this.url||xo.GLYPHS_URL;for(const _ in r)for(const x of r[_])h.push({stack:_,id:x});et(h,(({stack:_,id:x},E)=>{let O=this.entries[_];O||(O=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=O.glyphs[x];if(R!==void 0)return void E(null,{stack:_,id:x,glyph:R});if(R=this._tinySDF(O,_,x),R)return O.glyphs[x]=R,void E(null,{stack:_,id:x,glyph:R});const z=Math.floor(x/256);if(256*z>65535)return jr("glyphs > 65535 not supported"),void E(null,{stack:_,id:x,glyph:R});if(O.ranges[z])return void E(null,{stack:_,id:x,glyph:R});let j=O.requests[z];j||(j=O.requests[z]=[],Qv.loadGlyphRange(_,z,p,this.requestManager,((B,X)=>{if(X){O.ascender=X.ascender,O.descender=X.descender;for(const Z in X.glyphs)this._doesCharSupportLocalGlyph(+Z)||(O.glyphs[+Z]=X.glyphs[+Z]);O.ranges[z]=!0}for(const Z of j)Z(B,X);delete O.requests[z]}))),j.push(((B,X)=>{B?E(B):X&&E(null,{stack:_,id:x,glyph:X.glyphs[x]||null})}))}),((_,x)=>{if(_)s(_);else if(x){const E={};for(const{stack:O,id:R,glyph:z}of x)E[O]===void 0&&(E[O]={}),E[O].glyphs===void 0&&(E[O].glyphs={}),E[O].glyphs[R]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},E[O].ascender=this.entries[O].ascender,E[O].descender=this.entries[O].descender;s(null,E)}}))}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==QC.none&&(this.localGlyphMode===QC.all?!!this.localFontFamily:!!this.localFontFamily&&(jn["CJK Unified Ideographs"](r)||jn["Hangul Syllables"](r)||jn.Hiragana(r)||jn.Katakana(r)||jn["CJK Symbols and Punctuation"](r)||jn["CJK Unified Ideographs Extension A"](r)||jn["CJK Unified Ideographs Extension B"](r)||jn.Osage(r)))}_tinySDF(r,s,h){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let _=r.tinySDF;if(!_){let ae="400";/bold/i.test(s)?ae="900":/medium/i.test(s)?ae="500":/light/i.test(s)&&(ae="200"),_=r.tinySDF=new Qv.TinySDF({fontFamily:p,fontWeight:ae,fontSize:24*zd,buffer:3*zd,radius:8*zd}),_.fontWeight=ae}if(this.localGlyphs[_.fontWeight][h])return this.localGlyphs[_.fontWeight][h];const x=String.fromCodePoint(h),{data:E,width:O,height:R,glyphWidth:z,glyphHeight:j,glyphLeft:B,glyphTop:X,glyphAdvance:Z}=_.draw(x);return this.localGlyphs[_.fontWeight][h]={id:h,bitmap:new Dd({width:O,height:R},E),metrics:{width:z/zd,height:j/zd,left:B/zd,top:X/zd-27,advance:Z/zd,localGlyph:!0}}}}Qv.loadGlyphRange=function(l,r,s,h,p){const _=256*r,x=_+255,E=h.transformRequest(h.normalizeGlyphsURL(s).replace("{fontstack}",l).replace("{range}",`${_}-${x}`),uh.Glyphs);pc(E,((O,R)=>{if(O)p(O);else if(R){const z={},j=(function(B){return new KS(B).readFields(Fte,{})})(R);for(const B of j.glyphs)z[B.id]=B;p(null,{glyphs:z,ascender:j.ascender,descender:j.descender})}}))},Qv.TinySDF=class{constructor({fontSize:l=24,buffer:r=3,radius:s=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:x="normal"}={}){this.buffer=r,this.cutoff=h,this.radius=s;const E=this.size=l+4*r,O=this._createCanvas(E),R=this.ctx=O.getContext("2d",{willReadFrequently:!0});R.font=`${x} ${_} ${l}px ${p}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(l){const r=document.createElement("canvas");return r.width=r.height=l,r}draw(l){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(l),x=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-p))),O=Math.min(this.size-this.buffer,x+Math.ceil(h)),R=E+2*this.buffer,z=O+2*this.buffer,j=Math.max(R*z,0),B=new Uint8ClampedArray(j),X={data:B,width:R,height:z,glyphWidth:E,glyphHeight:O,glyphTop:x,glyphLeft:0,glyphAdvance:r};if(E===0||O===0)return X;const{ctx:Z,buffer:ae,gridInner:se,gridOuter:pe}=this;Z.clearRect(ae,ae,E,O),Z.fillText(l,ae,ae+x);const we=Z.getImageData(ae,ae,E,O);pe.fill(Ib,0,j),se.fill(0,0,j);for(let be=0;be<O;be++)for(let Ee=0;Ee<E;Ee++){const Ge=we.data[4*(be*E+Ee)+3]/255;if(Ge===0)continue;const Ue=(be+ae)*R+Ee+ae;if(Ge===1)pe[Ue]=0,se[Ue]=Ib;else{const $e=.5-Ge;pe[Ue]=$e>0?$e*$e:0,se[Ue]=$e<0?$e*$e:0}}B3(pe,0,0,R,z,R,this.f,this.v,this.z),B3(se,ae,ae,E,O,R,this.f,this.v,this.z);for(let be=0;be<j;be++){const Ee=Math.sqrt(pe[be])-Math.sqrt(se[be]);B[be]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return X}};const qg=E_;function V3(l,r){return l+r[1]-r[0]}function U3(l,r,s,h,p=1){const _=[],x=l.imagePrimary,E=x.pixelRatio,O=x.paddedRect.w-2*qg,R=x.paddedRect.h-2*qg,z=(l.right-l.left)*p,j=(l.bottom-l.top)*p,B=x.stretchX||[[0,O]],X=x.stretchY||[[0,R]],Z=B.reduce(V3,0),ae=X.reduce(V3,0),se=O-Z,pe=R-ae;let we=0,be=Z,Ee=0,Ge=ae,Ue=0,$e=se,Je=0,it=pe;if(x.content&&h){const ut=x.content;we=QS(B,0,ut[0]),Ee=QS(X,0,ut[1]),be=QS(B,ut[0],ut[2]),Ge=QS(X,ut[1],ut[3]),Ue=ut[0]-we,Je=ut[1]-Ee,$e=ut[2]-ut[0]-be,it=ut[3]-ut[1]-Ge}const Mt=(ut,Dt,ln,Vt)=>{const Yt=eT(ut.stretch-we,be,z,l.left*p),on=tT(ut.fixed-Ue,$e,ut.stretch,Z),At=eT(Dt.stretch-Ee,Ge,j,l.top*p),Kt=tT(Dt.fixed-Je,it,Dt.stretch,ae),pt=eT(ln.stretch-we,be,z,l.left*p),Ct=tT(ln.fixed-Ue,$e,ln.stretch,Z),un=eT(Vt.stretch-Ee,Ge,j,l.top*p),Qt=tT(Vt.fixed-Je,it,Vt.stretch,ae),Un=new kt(Yt,At),kn=new kt(pt,At),Xt=new kt(pt,un),an=new kt(Yt,un),Nn=new kt(on/E,Kt/E),Cn=new kt(Ct/E,Qt/E),pn=r*Math.PI/180;if(pn){const Xr=Math.sin(pn),Lr=Math.cos(pn),Ji=[Lr,-Xr,Xr,Lr];Un._matMult(Ji),kn._matMult(Ji),an._matMult(Ji),Xt._matMult(Ji)}const On=ut.stretch+ut.fixed,Jn=ln.stretch+ln.fixed,or=Dt.stretch+Dt.fixed,wr=Vt.stretch+Vt.fixed,ur=l.imageSecondary;return{tl:Un,tr:kn,bl:an,br:Xt,texPrimary:{x:x.paddedRect.x+qg+On,y:x.paddedRect.y+qg+or,w:Jn-On,h:wr-or},texSecondary:ur?{x:ur.paddedRect.x+qg+On,y:ur.paddedRect.y+qg+or,w:Jn-On,h:wr-or}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Nn,pixelOffsetBR:Cn,minFontScaleX:$e/E/z,minFontScaleY:it/E/j,isSDF:s}};if(h&&(x.stretchX||x.stretchY)){const ut=$3(B,se,Z),Dt=$3(X,pe,ae);for(let ln=0;ln<ut.length-1;ln++){const Vt=ut[ln],Yt=ut[ln+1];for(let on=0;on<Dt.length-1;on++)_.push(Mt(Vt,Dt[on],Yt,Dt[on+1]))}}else _.push(Mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:R+1}));return _}function QS(l,r,s){let h=0;for(const p of l)h+=Math.max(r,Math.min(s,p[1]))-Math.max(r,Math.min(s,p[0]));return h}function $3(l,r,s){const h=[{fixed:-qg,stretch:0}];for(const[p,_]of l){const x=h[h.length-1];h.push({fixed:p-x.stretch,stretch:x.stretch}),h.push({fixed:p-x.stretch,stretch:x.stretch+(_-p)})}return h.push({fixed:r+qg,stretch:s}),h}function eT(l,r,s,h){return l/r*s+h}function tT(l,r,s,h){return l-r*s/h}function Xte(l,r,s,h){const p=r+l.positionedLines[h].lineOffset;return h===0?s+p/2:s+(p+(r+l.positionedLines[h-1].lineOffset))/2}function Zte(l,r=1,s=!1){let h=1/0,p=1/0,_=-1/0,x=-1/0;const E=l[0];for(let X=0;X<E.length;X++){const Z=E[X];(!X||Z.x<h)&&(h=Z.x),(!X||Z.y<p)&&(p=Z.y),(!X||Z.x>_)&&(_=Z.x),(!X||Z.y>x)&&(x=Z.y)}const O=Math.min(_-h,x-p);let R=O/2;const z=new Pp([],Yte);if(O===0)return new kt(h,p);for(let X=h;X<_;X+=O)for(let Z=p;Z<x;Z+=O)z.push(new ex(X+R,Z+R,R,l));let j=(function(X){let Z=0,ae=0,se=0;const pe=X[0];for(let we=0,be=pe.length,Ee=be-1;we<be;Ee=we++){const Ge=pe[we],Ue=pe[Ee],$e=Ge.x*Ue.y-Ue.x*Ge.y;ae+=(Ge.x+Ue.x)*$e,se+=(Ge.y+Ue.y)*$e,Z+=3*$e}return new ex(ae/Z,se/Z,0,X)})(l),B=z.length;for(;z.length;){const X=z.pop();(X.d>j.d||!j.d)&&(j=X,s&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,B)),X.max-j.d<=r||(R=X.h/2,z.push(new ex(X.p.x-R,X.p.y-R,R,l)),z.push(new ex(X.p.x+R,X.p.y-R,R,l)),z.push(new ex(X.p.x-R,X.p.y+R,R,l)),z.push(new ex(X.p.x+R,X.p.y+R,R,l)),B+=4)}return s&&(console.log(`num probes: ${B}`),console.log(`best distance: ${j.d}`)),j.p}function Yte(l,r){return r.max-l.max}class ex{constructor(r,s,h,p){this.p=new kt(r,s),this.h=h,this.d=(function(_,x){let E=!1,O=1/0;for(let R=0;R<x.length;R++){const z=x[R];for(let j=0,B=z.length,X=B-1;j<B;X=j++){const Z=z[j],ae=z[X];Z.y>_.y!=ae.y>_.y&&_.x<(ae.x-Z.x)*(_.y-Z.y)/(ae.y-Z.y)+Z.x&&(E=!E),O=Math.min(O,_l(_,Z,ae))}}return(E?1:-1)*Math.sqrt(O)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Kte=Object.keys,eM=Number.POSITIVE_INFINITY,Jte=Math.sqrt(2);function q3(l,[r,s]){let h=0,p=0;if(s===eM){r<0&&(r=0);const _=r/Jte;switch(l){case"top-right":case"top-left":p=_-7;break;case"bottom-right":case"bottom-left":p=7-_;break;case"bottom":p=7-r;break;case"top":p=r-7}switch(l){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=r;break;case"right":h=-r}}else{switch(r=Math.abs(r),s=Math.abs(s),l){case"top-right":case"top-left":case"top":p=s-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-s}switch(l){case"top-right":case"bottom-right":case"right":h=-r;break;case"top-left":case"bottom-left":case"left":h=r}}return[h,p]}function nT(l,r,s,h,p,_,x,E,O){if(!r||!r.usvg)return;const R=O3(h),z=O3(p),j=_!=="both"&&_!=="width"||!M3(h)?1:z.width/R.width,B=_!=="both"&&_!=="height"||!P3(h)?1:z.height/R.height;s.scaleSelf(j,B);const X=s.toString();x.set(X,s),E.set(X,r);const{imagePosition:Z}=JC(X,r,E_);O.set(X,Z)}function H3(l,r,s,h,p,_,x,E,O){if(!l)return;const R=(function(z,j,B,X,Z,ae){if(z.kind==="camera")return z.maxSize;if(z.kind==="composite"){const se=j.possiblyEvaluate(new Ei(z.maxZoom,{worldview:ae}),B).evaluate(Z,{},B),pe=j.possiblyEvaluate(new Ei(z.minZoom,{worldview:ae}),B).evaluate(Z,{},B);return Math.max(se,pe)}return j.possiblyEvaluate(new Ei(X,{worldview:ae})).evaluate(Z,{},B)})(r,s,h,p,_,O);return l.scaleSelf(R*E*x)}function G3(l,r,s,h,p,_,x,E,O){return{iconPrimary:H3(l.getPrimary(),r,s,h,p,_,x,E,O),iconSecondary:H3(l.getSecondary(),r,s,h,p,_,x,E,O)}}function Qte(l,r,s){if(!r)return;const h=s.get(l.toString()),p=s.get(r.toString());p&&(h.paddedRect.w===p.paddedRect.w&&h.paddedRect.h===p.paddedRect.h||jr(`Mismatch in icon variant sizes: ${l.toString()} and ${r.toString()}`),h.usvg!==p.usvg&&jr(`Mismatch in icon variant image types: ${l.id} and ${r.id}`))}function W3(l,r,s,h){if(!l)return;const p=r.get(s.toString());if(l.imagePrimary=p,h){const _=r.get(h.toString());l.imageSecondary=_}}function ene(l,r){for(const s in l.horizontal)X3(l.horizontal[s],r);X3(l.vertical,r)}function X3(l,r){if(l){for(const s of l.positionedLines)for(const h of s.positionedGlyphs)if(h.image!==null){const p=h.image.toString();h.rect=r.get(p).paddedRect}}}function tM(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tne(l,r,s,h,p,_,x,E,O){const R=nM(_.horizontal)||_.vertical,z=s.get("icon-text-fit-padding").evaluate(h,{},p);let j,B=r;return r&&O!=="none"&&(l.allowVerticalPlacement&&_.vertical&&(j=C3(r,_.vertical,O,z,E,x)),R&&(B=C3(r,R,O,z,E,x))),{defaultShapedIcon:B,verticallyShapedIcon:j}}function nne(l,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe,we,be){let Ee=x.textMaxSize.evaluate(r,{},B);Ee===void 0?Ee=E*x.textScaleFactor:Ee*=x.textScaleFactor;const Ge=l.layers[0].layout,Ue=nM(s.horizontal)||s.vertical,$e=X.name==="globe",Je=ds,it=l.tilePixelRatio*Ee/Je,Mt=(on=l.overscaling,l.zoom>18&&on>2&&(on>>=1),Math.max(nn/(512*on),1)*Ge.get("symbol-spacing")),ut=Ge.get("text-padding")*l.tilePixelRatio,Dt=Ge.get("icon-padding")*l.tilePixelRatio,ln=hr(Ge.get("text-max-angle")),Vt=Ge.get("icon-rotation-alignment")==="map"&&be!=="point",Yt=Mt/2;var on;l.hasAnyIconTextFit===!1&&se!=="none"&&(l.hasAnyIconTextFit=!0);const At=r.properties?+r.properties[xn]:null,Kt=At&&l.elevationFeatureIdToIndex?l.elevationFeatureIdToIndex.get(At):65535,pt=(Ct,un,Qt)=>{if(un.x<0||un.x>=nn||un.y<0||un.y>=nn)return;let Un=null;if($e){const{x:kn,y:Xt,z:an}=X.projectTilePoint(un.x,un.y,Qt);Un={anchor:new bm(kn,Xt,an,0,void 0),up:X.upVector(Qt,un.x,un.y)}}(function(kn,Xt,an,Nn,Cn,pn,On,Jn,or,wr,ur,Xr,Lr,Ji,Oe,Re,Et,hn,vn,_n,Ln,ar,Hr,Gr,Pr,Ni,Aa,Er,ia){const Ui=kn.addToLineVertexArray(Xt,Nn);let Ci,_a,Qi,$i,Xi,Pi,Or,zi=0,va=0,nr=0,si=0,ea=-1,Oa=-1;const aa={};let Mo=Vc("");const ji=an?an.anchor:Xt,mo=Er!=="none";let rc=0,zs=0;if(or._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Po=or.layout.get("text-offset").evaluate(Ln,{},Pr);rc=Po[0]*ds,zs=Po[1]*ds}else rc=or.layout.get("text-radial-offset").evaluate(Ln,{},Pr)*ds,zs=eM;if(kn.allowVerticalPlacement&&Cn.vertical){const Po=Cn.vertical;if(Oe)Pi=rM(Po),Jn&&(Or=rM(Jn));else{const Vo=or.layout.get("text-rotate").evaluate(Ln,{},Pr)+90;Qi=rT(wr,ji,Xt,ur,Xr,Lr,Po,Ji,Vo,Re),Jn&&($i=rT(wr,ji,Xt,ur,Xr,Lr,Jn,hn,Vo))}}if(pn){const Po=kn.iconSizeData,Vo=or.layout.get("icon-rotate").evaluate(Ln,{},Pr),js=U3(pn,Vo,Hr,mo,ar.iconScaleFactor),xl=Jn?U3(Jn,Vo,Hr,mo,ar.iconScaleFactor):void 0;_a=rT(wr,ji,Xt,ur,Xr,Lr,pn,hn,Vo,null),zi=4*js.length;let el=null;Po.kind==="source"?(el=[Yf*or.layout.get("icon-size").evaluate(Ln,{},Pr)*ar.iconScaleFactor],el[0]>Hg&&jr(`${kn.layerIds[0]}: Value for "icon-size" is >= ${Db}. Reduce your "icon-size".`)):Po.kind==="composite"&&(el=[Yf*ar.compositeIconSizes[0].evaluate(Ln,{},Pr)*ar.iconScaleFactor,Yf*ar.compositeIconSizes[1].evaluate(Ln,{},Pr)*ar.iconScaleFactor],(el[0]>Hg||el[1]>Hg)&&jr(`${kn.layerIds[0]}: Value for "icon-size" is >= ${Db}. Reduce your "icon-size".`)),kn.addSymbols(kn.icon,js,el,_n,vn,Ln,void 0,an,Xt,Ui.lineStartIndex,Ui.lineLength,-1,Gr,Pr,Ni,Aa),ea=kn.icon.placedSymbolArray.length-1,xl&&(va=4*xl.length,kn.addSymbols(kn.icon,xl,el,_n,vn,Ln,Pc.vertical,an,Xt,Ui.lineStartIndex,Ui.lineLength,-1,Gr,Pr,Ni,Aa),Oa=kn.icon.placedSymbolArray.length-1)}for(const Po in Cn.horizontal){const Vo=Po,js=Cn.horizontal[Vo];Ci||(Mo=Vc(js.text),Oe?Xi=rM(js):Ci=rT(wr,ji,Xt,ur,Xr,Lr,js,Ji,or.layout.get("text-rotate").evaluate(Ln,{},Pr),Re));const xl=js.positionedLines.length===1;if(nr+=Z3(kn,an,Xt,js,On,or,Oe,Ln,Re,Ui,Cn.vertical?Pc.horizontal:Pc.horizontalOnly,xl?Kte(Cn.horizontal):[Vo],aa,ea,ar,Gr,Pr,Ni),xl)break}Cn.vertical&&(si+=Z3(kn,an,Xt,Cn.vertical,On,or,Oe,Ln,Re,Ui,Pc.vertical,["vertical"],aa,Oa,ar,Gr,Pr,Ni));let Ss=-1;const ic=(Po,Vo)=>Po?Math.max(Po,Vo):Vo;Ss=ic(Xi,Ss),Ss=ic(Pi,Ss),Ss=ic(Or,Ss);const Kf=Ss>-1?1:0;kn.glyphOffsetArray.length>=65535&&jr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ln.sortKey!==void 0&&kn.addToSortKeyRanges(kn.symbolInstances.length,Ln.sortKey),kn.symbolInstances.emplaceBack(Xt.x,Xt.y,ji.x,ji.y,ji.z,aa.right>=0?aa.right:-1,aa.center>=0?aa.center:-1,aa.left>=0?aa.left:-1,aa.vertical>=0?aa.vertical:-1,ea,Oa,Mo,Ci!==void 0?Ci:kn.collisionBoxArray.length,Ci!==void 0?Ci+1:kn.collisionBoxArray.length,Qi!==void 0?Qi:kn.collisionBoxArray.length,Qi!==void 0?Qi+1:kn.collisionBoxArray.length,_a!==void 0?_a:kn.collisionBoxArray.length,_a!==void 0?_a+1:kn.collisionBoxArray.length,$i||kn.collisionBoxArray.length,$i?$i+1:kn.collisionBoxArray.length,ur,nr,si,zi,va,Kf,0,rc,zs,Ss,0,mo?1:0,ia)})(l,un,Un,Ct,s,h,_,p,l.layers[0],l.collisionBoxArray,r.index,r.sourceLayerIndex,l.index,ut,we,R,0,Dt,Vt,pe,r,x,z,j,B,Z,ae,se,Kt)};if(be==="line")for(const Ct of Xv(r.geometry,0,0,nn,nn)){const un=Wte(Ct,Mt,ln,s.vertical||Ue,h,Je,it,l.overscaling,nn);for(const Qt of un)Ue&&rne(l,Ue.text,Yt,Qt)||pt(Ct,Qt,B)}else if(be==="line-center"){for(const Ct of r.geometry)if(Ct.length>1){const un=Gte(Ct,ln,s.vertical||Ue,h,Je,it);un&&pt(Ct,un,B)}}else if(r.type==="Polygon")for(const Ct of m_(r.geometry,0)){const un=Zte(Ct,16);pt(Ct[0],new bm(un.x,un.y,0,0,void 0),B)}else if(r.type==="LineString")for(const Ct of r.geometry)pt(Ct,new bm(Ct[0].x,Ct[0].y,0,0,void 0),B);else if(r.type==="Point")for(const Ct of r.geometry)for(const un of Ct)pt([un],new bm(un.x,un.y,0,0,void 0),B)}const Db=255,Hg=Db*Yf;function Z3(l,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se,pe){const we=(function(Ge,Ue,$e,Je,it,Mt,ut,Dt){const ln=[];if(Ue.positionedLines.length===0)return ln;const Vt=Je.layout.get("text-rotate").evaluate(Mt,{})*Math.PI/180,Yt=(function(Ct){const un=Ct[0],Qt=Ct[1],Un=un*Qt;return Un>0?[un,-Qt]:Un<0?[-un,Qt]:un===0?[Qt,un]:[Qt,-un]})($e);let on=Math.abs(Ue.top-Ue.bottom);for(const Ct of Ue.positionedLines)on-=Ct.lineOffset;const At=Ue.positionedLines.length,Kt=on/At;let pt=Ue.top-$e[1];for(let Ct=0;Ct<At;++Ct){const un=Ue.positionedLines[Ct];pt=Xte(Ue,Kt,pt,Ct);for(const Qt of un.positionedGlyphs){if(!Qt.rect)continue;const Un=Qt.rect||{};let kn=x3+1,Xt=!0,an=1,Nn=0;if(Qt.image){const Ln=ut.get(Qt.image.toString());if(!Ln)continue;if(Ln.sdf){jr("SDF images are not supported in formatted text and will be ignored.");continue}Xt=!1,an=Ln.pixelRatio,kn=E_/an}const Cn=(it||Dt)&&Qt.vertical,pn=Qt.metrics.advance*Qt.scale/2,On=Qt.metrics,Jn=Qt.rect;if(Jn===null)continue;Dt&&Ue.verticalizable&&(Nn=Qt.image?pn-Qt.metrics.width*Qt.scale/2:0);const or=it?[Qt.x+pn,Qt.y]:[0,0];let wr=[0,0],ur=[0,0],Xr=!1;it||(Cn?(ur=[Qt.x+pn+Yt[0],Qt.y+Yt[1]-Nn],Xr=!0):wr=[Qt.x+pn+$e[0],Qt.y+$e[1]-Nn]);const Lr=Jn.w*Qt.scale/(an*(Qt.localGlyph?zd:1)),Ji=Jn.h*Qt.scale/(an*(Qt.localGlyph?zd:1));let Oe,Re,Et,hn;if(Cn){const Ln=Qt.y-pt,ar=new kt(-pn,pn-Ln),Hr=-Math.PI/2,Gr=new kt(...ur);Oe=new kt(-pn+wr[0],wr[1]),Oe._rotateAround(Hr,ar)._add(Gr),Oe.x+=-Ln+pn,Oe.y-=(On.left-kn)*Qt.scale;const Pr=Qt.image?On.advance*Qt.scale:ds*Qt.scale,Ni=String.fromCodePoint(Qt.glyph);Pte(Ni)?Oe.x+=(1-kn)*Qt.scale:Ote(Ni)?Oe.x+=Pr-On.height*Qt.scale+(-kn-1)*Qt.scale:Oe.x+=Qt.image||On.width+2*kn===Jn.w&&On.height+2*kn===Jn.h?(Pr-Ji)/2:(Pr-(On.height+2*kn)*Qt.scale)/2,Re=new kt(Oe.x,Oe.y-Lr),Et=new kt(Oe.x+Ji,Oe.y),hn=new kt(Oe.x+Ji,Oe.y-Lr)}else{const Ln=(On.left-kn)*Qt.scale-pn+wr[0],ar=(-On.top-kn)*Qt.scale+wr[1],Hr=Ln+Lr,Gr=ar+Ji;Oe=new kt(Ln,ar),Re=new kt(Hr,ar),Et=new kt(Ln,Gr),hn=new kt(Hr,Gr)}if(Vt){let Ln;Ln=it?new kt(0,0):Xr?new kt(Yt[0],Yt[1]):new kt($e[0],$e[1]),Oe._rotateAround(Vt,Ln),Re._rotateAround(Vt,Ln),Et._rotateAround(Vt,Ln),hn._rotateAround(Vt,Ln)}const vn=new kt(0,0),_n=new kt(0,0);ln.push({tl:Oe,tr:Re,bl:Et,br:hn,texPrimary:Un,texSecondary:void 0,writingMode:Ue.writingMode,glyphOffset:or,sectionIndex:Qt.sectionIndex,isSDF:Xt,pixelOffsetTL:vn,pixelOffsetBR:_n,minFontScaleX:0,minFontScaleY:0})}}return ln})(0,h,O,_,x,E,p,l.allowVerticalPlacement),be=l.textSizeData;let Ee=null;be.kind==="source"?(Ee=[Yf*_.layout.get("text-size").evaluate(E,{},se)*Z.textScaleFactor],Ee[0]>Hg&&jr(`${l.layerIds[0]}: Value for "text-size" is >= ${Db}. Reduce your "text-size".`)):be.kind==="composite"&&(Ee=[Yf*Z.compositeTextSizes[0].evaluate(E,{},se)*Z.textScaleFactor,Yf*Z.compositeTextSizes[1].evaluate(E,{},se)*Z.textScaleFactor],(Ee[0]>Hg||Ee[1]>Hg)&&jr(`${l.layerIds[0]}: Value for "text-size" is >= ${Db}. Reduce your "text-size".`)),l.addSymbols(l.text,we,Ee,O,x,E,z,r,s,R.lineStartIndex,R.lineLength,X,ae,se,pe,!1);for(const Ge of j)B[Ge]=l.text.placedSymbolArray.length-1;return 4*we.length}function nM(l){for(const r in l)return l[r];return null}function rT(l,r,s,h,p,_,x,E,O,R){let z=x.top,j=x.bottom,B=x.left,X=x.right;if(A3(x)&&x.collisionPadding){const Z=x.collisionPadding;B-=Z[0],z-=Z[1],X+=Z[2],j+=Z[3]}if(O){const Z=new kt(B,z),ae=new kt(X,z),se=new kt(B,j),pe=new kt(X,j),we=hr(O);let be=new kt(0,0);R&&(be=new kt(R[0],R[1])),Z._rotateAround(we,be),ae._rotateAround(we,be),se._rotateAround(we,be),pe._rotateAround(we,be),B=Math.min(Z.x,ae.x,se.x,pe.x),X=Math.max(Z.x,ae.x,se.x,pe.x),z=Math.min(Z.y,ae.y,se.y,pe.y),j=Math.max(Z.y,ae.y,se.y,pe.y)}return l.emplaceBack(r.x,r.y,r.z,s.x,s.y,B,z,X,j,E,h,p,_),l.length-1}function rM(l){A3(l)&&l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const r=l.bottom-l.top;return r>0?Math.max(10,r):null}function rne(l,r,s,h){const p=l.compareText;if(r in p){const _=p[r];for(let x=_.length-1;x>=0;x--)if(h.dist(_[x])<s)return!0}else p[r]=[];return p[r].push(h),!1}function Y3(l,r){const s=l.fovAboveCenter,h=l.elevation?l.elevation.getMinElevationBelowMSL()*r:0,p=(l._camera.position[2]*l.worldSize-h)/Math.cos(l._pitch),_=Math.sin(s)*p/Math.sin(Math.max(Math.PI/2-l._pitch-s,.01));let x=Math.sin(l._pitch)*_+p;const E=p*(1/l._horizonShift);if(!l.elevation||l.elevation.exaggeration()===0){let O=Math.max(l.zoom-17,0);l.isOrthographic&&(O/=10),x*=1+O}return Math.min(1.01*x,E)}function kb(l,r){if(!r.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:r};const s=Math.pow(2,-l.z),h=l.x*s,p=(l.x+1)*s,_=l.y*s,x=(l.y+1)*s,E=xe(h),O=xe(p),R=Te(_),z=Te(x),j=r.project(E,R),B=r.project(O,R),X=r.project(O,z),Z=r.project(E,z);let ae=Math.min(j.x,B.x,X.x,Z.x),se=Math.min(j.y,B.y,X.y,Z.y),pe=Math.max(j.x,B.x,X.x,Z.x),we=Math.max(j.y,B.y,X.y,Z.y);const be=s/16;function Ee(Ue,$e,Je,it,Mt,ut){const Dt=(Je+Mt)/2,ln=(it+ut)/2,Vt=r.project(xe(Dt),Te(ln)),Yt=Math.max(0,ae-Vt.x,se-Vt.y,Vt.x-pe,Vt.y-we);ae=Math.min(ae,Vt.x),pe=Math.max(pe,Vt.x),se=Math.min(se,Vt.y),we=Math.max(we,Vt.y),Yt>be&&(Ee(Ue,Vt,Je,it,Dt,ln),Ee(Vt,$e,Dt,ln,Mt,ut))}Ee(j,B,h,_,p,_),Ee(B,X,p,_,p,x),Ee(X,Z,p,x,h,x),Ee(Z,j,h,x,h,_),ae-=be,se-=be,pe+=be,we+=be;const Ge=1/Math.max(pe-ae,we-se);return{scale:Ge,x:ae*Ge,y:se*Ge,x2:pe*Ge,y2:we*Ge,projection:r}}function K3(l,{x:r,y:s},h=0){return new kt(((r-h)*l.scale-l.x)*nn,(s*l.scale-l.y)*nn)}const ine=q(new Float32Array(16));class Gg{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,s){return{x:0,y:0,z:0}}unproject(r,s){return new U(0,0)}projectTilePoint(r,s,h){return{x:r,y:s,z:0}}locationPoint(r,s,h,p=!0){return r._coordinatePoint(r.locationCoordinate(s,h),p)}pixelsPerMeter(r,s){return de(1,r)*s}pixelSpaceConversion(r,s,h){return 1}farthestPixelDistance(r){return Y3(r,r.pixelsPerMeter)}pointCoordinate(r,s,h,p){const _=r.horizonLineFromTop(!1),x=new kt(s,Math.max(_,h));return r.rayIntersectionCoordinate(r.pointRayIntersection(x,p))}pointCoordinate3D(r,s,h){const p=new kt(s,h);if(r.elevation)return r.elevation.pointCoordinate(p);{const _=this.pointCoordinate(r,p.x,p.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(r,s){if(r.elevation&&r.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(r,s.x,s.y);const h=r.horizonLineFromTop();return s.y<h}createInversionMatrix(r,s){return ine}createTileMatrix(r,s,h){let p,_,x;const E=h.canonical,O=q(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=kb(E,this);p=1,_=R.x+h.wrap*R.scale,x=R.y,re(O,O,[p/R.scale,p/R.scale,r.pixelsPerMeter/s])}else p=s/r.zoomScale(E.z),_=(E.x+Math.pow(2,E.z)*h.wrap)*p,x=E.y*p;return ee(O,O,[_,x,0]),re(O,O,[p/nn,p/nn,1]),O}upVector(r,s,h){return[0,0,1]}upVectorScale(r,s,h){return{metersToTile:1}}}class ane extends Gg{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[s,h]=this.parallels=r.parallels||[29.5,45.5],p=Math.sin(hr(s));this.n=(p+Math.sin(hr(h)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(r,s){const{n:h,c:p,r0:_}=this,x=hr(r-this.center[0]),E=hr(s),O=Math.sqrt(p-2*h*Math.sin(E))/h;return{x:O*Math.sin(x*h),y:O*Math.cos(x*h)-_,z:0}}unproject(r,s){const{n:h,c:p,r0:_}=this,x=_+s;let E=Math.atan2(r,Math.abs(x))*Math.sign(x);x*h<0&&(E-=Math.PI*Math.sign(r)*Math.sign(x));const O=hr(this.center[0])*h;E=wt(E,-Math.PI-O,Math.PI-O);const R=Pe(ot(E/h)+this.center[0],-180,180),z=Math.asin(Pe((p-(r*r+x*x)*h*h)/(2*h),-1,1)),j=Pe(ot(z),-ke,ke);return new U(R,j)}}const Lb=1.340264,Nb=-.081106,zb=893e-6,jb=.003796,iT=Math.sqrt(3)/2;class one extends Gg{project(r,s){s=s/180*Math.PI,r=r/180*Math.PI;const h=Math.asin(iT*Math.sin(s)),p=h*h,_=p*p*p;return{x:.5*(r*Math.cos(h)/(iT*(Lb+3*Nb*p+_*(7*zb+9*jb*p)))/Math.PI+.5),y:1-.5*(h*(Lb+Nb*p+_*(zb+jb*p))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let h=s=(2*(1-s)-1)*Math.PI,p=h*h,_=p*p*p;for(let z,j,B,X=0;X<12&&(j=h*(Lb+Nb*p+_*(zb+jb*p))-s,B=Lb+3*Nb*p+_*(7*zb+9*jb*p),z=j/B,h=Pe(h-z,-Math.PI/3,Math.PI/3),p=h*h,_=p*p*p,!(Math.abs(z)<1e-12));++X);const x=iT*r*(Lb+3*Nb*p+_*(7*zb+9*jb*p))/Math.cos(h),E=Math.asin(Math.sin(h)/iT),O=Pe(180*x/Math.PI,-180,180),R=Pe(180*E/Math.PI,-ke,ke);return new U(O,R)}}class sne extends Gg{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){return{x:.5+r/360,y:.5-s/360,z:0}}unproject(r,s){const h=360*(r-.5),p=Pe(360*(.5-s),-ke,ke);return new U(h,p)}}const tx=Math.PI/2;function aT(l){return Math.tan((tx+l)/2)}class lne extends Gg{constructor(r){super(r),this.center=r.center||[0,30];const[s,h]=this.parallels=r.parallels||[30,30];let p=hr(s),_=hr(h);this.southernCenter=p+_<0,this.southernCenter&&(p=-p,_=-_);const x=Math.cos(p),E=aT(p);this.n=p===_?Math.sin(p):Math.log(x/Math.cos(_))/Math.log(aT(_)/E),this.f=x*Math.pow(aT(p),this.n)/this.n}project(r,s){s=hr(s),this.southernCenter&&(s=-s),r=hr(r-this.center[0]);const h=1e-6,{n:p,f:_}=this;_>0?s<-tx+h&&(s=-tx+h):s>tx-h&&(s=tx-h);const x=_/Math.pow(aT(s),p);let E=x*Math.sin(p*r),O=_-x*Math.cos(p*r);return E=.5*(E/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:E,y:this.southernCenter?O:1-O,z:0}}unproject(r,s){r=(2*r-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:h,f:p}=this,_=p-s,x=Math.sign(_),E=Math.sign(h)*Math.sqrt(r*r+_*_);let O=Math.atan2(r,Math.abs(_))*x;_*h<0&&(O-=Math.PI*Math.sign(r)*x);const R=Pe(ot(O/h)+this.center[0],-180,180),z=Pe(ot(2*Math.atan(Math.pow(p/E,1/h))-tx),-ke,ke);return new U(R,this.southernCenter?-z:z)}}class J3 extends Gg{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,s){return{x:oe(r),y:ue(s),z:0}}unproject(r,s){const h=xe(r),p=Te(s);return new U(h,p)}}const Q3=hr(ke);class cne extends Gg{project(r,s){const h=(s=hr(s))*s,p=h*h;return{x:.5*((r=hr(r))*(.8707-.131979*h+p*(p*(.003971*h-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+h*(.015085+p*(.028874*h-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let h=s=(2*(1-s)-1)*Math.PI,p=25,_=0,x=h*h;do{x=h*h;const R=x*x;_=(h*(1.007226+x*(.015085+R*(.028874*x-.044475-.005916*R)))-s)/(1.007226+x*(.045255+R*(.259866*x-.311325-.005916*11*R))),h=Pe(h-_,-Q3,Q3)}while(Math.abs(_)>1e-6&&--p>0);x=h*h;const E=Pe(ot(r/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),O=ot(h);return new U(E,O)}}const eB=hr(ke);class une extends Gg{project(r,s){s=hr(s),r=hr(r);const h=Math.cos(s),p=2/Math.PI,_=Math.acos(h*Math.cos(r/2)),x=Math.sin(_)/_,E=.5*(r*p+2*h*Math.sin(r/2)/x)||0,O=.5*(s+Math.sin(s)/x)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(r,s){let h=r=(2*r-.5)*Math.PI,p=s=(2*(1-s)-1)*Math.PI,_=25;const x=1e-6;let E=0,O=0;do{const R=Math.cos(p),z=Math.sin(p),j=2*z*R,B=z*z,X=R*R,Z=Math.cos(h/2),ae=Math.sin(h/2),se=2*Z*ae,pe=ae*ae,we=1-X*Z*Z,be=we?1/we:0,Ee=we?Math.acos(R*Z)*Math.sqrt(1/we):0,Ge=.5*(2*Ee*R*ae+2*h/Math.PI)-r,Ue=.5*(Ee*z+p)-s,$e=.5*be*(X*pe+Ee*R*Z*B)+1/Math.PI,Je=be*(se*j/4-Ee*z*ae),it=.125*be*(j*ae-Ee*z*X*se),Mt=.5*be*(B*Z+Ee*pe*R)+.5,ut=Je*it-Mt*$e;E=(Ue*Je-Ge*Mt)/ut,O=(Ge*it-Ue*$e)/ut,h=Pe(h-E,-Math.PI,Math.PI),p=Pe(p-O,-eB,eB)}while((Math.abs(E)>x||Math.abs(O)>x)&&--_>0);return new U(ot(h),ot(p))}}class tB extends Gg{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(hr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){const{scale:h,cosPhi:p}=this;return{x:hr(r)*p*h+.5,y:-Math.sin(hr(s))/p*h+.5,z:0}}unproject(r,s){const{scale:h,cosPhi:p}=this,_=-(s-.5)/h,x=Pe(ot((r-.5)/h)/p,-180,180),E=Math.asin(Pe(_*p,-1,1)),O=Pe(ot(E),-ke,ke);return new U(x,O)}}class hne extends J3{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,s,h){const p=Vf(r,s,h);return En(p,p,fm(iu(h))),{x:p[0],y:p[1],z:p[2]}}locationPoint(r,s,h){const p=I(s.lat,s.lng),_=qt([],p),x=h?r._centerAltitude+h:r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(s),r._centerAltitude):r._centerAltitude;nt(p,p,_,de(1,0)*nn*x);const E=q(new Float64Array(16));return J(E,r.pixelMatrix,r.globeMatrix),En(p,p,E),new kt(p[0],p[1])}pixelsPerMeter(r,s){return de(1,0)*s}pixelSpaceConversion(r,s,h){const p=de(1,r)*s,_=Gn(de(1,45)*s,p,h);return this.pixelsPerMeter(r,s)/_}createTileMatrix(r,s,h){const p=c_(iu(h.canonical));return J(new Float64Array(16),r.globeMatrix,p)}createInversionMatrix(r,s){const{center:h}=r,p=fm(iu(s));return ne(p,p,hr(h.lng)),fe(p,p,hr(h.lat)),re(p,p,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(r,s,h,p){return G0(r,s,h,!0)||new je(0,0)}pointCoordinate3D(r,s,h){const p=this.pointCoordinate(r,s,h,0);return[p.x,p.y,p.z]}isPointAboveHorizon(r,s){return!G0(r,s.x,s.y,!1)}farthestPixelDistance(r){const s=(function(p,_){const x=p.cameraToCenterDistance,E=p._centerAltitude*_,O=p._camera,R=p._camera.forward(),z=Ie([],vt([],R,-x),[0,0,E]),j=p.worldSize/(2*Math.PI),B=[0,0,-j],X=p.width/p.height,Z=Math.tan(p.fovAboveCenter),ae=vt([],O.up(),Z),se=vt([],O.right(),Z*X),pe=qt([],Ie([],Ie([],R,ae),se)),we=[];let be;if(new kr(z,pe).closestPointOnSphere(B,j,we)){const Ee=Ie([],we,B),Ge=Cr([],Ee,z);be=Math.cos(p.fovAboveCenter)*at(Ge)}else{const Ee=Cr([],z,B),Ge=Cr([],B,z);qt(Ge,Ge);const Ue=at(Ee)-j;be=Math.sqrt(Ue*(Ue+2*j));const $e=Math.acos(be/(j+Ue))-Math.acos(Ht(R,Ge));be*=Math.cos($e)}return 1.01*be})(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),h=Uf(r.zoom);if(h>0){const p=Y3(r,de(1,r.center.lat)*r.worldSize),_=r.worldSize/(2*Math.PI),x=Math.max(r.width,r.height)/r.worldSize*Math.PI;return Gn(s,p+_*(1-Math.cos(x)),Math.pow(h,10))}return s}upVector(r,s,h){return Vf(s,h,r,1)}upVectorScale(r){return{metersToTile:l_(Rd(iu(r)))}}}function nB(l){const r=l.parallels,s=!!r&&Math.abs(r[0]+r[1])<.01;switch(l.name){case"mercator":return new J3(l);case"equirectangular":return new sne(l);case"naturalEarth":return new cne(l);case"equalEarth":return new one(l);case"winkelTripel":return new une(l);case"albers":return s?new tB(l):new ane(l);case"lambertConformalConic":return s?new tB(l):new lne(l);case"globe":return new hne(l)}throw new Error(`Invalid projection name: ${l.name}`)}const dne=mt.types,fne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function oT(l,r,s,h,p,_,x,E,O,R,z,j,B){const X=E?Math.min(Hg,Math.round(E[0])):0,Z=E?Math.min(Hg,Math.round(E[1])):0;l.emplaceBack(r,s,Math.round(32*h),Math.round(32*p),_,x,(X<<1)+(O?1:0),Z,16*R,16*z,256*j,256*B)}function sT(l,r,s){l.emplaceBack(r,s)}function lT(l,r,s,h,p,_,x){l.emplaceBack(r,s,h,p,_,x)}const cT=(l,r,s,h)=>{for(let p=0;p<r;p++)l.emplaceBack(s[0],s[1],s[2],h[0],h[1],h[2])};function uT(l,r,s,h,p){l.emplaceBack(r,s,h,p),l.emplaceBack(r,s,h,p),l.emplaceBack(r,s,h,p),l.emplaceBack(r,s,h,p)}function pne(l){for(const r of l.sections)if(mv(r.text))return!0;return!1}class iM{constructor(r){this.layoutVertexArray=new tm,this.indexArray=new Zr,this.programConfigurations=r,this.segments=new Ki,this.dynamicLayoutVertexArray=new Bu,this.opacityVertexArray=new ml,this.placedSymbolArray=new To,this.iconTransitioningVertexArray=new Qo,this.globeExtVertexArray=new Ec,this.zOffsetVertexArray=new kh,this.orientationVertexArray=new im}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(r,s,h,p,_){this.isEmpty()||(h&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,vte.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,bte.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,fne,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=r.createVertexBuffer(this.iconTransitioningVertexArray,Tte.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,xte.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||_)&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,wte.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=r.createVertexBuffer(this.orientationVertexArray,Ste.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Rn(iM,"SymbolBuffers");class aM{constructor(r,s,h){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new h,this.segments=new Ki,this.collisionVertexArray=new gl,this.collisionVertexArrayExt=new Bu}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,Ete.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,Ate.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Rn(aM,"CollisionBuffers");class hT{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.lut=r.lut,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((x=>x.fqid)),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=q([]),this.placementViewportMatrix=q([]);const s=this.layers[0]._unevaluatedLayout._values;this.worldview=r.worldview,this.textSizeData=R3(this.zoom,s["text-size"],this.worldview),this.iconSizeData=R3(this.zoom,s["icon-size"],this.worldview);const h=this.layers[0].layout,p=h.get("symbol-sort-key"),_=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map((x=>Pc[x])),this.stateDependentLayerIds=this.layers.filter((x=>x.isStateDependent())).map((x=>x.id)),this.sourceID=r.sourceID,this.projection=r.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new iM(new Ks(this.layers,{zoom:this.zoom,lut:this.lut},(r=>r.startsWith("text")||r.startsWith("symbol")))),this.icon=new iM(new Ks(this.layers,{zoom:this.zoom,lut:this.lut},(r=>r.startsWith("icon")||r.startsWith("symbol")))),this.glyphOffsetArray=new Ag,this.lineVertexArray=new Qy,this.symbolInstances=new Jy}calculateGlyphDependencies(r,s,h,p,_){for(const x of r){const E=x.codePointAt(0);if(E===void 0)break;if(s[E]=!0,p&&_&&E<=65535){const O=Mb[x];O&&(s[O.charCodeAt(0)]=!0)}}}updateFootprints(r,s){}updateReplacement(r,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(r.toUnwrapped(),!0);return!Fv(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(r,s,h,p){const _=this.layers[0],x=_.layout,E=this.projection.name==="globe",O=x.get("text-font"),R=x.get("text-field"),z=x.get("icon-image"),[j,B]=x.get("icon-size-scale-range"),X=Pe(s.scaleFactor||1,j,B),Z=(R.value.kind!=="constant"||R.value.value instanceof Ko&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),ae=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,se=x.get("symbol-sort-key");if(this.features=[],!Z&&!ae)return;const pe=s.iconDependencies,we=s.glyphDependencies,be=s.availableImages,Ee=new Ei(this.zoom,{worldview:this.worldview});for(const{feature:Ge,id:Ue,index:$e,sourceLayerIndex:Je}of r){const it=_._featureFilter.needGeometry,Mt=Tt(Ge,it);if(!_._featureFilter.filter(Ee,Mt,h))continue;if(it||(Mt.geometry=We(Ge,h,p)),E&&Ge.type!==1&&h.z<=5){const Yt=Mt.geometry,on=.98078528056,At=(Kt,pt)=>Ht(Vf(Kt.x,Kt.y,h,1),Vf(pt.x,pt.y,h,1))<on;for(let Kt=0;Kt<Yt.length;Kt++)Yt[Kt]=_t(Yt[Kt],At)}let ut,Dt;if(Z){const Yt=_.getValueAndResolveTokens("text-field",Mt,h,be),on=Ko.factory(Yt);pne(on)&&(this.hasRTLText=!0),(!this.hasRTLText||Hy()==="unavailable"||this.hasRTLText&&Sc.isParsed())&&(ut=Mte(on,_,Mt))}if(ae){const Yt=_.getValueAndResolveTokens("icon-image",Mt,h,be);Dt=typeof Yt=="string"?wo.build(Yt):Yt}if(!ut&&!Dt)continue;const ln=this.sortFeaturesByKey?se.evaluate(Mt,{},h):void 0,Vt={id:Ue,text:ut,icon:Dt,index:$e,sourceLayerIndex:Je,geometry:Mt.geometry,properties:Ge.properties,type:dne[Ge.type],sortKey:ln};if(this.features.push(Vt),Dt){const Yt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:on,iconSecondary:At}=G3(Dt,this.iconSizeData,Yt["icon-size"],h,this.zoom,Vt,this.pixelRatio,X,this.worldview),Kt=on.id.toString();if(pe.has(Kt)?pe.get(Kt).push(on):pe.set(Kt,[on]),At){this.hasAnySecondaryIcon=!0;const pt=At.id.toString();pe.has(pt)?pe.get(pt).push(At):pe.set(pt,[At])}}if(ut){const Yt=O.evaluate(Mt,{},h).join(","),on=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Pc.vertical)>=0;for(const At of ut.sections)if(At.image){const Kt=At.image.getPrimary().scaleSelf(this.pixelRatio),pt=Kt.id.toString(),Ct=pe.get(pt)||[];Ct.push(Kt),pe.set(pt,Ct)}else{const Kt=Hp(ut.toString()),pt=At.fontStack||Yt,Ct=we[pt]=we[pt]||{};this.calculateGlyphDependencies(At.text,Ct,on,this.allowVerticalPlacement,Kt)}}}if(x.get("symbol-placement")==="line"&&(this.features=(function(Ge){const Ue={},$e={},Je=[];let it=0;function Mt(Vt){Je.push(Ge[Vt]),it++}function ut(Vt,Yt,on){const At=$e[Vt];return delete $e[Vt],$e[Yt]=At,Je[At].geometry[0].pop(),Je[At].geometry[0]=Je[At].geometry[0].concat(on[0]),At}function Dt(Vt,Yt,on){const At=Ue[Yt];return delete Ue[Yt],Ue[Vt]=At,Je[At].geometry[0].shift(),Je[At].geometry[0]=on[0].concat(Je[At].geometry[0]),At}function ln(Vt,Yt,on){const At=on?Yt[0][Yt[0].length-1]:Yt[0][0];return`${Vt}:${At.x}:${At.y}`}for(let Vt=0;Vt<Ge.length;Vt++){const Yt=Ge[Vt],on=Yt.geometry,At=Yt.text?Yt.text.toString():null;if(!At){Mt(Vt);continue}const Kt=ln(At,on),pt=ln(At,on,!0);if(Kt in $e&&pt in Ue&&$e[Kt]!==Ue[pt]){const Ct=Dt(Kt,pt,on),un=ut(Kt,pt,Je[Ct].geometry);delete Ue[Kt],delete $e[pt],$e[ln(At,Je[un].geometry,!0)]=un,Je[Ct].geometry=null}else Kt in $e?ut(Kt,pt,on):pt in Ue?Dt(Kt,pt,on):(Mt(Vt),Ue[Kt]=it-1,$e[pt]=it-1)}return Je.filter((Vt=>Vt.geometry))})(this.features)),x.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",s.elevationFeatures){!this.elevationFeatures&&s.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Ge of s.elevationFeatures)this.elevationFeatureIdToIndex.set(Ge.id,this.elevationFeatures.length),this.elevationFeatures.push(Ge)}}else x.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort(((Ge,Ue)=>Ge.sortKey-Ue.sortKey))}update(r,s,h,p,_,x,E){this.text.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E,this.worldview),this.icon.programConfigurations.updatePaintArrays(r,s,_,h,p,x,E,this.worldview)}updateRoadElevation(r){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let s=!1;const h=Ne(r),p=1/h;let _=!1,x=!1;for(let E=0;E<this.symbolInstances.length;E++){const O=this.symbolInstances.get(E),R=ct(1,0,0),z=ct(0,1,0),{numHorizontalGlyphVertices:j,numVerticalGlyphVertices:B,numIconVertices:X,numVerticalIconVertices:Z}=O,ae=j>0||B>0,se=X>0,pe=this.elevationFeatures[O.elevationFeatureIndex];if(pe){const we=new kt(O.tileAnchorX,O.tileAnchorY),be=.075+pe.pointElevation(we);O.zOffset!==be&&(s=!0,O.zOffset=be);const Ee=pe.computeSlopeNormal(we,p),Ge=_o(tn(),ct(0,0,1),Ee);cn(R,R,Ge),cn(z,z,Ge),R[2]*=h,z[2]*=h,R[0]===1&&R[1]===0&&R[2]===0&&z[0]===0&&z[1]===1&&z[2]===0||(_=_||ae,x=x||se)}if(ae&&(cT(this.text.orientationVertexArray,j,R,z),cT(this.text.orientationVertexArray,B,R,z)),se){const{placedIconSymbolIndex:we,verticalPlacedIconSymbolIndex:be}=O;we>=0&&cT(this.icon.orientationVertexArray,X,R,z),be>=0&&cT(this.icon.orientationVertexArray,Z,R,z)}}_||(this.text.orientationVertexArray=void 0),x||(this.icon.orientationVertexArray=void 0),s&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const r=(_,x,E)=>{h+=x,h>_.length&&_.resize(h);for(let O=-x;O<0;O++)_.emplace(O+h,E)},s=(_,x,E)=>{p+=x,p>_.length&&_.resize(p);for(let O=-x;O<0;O++)_.emplace(O+p,E)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,p=0;for(let _=0;_<this.symbolInstances.length;_++){const x=this.symbolInstances.get(_),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:O,numIconVertices:R}=x,z=x.zOffset,j=R>0;if((E>0||O>0)&&(r(this.text.zOffsetVertexArray,E,z),r(this.text.zOffsetVertexArray,O,z)),j){const{placedIconSymbolIndex:B,verticalPlacedIconSymbolIndex:X}=x;B>=0&&s(this.icon.zOffsetVertexArray,R,z),X>=0&&s(this.icon.zOffsetVertexArray,x.numVerticalIconVertices,z)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=nB(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const h=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:p,y:_}of s)this.lineVertexArray.emplaceBack(p,_);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae,se){const pe=r.indexArray,we=r.layoutVertexArray,be=r.globeExtVertexArray,Ee=r.segments.prepareSegment(4*s.length,we,pe,this.canOverlap?x.sortKey:void 0),Ge=this.glyphOffsetArray.length,Ue=Ee.vertexLength,$e=this.allowVerticalPlacement&&E===Pc.vertical?Math.PI/2:0,Je=x.text&&x.text.sections;for(let Mt=0;Mt<s.length;Mt++){const{tl:ut,tr:Dt,bl:ln,br:Vt,texPrimary:Yt,texSecondary:on,pixelOffsetTL:At,pixelOffsetBR:Kt,minFontScaleX:pt,minFontScaleY:Ct,glyphOffset:un,isSDF:Qt,sectionIndex:Un}=s[Mt],kn=Ee.vertexLength,Xt=un[1];if(oT(we,R.x,R.y,ut.x,Xt+ut.y,Yt.x,Yt.y,h,Qt,At.x,At.y,pt,Ct),oT(we,R.x,R.y,Dt.x,Xt+Dt.y,Yt.x+Yt.w,Yt.y,h,Qt,Kt.x,At.y,pt,Ct),oT(we,R.x,R.y,ln.x,Xt+ln.y,Yt.x,Yt.y+Yt.h,h,Qt,At.x,Kt.y,pt,Ct),oT(we,R.x,R.y,Vt.x,Xt+Vt.y,Yt.x+Yt.w,Yt.y+Yt.h,h,Qt,Kt.x,Kt.y,pt,Ct),O){const{x:an,y:Nn,z:Cn}=O.anchor,[pn,On,Jn]=O.up;lT(be,an,Nn,Cn,pn,On,Jn),lT(be,an,Nn,Cn,pn,On,Jn),lT(be,an,Nn,Cn,pn,On,Jn),lT(be,an,Nn,Cn,pn,On,Jn),uT(r.dynamicLayoutVertexArray,an,Nn,Cn,$e)}else uT(r.dynamicLayoutVertexArray,R.x,R.y,R.z,$e);if(se){const an=on||Yt;sT(r.iconTransitioningVertexArray,an.x,an.y),sT(r.iconTransitioningVertexArray,an.x+an.w,an.y),sT(r.iconTransitioningVertexArray,an.x,an.y+an.h),sT(r.iconTransitioningVertexArray,an.x+an.w,an.y+an.h)}pe.emplaceBack(kn,kn+1,kn+2),pe.emplaceBack(kn+1,kn+2,kn+3),Ee.vertexLength+=4,Ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(un[0]),Mt!==s.length-1&&Un===s[Mt+1].sectionIndex||r.programConfigurations.populatePaintArrays(we.length,x,x.index,{},X,Z,ae,Je&&Je[Un],this.worldview)}const it=O?O.anchor:R;r.placedSymbolArray.emplaceBack(it.x,it.y,it.z,R.x,R.y,Ge,this.glyphOffsetArray.length-Ge,Ue,z,j,R.segment,h?h[0]:0,h?h[1]:0,p[0],p[1],E,0,0,0,B,0)}_commitLayoutVertex(r,s,h,p,_,x,E){r.emplaceBack(s,h,p,_,x,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(r,s,h,p,_,x,E){const O=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),R=O.vertexLength,z=E.tileAnchorX,j=E.tileAnchorY;for(let X=0;X<4;X++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,s,r.padding,E.zOffset),this._commitLayoutVertex(h.layoutVertexArray,p,_,x,z,j,new kt(r.x1,r.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,_,x,z,j,new kt(r.x2,r.y1)),this._commitLayoutVertex(h.layoutVertexArray,p,_,x,z,j,new kt(r.x2,r.y2)),this._commitLayoutVertex(h.layoutVertexArray,p,_,x,z,j,new kt(r.x1,r.y2)),O.vertexLength+=4;const B=h.indexArray;B.emplaceBack(R,R+1),B.emplaceBack(R+1,R+2),B.emplaceBack(R+2,R+3),B.emplaceBack(R+3,R),O.primitiveLength+=4}_addTextDebugCollisionBoxes(r,s,h,p,_,x){for(let E=p;E<_;E++){const O=h.get(E),R=this.getSymbolInstanceTextSize(r,x,s,E);this._addCollisionDebugVertices(O,R,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(r,s,h,p,_,x){for(let E=p;E<_;E++){const O=h.get(E),R=this.getSymbolInstanceIconSize(r,s,x.placedIconSymbolIndex);this._addCollisionDebugVertices(O,R,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,x)}}generateCollisionDebugBuffers(r,s,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new aM(nm,g3.members,Qo),this.iconCollisionBox=new aM(nm,g3.members,Qo);const p=Ob(this.iconSizeData,r),_=Ob(this.textSizeData,r,h);for(let x=0;x<this.symbolInstances.length;x++){const E=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(_,r,s,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(_,r,s,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,r,s,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(p,r,s,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(r,s,h,p){const _=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:p),x=KC(this.textSizeData,r,_)/ds;return this.tilePixelRatio*x}getSymbolInstanceIconSize(r,s,h){const p=this.icon.placedSymbolArray.get(h),_=KC(this.iconSizeData,r,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(r,s,h,p){r.emplaceBack(s,-h,-h,p),r.emplaceBack(s,h,-h,p),r.emplaceBack(s,h,h,p),r.emplaceBack(s,-h,h,p)}_updateTextDebugCollisionBoxes(r,s,h,p,_,x,E){for(let O=p;O<_;O++){const R=h.get(O),z=this.getSymbolInstanceTextSize(r,x,s,O);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,z,R.padding,x.zOffset)}}_updateIconDebugCollisionBoxes(r,s,h,p,_,x,E){for(let O=p;O<_;O++){const R=h.get(O),z=this.getSymbolInstanceIconSize(r,s,x.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,z,R.padding,x.zOffset)}}updateCollisionDebugBuffers(r,s,h,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=Ob(this.iconSizeData,r,p),x=Ob(this.textSizeData,r,h);for(let E=0;E<this.symbolInstances.length;E++){const O=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(x,r,s,O.textBoxStartIndex,O.textBoxEndIndex,O,h),this._updateTextDebugCollisionBoxes(x,r,s,O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,h),this._updateIconDebugCollisionBoxes(_,r,s,O.iconBoxStartIndex,O.iconBoxEndIndex,O,p),this._updateIconDebugCollisionBoxes(_,r,s,O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,s,h,p,_,x,E,O,R){const z={};if(s<h){const{x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee,featureIndex:Ge}=r.get(s);z.textBox={x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee},z.textFeatureIndex=Ge}if(p<_){const{x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee,featureIndex:Ge}=r.get(p);z.verticalTextBox={x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee},z.verticalTextFeatureIndex=Ge}if(x<E){const{x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee,featureIndex:Ge}=r.get(x);z.iconBox={x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee},z.iconFeatureIndex=Ge}if(O<R){const{x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee,featureIndex:Ge}=r.get(O);z.verticalIconBox={x1:j,y1:B,x2:X,y2:Z,padding:ae,projectedAnchorX:se,projectedAnchorY:pe,projectedAnchorZ:we,tileAnchorX:be,tileAnchorY:Ee},z.verticalIconFeatureIndex=Ge}return z}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const h=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(r,s){const h=r.placedSymbolArray.get(s),p=h.vertexStartIndex+4*h.numGlyphs;for(let _=h.vertexStartIndex;_<p;_+=4)r.indexArray.emplaceBack(_,_+1,_+2),r.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),h=Math.cos(r),p=[],_=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const O=this.symbolInstances.get(E);p.push(0|Math.round(s*O.tileAnchorX+h*O.tileAnchorY)),_.push(O.featureIndex)}return x.sort(((E,O)=>p[E]-p[O]||_[O]-_[E])),x}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let r=0;r<this.symbolInstances.length;++r)this.symbolInstanceIndexesSortedZOffset.push(r)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((r,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(r).zOffset))}addToSortKeyRanges(r,s){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===s?h.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const h=this.symbolInstances.get(s);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:R}=h;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),x>=0&&x!==_&&x!==p&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let rB,iB,oM;Rn(hT,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),hT.addDynamicAttributes=uT;class aB{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:ph,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rn(aB,"FormatSectionOverride",{omit:["defaultValue"]});const sM=()=>oM||(oM={layout:rB||(rB=new la({"symbol-placement":new Jt(st.layout_symbol["symbol-placement"]),"symbol-spacing":new Jt(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jt(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wn(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jt(st.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Jt(st.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Jt(st.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Jt(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jt(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jt(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jt(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new wn(st.layout_symbol["icon-size"]),"icon-size-scale-range":new Jt(st.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new wn(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wn(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new wn(st.layout_symbol["icon-image"]),"icon-rotate":new wn(st.layout_symbol["icon-rotate"]),"icon-padding":new Jt(st.layout_symbol["icon-padding"]),"icon-keep-upright":new Jt(st.layout_symbol["icon-keep-upright"]),"icon-offset":new wn(st.layout_symbol["icon-offset"]),"icon-anchor":new wn(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jt(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jt(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jt(st.layout_symbol["text-rotation-alignment"]),"text-field":new wn(st.layout_symbol["text-field"]),"text-font":new wn(st.layout_symbol["text-font"]),"text-size":new wn(st.layout_symbol["text-size"]),"text-size-scale-range":new Jt(st.layout_symbol["text-size-scale-range"]),"text-max-width":new wn(st.layout_symbol["text-max-width"]),"text-line-height":new wn(st.layout_symbol["text-line-height"]),"text-letter-spacing":new wn(st.layout_symbol["text-letter-spacing"]),"text-justify":new wn(st.layout_symbol["text-justify"]),"text-radial-offset":new wn(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jt(st.layout_symbol["text-variable-anchor"]),"text-anchor":new wn(st.layout_symbol["text-anchor"]),"text-max-angle":new Jt(st.layout_symbol["text-max-angle"]),"text-writing-mode":new Jt(st.layout_symbol["text-writing-mode"]),"text-rotate":new wn(st.layout_symbol["text-rotate"]),"text-padding":new Jt(st.layout_symbol["text-padding"]),"text-keep-upright":new Jt(st.layout_symbol["text-keep-upright"]),"text-transform":new wn(st.layout_symbol["text-transform"]),"text-offset":new wn(st.layout_symbol["text-offset"]),"text-allow-overlap":new Jt(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jt(st.layout_symbol["text-ignore-placement"]),"text-optional":new Jt(st.layout_symbol["text-optional"]),visibility:new Jt(st.layout_symbol.visibility)})),paint:iB||(iB=new la({"icon-opacity":new wn(st.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new wn(st.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new wn(st.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new wn(st.paint_symbol["text-emissive-strength"]),"icon-color":new wn(st.paint_symbol["icon-color"]),"icon-halo-color":new wn(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new wn(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wn(st.paint_symbol["icon-halo-blur"]),"icon-translate":new Jt(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jt(st.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Jt(st.paint_symbol["icon-image-cross-fade"]),"text-opacity":new wn(st.paint_symbol["text-opacity"]),"text-occlusion-opacity":new wn(st.paint_symbol["text-occlusion-opacity"]),"text-color":new wn(st.paint_symbol["text-color"],{runtimeType:cs,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new wn(st.paint_symbol["text-halo-color"]),"text-halo-width":new wn(st.paint_symbol["text-halo-width"]),"text-halo-blur":new wn(st.paint_symbol["text-halo-blur"]),"text-translate":new Jt(st.paint_symbol["text-translate"]),"text-translate-anchor":new Jt(st.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Jt(st.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Jt(st.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Jt(st.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Jt(st.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new wn(st.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},oM);class dT extends vs{constructor(r,s,h,p){super(r,sM(),s,h,p),this._colorAdjustmentMatrix=q([]),this.hasInitialOcclusionOpacityProperties=r.paint!==void 0&&("icon-occlusion-opacity"in r.paint||"text-occlusion-opacity"in r.paint)}recalculate(r,s){super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const p=[];for(const _ of h)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(r,s,h,p){return this._saturation===r&&this._contrast===s&&this._brightnessMin===h&&this._brightnessMax===p||(this._colorAdjustmentMatrix=(function(_,x,E,O){_=uo(_),x=Xa(x);const R=G(),z=_/3,j=1-2*z,B=[j,z,z,0,z,j,z,0,z,z,j,0,0,0,0,1],X=.5-.5*x,Z=O-E;return J(R,[Z,0,0,0,0,Z,0,0,0,0,Z,0,E,E,E,1],[x,0,0,0,0,x,0,0,0,0,x,0,X,X,X,1]),J(R,R,B),R})(r,s,h,p),this._saturation=r,this._contrast=s,this._brightnessMin=h,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(r,s,h,p){const _=this.layout.get(r).evaluate(s,{},h,p),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||wf(x.value)||!_?_:(function(E,O){return O.replace(/{([^{}]+)}/g,((R,z)=>z in E?String(E[z]):""))})(s.properties,_)}createBucket(r){return new hT(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of sM().paint.overridableProperties){if(!dT.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),h=new aB(s),p=new So(h,s.property.specification,this.scope,this.options);let _=null;_=s.value.kind==="constant"||s.value.kind==="source"?new tu("source",p):new bc("composite",p,s.value.zoomStops,s.value.interpolationType),this.paint._values[r]=new bd(s.property,_,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,h){return!(!this.layout||s.isDataDriven()||h.isDataDriven())&&dT.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const h=r.get("text-field"),p=sM().paint.properties[s];let _=!1;const x=E=>{for(const O of E)if(p.overrides&&p.overrides.hasOverride(O))return void(_=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Ko)x(h.value.value.sections);else if(h.value.kind==="source"){const E=R=>{_||(R instanceof er&&Tn(R.value)===_e?x(R.value.sections):R instanceof Pl?x(R.sections):R.eachChild(E))},O=h.value;O._styleExpression&&E(O._styleExpression.expression)}return _}getProgramIds(){return["symbol"]}getDefaultProgramParams(r,s,h){return{config:new xs(this,{zoom:s,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let oB,sB,lB,cB;var lM=Ur([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function fT(l,r,s,h,p,_,x,E){const O=[l,r,1,s,h,1,p,_,1],R=[x,E,1],z=N([],O),[j,B,X]=Xn(R,R,z);return $(O,O,[j,0,0,0,B,0,0,0,X])}function uB(l,r,s,h,p,_,x,E){const O=(function(R,z,j,B,X,Z,ae,se){const pe=fT(0,0,1,0,1,1,0,1),we=fT(R,z,j,B,X,Z,ae,se);return $(we,we,N([],pe))})(l,r,s,h,p,_,x,E);return[O[2]/O[8]/nn,O[5]/O[8]/nn]}function pT(l){return[l[0],Math.min(Math.max(l[1],-ke),ke)]}class hB extends yu{constructor(r,s,h,p){super(),this.id=r,this.dispatcher=h,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=s,this._dirty=!1}load(r,s){if(this._loaded=s||!1,this.fire(new Cl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return r&&(this.coordinates=r),this._loaded=!0,void this._finishLoading();this._imageRequest=Fc(this.map._requestManager.transformRequest(this.url,uh.Image),((h,p)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new Yo(h)):p&&(this.image=p instanceof HTMLImageElement?ls.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading())}))}loaded(){return this._loaded}updateImage(r){return r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}setTexture(r){if(!(r.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Eb(this.map.painter.context,r.handle),this.width=r.dimensions[0],this.height=r.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Cl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(r){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Eb||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(r){if(this.coordinates=r,this._boundsArray=void 0,this._unsupportedCoords=!1,!r.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=r[0][1],h=r[0][1];for(const _ of r)_[1]>h&&(h=_[1]),_[1]<s&&(s=_[1]);const p=(h+s)/2;if(p>ke?this.onNorthPole=!0:p<-ke&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const _=r.map(je.fromLngLat);this.tileID=(function(x){let E=1/0,O=1/0,R=-1/0,z=-1/0;for(const ae of x)E=Math.min(E,ae.x),O=Math.min(O,ae.y),R=Math.max(R,ae.x),z=Math.max(z,ae.y);const j=Math.max(R-E,z-O),B=Math.max(0,Math.floor(-Math.log(j)/Math.LN2)),X=Math.pow(2,B);let Z=Math.floor((E+R)/2*X);return Z>1&&(Z-=1),new vl(B,Z,Math.floor((O+z)/2*X))})(_),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Cl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof Eb||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(r){for(const pe in this.tiles){const we=this.tiles[pe];we.state!=="loaded"&&(we.state="loaded",we.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=kb(new vl(0,0,0),this.map.transform.projection),h=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!(function(pe){const we=pe[1].x-pe[0].x,be=pe[1].y-pe[0].y,Ee=pe[2].x-pe[1].x,Ge=pe[2].y-pe[1].y,Ue=pe[3].x-pe[2].x,$e=pe[3].y-pe[2].y,Je=pe[0].x-pe[3].x,it=pe[0].y-pe[3].y,Mt=we*Ge-Ee*be,ut=Ee*$e-Ue*Ge,Dt=Ue*it-Je*$e,ln=Je*be-we*it;return Mt>0&&ut>0&&Dt>0&&ln>0||Mt<0&&ut<0&&Dt<0&&ln<0})(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=kb(this.tileID,this.map.transform.projection),[_,x,E,O]=this.coordinates.map((pe=>{const we=p.projection.project(pe[0],pe[1]);return K3(p,we)._round()}));this.perspectiveTransform=uB(_.x,_.y,x.x,x.y,E.x,E.y,O.x,O.y);const R=this._boundsArray=new Nu;R.emplaceBack(_.x,_.y,0,0),R.emplaceBack(x.x,x.y,nn,0),R.emplaceBack(O.x,O.y,0,nn),R.emplaceBack(E.x,E.y,nn,nn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=r.createVertexBuffer(R,lM.members),this.boundsSegments=Ki.simpleSegment(0,0,4,2);const z=[],j=[pT((B=this.coordinates)[0]),pT(B[1]),pT(B[2]),pT(B[3])];var B;const[X,Z,ae,se]=(function(pe){let we=pe[0][0],be=we,Ee=pe[0][1],Ge=Ee;for(let Ue=1;Ue<pe.length;Ue++)pe[Ue][0]<we?we=pe[Ue][0]:pe[Ue][0]>be&&(be=pe[Ue][0]),pe[Ue][1]<Ee?Ee=pe[Ue][1]:pe[Ue][1]>Ge&&(Ge=pe[Ue][1]);return[we,Ee,be-we,Ge-Ee]})(j);{const pe=new Nu,[we,be,Ee,Ge]=(function(At){let Kt=At[0].x,pt=Kt,Ct=At[0].y,un=Ct;for(let Qt=1;Qt<At.length;Qt++)At[Qt].x<Kt?Kt=At[Qt].x:At[Qt].x>pt&&(pt=At[Qt].x),At[Qt].y<Ct?Ct=At[Qt].y:At[Qt].y>un&&(un=At[Qt].y);return[Kt,Ct,pt-Kt,un-Ct]})(h),Ue=At=>[(At.x-we)/Ee,(At.y-be)/Ge],[$e,Je,it,Mt]=h.map(Ue),ut=(function(At,Kt,pt,Ct,un,Qt,Un,kn){const Xt=fT(0,0,1,0,1,1,0,1);return $(Xt,Xt,N([],fT(At,Kt,pt,Ct,un,Qt,Un,kn)))})($e[0],$e[1],Je[0],Je[1],it[0],it[1],Mt[0],Mt[1]);this.elevatedGlobePerspectiveTransform=uB($e[0],$e[1],Je[0],Je[1],it[0],it[1],Mt[0],Mt[1]);const Dt=(At,Kt)=>{z.push(At.lng);const pt=Math.round((At.lng-X)/ae*nn),Ct=Math.round((At.lat-Z)/se*nn),un=Ue(Kt),Qt=Xn([],[un[0],un[1],1],ut),Un=Math.round(Qt[0]/Qt[2]*nn),kn=Math.round(Qt[1]/Qt[2]*nn);pe.emplaceBack(pt,Ct,Un,kn)},ln=h[3].x-h[0].x,Vt=h[3].y-h[0].y,Yt=h[2].x-h[1].x,on=h[2].y-h[1].y;for(let At=0;At<65;At++){const Kt=At/64,pt=[h[0].x+Kt*ln,h[0].y+Kt*Vt],Ct=[h[1].x+Kt*Yt,h[1].y+Kt*on],un=Ct[0]-pt[0],Qt=Ct[1]-pt[1];for(let Un=0;Un<65;Un++){const kn=Un/64,Xt={x:pt[0]+un*kn,y:pt[1]+Qt*kn};Dt(s.projection.unproject(Xt.x,Xt.y),Xt)}}this.elevatedGlobeVertexBuffer=r.createVertexBuffer(pe,lM.members)}{this.maxLongitudeTriangleSize=0;let pe=[],we=new Zr;const be=(Ee,Ge,Ue)=>{we.emplaceBack(Ee,Ge,Ue);const $e=z[Ee],Je=z[Ge],it=z[Ue],Mt=Math.min(Math.min($e,Je),it),ut=Math.max(Math.max($e,Je),it)-Mt;ut>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ut),pe.push(Mt+ut/2)};for(let Ee=0;Ee<64;Ee++)for(let Ge=0;Ge<64;Ge++){const Ue=65*Ee+Ge,$e=Ue+1,Je=Ue+65,it=Je+1;be(Ue,Je,$e),be($e,Je,it)}[pe,we]=(function(Ee,Ge){const Ue=Array.from({length:Ee.length},((it,Mt)=>Mt));Ue.sort(((it,Mt)=>Ee[it]-Ee[Mt]));const $e=[],Je=new Zr;for(let it=0;it<Ue.length;it++){const Mt=Ue[it];$e.push(Ee[Mt]);const ut=3*Mt,Dt=ut+1;Je.emplaceBack(Ge.uint16[ut],Ge.uint16[Dt],Ge.uint16[Dt+1])}return[$e,Je]})(pe,we),this.elevatedGlobeTrianglesCenterLongitudes=pe,this.elevatedGlobeIndexBuffer=r.createIndexBuffer(we)}this.elevatedGlobeSegments=Ki.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ae/nn,0,se/nn,0,0,Z,X,0])}prepare(){const r=Object.keys(this.tiles).length!==0;if(this.tileID&&!r)return;const s=this.map.painter.context,h=s.gl;!this._dirty||this.texture instanceof Eb||(this.texture?this.texture.update(this.image):(this.texture=new zC(s,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),r&&this._prepareData(s)}loadTile(r,s){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},s(null)):(r.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(r){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let p=(_=r+180)+360*Math.round((h[0]-_)/360);var _;const x=new Ki,E=(j,B)=>{x.segments.push({vertexOffset:0,primitiveOffset:j,vertexLength:s.segments[0].vertexLength,primitiveLength:B,sortKey:void 0,vaos:{}})},O=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-p)<=O){const j=Da(h,0,h.length,p+O);return j===h.length||E(j,bi(h,j+1,h.length,p+360-O)-j),x}p<h[0]&&(p+=360);const R=bi(h,0,h.length,p-O);if(R===h.length)return E(0,h.length),x;E(0,R-0);const z=Da(h,R+1,h.length,p+O);return z!==h.length&&E(z,h.length-z),x}}const mne=(Math.pow(256,2)-1)/16907520;class dB extends vs{constructor(r,s,h,p){super(r,{layout:lB||(lB=new la({visibility:new Jt(st.layout_raster.visibility)})),paint:cB||(cB=new la({"raster-opacity":new Jt(st.paint_raster["raster-opacity"]),"raster-color":new wd(st.paint_raster["raster-color"]),"raster-color-mix":new Jt(st.paint_raster["raster-color-mix"]),"raster-color-range":new Jt(st.paint_raster["raster-color-range"]),"raster-hue-rotate":new Jt(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jt(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jt(st.paint_raster["raster-brightness-max"]),"raster-saturation":new Jt(st.paint_raster["raster-saturation"]),"raster-contrast":new Jt(st.paint_raster["raster-contrast"]),"raster-resampling":new Jt(st.paint_raster["raster-resampling"]),"raster-fade-duration":new Jt(st.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Jt(st.paint_raster["raster-emissive-strength"]),"raster-array-band":new Jt(st.paint_raster["raster-array-band"]),"raster-elevation":new Jt(st.paint_raster["raster-elevation"]),"raster-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,h,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(r){return!(r&&r._source instanceof hB&&(r._source.onNorthPole||r._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(r){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[h,p]=r||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(p)||h===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=$f({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,p])}}let fB,pB,mB,gB,yB;class _B extends vs{constructor(r,s,h,p){super(r,{layout:fB||(fB=new la({visibility:new Jt(st["layout_raster-particle"].visibility)})),paint:pB||(pB=new la({"raster-particle-array-band":new Jt(st["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Jt(st["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new wd(st["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Jt(st["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Jt(st["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Jt(st["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Jt(st["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Jt(st["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,h,p),this._updateColorRamp(),this.lastInvalidatedAt=ls.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(r){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(r){return!1}_handleSpecialPaintPropertyUpdate(r){r!=="raster-particle-color"&&r!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),r==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=$f({expression:r,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=ls.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class gne extends vs{constructor(r,s){super(r,{},s,null),this.implementation=r,r.slot&&(this.slot=r.slot)}is3D(r){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(r){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}function cM(l,r,s){const h=[0,0,1],p=$n([]);return An(p,p,s?-hr(l)+Math.PI:hr(l)),qn(p,p,-hr(r)),cn(h,h,p),qt(h,h)}const vB={None:0,Model:1,Symbol:2,FillExtrusion:4};class mT{constructor(r,s,h,p){this.message=(r?`${r}: `:"")+h,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function uM(l,r){const s=l.indexOf("://")===-1;try{return new URL(l,s&&r?"http://example.com":void 0),!0}catch{return!1}}class xB{constructor(r,s){this.feature=r,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class bB{constructor(){this.instancedDataArray=new Ed,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class hM{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.fqid)),this.projection=r.projection,this.index=r.index,this.worldview=r.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=r.styleDefinedModelURLs}updateFootprints(r,s){}populate(r,s,h,p){this.tileToMeter=Ne(h);const _=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:x,id:E,index:O,sourceLayerIndex:R}of r){const z=E??(x.properties&&x.properties.hasOwnProperty("id")?x.properties.id:void 0),j=Tt(x,_);if(!this.layers[0]._featureFilter.filter(new Ei(this.zoom,{worldview:this.worldview}),j,h))continue;const B={id:z,sourceLayerIndex:R,index:O,geometry:_?j.geometry:We(x,h,p),properties:x.properties,type:x.type,patterns:{}},X=this.addFeature(B,B.geometry,j);X&&s.featureIndex.insert(x,B.geometry,O,R,this.index,this.instancesPerModel[X].instancedDataArray.length,nn/32)}this.lookup=null}update(r,s,h,p){for(const _ in this.instancesPerModel){const x=this.instancesPerModel[_];for(const E in r)x.idToFeaturesIndex.hasOwnProperty(E)&&(this.evaluate(x.features[x.idToFeaturesIndex[E]],r[E],x,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let r=!1;for(const s in this.instancesPerModel){const h=this.instancesPerModel[s];for(const p of h.features){const _=this.layers[0],x=p.feature,E=this.canonical,O=_.paint.get("model-rotation").evaluate(x,{},E),R=_.paint.get("model-scale").evaluate(x,{},E),z=_.paint.get("model-translation").evaluate(x,{},E);mr(p.rotation,O)&&mr(p.scale,R)&&mr(p.translation,z)||(this.evaluate(p,p.featureStates,h,!0),r=!0)}}return r}updateReplacement(r,s,h,p){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const _=s.getReplacementRegionsForTile(r.toUnwrapped(),!0);if(Fv(this.activeReplacements,_))return!1;this.activeReplacements=_;let x=!1;for(const E in this.instancesPerModel){const O=this.instancesPerModel[E],R=O.instancedDataArray;for(const z of O.features){const j=z.instancedDataOffset,B=z.instancedDataCount;for(let X=0;X<B;X++){const Z=16*(X+j);let ae=R.float32[Z+0];const se=ae>nn;ae=se?ae-nn:ae;const pe=Math.floor(ae),we=R.float32[Z+1];let be=!1;for(const Ee of this.activeReplacements)if(!BS(Ee,h,vB.Model,p)&&!(Ee.min.x>pe||pe>Ee.max.x||Ee.min.y>we||we>Ee.max.y)&&(be=ym(VS(pe,we,r.canonical,Ee.footprintTileId.canonical),Ee.footprint),be))break;R.float32[Z]=be?ae+nn:ae,x=x||be!==se}}}return x}isEmpty(){for(const r in this.instancesPerModel)if(this.instancesPerModel[r].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(r){if(!this.uploaded)for(const s in this.instancesPerModel){const h=this.instancesPerModel[s];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=r.createVertexBuffer(h.instancedDataArray,Zee.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const h=this.instancesPerModel[s];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const r=this.layers[0].modelManager;if(r&&this.modelUris&&this.modelsRequested)for(const s of this.modelUris)r.removeModel(s,"",!0)}addFeature(r,s,h){const p=this.layers[0],_=p.layout.get("model-id").evaluate(h,{},this.canonical);if(!_)return jr(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),_;(uM(_,!1)||this.styleDefinedModelURLs[_]!==void 0)&&(this.modelUris.includes(_)||this.modelUris.push(_)),this.instancesPerModel[_]||(this.instancesPerModel[_]=new bB);const x=this.instancesPerModel[_],E=x.instancedDataArray,O=new xB(h,E.length);for(const R of s)for(const z of R){if(z.x<0||z.x>=nn||z.y<0||z.y>=nn)continue;const j=(this.lookupDim-1)/nn,B=this.lookupDim*(z.y*j|0)+z.x*j|0;if(this.lookup){if(this.lookup[B]!==0)continue;this.lookup[B]=1}this.instanceCount++;const X=E.length;E.resize(X+1),x.instancesEvaluatedElevation.push(0),E.float32[16*X]=z.x,E.float32[16*X+1]=z.y}return O.instancedDataCount=x.instancedDataArray.length-O.instancedDataOffset,O.instancedDataCount>0&&(r.id&&(x.idToFeaturesIndex[r.id]=x.features.length),x.features.push(O),this.evaluate(O,{},x,!1)),_}getModelUris(){return this.modelUris}evaluate(r,s,h,p){const _=this.layers[0],x=r.feature,E=this.canonical,O=r.rotation=_.paint.get("model-rotation").evaluate(x,s,E),R=r.scale=_.paint.get("model-scale").evaluate(x,s,E),z=r.translation=_.paint.get("model-translation").evaluate(x,s,E),j=_.paint.get("model-color").evaluate(x,s,E);j.a=_.paint.get("model-color-mix-intensity").evaluate(x,s,E);const B=[];this.maxVerticalOffset<z[2]&&(this.maxVerticalOffset=z[2]),this.maxScale=Math.max(Math.max(this.maxScale,R[0]),Math.max(R[1],R[2])),Wj(B,O,R);const X=Math.round(100*j.a)+j.b/1.05;for(let Z=0;Z<r.instancedDataCount;++Z){const ae=r.instancedDataOffset+Z,se=16*ae,pe=h.instancedDataArray.float32;let we=0;p&&(we=pe[se+6]-h.instancesEvaluatedElevation[ae]);const be=0|pe[se+1];pe[se]=(0|pe[se])+j.r/1.05,pe[se+1]=be+j.g/1.05,pe[se+2]=X,pe[se+3]=1/(E.z>10?this.tileToMeter:Ne(E,be)),pe[se+4]=z[0],pe[se+5]=z[1],pe[se+6]=z[2]+we,pe[se+7]=B[0],pe[se+8]=B[1],pe[se+9]=B[2],pe[se+10]=B[4],pe[se+11]=B[5],pe[se+12]=B[6],pe[se+13]=B[8],pe[se+14]=B[9],pe[se+15]=B[10],h.instancesEvaluatedElevation[ae]=z[2]}}}let wB,SB;Rn(hM,"ModelBucket",{omit:["layers"]}),Rn(bB,"PerModelAttributes"),Rn(xB,"ModelFeature");class nx{constructor(r,s,h){this._demTile=r,this._dem=this._demTile.dem,this._scale=s,this._offset=h}static create(r,s,h){const p=h||r.findDEMTileFor(s);if(!p||!p.dem)return;const _=p.dem,x=p.tileID,E=1<<s.canonical.z-x.canonical.z;return new nx(p,_.dim/nn/E,[(s.canonical.x/E-x.canonical.x)*_.dim,(s.canonical.y/E-x.canonical.y)*_.dim])}tileCoordToPixel(r,s){const h=s*this._scale+this._offset[1];return new kt(Math.floor(r*this._scale+this._offset[0]),Math.floor(h))}getElevationAt(r,s,h,p){const _=r*this._scale+this._offset[0],x=s*this._scale+this._offset[1],E=Math.floor(_),O=Math.floor(x),R=this._dem;return p=!!p,h?Gn(Gn(R.get(E,O,p),R.get(E,O+1,p),x-O),Gn(R.get(E+1,O,p),R.get(E+1,O+1,p),x-O),_-E):R.get(E,O,p)}getElevationAtPixel(r,s,h){return this._dem.get(r,s,!!h)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*de(1,r)*this._dem.stride}}const dM=new Float32Array(262144),A_=new Uint8Array(262144);function TB(l){let r=0;if(l.meshes)for(const s of l.meshes)r=Math.max(r,s.aabb.max[2]);if(l.children)for(const s of l.children)r=Math.max(r,TB(s));return r}function EB(l,r,s){if(l.meshes)for(const h of l.meshes){if(h.aabb.min[0]===1/0)continue;const p=br.applyTransform(h.aabb,l.matrix);s.insert(r,p.min[0],p.min[1],p.max[0],p.max[1])}if(l.children)for(const h of l.children)EB(h,r,s)}const AB=["","wall","door","roof","window","lamp","logo"];class CB{constructor(r){this.node=r,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:r.id,geometry:[],properties:{height:TB(r)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new br([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let r=0;const s=new br([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==r&&(h.transformedAabb=br.applyTransformFast(h.aabb,this.node.matrix),s.encapsulate(h.transformedAabb)),r++;this.aabb=s}return this.aabb}}class gT{constructor(r,s,h,p,_,x,E,O){this.id=h,this.layers=r,this.layerIds=this.layers.map((R=>R.fqid)),this.stateDependentLayerIds=this.layers.filter((R=>R.isStateDependent())).map((R=>R.id)),this.modelTraits|=Yv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=Yv.HasMapboxMeshFeatures),_&&(this.modelTraits|=Yv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.worldview=O,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const R of s)this.nodesInfo.push(new CB(R)),EB(R,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(r,s){for(const h of this.getNodesInfo()){const p=h.node;p.footprint&&s.push({footprint:p.footprint,id:r})}}update(r){const s=Object.keys(r).length!==0;if(s&&!this.stateDependentLayers.length)return;const h=s?this.stateDependentLayers:this.layers;if(!Dr(r,this.states))for(const p of h)this.evaluate(p,r);this.states=structuredClone(r)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(r){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const h of s){const p=h.node;this.uploaded?this.updatePbrBuffer(p):FC(p,r,!0)}for(const h of s)YS(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(r){let s=!1;if(!r.meshes)return s;for(const h of r.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),s=!0);return s}needsReEvaluation(r,s,h){const p=r.transform.projectionOptions,_=r.style.getBrightness(),x=this.brightness!==_;if(!this.uploaded||this.dirty||p.name!==this.projection.name||Bb(h.paint.get("model-color").value,x)||Bb(h.paint.get("model-color-mix-intensity").value,x)||Bb(h.paint.get("model-roughness").value,x)||Bb(h.paint.get("model-emissive-strength").value,x)||Bb(h.paint.get("model-height-based-emissive-strength-multiplier").value,x)){this.projection=p,this.brightness=_;const E=this.getNodesInfo();for(const O of E)O.state=null;return!0}return!1}evaluateTransform(r,s){if(r.transform.zoom===this.zoom)return;this.zoom=r.transform.zoom;const h=this.getNodesInfo(),p=this.id.canonical;for(const _ of h){const x=_.feature;_.evaluatedTranslation=s.paint.get("model-translation").evaluate(x,{},p),_.evaluatedScale=s.paint.get("model-scale").evaluate(x,{},p)}}evaluate(r,s){const h=this.getNodesInfo();for(const p of h){if(!p.node.meshes)continue;const _=p.feature,x=s&&s[_.id];if(Dr(x,p.state))continue;p.state=structuredClone(x);const E=p.node.meshes&&p.node.meshes[0].featureData,O=p.evaluatedColor[2],R=p.evaluatedRMEA[2],z=this.id.canonical;if(p.hasTranslucentParts=!1,E){for(let j=0;j<AB.length;j++){const B=AB[j];B.length&&(_.properties.part=B);const X=r.paint.get("model-color").evaluate(_,x,z).toPremultipliedRenderColor(null),Z=r.paint.get("model-color-mix-intensity").evaluate(_,x,z);p.evaluatedColor[j]=[X.r,X.g,X.b,Z],p.evaluatedRMEA[j][0]=r.paint.get("model-roughness").evaluate(_,x,z),p.evaluatedRMEA[j][2]=r.paint.get("model-emissive-strength").evaluate(_,x,z),p.evaluatedRMEA[j][3]=X.a,p.emissionHeightBasedParams[j]=r.paint.get("model-height-based-emissive-strength-multiplier").evaluate(_,x,z),!p.hasTranslucentParts&&X.a<1&&(p.hasTranslucentParts=!0)}delete _.properties.part,_ne(p,O!==p.evaluatedColor[2]||R!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=r.paint.get("model-emissive-strength").evaluate(_,x,z);p.evaluatedTranslation=r.paint.get("model-translation").evaluate(_,x,z),p.evaluatedScale=r.paint.get("model-scale").evaluate(_,x,z),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(r,s,h,p){const _=r.findDEMTileFor(h);if(_&&(_.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(_.dem&&_.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=_.tileID.overscaledZ;const x=nx.create(r,h,_);if(!x)return;this.modelTraits&Yv.HasMapboxMeshFeatures&&this.updateDEM(r,x,h,p);for(const E of this.getNodesInfo()){const O=E.node;if(!O.footprint||!O.footprint.vertices||!O.footprint.vertices.length)continue;const R=O.footprint.vertices;let z=x.getElevationAt(R[0].x,R[0].y,!0,!0);for(let j=1;j<R.length;j++)z=Math.min(z,x.getElevationAt(R[j].x,R[j].y,!0,!0));O.elevation=z}}this.terrainTile=_.tileID.canonical,this.terrainExaggeration=s}}updateDEM(r,s,h,p){let _=s._dem._modifiedForSources[p];if(_===void 0&&(s._dem._modifiedForSources[p]=[],_=s._dem._modifiedForSources[p]),_.includes(h.canonical))return;const x=s._dem.dim;_.push(h.canonical);let E=!1;for(const O of this.getNodesInfo()){const R=O.node;if(!R.footprint||!R.footprint.grid)continue;const z=R.footprint.grid,j=s.tileCoordToPixel(z.min.x,z.min.y),B=s.tileCoordToPixel(z.max.x,z.max.y),X=Math.min(Math.min(x-B.y,j.x),Math.min(j.y,x-B.x));if(X<0)continue;const Z=Pe(X,2,5);let ae=Math.max(0,j.x-Z),se=Math.max(0,j.y-Z),pe=Math.min(B.x+Z,x-1),we=Math.min(B.y+Z,x-1);for(let Ue=se;Ue<=we;++Ue)for(let $e=ae;$e<=pe;++$e)A_[Ue*x+$e]=255;let be=0,Ee=0;for(let Ue=0;Ue<z.cellsY;++Ue)for(let $e=0;$e<z.cellsX;++$e){if(!z.cells[Ue*z.cellsX+$e])continue;const Je=s.tileCoordToPixel(z.min.x+$e/z.xScale,z.min.y+Ue/z.yScale),it=s.tileCoordToPixel(z.min.x+($e+1)/z.xScale,z.min.y+(Ue+1)/z.yScale);for(let Mt=Je.y;Mt<=Math.min(it.y+1,x-1);++Mt)for(let ut=Je.x;ut<=Math.min(it.x+1,x-1);++ut)A_[Mt*x+ut]===255&&(A_[Mt*x+ut]=0,be+=s.getElevationAtPixel(ut,Mt),Ee++)}const Ge=be/Ee;ae=Math.max(1,j.x-Z),se=Math.max(1,j.y-Z),pe=Math.min(B.x+Z,x-2),we=Math.min(B.y+Z,x-2),E=!0;for(let Ue=se;Ue<=we;++Ue)for(let $e=ae;$e<=pe;++$e)A_[Ue*x+$e]===0&&(dM[Ue*x+$e]=s._dem.set($e,Ue,Ge));for(let Ue=1;Ue<Z;++Ue){ae=Math.max(1,j.x-Ue),se=Math.max(1,j.y-Ue),pe=Math.min(B.x+Ue,x-2),we=Math.min(B.y+Ue,x-2);for(let $e=se;$e<=we;++$e)for(let Je=ae;Je<=pe;++Je){const it=$e*x+Je;if(A_[it]===255){let Mt=0,ut=0,Dt=-1,ln=-1;for(let Vt=-1;Vt<=1;++Vt)for(let Yt=-1;Yt<=1;++Yt){const on=($e+Vt)*x+Je+Yt;if(A_[on]>=Ue)continue;const At=dM[on],Kt=Math.abs(At);Kt>ut&&(Mt=At,ut=Kt,Dt=Yt,ln=Vt)}if(ut>.1){const Vt=1-(Ue+.5*Math.abs(Dt*ln))/Z;let Yt=s._dem.get(Je,$e)+Mt*Vt;const on=s._dem.get(Je+Dt,$e+ln),At=s._dem.get(Je-Dt,$e-ln,!0);(Yt-on)*(Yt-At)>0&&(Yt=(on+At)/2),dM[it]=s._dem.set(Je,$e,Yt),A_[it]=Ue}}}}}E&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=ls.now())}setFilter(r){this.filter=r?Sd(r):null}getNodesInfo(){return this.filter?this.nodesInfo.filter((r=>this.filter.filter(new Ei(this.id.overscaledZ,{worldview:this.worldview}),r.feature,this.id.canonical))):this.nodesInfo}destroy(){const r=this.getNodesInfo();for(const s of r)YS(s.node),VC(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(r,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(r.toUnwrapped());for(const p of this.getNodesInfo()){const _=p.node.footprint;p.hiddenByReplacement=!!_&&!h.find((x=>x.footprint===_))}}getHeightAtTileCoord(r,s){const h=[],p=[0,0,0],_=q([]);for(const x of this.getNodesInfo()){const E=x.node.meshes[0],O=E.transformedAabb;if(r<O.min[0]||s<O.min[1]||r>O.max[0]||s>O.max[1])continue;if(x.node.hidden===!0)return{height:1/0,maxHeight:x.feature.properties.height,hidden:!1,verticalScale:x.evaluatedScale[2]};V(_,x.node.matrix),p[0]=r,p[1]=s,En(p,p,_);const R=(p[0]-E.aabb.min[0])/(E.aabb.max[0]-E.aabb.min[0])*S_|0,z=Math.min(63,(p[1]-E.aabb.min[1])/(E.aabb.max[1]-E.aabb.min[1])*S_|0)*S_+Math.min(63,R),j=E.heightmap[z];if(!(j<0&&x.node.footprint))return x.hiddenByReplacement?void 0:{height:j,maxHeight:x.feature.properties.height,hidden:!1,verticalScale:x.evaluatedScale[2]};if(x.node.footprint.grid.query(new kt(r,s),new kt(r,s),h),h.length>0)return{height:void 0,maxHeight:x.feature.properties.height,hidden:x.hiddenByReplacement,verticalScale:x.evaluatedScale[2]}}}}function Bb(l,r){return l instanceof tu&&!l.isLightConstant&&r}function yne(l,r,s,h,p,_,x,E){let O=(61440&r|(61440&r)>>4)>>8,R=(3840&r|(3840&r)>>4)>>4,z=240&r|(240&r)>>4;s[3]>0&&(O=Gn(O,255*s[0],s[3]),R=Gn(R,255*s[1],s[3]),z=Gn(z,255*s[2],s[3]));const j=O<<8|R,B=z<<8|Math.floor(255*h[3]),X=(function(Ue){const $e=Pe(Ue,0,2);return Math.min(Math.round(.5*$e*255),255)})(h[2])<<8|15*h[0]<<4|15*h[1],Z=Pe(p[0],0,1),ae=Pe(p[1],0,1),se=Pe(p[2],0,1),pe=Pe(p[3],0,1);let we,be,Ee,Ge;if(Z!==ae&&x!==_&&ae!==Z){const Ue=x-_;be=1/(Ue*(ae-Z)),Ee=-(_+Ue*Z)/(Ue*(ae-Z));const $e=Pe(p[4],-1,1);Ge=Math.pow(10,$e),we=255*se<<8|255*pe}else we=65535,be=0,Ee=1,Ge=1;if(l.emplaceBack(j,B,X,we,be,Ee,Ge),E){const Ue=E.length;E.clear();for(let $e=0;$e<Ue;$e++)E.emplaceBack(j,B,X,we,be,Ee,Ge)}}function _ne(l,r,s){const h=l.node;let p=0;const _=s&Yv.HasMeshoptCompression;for(const x of h.meshes){if(h.lights&&h.lightMeshIndex===p||!x.featureData)continue;x.featureArray=new Ad,x.featureArray.reserve(x.featureData.length);let E=r;for(const O of x.featureData){const R=_?65535&O:O>>16&65535,z=_?O>>16&65535:65535&O,j=(15&z)<8?15&z:0,B=l.evaluatedRMEA[j],X=l.evaluatedColor[j],Z=l.emissionHeightBasedParams[j];let ae;if(E&&j===2&&h.lights&&(ae=new Ad,ae.resize(10*h.lights.length)),yne(x.featureArray,R,X,B,Z,x.aabb.min[2],x.aabb.max[2],ae),ae&&E){E=!1;const se=h.meshes[h.lightMeshIndex];se.featureArray=ae,se.featureArray._trim()}}x.featureArray._trim(),p++}}function MB(l,r,s,h){const p=1<<l.z;r.lat=Te((h/nn+l.y)/p),r.lng=xe((s/nn+l.x)/p)}function vne(l,r,s,h){const p=l.getNodesInfo()[r];if(!p||p.hiddenByReplacement||!p.node.meshes)return;let _=Number.MAX_VALUE;const x=p.node,E=s.tile,O=h.calculatePosMatrix(E.tileID.toUnwrapped(),h.worldSize),R=p.evaluatedScale;let z=0;h.elevation&&x.elevation&&(z=x.elevation*h.elevation.exaggeration()),ee(O,O,[(x.anchor?x.anchor[0]:0)*(R[0]-1),(x.anchor?x.anchor[1]:0)*(R[1]-1),z]),re(O,O,R);const j=s.queryGeometry,B=j.isPointQuery()?j.screenBounds:j.screenGeometry,X=function(ae){const se=J([],O,ae.matrix);J(se,h.expandedFarZProjMatrix,se);for(let pe=0;pe<ae.meshes.length;++pe){const we=ae.meshes[pe];if(pe===ae.lightMeshIndex)continue;const be=Xj(B,h,se,we.aabb);be!=null&&(_=Math.min(be,_))}if(ae.children)for(const pe of ae.children)X(pe)};if(X(x),_===Number.MAX_VALUE)return;const Z=new U(0,0);return MB(E.tileID.canonical,Z,p.node.anchor[0],p.node.anchor[1]),{intersectionZ:_,position:Z,feature:p.feature}}Rn(gT,"Tiled3dModelBucket",{omit:["layers"]}),Rn(CB,"Tiled3dModelFeature");const xne={circle:class extends vs{constructor(l,r,s,h){super(l,{layout:zh||(zh=new la({"circle-sort-key":new wn(st.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Jt(st.layout_circle["circle-elevation-reference"]),visibility:new Jt(st.layout_circle.visibility)})),paint:Bf||(Bf=new la({"circle-radius":new wn(st.paint_circle["circle-radius"]),"circle-color":new wn(st.paint_circle["circle-color"]),"circle-blur":new wn(st.paint_circle["circle-blur"]),"circle-opacity":new wn(st.paint_circle["circle-opacity"]),"circle-translate":new Jt(st.paint_circle["circle-translate"]),"circle-translate-anchor":new Jt(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jt(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jt(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wn(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wn(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wn(st.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Jt(st.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h)}createBucket(l){return new ti(l)}queryRadius(l){const r=l;return Io("circle-radius",this,r)+Io("circle-stroke-width",this,r)+Sa(this.paint.get("circle-translate"))}queryIntersectsFeature(l,r,s,h,p,_,x,E){const O=Uu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(r,s)+this.paint.get("circle-stroke-width").evaluate(r,s);return Q0(l,h,_,x,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,R)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,r,s){const h=J0(this);return{config:new xs(this,{zoom:r,lut:s}),defines:h,overrideFog:!1}}is3D(l){return!l&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends vs{createBucket(l){return new SS(l)}constructor(l,r,s,h){super(l,{layout:Dg||(Dg=new la({visibility:new Jt(st.layout_heatmap.visibility)})),paint:TS||(TS=new la({"heatmap-radius":new wn(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wn(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jt(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wd(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jt(st.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$f({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(l){return Io("heatmap-radius",this,l)}queryIntersectsFeature(l,r,s,h,p,_,x,E){const O=this.paint.get("heatmap-radius").evaluate(r,s);return Q0(l,h,_,x,E,!0,!0,new kt(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,r,s){return l==="heatmap"?{config:new xs(this,{zoom:r,lut:s}),overrideFog:!1}:{}}},hillshade:class extends vs{constructor(l,r,s,h){super(l,{layout:tb||(tb=new la({visibility:new Jt(st.layout_hillshade.visibility)})),paint:Wi||(Wi=new la({"hillshade-illumination-direction":new Jt(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jt(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jt(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jt(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jt(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jt(st.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Jt(st.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,r,s){return{overrideFog:!1}}},fill:class extends vs{constructor(l,r,s,h){super(l,{layout:LS||(LS=new la({"fill-sort-key":new wn(st.layout_fill["fill-sort-key"]),visibility:new Jt(st.layout_fill.visibility),"fill-elevation-reference":new Jt(st.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new wn(st.layout_fill["fill-construct-bridge-guard-rail"])})),paint:NS||(NS=new la({"fill-antialias":new Jt(st.paint_fill["fill-antialias"]),"fill-opacity":new wn(st.paint_fill["fill-opacity"]),"fill-color":new wn(st.paint_fill["fill-color"]),"fill-outline-color":new wn(st.paint_fill["fill-outline-color"]),"fill-translate":new Jt(st.paint_fill["fill-translate"]),"fill-translate-anchor":new Jt(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new wn(st.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Jt(st.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Jt(st.paint_fill["fill-emissive-strength"]),"fill-z-offset":new wn(st.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new wn(st.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new wn(st.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h)}getProgramIds(){const l=this.paint.get("fill-pattern"),r=l&&l.constantOr(1),s=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(l,r,s){return{config:new xs(this,{zoom:r,lut:s}),overrideFog:!1}}recalculate(l,r){super.recalculate(l,r);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new cb(l)}queryRadius(){return Sa(this.paint.get("fill-translate"))}queryIntersectsFeature(l,r,s,h,p,_){return!l.queryGeometry.isAboveHorizon&&Ma(Js(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(l){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const r=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return l!=null?r&&!l:r}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends vs{constructor(l,r,s,h){super(l,{layout:b_||(b_=new la({visibility:new Jt(st["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Jt(st["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:wb||(wb=new la({"fill-extrusion-opacity":new Jt(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wn(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jt(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jt(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wn(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Jt(st["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new wn(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wn(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Jt(st["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Jt(st["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Jt(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Jt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Jt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Jt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Jt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Jt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Jt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Jt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new wn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new wn(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Jt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Jt(st["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Jt(st["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Jt(st["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new wn(st["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new wn(st["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Jt(st["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new Zf(l)}queryRadius(){return Sa(this.paint.get("fill-extrusion-translate"))}is3D(l){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,r,s,h,p,_,x,E,O){const R=Uu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),z=this.paint.get("fill-extrusion-height").evaluate(r,s),j=this.paint.get("fill-extrusion-base").evaluate(r,s),B=[0,0],X=E&&_.elevation,Z=_.elevation?_.elevation.exaggeration():1,ae=l.tile.getBucket(this);if(X&&ae instanceof Zf){const Ee=ae.centroidVertexArray,Ge=O+1;Ge<Ee.length&&(B[0]=Ee.geta_centroid_pos0(Ge),B[1]=Ee.geta_centroid_pos1(Ge))}if(B[0]===0&&B[1]===1)return!1;_.projection.name==="globe"&&(h=GS([h],[new kt(0,0),new kt(nn,nn)],l.tileID.canonical).map((Ee=>Ee.polygon)).flat());const se=X?E:null,[pe,we]=(function(Ee,Ge,Ue,$e,Je,it,Mt,ut,Dt,ln,Vt){return Ee.projection.name==="globe"?(function(Yt,on,At,Kt,pt,Ct,un,Qt,Un,kn,Xt){const an=[],Nn=[],Cn=Yt.projection.upVectorScale(Xt,Yt.center.lat,Yt.worldSize).metersToTile,pn=[0,0,0,1],On=[0,0,0,1],Jn=(wr,ur,Xr,Lr)=>{wr[0]=ur,wr[1]=Xr,wr[2]=Lr,wr[3]=1},or=bb();At>0&&(At+=or),Kt+=or;for(const wr of on){const ur=[],Xr=[];for(const Lr of wr){const Ji=Lr.x+pt.x,Oe=Lr.y+pt.y,Re=Yt.projection.projectTilePoint(Ji,Oe,Xt),Et=Yt.projection.upVector(Xt,Lr.x,Lr.y);let hn=At,vn=Kt;if(un){const _n=k(Ji,Oe,At,Kt,un,Qt,Un,kn);hn+=_n.base,vn+=_n.top}At!==0?Jn(pn,Re.x+Et[0]*Cn*hn,Re.y+Et[1]*Cn*hn,Re.z+Et[2]*Cn*hn):Jn(pn,Re.x,Re.y,Re.z),Jn(On,Re.x+Et[0]*Cn*vn,Re.y+Et[1]*Cn*vn,Re.z+Et[2]*Cn*vn),En(pn,pn,Ct),En(On,On,Ct),ur.push(new Wu(pn[0],pn[1],pn[2])),Xr.push(new Wu(On[0],On[1],On[2]))}an.push(ur),Nn.push(Xr)}return[an,Nn]})(Ee,Ge,Ue,$e,Je,it,Mt,ut,Dt,ln,Vt):Mt?(function(Yt,on,At,Kt,pt,Ct,un,Qt,Un){const kn=[],Xt=[],an=[0,0,0,1];for(const Nn of Yt){const Cn=[],pn=[];for(const On of Nn){const Jn=On.x+Kt.x,or=On.y+Kt.y,wr=k(Jn,or,on,At,Ct,un,Qt,Un);an[0]=Jn,an[1]=or,an[2]=wr.base,an[3]=1,Bt(an,an,pt),an[3]=Math.max(an[3],1e-5);const ur=new Wu(an[0]/an[3],an[1]/an[3],an[2]/an[3]);an[0]=Jn,an[1]=or,an[2]=wr.top,an[3]=1,Bt(an,an,pt),an[3]=Math.max(an[3],1e-5);const Xr=new Wu(an[0]/an[3],an[1]/an[3],an[2]/an[3]);Cn.push(ur),pn.push(Xr)}kn.push(Cn),Xt.push(pn)}return[kn,Xt]})(Ge,Ue,$e,Je,it,Mt,ut,Dt,ln):(function(Yt,on,At,Kt,pt){const Ct=[],un=[],Qt=pt[8]*on,Un=pt[9]*on,kn=pt[10]*on,Xt=pt[11]*on,an=pt[8]*At,Nn=pt[9]*At,Cn=pt[10]*At,pn=pt[11]*At;for(const On of Yt){const Jn=[],or=[];for(const wr of On){const ur=wr.x+Kt.x,Xr=wr.y+Kt.y,Lr=pt[0]*ur+pt[4]*Xr+pt[12],Ji=pt[1]*ur+pt[5]*Xr+pt[13],Oe=pt[2]*ur+pt[6]*Xr+pt[14],Re=pt[3]*ur+pt[7]*Xr+pt[15],Et=Lr+Qt,hn=Ji+Un,vn=Oe+kn,_n=Math.max(Re+Xt,1e-5),Ln=Lr+an,ar=Ji+Nn,Hr=Oe+Cn,Gr=Math.max(Re+pn,1e-5);Jn.push(new Wu(Et/_n,hn/_n,vn/_n)),or.push(new Wu(Ln/Gr,ar/Gr,Hr/Gr))}Ct.push(Jn),un.push(or)}return[Ct,un]})(Ge,Ue,$e,Je,it)})(_,h,j,z,R,x,se,B,Z,_.center.lat,l.tileID.canonical),be=l.queryGeometry;return(function(Ee,Ge,Ue){let $e=1/0;Ma(Ue,Ge)&&($e=A(Ue,Ge[0]));for(let Je=0;Je<Ge.length;Je++){const it=Ge[Je],Mt=Ee[Je];for(let ut=0;ut<it.length-1;ut++){const Dt=it[ut],ln=[Dt,it[ut+1],Mt[ut+1],Mt[ut],Dt];Ai(Ue,ln)&&($e=Math.min($e,A(Ue,ln)))}}return $e!==1/0&&$e})(pe,we,be.isPointQuery()?be.screenBounds:be.screenGeometry)}},building:class extends vs{constructor(l,r,s,h){super(l,{layout:r3||(r3=new la({visibility:new Jt(st.layout_building.visibility),"building-facade":new wn(st.layout_building["building-facade"]),"building-facade-floors":new wn(st.layout_building["building-facade-floors"]),"building-facade-window":new wn(st.layout_building["building-facade-window"]),"building-roof-shape":new wn(st.layout_building["building-roof-shape"]),"building-height":new wn(st.layout_building["building-height"]),"building-base":new wn(st.layout_building["building-base"])})),paint:i3||(i3=new la({"building-opacity":new Jt(st.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new Jt(st.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new Jt(st.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Jt(st.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Jt(st.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Jt(st.paint_building["building-vertical-scale"]),"building-cast-shadows":new Jt(st.paint_building["building-cast-shadows"]),"building-color":new wn(st.paint_building["building-color"]),"building-emissive-strength":new wn(st.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new Jt(st.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new Jt(st.paint_building["building-cutoff-fade-range"]),"building-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new n3(l)}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(l){return!0}},line:class extends vs{constructor(l,r,s,h){const p=p3();super(l,p,r,s,h),p.layout&&(this.layout=new Ql(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Au,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,r){super.recalculate(l,r),this.paint._values["line-floorwidth"]=(()=>{if(Cb)return Cb;const s=p3();return Cb=new _te(s.paint.properties["line-width"].specification),Cb.useIntegerZoom=!0,Cb})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new qC(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,r,s){const h=d3(this);return{config:new xs(this,{zoom:r,lut:s}),defines:h,overrideFog:!1}}queryRadius(l){const r=l,s=m3(Io("line-width",this,r),Io("line-gap-width",this,r)),h=Io("line-offset",this,r);return s/2+Math.abs(h)+Sa(this.paint.get("line-translate"))}queryIntersectsFeature(l,r,s,h,p,_){if(l.queryGeometry.isAboveHorizon)return!1;const x=Js(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,l.pixelToTileUnitsFactor),E=l.pixelToTileUnitsFactor/2*m3(this.paint.get("line-width").evaluate(r,s),this.paint.get("line-gap-width").evaluate(r,s)),O=this.paint.get("line-offset").evaluate(r,s);return O&&(h=(function(R,z){const j=[],B=new kt(0,0);for(let X=0;X<R.length;X++){const Z=R[X],ae=[];for(let se=0;se<Z.length;se++){const pe=Z[se],we=Z[se+1],be=se===0?B:pe.sub(Z[se-1])._unit()._perp(),Ee=se===Z.length-1?B:we.sub(pe)._unit()._perp(),Ge=be._add(Ee)._unit();Ge._mult(1/(Ge.x*Ee.x+Ge.y*Ee.y)),ae.push(Ge._mult(z)._add(pe))}j.push(ae)}return j})(h,O*l.pixelToTileUnitsFactor)),(function(R,z,j){for(let B=0;B<z.length;B++){const X=z[B];if(R.length>=3){for(let Z=0;Z<X.length;Z++)if(Ya(R,X[Z]))return!0}if(wa(R,X,j))return!0}return!1})(x,h,E)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(l){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:dT,background:class extends vs{constructor(l,r,s,h){super(l,{layout:oB||(oB=new la({visibility:new Jt(st.layout_background.visibility)})),paint:sB||(sB=new la({"background-pitch-alignment":new Jt(st.paint_background["background-pitch-alignment"]),"background-color":new Jt(st.paint_background["background-color"]),"background-pattern":new Jt(st.paint_background["background-pattern"]),"background-opacity":new Jt(st.paint_background["background-opacity"]),"background-emissive-strength":new Jt(st.paint_background["background-emissive-strength"]),"background-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,r,s){return{overrideFog:!1}}is3D(l){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:dB,"raster-particle":_B,sky:class extends vs{constructor(l,r,s,h){super(l,{layout:mB||(mB=new la({visibility:new Jt(st.layout_sky.visibility)})),paint:gB||(gB=new la({"sky-type":new Jt(st.paint_sky["sky-type"]),"sky-atmosphere-sun":new Jt(st.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Jt(st.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Jt(st.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Jt(st.paint_sky["sky-gradient-radius"]),"sky-gradient":new wd(st.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Jt(st.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Jt(st.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Jt(st.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=$f({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(l,r){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),p=!h,_=l.style.light,x=_.properties.get("position");return p&&_.properties.get("anchor")==="viewport"&&jr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?cM(x.azimuthal,90-x.polar,r):cM(h[0],90-h[1],r)}const s=this.paint.get("sky-gradient-center");return cM(s[0],90-s[1],r)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends vs{constructor(l,r,s,h){super(l,{paint:yB||(yB=new la({}))},r,null)}},model:class extends vs{constructor(l,r,s,h){super(l,{layout:wB||(wB=new la({visibility:new Jt(st.layout_model.visibility),"model-id":new wn(st.layout_model["model-id"])})),paint:SB||(SB=new la({"model-opacity":new wn(st.paint_model["model-opacity"]),"model-rotation":new wn(st.paint_model["model-rotation"]),"model-scale":new wn(st.paint_model["model-scale"]),"model-translation":new wn(st.paint_model["model-translation"]),"model-color":new wn(st.paint_model["model-color"]),"model-color-mix-intensity":new wn(st.paint_model["model-color-mix-intensity"]),"model-type":new Jt(st.paint_model["model-type"]),"model-cast-shadows":new Jt(st.paint_model["model-cast-shadows"]),"model-receive-shadows":new Jt(st.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Jt(st.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new wn(st.paint_model["model-emissive-strength"]),"model-roughness":new wn(st.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new wn(st.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Jt(st.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Jt(st.paint_model["model-front-cutoff"]),"model-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},r,s,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new hM(l)}getProgramIds(){return["model"]}is3D(l){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof gT?nn-1:0}queryIntersectsFeature(l,r,s,h,p,_){if(!this.modelManager)return!1;const x=this.modelManager,E=l.tile.getBucket(this);if(!(E&&E instanceof hM))return!1;for(const O in E.instancesPerModel){const R=E.instancesPerModel[O],z=r.id!==void 0?r.id:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0;if(R.idToFeaturesIndex.hasOwnProperty(z)){const j=R.features[R.idToFeaturesIndex[z]],B=x.getModel(O,this.scope);if(!B)return!1;let X=G();const Z=new U(0,0),ae=E.canonical;let se=Number.MAX_VALUE;for(let pe=0;pe<j.instancedDataCount;++pe){const we=16*(j.instancedDataOffset+pe),be=R.instancedDataArray.float32,Ee=[be[we+4],be[we+5],be[we+6]];MB(ae,Z,be[we],0|be[we+1]),Zj(X,B,_,Z,j.rotation,j.scale,Ee,!1,!1,!1),_.projection.name==="globe"&&(X=BC(X,_));const Ge=J([],_.projMatrix,X),Ue=l.queryGeometry,$e=Xj(Ue.isPointQuery()?Ue.screenBounds:Ue.screenGeometry,_,Ge,B.aabb);$e!=null&&(se=Math.min($e,se))}return se!==Number.MAX_VALUE&&se}}return!1}_handleOverridablePaintPropertyUpdate(l,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const r=this._transitionablePaint._values[l];return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof bc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends vs{constructor(l,r,s,h){super(l,{layout:ub||(ub=new la({"clip-layer-types":new Jt(st.layout_clip["clip-layer-types"]),"clip-layer-scope":new Jt(st.layout_clip["clip-layer-scope"])})),paint:gm||(gm=new la({}))},r,s,h)}recalculate(l,r){super.recalculate(l,r)}createBucket(l){return new zS(l)}is3D(l){return!0}}},fM=new pi(0,0,0),pM={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},mM={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},yT={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},bne={PAINT_ORDER_FILL_AND_STROKE:1},Fb={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},PB={MASK_TYPE_LUMINANCE:1};function wne(l,r,s){l===1&&r.icons.push((function(h,p){return(function(_){if(_.usvg_tree.height||(_.usvg_tree.height=_.usvg_tree.width),!_.metadata)return _;const{metadata:x}=_;if(x.content_area){const{content_area:E}=x;E.top==null&&(E.top=E.left),E.width==null&&(E.width=_.usvg_tree.width),E.height==null&&(E.height=E.width)}return x.stretch_x&&x.stretch_x.length&&OB(x,"x"),x.stretch_y&&x.stretch_y.length&&OB(x,"y"),_})(h.readFields(Sne,{name:void 0},p))})(s,s.readVarint()+s.pos))}function OB(l,r){const s=[],h=l[`stretch_${r}`];let p=null;for(let _=0;_<h.length;_++)p===null?p=s.length===0?h[0]:s[s.length-1][1]+h[_]:(s.push([p,p+h[_]]),p=null);l[`stretch_${r}_areas`]=s}function Sne(l,r,s){l===1?r.name=s.readString():l===2?r.metadata=(function(h,p){return h.readFields(Tne,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)})(s,s.readVarint()+s.pos):l===3&&(r.usvg_tree=(function(h,p){return h.readFields(Cne,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)})(s,s.readVarint()+s.pos),r.data="usvg_tree")}function Tne(l,r,s){l===1?r.stretch_x=s.readPackedVarint():l===2?r.stretch_y=s.readPackedVarint():l===3?r.content_area=(function(h,p){return h.readFields(Ene,{left:0},p)})(s,s.readVarint()+s.pos):l===4&&r.variables.push((function(h,p){return h.readFields(Ane,{name:void 0},p)})(s,s.readVarint()+s.pos))}function Ene(l,r,s){l===1?r.left=s.readVarint():l===2?r.width=s.readVarint():l===3?r.top=s.readVarint():l===4&&(r.height=s.readVarint())}function Ane(l,r,s){l===1?r.name=s.readString():l===2&&(r.rgb_color=xT(s.readVarint()),r.value="rgb_color")}function Cne(l,r,s){l===1?r.width=r.height=s.readVarint():l===2?r.height=s.readVarint():l===3?r.children.push(_T(s,s.readVarint()+s.pos)):l===4?r.linear_gradients.push((function(h,p){return h.readFields(kne,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)})(s,s.readVarint()+s.pos)):l===5?r.radial_gradients.push((function(h,p){return h.readFields(Nne,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)})(s,s.readVarint()+s.pos)):l===7?r.clip_paths.push((function(h,p){return h.readFields(zne,{children:[]},p)})(s,s.readVarint()+s.pos)):l===8&&r.masks.push((function(h,p){const _=h.readFields(jne,{left:0,width:20,mask_type:PB.MASK_TYPE_LUMINANCE,children:[]},p);return _.height==null&&(_.height=_.width),_.top==null&&(_.top=_.left),_})(s,s.readVarint()+s.pos))}function _T(l,r){return l.readFields(Mne,{},r)}function Mne(l,r,s){l===1?(r.group=(function(h,p){return h.readFields(Pne,{opacity:255,children:[]},p)})(s,s.readVarint()+s.pos),r.node="group"):l===2&&(r.path=(function(h,p){return h.readFields(Rne,{paint_order:1,commands:[],step:1,diffs:[],rule:pM.PATH_RULE_NON_ZERO},p)})(s,s.readVarint()+s.pos),r.node="path")}function Pne(l,r,s){l===1?r.transform=vT(s,s.readVarint()+s.pos):l===2?r.opacity=s.readVarint():l===5?r.clip_path_idx=s.readVarint():l===6?r.mask_idx=s.readVarint():l===7&&r.children.push(_T(s,s.readVarint()+s.pos))}function vT(l,r){return l.readFields(One,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},r)}function One(l,r,s){l===1?r.sx=s.readFloat():l===2?r.ky=s.readFloat():l===3?r.kx=s.readFloat():l===4?r.sy=s.readFloat():l===5?r.tx=s.readFloat():l===6&&(r.ty=s.readFloat())}function Rne(l,r,s){l===1?r.fill=(function(h,p){return h.readFields(Ine,{rgb_color:fM,paint:"rgb_color",opacity:255},p)})(s,s.readVarint()+s.pos):l===2?r.stroke=(function(h,p){return h.readFields(Dne,{rgb_color:fM,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)})(s,s.readVarint()+s.pos):l===3?r.paint_order=s.readVarint():l===5?s.readPackedVarint(r.commands):l===6?r.step=s.readFloat():l===7?s.readPackedSVarint(r.diffs):l===8&&(r.rule=s.readVarint())}function Ine(l,r,s){l===1?(r.rgb_color=xT(s.readVarint()),r.paint="rgb_color"):l===2?(r.linear_gradient_idx=s.readVarint(),r.paint="linear_gradient_idx"):l===3?(r.radial_gradient_idx=s.readVarint(),r.paint="radial_gradient_idx"):l===5&&(r.opacity=s.readVarint())}function xT(l){return new pi((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function Dne(l,r,s){l===1?(r.rgb_color=xT(s.readVarint()),r.paint="rgb_color"):l===2?(r.linear_gradient_idx=s.readVarint(),r.paint="linear_gradient_idx"):l===3?(r.radial_gradient_idx=s.readVarint(),r.paint="radial_gradient_idx"):l===5?s.readPackedFloat(r.dasharray):l===6?r.dashoffset=s.readFloat():l===7?r.miterlimit=s.readFloat():l===8?r.opacity=s.readVarint():l===9?r.width=s.readFloat():l===10?r.linecap=s.readVarint():l===11&&(r.linejoin=s.readVarint())}function kne(l,r,s){l===1?r.transform=vT(s,s.readVarint()+s.pos):l===2?r.spread_method=s.readVarint():l===3?r.stops.push(RB(s,s.readVarint()+s.pos)):l===4?r.x1=s.readFloat():l===5?r.y1=s.readFloat():l===6?r.x2=s.readFloat():l===7&&(r.y2=s.readFloat())}function RB(l,r){return l.readFields(Lne,{offset:0,opacity:255,rgb_color:fM},r)}function Lne(l,r,s){l===1?r.offset=s.readFloat():l===2?r.opacity=s.readVarint():l===3&&(r.rgb_color=xT(s.readVarint()))}function Nne(l,r,s){l===1?r.transform=vT(s,s.readVarint()+s.pos):l===2?r.spread_method=s.readVarint():l===3?r.stops.push(RB(s,s.readVarint()+s.pos)):l===4?r.cx=s.readFloat():l===5?r.cy=s.readFloat():l===6?r.r=s.readFloat():l===7?r.fx=s.readFloat():l===8?r.fy=s.readFloat():l===9&&(r.fr=s.readFloat())}function zne(l,r,s){l===1?r.transform=vT(s,s.readVarint()+s.pos):l===2?r.clip_path_idx=s.readVarint():l===3&&r.children.push(_T(s,s.readVarint()+s.pos))}function jne(l,r,s){l===1?r.left=r.top=s.readFloat():l===2?r.width=r.height=s.readFloat():l===3?r.top=s.readFloat():l===4?r.height=s.readFloat():l===5?r.mask_type=s.readVarint():l===6?r.mask_idx=s.readVarint():l===7&&r.children.push(_T(s,s.readVarint()+s.pos))}class Bne{static calculate(r={},s=[]){const h=new Map,p=new Map;if(Object.keys(r).length===0)return h;s.forEach((_=>{p.set(_.name,_.rgb_color||new pi(0,0,0))}));for(const[_,x]of Object.entries(r))p.has(_)?h.set(p.get(_).toString(),x):console.warn(`Ignoring unknown image variable "${_}"`);return h}}function rx(l,r=255,s){const h=r/255,p=l.toString(),_=s.has(p)?s.get(p).clone():l.clone();return _.a*=h,_.toString()}function Vb(l,r){if(!sh()){const s=document.createElement("canvas");return s.width=l,s.height=r,s}return new OffscreenCanvas(l,r)}function Fne(l,r){const s=Bne.calculate(r.params,l.metadata?l.metadata.variables:[]),h=l.usvg_tree,p=h.width,_=h.height,x=r.transform?r.transform:new DOMMatrix,E=Math.max(1,Math.round(p*x.a)),O=Math.max(1,Math.round(_*x.d)),R=new DOMMatrix([E/p,0,0,O/_,0,0]),z=Vb(E,O).getContext("2d");return gM(z,R,h,h,s),z.getImageData(0,0,E,O)}function gM(l,r,s,h,p){for(const _ of h.children)IB(l,r,s,_,p)}function IB(l,r,s,h,p){h.group?(l.save(),(function(_,x,E,O,R){const z=O.mask_idx!=null?E.masks[O.mask_idx]:null,j=O.clip_path_idx!=null?E.clip_paths[O.clip_path_idx]:null;if(O.transform&&(x=ix(O.transform).preMultiplySelf(x)),!(function(Z,ae,se){return Z.opacity!==255||ae||se})(O,j!=null,z!=null))return void gM(_,x,E,O,R);const B=Vb(_.canvas.width,_.canvas.height),X=B.getContext("2d");gM(X,x,E,O,R),j&&BB(X,x,E,j),z&&FB(X,x,E,z,R),_.globalAlpha=O.opacity/255,_.drawImage(B,0,0)})(l,r,s,h.group,p),l.restore()):h.path&&(l.save(),(function(_,x,E,O,R){_.setTransform(x),O.paint_order===bne.PAINT_ORDER_FILL_AND_STROKE?(DB(_,E,O,R),LB(_,E,O,R)):(LB(_,E,O,R),DB(_,E,O,R))})(l,r,s,h.path,p),l.restore())}function DB(l,r,s,h){const p=s.fill;if(!p)return;const _=p.opacity/255;switch(l.save(),l.beginPath(),VB(s,l),p.paint){case"rgb_color":l.fillStyle=rx(p.rgb_color,p.opacity,h);break;case"linear_gradient_idx":{const x=r.linear_gradients[p.linear_gradient_idx];x.transform&&l.setTransform(ix(x.transform).preMultiplySelf(l.getTransform())),l.fillStyle=NB(l,x,_,h);break}case"radial_gradient_idx":{const x=r.radial_gradients[p.radial_gradient_idx];x.transform&&l.setTransform(ix(x.transform).preMultiplySelf(l.getTransform())),l.fillStyle=zB(l,x,_,h)}}l.fill(kB(s)),l.restore()}function kB(l){return l.rule===pM.PATH_RULE_NON_ZERO?"nonzero":l.rule===pM.PATH_RULE_EVEN_ODD?"evenodd":void 0}function LB(l,r,s,h){const p=s.stroke;if(!p)return;const _=UB(s);l.lineWidth=p.width,l.miterLimit=p.miterlimit,l.setLineDash(p.dasharray),l.lineDashOffset=p.dashoffset;const x=p.opacity/255;switch(p.paint){case"rgb_color":l.strokeStyle=rx(p.rgb_color,p.opacity,h);break;case"linear_gradient_idx":l.strokeStyle=NB(l,r.linear_gradients[p.linear_gradient_idx],x,h,!0);break;case"radial_gradient_idx":l.strokeStyle=zB(l,r.radial_gradients[p.radial_gradient_idx],x,h,!0)}switch(p.linejoin){case yT.LINE_JOIN_MITER_CLIP:case yT.LINE_JOIN_MITER:l.lineJoin="miter";break;case yT.LINE_JOIN_ROUND:l.lineJoin="round";break;case yT.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(p.linecap){case mM.LINE_CAP_BUTT:l.lineCap="butt";break;case mM.LINE_CAP_ROUND:l.lineCap="round";break;case mM.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(_)}function NB(l,r,s,h,p=!1){if(r.stops.length===1){const B=r.stops[0];return rx(B.rgb_color,B.opacity*s,h)}const{x1:_,y1:x,x2:E,y2:O}=r;let R=new DOMPoint(_,x),z=new DOMPoint(E,O);if(p){const B=ix(r.transform);R=B.transformPoint(R),z=B.transformPoint(z)}const j=l.createLinearGradient(R.x,R.y,z.x,z.y);for(const B of r.stops)j.addColorStop(B.offset,rx(B.rgb_color,B.opacity*s,h));return j}function zB(l,r,s,h,p=!1){if(r.stops.length===1){const pe=r.stops[0];return rx(pe.rgb_color,pe.opacity*s,h)}const _=ix(r.transform),{fx:x,fy:E,fr:O,cx:R,cy:z,r:j}=r;let B=new DOMPoint(x,E),X=new DOMPoint(R,z),Z=O,ae=j;if(p){B=_.transformPoint(B),X=_.transformPoint(X);const pe=(_.a+_.d)/2;Z=O*pe,ae=r.r*pe}const se=l.createRadialGradient(B.x,B.y,Z,X.x,X.y,ae);for(const pe of r.stops)se.addColorStop(pe.offset,rx(pe.rgb_color,pe.opacity*s,h));return se}function jB(l,r,s,h){const p=h.transform?ix(h.transform).preMultiplySelf(r):r,_=Vb(l.canvas.width,l.canvas.height),x=_.getContext("2d");for(const O of h.children)if(O.group)jB(x,p,s,O.group);else if(O.path){const R=O.path,z=new Path2D;z.addPath(UB(R),p),x.fill(z,kB(R))}const E=h.clip_path_idx!=null?s.clip_paths[h.clip_path_idx]:null;E&&BB(x,p,s,E),l.globalCompositeOperation="source-over",l.drawImage(_,0,0)}function BB(l,r,s,h){const p=Vb(l.canvas.width,l.canvas.height);jB(p.getContext("2d"),r,s,h),l.globalCompositeOperation="destination-in",l.drawImage(p,0,0)}function FB(l,r,s,h,p){if(h.children.length===0)return;const _=h.mask_idx!=null?s.masks[h.mask_idx]:null;_&&FB(l,r,s,_,p);const x=l.canvas.width,E=l.canvas.height,O=Vb(x,E),R=O.getContext("2d"),z=h.width,j=h.height,B=h.left,X=h.top,Z=new Path2D,ae=new Path2D;ae.rect(B,X,z,j),Z.addPath(ae,r),R.clip(Z);for(const we of h.children)IB(R,r,s,we,p);const se=R.getImageData(0,0,x,E),pe=se.data;if(h.mask_type===PB.MASK_TYPE_LUMINANCE)for(let we=0;we<pe.length;we+=4)pe[we+3]=pe[we+3]/255*(.2126*pe[we]+.7152*pe[we+1]+.0722*pe[we+2]);R.putImageData(se,0,0),l.globalCompositeOperation="destination-in",l.drawImage(O,0,0)}function ix(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function VB(l,r){const s=l.step;let h=l.diffs[0]*s,p=l.diffs[1]*s;r.moveTo(h,p);for(let _=0,x=2;_<l.commands.length;_++)switch(l.commands[_]){case Fb.PATH_COMMAND_MOVE:h+=l.diffs[x++]*s,p+=l.diffs[x++]*s,r.moveTo(h,p);break;case Fb.PATH_COMMAND_LINE:h+=l.diffs[x++]*s,p+=l.diffs[x++]*s,r.lineTo(h,p);break;case Fb.PATH_COMMAND_QUAD:{const E=h+l.diffs[x++]*s,O=p+l.diffs[x++]*s;h=E+l.diffs[x++]*s,p=O+l.diffs[x++]*s,r.quadraticCurveTo(E,O,h,p);break}case Fb.PATH_COMMAND_CUBIC:{const E=h+l.diffs[x++]*s,O=p+l.diffs[x++]*s,R=E+l.diffs[x++]*s,z=O+l.diffs[x++]*s;h=R+l.diffs[x++]*s,p=z+l.diffs[x++]*s,r.bezierCurveTo(E,O,R,z,h,p);break}case Fb.PATH_COMMAND_CLOSE:r.closePath()}return r}function UB(l){return VB(l,new Path2D)}class bT{constructor(r){this.capacity=r,this.cache=new Map}get(r){if(!this.cache.has(r))return;const s=this.cache.get(r);return this.cache.delete(r),this.cache.set(r,s),s}put(r,s){this.cache.has(r)?this.cache.delete(r):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(r,s)}delete(r){this.cache.delete(r)}}Rn(bT,"LRUCache");class yM{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(r){return new Fo(r,r.data)}getFromCache(r,s,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new bT(150)),this.cacheMap.get(h).get(Dh(r.toString(),s))}setInCache(r,s,h,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new bT(150));const _=this.cacheDependenciesMap.get(p),x=Dh(r.id.toString(),h);_.get(x)||_.set(x,new Set);const E=this.cacheMap.get(p),O=r.toString();_.get(x).add(O),E.put(Dh(r.toString(),h),s)}removeImagesFromCacheByIds(r,s,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const p=this.cacheMap.get(h),_=this.cacheDependenciesMap.get(h);for(const x of r){const E=Dh(x.toString(),s);if(_.has(E)){for(const O of _.get(E))p.delete(O);_.delete(E)}}}rasterize(r,s,h,p,_=Fne){const x=this.getFromCache(r,h,p);if(x)return x.clone();const E=_(s.icon,r.options),O=yM._getImage(E);return this.setInCache(r,O,h,p),O.clone()}}class $B{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,s){const h=this.toIdx(r,s);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(r,s){return this.leaves[this.toIdx(r,s)]}toIdx(r,s){return s*this.size+r}}function qB(l,r,s,h){let p=0,_=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(h[x])<1e-15){if(s[x]<l[x]||s[x]>r[x])return null}else{const E=1/h[x];let O=(l[x]-s[x])*E,R=(r[x]-s[x])*E;if(O>R){const z=O;O=R,R=z}if(O>p&&(p=O),R<_&&(_=R),p>_)return null}return p}function HB(l,r,s,h,p,_,x,E,O,R,z){const j=h-l,B=p-r,X=_-s,Z=x-l,ae=E-r,se=O-s,pe=z[1]*se-z[2]*ae,we=z[2]*Z-z[0]*se,be=z[0]*ae-z[1]*Z,Ee=j*pe+B*we+X*be;if(Math.abs(Ee)<1e-15)return null;const Ge=1/Ee,Ue=R[0]-l,$e=R[1]-r,Je=R[2]-s,it=(Ue*pe+$e*we+Je*be)*Ge;if(it<0||it>1)return null;const Mt=$e*X-Je*B,ut=Je*j-Ue*X,Dt=Ue*B-$e*j,ln=(z[0]*Mt+z[1]*ut+z[2]*Dt)*Ge;return ln<0||it+ln>1?null:(Z*Mt+ae*ut+se*Dt)*Ge}function GB(l,r,s){return(l-r)/(s-r)}function WB(l,r,s,h,p,_,x,E,O){const R=1<<s,z=_-h,j=x-p,B=(l+1)/R*z+h,X=(r+0)/R*j+p,Z=(r+1)/R*j+p;E[0]=(l+0)/R*z+h,E[1]=X,O[0]=B,O[1]=Z}class XB{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=(function(_){const x=Math.ceil(Math.log2(_.dim/8)),E=[];let O=Math.ceil(Math.pow(2,x));const R=1/O,z=(X,Z,ae,se,pe)=>{const we=se?1:0,be=(X+1)*ae-we,Ee=Z*ae,Ge=(Z+1)*ae-we;pe[0]=X*ae,pe[1]=Ee,pe[2]=be,pe[3]=Ge};let j=new $B(O);const B=[];for(let X=0;X<O*O;X++){z(X%O,Math.floor(X/O),R,!1,B);const Z=Wg(B[0],B[1],_),ae=Wg(B[2],B[1],_),se=Wg(B[2],B[3],_),pe=Wg(B[0],B[3],_);j.minimums.push(Math.min(Z,ae,se,pe)),j.maximums.push(Math.max(Z,ae,se,pe)),j.leaves.push(1)}for(E.push(j),O/=2;O>=1;O/=2){const X=E[E.length-1];j=new $B(O);for(let Z=0;Z<O*O;Z++){z(Z%O,Math.floor(Z/O),2,!0,B);const ae=X.getElevation(B[0],B[1]),se=X.getElevation(B[2],B[1]),pe=X.getElevation(B[2],B[3]),we=X.getElevation(B[0],B[3]),be=X.isLeaf(B[0],B[1]),Ee=X.isLeaf(B[2],B[1]),Ge=X.isLeaf(B[2],B[3]),Ue=X.isLeaf(B[0],B[3]),$e=Math.min(ae.min,se.min,pe.min,we.min),Je=Math.max(ae.max,se.max,pe.max,we.max),it=be&&Ee&&Ge&&Ue;j.maximums.push(Je),j.minimums.push($e),j.leaves.push(Je-$e<=5&&it?1:0)}E.push(j)}return E})(this.dem),h=s.length-1,p=s[h];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(s,0,0,h,0)}raycastRoot(r,s,h,p,_,x,E=1){return qB([r,s,-100],[h,p,this.maximums[0]*E],_,x)}raycast(r,s,h,p,_,x,E=1){if(!this.nodeCount)return null;const O=this.raycastRoot(r,s,h,p,_,x,E);if(O==null)return null;const R=[],z=[],j=[],B=[],X=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;X.length>0;){const{idx:Z,t:ae,nodex:se,nodey:pe,depth:we}=X.pop();if(this.leaves[Z]){WB(se,pe,we,r,s,h,p,j,B);const Ee=1<<we,Ge=(se+0)/Ee,Ue=(se+1)/Ee,$e=(pe+0)/Ee,Je=(pe+1)/Ee,it=Wg(Ge,$e,this.dem)*E,Mt=Wg(Ue,$e,this.dem)*E,ut=Wg(Ue,Je,this.dem)*E,Dt=Wg(Ge,Je,this.dem)*E,ln=HB(j[0],j[1],it,B[0],j[1],Mt,B[0],B[1],ut,_,x),Vt=HB(B[0],B[1],ut,j[0],B[1],Dt,j[0],j[1],it,_,x),Yt=Math.min(ln!==null?ln:Number.MAX_VALUE,Vt!==null?Vt:Number.MAX_VALUE);if(Yt!==Number.MAX_VALUE)return Yt;{const on=nt([],_,x,ae);if(ZB(it,Mt,Dt,ut,GB(on[0],j[0],B[0]),GB(on[1],j[1],B[1]))>=on[2])return ae}continue}let be=0;for(let Ee=0;Ee<this._siblingOffset.length;Ee++){WB((se<<1)+this._siblingOffset[Ee][0],(pe<<1)+this._siblingOffset[Ee][1],we+1,r,s,h,p,j,B),j[2]=-100,B[2]=this.maximums[this.childOffsets[Z]+Ee]*E;const Ge=qB(j,B,_,x);if(Ge!=null){const Ue=Ge;R[Ee]=Ue;let $e=!1;for(let Je=0;Je<be&&!$e;Je++)Ue>=R[z[Je]]&&(z.splice(Je,0,Ee),$e=!0);$e||(z[be]=Ee),be++}}for(let Ee=0;Ee<be;Ee++){const Ge=z[Ee];X.push({idx:this.childOffsets[Z]+Ge,t:R[Ge],nodex:(se<<1)+this._siblingOffset[Ge][0],nodey:(pe<<1)+this._siblingOffset[Ge][1],depth:we+1})}}return null}_addNode(r,s,h){return this.minimums.push(r),this.maximums.push(s),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(r,s,h,p,_){if(r[p].isLeaf(s,h)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const x=p-1,E=r[x];let O=0,R=0;for(let z=0;z<this._siblingOffset.length;z++){const j=2*s+this._siblingOffset[z][0],B=2*h+this._siblingOffset[z][1],X=E.getElevation(j,B),Z=E.isLeaf(j,B),ae=this._addNode(X.min,X.max,Z);Z&&(O|=1<<z),R||(R=ae)}for(let z=0;z<this._siblingOffset.length;z++)O&1<<z||this._construct(r,2*s+this._siblingOffset[z][0],2*h+this._siblingOffset[z][1],x,R+z)}}function ZB(l,r,s,h,p,_){return Gn(Gn(l,s,_),Gn(r,h,_),p)}function Wg(l,r,s){const h=s.dim,p=Pe(l*h-.5,0,h-1),_=Pe(r*h-.5,0,h-1),x=Math.floor(p),E=Math.floor(_),O=Math.min(x+1,h-1),R=Math.min(E+1,h-1);return ZB(s.get(x,E),s.get(O,E),s.get(x,R),s.get(O,R),p-x,_-E)}const Vne={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Une(l,r,s){return(256*l*256+256*r+s)/10-1e4}function $ne(l,r,s){return 256*l+r+s/256-32768}class wT{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,s,h,p=!1){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void jr(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const _=this.dim=s.height-2,x=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let O=0;O<_;O++)x[this._idx(-1,O)]=x[this._idx(0,O)],x[this._idx(_,O)]=x[this._idx(_-1,O)],x[this._idx(O,-1)]=x[this._idx(O,0)],x[this._idx(O,_)]=x[this._idx(O,_-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(_,-1)]=x[this._idx(_-1,0)],x[this._idx(-1,_)]=x[this._idx(0,_-1)],x[this._idx(_,_)]=x[this._idx(_-1,_-1)]}const E=h==="terrarium"?$ne:Une;for(let O=0;O<x.length;++O){const R=4*O;this.floatView[O]=E(this.pixels[R],this.pixels[R+1],this.pixels[R+2])}this._timestamp=ls.now()}_buildQuadTree(){this._tree=new XB(this)}get(r,s,h=!1){h&&(r=Pe(r,-1,this.dim),s=Pe(s,-1,this.dim));const p=this._idx(r,s);return this.floatView[p]}set(r,s,h){const p=this._idx(r,s),_=this.floatView[p];return this.floatView[p]=h,h-_}static getUnpackVector(r){return Vne[r]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}static pack(r,s){const h=[0,0,0,0],p=wT.getUnpackVector(s);let _=Math.floor((r+p[3])/p[2]);return h[2]=_%256,_=Math.floor(_/256),h[1]=_%256,_=Math.floor(_/256),h[0]=_,h}getPixels(){return new kg({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,s,h){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,_=s*this.dim+this.dim,x=h*this.dim,E=h*this.dim+this.dim;switch(s){case-1:p=_-1;break;case 1:_=p+1}switch(h){case-1:x=E-1;break;case 1:E=x+1}const O=-s*this.dim,R=-h*this.dim;for(let z=x;z<E;z++)for(let j=p;j<_;j++){const B=4*this._idx(j,z),X=4*this._idx(j+O,z+R);this.pixels[B+0]=r.pixels[X+0],this.pixels[B+1]=r.pixels[X+1],this.pixels[B+2]=r.pixels[X+2],this.pixels[B+3]=r.pixels[X+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function qne(l,r,s){l===1?r.headerLength=s.readFixed32():l===2?r.x=s.readVarint():l===3?r.y=s.readVarint():l===4?r.z=s.readVarint():l===5&&r.layers.push((function(h,p){return h.readFields(Zne,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)})(s,s.readVarint()+s.pos))}function Hne(l,r,s){l===1?(r.delta_filter=(function(h,p){return h.readFields(Gne,{blockSize:0},p)})(s,s.readVarint()+s.pos),r.filter="delta_filter"):l===2?(s.readVarint(),r.filter="zigzag_filter"):l===3?(s.readVarint(),r.filter="bitshuffle_filter"):l===4&&(s.readVarint(),r.filter="byteshuffle_filter")}function Gne(l,r,s){l===1&&(r.blockSize=s.readVarint())}function Wne(l,r,s){l===1?(s.readVarint(),r.codec="gzip_data"):l===2?(s.readVarint(),r.codec="jpeg_image"):l===3?(s.readVarint(),r.codec="webp_image"):l===4&&(s.readVarint(),r.codec="png_image")}function Xne(l,r,s){let h=0,p=0;l===1?r.firstByte=s.readFixed64():l===2?r.lastByte=s.readFixed64():l===3?r.filters.push((function(_,x){return _.readFields(Hne,{},x)})(s,s.readVarint()+s.pos)):l===4?r.codec=(function(_,x){return _.readFields(Wne,{},x)})(s,s.readVarint()+s.pos):l===5?p=s.readFloat():l===6?h=s.readFloat():l===7?r.bands.push(s.readString()):l===8?r.offset=s.readDouble():l===9&&(r.scale=s.readDouble()),r.offset===0&&(r.offset=p),r.scale===0&&(r.scale=h)}function Zne(l,r,s){l===1?r.version=s.readVarint():l===2?r.name=s.readString():l===3?r.units=s.readString():l===4?r.tileSize=s.readVarint():l===5?r.buffer=s.readVarint():l===6?r.pixelFormat=s.readVarint():l===7&&r.dataIndex.push((function(h,p){return h.readFields(Xne,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)})(s,s.readVarint()+s.pos))}function Yne(l,r,s){if(l===2)(function(h,p,_){h.readFields(Kne,_,p)})(s,s.readVarint()+s.pos,r);else if(l===3)throw new Error("Not implemented")}function Kne(l,r,s){if(l===1){let h=0;const p=s.readVarint()+s.pos;for(;s.pos<p;)r[h++]=s.readVarint()}}function Jne(l,r){if(r.length!==4)throw new Error(`Expected data of dimension 4 but got ${r.length}.`);let s=r[3];for(let h=2;h>=1;h--){const p=h===1?1:0,_=h===2?1:0;for(let x=0;x<r[0];x++){const E=r[1]*x;for(let O=p;O<r[1];O++){const R=r[2]*(O+E);for(let z=_;z<r[2];z++){const j=r[3]*(z+R);for(let B=0;B<r[3];B++){const X=j+B;l[X]+=l[X-s]}}}}s*=r[h]}return l}function Qne(l){for(let r=0,s=l.length;r<s;r++)l[r]=l[r]>>>1^-(1&l[r]);return l}function ere(l,r){switch(r){case"uint32":return l;case"uint16":for(let s=0;s<l.length;s+=2){const h=l[s],p=l[s+1];l[s]=(240&h)>>4|(61440&h)>>8|(240&p)<<4|61440&p,l[s+1]=15&h|(3840&h)>>4|(15&p)<<8|(3840&p)<<4}return l;case"uint8":for(let s=0;s<l.length;s+=4){const h=l[s],p=l[s+1],_=l[s+2],x=l[s+3];l[s+0]=(192&h)>>6|(192&p)>>4|(192&_)>>2|192&x,l[s+1]=(48&h)>>4|(48&p)>>2|48&_|(48&x)<<2,l[s+2]=(12&h)>>2|12&p|(12&_)<<2|(12&x)<<4,l[s+3]=3&h|(3&p)<<2|(3&_)<<4|(3&x)<<6}return l;default:throw new Error(`Invalid pixel format, "${r}"`)}}Rn(wT,"DEMData"),Rn(XB,"DemMinMaxQuadTree",{omit:["dem"]});var Zu=Uint8Array,Ub=Uint16Array,tre=Int32Array,YB=new Zu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),KB=new Zu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nre=new Zu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),JB=function(l,r){for(var s=new Ub(31),h=0;h<31;++h)s[h]=r+=1<<l[h-1];var p=new tre(s[30]);for(h=1;h<30;++h)for(var _=s[h];_<s[h+1];++_)p[_]=_-s[h]<<5|h;return{b:s,r:p}},QB=JB(YB,2),eF=QB.b,rre=QB.r;eF[28]=258,rre[258]=28;for(var ire=JB(KB,0).b,tF=new Ub(32768),ko=0;ko<32768;++ko){var ax=(43690&ko)>>1|(21845&ko)<<1;tF[ko]=((65280&(ax=(61680&(ax=(52428&ax)>>2|(13107&ax)<<2))>>4|(3855&ax)<<4))>>8|(255&ax)<<8)>>1}var $b=function(l,r,s){for(var h=l.length,p=0,_=new Ub(r);p<h;++p)l[p]&&++_[l[p]-1];var x,E=new Ub(r);for(p=1;p<r;++p)E[p]=E[p-1]+_[p-1]<<1;x=new Ub(1<<r);var O=15-r;for(p=0;p<h;++p)if(l[p])for(var R=p<<4|l[p],z=r-l[p],j=E[l[p]-1]++<<z,B=j|(1<<z)-1;j<=B;++j)x[tF[j]>>O]=R;return x},qb=new Zu(288);for(ko=0;ko<144;++ko)qb[ko]=8;for(ko=144;ko<256;++ko)qb[ko]=9;for(ko=256;ko<280;++ko)qb[ko]=7;for(ko=280;ko<288;++ko)qb[ko]=8;var nF=new Zu(32);for(ko=0;ko<32;++ko)nF[ko]=5;var are=$b(qb,9),ore=$b(nF,5),_M=function(l){for(var r=l[0],s=1;s<l.length;++s)l[s]>r&&(r=l[s]);return r},jd=function(l,r,s){var h=r/8|0;return(l[h]|l[h+1]<<8)>>(7&r)&s},vM=function(l,r){var s=r/8|0;return(l[s]|l[s+1]<<8|l[s+2]<<16)>>(7&r)},sre=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Bd=function(l,r,s){var h=new Error(r||sre[l]);if(h.code=l,Error.captureStackTrace&&Error.captureStackTrace(h,Bd),!s)throw h;return h},lre=new Zu(0),cre=typeof TextDecoder<"u"&&new TextDecoder;try{cre.decode(lre,{stream:!0})}catch{}const ure={gzip_data:"gzip"};class Vh extends Error{constructor(r){super(r),this.name="MRTError"}}const hre={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},rF={uint32:1,uint16:2,uint8:4},dre={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let xM;class ST{constructor(r=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=r}getLayer(r){const s=this.layers[r];if(!s)throw new Vh(`Layer '${r}' not found`);return s}getHeaderLength(r){const s=new Uint8Array(r),h=new DataView(r);if(s[0]!==13)throw new Vh("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(r){const s=new Uint8Array(r),h=this.getHeaderLength(r);if(s.length<h)throw new Vh(`Expected header with length >= ${h} but got buffer of length ${s.length}`);const p=new xM(s.subarray(0,h)).readFields(qne,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new Vh(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const _ of p.layers)this.layers[_.name]=new iF(_,{cacheSize:this._cacheSize});return this}createDecodingTask(r){const s=[],h=this.getLayer(r.layerName);for(let p of r.blockIndices){const _=h.dataIndex[p],x=_.firstByte-r.firstByte,E=_.lastByte-r.firstByte;if(h._blocksInProgress.has(p))continue;const O={layerName:h.name,firstByte:x,lastByte:E,pixelFormat:h.pixelFormat,blockIndex:p,blockShape:[_.bands.length].concat(h.bandShape),buffer:h.buffer,codec:_.codec.codec,filters:_.filters.map((R=>R.filter))};h._blocksInProgress.add(p),s.push(O)}return new aF(s,(()=>{s.forEach((p=>h._blocksInProgress.delete(p.blockIndex)))}),((p,_)=>{if(s.forEach((x=>h._blocksInProgress.delete(x.blockIndex))),p)throw p;_.forEach((x=>{this.getLayer(x.layerName).processDecodedData(x)}))}))}}class iF{constructor({version:r,name:s,units:h,tileSize:p,pixelFormat:_,buffer:x,dataIndex:E},O){if(this.version=r,this.version!==1)throw new Vh(`Cannot parse raster layer encoded with MRT version ${r}`);this.name=s,this.units=h,this.tileSize=p,this.buffer=x,this.pixelFormat=hre[_],this.dataIndex=E,this.bandShape=[p+2*x,p+2*x,rF[this.pixelFormat]],this._decodedBlocks=new bT(O?O.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return rF[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:r})=>r)).flat()}processDecodedData(r){const s=r.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,r.data)}getBlockForBand(r){let s=0;switch(typeof r){case"string":for(const[h,p]of this.dataIndex.entries()){for(const[_,x]of p.bands.entries())if(x===r)return{bandIndex:s+_,blockIndex:h,blockBandIndex:_};s+=p.bands.length}break;case"number":for(const[h,p]of this.dataIndex.entries()){if(r>=s&&r<s+p.bands.length)return{bandIndex:r,blockIndex:h,blockBandIndex:r-s};s+=p.bands.length}break;default:throw new Vh(`Invalid band \`${JSON.stringify(r)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(r){let s=1/0,h=-1/0;const p=[],_=new Set;for(const x of r){const{blockIndex:E}=this.getBlockForBand(x);if(E<0)throw new Vh(`Invalid band: ${JSON.stringify(x)}`);const O=this.dataIndex[E];p.includes(E)||p.push(E),_.add(E),s=Math.min(s,O.firstByte),h=Math.max(h,O.lastByte)}if(_.size>this.cacheSize)throw new Vh(`Number of blocks to decode (${_.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:h,blockIndices:p}}hasBand(r){const{blockIndex:s}=this.getBlockForBand(r);return s>=0}hasDataForBand(r){const{blockIndex:s}=this.getBlockForBand(r);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(r){const{blockIndex:s,blockBandIndex:h}=this.getBlockForBand(r);if(s<0)throw new Vh(`Band not found: ${JSON.stringify(r)}`);const p=this._decodedBlocks.get(s.toString());if(!p)throw new Vh(`Data for band ${JSON.stringify(r)} of layer "${this.name}" not decoded.`);const _=this.dataIndex[s],x=this.bandShape.reduce(((R,z)=>R*z),1),E=h*x,O=p.subarray(E,E+x);return{data:O,bytes:new Uint8Array(O.buffer).subarray(O.byteOffset,O.byteOffset+O.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:_.offset,scale:_.scale}}}ST.setPbf=function(l){xM=l};class aF{constructor(r,s,h){this.tasks=r,this._onCancel=s,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(r,s){this._finalized||(this._onComplete(r,s),this._finalized=!0)}}ST.performDecoding=function(l,r){const s=new Uint8Array(l);return Promise.all(r.tasks.map((h=>{const{layerName:p,firstByte:_,lastByte:x,pixelFormat:E,blockShape:O,blockIndex:R,filters:z,codec:j}=h,B=s.subarray(_,x+1),X=new Uint32Array(O[0]*O[1]*O[2]);let Z;if(j!=="gzip_data")throw new Vh(`Unhandled codec: ${j}`);return Z=(function(ae,se){if(!globalThis.DecompressionStream&&se==="gzip_data")return Promise.resolve(((Ee=(function($e){$e[0]==31&&$e[1]==139&&$e[2]==8||Bd(6,"invalid gzip data");var Je=$e[3],it=10;4&Je&&(it+=2+($e[10]|$e[11]<<8));for(var Mt=(Je>>3&1)+(Je>>4&1);Mt>0;Mt-=!$e[it++]);return it+(2&Je)})(be=ae))+8>be.length&&Bd(6,"invalid gzip data"),(function($e,Je,it,Mt){var ut=$e.length;if(!ut||Je.f&&!Je.l)return it||new Zu(0);var Dt=!it,ln=Dt||Je.i!=2,Vt=Je.i;Dt&&(it=new Zu(3*ut));var Yt,on,At=function(_a){var Qi=it.length;if(_a>Qi){var $i=new Zu(Math.max(2*Qi,_a));$i.set(it),it=$i}},Kt=Je.f||0,pt=Je.p||0,Ct=Je.b||0,un=Je.l,Qt=Je.d,Un=Je.m,kn=Je.n,Xt=8*ut;do{if(!un){Kt=jd($e,pt,1);var an=jd($e,pt+1,3);if(pt+=3,!an){var Nn=$e[(Oe=4+((pt+7)/8|0))-4]|$e[Oe-3]<<8,Cn=Oe+Nn;if(Cn>ut){Vt&&Bd(0);break}ln&&At(Ct+Nn),it.set($e.subarray(Oe,Cn),Ct),Je.b=Ct+=Nn,Je.p=pt=8*Cn,Je.f=Kt;continue}if(an==1)un=are,Qt=ore,Un=9,kn=5;else if(an==2){var pn=jd($e,pt,31)+257,On=jd($e,pt+10,15)+4,Jn=pn+jd($e,pt+5,31)+1;pt+=14;for(var or=new Zu(Jn),wr=new Zu(19),ur=0;ur<On;++ur)wr[nre[ur]]=jd($e,pt+3*ur,7);pt+=3*On;var Xr=_M(wr),Lr=(1<<Xr)-1,Ji=$b(wr,Xr);for(ur=0;ur<Jn;){var Oe,Re=Ji[jd($e,pt,Lr)];if(pt+=15&Re,(Oe=Re>>4)<16)or[ur++]=Oe;else{var Et=0,hn=0;for(Oe==16?(hn=3+jd($e,pt,3),pt+=2,Et=or[ur-1]):Oe==17?(hn=3+jd($e,pt,7),pt+=3):Oe==18&&(hn=11+jd($e,pt,127),pt+=7);hn--;)or[ur++]=Et}}var vn=or.subarray(0,pn),_n=or.subarray(pn);Un=_M(vn),kn=_M(_n),un=$b(vn,Un),Qt=$b(_n,kn)}else Bd(1);if(pt>Xt){Vt&&Bd(0);break}}ln&&At(Ct+131072);for(var Ln=(1<<Un)-1,ar=(1<<kn)-1,Hr=pt;;Hr=pt){var Gr=(Et=un[vM($e,pt)&Ln])>>4;if((pt+=15&Et)>Xt){Vt&&Bd(0);break}if(Et||Bd(2),Gr<256)it[Ct++]=Gr;else{if(Gr==256){Hr=pt,un=null;break}var Pr=Gr-254;Gr>264&&(Pr=jd($e,pt,(1<<(Er=YB[ur=Gr-257]))-1)+eF[ur],pt+=Er);var Ni=Qt[vM($e,pt)&ar],Aa=Ni>>4;if(Ni||Bd(3),pt+=15&Ni,_n=ire[Aa],Aa>3){var Er=KB[Aa];_n+=vM($e,pt)&(1<<Er)-1,pt+=Er}if(pt>Xt){Vt&&Bd(0);break}ln&&At(Ct+131072);var ia=Ct+Pr;if(Ct<_n){var Ui=0-_n,Ci=Math.min(_n,ia);for(Ui+Ct<0&&Bd(3);Ct<Ci;++Ct)it[Ct]=(void 0)[Ui+Ct]}for(;Ct<ia;++Ct)it[Ct]=it[Ct-_n]}}Je.l=un,Je.p=Hr,Je.b=Ct,Je.f=Kt,un&&(Kt=1,Je.m=Un,Je.d=Qt,Je.n=kn)}while(!Kt);return Ct!=it.length&&Dt?(Yt=it,((on=Ct)==null||on>Yt.length)&&(on=Yt.length),new Zu(Yt.subarray(0,on))):it.subarray(0,Ct)})(be.subarray(Ee,-8),{i:2},new Zu(((pe=be)[(we=pe.length)-4]|pe[we-3]<<8|pe[we-2]<<16|pe[we-1]<<24)>>>0))));var pe,we,be,Ee;const Ge=ure[se];if(!Ge)throw new Error(`Unhandled codec: ${se}`);const Ue=new globalThis.DecompressionStream(Ge);return new Response(new Blob([ae]).stream().pipeThrough(Ue)).arrayBuffer().then(($e=>new Uint8Array($e)))})(B,j).then((ae=>((function(se,pe){se.readFields(Yne,pe)})(new xM(ae),X),new dre[E](X.buffer)))),Z.then((ae=>{for(let se=z.length-1;se>=0;se--)switch(z[se]){case"delta_filter":Jne(ae,O);break;case"zigzag_filter":Qne(ae);break;case"bitshuffle_filter":ere(ae,E);break;default:throw new Vh(`Unhandled filter "${z[se]}"`)}return{layerName:p,blockIndex:R,data:ae}})).catch((ae=>{throw ae}))})))},Rn(aF,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Rn(ST,"MapboxRasterTile"),Rn(iF,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class oF{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const h=r[s];this._stringToNumber[h]=s,this._numberToString[s]=h}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const fre=["id","tile","layer","source","sourceLayer","state"];class ox{constructor(r,s,h,p,_){this.type="Feature",this._vectorTileFeature=r,this._z=s,this._x=h,this._y=p,this.properties=r.properties,this.id=_}clone(){const r=new ox(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(r.state=Object.assign({},this.state)),this.layer&&(r.layer=Object.assign({},this.layer)),this.source&&(r.source=this.source),this.sourceLayer&&(r.sourceLayer=this.sourceLayer),r}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of fre)this[s]!==void 0&&(r[s]=this[s]);return r}}class sF{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Du(nn,16,0),this.featureIndexArray=new e_,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(r,s,h,p,_,x=0,E=0){const O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,p,_,x);const R=this.grid;for(let z=0;z<s.length;z++){const j=s[z],B=[1/0,1/0,-1/0,-1/0];for(let X=0;X<j.length;X++){const Z=j[X];B[0]=Math.min(B[0],Z.x),B[1]=Math.min(B[1],Z.y),B[2]=Math.max(B[2],Z.x),B[3]=Math.max(B[3],Z.y)}E!==0&&(B[0]-=E,B[1]-=E,B[2]+=E,B[3]+=E),B[0]<nn&&B[1]<nn&&B[2]>=0&&B[3]>=0&&R.insert(O,B[0],B[1],B[2],B[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new gn(new KS(this.rawTileData)).layers,this.sourceLayerCoder=new oF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,s){const{tilespaceGeometry:h,transform:p,tileTransform:_,pixelPosMatrix:x,availableImages:E,worldview:O}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const R=h.bufferedTilespaceBounds,z=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,((Z,ae,se,pe)=>ma(h.bufferedTilespaceGeometry,Z,ae,se,pe)));z.sort(pre);let j=null;p.elevation&&z.length>0&&(j=nx.create(p.elevation,this.tileID));const B={};let X;for(let Z=0;Z<z.length;Z++){const ae=z[Z];if(ae===X)continue;X=ae;const se=this.featureIndexArray.get(ae);let pe=null;this.is3DTile?this.loadMatchingModelFeature(B,se,r,h,p,O):this.loadMatchingFeature(B,se,r,E,O,((we,be,Ee,Ge=0)=>(pe||(pe=We(we,this.tileID.canonical,_)),be.queryIntersectsFeature(h,we,Ee,pe,this.z,p,x,j,Ge))))}return B}loadMatchingFeature(r,s,h,p,_,x){const{featureIndex:E,bucketIndex:O,sourceLayerIndex:R,layoutVertexArrayOffset:z}=s,j=this.bucketLayerIDs[O],B=h.layers,X=Object.keys(B);if(X.length&&!Sr(X,j))return;const Z=h.sourceCache,ae=this.sourceLayerCoder.decode(R),se=this.vtLayers[ae].feature(E),pe=this.getId(se,ae);for(let we=0;we<j.length;we++){const be=j[we];if(!B[be])continue;const{styleLayer:Ee,targets:Ge}=B[be];let Ue={};pe!==void 0&&(Ue=Z.getFeatureState(Ee.sourceLayer,pe));const $e=!x||x(se,Ee,Ue,z);if(!$e)continue;const Je=new ox(se,this.z,this.x,this.y,pe);Je.tile=this.tileID.canonical,Je.state=Ue;let it=this.serializedLayersCache.get(be);it||(it=Ee.serialize(),it.id=be,this.serializedLayersCache.set(be,it)),Je.source=it.source,Je.sourceLayer=it["source-layer"],Je.layer=yt({},it),Je.layer.paint=lF(it.paint,Ee.paint,se,Ue,p),Je.layer.layout=lF(it.layout,Ee.layout,se,Ue,p);let Mt=!1;for(const ut of Ge){this.updateFeatureProperties(Je,ut);const{filter:Dt}=ut;if(Dt){if(se.properties=Je.properties,Dt.needGeometry){const ln=Tt(se,!0);if(!Dt.filter(new Ei(this.tileID.overscaledZ,{worldview:_}),ln,this.tileID.canonical))continue}else if(!Dt.filter(new Ei(this.tileID.overscaledZ,{worldview:_}),se))continue}Mt=!0,ut.targetId&&this.addFeatureVariant(Je,ut)}Mt&&this.appendToResult(r,be,E,Je,$e)}}loadMatchingModelFeature(r,s,h,p,_,x){const{featureIndex:E,bucketIndex:O}=s,R=this.bucketLayerIDs[O],z=h.layers,j=Object.keys(z);if(!j.length||Sr(j,R))for(let B=0;B<R.length;B++){const X=R[B],{styleLayer:Z,targets:ae}=z[X];if(Z.type!=="model")continue;const se=p.tile,pe=se.getBucket(Z);if(!(pe&&pe instanceof gT))continue;const we=vne(pe,E,p,_);if(!we)continue;const{z:be,x:Ee,y:Ge}=se.tileID.canonical,{feature:Ue,intersectionZ:$e,position:Je}=we;let it={};Ue.id!==void 0&&(it=h.sourceCache.getFeatureState(Z.sourceLayer,Ue.id));const Mt=new ox({},be,Ee,Ge,Ue.id);Mt.tile=this.tileID.canonical,Mt.state=it,Mt.properties=Ue.properties,Mt.geometry={type:"Point",coordinates:[Je.lng,Je.lat]};let ut=this.serializedLayersCache.get(X);ut||(ut=Z.serialize(),ut.id=X,this.serializedLayersCache.set(X,ut)),Mt.source=ut.source,Mt.sourceLayer=ut["source-layer"],Mt.layer=yt({},ut);let Dt=!1;for(const ln of ae){this.updateFeatureProperties(Mt,ln);const{filter:Vt}=ln;if(Vt){if(Ue.properties=Mt.properties,Vt.needGeometry){if(!Vt.filter(new Ei(this.tileID.overscaledZ,{worldview:x}),Ue,this.tileID.canonical))continue}else if(!Vt.filter(new Ei(this.tileID.overscaledZ,{worldview:x}),Ue))continue}Dt=!0,ln.targetId&&this.addFeatureVariant(Mt,ln)}Dt&&this.appendToResult(r,X,E,Mt,$e)}}updateFeatureProperties(r,s,h){if(s.properties){const p={};for(const _ in s.properties){const x=s.properties[_].evaluate({zoom:this.z},r._vectorTileFeature,r.state,r.tile,h);x!=null&&(p[_]=x)}r.properties=p}}addFeatureVariant(r,s,h){const p={target:s.target,namespace:s.namespace,uniqueFeatureID:s.uniqueFeatureID};s.properties&&(p.properties=r.properties),r.variants=r.variants||{},r.variants[s.targetId]=r.variants[s.targetId]||[],r.variants[s.targetId].push(p)}appendToResult(r,s,h,p,_){let x=r[s];x===void 0&&(x=r[s]=[]),x.push({featureIndex:h,feature:p,intersectionZ:_})}lookupSymbolFeatures(r,s,h,p,_,x){const E={};this.loadVTLayers();for(const O of r)this.loadMatchingFeature(E,{bucketIndex:s,sourceLayerIndex:h,featureIndex:O,layoutVertexArrayOffset:0},p,_,x);return E}loadFeature(r){const{featureIndex:s,sourceLayerIndex:h}=r;this.loadVTLayers();const p=this.sourceLayerCoder.decode(h),_=this.vtFeatures[p];if(_[s])return _[s];const x=this.vtLayers[p].feature(s);return _[s]=x,x}hasLayer(r){for(const s of this.bucketLayerIDs)for(const h of s)if(r===h)return!0;return!1}getId(r,s){let h=r.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[s];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const _=Yl(p);if(_.result!=="success"){const x=_.value.map((E=>`${E.key}: ${E.message}`)).join(", ");return void jr(`Failed to create expression for promoteId: ${x}`)}this.promoteIdExpression=_.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new mh),h=this.promoteIdExpression.evaluate({zoom:0},r)}else h=r.properties[p];typeof h=="boolean"&&(h=Number(h))}return h}}function lF(l,r,s,h,p){return Hn(l,((_,x)=>{const E=r instanceof Ql?r.get(x):null;return E&&E.evaluate?E.evaluate(s,h,void 0,p):E}))}function pre(l,r){return r-l}Rn(sF,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const cF=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bM{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,h]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=h>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const _=cF[15&h];if(!_)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[E]=new Uint32Array(r,4,1);return new bM(E,x,_,r)}constructor(r,s=64,h=Float64Array,p){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=h,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const _=cF.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,E=r*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-E%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${h}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+E+O,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+E+O),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+E+O,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=r,this.coords[this._pos++]=s,h}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return wM(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:E}=this,O=[0,_.length-1,0],R=[];for(;O.length;){const z=O.pop()||0,j=O.pop()||0,B=O.pop()||0;if(j-B<=E){for(let se=B;se<=j;se++){const pe=x[2*se],we=x[2*se+1];pe>=r&&pe<=h&&we>=s&&we<=p&&R.push(_[se])}continue}const X=B+j>>1,Z=x[2*X],ae=x[2*X+1];Z>=r&&Z<=h&&ae>=s&&ae<=p&&R.push(_[X]),(z===0?r<=Z:s<=ae)&&(O.push(B),O.push(X-1),O.push(1-z)),(z===0?h>=Z:p>=ae)&&(O.push(X+1),O.push(j),O.push(1-z))}return R}within(r,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:_,nodeSize:x}=this,E=[0,p.length-1,0],O=[],R=h*h;for(;E.length;){const z=E.pop()||0,j=E.pop()||0,B=E.pop()||0;if(j-B<=x){for(let se=B;se<=j;se++)hF(_[2*se],_[2*se+1],r,s)<=R&&O.push(p[se]);continue}const X=B+j>>1,Z=_[2*X],ae=_[2*X+1];hF(Z,ae,r,s)<=R&&O.push(p[X]),(z===0?r-h<=Z:s-h<=ae)&&(E.push(B),E.push(X-1),E.push(1-z)),(z===0?r+h>=Z:s+h>=ae)&&(E.push(X+1),E.push(j),E.push(1-z))}return O}}function wM(l,r,s,h,p,_){if(p-h<=s)return;const x=h+p>>1;uF(l,r,x,h,p,_),wM(l,r,s,h,x-1,1-_),wM(l,r,s,x+1,p,1-_)}function uF(l,r,s,h,p,_){for(;p>h;){if(p-h>600){const R=p-h+1,z=s-h+1,j=Math.log(R),B=.5*Math.exp(2*j/3),X=.5*Math.sqrt(j*B*(R-B)/R)*(z-R/2<0?-1:1);uF(l,r,s,Math.max(h,Math.floor(s-z*B/R+X)),Math.min(p,Math.floor(s+(R-z)*B/R+X)),_)}const x=r[2*s+_];let E=h,O=p;for(Hb(l,r,h,s),r[2*p+_]>x&&Hb(l,r,h,p);E<O;){for(Hb(l,r,E,O),E++,O--;r[2*E+_]<x;)E++;for(;r[2*O+_]>x;)O--}r[2*h+_]===x?Hb(l,r,h,O):(O++,Hb(l,r,O,p)),O<=s&&(h=O+1),s<=O&&(p=O-1)}}function Hb(l,r,s,h){SM(l,s,h),SM(r,2*s,2*h),SM(r,2*s+1,2*h+1)}function SM(l,r,s){const h=l[r];l[r]=l[s],l[s]=h}function hF(l,r,s,h){const p=l-s,_=r-h;return p*p+_*_}a.$=no,a.A=Cl,a.B=Ml,a.C=Dh,a.D=Sn,a.E=yu,a.F=2,a.G=Rb,a.H=z3,a.I=Ms,a.J=ql,a.K=class extends mT{},a.L=_u,a.M=Zy,a.N=Fp,a.O=Rh,a.P=kt,a.Q=Uy,a.R=uh,a.S=wf,a.T=zC,a.U=Mf,a.V=mT,a.W=_d,a.X=Yl,a.Y=mf,a.Z=ja,a._=Th,a.a=function(l){return xo.API_CDN_URL_REGEX.test(l)},a.a$=zt,a.a0=Ap,a.a1=Pf,a.a2=Ou,a.a3=bf,a.a4=function(l){const r=l.value;let s=[];if(!r)return s;const h=ql(r);return h!=="string"?(s=s.concat([new mT(l.key,r,`string expected, "${h}" found`)]),s):(uM(r,!0)||(s=s.concat([new mT(l.key,r,`invalid url "${r}"`)])),s)},a.a5=st,a.a6=Cf,a.a7=la,a.a8=Jt,a.a9=class{constructor(l){this.specification=l}possiblyEvaluate(l,r){return $a(l.expression.evaluate(r))}interpolate(l,r,s){return{x:Gn(l.x,r.x,s),y:Gn(l.y,r.y,s),z:Gn(l.z,r.z,s),azimuthal:Gn(l.azimuthal,r.azimuthal,s),polar:Gn(l.polar,r.polar,s)}}},a.aA=Bt,a.aB=Za,a.aC=Ya,a.aD=oe,a.aE=Ze,a.aF=function(l,r){const s={};for(let h=0;h<r.length;h++){const p=r[h];p in l&&(s[p]=l[p])}return s},a.aG=Y,a.aH=ue,a.aI=class{constructor(l){this.entries={},this.scheduler=l}request(l,r,s,h){const p=this.entries[l]=this.entries[l]||{callbacks:[]};if(p.result){const[_,x]=p.result;return this.scheduler?this.scheduler.add((()=>{h(_,x)}),r):h(_,x),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=s(((_,x)=>{p.result=[_,x];for(const E of p.callbacks)this.scheduler?this.scheduler.add((()=>{E(_,x)}),r):E(_,x);setTimeout((()=>delete this.entries[l]),3e3)}))),()=>{p.result||(p.callbacks=p.callbacks.filter((_=>_!==h)),p.callbacks.length||(p.cancel(),delete this.entries[l]))}}},a.aJ=function(l,r,s){const h=JSON.stringify(l.request);return l.data&&(this.deduped.entries[h]={result:[null,l.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},(p=>{const _=pc(l.request,((x,E,O,R)=>{x?p(x):E&&p(null,{vectorTile:s?void 0:new gn(new KS(E)),rawData:E,cacheControl:O,expires:R})}));return()=>{_.cancel(),p()}}),r)},a.aK=function(l){Sp++,Sp>Cs&&(l.getActor().send("enforceCacheSizeLimit",cl),Sp=0)},a.aL=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},a.aM=Pa,a.aN=dB,a.aO=_B,a.aP=hB,a.aQ=function(l,r){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){r(null,s)};for(let h=0;h<l.length;h++){const p=document.createElement("source");Bc(l[h])||(s.crossOrigin="Anonymous"),p.src=l[h],s.appendChild(p)}return{cancel:()=>{}}},a.aR=Eb,a.aS=function(l){return fetch(l).then((r=>r.arrayBuffer())).then((r=>$j(r,0,l)))},a.aT=Kj,a.aU=class{constructor(l,r,s,h){this.id=l,this.position=r!=null?new U(r[0],r[1]):new U(0,0),this.orientation=s??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new br([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,r){if(J(l.matrix,r,l.matrix),l.meshes)for(const s of l.meshes){const h=br.applyTransformFast(s.aabb,l.matrix);this.aabb.encapsulate(h)}if(l.children)for(const s of l.children)this._applyTransformations(s,l.matrix)}computeBoundsAndApplyParent(){const l=q([]);for(const r of this.nodes)this._applyTransformations(r,l)}computeModelMatrix(l,r,s,h,p,_,x=!1){Zj(this.matrix,this,l.transform,this.position,r,s,h,p,_,x)}upload(l){if(!this.uploaded){for(const r of this.nodes)FC(r,l);for(const r of this.nodes)YS(r);this.uploaded=!0}}destroy(){for(const l of this.nodes)VC(l)}},a.aV=Yn,a.aW=kb,a.aX=xe,a.aY=Te,a.aZ=Nu,a.a_=Zr,a.aa=Ei,a.ab=bc,a.ac=je,a.ad=En,a.ae=at,a.af=Ke,a.ag=Ql,a.ah=Uf,a.ai=Gn,a.aj=nn,a.ak=Qm,a.al=hr,a.am=pi,a.an=class{constructor(l){this.specification=l}possiblyEvaluate(l,r){return(function([s,h]){const p=$a([1,s,h]);return{x:p.x,y:p.y,z:p.z}})(l.expression.evaluate(r))}interpolate(l,r,s){return{x:Gn(l.x,r.x,s),y:Gn(l.y,r.y,s),z:Gn(l.z,r.z,s)}}},a.ao=function(l,r,s=0,h=!0){const p=new kt(s,s),_=l.sub(p),x=r.add(p),E=[_,new kt(x.x,_.y),x,new kt(_.x,x.y)];return h&&E.push(_.clone()),E},a.ap=function(l,r){const s=[];for(let h=0;h<l.length;h++){const p=wt(h-1,-1,l.length-1),_=wt(h+1,-1,l.length-1),x=l[h],E=l[_],O=l[p].sub(x).unit(),R=E.sub(x).unit(),z=R.angleWithSep(O.x,O.y),j=O.add(R).unit().mult(-1*r/Math.sin(z/2));s.push(x.add(j))}return s},a.aq=K3,a.ar=ma,a.as=function(l,r,s=0){return ct(((r.x-s)*l.scale-l.x)*nn,(r.y*l.scale-l.y)*nn,Me(r.z,r.y))},a.at=Cr,a.au=qt,a.av=kr,a.aw=l3,a.ax=function(l){let r=1/0,s=1/0,h=-1/0,p=-1/0;for(const _ of l)r=Math.min(r,_.x),s=Math.min(s,_.y),h=Math.max(h,_.x),p=Math.max(p,_.y);return{min:new kt(r,s),max:new kt(h,p)}},a.ay=Pe,a.az=J,a.b=function(l){return xo.API_FONTS_REGEX.test(l)},a.b$=tM,a.b0=vv,a.b1=hT,a.b2=function(){Sc.isLoading()||Sc.isLoaded()||Hy()!=="deferred"||Gy()},a.b3=Sd,a.b4=Tt,a.b5=ox,a.b6=Qr,a.b7=qC,a.b8=cb,a.b9=We,a.bA=function(l,r){const{x:s,y:h}=l.point,p=Ig(s,h,l.worldSize/l._pixelsPerMercatorPixel,0,0);return J(p,p,c_(iu(r)))},a.bB=M,a.bC=Jr,a.bD=function(l,r){return Math.hypot(r[0]-l[0],r[1]-l[1],r[2]-l[2])},a.bE=nt,a.bF=mn,a.bG=Ht,a.bH=Ob,a.bI=Pc,a.bJ=KC,a.bK=function(l,r,s,h,p){const _=5*r+2;l.float32[_+0]=s,l.float32[_+1]=h,l.float32[_+2]=p},a.bL=uT,a.bM=Ua,a.bN=co,a.bO=lo,a.bP=Ra,a.bQ=wt,a.bR=function(l,r,s,h){var p=new S(4);return p[0]=l,p[1]=r,p[2]=s,p[3]=h,p},a.bS=Xv,a.bT=Ai,a.bU=ds,a.bV=BS,a.bW=vB,a.bX=VS,a.bY=ym,a.bZ=YC,a.b_=q3,a.ba=Rs,a.bb=Tg,a.bc=H0,a.bd=Ki,a.be=pm,a.bf=lM,a.bg=function(l,r){const s=Uf(r.zoom);if(s===0)return iu(l);const h=Ev(l),p=X0(h),_=oe(h.getWest())*r.worldSize,x=oe(h.getEast())*r.worldSize,E=ue(h.getNorth())*r.worldSize,O=ue(h.getSouth())*r.worldSize,R=[_,E,0],z=[x,E,0],j=[_,O,0],B=[x,O,0],X=V([],r.globeMatrix);return En(R,R,X),En(z,z,X),En(j,j,X),En(B,B,X),p[0]=Od(p[0],j,s),p[1]=Od(p[1],B,s),p[2]=Od(p[2],z,s),p[3]=Od(p[3],R,s),br.fromPoints(p)},a.bh=fm,a.bi=V,a.bj=Vf,a.bk=Od,a.bl=Td,a.bm=vS,a.bn=me,a.bo=ee,a.bp=ST,a.bq=KS,a.br=pc,a.bs=function(l,r){const s=[];for(const h in l)h in r||s.push(h);return s},a.bt=et,a.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.bv=Dr,a.bw=function(l){var r=new S(16);return r[0]=l[0],r[1]=l[1],r[2]=l[2],r[3]=l[3],r[4]=l[4],r[5]=l[5],r[6]=l[6],r[7]=l[7],r[8]=l[8],r[9]=l[9],r[10]=l[10],r[11]=l[11],r[12]=l[12],r[13]=l[13],r[14]=l[14],r[15]=l[15],r},a.bx=q,a.by=ce,a.bz=G,a.c=nd,a.c$=45,a.c0=bM,a.c1=vt,a.c2=hi,a.c3=$n,a.c4=function(l,r,s){s*=.5;var h=r[0],p=r[1],_=r[2],x=r[3],E=Math.sin(s),O=Math.cos(s);return l[0]=h*O+p*E,l[1]=p*O-h*E,l[2]=_*O+x*E,l[3]=x*O-_*E,l},a.c5=qn,a.c6=Gi,a.c7=function(l,r){return l[0]=-r[0],l[1]=-r[1],l[2]=-r[2],l[3]=r[3],l},a.c8=De,a.c9=function(l,r,s,h,p){var _,x=1/Math.tan(r/2);return l[0]=x/s,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=x,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,p!=null&&p!==1/0?(l[10]=(p+h)*(_=1/(h-p)),l[14]=2*p*h*_):(l[10]=-1,l[14]=-2*h),l},a.cA=vl,a.cB=bS,a.cC=function(l,r,s,h,p,_,x,E,O){if(O.name==="globe")return bS(l,r,new vl(s,h,p),!1);const R=kb({z:s,x:h,y:p},O);return new br([(_+R.x/R.scale)*r,r*(R.y/R.scale),x],[(_+R.x2/R.scale)*r,r*(R.y2/R.scale),E])},a.cD=function(l,r,s){return l[0]=Math.min(r[0],s[0]),l[1]=Math.min(r[1],s[1]),l[2]=Math.min(r[2],s[2]),l[3]=Math.min(r[3],s[3]),l},a.cE=function(l,r,s){return l[0]=Math.max(r[0],s[0]),l[1]=Math.max(r[1],s[1]),l[2]=Math.max(r[2],s[2]),l[3]=Math.max(r[3],s[3]),l},a.cF=function(l){const r=Math.round((l+45+360)%360/90)%4;return he[r]},a.cG=ke,a.cH=ra,a.cI=g,a.cJ=function(l){const r=q(new Float64Array(16));J(r,l.pixelMatrix,l.globeMatrix);const s=[0,b,0],h=[0,T,0];return En(s,s,r),En(h,h,r),[s[0]>0&&s[0]<=l.width&&s[1]>0&&s[1]<=l.height&&!Cv(l,new U(l.center.lat,90)),h[0]>0&&h[0]<=l.width&&h[1]>0&&h[1]<=l.height&&!Cv(l,new U(l.center.lat,-90))]},a.cK=function(l,r){const{scale:s}=l.tileTransform,h=s*nn/(l.tileSize*Math.pow(2,r.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return(function(p,_,x){var E=_[1],O=_[2],R=_[3],z=x[0],j=x[1];return p[0]=_[0]*z,p[1]=E*z,p[2]=O*j,p[3]=R*j,p})(new Float32Array(4),r.inverseAdjustmentMatrix,[h,h])},a.cL=XS,a.cM=Ye,a.cN=qj,a.cO=function(l){const r=qj(l,!0);return M([],[r[0],r[1],r[4],r[5]])},a.cP=re,a.cQ=Yr,a.cR=fe,a.cS=function(l){const{x:r,y:s}=l.point,{lng:h,lat:p}=l._center;return Ig(r,s,l.worldSize,h,p)},a.cT=Qe,a.cU=ot,a.cV=ks,a.cW=ca,a.cX=Ao,a.cY=function(l,r,s){let h=0;for(let p=0;p<2;++p)l[p]>0&&(h+=(l[p]-0)*(l[p]-0)),r[p]<0&&(h+=(0-r[p])*(0-r[p]));return h},a.cZ=function(l){return l*l*l*l*l},a.c_=le,a.ca=function(l,r,s,h,p,_,x){var E=1/(r-s),O=1/(h-p),R=1/(_-x);return l[0]=-2*E,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*O,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*R,l[11]=0,l[12]=(r+s)*E,l[13]=(p+h)*O,l[14]=(x+_)*R,l[15]=1,l},a.cb=de,a.cc=function(l,r,s){l[4*r+0]=s[0],l[4*r+1]=s[1],l[4*r+2]=s[2],l[4*r+3]=s[3]},a.cd=Lf,a.ce=yl,a.cf=Ba,a.cg=Cc,a.ch=Fa,a.ci=U,a.cj=nB,a.ck=function(){var l=new S(4);return S!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l},a.cl=function(l,r,s){var h=r[0],p=r[1],_=r[2],x=r[3],E=Math.sin(s),O=Math.cos(s);return l[0]=h*O+_*E,l[1]=p*O+x*E,l[2]=h*-E+_*O,l[3]=p*-E+x*O,l},a.cm=function(l,r){return l[0]===r[0]&&l[1]===r[1]&&l[2]===r[2]&&l[3]===r[3]},a.cn=mr,a.co=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},a.cp=Mi,a.cq=cn,a.cr=Mc,a.cs=3,a.ct=2,a.cu=7,a.cv=6,a.cw=en,a.cx=ze,a.cy=ai,a.cz=Hj,a.d=function(l){return xo.API_TILEJSON_REGEX.test(l)},a.d$=(l,r,s,h,p,_,x,E,O,R)=>{const z=l.transform,j=z.calculatePixelsToTileUnitsMatrix(r),B=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",X=z.pitch<15?c3(.07,.7,Pe((14-z.zoom)/5,0,1)):.07;return{u_matrix:h3(l,r,s,h),u_pixels_to_tile_units:j,u_device_pixel_ratio:_,u_width_scale:x,u_floor_width_scale:E,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:f3(s)&&r.lineAtlasTexture?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:u3(r,l.transform),u_alpha_discard_threshold:0,u_trim_offset:O,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toPremultipliedRenderColor(B?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:X,u_tile_to_meter:Ne(r.tileID.canonical,0),u_ground_shadow_factor:R}},a.d0=Nf,a.d1=function(l,r,s){const h=Math.sqrt(l*l+r*r+s*s),p=h>0?Math.acos(s/h)*Hs:0;let _=l!==0||r!==0?Math.atan2(-r,-l)*Hs+90:0;return _<0&&(_+=360),[h,_,p]},a.d2=ct,a.d3=$a,a.d4=Ne,a.d5=Ie,a.d6=br,a.d7=rt,a.d8=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},a.d9=uM,a.dA=Ev,a.dB=function(l){const r=ke-5;l=Pe(l,-r,r)/r*90;const s=Math.pow(Math.abs(Math.sin(hr(l))),3);return Math.round(s*(y.length-1))},a.dC=function(l,r,s,h){const p=r.getNorth(),_=r.getSouth(),x=r.getWest(),E=r.getEast(),O=1<<l.z,R=E-x,z=p-_,j=R/u,B=-z/y[s],X=[0,j,0,B,0,0,p,x,0];if(l.z>0){const Z=180/h;$(X,X,[Z/R+1,0,0,0,Z/z+1,0,-.5*Z/j,.5*Z/B,1])}return X[2]=O,X[5]=l.x,X[8]=l.y,X},a.dD=iu,a.dE=function(l,r,s){const h=q(new Float64Array(16)),p=(r/(1<<l)-.5)*Math.PI*2;return ne(h,s.globeMatrix,p),Float32Array.from(h)},a.dF=class{isDataAvailableAtPoint(l){const r=this._source();if(this.isUsingMockSource()||!r||l.y<0||l.y>1)return!1;const s=r.getSource().maxzoom,h=1<<s,p=Math.floor(l.x),_=Math.floor((l.x-p)*h),x=Math.floor(l.y*h),E=this.findDEMTileFor(new Pa(s,p,s,_,x));return!(!E||!E.dem)}getAtPointOrZero(l,r=0){return this.getAtPoint(l,r)||0}getAtPoint(l,r,s=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const h=this._source();if(!h||l.y<0||l.y>1)return r;const p=h.getSource().maxzoom,_=1<<p,x=Math.floor(l.x),E=l.x-x,O=new Pa(p,x,p,Math.floor(E*_),Math.floor(l.y*_)),R=this.findDEMTileFor(O);if(!R||!R.dem)return r;const z=R.dem,j=1<<R.tileID.canonical.z,B=(E*j-R.tileID.canonical.x)*z.dim,X=(l.y*j-R.tileID.canonical.y)*z.dim,Z=Math.floor(B),ae=Math.floor(X);return(s?this.exaggeration():1)*Gn(Gn(z.get(Z,ae),z.get(Z,ae+1),X-ae),Gn(z.get(Z+1,ae),z.get(Z+1,ae+1),X-ae),B-Z)}getAtTileOffset(l,r,s){const h=1<<l.canonical.z;return this.getAtPointOrZero(new je(l.wrap+(l.canonical.x+r/nn)/h,(l.canonical.y+s/nn)/h))}getAtTileOffsetFunc(l,r,s,h){return p=>{const _=this.getAtTileOffset(l,p.x,p.y),x=h.upVector(l.canonical,p.x,p.y);return vt(x,x,_*h.upVectorScale(l.canonical,r,s).metersToTile),x}}getForTilePoints(l,r,s,h){if(this.isUsingMockSource())return!1;const p=nx.create(this,l,h);return!!p&&(r.forEach((_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],s)})),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(l);if(!r||!r.dem)return null;const s=r.dem.tree,h=r.tileID,p=1<<l.canonical.z-h.canonical.z;let _=l.canonical.x/p-h.canonical.x,x=l.canonical.y/p-h.canonical.y,E=0;for(let O=0;O<l.canonical.z-h.canonical.z&&!s.leaves[E];O++){_*=2,x*=2;const R=2*Math.floor(x)+Math.floor(_);E=s.childOffsets[E]+R,_%=1,x%=1}return{min:this.exaggeration()*s.minimums[E],max:this.exaggeration()*s.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,r,s){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let r=!1,s=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const p of l){const _=this.getMinMaxForTile(p.tileID);_&&(s=Math.min(s,_.min),h=Math.max(h,_.max),r=!0)}return r?{min:s,max:h}:null}},a.dG=kg,a.dH=l_,a.dI=function(l,r){return[Math.pow(l[0],2.2)*r,Math.pow(l[1],2.2)*r,Math.pow(l[2],2.2)*r]},a.dJ=P,a.dK=function(l,r){var s=Math.sin(r),h=Math.cos(r);return l[0]=h,l[1]=s,l[2]=0,l[3]=-s,l[4]=h,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},a.dL=Xn,a.dM=$u,a.dN=Xa,a.dO=uo,a.dP=256,a.dQ=function(l,r){const s=[0,0,0];return En(s,s,fm(iu(r.canonical))),En(s,s,l),s},a.dR=l=>({u_matrix:new Fa(l),u_texsize:new Cc(l),u_pixels_to_tile_units:new Og(l),u_device_pixel_ratio:new Ba(l),u_width_scale:new Ba(l),u_floor_width_scale:new Ba(l),u_image:new Lf(l),u_units_to_pixels:new Cc(l),u_tile_units_to_pixels:new Ba(l),u_alpha_discard_threshold:new Ba(l),u_trim_offset:new Cc(l),u_trim_fade_range:new Cc(l),u_trim_color:new Nf(l),u_emissive_strength:new Ba(l),u_zbias_factor:new Ba(l),u_tile_to_meter:new Ba(l),u_ground_shadow_factor:new yl(l),u_pattern_transition:new Ba(l)}),a.dS=l=>({u_matrix:new Fa(l),u_pixels_to_tile_units:new Og(l),u_device_pixel_ratio:new Ba(l),u_width_scale:new Ba(l),u_floor_width_scale:new Ba(l),u_units_to_pixels:new Cc(l),u_dash_image:new Lf(l),u_gradient_image:new Lf(l),u_image_height:new Ba(l),u_texsize:new Cc(l),u_tile_units_to_pixels:new Ba(l),u_alpha_discard_threshold:new Ba(l),u_trim_offset:new Cc(l),u_trim_fade_range:new Cc(l),u_trim_color:new Nf(l),u_emissive_strength:new Ba(l),u_zbias_factor:new Ba(l),u_tile_to_meter:new Ba(l),u_ground_shadow_factor:new yl(l)}),a.dT=l=>({u_camera_to_center_distance:new Ba(l),u_extrude_scale:new Og(l),u_device_pixel_ratio:new Ba(l),u_matrix:new Fa(l),u_inv_rot_matrix:new Fa(l),u_merc_center:new Cc(l),u_tile_id:new yl(l),u_zoom_transition:new Ba(l),u_up_dir:new yl(l),u_emissive_strength:new Ba(l)}),a.dU=Dl,a.dV=Cte,a.dW=J0,a.dX=(l,r,s,h,p,_)=>{const x=l.transform,E=x.projection.name==="globe";let O;if(_.paint.get("circle-pitch-alignment")==="map")if(E){const z=$u(x.zoom,r.canonical)*x._pixelsPerMercatorPixel;O=Float32Array.from([z,0,0,z])}else O=x.calculatePixelsToTileUnitsMatrix(s);else O=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(x.projection),u_matrix:l.translatePosMatrix(r.projMatrix,s,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:ls.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:K0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:_.paint.get("circle-emissive-strength")};if(E){R.u_inv_rot_matrix=h,R.u_merc_center=p,R.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],R.u_zoom_transition=Uf(x.zoom);const z=p[0]*nn,j=p[1]*nn;R.u_up_dir=x.projection.upVector(new vl(0,0,0),z,j)}return R},a.dY=d3,a.dZ=wo,a.d_=(l,r,s,h,p,_,x,E,O,R)=>{const z=l.transform,j=z.pitch<15?c3(.07,.7,Pe((14-z.zoom)/5,0,1)):.07,B=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:h3(l,r,s,h),u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:z.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:p,u_width_scale:_,u_floor_width_scale:x,u_image:0,u_tile_units_to_pixels:u3(r,z),u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toPremultipliedRenderColor(B?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:j,u_tile_to_meter:Ne(r.tileID.canonical,0),u_ground_shadow_factor:O,u_pattern_transition:R}},a.da=function(l,r){return l.readFields(wne,{icons:[]},r)},a.db=dn,a.dc=Qv,a.dd=QC,a.de=hl,a.df=qy,a.dg=Xo,a.dh=Vc,a.di=gr,a.dj=function(l){const r=l.indexOf(Of);return r>=0?l.slice(0,r):l},a.dk=function(l){return l.indexOf(Of)>=0},a.dl=function(l){const r=l.lastIndexOf(Of);return r>=0?l.slice(r+1):""},a.dm=function(l){const r=[],s=l.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),l.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},a.dn=function(l,r,s,h){return l.type==="custom"?new gne(l,r):new xne[l.type](l,r,s,h)},a.dp=Mr,a.dq=function(l){const r=l.indexOf(Of);return r>=0?l.slice(r+1):""},a.dr=class extends ox{constructor(l,r){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state=Object.assign({},l.state)),this.target=r.target,this.namespace=r.namespace,r.properties&&(this.properties=r.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=l.source,this.sourceLayer=l.sourceLayer,this.layer=l.layer)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},a.ds=yg,a.dt=jc,a.du=function(l){return l({pluginStatus:_s,pluginURL:ku}),yg.on("pluginStateChange",l),l},a.dv=zf,a.dw=class extends Bo{constructor(l){super(l),this.current=q0}set(l,r,s){if(this.fetchUniformLocation(l,r)){for(let h=0;h<9;h++)if(s[h]!==this.current[h]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},a.dx=ye,a.dy=function(l,r,s){const h=Uf(s.zoom),p=l.style.map._antialias,_=l.terrain&&l.terrain.exaggeration()>0;return h===0&&!p&&!_},a.dz=function(l){const r=l.pixelsPerMeter,s=r/de(1,l.center.lat),h=q(new Float64Array(16));return ee(h,h,[l.point.x,l.point.y,0]),re(h,h,[s,s,r]),Float32Array.from(h)},a.e=xo,a.e$=Hy,a.e0=Fn,a.e1=$f,a.e2=Me,a.e3=jh,a.e4=Zf,a.e5=bb,a.e6=Hf,a.e7=450,a.e8=7,a.e9=Ve,a.eA=function(l,r,s,h,p,_,x,E,O,R,z,j,B,X,Z,ae){var se=new S(16);return se[0]=l,se[1]=r,se[2]=s,se[3]=h,se[4]=p,se[5]=_,se[6]=x,se[7]=E,se[8]=O,se[9]=R,se[10]=z,se[11]=j,se[12]=B,se[13]=X,se[14]=Z,se[15]=ae,se},a.eB=L,a.eC=Df,a.eD=Ac,a.eE=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new kt(1/0,1/0),max:new kt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,r=!1){const s=FS(new kt(0,0),new kt(nn,nn),l),h=[];if(r&&!pb(s,this._globalClipBounds))return h;for(const p of this._activeRegions){if(p.hiddenByOverlap||!pb(s,p))continue;const _=Vv(p.min,p.max,l);h.push({min:_.min,max:_.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return h}setSources(l){this._setSources(l.map((r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const s=[];for(const h of r.cache.getVisibleCoordinates()){const p=r.cache.getTile(h).buckets[r.layer];p&&p.updateFootprints(h.toUnwrapped(),s)}return s},getOrder:()=>r.order,getClipMask:()=>r.clipMask,getClipScope:()=>r.clipScope}))))}_addSource(l){const r=l.getFootprints();if(r.length===0)return;const s=l.getOrder(),h=l.getClipMask(),p=l.getClipScope();for(const _ of r){if(!_.footprint)continue;const x=FS(_.footprint.min,_.footprint.max,_.id);this._activeRegions.push({min:x.min,max:x.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:_.id,footprint:_.footprint,order:s,clipMask:h,clipScope:p})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort(((r,s)=>r.priority-s.priority||y_(r.min,s.min)||y_(r.max,s.max)||r.order-s.order||r.clipMask-s.clipMask||(function(h,p){const _=(x,E)=>x+E;return h.length-p.length||h.reduce(_,"").localeCompare(p.reduce(_,""))})(r.clipScope,s.clipScope)));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let r=0;for(;!l&&r!==this._activeRegions.length;){const s=this._activeRegions[r],h=this._prevRegions[r];l=s.priority!==h.priority||!Fg(s,h)||s.order!==h.order||s.clipMask!==h.clipMask||!Dr(s.clipScope,h.clipScope),++r}}if(l){++this._updateTime;for(const s of this._activeRegions)s.order!==Bg&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const r=s=>{const h=this._activeRegions;if(s>=h.length)return s;const p=h[s].priority;for(;s<h.length&&h[s].priority===p;)++s;return s};if(this._sourceIds.length>1){let s=0,h=r(s);for(;s!==h;){let p=s;const _=s;for(;p!==h;){const x=this._activeRegions[p];x.hiddenByOverlap=!1;for(let E=0;E<_;E++){const O=this._activeRegions[E];if(!O.hiddenByOverlap&&x.order===Bg&&pb(x,O)&&(x.hiddenByOverlap=Uv(x.footprint,x.tileId,O.footprint,O.tileId),x.hiddenByOverlap))break}++p}s=h,h=r(s)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=l.length-1;r>=0;r--)this._addSource(l[r]);this._computeReplacement()}},a.eF=Bg,a.eG=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,r){const s=new Rs,h=new Zr,p=[],_=l+1+2,x=r[0]+1,E=r[0]+1+(1+r.length),O=(R,z,j)=>{let B=R===_-1?R-2:R===0?R:R-1;return B+=j?24575:0,[B,z]};for(let R=0;R<_;++R)s.emplaceBack(...O(R,0,!0));for(let R=0;R<x;++R)for(let z=0;z<_;++z)s.emplaceBack(...O(z,R,(z===0||z===_-1)&&!0));for(let R=0;R<r.length;++R){const z=r[R];for(let j=0;j<_;++j)s.emplaceBack(...O(j,z,!0))}for(let R=0;R<r.length;++R){const z=h.length,j=r[R]+1+2,B=new Zr;for(let ae=0;ae<j-1;ae++){const se=ae===j-2,pe=se?_*(E-r.length+R-ae):_;for(let we=0;we<_-1;we++){const be=ae*_+we;ae===0||se||we===0||we===_-2?(B.emplaceBack(be+1,be,be+pe),B.emplaceBack(be+pe,be+pe+1,be+1)):(h.emplaceBack(be+1,be,be+pe),h.emplaceBack(be+pe,be+pe+1,be+1))}}const X=Ki.simpleSegment(0,z,s.length,h.length-z);for(let ae=0;ae<B.uint16.length;ae+=3)h.emplaceBack(B.uint16[ae],B.uint16[ae+1],B.uint16[ae+2]);const Z=Ki.simpleSegment(0,z,s.length,h.length-z);p.push({withoutSkirts:X,withSkirts:Z})}return{vertices:s,indices:h,segments:p}}_createGrid(l){const r=this._fillGridMeshWithLods(u,y);this._gridSegments=r.segments,this._gridBuffer=l.createVertexBuffer(r.vertices,H0.members),this._gridIndexBuffer=l.createIndexBuffer(r.indices,!0)}_createPoles(l){const r=new Zr;for(let x=0;x<=u;x++)r.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=l.createIndexBuffer(r,!0);const s=new Nh,h=new Nh,p=new Nh,_=new Nh;this._poleSegments=[];for(let x=0,E=0;x<Ao;x++){const O=360/(1<<x);s.emplaceBack(0,-Za,0,.5,0),h.emplaceBack(0,-Za,0,.5,1),p.emplaceBack(0,-Za,0,.5,.5),_.emplaceBack(0,-Za,0,.5,.5);for(let R=0;R<=u;R++){let z=R/u,j=0;const B=Gn(0,O,z),[X,Z,ae]=C(wS,EC,B,Za);s.emplaceBack(X,Z,ae,z,j),h.emplaceBack(X,Z,ae,z,1-j);const se=hr(B);z=.5+.5*Math.sin(se),j=.5+.5*Math.cos(se),p.emplaceBack(X,Z,ae,z,j),_.emplaceBack(X,Z,ae,z,1-j)}this._poleSegments.push(Ki.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(s,s_,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(h,s_,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(p,s_,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(_,s_,!1)}getGridBuffers(l,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},a.eH=fb,a.eI=Ae,a.eJ=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.eK=He,a.eL=Le,a.eM=function(l,r,s){return l[0]=r[0]/s[0],l[1]=r[1]/s[1],l[2]=r[2]/s[2],l},a.eN=li,a.eO=I,a.eP=Ut,a.eQ=ht,a.eR=function([l,r,s]){const h=Math.hypot(l,r,s),p=Math.atan2(l,s),_=.5*Math.PI-Math.acos(-r/h);return new U(ot(p),ot(_))},a.eS=xt,a.eT=jC,a.eU=function(l){const r=l.navigator?l.navigator.userAgent:null;return!!(function(s){if(Ri==null){const h=s.navigator?s.navigator.userAgent:null;Ri=!!s.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return Ri})(l)&&!(!r||!(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},a.eV=function(l,r){cl=l,Cs=r},a.eW=Cv,a.eX=Z0,a.eY=function(l){const r=[0,0,0],s=q(new Float64Array(16));return J(s,l.pixelMatrix,l.globeMatrix),En(r,r,s),new kt(r[0],r[1])},a.eZ=function(){const l=In;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(bt),In=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.e_=function(){dn().acquire(bt)},a.ea=function(l,r){if(l===r){var s=r[1],h=r[2],p=r[3],_=r[6],x=r[7],E=r[11];l[1]=r[4],l[2]=r[8],l[3]=r[12],l[4]=s,l[6]=r[9],l[7]=r[13],l[8]=h,l[9]=_,l[11]=r[14],l[12]=p,l[13]=x,l[14]=E}else l[0]=r[0],l[1]=r[4],l[2]=r[8],l[3]=r[12],l[4]=r[1],l[5]=r[5],l[6]=r[9],l[7]=r[13],l[8]=r[2],l[9]=r[6],l[10]=r[10],l[11]=r[14],l[12]=r[3],l[13]=r[7],l[14]=r[11],l[15]=r[15];return l},a.eb=mne,a.ec=Ur,a.ed=am,a.ee=256,a.ef=c_,a.eg=Is,a.eh=ne,a.ei=function(l,r){return l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=r[4],l[4]=r[5],l[5]=r[6],l[6]=r[8],l[7]=r[9],l[8]=r[10],l},a.ej=Nh,a.ek=wg,a.el=Vy,a.em=function(l,r,s,h,p){return Pe((l-r)/(s-r)*(p-h)+h,h,p)},a.en=An,a.eo=function(l,r){var s=r[0],h=r[1],p=r[2],_=r[3],x=r[4],E=r[5],O=r[6],R=r[7],z=r[8],j=z*x-E*R,B=-z*_+E*O,X=R*_-x*O,Z=s*j+h*B+p*X;return Z?(l[0]=j*(Z=1/Z),l[1]=(-z*h+p*R)*Z,l[2]=(E*h-p*x)*Z,l[3]=B*Z,l[4]=(z*s-p*O)*Z,l[5]=(-E*s+p*_)*Z,l[6]=X*Z,l[7]=(-R*s+h*O)*Z,l[8]=(x*s-h*_)*Z,l):null},a.ep=2,a.eq=$t,a.er=BC,a.es=[1,1,1],a.et=class{constructor(l,r,s,h){this.context=l,this.format=h,this.size=s,this.texture=l.gl.createTexture();const[p,_,x]=this.size,{gl:E}=l;E.bindTexture(E.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),E.texImage3D(E.TEXTURE_3D,0,this.format,p,_,x,0,LC(this.format),NC(this.format),r.data)}bind(l,r){const{context:s}=this,{gl:h}=s;h.bindTexture(h.TEXTURE_3D,this.texture),l!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,l),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,l),this.minFilter=l),r!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,r),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,r),this.wrapS=r)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},a.eu=nx,a.ev=so,a.ew=function(l,r,s,h){var p=r[0],_=r[1],x=r[2],E=r[3];return l[0]=p+h*(s[0]-p),l[1]=_+h*(s[1]-_),l[2]=x+h*(s[2]-x),l[3]=E+h*(s[3]-E),l},a.ex=Yv,a.ey=Qo,a.ez=Vu,a.f=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,((r,s)=>String.fromCharCode(+("0x"+s)))))},a.f0=function(l,r,s=!1){if(_s===Ys.deferred||_s===Ys.loading||_s===Ys.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");ku=ls.resolveURL(l),_s=Ys.deferred,gg=r,Xp(),s||Gy()},a.f1=function(l){Ot=ls.resolveURL(l),Pn||(Pn=new Sn(dn(),new yu)),Pn.broadcast("setMeshoptUrl",Ot)},a.f2=ws,a.f3=function(l){La=ls.resolveURL(l),Pn||(Pn=new Sn(dn(),new yu)),Pn.broadcast("setDracoUrl",La)},a.f4=ui,a.f5=Be,a.f6=function(l){const r=gs();if(!r)return;const s=r.delete(Bl);l&&s.then((()=>l())).catch(l)},a.f7=Gt,a.f8=Rn,a.f9=Dd,a.fa=zd,a.fb=oF,a.fc=sF,a.fd=a3,a.fe=xn,a.ff="hd_road_elevation",a.fg=Li,a.fh=Hn,a.fi=Ls,a.fj=JC,a.fk=E_,a.fl=function(l,r,s,h,p,_,x,E=1,O,R,z){l.createArrays(),l.tilePixelRatio=nn/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const j=l.layers[0].layout,B=l.layers[0]._unevaluatedLayout._values,X={};X.scaleFactor=E,X.textSizeScaleRange=j.get("text-size-scale-range"),X.iconSizeScaleRange=j.get("icon-size-scale-range");const[Z,ae]=X.textSizeScaleRange,[se,pe]=X.iconSizeScaleRange;X.textScaleFactor=Pe(X.scaleFactor,Z,ae),X.iconScaleFactor=Pe(X.scaleFactor,se,pe);const we=B["text-size"],be=B["icon-size"];if(l.textSizeData.kind==="composite"){const{minZoom:it,maxZoom:Mt}=l.textSizeData;X.compositeTextSizes=[we.possiblyEvaluate(new Ei(it,{worldview:z}),_),we.possiblyEvaluate(new Ei(Mt,{worldview:z}),_)]}if(l.iconSizeData.kind==="composite"){const{minZoom:it,maxZoom:Mt}=l.iconSizeData;X.compositeIconSizes=[be.possiblyEvaluate(new Ei(it,{worldview:z}),_),be.possiblyEvaluate(new Ei(Mt,{worldview:z}),_)]}X.layoutTextSize=we.possiblyEvaluate(new Ei(x+1,{worldview:z}),_),X.layoutIconSize=be.possiblyEvaluate(new Ei(x+1,{worldview:z}),_),X.textMaxSize=we.possiblyEvaluate(new Ei(18,{worldview:z}),_);const Ee=j.get("symbol-placement"),Ge=j.get("text-rotation-alignment")==="map"&&Ee!=="point",Ue=j.get("text-size");let $e=!1;const Je=[];for(const it of l.features){const Mt=j.get("text-font").evaluate(it,{},_).join(","),ut=Ue.evaluate(it,{},_)*X.textScaleFactor,Dt=X.layoutTextSize.evaluate(it,{},_)*X.textScaleFactor,ln=X.layoutIconSize.evaluate(it,{},_)*X.iconScaleFactor,Vt={horizontal:{},vertical:void 0},Yt=it.text;let on,At=[0,0];if(Yt){const On=Yt.toString(),Jn=j.get("text-letter-spacing").evaluate(it,{},_)*ds,or=j.get("text-line-height").evaluate(it,{},_)*ds,wr=Gp(On)?Jn:0,ur=j.get("text-anchor").evaluate(it,{},_),Xr=j.get("text-variable-anchor");if(!Xr){const Et=j.get("text-radial-offset").evaluate(it,{},_);if(Et)At=q3(ur,[Et*ds,eM]);else{const hn=j.get("text-offset").evaluate(it,{},_);At=[hn[0]*ds,hn[1]*ds]}}let Lr=Ge?"center":j.get("text-justify").evaluate(it,{},_);const Ji=Ee==="point",Oe=Ji?j.get("text-max-width").evaluate(it,{},_)*ds:1/0,Re=Et=>{l.allowVerticalPlacement&&Hp(On)&&(Vt.vertical=ZC(Yt,r,s,p,Mt,Oe,or,ur,Et,wr,At,Pc.vertical,!0,Dt,ut,O))};if(!Ge&&Xr){const Et=Lr==="auto"?Xr.map((vn=>tM(vn))):[Lr];let hn=!1;for(let vn=0;vn<Et.length;vn++){const _n=Et[vn];if(!Vt.horizontal[_n])if(hn)Vt.horizontal[_n]=Vt.horizontal[0];else{const Ln=ZC(Yt,r,s,p,Mt,Oe,or,"center",_n,wr,At,Pc.horizontal,!1,Dt,ut,O);Ln&&(Vt.horizontal[_n]=Ln,hn=Ln.positionedLines.length===1)}}Re("left")}else{if(Lr==="auto"&&(Lr=tM(ur)),Ji||j.get("text-writing-mode").indexOf("horizontal")>=0||!Hp(On)){const Et=ZC(Yt,r,s,p,Mt,Oe,or,ur,Lr,wr,At,Pc.horizontal,!1,Dt,ut,O);Et&&(Vt.horizontal[Lr]=Et)}Re(Ji?"left":Lr)}}let Kt,pt,Ct,un,Qt,Un,kn=!1;const Xt=j.get("icon-text-fit").evaluate(it,{},_);if(it.icon&&it.icon.hasPrimary()){const On=G3(it.icon,l.iconSizeData,B["icon-size"],_,l.zoom,it,O,X.iconScaleFactor,z);Kt=On.iconPrimary,Ct=On.iconSecondary;const Jn=Kt.toString();if(pt=h.get(Jn),pt&&(Qt=j.get("icon-offset").evaluate(it,{},_),Un=j.get("icon-anchor").evaluate(it,{},_),on=Hte(p.get(Jn),Ct?p.get(Ct.toString()):void 0,Qt,Un),kn=pt.sdf,l.sdfIcons===void 0?l.sdfIcons=pt.sdf:l.sdfIcons!==pt.sdf&&jr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pt.pixelRatio!==l.pixelRatio||j.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0)),Ct){const or=Ct.toString();un=h.get(or)}}$e=$e||!(!it.icon||!it.icon.hasSecondary());const an=nM(Vt.horizontal)||Vt.vertical;l.iconsInText||(l.iconsInText=!!an&&an.iconsInText);const Nn=Dt*X.textScaleFactor/ds,{defaultShapedIcon:Cn,verticallyShapedIcon:pn}=tne(l,on,j,it,_,Vt,Nn,Qt,Xt);Xt!=="none"&&on&&(M3(on)||P3(on))&&(nT(0,pt,Kt,on,Cn,Xt,R,h,p),nT(0,un,Ct,on,Cn,Xt,R,h,p),pn&&(nT(0,pt,Kt,on,pn,Xt,R,h,p),nT(0,un,Ct,on,pn,Xt,R,h,p))),on=Cn,Je.push({feature:it,shapedTextOrientations:Vt,shapedText:an,shapedIcon:on,iconPrimary:Kt,iconSecondary:Ct,iconOffset:Qt,iconAnchor:Un,verticallyShapedIcon:pn,layoutTextSize:Dt,layoutIconSize:ln,textOffset:At,isSDFIcon:kn,iconTextFit:Xt})}return{featureData:Je,sizes:X,hasAnySecondaryIcon:$e,textAlongLine:Ge,symbolPlacement:Ee}},a.fm=j3,a.fn=function(l,r,s,h,p,_,x,E,O,R){const{featureData:z,hasAnySecondaryIcon:j,sizes:B,textAlongLine:X,symbolPlacement:Z}=r;for(const ae of z){const{shapedIcon:se,verticallyShapedIcon:pe,feature:we,shapedTextOrientations:be,shapedText:Ee,layoutTextSize:Ge,textOffset:Ue,isSDFIcon:$e,iconPrimary:Je,iconSecondary:it,iconTextFit:Mt,iconOffset:ut}=ae;W3(se,R.iconPositions,Je,it),W3(pe,R.iconPositions,Je,it),ene(be,R.iconPositions),Qte(Je,it,R.iconPositions),(Ee||se)&&nne(l,we,be,se,pe,O,B,Ge,0,Ue,$e,h,p,x,E,j,Mt,ut,X,Z)}s&&l.generateCollisionDebugBuffers(_,l.collisionBoxArray,B.textScaleFactor)},a.fo=gn,a.fp=wT,a.fq=mt,a.fr=function(l){let r=0;if(new Uint32Array(l,0,1)[0]!==Bj){const s=new Uint32Array(l,0,7),[,,h,p,_,x]=s;r=s.byteLength+p+_+x+_,(h!==l.byteLength||r>=l.byteLength)&&jr("Invalid b3dm header information.")}return $j(l,r)},a.fs=function(l,r){const s=Kj(l);for(const h of s){for(const p of h.meshes)nte(p);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(rte(h.lights,r)))}return s},a.ft=gT,a.fu=yi,a.fv=Se,a.fw=Sc,a.fx=Ys,a.fy=function(l){lh(),El?.then((r=>{r.keys().then((s=>{for(let h=0;h<s.length-l;h++)r.delete(s[h]).catch((p=>jr(p.message)))})).catch((s=>jr(s.message)))})).catch((r=>jr(r.message)))},a.g=function(l,r){return jc(yt(l,{method:"GET"}),r)},a.h=yt,a.i=function(l){return xo.API_STYLE_REGEX.test(l)&&!nd(l)},a.j=function(l){return l.indexOf("mapbox:")===0},a.k=Ro,a.l=ch,a.m=function(l){return decodeURIComponent(atob(l).split("").map((r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2))).join(""))},a.n=function(l,r){return jc(yt(l,{type:"json"}),r)},a.o=Fc,a.p=function(l,r){return jc(yt(l,{method:"POST"}),r)},a.q=ls,a.r=Fo,a.s=function(l){try{const r=self[l];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=sh,a.u=function(){return(function l(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)})()},a.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},a.w=jr,a.x=function(){return sn||(sn=new Gt),sn},a.y=yM,a.z=Yo})),d(["./shared"],(function(a){function w(ot){const he=ot?ot.url.toString():void 0;return he?performance.getEntriesByName(he):[]}function S(ot){if(typeof ot=="number"||typeof ot=="boolean"||typeof ot=="string"||ot==null)return JSON.stringify(ot);if(Array.isArray(ot)){let ye="[";for(const Ae of ot)ye+=`${S(Ae)},`;return`${ye}]`}let he="{";for(const ye of Object.keys(ot).sort())he+=`${ye}:${S(ot[ye])},`;return`${he}}`}function M(ot){let he="";for(const ye of a.bu)he+=`/${S(ot[ye])}`;return he}class P{constructor(he){this.keyCache={},this._layers={},this._layerConfigs={},he&&this.replace(he)}replace(he,ye){this._layerConfigs={},this._layers={},this.update(he,[],ye)}update(he,ye,Ae){this._options=Ae;for(const Pe of he)this._layerConfigs[Pe.id]=Pe,(this._layers[Pe.id]=a.dn(Pe,this.scope,null,this._options)).compileFilter(Ae),this.keyCache[Pe.id]&&delete this.keyCache[Pe.id];for(const Pe of ye)delete this.keyCache[Pe],delete this._layerConfigs[Pe],delete this._layers[Pe];this.familiesBySource={};const He=(function(Pe,Ke){const wt={};for(let yt=0;yt<Pe.length;yt++){const Zt=Pe[yt];let zt=Ke&&Ke[Zt.id];zt||(Zt.type==="symbol"?zt=Zt.id:(zt=M(Zt),Zt.type==="line"&&Zt.paint&&(function Yn(Hn){return typeof Hn=="string"&&Hn==="line-progress"||(Array.isArray(Hn)?Hn.some(Yn):!(!Hn||typeof Hn!="object")&&Object.values(Hn).some(Yn))})(Zt.paint["line-width"])&&(zt+=`/${S(Zt.paint["line-width"])}`))),Ke&&(Ke[Zt.id]=zt);let Fn=wt[zt];Fn||(Fn=wt[zt]=[]),Fn.push(Zt)}const et=[];for(const yt in wt)et.push(wt[yt]);return et})(Object.values(this._layerConfigs),this.keyCache);for(const Pe of He){const Ke=Pe.map((Fn=>this._layers[Fn.id])),wt=Ke[0];if(wt.visibility==="none")continue;const et=wt.source||"";let yt=this.familiesBySource[et];yt||(yt=this.familiesBySource[et]={});const Zt=wt.sourceLayer||"_geojsonTileLayer";let zt=yt[Zt];zt||(zt=yt[Zt]=[]),zt.push(Ke)}}}const N=1*a.fa;class ${constructor(he){const ye={},Ae=[];for(const wt in he){const et=he[wt],yt=ye[wt]={};for(const Zt in et.glyphs){const zt=et.glyphs[+Zt];if(!zt||zt.bitmap.width===0||zt.bitmap.height===0)continue;const Fn=zt.metrics.localGlyph?N:1,Yn={x:0,y:0,w:zt.bitmap.width+2*Fn,h:zt.bitmap.height+2*Fn};Ae.push(Yn),yt[Zt]=Yn}}const{w:He,h:Pe}=a.H(Ae),Ke=new a.f9({width:He||1,height:Pe||1});for(const wt in he){const et=he[wt];for(const yt in et.glyphs){const Zt=et.glyphs[+yt];if(!Zt||Zt.bitmap.width===0||Zt.bitmap.height===0)continue;const zt=ye[wt][yt],Fn=Zt.metrics.localGlyph?N:1;a.f9.copy(Zt.bitmap,Ke,{x:0,y:0},{x:zt.x+Fn,y:zt.y+Fn},Zt.bitmap)}}this.image=Ke,this.positions=ye}}a.f8($,"GlyphAtlas");class G{constructor(he){this.tileID=new a.aM(he.tileID.overscaledZ,he.tileID.wrap,he.tileID.canonical.z,he.tileID.canonical.x,he.tileID.canonical.y),this.tileZoom=he.tileZoom,this.uid=he.uid,this.zoom=he.zoom,this.lut=he.lut,this.canonical=he.tileID.canonical,this.pixelRatio=he.pixelRatio,this.tileSize=he.tileSize,this.source=he.source,this.scope=he.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=he.showCollisionBoxes,this.collectResourceTiming=!!he.request&&he.request.collectResourceTiming,this.promoteId=he.promoteId,this.isSymbolTile=he.isSymbolTile,this.tileTransform=a.aW(he.tileID.canonical,he.projection),this.projection=he.projection,this.worldview=he.worldview,this.localizableLayerIds=he.localizableLayerIds,this.brightness=he.brightness,this.extraShadowCaster=!!he.extraShadowCaster,this.tessellationStep=he.tessellationStep,this.scaleFactor=he.scaleFactor,this.worldview=he.worldview}parse(he,ye,Ae,He,Pe,Ke){this.status="parsing",this.data=he,this.collisionBoxArray=new a.b0;const wt=new a.fb(Object.keys(he.layers).sort()),et=new a.fc(this.tileID,this.promoteId);et.bucketLayerIDs=[];const yt={},Zt=new a.fd(256,256),zt={featureIndex:et,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Zt,availableImages:Ae,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Fn=[],Yn=ye.familiesBySource[this.source];for(const Mr in Yn){const gr=he.layers[Mr];if(!gr)continue;let Sr=!1,gi=!1,jr=!1;for(const yi of Yn[Mr])yi[0].type==="symbol"?Sr=!0:gi=!0,yi[0].is3D()&&yi[0].type!=="model"&&(jr=!0);if(this.extraShadowCaster&&!jr||this.isSymbolTile===!0&&!Sr||this.isSymbolTile===!1&&!gi)continue;gr.version===1&&a.w(`Vector tile source "${this.source}" layer "${Mr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const da=wt.encode(Mr),Ia=[];let $a=!1;for(let yi=0,Qr=0;yi<gr.length;yi++){const Ri=gr.feature(yi),Gi=et.getId(Ri,Mr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Mr)){const bi=Ri.properties?Ri.properties.worldview:null;if(this.worldview&&typeof bi=="string")if(bi==="all")Ri.properties.$localized=!0;else{if(!bi.split(",").includes(this.worldview))continue;Ri.properties.$localized=!0,Ri.properties.worldview=this.worldview}}!$a&&Ri.properties&&Ri.properties.hasOwnProperty(a.fe)&&($a=!0),Ia.push({feature:Ri,id:Gi,index:Qr,sourceLayerIndex:da}),Qr++}$a&&!zt.elevationFeatures&&he.layers.hasOwnProperty(a.ff)&&(zt.elevationFeatures=a.fg.parseFrom(he.layers[a.ff],this.canonical));for(const yi of Yn[Mr]){const Qr=yi[0];if(this.extraShadowCaster&&(!Qr.is3D()||Qr.type==="model")||this.isSymbolTile!==void 0&&Qr.type==="symbol"!==this.isSymbolTile||Qr.minzoom&&this.zoom<Math.floor(Qr.minzoom)||Qr.maxzoom&&this.zoom>=Qr.maxzoom||Qr.visibility==="none")continue;q(yi,this.zoom,zt.brightness,Ae,this.worldview);const Ri=yt[Qr.id]=Qr.createBucket({index:et.bucketLayerIDs.length,layers:yi,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:da,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:He,worldview:this.worldview});et.bucketLayerIDs.push(yi.map((bi=>a.C(bi.id,bi.scope))));let Gi=Ri.prepare?Ri.prepare():null;Gi!=null?(Gi=Gi.then((()=>Ri.populate(Ia,zt,this.tileID.canonical,this.tileTransform))),Fn.push(Gi)):Ri.populate(Ia,zt,this.tileID.canonical,this.tileTransform)}}const Hn=()=>{let Mr,gr,Sr,gi,jr,da;Zt.trim();const Ia={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},$a=()=>{if(Mr)return this.status="done",Ke(Mr);if(this.extraShadowCaster)this.status="done",Ke(null,{buckets:Object.values(yt).filter((Qr=>!Qr.isEmpty())),featureIndex:et,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:zt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(gr&&Sr&&gi){const Qr=new $(gr),Ri=new Map;for(const[Da,Xa]of Sr.entries()){const{imagePosition:uo}=a.fj(Da,Xa,a.fk);Ri.set(Da,uo)}const Gi={};for(const Da in yt){const Xa=yt[Da];Xa instanceof a.b1&&(q(Xa.layers,this.zoom,zt.brightness,Ae,this.worldview),Gi[Da]=a.fl(Xa,gr,Qr.positions,Sr,Ri,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,jr,this.worldview))}const bi={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Pe,Sr,jr,(()=>{bi.iconsPending=!1,yi(Gi,Qr,bi)})),this.rasterizeIfNeeded(Pe,gi,da,(()=>{bi.patternsPending=!1,yi(Gi,Qr,bi)}))}},yi=(Qr,Ri,Gi,bi)=>{if(Gi.iconsPending||Gi.patternsPending)return;const Da=new a.fm(Sr,gi,this.lut);for(const Xa in yt){const uo=yt[Xa];if(Xa in Qr)a.fn(uo,Qr[Xa],this.showCollisionBoxes,Ae,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Sr,Da);else if(uo.hasPattern&&(uo instanceof a.b7||uo instanceof a.b8||uo instanceof a.e4)){q(uo.layers,this.zoom,zt.brightness,Ae,this.worldview);const td=Object.fromEntries(Da.patternPositions);uo.addFeatures(zt,this.tileID.canonical,td,Ae,this.tileTransform,this.brightness)}}this.status="done",Ke(null,{buckets:Object.values(yt).filter((Xa=>!Xa.isEmpty())),featureIndex:et,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ri.image,lineAtlas:Zt,imageAtlas:Da,brightness:zt.brightness})};if(!this.extraShadowCaster){const Qr=a.fh(zt.glyphDependencies,(bi=>Object.keys(bi).map(Number)));Object.keys(Qr).length?Pe.send("getGlyphs",{uid:this.uid,stacks:Qr},((bi,Da)=>{Mr||(Mr=bi,gr=Da,$a())}),void 0,!1,Ia):gr={};const Ri=Array.from(zt.iconDependencies.keys()).map((bi=>a.I.parse(bi)));Ri.length?Pe.send("getImages",{images:Ri,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((bi,Da)=>{Mr||(Mr=bi,Sr=new Map,jr=this.updateImageMapAndGetImageTaskQueue(Sr,Da,zt.iconDependencies),$a())}),void 0,!1,Ia):(Sr=new Map,jr=new Map);const Gi=Array.from(zt.patternDependencies.keys()).map((bi=>a.I.parse(bi)));Gi.length?Pe.send("getImages",{images:Gi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((bi,Da)=>{Mr||(Mr=bi,gi=new Map,da=this.updateImageMapAndGetImageTaskQueue(gi,Da,zt.patternDependencies),$a())}),void 0,!1,Ia):(gi=new Map,da=new Map)}if(zt.elevationFeatures&&zt.elevationFeatures.length>0){const Qr=[];for(const Gi of Object.values(yt))if(Gi instanceof a.b8){const bi=Gi.getUnevaluatedPortalGraph();bi&&Qr.push(bi)}const Ri=a.fi.evaluate(Qr);for(const Gi of Object.values(yt))if(Gi instanceof a.b8){const bi=he.layers[wt.decode(Gi.sourceLayerIndex)];Gi.setEvaluatedPortalGraph(Ri,bi,this.tileID.canonical,zt.availableImages,zt.brightness)}}$a()};Fn.length>0?Promise.allSettled(Fn).then(Hn).catch(Ke):Hn()}rasterizeIfNeeded(he,ye,Ae,He){Array.from(ye.values()).some((Pe=>Pe.usvg))?this.rasterize(he,ye,Ae,He):He()}updateImageMapAndGetImageTaskQueue(he,ye,Ae){const He=new Map;for(const Pe of ye.keys()){const Ke=Ae.get(Pe)||[];for(const wt of Ke){const et=wt.toString(),yt=ye.get(wt.id.toString());yt.usvg?He.has(et)||(He.set(et,wt),he.set(et,Object.assign({},yt))):he.set(et,yt)}}return He}rasterize(he,ye,Ae,He){this.rasterizeTask=he.send("rasterizeImages",{scope:this.scope,tasks:Ae},((Pe,Ke)=>{if(!Pe)for(const[wt,et]of Ke.entries()){const yt=Object.assign(ye.get(wt),{data:et});ye.set(wt,yt)}He()}))}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function q(ot,he,ye,Ae,He){const Pe=new a.aa(he,{brightness:ye,worldview:He});for(const Ke of ot)Ke.recalculate(Pe,Ae)}class V extends a.E{constructor(he,ye,Ae,He,Pe,Ke,wt){super(),this.actor=he,this.layerIndex=ye,this.availableImages=Ae,this.availableModels=He,this.loadVectorData=Ke||a.aJ,this.loading={},this.loaded={},this.deduped=new a.aI(he.scheduler),this.isSpriteLoaded=Pe,this.scheduler=he.scheduler,this.brightness=wt}loadTile(he,ye){const Ae=he.uid,He=he&&he.request,Pe=He&&He.collectResourceTiming,Ke=this.loading[Ae]=new G(he);Ke.abort=this.loadVectorData(he,((wt,et)=>{const yt=!this.loading[Ae];if(delete this.loading[Ae],Ke.cancelRasterize(),yt||wt||!et)return Ke.status="done",yt||(this.loaded[Ae]=Ke),ye(wt);const Zt=et.rawData,zt={};et.expires&&(zt.expires=et.expires),et.cacheControl&&(zt.cacheControl=et.cacheControl),Ke.vectorTile=et.vectorTile||new a.fo(new a.bq(Zt));const Fn=()=>{Ke.parse(Ke.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,((Yn,Hn)=>{if(Yn||!Hn)return ye(Yn);const Mr={};if(Pe){const gr=w(He);gr.length>0&&(Mr.resourceTiming=JSON.parse(JSON.stringify(gr)))}ye(null,a.h({rawTileData:Zt.slice(0)},Hn,zt,Mr))}))};this.isSpriteLoaded?Fn():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(Fn,{type:"parseTile",isSymbolTile:he.isSymbolTile,zoom:he.tileZoom}):Fn()})),this.loaded=this.loaded||{},this.loaded[Ae]=Ke}))}reloadTile(he,ye){const Ae=this.loaded,He=he.uid;if(Ae&&Ae[He]){const Pe=Ae[He];Pe.scaleFactor=he.scaleFactor,Pe.showCollisionBoxes=he.showCollisionBoxes,Pe.projection=he.projection,Pe.brightness=he.brightness,Pe.tileTransform=a.aW(he.tileID.canonical,he.projection),Pe.extraShadowCaster=he.extraShadowCaster,Pe.lut=he.lut,Pe.worldview=he.worldview;const Ke=(wt,et)=>{const yt=Pe.reloadCallback;yt&&(delete Pe.reloadCallback,Pe.parse(Pe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,yt)),ye(wt,et)};Pe.status==="parsing"?Pe.reloadCallback=Ke:Pe.status==="done"&&(Pe.vectorTile?Pe.parse(Pe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Ke):Ke())}else ye(null,void 0)}abortTile(he,ye){const Ae=he.uid,He=this.loading[Ae];He&&(He.abort&&He.abort(),delete this.loading[Ae]),ye()}removeTile(he,ye){const Ae=this.loaded,He=he.uid;Ae&&Ae[He]&&delete Ae[He],ye()}}class J{loadTile(he,ye){const{uid:Ae,encoding:He,rawImageData:Pe,padding:Ke}=he,wt=ImageBitmap&&Pe instanceof ImageBitmap?this.getImageData(Pe,Ke):Pe;ye(null,new a.fp(Ae,wt,He,Ke<1))}reloadTile(he,ye){ye(null,null)}abortTile(he,ye){ye()}removeTile(he,ye){ye()}getImageData(he,ye){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(he.width,he.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=he.width,this.offscreenCanvas.height=he.height,this.offscreenCanvasContext.drawImage(he,0,0,he.width,he.height);const Ae=this.offscreenCanvasContext.getImageData(-ye,-ye,he.width+2*ye,he.height+2*ye);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ae}}a.bp.setPbf(a.bq);class ee{constructor(he){this._mrt=new a.bp(he.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=he.uid,this.tileID=he.tileID,this.source=he.source}parse(he,ye){const Ae=this._mrt;this.status="parsing",this._entireBuffer=he;try{Ae.parseHeader(he),this._isHeaderLoaded=!0;const He=[];for(const Pe in Ae.layers){const Ke=Ae.getLayer(Pe),wt=Ke.getDataRange(Ke.getBandList()),et=Ae.createDecodingTask(wt),yt=he.slice(wt.firstByte,wt.lastByte+1),Zt=a.bp.performDecoding(yt,et).then((zt=>et.complete(null,zt))).catch((zt=>et.complete(zt,null)));He.push(Zt)}Promise.allSettled(He).then((()=>ye(null,Ae))).catch((Pe=>ye(Pe)))}catch(He){ye(He)}}}class re{constructor(he){this.actor=he,this.loading={},this.loaded={}}loadTile(he,ye){const Ae=he.uid,He=he.request,Pe=this.loading[Ae]=new ee(he),{cancel:Ke}=a.br(He,((wt,et,yt,Zt)=>{const zt=!this.loading[Ae];if(delete this.loading[Ae],zt||wt||!et)return Pe.status="done",zt||(this.loaded[Ae]=Pe),ye(wt);Pe.parse(et,((Fn,Yn)=>{if(Fn||!Yn)return ye(Fn);ye(null,Yn,yt,Zt)})),this.loaded[Ae]=Pe}));Pe.abort=Ke}reloadTile(he,ye){ye(null,void 0)}abortTile(he,ye){const Ae=he.uid,He=this.loading[Ae];He&&(He.abort&&He.abort(),delete this.loading[Ae]),ye()}removeTile(he,ye){const Ae=he.uid;this.loaded[Ae]&&delete this.loaded[Ae],ye()}decodeRasterArray(he,ye){a.bp.performDecoding(he.buffer,he.task).then((Ae=>ye(null,Ae))).catch((Ae=>ye(Ae)))}}const fe=a.fq.prototype.toGeoJSON;class ne{constructor(he){this._feature=he,this.extent=a.aj,this.type=he.type,this.properties=he.tags,"id"in he&&!isNaN(he.id)&&(this.id=parseInt(he.id,10))}loadGeometry(){if(this._feature.type===1){const he=[];for(const ye of this._feature.geometry)he.push([new a.P(ye[0],ye[1])]);return he}{const he=[];for(const ye of this._feature.geometry){const Ae=[];for(const He of ye)Ae.push(new a.P(He[0],He[1]));he.push(Ae)}return he}}toGeoJSON(he,ye,Ae){return fe.call(this,he,ye,Ae)}}class ce{constructor(he,ye){this.name=he,this.extent=a.aj,this.length=ye.length,this._jsonFeatures=ye}feature(he){return new ne(this._jsonFeatures[he])}}class me{constructor(he){this.layers={},this.extent=a.aj;for(const ye of Object.keys(he))this.layers[ye]=new ce(ye,he[ye])}}const ve=64/4096,De=128;class Ye{constructor(){this.features=new Map}clear(){this.features.clear()}load(he=[],ye){for(const Ae of he){const He=Ae.id;if(He==null)continue;let Pe=this.features.get(He);Pe&&this.updateCache(Pe,ye),Ae.geometry?(Pe=tt(Ae),this.updateCache(Pe,ye),this.features.set(He,Pe)):this.features.delete(He),this.updateCache(Pe,ye)}}updateCache(he,ye){for(const{canonical:Ae,uid:He}of Object.values(ye)){const{z:Pe,x:Ke,y:wt}=Ae;ze(he,Math.pow(2,Pe),Ke,wt)&&delete ye[He]}}getTile(he,ye,Ae){const He=Math.pow(2,he),Pe=[];for(const Ke of this.features.values())ze(Ke,He,ye,Ae)&&Pe.push(Ie(Ke,He,ye,Ae));return{features:Pe}}getFeatures(){return[...this.features.values()]}}function ze({minX:ot,minY:he,maxX:ye,maxY:Ae},He,Pe,Ke){return ot<(Pe+1+ve)/He&&he<(Ke+1+ve)/He&&ye>(Pe-ve)/He&&Ae>(Ke-ve)/He}function tt(ot){const{id:he,geometry:ye,properties:Ae}=ot;if(!ye)return;if(ye.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:He,coordinates:Pe}=ye,Ke={id:he,type:1,geometry:[],tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},wt=Ke.geometry;if(He==="Point")at(Pe,wt,Ke);else if(He==="MultiPoint")for(const et of Pe)at(et,wt,Ke);else if(He==="LineString")Ke.type=2,ct(Pe,wt,Ke);else if(He==="MultiLineString")Ke.type=2,ht(Pe,wt,Ke);else if(He==="Polygon")Ke.type=3,ht(Pe,wt,Ke,!0);else{if(He!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Ke.type=3;for(const et of Pe)ht(et,wt,Ke,!0)}return Ke}function at([ot,he],ye,Ae){const He=a.aD(ot);let Pe=a.aH(he);Pe=Pe<0?0:Pe>1?1:Pe,ye.push(He,Pe),Ae.minX=Math.min(Ae.minX,He),Ae.minY=Math.min(Ae.minY,Pe),Ae.maxX=Math.max(Ae.maxX,He),Ae.maxY=Math.max(Ae.maxY,Pe)}function ct(ot,he,ye,Ae=!1,He=!1){const Pe=[];for(const Ke of ot)at(Ke,Pe,ye);he.push(Pe),Ae&&(function(Ke,wt){let et=0;for(let yt=0,Zt=Ke.length,zt=Zt-2;yt<Zt;zt=yt,yt+=2)et+=(Ke[yt]-Ke[zt])*(Ke[yt+1]+Ke[zt+1]);if(et>0===wt)for(let yt=0,Zt=Ke.length;yt<Zt/2;yt+=2){const zt=Ke[yt],Fn=Ke[yt+1];Ke[yt]=Ke[Zt-2-yt],Ke[yt+1]=Ke[Zt-1-yt],Ke[Zt-2-yt]=zt,Ke[Zt-1-yt]=Fn}})(Pe,He)}function ht(ot,he,ye,Ae=!1){for(let He=0;He<ot.length;He++)ct(ot[He],he,ye,Ae,He===0)}function Ie(ot,he,ye,Ae){const{id:He,type:Pe,geometry:Ke,tags:wt}=ot,et=[];if(Pe===1)(function(yt,Zt,zt,Fn,Yn){for(let Hn=0;Hn<yt.length;Hn+=2){const Mr=Math.round(a.aj*(yt[Hn+0]*Zt-zt)),gr=Math.round(a.aj*(yt[Hn+1]*Zt-Fn));Yn.push([Mr,gr])}})(Ke,he,ye,Ae,et);else for(const yt of Ke)rt(yt,he,ye,Ae,et);return{id:He,type:Pe,geometry:et,tags:wt}}function rt(ot,he,ye,Ae,He){const Pe=-De,Ke=a.aj+De;let wt;for(let et=0;et<ot.length-2;et+=2){let yt=Math.round(a.aj*(ot[et+0]*he-ye)),Zt=Math.round(a.aj*(ot[et+1]*he-Ae)),zt=Math.round(a.aj*(ot[et+2]*he-ye)),Fn=Math.round(a.aj*(ot[et+3]*he-Ae));const Yn=zt-yt,Hn=Fn-Zt;yt<Pe&&zt<Pe||(yt<Pe?(Zt+=Math.round(Hn*((Pe-yt)/Yn)),yt=Pe):zt<Pe&&(Fn=Zt+Math.round(Hn*((Pe-yt)/Yn)),zt=Pe),Zt<Pe&&Fn<Pe||(Zt<Pe?(yt+=Math.round(Yn*((Pe-Zt)/Hn)),Zt=Pe):Fn<Pe&&(zt=yt+Math.round(Yn*((Pe-Zt)/Hn)),Fn=Pe),yt>=Ke&&zt>=Ke||(yt>=Ke?(Zt+=Math.round(Hn*((Ke-yt)/Yn)),yt=Ke):zt>=Ke&&(Fn=Zt+Math.round(Hn*((Ke-yt)/Yn)),zt=Ke),Zt>=Ke&&Fn>=Ke||(Zt>=Ke?(yt+=Math.round(Yn*((Ke-Zt)/Hn)),Zt=Ke):Fn>=Ke&&(zt=yt+Math.round(Yn*((Ke-Zt)/Hn)),Fn=Ke),wt&&yt===wt[wt.length-1][0]&&Zt===wt[wt.length-1][1]||(wt=[[yt,Zt]],He.push(wt)),wt.push([zt,Fn])))))}}function Qe({name:ot,features:he},ye){ye.writeStringField(1,ot),ye.writeVarintField(5,a.aj);const Ae=new Map,He=new Map,Pe={keys:Ae,values:He,feature:null};for(const Ke of he)Pe.feature=Ke,ye.writeMessage(2,St,Pe);for(const Ke of Ae.keys())ye.writeStringField(3,Ke);for(const Ke of He.keys())ye.writeMessage(4,Ut,Ke)}function St(ot,he){const ye=ot.feature;ye.id===void 0||isNaN(+ye.id)||he.writeVarintField(1,+ye.id),ye.tags&&he.writeMessage(2,qe,ot),he.writeVarintField(3,ye.type),he.writeMessage(4,gt,ye)}function qe({keys:ot,values:he,feature:ye},Ae){for(const He of Object.keys(ye.tags)){let Pe=ye.tags[He];if(Pe===null)continue;let Ke=ot.get(He);Ke===void 0&&(Ke=ot.size,ot.set(He,Ke)),Ae.writeVarint(Ke);const wt=typeof Pe;wt!=="string"&&wt!=="boolean"&&wt!=="number"&&(Pe=JSON.stringify(Pe));let et=he.get(Pe);et===void 0&&(et=he.size,he.set(Pe,et)),Ae.writeVarint(et)}}function vt(ot,he){return(he<<3)+(7&ot)}function nt(ot){return ot<<1^ot>>31}function gt(ot,he){const{geometry:ye,type:Ae}=ot;let He=0,Pe=0;if(Ae===1){he.writeVarint(vt(1,ye.length));for(const Ke of ye){const wt=Ke[0]-He,et=Ke[1]-Pe;he.writeVarint(nt(wt)),he.writeVarint(nt(et)),He+=wt,Pe+=et}}else for(const Ke of ye){he.writeVarint(vt(1,1));const wt=Ke.length-(Ae===3?1:0);for(let et=0;et<wt;et++){et===1&&he.writeVarint(vt(2,wt-1));const yt=Ke[et][0]-He,Zt=Ke[et][1]-Pe;he.writeVarint(nt(yt)),he.writeVarint(nt(Zt)),He+=yt,Pe+=Zt}Ae===3&&he.writeVarint(vt(7,1))}}function Ut(ot,he){const ye=typeof ot;ye==="string"?he.writeStringField(1,ot):ye==="boolean"?he.writeBooleanField(7,ot):ye==="number"&&(ot%1!=0?he.writeDoubleField(3,ot):ot<0?he.writeSVarintField(6,ot):he.writeVarintField(5,ot))}const $t={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ot=>ot},qt=Math.fround||(Ht=new Float32Array(1),ot=>(Ht[0]=+ot,Ht[0]));var Ht;const mn=3,en=5,En=6;class Xn{constructor(he){this.options=Object.assign(Object.create($t),he),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(he){const{log:ye,minZoom:Ae,maxZoom:He}=this.options;ye&&console.time("total time");const Pe=`prepare ${he.length} points`;ye&&console.time(Pe),this.points=he;const Ke=[];for(let et=0;et<he.length;et++){const yt=he[et];if(!yt.geometry)continue;const[Zt,zt]=yt.geometry.coordinates,Fn=qt(mr(Zt)),Yn=qt(Cr(zt));Ke.push(Fn,Yn,1/0,et,-1,1),this.options.reduce&&Ke.push(0)}let wt=this.trees[He+1]=this._createTree(Ke);ye&&console.timeEnd(Pe);for(let et=He;et>=Ae;et--){const yt=+Date.now();wt=this.trees[et]=this._createTree(this._cluster(wt,et)),ye&&console.log("z%d: %d clusters in %dms",et,wt.numItems,+Date.now()-yt)}return ye&&console.timeEnd("total time"),this}getClusters(he,ye){let Ae=((he[0]+180)%360+360)%360-180;const He=Math.max(-90,Math.min(90,he[1]));let Pe=he[2]===180?180:((he[2]+180)%360+360)%360-180;const Ke=Math.max(-90,Math.min(90,he[3]));if(he[2]-he[0]>=360)Ae=-180,Pe=180;else if(Ae>Pe){const zt=this.getClusters([Ae,He,180,Ke],ye),Fn=this.getClusters([-180,He,Pe,Ke],ye);return zt.concat(Fn)}const wt=this.trees[this._limitZoom(ye)],et=wt.range(mr(Ae),Cr(Ke),mr(Pe),Cr(He)),yt=wt.data,Zt=[];for(const zt of et){const Fn=this.stride*zt;Zt.push(yt[Fn+en]>1?cn(yt,Fn,this.clusterProps):this.points[yt[Fn+mn]])}return Zt}getChildren(he){const ye=this._getOriginId(he),Ae=this._getOriginZoom(he),He="No cluster with the specified id.",Pe=this.trees[Ae];if(!Pe)throw new Error(He);const Ke=Pe.data;if(ye*this.stride>=Ke.length)throw new Error(He);const wt=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),et=Pe.within(Ke[ye*this.stride],Ke[ye*this.stride+1],wt),yt=[];for(const Zt of et){const zt=Zt*this.stride;Ke[zt+4]===he&&yt.push(Ke[zt+en]>1?cn(Ke,zt,this.clusterProps):this.points[Ke[zt+mn]])}if(yt.length===0)throw new Error(He);return yt}getLeaves(he,ye,Ae){const He=[];return this._appendLeaves(He,he,ye=ye||10,Ae=Ae||0,0),He}getTile(he,ye,Ae){const He=this.trees[this._limitZoom(he)],Pe=Math.pow(2,he),{extent:Ke,radius:wt}=this.options,et=wt/Ke,yt=(Ae-et)/Pe,Zt=(Ae+1+et)/Pe,zt={features:[]};return this._addTileFeatures(He.range((ye-et)/Pe,yt,(ye+1+et)/Pe,Zt),He.data,ye,Ae,Pe,zt),ye===0&&this._addTileFeatures(He.range(1-et/Pe,yt,1,Zt),He.data,Pe,Ae,Pe,zt),ye===Pe-1&&this._addTileFeatures(He.range(0,yt,et/Pe,Zt),He.data,-1,Ae,Pe,zt),zt.features.length?zt:null}getClusterExpansionZoom(he){let ye=this._getOriginZoom(he)-1;for(;ye<=this.options.maxZoom;){const Ae=this.getChildren(he);if(ye++,Ae.length!==1)break;he=Ae[0].properties.cluster_id}return ye}_appendLeaves(he,ye,Ae,He,Pe){const Ke=this.getChildren(ye);for(const wt of Ke){const et=wt.properties;if(et&&et.cluster?Pe+et.point_count<=He?Pe+=et.point_count:Pe=this._appendLeaves(he,et.cluster_id,Ae,He,Pe):Pe<He?Pe++:he.push(wt),he.length===Ae)break}return Pe}_createTree(he){const ye=new a.c0(he.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ae=0;Ae<he.length;Ae+=this.stride)ye.add(he[Ae],he[Ae+1]);return ye.finish(),ye.data=he,ye}_addTileFeatures(he,ye,Ae,He,Pe,Ke){for(const wt of he){const et=wt*this.stride,yt=ye[et+en]>1;let Zt,zt,Fn;if(yt)Zt=Jr(ye,et,this.clusterProps),zt=ye[et],Fn=ye[et+1];else{const Mr=this.points[ye[et+mn]];Zt=Mr.properties;const[gr,Sr]=Mr.geometry.coordinates;zt=mr(gr),Fn=Cr(Sr)}const Yn={type:1,geometry:[[Math.round(this.options.extent*(zt*Pe-Ae)),Math.round(this.options.extent*(Fn*Pe-He))]],tags:Zt};let Hn;Hn=yt||this.options.generateId?ye[et+mn]:this.points[ye[et+mn]].id,Hn!==void 0&&(Yn.id=Hn),Ke.features.push(Yn)}}_limitZoom(he){return Math.max(this.options.minZoom,Math.min(Math.floor(+he),this.options.maxZoom+1))}_cluster(he,ye){const{radius:Ae,extent:He,reduce:Pe,minPoints:Ke}=this.options,wt=Ae/(He*Math.pow(2,ye)),et=he.data,yt=[],Zt=this.stride;for(let zt=0;zt<et.length;zt+=Zt){if(et[zt+2]<=ye)continue;et[zt+2]=ye;const Fn=et[zt],Yn=et[zt+1],Hn=he.within(et[zt],et[zt+1],wt),Mr=et[zt+en];let gr=Mr;for(const Sr of Hn){const gi=Sr*Zt;et[gi+2]>ye&&(gr+=et[gi+en])}if(gr>Mr&&gr>=Ke){let Sr,gi=Fn*Mr,jr=Yn*Mr,da=-1;const Ia=(zt/Zt<<5)+(ye+1)+this.points.length;for(const $a of Hn){const yi=$a*Zt;if(et[yi+2]<=ye)continue;et[yi+2]=ye;const Qr=et[yi+en];gi+=et[yi]*Qr,jr+=et[yi+1]*Qr,et[yi+4]=Ia,Pe&&(Sr||(Sr=this._map(et,zt,!0),da=this.clusterProps.length,this.clusterProps.push(Sr)),Pe(Sr,this._map(et,yi)))}et[zt+4]=Ia,yt.push(gi/gr,jr/gr,1/0,Ia,-1,gr),Pe&&yt.push(da)}else{for(let Sr=0;Sr<Zt;Sr++)yt.push(et[zt+Sr]);if(gr>1)for(const Sr of Hn){const gi=Sr*Zt;if(!(et[gi+2]<=ye)){et[gi+2]=ye;for(let jr=0;jr<Zt;jr++)yt.push(et[gi+jr])}}}}return yt}_getOriginId(he){return he-this.points.length>>5}_getOriginZoom(he){return(he-this.points.length)%32}_map(he,ye,Ae){if(he[ye+en]>1){const Ke=this.clusterProps[he[ye+En]];return Ae?Object.assign({},Ke):Ke}const He=this.points[he[ye+mn]].properties,Pe=this.options.map(He);return Ae&&Pe===He?Object.assign({},Pe):Pe}}function cn(ot,he,ye){return{type:"Feature",id:ot[he+mn],properties:Jr(ot,he,ye),geometry:{type:"Point",coordinates:[(Ae=ot[he],360*(Ae-.5)),li(ot[he+1])]}};var Ae}function Jr(ot,he,ye){const Ae=ot[he+en],He=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae,Pe=ot[he+En],Ke=Pe===-1?{}:Object.assign({},ye[Pe]);return Object.assign(Ke,{cluster:!0,cluster_id:ot[he+mn],point_count:Ae,point_count_abbreviated:He})}function mr(ot){return ot/360+.5}function Cr(ot){const he=Math.sin(ot*Math.PI/180),ye=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return ye<0?0:ye>1?1:ye}function li(ot){const he=(180-360*ot)*Math.PI/180;return 360*Math.atan(Math.exp(he))/Math.PI-90}function hi(ot,he,ye,Ae){let He=Ae;const Pe=he+(ye-he>>1);let Ke,wt=ye-he;const et=ot[he],yt=ot[he+1],Zt=ot[ye],zt=ot[ye+1];for(let Fn=he+3;Fn<ye;Fn+=3){const Yn=so(ot[Fn],ot[Fn+1],et,yt,Zt,zt);if(Yn>He)Ke=Fn,He=Yn;else if(Yn===He){const Hn=Math.abs(Fn-Pe);Hn<wt&&(Ke=Fn,wt=Hn)}}He>Ae&&(Ke-he>3&&hi(ot,he,Ke,Ae),ot[Ke+2]=He,ye-Ke>3&&hi(ot,Ke,ye,Ae))}function so(ot,he,ye,Ae,He,Pe){let Ke=He-ye,wt=Pe-Ae;if(Ke!==0||wt!==0){const et=((ot-ye)*Ke+(he-Ae)*wt)/(Ke*Ke+wt*wt);et>1?(ye=He,Ae=Pe):et>0&&(ye+=Ke*et,Ae+=wt*et)}return Ke=ot-ye,wt=he-Ae,Ke*Ke+wt*wt}function ra(ot,he,ye,Ae){const He={id:ot??null,type:he,geometry:ye,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(he==="Point"||he==="MultiPoint"||he==="LineString")xt(He,ye);else if(he==="Polygon")xt(He,ye[0]);else if(he==="MultiLineString")for(const Pe of ye)xt(He,Pe);else if(he==="MultiPolygon")for(const Pe of ye)xt(He,Pe[0]);return He}function xt(ot,he){for(let ye=0;ye<he.length;ye+=3)ot.minX=Math.min(ot.minX,he[ye]),ot.minY=Math.min(ot.minY,he[ye+1]),ot.maxX=Math.max(ot.maxX,he[ye]),ot.maxY=Math.max(ot.maxY,he[ye+1])}function Bt(ot,he,ye,Ae){if(!he.geometry)return;const He=he.geometry.coordinates;if(He&&He.length===0)return;const Pe=he.geometry.type,Ke=Math.pow(ye.tolerance/((1<<ye.maxZoom)*ye.extent),2);let wt=[],et=he.id;if(ye.promoteId?et=he.properties[ye.promoteId]:ye.generateId&&(et=Ae||0),Pe==="Point")tn(He,wt);else if(Pe==="MultiPoint")for(const yt of He)tn(yt,wt);else if(Pe==="LineString")$n(He,wt,Ke,!1);else if(Pe==="MultiLineString"){if(ye.lineMetrics){for(const yt of He)wt=[],$n(yt,wt,Ke,!1),ot.push(ra(et,"LineString",wt,he.properties));return}qn(He,wt,Ke,!1)}else if(Pe==="Polygon")qn(He,wt,Ke,!0);else{if(Pe!=="MultiPolygon"){if(Pe==="GeometryCollection"){for(const yt of he.geometry.geometries)Bt(ot,{id:et,geometry:yt,properties:he.properties},ye,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const yt of He){const Zt=[];qn(yt,Zt,Ke,!0),wt.push(Zt)}}ot.push(ra(et,Pe,wt,he.properties))}function tn(ot,he){he.push(An(ot[0]),tr(ot[1]),0)}function $n(ot,he,ye,Ae){let He,Pe,Ke=0;for(let et=0;et<ot.length;et++){const yt=An(ot[et][0]),Zt=tr(ot[et][1]);he.push(yt,Zt,0),et>0&&(Ke+=Ae?(He*Zt-yt*Pe)/2:Math.sqrt(Math.pow(yt-He,2)+Math.pow(Zt-Pe,2))),He=yt,Pe=Zt}const wt=he.length-3;he[2]=1,hi(he,0,wt,ye),he[wt+2]=1,he.size=Math.abs(Ke),he.start=0,he.end=he.size}function qn(ot,he,ye,Ae){for(let He=0;He<ot.length;He++){const Pe=[];$n(ot[He],Pe,ye,Ae),he.push(Pe)}}function An(ot){return ot/360+.5}function tr(ot){const he=Math.sin(ot*Math.PI/180),ye=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return ye<0?0:ye>1?1:ye}function Ir(ot,he,ye,Ae,He,Pe,Ke,wt){if(Ae/=he,Pe>=(ye/=he)&&Ke<Ae)return ot;if(Ke<ye||Pe>=Ae)return null;const et=[];for(const yt of ot){const Zt=yt.geometry;let zt=yt.type;const Fn=He===0?yt.minX:yt.minY,Yn=He===0?yt.maxX:yt.maxY;if(Fn>=ye&&Yn<Ae){et.push(yt);continue}if(Yn<ye||Fn>=Ae)continue;let Hn=[];if(zt==="Point"||zt==="MultiPoint")mi(Zt,Hn,ye,Ae,He);else if(zt==="LineString")Mi(Zt,Hn,ye,Ae,He,!1,wt.lineMetrics);else if(zt==="MultiLineString")oa(Zt,Hn,ye,Ae,He,!1);else if(zt==="Polygon")oa(Zt,Hn,ye,Ae,He,!0);else if(zt==="MultiPolygon")for(const Mr of Zt){const gr=[];oa(Mr,gr,ye,Ae,He,!0),gr.length&&Hn.push(gr)}if(Hn.length){if(wt.lineMetrics&&zt==="LineString"){for(const Mr of Hn)et.push(ra(yt.id,zt,Mr,yt.tags));continue}zt!=="LineString"&&zt!=="MultiLineString"||(Hn.length===1?(zt="LineString",Hn=Hn[0]):zt="MultiLineString"),zt!=="Point"&&zt!=="MultiPoint"||(zt=Hn.length===3?"Point":"MultiPoint"),et.push(ra(yt.id,zt,Hn,yt.tags))}}return et.length?et:null}function mi(ot,he,ye,Ae,He){for(let Pe=0;Pe<ot.length;Pe+=3){const Ke=ot[Pe+He];Ke>=ye&&Ke<=Ae&&Ua(he,ot[Pe],ot[Pe+1],ot[Pe+2])}}function Mi(ot,he,ye,Ae,He,Pe,Ke){let wt=_o(ot);const et=He===0?lo:eo;let yt,Zt,zt=ot.start;for(let gr=0;gr<ot.length-3;gr+=3){const Sr=ot[gr],gi=ot[gr+1],jr=ot[gr+2],da=ot[gr+3],Ia=ot[gr+4],$a=He===0?Sr:gi,yi=He===0?da:Ia;let Qr=!1;Ke&&(yt=Math.sqrt(Math.pow(Sr-da,2)+Math.pow(gi-Ia,2))),$a<ye?yi>ye&&(Zt=et(wt,Sr,gi,da,Ia,ye),Ke&&(wt.start=zt+yt*Zt)):$a>Ae?yi<Ae&&(Zt=et(wt,Sr,gi,da,Ia,Ae),Ke&&(wt.start=zt+yt*Zt)):Ua(wt,Sr,gi,jr),yi<ye&&$a>=ye&&(Zt=et(wt,Sr,gi,da,Ia,ye),Qr=!0),yi>Ae&&$a<=Ae&&(Zt=et(wt,Sr,gi,da,Ia,Ae),Qr=!0),!Pe&&Qr&&(Ke&&(wt.end=zt+yt*Zt),he.push(wt),wt=_o(ot)),Ke&&(zt+=yt)}let Fn=ot.length-3;const Yn=ot[Fn],Hn=ot[Fn+1],Mr=He===0?Yn:Hn;Mr>=ye&&Mr<=Ae&&Ua(wt,Yn,Hn,ot[Fn+2]),Fn=wt.length-3,Pe&&Fn>=3&&(wt[Fn]!==wt[0]||wt[Fn+1]!==wt[1])&&Ua(wt,wt[0],wt[1],wt[2]),wt.length&&he.push(wt)}function _o(ot){const he=[];return he.size=ot.size,he.start=ot.start,he.end=ot.end,he}function oa(ot,he,ye,Ae,He,Pe){for(const Ke of ot)Mi(Ke,he,ye,Ae,He,Pe,!1)}function Ua(ot,he,ye,Ae){ot.push(he,ye,Ae)}function lo(ot,he,ye,Ae,He,Pe){const Ke=(Pe-he)/(Ae-he);return Ua(ot,Pe,ye+(He-ye)*Ke,1),Ke}function eo(ot,he,ye,Ae,He,Pe){const Ke=(Pe-ye)/(He-ye);return Ua(ot,he+(Ae-he)*Ke,Pe,1),Ke}function co(ot,he){const ye=[];for(let Ae=0;Ae<ot.length;Ae++){const He=ot[Ae],Pe=He.type;let Ke;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")Ke=vo(He.geometry,he);else if(Pe==="MultiLineString"||Pe==="Polygon"){Ke=[];for(const wt of He.geometry)Ke.push(vo(wt,he))}else if(Pe==="MultiPolygon"){Ke=[];for(const wt of He.geometry){const et=[];for(const yt of wt)et.push(vo(yt,he));Ke.push(et)}}ye.push(ra(He.id,Pe,Ke,He.tags))}return ye}function vo(ot,he){const ye=[];ye.size=ot.size,ot.start!==void 0&&(ye.start=ot.start,ye.end=ot.end);for(let Ae=0;Ae<ot.length;Ae+=3)ye.push(ot[Ae]+he,ot[Ae+1],ot[Ae+2]);return ye}function ss(ot,he){if(ot.transformed)return ot;const ye=1<<ot.z,Ae=ot.x,He=ot.y;for(const Pe of ot.features){const Ke=Pe.geometry,wt=Pe.type;if(Pe.geometry=[],wt===1)for(let et=0;et<Ke.length;et+=2)Pe.geometry.push(ir(Ke[et],Ke[et+1],he,ye,Ae,He));else for(let et=0;et<Ke.length;et++){const yt=[];for(let Zt=0;Zt<Ke[et].length;Zt+=2)yt.push(ir(Ke[et][Zt],Ke[et][Zt+1],he,ye,Ae,He));Pe.geometry.push(yt)}}return ot.transformed=!0,ot}function ir(ot,he,ye,Ae,He,Pe){return[Math.round(ye*(ot*Ae-He)),Math.round(ye*(he*Ae-Pe))]}function xi(ot,he,ye,Ae,He){const Pe=he===He.maxZoom?0:He.tolerance/((1<<he)*He.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:ot.length,source:null,x:ye,y:Ae,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const wt of ot)ci(Ke,wt,Pe,He);return Ke}function ci(ot,he,ye,Ae){const He=he.geometry,Pe=he.type,Ke=[];if(ot.minX=Math.min(ot.minX,he.minX),ot.minY=Math.min(ot.minY,he.minY),ot.maxX=Math.max(ot.maxX,he.maxX),ot.maxY=Math.max(ot.maxY,he.maxY),Pe==="Point"||Pe==="MultiPoint")for(let wt=0;wt<He.length;wt+=3)Ke.push(He[wt],He[wt+1]),ot.numPoints++,ot.numSimplified++;else if(Pe==="LineString")Ra(Ke,He,ot,ye,!1,!1);else if(Pe==="MultiLineString"||Pe==="Polygon")for(let wt=0;wt<He.length;wt++)Ra(Ke,He[wt],ot,ye,Pe==="Polygon",wt===0);else if(Pe==="MultiPolygon")for(let wt=0;wt<He.length;wt++){const et=He[wt];for(let yt=0;yt<et.length;yt++)Ra(Ke,et[yt],ot,ye,!0,yt===0)}if(Ke.length){let wt=he.tags||null;if(Pe==="LineString"&&Ae.lineMetrics){wt={};for(const yt in he.tags)wt[yt]=he.tags[yt];wt.mapbox_clip_start=He.start/He.size,wt.mapbox_clip_end=He.end/He.size}const et={geometry:Ke,type:Pe==="Polygon"||Pe==="MultiPolygon"?3:Pe==="LineString"||Pe==="MultiLineString"?2:1,tags:wt};he.id!==null&&(et.id=he.id),ot.features.push(et)}}function Ra(ot,he,ye,Ae,He,Pe){const Ke=Ae*Ae;if(Ae>0&&he.size<(He?Ke:Ae))return void(ye.numPoints+=he.length/3);const wt=[];for(let et=0;et<he.length;et+=3)(Ae===0||he[et+2]>Ke)&&(ye.numSimplified++,wt.push(he[et],he[et+1])),ye.numPoints++;He&&(function(et,yt){let Zt=0;for(let zt=0,Fn=et.length,Yn=Fn-2;zt<Fn;Yn=zt,zt+=2)Zt+=(et[zt]-et[Yn])*(et[zt+1]+et[Yn+1]);if(Zt>0===yt)for(let zt=0,Fn=et.length;zt<Fn/2;zt+=2){const Yn=et[zt],Hn=et[zt+1];et[zt]=et[Fn-2-zt],et[zt+1]=et[Fn-1-zt],et[Fn-2-zt]=Yn,et[Fn-1-zt]=Hn}})(wt,Pe),ot.push(wt)}const ya={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Tl{constructor(he,ye){const Ae=(ye=this.options=(function(Pe,Ke){for(const wt in Ke)Pe[wt]=Ke[wt];return Pe})(Object.create(ya),ye)).debug;if(Ae&&console.time("preprocess data"),ye.maxZoom<0||ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ye.promoteId&&ye.generateId)throw new Error("promoteId and generateId cannot be used together.");let He=(function(Pe,Ke){const wt=[];if(Pe.type==="FeatureCollection")for(let et=0;et<Pe.features.length;et++)Bt(wt,Pe.features[et],Ke,et);else Bt(wt,Pe.type==="Feature"?Pe:{geometry:Pe},Ke);return wt})(he,ye);this.tiles={},this.tileCoords=[],Ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ye.indexMaxZoom,ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),He=(function(Pe,Ke){const wt=Ke.buffer/Ke.extent;let et=Pe;const yt=Ir(Pe,1,-1-wt,wt,0,-1,2,Ke),Zt=Ir(Pe,1,1-wt,2+wt,0,-1,2,Ke);return(yt||Zt)&&(et=Ir(Pe,1,-wt,1+wt,0,-1,2,Ke)||[],yt&&(et=co(yt,1).concat(et)),Zt&&(et=et.concat(co(Zt,-1)))),et})(He,ye),He.length&&this.splitTile(He,0,0,0),Ae&&(He.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(he,ye,Ae,He,Pe,Ke,wt){const et=[he,ye,Ae,He],yt=this.options,Zt=yt.debug;for(;et.length;){He=et.pop(),Ae=et.pop(),ye=et.pop(),he=et.pop();const zt=1<<ye,Fn=dr(ye,Ae,He);let Yn=this.tiles[Fn];if(!Yn&&(Zt>1&&console.time("creation"),Yn=this.tiles[Fn]=xi(he,ye,Ae,He,yt),this.tileCoords.push({z:ye,x:Ae,y:He}),Zt)){Zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ye,Ae,He,Yn.numFeatures,Yn.numPoints,Yn.numSimplified),console.timeEnd("creation"));const Qr=`z${ye}`;this.stats[Qr]=(this.stats[Qr]||0)+1,this.total++}if(Yn.source=he,Pe==null){if(ye===yt.indexMaxZoom||Yn.numPoints<=yt.indexMaxPoints)continue}else{if(ye===yt.maxZoom||ye===Pe)continue;if(Pe!=null){const Qr=Pe-ye;if(Ae!==Ke>>Qr||He!==wt>>Qr)continue}}if(Yn.source=null,he.length===0)continue;Zt>1&&console.time("clipping");const Hn=.5*yt.buffer/yt.extent,Mr=.5-Hn,gr=.5+Hn,Sr=1+Hn;let gi=null,jr=null,da=null,Ia=null,$a=Ir(he,zt,Ae-Hn,Ae+gr,0,Yn.minX,Yn.maxX,yt),yi=Ir(he,zt,Ae+Mr,Ae+Sr,0,Yn.minX,Yn.maxX,yt);he=null,$a&&(gi=Ir($a,zt,He-Hn,He+gr,1,Yn.minY,Yn.maxY,yt),jr=Ir($a,zt,He+Mr,He+Sr,1,Yn.minY,Yn.maxY,yt),$a=null),yi&&(da=Ir(yi,zt,He-Hn,He+gr,1,Yn.minY,Yn.maxY,yt),Ia=Ir(yi,zt,He+Mr,He+Sr,1,Yn.minY,Yn.maxY,yt),yi=null),Zt>1&&console.timeEnd("clipping"),et.push(gi||[],ye+1,2*Ae,2*He),et.push(jr||[],ye+1,2*Ae,2*He+1),et.push(da||[],ye+1,2*Ae+1,2*He),et.push(Ia||[],ye+1,2*Ae+1,2*He+1)}}getTile(he,ye,Ae){he=+he,ye=+ye,Ae=+Ae;const He=this.options,{extent:Pe,debug:Ke}=He;if(he<0||he>24)return null;const wt=1<<he,et=dr(he,ye=ye+wt&wt-1,Ae);if(this.tiles[et])return ss(this.tiles[et],Pe);Ke>1&&console.log("drilling down to z%d-%d-%d",he,ye,Ae);let yt,Zt=he,zt=ye,Fn=Ae;for(;!yt&&Zt>0;)Zt--,zt>>=1,Fn>>=1,yt=this.tiles[dr(Zt,zt,Fn)];return yt&&yt.source?(Ke>1&&(console.log("found parent tile z%d-%d-%d",Zt,zt,Fn),console.time("drilling down")),this.splitTile(yt.source,Zt,zt,Fn,he,ye,Ae),Ke>1&&console.timeEnd("drilling down"),this.tiles[et]?ss(this.tiles[et],Pe):null):null}}function dr(ot,he,ye){return 32*((1<<ot)*ye+he)+ot}function kt(ot,he){const ye=ot.tileID.canonical;if(!this._geoJSONIndex)return void he(null,null);const Ae=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);if(!Ae)return void he(null,null);const He=yt=>yt.tags&&"3d_elevation_id"in yt.tags&&"source"in yt.tags&&yt.tags.source==="elevation",Pe=Ae.features.filter((yt=>He(yt)));let Ke={_geojsonTileLayer:Ae.features};Pe.length>0&&(Ke={_geojsonTileLayer:Ae.features.filter((yt=>!He(yt))),hd_road_elevation:Pe});const wt=new me(Ke),et=(function(yt){const Zt=new a.bq;for(const zt of Object.keys(yt))Zt.writeMessage(3,Qe,{name:zt,features:yt[zt]});return Zt.finish()})(Ke).buffer;he(null,{vectorTile:wt,rawData:et})}class Dr extends V{constructor(he,ye,Ae,He,Pe,Ke,wt){super(he,ye,Ae,He,Pe,kt,wt),Ke&&(this.loadGeoJSON=Ke),this._dynamicIndex=new Ye}loadData(he,ye){const Ae=he&&he.request,He=Ae&&Ae.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(he,((Pe,Ke)=>{if(Pe||!Ke)return ye(Pe);if(typeof Ke!="object")return ye(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));{try{if(he.filter){const et=a.X(he.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(et.result==="error")throw new Error(et.value.map((yt=>`${yt.key}: ${yt.message}`)).join(", "));Ke.features=Ke.features.filter((yt=>et.value.evaluate({zoom:0},yt)))}he.dynamic?(Ke.type==="Feature"&&(Ke={type:"FeatureCollection",features:[Ke]}),he.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Ke.features,this.loaded),he.cluster&&(Ke.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=he.cluster?new Xn((function({superclusterOptions:et,clusterProperties:yt}){if(!yt||!et)return et;const Zt={},zt={},Fn={accumulated:null,zoom:0},Yn={properties:null},Hn=Object.keys(yt);for(const Mr of Hn){const[gr,Sr]=yt[Mr],gi=a.X(Sr),jr=a.X(typeof gr=="string"?[gr,["accumulated"],["get",Mr]]:gr);Zt[Mr]=gi.value,zt[Mr]=jr.value}return et.map=Mr=>{Yn.properties=Mr;const gr={};for(const Sr of Hn)gr[Sr]=Zt[Sr].evaluate(Fn,Yn);return gr},et.reduce=(Mr,gr)=>{Yn.properties=gr;for(const Sr of Hn)Fn.accumulated=Mr[Sr],Mr[Sr]=zt[Sr].evaluate(Fn,Yn)},et})(he)).load(Ke.features):he.dynamic?this._dynamicIndex:(function(et,yt){return new Tl(et,yt)})(Ke,he.geojsonVtOptions)}catch(et){return ye(et)}const wt={};if(He){const et=w(Ae);et&&(wt.resourceTiming={},wt.resourceTiming[he.source]=JSON.parse(JSON.stringify(et)))}ye(null,wt)}}))}reloadTile(he,ye){const Ae=this.loaded;return Ae&&Ae[he.uid]?he.partial?ye(null,void 0):super.reloadTile(he,ye):this.loadTile(he,ye)}loadGeoJSON(he,ye){if(he.request)a.n(he.request,ye);else{if(typeof he.data!="string")return ye(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));setTimeout((()=>{try{return ye(null,JSON.parse(he.data))}catch{return ye(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`))}}),0)}}getClusterExpansionZoom(he,ye){try{ye(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(Ae){ye(Ae)}}getClusterChildren(he,ye){try{ye(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(Ae){ye(Ae)}}getClusterLeaves(he,ye){try{ye(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(Ae){ye(Ae)}}}class to{constructor(he,ye,Ae){this.tileID=new a.aM(he.tileID.overscaledZ,he.tileID.wrap,he.tileID.canonical.z,he.tileID.canonical.x,he.tileID.canonical.y),this.tileZoom=he.tileZoom,this.uid=he.uid,this.zoom=he.zoom,this.canonical=he.tileID.canonical,this.pixelRatio=he.pixelRatio,this.tileSize=he.tileSize,this.source=he.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=he.projection,this.brightness=ye,this.worldview=Ae}parse(he,ye,Ae,He){this.status="parsing";const Pe=new a.aM(Ae.tileID.overscaledZ,Ae.tileID.wrap,Ae.tileID.canonical.z,Ae.tileID.canonical.x,Ae.tileID.canonical.y),Ke=[],wt=ye.familiesBySource[Ae.source],et=new a.fc(Pe,Ae.promoteId);et.bucketLayerIDs=[],et.is3DTile=!0,a.fr(he).then((yt=>{if(!yt)return He(new Error("Could not parse tile"));const Zt=yt.json.extensionsUsed&&yt.json.extensionsUsed.includes("MAPBOX_mesh_features")||yt.json.asset.extras&&yt.json.asset.extras.MAPBOX_mesh_features,zt=yt.json.extensionsUsed&&yt.json.extensionsUsed.includes("EXT_meshopt_compression"),Fn=new a.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const Yn in wt)for(const Hn of wt[Yn]){const Mr=Hn[0];et.bucketLayerIDs.push(Hn.map((gi=>a.C(gi.id,gi.scope)))),Mr.recalculate(Fn,[]);const gr=a.fs(yt,1/a.d4(Ae.tileID.canonical)),Sr=new a.ft(Hn,gr,Pe,Zt,zt,this.brightness,et,this.worldview);Zt||(Sr.needsUpload=!0),Ke.push(Sr),Sr.evaluate(Mr)}this.status="done",He(null,{buckets:Ke,featureIndex:et,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((yt=>He(new Error(yt.message))))}}class Hs{constructor(he,ye,Ae,He,Pe,Ke,wt,et){this.actor=he,this.layerIndex=ye,this.availableImages=Ae,this.availableModels=He,this.brightness=wt,this.loading={},this.loaded={},this.worldview=et}loadTile(he,ye){const Ae=he.uid,He=this.loading[Ae]=new to(he,this.brightness,this.worldview);a.br(he.request,((Pe,Ke)=>{const wt=!this.loading[Ae];return delete this.loading[Ae],wt||Pe?(He.status="done",wt||(this.loaded[Ae]=He),ye(Pe)):Ke&&Ke.byteLength!==0?void He.parse(Ke,this.layerIndex,he,((et,yt)=>{He.status="done",this.loaded=this.loaded||{},this.loaded[Ae]=He,et||!yt?ye(et):ye(null,yt)})):(He.status="done",this.loaded[Ae]=He,ye())}))}reloadTile(he,ye){const Ae=this.loaded,He=he.uid;if(Ae&&Ae[He]){const Pe=Ae[He];Pe.projection=he.projection,Pe.brightness=he.brightness;const Ke=(wt,et)=>{Pe.reloadCallback&&(delete Pe.reloadCallback,this.loadTile(he,ye)),ye(wt,et)};Pe.status==="parsing"?Pe.reloadCallback=Ke:Pe.status==="done"&&this.loadTile(he,ye)}}abortTile(he,ye){const Ae=he.uid;this.loading[Ae]&&delete this.loading[Ae],ye()}removeTile(he,ye){const Ae=this.loaded,He=he.uid;Ae&&Ae[He]&&delete Ae[He],ye()}}class hr{constructor(he){this.self=he,this.actor=new a.fv(he,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new a.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=a.cj({name:"mercator"}),this.workerSourceTypes={vector:V,geojson:Dr,"raster-dem":J,"raster-array":re,"batched-model":Hs},this.workerSources={},this.self.registerWorkerSource=(ye,Ae)=>{if(this.workerSourceTypes[ye])throw new Error(`Worker source with name "${ye}" already registered.`);this.workerSourceTypes[ye]=Ae},this.self.registerRTLTextPlugin=ye=>{if(a.fw.isParsed())throw new Error("RTL text plugin already registered.");a.fw.setState({pluginStatus:a.fx.parsed,pluginURL:a.fw.getPluginURL()}),a.fw.applyArabicShaping=ye.applyArabicShaping,a.fw.processBidirectionalText=ye.processBidirectionalText,a.fw.processStyledBidirectionalText=ye.processStyledBidirectionalText;for(const Ae of this.rtlPluginParsingListeners)Ae(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(he,ye,Ae){delete this.layerIndexes[he],delete this.availableImages[he],delete this.availableModels[he],delete this.workerSources[he],Ae()}checkIfReady(he,ye,Ae){Ae()}setReferrer(he,ye){this.referrer=ye}spriteLoaded(he,ye){this.isSpriteLoaded[he]||(this.isSpriteLoaded[he]={});const{scope:Ae,isLoaded:He}=ye;if(this.isSpriteLoaded[he][Ae]=He,this.workerSources[he]&&this.workerSources[he][Ae])for(const Pe in this.workerSources[he][Ae]){const Ke=this.workerSources[he][Ae][Pe];for(const wt in Ke){const et=Ke[wt];et instanceof V&&(et.isSpriteLoaded=He,et.fire(new a.A("isSpriteLoaded")))}}}setImages(he,ye,Ae){this.availableImages[he]||(this.availableImages[he]={});const{scope:He,images:Pe}=ye;if(this.availableImages[he][He]=Pe,this.workerSources[he]&&this.workerSources[he][He]){for(const Ke in this.workerSources[he][He]){const wt=this.workerSources[he][He][Ke];for(const et in wt)wt[et].availableImages=Pe}Ae()}else Ae()}setModels(he,{scope:ye,models:Ae},He){if(this.availableModels[he]||(this.availableModels[he]={}),this.availableModels[he][ye]=Ae,this.workerSources[he]&&this.workerSources[he][ye]){for(const Pe in this.workerSources[he][ye]){const Ke=this.workerSources[he][ye][Pe];for(const wt in Ke)Ke[wt].availableModels=Ae}He()}else He()}setProjection(he,ye){this.projections[he]=a.cj(ye)}setBrightness(he,ye,Ae){this.brightness=ye,Ae()}setWorldview(he,ye,Ae){this.worldview=ye,Ae()}setLayers(he,ye,Ae){this.getLayerIndex(he,ye.scope).replace(ye.layers,ye.options),Ae()}updateLayers(he,ye,Ae){this.getLayerIndex(he,ye.scope).update(ye.layers,ye.removedIds,ye.options),Ae()}loadTile(he,ye,Ae){ye.projection=this.projections[he]||this.defaultProjection,this.getWorkerSource(he,ye.type,ye.source,ye.scope).loadTile(ye,Ae)}decodeRasterArray(he,ye,Ae){this.getWorkerSource(he,ye.type,ye.source,ye.scope).decodeRasterArray(ye,Ae)}reloadTile(he,ye,Ae){ye.projection=this.projections[he]||this.defaultProjection,this.getWorkerSource(he,ye.type,ye.source,ye.scope).reloadTile(ye,Ae)}abortTile(he,ye,Ae){this.getWorkerSource(he,ye.type,ye.source,ye.scope).abortTile(ye,Ae)}removeTile(he,ye,Ae){this.getWorkerSource(he,ye.type,ye.source,ye.scope).removeTile(ye,Ae)}removeSource(he,ye,Ae){if(!(this.workerSources[he]&&this.workerSources[he][ye.scope]&&this.workerSources[he][ye.scope][ye.type]&&this.workerSources[he][ye.scope][ye.type][ye.source]))return;const He=this.workerSources[he][ye.scope][ye.type][ye.source];delete this.workerSources[he][ye.scope][ye.type][ye.source],He.removeSource!==void 0?He.removeSource(ye,Ae):Ae()}loadWorkerSource(he,ye,Ae){try{this.self.importScripts(ye.url),Ae()}catch(He){Ae(He.toString())}}syncRTLPluginState(he,ye,Ae){if(a.fw.isParsed())Ae(null,!0);else if(a.fw.isParsing())this.rtlPluginParsingListeners.push(Ae);else try{a.fw.setState(ye);const He=a.fw.getPluginURL();!a.fw.isLoaded()||a.fw.isParsed()||a.fw.isParsing()||He==null||(a.fw.setState({pluginStatus:a.fx.parsing,pluginURL:a.fw.getPluginURL()}),this.self.importScripts(He),a.fw.isParsed()?Ae(null,!0):this.rtlPluginParsingListeners.push(Ae))}catch(He){Ae(He.toString())}}setDracoUrl(he,ye){this.dracoUrl=ye}getAvailableImages(he,ye){this.availableImages[he]||(this.availableImages[he]={});let Ae=this.availableImages[he][ye];return Ae||(Ae=[]),Ae}getAvailableModels(he,ye){this.availableModels[he]||(this.availableModels[he]={});let Ae=this.availableModels[he][ye];return Ae||(Ae={}),Ae}getLayerIndex(he,ye){this.layerIndexes[he]||(this.layerIndexes[he]={});let Ae=this.layerIndexes[he][ye];return Ae||(Ae=this.layerIndexes[he][ye]=new P,Ae.scope=ye),Ae}getWorkerSource(he,ye,Ae,He){const Pe=this.workerSources;return Pe[he]||(Pe[he]={}),Pe[he][He]||(Pe[he][He]={}),Pe[he][He][ye]||(Pe[he][He][ye]={}),this.isSpriteLoaded[he]||(this.isSpriteLoaded[he]={}),Pe[he][He][ye][Ae]||(Pe[he][He][ye][Ae]=new this.workerSourceTypes[ye]({send:(Ke,wt,et,yt,Zt,zt)=>this.actor.send(Ke,wt,et,he,Zt,zt),scheduler:this.actor.scheduler},this.getLayerIndex(he,He),this.getAvailableImages(he,He),this.getAvailableModels(he,He),this.isSpriteLoaded[he][He],void 0,this.brightness,this.worldview)),Pe[he][He][ye][Ae]}rasterizeImagesWorker(he,ye,Ae){const He=new Map;for(const[Pe,{image:Ke,imageVariant:wt}]of ye.tasks.entries()){const et=this.imageRasterizer.rasterize(wt,Ke,ye.scope,he);He.set(Pe,et)}Ae(void 0,He)}removeRasterizedImages(he,ye,Ae){this.imageRasterizer.removeImagesFromCacheByIds(ye.imageIds,ye.scope,he),Ae()}enforceCacheSizeLimit(he,ye){a.fy(ye)}getWorkerPerformanceMetrics(he,ye,Ae){Ae(void 0,void 0)}}return a.fu(self)&&(self.worker=new hr(self)),hr})),d(["./shared"],(function(a){var w="3.14.0";const S={create:"create",load:"load",fullLoad:"fullLoad"},M={mark(g){performance.mark(g)},measure(g,o,u){performance.measure(g,o,u)}};function P(g){const o=g.name.split("?")[0];return a.a(o)&&o.includes("mapbox-gl.js")?"javascript":a.a(o)&&o.includes("mapbox-gl.css")?"css":a.b(o)?"fontRange":a.c(o)?"sprite":a.i(o)?"style":a.d(o)?"tilejson":"other"}var N,$={},G=(function(){if(N)return $;function g(y){return!o(y)}function o(y){return typeof window>"u"||typeof document>"u"?"not a browser":(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,C,I=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(I);try{C=new Worker(L),T=!0}catch{T=!1}return C&&C.terminate(),URL.revokeObjectURL(L),T})()?(function(){var T=document.createElement("canvas");T.width=T.height=1;var C=T.getContext("2d");if(!C)return!1;var I=C.getImageData(0,0,1,1);return I&&I.width===T.width})()?(u[b=y&&y.failIfMajorPerformanceCaveat]===void 0&&(u[b]=(function(T){var C,I=(function(L){var F=document.createElement("canvas"),U=Object.create(g.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=L,F.getContext("webgl2",U)})(T);if(!I)return!1;try{C=I.createShader(I.VERTEX_SHADER)}catch{return!1}return!(!C||I.isContextLost())&&(I.shaderSource(C,"void main() {}"),I.compileShader(C),I.getShaderParameter(C,I.COMPILE_STATUS)===!0)})(b)),u[b]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var b}N=1,$.supported=g,$.notSupportedReason=o;var u={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},$})();function q(g,o,u){const y=document.createElement(g);return o!=null&&(y.className=o),u&&u.appendChild(y),y}function V(g,o,u){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const b of Object.keys(o))y.setAttributeNS(null,b,String(o[b]));return u&&u.appendChild(y),y}const J=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ee=J&&J.userSelect!==void 0?"userSelect":"WebkitUserSelect";let re;function fe(){J&&ee&&(re=J[ee],J[ee]="none")}function ne(){J&&ee&&(J[ee]=re)}function ce(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",ce,!0)}function me(){window.addEventListener("click",ce,!0),window.setTimeout((()=>{window.removeEventListener("click",ce,!0)}),0)}function ve(g,o){const u=g.getBoundingClientRect();return ze(g,u,o)}function De(g,o){const u=g.getBoundingClientRect(),y=[];for(let b=0;b<o.length;b++)y.push(ze(g,u,o[b]));return y}function Ye(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function ze(g,o,u){const y=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new a.P((u.clientX-o.left)*y,(u.clientY-o.top)*y)}const tt="01",at="NO_ACCESS_TOKEN";class ct{constructor(o,u,y){this._transformRequestFn=o,this._customAccessToken=u,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const o=(function(){let u="";for(let y=0;y<10;y++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",tt,u].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}normalizeStyleURL(o,u){if(!a.j(o))return o;const y=Ie(o);return y.params.push(`sdk=js-${w}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeGlyphsURL(o,u){if(!a.j(o))return o;const y=Ie(o);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeModelURL(o,u){if(!a.j(o))return o;const y=Ie(o);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeSourceURL(o,u,y,b){if(!a.j(o))return o;const T=Ie(o);return T.path=`/v4/${T.authority}.json`,T.params.push("secure"),y&&T.params.push(`language=${y}`),b&&T.params.push(`worldview=${b}`),this._makeAPIURL(T,this._customAccessToken||u)}normalizeIconsetURL(o,u){const y=Ie(o);return a.j(o)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||u)):rt(y)}normalizeSpriteURL(o,u,y,b){const T=Ie(o);return a.j(o)?(T.path=`/styles/v1${T.path}/sprite${u}${y}`,this._makeAPIURL(T,this._customAccessToken||b)):(T.path+=`${u}${y}`,rt(T))}normalizeTileURL(o,u,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!a.j(o))return o;const b=Ie(o);b.path=b.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||y&&b.authority!=="raster"&&y===512?"@2x":""}${a.l.supported?".webp":"$1"}`),b.authority==="raster"?b.path=`/${a.e.RASTER_URL_PREFIX}${b.path}`:b.authority==="rasterarrays"?b.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${b.path}`:b.authority==="3dtiles"?b.path=`/${a.e.TILES3D_URL_PREFIX}${b.path}`:(b.path=b.path.replace(/^.+\/v4\//,"/"),b.path=`/${a.e.TILE_URL_VERSION}${b.path}`);const T=this._customAccessToken||(function(C){for(const I of C){const L=I.match(/^access_token=(.*)$/);if(L)return L[1]}return null})(b.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&b.params.push(`sku=${this._skuToken}`),this._makeAPIURL(b,T)}canonicalizeTileURL(o,u){const y=Ie(o);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return o;let b="mapbox://";y.path.match(/^\/raster\/v1\//)?b+=`raster/${y.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?b+=`rasterarrays/${y.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:b+=`tiles/${y.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let T=y.params;return u&&(T=T.filter((C=>!C.match(/^access_token=/)))),T.length&&(b+=`?${T.join("&")}`),b}canonicalizeTileset(o,u){const y=!!u&&a.j(u),b=[];for(const T of o.tiles||[])a.k(T)?b.push(this.canonicalizeTileURL(T,y)):b.push(T);return b}_makeAPIURL(o,u){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",b=Ie(a.e.API_URL);if(o.protocol=b.protocol,o.authority=b.authority,o.protocol==="http"){const T=o.params.indexOf("secure");T>=0&&o.params.splice(T,1)}if(b.path!=="/"&&(o.path=`${b.path}${o.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return rt(o);if(u=u||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return o.params=o.params.filter((T=>T.indexOf("access_token")===-1)),o.params.push(`access_token=${u||""}`),rt(o)}}const ht=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ie(g){const o=g.match(ht);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function rt(g){const o=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${o}`}const Qe="mapbox.eventData";function St(g){if(!g)return null;const o=g.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(a.m(o[1]))}catch{return null}}class qe{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const u=St(a.e.ACCESS_TOKEN);let y="";return y=u&&u.u?a.f(u.u):a.e.ACCESS_TOKEN||"",o?`${Qe}.${o}:${y}`:`${Qe}:${y}`}fetchEventData(){const o=a.s("localStorage"),u=this.getStorageKey(),y=this.getStorageKey("uuid");if(o)try{const b=localStorage.getItem(u);b&&(this.eventData=JSON.parse(b));const T=localStorage.getItem(y);T&&(this.anonId=T)}catch{a.w("Unable to read from LocalStorage")}}saveEventData(){const o=a.s("localStorage"),u=this.getStorageKey(),y=this.getStorageKey("uuid"),b=this.anonId;if(o&&b)try{localStorage.setItem(y,b),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{a.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,u,y,b){if(!a.e.EVENTS_URL)return;const T=Ie(a.e.EVENTS_URL);T.params.push(`access_token=${b||a.e.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(o).toISOString()},I=u?a.h(C,u):C,L={url:rt(T),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=a.p(L,(F=>{this.pendingRequest=null,y(F),this.saveEventData(),this.processRequests(b)}))}queueRequest(o,u){this.queue.push(o),this.processRequests(u)}}const vt=new class extends qe{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,o){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some((u=>a.j(u)||a.k(u)))&&this.queueRequest(Date.now(),o)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=St(a.e.ACCESS_TOKEN),u=o?o.u:a.e.ACCESS_TOKEN;let y=u!==this.eventData.tokenU;a.v(this.anonId)||(this.anonId=a.u(),y=!0);const b=this.queue.shift();if(this.eventData.lastSuccess){const T=new Date(this.eventData.lastSuccess),C=new Date(b),I=(b-this.eventData.lastSuccess)/864e5;y=y||I>=1||I<-1||T.getDate()!==C.getDate()}else y=!0;y?this.postEvent(b,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:tt,"enabled.telemetry":!1,userId:this.anonId},(T=>{T||(this.eventData.lastSuccess=b,this.eventData.tokenU=u)}),g):this.processRequests()}},nt=vt.postTurnstileEvent.bind(vt),gt=new class extends qe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,o,u,y){this.skuToken=o,this.errorCb=y,a.e.EVENTS_URL&&(u||a.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},u):this.errorCb(new Error(at)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:u}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),a.v(this.anonId)||(this.anonId=a.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:w,skuId:tt,skuToken:this.skuToken,userId:this.anonId},(y=>{y?this.errorCb(y):o&&(this.success[o]=!0)}),g))}remove(){this.errorCb=null}},Ut=gt.postMapLoadEvent.bind(gt),$t=new class extends qe{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let o=this.mapInstanceIdMap.get(g);return o||(o=a.u(),this.mapInstanceIdMap.set(g,o)),o}getEventId(g){const o=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,o+1),o}postStyleLoadEvent(g,o){const{map:u,style:y,importedStyles:b}=o;if(!a.e.EVENTS_URL||!g&&!a.e.ACCESS_TOKEN)return;const T=this.getMapInstanceId(u),C={mapInstanceId:T,eventId:this.getEventId(T),style:y};b.length&&(C.importedStyles=b),this.queueRequest({timestamp:Date.now(),payload:C},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:u}=this.queue.shift();this.postEvent(o,u,(()=>{}),g)}},qt=$t.postStyleLoadEvent.bind($t),Ht=new class extends qe{constructor(){super("gljs.performance")}postPerformanceEvent(g,o){a.e.EVENTS_URL&&(g||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:u}=this.queue.shift(),y=(function(b){const T=performance.getEntriesByType("resource"),C=performance.getEntriesByType("mark"),I=(function(Q){const le={};if(Q){for(const oe in Q)if(oe!=="other")for(const ue of Q[oe]){const de=`${oe}ResolveRangeMin`,xe=`${oe}ResolveRangeMax`,Te=`${oe}RequestCount`,Me=`${oe}RequestCachedCount`;le[de]=Math.min(le[de]||1/0,ue.startTime),le[xe]=Math.max(le[xe]||-1/0,ue.responseEnd);const ke=Fe=>{le[Fe]===void 0&&(le[Fe]=0),++le[Fe]};ue.transferSize!==void 0&&ue.transferSize===0&&ke(Me),ke(Te)}}return le})((function(Q,le){const oe={};if(Q)for(const ue of Q){const de=le(ue);oe[de]===void 0&&(oe[de]=[]),oe[de].push(ue)}return oe})(T,P)),L=window.devicePixelRatio,F=navigator.connection||navigator.mozConnection||navigator.webkitConnection,U=F?F.effectiveType:void 0,Y={counters:[],metadata:[],attributes:[]},W=(Q,le,oe)=>{oe!=null&&Q.push({name:le,value:oe.toString()})};for(const Q in I)W(Y.counters,Q,I[Q]);if(b.interactionRange[0]!==1/0&&b.interactionRange[1]!==-1/0&&(W(Y.counters,"interactionRangeMin",b.interactionRange[0]),W(Y.counters,"interactionRangeMax",b.interactionRange[1])),C)for(const Q of Object.keys(S)){const le=S[Q],oe=C.find((ue=>ue.name===le));oe&&W(Y.counters,le,oe.startTime)}return W(Y.counters,"visibilityHidden",b.visibilityHidden),W(Y.attributes,"style",(function(Q){if(Q)for(const le of Q){const oe=le.name.split("?")[0];if(a.i(oe)){const ue=oe.split("/").slice(-2);if(ue.length===2)return`mapbox://styles/${ue[0]}/${ue[1]}`}}})(T)),W(Y.attributes,"terrainEnabled",b.terrainEnabled?"true":"false"),W(Y.attributes,"fogEnabled",b.fogEnabled?"true":"false"),W(Y.attributes,"projection",b.projection),W(Y.attributes,"zoom",b.zoom),W(Y.metadata,"devicePixelRatio",L),W(Y.metadata,"connectionEffectiveType",U),W(Y.metadata,"navigatorUserAgent",navigator.userAgent),W(Y.metadata,"screenWidth",window.screen.width),W(Y.metadata,"screenHeight",window.screen.height),W(Y.metadata,"windowWidth",window.innerWidth),W(Y.metadata,"windowHeight",window.innerHeight),W(Y.metadata,"mapWidth",b.width/L),W(Y.metadata,"mapHeight",b.height/L),W(Y.metadata,"webglRenderer",b.renderer),W(Y.metadata,"webglVendor",b.vendor),W(Y.metadata,"sdkVersion",w),W(Y.metadata,"sdkIdentifier","mapbox-gl-js"),Y})(u);for(const b of y.metadata);for(const b of y.counters);for(const b of y.attributes);this.postEvent(o,y,(()=>{}),g)}},mn=Ht.postPerformanceEvent.bind(Ht),en=new class extends qe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,o,u,y){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const b=Ie(a.e.API_URL+a.e.SESSION_PATH);b.params.push(`sku=${o||""}`),b.params.push(`access_token=${y||a.e.ACCESS_TOKEN||""}`);const T={url:rt(b),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(T,(C=>{this.pendingRequest=null,u(C),this.saveEventData(),this.processRequests(y)}))}getSessionAPI(g,o,u,y){this.skuToken=o,this.errorCb=y,a.e.SESSION_PATH&&a.e.API_URL&&(u||a.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},u):this.errorCb(new Error(at)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:u}=this.queue.shift();o&&this.success[o]||this.getSession(u,this.skuToken,(y=>{y?this.errorCb(y):o&&(this.success[o]=!0)}),g)}remove(){this.errorCb=null}},En=en.getSessionAPI.bind(en),Xn=new Set;function cn(g,o){o?Xn.add(g):Xn.delete(g)}class Jr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,u){this._updatedSourceCaches[o]=u,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const u=o.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(o.id),this.setDirty()}removeLayer(o){const u=o.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][o.id]=o,this._updatedLayers[u].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const u in this._updatedLayers)o[u]=o[u]||{},o[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)o[u]=o[u]||{},o[u].removedIds=Object.keys(this._removedLayers[u]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(o){return this._updatedImages[o]?Array.from(this._updatedImages[o].values()):[]}updateImage(o,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(a.I.toString(o)),this.setDirty()}resetUpdatedImages(o){this._updatedImages[o]&&this._updatedImages[o].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function mr(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class Cr extends a.E{constructor(o){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=o,o!=="raster"&&a.t()&&(this.imageRasterizerDispatcher=new a.D(a.x(),this,"Image Rasterizer Worker",1))}addScope(o){this.loaded.set(o,!1),this.imageProviders.set(o,new Map),this.images.set(o,new Map),this.updatedImages.set(o,new Set),this.callbackDispatchedThisFrame.set(o,new Set),this.patterns.set(o,new Map),this.atlasImage.set(o,new a.r({width:1,height:1}))}removeScope(o){this.loaded.delete(o),this.imageProviders.delete(o),this.images.delete(o),this.updatedImages.delete(o),this.callbackDispatchedThisFrame.delete(o),this.patterns.delete(o),this.atlasImage.delete(o);const u=this.atlasTexture.get(o);u&&(u.destroy(),this.atlasTexture.delete(o))}addImageProvider(o,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(o.id,o)}removeImageProvider(o,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(o)}getPendingImageProviders(){const o=[];for(const u of this.imageProviders.values())for(const y of u.values())y.hasPendingRequests()&&o.push(y);return o}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new a.y),this._imageRasterizer}isLoaded(){for(const o of this.loaded.keys())if(!this.loaded.get(o))return!1;return!0}setLoaded(o,u){if(this.loaded.get(u)!==o&&(this.loaded.set(u,o),o)){for(const{ids:y,callback:b}of this.requestors)this._notify(y,u,b);this.requestors=[]}}hasImage(o,u){return!!this.getImage(o,u)}getImage(o,u){return this.images.get(u).get(o.toString())}addImage(o,u,y){this._validate(o,y)&&this.images.get(u).set(o.toString(),y)}_validate(o,u){let y=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.z(new Error(`Image "${o.name}" has invalid "stretchX" value`))),y=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.z(new Error(`Image "${o.name}" has invalid "stretchY" value`))),y=!1),this._validateContent(u.content,u)||(this.fire(new a.z(new Error(`Image "${o.name}" has invalid "content" value`))),y=!1),y}_validateStretch(o,u){if(!o)return!0;let y=0;for(const b of o){if(b[0]<y||b[1]<b[0]||u<b[1])return!1;y=b[1]}return!0}_validateContent(o,u){return o?o.length!==4||!u.usvg&&(o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,u,y){const b=this.images.get(u).get(o.toString());y.version=b.version+1,this.images.get(u).set(o.toString(),y),this.updatedImages.get(u).add(o),this.removeFromImageRasterizerCache(o,u)}clearUpdatedImages(o){this.updatedImages.get(o).clear()}removeFromImageRasterizerCache(o,u){this.spriteFormat!=="raster"&&(a.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([o],u))}removeImage(o,u){const y=this.images.get(u),b=y.get(o.toString());y.delete(o.toString()),this.patterns.get(u).delete(o.toString()),this.removeFromImageRasterizerCache(o,u),b.userImage&&b.userImage.onRemove&&b.userImage.onRemove()}listImages(o){return Array.from(this.images.get(o).keys()).map((u=>a.I.from(u)))}getImages(o,u,y){const b=[],T=[],C=this.imageProviders.get(u);for(const U of o){if(!U.iconsetId){b.push(U);continue}const Y=C.get(U.iconsetId);Y&&(this.getImage(U,u)?T.push(U):Y.addPendingRequest(U))}if(b.length===0)return void this._notify(T,u,y);let I=!0;const L=!!this.loaded.get(u),F=this.images.get(u);if(!L)for(const U of b)F.has(U.toString())||(I=!1);L||I?this._notify(b,u,y):this.requestors.push({ids:b,scope:u,callback:y})}rasterizeImages(o,u){const y=new Map,{tasks:b,scope:T}=o;for(const[C,I]of b.entries()){const L=this.getImage(I.id,T);L&&y.set(C,{image:L,imageVariant:I})}this._rasterizeImages(T,y,u)}_rasterizeImages(o,u,y){if(a.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:o},y);else{const b=new Map;for(const[T,{image:C,imageVariant:I}]of u.entries())b.set(T,this.imageRasterizer.rasterize(I,C,o,0));y(void 0,b)}}getUpdatedImages(o){return this.updatedImages.get(o)||new Set}_notify(o,u,y){const b=this.images.get(u),T=new Map;for(const C of o){if(!b.get(C.toString())){if(C.iconsetId)continue;this.fire(new a.A("styleimagemissing",{id:C.name}))}const I=b.get(C.toString());if(!I){a.w(`Image "${C.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const L={data:I.usvg?null:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,usvg:I.usvg,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:!!(I.userImage&&I.userImage.render)};I.usvg&&Object.assign(L,{width:I.icon.usvg_tree.width,height:I.icon.usvg_tree.height}),T.set(a.I.toString(C),L)}y(null,T)}getPixelSize(o){const{width:u,height:y}=this.atlasImage.get(o);return{width:u,height:y}}getPattern(o,u,y){const b=o.toString(),T=this.patterns.get(u),C=T.get(b),I=this.getImage(o,u);if(!I)return null;if(C){if(C.position.version===I.version)return C.position;C.position.version=I.version}else{if(I.usvg&&!I.data){const L=this.getPatternInFlightId(b,u);if(this.patternsInFlight.has(L))return null;this.patternsInFlight.add(L);const F=new a.B(o).scaleSelf(a.q.devicePixelRatio),U=new Map([[F.toString(),{image:I,imageVariant:F}]]);return this._rasterizeImages(u,U,((Y,W)=>this.storePatternImage(F,u,I,y,W))),null}this.storePattern(o,u,I)}return this._updatePatternAtlas(u,y),T.get(b).position}getPatternInFlightId(o,u){return a.C(o,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(o,u,y,b,T){const C=o.toString(),I=T?T.get(C):void 0;I&&(y.data=I,this.storePattern(o.id,u,y),this._updatePatternAtlas(u,b),this.patternsInFlight.delete(this.getPatternInFlightId(o.id.toString(),u)))}storePattern(o,u,y){const b={w:y.data.width+2*a.F,h:y.data.height+2*a.F,x:0,y:0},T=new a.G(b,y,a.F);this.patterns.get(u).set(o.toString(),{bin:b,position:T})}destroyAtlasTextures(){for(const o of this.atlasTexture.values())o&&o.destroy();this.atlasTexture.clear()}bind(o,u){const y=o.gl;let b=this.atlasTexture.get(u);b?this.dirty&&(b.update(this.atlasImage.get(u)),this.dirty=!1):(b=new a.T(o,this.atlasImage.get(u),y.RGBA8),this.atlasTexture.set(u,b)),b.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(o,u){const y=this.patterns.get(o),b=Array.from(y.values()).map((({bin:F})=>F)),{w:T,h:C}=a.H(b),I=this.atlasImage.get(o);I.resize({width:T||1,height:C||1});const L=this.images.get(o);for(const[F,{bin:U,position:Y}]of y.entries()){let W=Y.padding;const Q=U.x+W,le=U.y+W,oe=L.get(F).data,ue=oe.width,de=oe.height;W=W>1?W-1:W,a.r.copy(oe,I,{x:0,y:0},{x:Q,y:le},{width:ue,height:de},u),a.r.copy(oe,I,{x:0,y:de-W},{x:Q,y:le-W},{width:ue,height:W},u),a.r.copy(oe,I,{x:0,y:0},{x:Q,y:le+de},{width:ue,height:W},u),a.r.copy(oe,I,{x:ue-W,y:0},{x:Q-W,y:le},{width:W,height:de},u),a.r.copy(oe,I,{x:0,y:0},{x:Q+ue,y:le},{width:W,height:de},u),a.r.copy(oe,I,{x:ue-W,y:de-W},{x:Q-W,y:le-W},{width:W,height:W},u),a.r.copy(oe,I,{x:0,y:de-W},{x:Q+ue,y:le-W},{width:W,height:W},u),a.r.copy(oe,I,{x:0,y:0},{x:Q+ue,y:le+de},{width:W,height:W},u),a.r.copy(oe,I,{x:ue-W,y:0},{x:Q-W,y:le+de},{width:W,height:W},u)}this.dirty=!0}beginFrame(){for(const o of this.images.keys())this.callbackDispatchedThisFrame.set(o,new Set)}dispatchRenderCallbacks(o,u){const y=this.images.get(u);for(const b of o){if(this.callbackDispatchedThisFrame.get(u).has(b.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(b.toString());const T=y.get(b.toString());mr(T)&&this.updateImage(b,u,T)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function li(g){const o=g.key,u=g.value,y=g.valueSpec||{},b=g.objectElementValidators||{},T=g.style,C=g.styleSpec;let I=[];const L=a.J(u);if(L!=="object")return[new a.V(o,u,`object expected, ${L} found`)];for(const F in u){const U=F.split(".")[0];let Y;b[U]?Y=b[U]:y[U]?Y=ir:b["*"]?Y=b["*"]:y["*"]&&(Y=ir),Y?I=I.concat(Y({key:(o&&`${o}.`)+F,value:u[F],valueSpec:y[U]||y["*"],style:T,styleSpec:C,object:u,objectKey:F},u)):I.push(new a.K(o,u[F],`unknown property "${F}"`))}for(const F in y)b[F]||y[F].required&&y[F].default===void 0&&u[F]===void 0&&I.push(new a.V(o,u,`missing required property "${F}"`));return I}function hi(g){const o=g.value,u=g.valueSpec,y=g.style,b=g.styleSpec,T=g.key,C=g.arrayElementValidator||ir;if(a.J(o)!=="array")return[new a.V(T,o,`array expected, ${a.J(o)} found`)];if(u.length&&o.length!==u.length)return[new a.V(T,o,`array length ${u.length} expected, length ${o.length} found`)];if(u["min-length"]&&o.length<u["min-length"])return[new a.V(T,o,`array length at least ${u["min-length"]} expected, length ${o.length} found`)];let I={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};b.$version<7&&(I.function=u.function),a.J(u.value)==="object"&&(I=u.value);let L=[];for(let F=0;F<o.length;F++)L=L.concat(C({array:o,arrayIndex:F,value:o[F],valueSpec:I,style:y,styleSpec:b,key:`${T}[${F}]`},!0));return L}function so(g){const o=g.key,u=g.value,y=g.valueSpec;let b=a.J(u);if(b==="number"&&u!=u&&(b="NaN"),b!=="number")return[new a.V(o,u,`number expected, ${b} found`)];if("minimum"in y){let T=y.minimum;if(a.J(y.minimum)==="array"&&(T=y.minimum[g.arrayIndex]),u<T)return[new a.V(o,u,`${u} is less than the minimum value ${T}`)]}if("maximum"in y){let T=y.maximum;if(a.J(y.maximum)==="array"&&(T=y.maximum[g.arrayIndex]),u>T)return[new a.V(o,u,`${u} is greater than the maximum value ${T}`)]}return[]}function ra(g){const o=g.valueSpec,u=a.M(g.value.type);let y,b,T,C={};const I=u!=="categorical"&&g.value.property===void 0,L=!I,F=a.J(g.value.stops)==="array"&&a.J(g.value.stops[0])==="array"&&a.J(g.value.stops[0][0])==="object",U=li({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(Q){if(u==="identity")return[new a.V(Q.key,Q.value,'identity function may not have a "stops" property')];let le=[];const oe=Q.value;return le=le.concat(hi({key:Q.key,value:oe,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:Y})),a.J(oe)==="array"&&oe.length===0&&le.push(new a.V(Q.key,oe,"array must have at least one stop")),le},default:function(Q){return ir({key:Q.key,value:Q.value,valueSpec:o,style:Q.style,styleSpec:Q.styleSpec})}}});return u==="identity"&&I&&U.push(new a.V(g.key,g.value,'missing required property "property"')),u==="identity"||g.value.stops||U.push(new a.V(g.key,g.value,'missing required property "stops"')),u==="exponential"&&g.valueSpec.expression&&!a.N(g.valueSpec)&&U.push(new a.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(L&&!a.O(g.valueSpec)?U.push(new a.V(g.key,g.value,"property functions not supported")):I&&!a.Q(g.valueSpec)&&U.push(new a.V(g.key,g.value,"zoom functions not supported"))),u!=="categorical"&&!F||g.value.property!==void 0||U.push(new a.V(g.key,g.value,'"property" property is required')),U;function Y(Q){let le=[];const oe=Q.value,ue=Q.key;if(a.J(oe)!=="array")return[new a.V(ue,oe,`array expected, ${a.J(oe)} found`)];if(oe.length!==2)return[new a.V(ue,oe,`array length 2 expected, length ${oe.length} found`)];if(F){if(a.J(oe[0])!=="object")return[new a.V(ue,oe,`object expected, ${a.J(oe[0])} found`)];if(oe[0].zoom===void 0)return[new a.V(ue,oe,"object stop key must have zoom")];if(oe[0].value===void 0)return[new a.V(ue,oe,"object stop key must have value")];const de=a.M(oe[0].zoom);if(typeof de!="number")return[new a.V(ue,oe[0].zoom,"stop zoom values must be numbers")];if(T&&T>de)return[new a.V(ue,oe[0].zoom,"stop zoom values must appear in ascending order")];de!==T&&(T=de,b=void 0,C={}),le=le.concat(li({key:`${ue}[0]`,value:oe[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:so,value:W}}))}else le=le.concat(W({key:`${ue}[0]`,value:oe[0],style:Q.style,styleSpec:Q.styleSpec},oe));return a.S(a.U(oe[1]))?le.concat([new a.V(`${ue}[1]`,oe[1],"expressions are not allowed in function stops.")]):le.concat(ir({key:`${ue}[1]`,value:oe[1],valueSpec:o,style:Q.style,styleSpec:Q.styleSpec}))}function W(Q,le){const oe=a.J(Q.value),ue=a.M(Q.value),de=Q.value!==null?Q.value:le;if(y){if(oe!==y)return[new a.V(Q.key,de,`${oe} stop domain type must match previous stop domain type ${y}`)]}else y=oe;if(oe!=="number"&&oe!=="string"&&oe!=="boolean"&&typeof ue!="number"&&typeof ue!="string"&&typeof ue!="boolean")return[new a.V(Q.key,de,"stop domain value must be a number, string, or boolean")];if(oe!=="number"&&u!=="categorical"){let xe=`number expected, ${oe} found`;return a.O(o)&&u===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(Q.key,de,xe)]}return u!=="categorical"||oe!=="number"||typeof ue=="number"&&isFinite(ue)&&Math.floor(ue)===ue?u!=="categorical"&&oe==="number"&&typeof ue=="number"&&typeof b=="number"&&b!==void 0&&ue<b?[new a.V(Q.key,de,"stop domain values must appear in ascending order")]:(b=ue,u==="categorical"&&ue in C?[new a.V(Q.key,de,"stop domain values must be unique")]:(C[ue]=!0,[])):[new a.V(Q.key,de,`integer expected, found ${String(ue)}`)]}}function xt(g){const o=(g.expressionContext==="property"?a.W:a.X)(a.U(g.value),g.valueSpec);if(o.result==="error")return o.value.map((y=>new a.V(`${g.key}${y.key}`,g.value,y.message)));const u=o.value.expression||o.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!u.outputDefined())return[new a.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!a.Y(u))return[new a.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return Bt(u,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!a.Z(u,["zoom","feature-state"]))return[new a.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!a._(u))return[new a.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bt(g,o){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const b of o.valueSpec.expression.parameters)u.delete(b);if(u.size===0)return[];const y=[];return g instanceof a.$&&u.has(g.name)?[new a.V(o.key,o.value,`["${g.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(g.eachChild((b=>{y.push(...Bt(b,o))})),y)}function tn(g){const o=g.key,u=g.value,y=g.valueSpec,b=[];return Array.isArray(y.values)?y.values.indexOf(a.M(u))===-1&&b.push(new a.V(o,u,`expected one of [${y.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(y.values).indexOf(a.M(u))===-1&&b.push(new a.V(o,u,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(u)} found`)),b}function $n(g){return a.a1(a.U(g.value))?xt(a.L({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):qn(g)}function qn(g){const o=g.value,u=g.key;if(a.J(o)!=="array")return[new a.V(u,o,`array expected, ${a.J(o)} found`)];const y=g.styleSpec;let b,T=[];if(o.length<1)return[new a.V(u,o,"filter array must have at least 1 element")];switch(T=T.concat(tn({key:`${u}[0]`,value:o[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),a.M(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&a.M(o[1])==="$type"&&T.push(new a.V(u,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&T.push(new a.V(u,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(b=a.J(o[1]),b!=="string"&&T.push(new a.V(`${u}[1]`,o[1],`string expected, ${b} found`)));for(let C=2;C<o.length;C++)b=a.J(o[C]),a.M(o[1])==="$type"?T=T.concat(tn({key:`${u}[${C}]`,value:o[C],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&T.push(new a.V(`${u}[${C}]`,o[C],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let C=1;C<o.length;C++)T=T.concat(qn({key:`${u}[${C}]`,value:o[C],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":b=a.J(o[1]),o.length!==2?T.push(new a.V(u,o,`filter array for "${o[0]}" operator must have 2 elements`)):b!=="string"&&T.push(new a.V(`${u}[1]`,o[1],`string expected, ${b} found`))}return T}function An(g,o){const u=g.key,y=g.style,b=g.layer,T=g.styleSpec,C=g.value,I=g.objectKey,L=T[`${o}_${g.layerType}`];if(!L)return[];const F=I.match(/^(.*)-use-theme$/);if(o==="paint"&&F&&L[F[1]])return a.S(C)?[].concat(ir({key:g.key,value:C,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:T,expressionContext:"property",propertyType:o,propertyKey:I})):ir({key:u,value:C,valueSpec:{type:"string"},style:y,styleSpec:T});const U=I.match(/^(.*)-transition$/);if(o==="paint"&&U&&L[U[1]]&&L[U[1]].transition)return ir({key:u,value:C,valueSpec:T.transition,style:y,styleSpec:T});const Y=g.valueSpec||L[I];if(!Y)return[new a.K(u,C,`unknown property "${I}"`)];let W;if(a.J(C)==="string"&&a.O(Y)&&!Y.tokens&&(W=/^{([^}]+)}$/.exec(C))){const le=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new a.V(u,C,`"${I}" does not support interpolation syntax
Use an identity property function instead: ${le}.`)]}const Q=[];if(g.layerType==="symbol")I!=="text-field"||!y||y.glyphs||y.imports||Q.push(new a.V(u,C,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&a.a2(a.U(C))&&a.M(C.type)==="identity"&&Q.push(new a.V(u,C,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&o==="paint"&&b&&b.layout&&b.layout.hasOwnProperty("model-id")&&a.O(Y)&&(a.a3(Y)||a.Q(Y))){const le=a.W(a.U(C),Y),oe=le.value.expression||le.value._styleExpression.expression;oe&&!a.Z(oe,["measure-light"])&&(I==="model-emissive-strength"&&a._(oe)&&a.Y(oe)||Q.push(new a.V(u,C,`${I} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Q.concat(ir({key:g.key,value:C,valueSpec:Y,style:y,styleSpec:T,expressionContext:"property",propertyType:o,propertyKey:I}))}function tr(g){return An(g,"paint")}function Ir(g){return An(g,"layout")}function mi(g){let o=[];const u=g.value,y=g.key,b=g.style,T=g.styleSpec;u.type||u.ref||o.push(new a.V(y,u,'either "type" or "ref" is required'));let C=a.M(u.type);const I=a.M(u.ref);if(u.id){const L=a.M(u.id);for(let F=0;F<g.arrayIndex;F++){const U=b.layers[F];a.M(U.id)===L&&o.push(new a.V(y,u.id,`duplicate layer id "${u.id}", previously used at line ${U.id.__line__}`))}}if("ref"in u){let L;["type","source","source-layer","filter","layout"].forEach((F=>{F in u&&o.push(new a.V(y,u[F],`"${F}" is prohibited for ref layers`))})),b.layers.forEach((F=>{a.M(F.id)===I&&(L=F)})),L?L.ref?o.push(new a.V(y,u.ref,"ref cannot reference another ref layer")):C=a.M(L.type):typeof I=="string"&&o.push(new a.V(y,u.ref,`ref layer "${I}" not found`))}else if(C!=="background"&&C!=="sky"&&C!=="slot")if(u.source){const L=b.sources&&b.sources[u.source],F=L&&a.M(L.type);L?F==="vector"&&C==="raster"?o.push(new a.V(y,u.source,`layer "${u.id}" requires a raster source`)):F==="raster"&&C!=="raster"?o.push(new a.V(y,u.source,`layer "${u.id}" requires a vector source`)):F!=="vector"||u["source-layer"]?F==="raster-dem"&&C!=="hillshade"?o.push(new a.V(y,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="raster-array"||["raster","raster-particle"].includes(C)?C==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&F==="geojson"&&!L.lineMetrics?o.push(new a.V(y,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):C==="raster-particle"&&F!=="raster-array"&&o.push(new a.V(y,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):o.push(new a.V(y,u.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new a.V(y,u,`layer "${u.id}" must specify a "source-layer"`)):o.push(new a.V(y,u.source,`source "${u.source}" not found`))}else o.push(new a.V(y,u,'missing required property "source"'));return o=o.concat(li({key:y,value:u,valueSpec:T.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ir({key:`${y}.type`,value:u.type,valueSpec:T.layer.type,style:g.style,styleSpec:g.styleSpec,object:u,objectKey:"type"}),filter:L=>$n(a.L({layerType:C},L)),layout:L=>li({layer:u,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":F=>Ir(a.L({layerType:C},F))}}),paint:L=>li({layer:u,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":F=>tr(a.L({layerType:C,layer:u},F))}})}})),o}function Mi(g){const o=g.value,u=g.key,y=a.J(o);return y!=="string"?[new a.V(u,o,`string expected, ${y} found`)]:[]}const _o={promoteId:function g({key:o,value:u}){if(a.J(u)==="string")return Mi({key:o,value:u});if(Array.isArray(u)){const y=[],b=a.U(u),T=a.X(b);return T.result==="error"&&T.value.forEach((C=>{y.push(new a.V(`${o}${C.key}`,null,`${C.message}`))})),a.Z(T.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new a.V(`${o}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const b in u)y.push(...g({key:`${o}.${b}`,value:u[b]}));return y}}};function oa(g){const o=g.value,u=g.key,y=g.styleSpec,b=g.style;if(!o.type)return[new a.V(u,o,'"type" is required')];const T=a.M(o.type);let C=[];switch(["vector","raster","raster-dem","raster-array"].includes(T)&&(o.url||o.tiles||C.push(new a.K(u,o,'Either "url" or "tiles" is required.'))),T){case"vector":case"raster":case"raster-dem":case"raster-array":return C=C.concat(li({key:u,value:o,valueSpec:y[`source_${T.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:_o})),C;case"geojson":if(C=li({key:u,value:o,valueSpec:y.source_geojson,style:b,styleSpec:y,objectElementValidators:_o}),o.cluster)for(const I in o.clusterProperties){const[L,F]=o.clusterProperties[I],U=typeof L=="string"?[L,["accumulated"],["get",I]]:L;C.push(...xt({key:`${u}.${I}.map`,value:F,expressionContext:"cluster-map"})),C.push(...xt({key:`${u}.${I}.reduce`,value:U,expressionContext:"cluster-reduce"}))}return C;case"video":return li({key:u,value:o,valueSpec:y.source_video,style:b,styleSpec:y});case"image":return li({key:u,value:o,valueSpec:y.source_image,style:b,styleSpec:y});case"canvas":return[new a.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tn({key:`${u}.type`,value:o.type,valueSpec:{values:Ua(y)}})}}function Ua(g){return g.source.reduce(((o,u)=>{const y=g[u];return y.type.type==="enum"&&(o=o.concat(Object.keys(y.type.values))),o}),[])}function lo(g){const o=g.value,u=g.styleSpec,y=u.light,b=g.style;let T=[];const C=a.J(o);if(o===void 0)return T;if(C!=="object")return T=T.concat([new a.V("light",o,`object expected, ${C} found`)]),T;for(const I in o){const L=I.match(/^(.*)-transition$/),F=I.match(/^(.*)-use-theme$/);T=T.concat(F&&y[F[1]]?ir({key:I,value:o[I],valueSpec:{type:"string"},style:b,styleSpec:u}):L&&y[L[1]]&&y[L[1]].transition?ir({key:I,value:o[I],valueSpec:u.transition,style:b,styleSpec:u}):y[I]?ir({key:I,value:o[I],valueSpec:y[I],style:b,styleSpec:u}):[new a.V(I,o[I],`unknown property "${I}"`)])}return T}function eo(g){const o=g.value;let u=[];if(!o)return u;const y=a.J(o);if(y!=="object")return u=u.concat([new a.V("light-3d",o,`object expected, ${y} found`)]),u;const b=g.styleSpec,T=b["light-3d"],C=g.key,I=g.style,L=g.style.lights;for(const Y of["type","id"])if(!(Y in o))return u=u.concat([new a.V("light-3d",o,`missing property ${Y} on light`)]),u;if(o.type&&L)for(let Y=0;Y<g.arrayIndex;Y++){const W=a.M(o.type),Q=L[Y];a.M(Q.type)===W&&u.push(new a.V(C,o.id,`duplicate light type "${o.type}", previously defined at line ${Q.id.__line__}`))}const F=`properties_light_${o.type}`;if(!(F in b))return u=u.concat([new a.V("light-3d",o,`Invalid light type ${o.type}`)]),u;const U=b[F];for(const Y in o)if(Y==="properties"){const W=o[Y],Q=a.J(W);if(Q!=="object")return u=u.concat([new a.V("properties",W,`object expected, ${Q} found`)]),u;for(const le in W){const oe=le.match(/^(.*)-transition$/),ue=le.match(/^(.*)-use-theme$/);u=u.concat(ue&&U[ue[1]]?ir({key:Y,value:W[le],valueSpec:{type:"string"},style:I,styleSpec:b}):oe&&U[oe[1]]&&U[oe[1]].transition?ir({key:Y,value:o[Y],valueSpec:b.transition,style:I,styleSpec:b}):U[le]?ir({key:le,value:W[le],valueSpec:U[le],style:I,styleSpec:b}):[new a.K(g.key,W[le],`unknown property "${le}"`)])}}else u=u.concat(T[Y]?ir({key:Y,value:o[Y],valueSpec:T[Y],style:I,styleSpec:b}):[new a.K(Y,o[Y],`unknown property "${Y}"`)]);return u}function co(g){const o=g.value,u=g.key,y=g.style,b=g.styleSpec,T=b.terrain;let C=[];const I=a.J(o);if(o===void 0||I==="null")return C;if(I!=="object")return C=C.concat([new a.V("terrain",o,`object expected, ${I} found`)]),C;for(const L in o){const F=L.match(/^(.*)-transition$/),U=L.match(/^(.*)-use-theme$/);C=C.concat(U&&T[U[1]]?ir({key:L,value:o[L],valueSpec:{type:"string"},style:y,styleSpec:b}):F&&T[F[1]]&&T[F[1]].transition?ir({key:L,value:o[L],valueSpec:b.transition,style:y,styleSpec:b}):T[L]?ir({key:L,value:o[L],valueSpec:T[L],style:y,styleSpec:b}):[new a.K(L,o[L],`unknown property "${L}"`)])}if(o.source){const L=y.sources&&y.sources[o.source],F=L&&a.M(L.type);L?F!=="raster-dem"&&C.push(new a.V(u,o.source,`terrain cannot be used with a source of type ${String(F)}, it only be used with a "raster-dem" source type`)):C.push(new a.V(u,o.source,`source "${o.source}" not found`))}else C.push(new a.V(u,o,'terrain is missing required property "source"'));return C}function vo(g){const o=g.value,u=g.style,y=g.styleSpec,b=y.fog;let T=[];const C=a.J(o);if(o===void 0)return T;if(C!=="object")return T=T.concat([new a.V("fog",o,`object expected, ${C} found`)]),T;for(const I in o){const L=I.match(/^(.*)-transition$/),F=I.match(/^(.*)-use-theme$/);T=T.concat(F&&b[F[1]]?ir({key:I,value:o[I],valueSpec:{type:"string"},style:u,styleSpec:y}):L&&b[L[1]]&&b[L[1]].transition?ir({key:I,value:o[I],valueSpec:y.transition,style:u,styleSpec:y}):b[I]?ir({key:I,value:o[I],valueSpec:b[I],style:u,styleSpec:y}):[new a.K(I,o[I],`unknown property "${I}"`)])}return T}const ss={"*":()=>[],array:hi,boolean:function(g){const o=g.value,u=g.key,y=a.J(o);return y!=="boolean"?[new a.V(u,o,`boolean expected, ${y} found`)]:[]},number:so,color:function(g){const o=g.key,u=g.value,y=a.J(u);return y!=="string"?[new a.V(o,u,`color expected, ${y} found`)]:a.a0.parseCSSColor(u)===null?[new a.V(o,u,`color expected, "${u}" found`)]:[]},enum:tn,filter:$n,function:ra,layer:mi,object:li,source:oa,model:a.a4,light:lo,"light-3d":eo,terrain:co,fog:vo,string:Mi,formatted:function(g){return Mi(g).length===0?[]:xt(g)},resolvedImage:function(g){return Mi(g).length===0?[]:xt(g)},projection:function(g){const o=g.value,u=g.styleSpec,y=u.projection,b=g.style;let T=[];const C=a.J(o);if(C==="object")for(const I in o)T=T.concat(ir({key:I,value:o[I],valueSpec:y[I],style:b,styleSpec:u}));else C!=="string"&&(T=T.concat([new a.V("projection",o,`object or string expected, ${C} found`)]));return T},import:function(g){const{value:o,styleSpec:u}=g,{data:y,...b}=o;Object.defineProperty(b,"__line__",{value:o.__line__,enumerable:!1});let T=li(a.L({},g,{value:b,valueSpec:u.import}));return a.M(b.id)===""&&T.push(new a.V(`${g.key}.id`,b,"import id can't be an empty string")),y&&(T=T.concat(ci(y,u,{key:`${g.key}.data`}))),T},iconset:function(g){const o=g.value,u=g.key,y=g.styleSpec,b=g.style;if(!o.type)return[new a.V(u,o,'"type" is required')];const T=a.M(o.type);let C=[];if(C=C.concat(li({key:u,value:o,valueSpec:y[`iconset_${T}`],style:b,styleSpec:y})),T==="source"&&o.source){const I=b.sources&&b.sources[o.source],L=I&&a.M(I.type);I?L!=="raster-array"&&C.push(new a.V(u,o.source,`iconset cannot be used with a source of type ${String(L)}, it only be used with a "raster-array" source type`)):C.push(new a.V(u,o.source,`source "${o.source}" not found`))}return C}};function ir(g,o=!1){const u=g.value,y=g.valueSpec,b=g.styleSpec;if(y.expression&&a.a2(a.M(u)))return ra(g);if(y.expression&&a.S(a.U(u)))return xt(g);if(y.type&&ss[y.type]){const T=ss[y.type](g);return o===!0&&T.length>0&&a.J(g.value)==="array"?xt(g):T}return li(a.L({},g,{valueSpec:y.type?b[y.type]:y}))}function xi(g){const o=g.value,u=g.key,y=Mi(g);return y.length||(o.indexOf("{fontstack}")===-1&&y.push(new a.V(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&y.push(new a.V(u,o,'"glyphs" url must include a "{range}" token'))),y}function ci(g,o=a.a5,u={}){return ir({key:u.key||"",value:g,valueSpec:o.$root,styleSpec:o,style:g,objectElementValidators:{glyphs:xi,"*":()=>[]}})}function Ra(g,o=a.a5){return He(ci(g,o))}const ya=g=>He(oa(g)),Tl=g=>He(lo(g)),dr=g=>He(eo(g)),kt=g=>He(co(g)),Dr=g=>He(vo(g)),to=g=>He((function(o){const u=o.value,y=o.style,b=o.styleSpec,T=b.snow;let C=[];const I=a.J(u);if(u===void 0)return C;if(I!=="object")return C=C.concat([new a.V("snow",u,`object expected, ${I} found`)]),C;for(const L in u){const F=L.match(/^(.*)-transition$/);C=C.concat(F&&T[F[1]]&&T[F[1]].transition?ir({key:L,value:u[L],valueSpec:b.transition,style:y,styleSpec:b}):T[L]?ir({key:L,value:u[L],valueSpec:T[L],style:y,styleSpec:b}):[new a.K(L,u[L],`unknown property "${L}"`)])}return C})(g)),Hs=g=>He((function(o){const u=o.value,y=o.style,b=o.styleSpec,T=b.rain;let C=[];const I=a.J(u);if(u===void 0)return C;if(I!=="object")return C=C.concat([new a.V("rain",u,`object expected, ${I} found`)]),C;for(const L in u){const F=L.match(/^(.*)-transition$/);C=C.concat(F&&T[F[1]]&&T[F[1]].transition?ir({key:L,value:u[L],valueSpec:b.transition,style:y,styleSpec:b}):T[L]?ir({key:L,value:u[L],valueSpec:T[L],style:y,styleSpec:b}):[new a.K(L,u[L],`unknown property "${L}"`)])}return C})(g)),hr=g=>He(mi(g)),ot=g=>He($n(g)),he=g=>He(tr(g)),ye=g=>He(Ir(g)),Ae=g=>He(a.a4(g));function He(g){return g.slice().sort(((o,u)=>o.line&&u.line?o.line-u.line:0))}function Pe(g,o){let u=!1;if(o&&o.length)for(const y of o)y instanceof a.K?a.w(y.message):(g.fire(new a.z(new Error(y.message))),u=!0);return u}let Ke;class wt extends a.E{constructor(o,u="flat"){super(),this._transitionable=new a.a6(Ke||(Ke=new a.a7({anchor:new a.a8(a.a5.light.anchor),position:new a.a9(a.a5.light.position),color:new a.a8(a.a5.light.color),intensity:new a.a8(a.a5.light.intensity)}))),this.setLight(o,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u,y={}){this._validate(Tl,o,y)||(this._transitionable.setTransitionOrValue(o),this.id=u)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,y){return(!y||y.validate!==!1)&&Pe(this,o.call(Ra,a.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}}let et=class extends a.E{constructor(g,o,u,y,b){super(),this.scope=u,this._transitionable=new a.a6(new a.a7({source:new a.a8(a.a5.terrain.source),exaggeration:new a.a8(a.a5.terrain.exaggeration)}),u,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o,this.worldview=b}get(){return this._transitionable.serialize()}set(g,o){this._transitionable.setTransitionOrValue(g,o)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new a.aa(g,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const o=g.value.expression;if(!o)return null;let u=-1,y=-1,b=1;for(const T of o.zoomStops)b=o.evaluate(new a.aa(T,{worldview:this.worldview})),b>.01?(u=T,y=-1):y=T;return b<.01&&u>0&&y>u?[u,y]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof a.ab}};const yt=45,Zt=65,zt=.05;function Fn(g,o,u,y){const b=a.af(yt,Zt,u),[T,C]=Yn(g,y);let I=1-Math.min(1,Math.exp((o-T)/(C-T)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*b*g.alpha}function Yn(g,o){const u=.5/Math.tan(.5*o);return[g.range[0]+u,g.range[1]+u]}function Hn(g,o,u,y,b){const T=a.ad([],[o,u,y],b.mercatorFogMatrix);return Fn(g,a.ae(T),b.pitch,b._fov)}function Mr(g,o,u,y,b,T,C){const I=[[u,y,0],[b,y,0],[b,T,0],[u,T,0]];let L=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(const U of I){const Y=a.ad([],U,o),W=a.ae(Y);L=Math.min(L,W),F=Math.max(F,W)}return[Fn(g,L,C.pitch,C._fov),Fn(g,F,C.pitch,C._fov)]}class gr extends a.E{constructor(o,u,y,b){super();const T=new a.a7({range:new a.a8(a.a5.fog.range),color:new a.a8(a.a5.fog.color),"color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new a.a8(a.a5.fog["high-color"]),"high-color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new a.a8(a.a5.fog["space-color"]),"space-color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new a.a8(a.a5.fog["horizon-blend"]),"star-intensity":new a.a8(a.a5.fog["star-intensity"]),"vertical-range":new a.a8(a.a5.fog["vertical-range"])});this._transitionable=new a.a6(T,y,new Map(b)),this.set(o,b),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new a.ag(T),this.scope=y}get state(){const o=this._transform,u=o.projection.name==="globe",y=a.ah(o.zoom),b=this.properties.get("range"),T=[.5,3];return{range:u?[a.ai(T[0],b[0],y),a.ai(T[1],b[1],y)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,u,y={}){if(this._validate(Dr,o,y))return;const b=a.h({},o);for(const T of Object.keys(a.a5.fog))b[T]===void 0&&(b[T]=a.a5.fog[T].default);this._options=b,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.af(yt,Zt,o))*u.a}getOpacityAtLatLng(o,u){return this._transform.projection.supportsFog?(function(y,b,T){const C=a.ac.fromLngLat(b),I=T.elevation?T.elevation.getAtPointOrZero(C):0;return Hn(y,C.x,C.y,I,T)})(this.state,o,u):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Mr(this.state,u,0,0,a.aj,a.aj,this._transform)}getOpacityForBounds(o,u,y,b,T){return this._transform.projection.supportsFog?Mr(this.state,o,u,y,b,T,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Yn(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const y of u){const b=o.points[y];let T;if(b[2]>=0)T=b;else{const C=o.points[y-4];T=a.ak(C,b,C[2]/(C[2]-b[2]))}if(Hn(this.state,T[0],T[1],0,this._transform)>=zt)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,y){return(!y||y.validate!==!1)&&Pe(this,o.call(Ra,a.h({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}}let Sr,gi,jr,da,Ia=class extends a.E{constructor(g,o,u,y){super();const b=Sr||(Sr=new a.a7({density:new a.a8(a.a5.snow.density),intensity:new a.a8(a.a5.snow.intensity),color:new a.a8(a.a5.snow.color),opacity:new a.a8(a.a5.snow.opacity),vignette:new a.a8(a.a5.snow.vignette),"vignette-color":new a.a8(a.a5.snow["vignette-color"]),"center-thinning":new a.a8(a.a5.snow["center-thinning"]),direction:new a.a8(a.a5.snow.direction),"flake-size":new a.a8(a.a5.snow["flake-size"])}));this._transitionable=new a.a6(b,u,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ag(b),this.scope=u}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),u=this.properties.get("direction"),y=a.al(u[0]),b=-Math.max(a.al(u[1]),.01),T=[Math.cos(y)*Math.cos(b),Math.sin(y)*Math.cos(b),Math.sin(b)],C=this.properties.get("vignette"),I=this.properties.get("vignette-color");return I.a=C,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.am(o.r,o.g,o.b,o.a*g),direction:T,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:I}}get(){return this._transitionable.serialize()}set(g,o,u={}){if(this._validate(to,g,u))return;const y=a.h({},g);for(const b of Object.keys(a.a5.snow))y[b]===void 0&&(y[b]=a.a5.snow[b].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,u){return(!u||u.validate!==!1)&&Pe(this,g.call(Ra,a.h({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}},$a=class extends a.E{constructor(g,o,u,y){super();const b=gi||(gi=new a.a7({density:new a.a8(a.a5.rain.density),intensity:new a.a8(a.a5.rain.intensity),color:new a.a8(a.a5.rain.color),opacity:new a.a8(a.a5.rain.opacity),vignette:new a.a8(a.a5.rain.vignette),"vignette-color":new a.a8(a.a5.rain["vignette-color"]),"center-thinning":new a.a8(a.a5.rain["center-thinning"]),direction:new a.a8(a.a5.rain.direction),"droplet-size":new a.a8(a.a5.rain["droplet-size"]),"distortion-strength":new a.a8(a.a5.rain["distortion-strength"])}));this._transitionable=new a.a6(b,u,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ag(b),this.scope=u}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),u=this.properties.get("direction"),y=a.al(u[0]),b=-Math.max(a.al(u[1]),.01),T=[Math.cos(y)*Math.cos(b),Math.sin(y)*Math.cos(b),Math.sin(b)],C=this.properties.get("vignette-color");return C.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.am(o.r,o.g,o.b,o.a*g),direction:T,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:C}}get(){return this._transitionable.serialize()}set(g,o,u={}){if(this._validate(Hs,g,u))return;const y=a.h({},g);for(const b of Object.keys(a.a5.rain))y[b]===void 0&&(y[b]=a.a5.rain[b].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,u){return(!u||u.validate!==!1)&&Pe(this,g.call(Ra,a.h({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}};class yi extends a.E{constructor(o,u,y,b){super(),this.scope=y,this._options=o,this.properties=new a.ag(u),this._transitionable=new a.a6(u,y,new Map(b)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,u){this._options=o,this._transitionable.setTransitionOrValue(o.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Qr{constructor(o,u,y){this.screenBounds=o,this.cameraPoint=y.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=u,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(o,u){let y,b;if(o instanceof a.P||typeof o[0]=="number"){const T=a.P.convert(o);y=[T],b=u.isPointAboveHorizon(T)}else{const T=a.P.convert(o[0]),C=a.P.convert(o[1]),I=T.add(C)._div(2);y=[T,C],b=a.ao(T,C).every((L=>u.isPointAboveHorizon(L)))&&u.isPointAboveHorizon(I)}return new Qr(y,b,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return a.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const u=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],b=a.ao(u,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<y.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?b[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(b[3]=this.cameraPoint)),a.ap(b,o)}bufferedCameraGeometryGlobe(o){const u=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],b=a.ao(u,y,o),T=this.cameraPoint.clone();switch(3*((T.y>u.y)+(T.y>y.y))+((T.x>u.x)+(T.x>y.x))){case 0:b[0]=T,b[4]=T.clone();break;case 1:b.splice(1,0,T);break;case 2:b[1]=T;break;case 3:b.splice(4,0,T);break;case 5:b.splice(2,0,T);break;case 6:b[3]=T;break;case 7:b.splice(3,0,T);break;case 8:b[2]=T}return b}containsTile(o,u,y,b=0){const T=o.queryPadding/u._pixelsPerMercatorPixel+1,C=y?this._bufferedCameraMercator(T,u):this._bufferedScreenMercator(T,u);let I=o.tileID.wrap+(C.unwrapped?b:0);const L=C.polygon.map((ue=>a.aq(o.tileTransform,ue,I)));if(!a.ar(L,0,0,a.aj,a.aj))return;I=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const F=this.screenGeometryMercator.polygon.map((ue=>a.as(o.tileTransform,ue,I))),U=F.map((ue=>new a.P(ue[0],ue[1]))),Y=u.getFreeCameraOptions().position||new a.ac(0,0,0),W=a.as(o.tileTransform,Y,I),Q=F.map((ue=>{const de=a.at(ue,ue,W);return a.au(de,de),new a.av(W,de)})),le=a.aw(o,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:Q,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(oe=a.ax(L),oe.min.x=a.ay(oe.min.x,0,a.aj),oe.min.y=a.ay(oe.min.y,0,a.aj),oe.max.x=a.ay(oe.max.x,0,a.aj),oe.max.y=a.ay(oe.max.y,0,a.aj),oe),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:le};var oe}_bufferedScreenMercator(o,u){const y=bi(o);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let b;return b=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),u):{polygon:this.bufferedScreenGeometry(o).map((T=>u.pointCoordinate3D(T))),unwrapped:!0},this._screenRaycastCache[y]=b,b}}_bufferedCameraMercator(o,u){const y=bi(o);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let b;return b=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),u):{polygon:this.bufferedCameraGeometry(o).map((T=>u.pointCoordinate3D(T))),unwrapped:!0},this._cameraRaycastCache[y]=b,b}}_projectAndResample(o,u){const y=(function(T,C){const I=a.az([],C.pixelMatrix,C.globeMatrix),L=[0,-a.aB,0,1],F=[0,a.aB,0,1],U=[0,0,0,1];a.aA(L,L,I),a.aA(F,F,I),a.aA(U,U,I);const Y=new a.P(L[0]/L[3],L[1]/L[3]),W=new a.P(F[0]/F[3],F[1]/F[3]),Q=a.aC(T,Y)&&L[3]<U[3],le=a.aC(T,W)&&F[3]<U[3];if(!Q&&!le)return null;const oe=(function(Ve,Le,Ne){for(let je=1;je<Ve.length;je++){const dt=Gi(Le.pointCoordinate3D(Ve[je-1]).x),Ze=Gi(Le.pointCoordinate3D(Ve[je]).x);if(Ne<0){if(dt<Ze)return{idx:je,t:-dt/(Ze-1-dt)}}else if(Ze<dt)return{idx:je,t:(1-dt)/(Ze+1-dt)}}return null})(T,C,Q?-1:1);if(!oe)return null;const{idx:ue,t:de}=oe;let xe=ue>1?Ri(T.slice(0,ue),C):[],Te=ue<T.length?Ri(T.slice(ue),C):[];xe=xe.map((Ve=>new a.P(Gi(Ve.x),Ve.y))),Te=Te.map((Ve=>new a.P(Gi(Ve.x),Ve.y)));const Me=[...xe];Me.length===0&&Me.push(Te[Te.length-1]);const ke=a.ai(Me[Me.length-1].y,(Te.length===0?xe[0]:Te[0]).y,de);let Fe;return Fe=Q?[new a.P(0,ke),new a.P(0,0),new a.P(1,0),new a.P(1,ke)]:[new a.P(1,ke),new a.P(1,1),new a.P(0,1),new a.P(0,ke)],Me.push(...Fe),Te.length===0?Me.push(xe[0]):Me.push(...Te),{polygon:Me.map((Ve=>new a.ac(Ve.x,Ve.y))),unwrapped:!1}})(o,u);if(y)return y;const b=(function(T,C){let I=!1,L=-1/0,F=0;for(let Y=0;Y<T.length-1;Y++)T[Y].x>L&&(L=T[Y].x,F=Y);for(let Y=0;Y<T.length-1;Y++){const W=(F+Y)%(T.length-1),Q=T[W],le=T[W+1];Math.abs(Q.x-le.x)>.5&&(Q.x<le.x?(Q.x+=1,W===0&&(T[T.length-1].x+=1)):(le.x+=1,W+1===T.length-1&&(T[0].x+=1)),I=!0)}const U=a.aD(C.center.lng);return I&&U<Math.abs(U-1)&&T.forEach((Y=>{Y.x-=1})),{polygon:T,unwrapped:I}})(Ri(o,u).map((T=>new a.P(Gi(T.x),T.y))),u);return{polygon:b.polygon.map((T=>new a.ac(T.x,T.y))),unwrapped:b.unwrapped}}}function Ri(g,o){return a.aE(g,(u=>{const y=o.pointCoordinate3D(u);u.x=y.x,u.y=y.y}),1/256)}function Gi(g){return g<0?1+g%1:g%1}function bi(g){return 100*g|0}function Da(g,o,u,y,b){const T=function(I,L){if(I)return b(I);if(L){if(g.url&&L.tiles&&g.tiles&&delete g.tiles,L.variants){if(!Array.isArray(L.variants))return b(new Error("variants must be an array"));for(const U of L.variants){if(U==null||typeof U!="object"||U.constructor!==Object)return b(new Error("variant must be an object"));if(!Array.isArray(U.capabilities))return b(new Error("capabilities must be an array"));if(U.capabilities.length===1&&U.capabilities[0]==="meshopt"){L=a.h(L,U);break}}}const F=a.aF(a.h({},L,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);F.tiles=o.canonicalizeTileset(F,g.url),b(null,F)}},C=(function(I,L,F){if(!I)return null;if(!L&&!F)return I;F=F||I.worldview_default;const U=Object.values(I.language||{});if(U.length===0)return null;const Y=Object.values(I.worldview||{});if(Y.length===0)return null;const W=U.every((le=>le===L)),Q=Y.every((le=>le===F));return W&&Q?I:L in(I.language_options||{})||F in(I.worldview_options||{})?null:I.language_options&&I.worldview_options?I:null})(g.data,u,y);return C?a.q.frame((()=>T(null,C))):g.url?a.n(o.transformRequest(o.normalizeSourceURL(g.url,null,u,y),a.R.Source),T):a.q.frame((()=>{const{data:I,...L}=g;T(null,L)}))}function Xa(g,o){const u=Math.pow(2,o.z),y=Math.floor(a.aD(g.getWest())*u),b=Math.floor(a.aH(g.getNorth())*u),T=Math.ceil(a.aD(g.getEast())*u),C=Math.ceil(a.aH(g.getSouth())*u);return o.x>=y&&o.x<T&&o.y>=b&&o.y<C}class uo{constructor(o,u,y){this.bounds=o?a.aG.convert(this.validateBounds(o)):null,this.minzoom=u||0,this.maxzoom=y||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}addExtraBounds(o){if(o){this.extraBounds||(this.extraBounds=[]);for(const u of o)this.extraBounds.push(a.aG.convert(this.validateBounds(u)))}}contains(o){if(o.z>this.maxzoom||o.z<this.minzoom||this.bounds&&!Xa(this.bounds,o))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(Xa(u,o))return!0;return!1}static fromTileJSON(o){if(!o.bounds&&!o.extra_bounds)return null;const u=new uo(o.bounds,o.minzoom,o.maxzoom);return u.addExtraBounds(o.extra_bounds),u}}class td extends a.E{constructor(o,u,y,b){if(super(),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.h(this,a.aF(u,["url","scheme","tileSize","promoteId"])),this._options=a.h({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new a.aI}load(o){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=Da(this._options,this.map._requestManager,u,y,((b,T)=>{if(this._tileJSONRequest=null,this._loaded=!0,b)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new a.z(b));else if(T){if(a.h(this,T),this.hasWorldviews=!!T.worldview_options,T.worldview_default&&(this.worldviewDefault=T.worldview_default),T.vector_layers){this.vectorLayers=T.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const C of T.vector_layers)this.vectorLayerIds.push(C.id),T.worldview&&T.worldview[C.source]&&this.localizableLayerIds.add(C.id)}this.tileBounds=uo.fromTileJSON(T),nt(T.tiles,this.map._requestManager._customAccessToken),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}o&&o(b)}))}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=a.C(this.id,this.scope);this.load((()=>this.map.style.clearSource(o)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return a.h({},this._options)}loadTile(o,u){const y=o.tileID.canonical.url(this.tiles,this.scheme),b=this.map._requestManager.normalizeTileURL(y),T=this.map._requestManager.transformRequest(b,a.R.Tile),C=this.map.style?this.map.style.getLut(this.scope):null,I=C?{image:C.image.clone()}:null,L={request:T,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:I,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&a.j(y)&&(L.localizableLayerIds=this.localizableLayerIds),L.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",L,F.bind(this));else if(o.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",L,F.bind(this),void 0,!0);else{const U=a.aJ.call({deduped:this._deduped},L,((Y,W)=>{Y||!W?F.call(this,Y):(L.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},o.actor&&o.actor.send("loadTile",L,F.bind(this),void 0,!0))}),!0);o.request={cancel:U}}function F(U,Y){return delete o.request,o.aborted?u(null):U&&U.status!==404?u(U):(Y&&Y.resourceTiming&&(o.resourceTiming=Y.resourceTiming),this.map._refreshExpiredTiles&&Y&&o.setExpiryData(Y),o.loadVectorData(Y,this.map.painter),a.aK(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,u){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class xo extends a.E{constructor(o,u,y,b){super(),this.id=o,this.dispatcher=y,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.h({type:"raster"},u),a.h(this,a.aF(u,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const u=this.map.getWorldview();this._tileJSONRequest=Da(this._options,this.map._requestManager,null,u,((y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?this.fire(new a.z(y)):b&&(a.h(this,b),b.raster_layers&&(this.rasterLayers=b.raster_layers,this.rasterLayerIds=this.rasterLayers.map((T=>T.id))),this.tileBounds=uo.fromTileJSON(b),nt(b.tiles),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))),o&&o(y)}))}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=a.C(this.id,this.scope);this.load((()=>this.map.style.clearSource(o)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return a.h({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,u){const y=a.q.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);o.request=a.o(this.map._requestManager.transformRequest(b,a.R.Tile),((T,C,I,L)=>(delete o.request,o.aborted?(o.state="unloaded",u(null)):T?(o.state="errored",u(T)):C?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:I,expires:L}),o.setTexture(C,this.map.painter),o.state="loaded",a.aK(this.dispatcher),void u(null)):u(null))))}abortTile(o,u){o.request&&(o.request.cancel(),delete o.request),u&&u()}unloadTile(o,u){o.texture&&o.texture instanceof a.T?(o.destroy(!0),o.texture&&o.texture instanceof a.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ro extends xo{constructor(o,u,y,b){super(o,u,y,b),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=a.h({type:"raster-array"},u)}triggerRepaint(o){const u=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);u&&u.enabled&&y&&u._clearRenderCacheForTile(y.id,o.tileID),this.map.triggerRepaint()}loadTile(o,u){const y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),b=this.map._requestManager.transformRequest(y,a.R.Tile),T={request:b,uid:o.uid,tileID:o.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};o.source=this.id,o.scope=this.scope,o.requestParams=b,o.actor||(o.actor=this.dispatcher.getActor());const C=(I,L,F,U)=>{if(delete o.request,o.aborted)return o.state="unloaded",u(null);if(I)return I.name==="AbortError"?void 0:(o.state="errored",u(I));if(this.map._refreshExpiredTiles&&L&&o.setExpiryData({cacheControl:F,expires:U}),this.partial)o.state="empty";else{if(!L)return u(null);o.state="loaded",o._isHeaderLoaded=!0,o._mrt=L}u(null)};o.request=this.partial?o.fetchHeader(void 0,C.bind(this)):o.actor.send("loadTile",T,C.bind(this),void 0,!0)}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,u){const y=o.texturePerLayer;if(o.flushAllQueues(),y.size){o.destroy(!0);for(const b of y.values())this.map.painter.saveTileTexture(b)}else o.destroy()}prepareTile(o,u,y,b){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(u,y,b,((T,C)=>{if(T)return o.state="errored",this.fire(new a.z(T)),void this.triggerRepaint(o);C&&(o._isHeaderLoaded=!0,o.setTexturePerLayer(y,C,this.map.painter),o.state="loaded",this.triggerRepaint(o))})))}getInitialBand(o){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find((({id:T})=>T===o)),y=u&&u.fields,b=y&&y.bands&&y.bands;return b?b[0]:0}getTextureDescriptor(o,u,y){if(!o)return;const b=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!b)return;let T=null;u instanceof a.aN?T=u.paint.get("raster-array-band"):u instanceof a.aO&&(T=u.paint.get("raster-particle-array-band"));const C=T||this.getInitialBand(b);if(C==null)return;if(!o.textureDescriptorPerLayer.get(u.id))return void this.prepareTile(o,b,u.id,C);if(o.updateNeeded(u.id,C)&&!y)return;const I=o.textureDescriptorPerLayer.get(u.id);return Object.assign({},I,{texture:o.texturePerLayer.get(u.id)})}getImages(o,u){const y=new Map;for(const b of o)for(const T of u){const[C,I]=T.split("/"),L=b.getLayer(C);if(!L||!L.hasBand(I)||!L.hasDataForBand(I))continue;const{bytes:F,tileSize:U,buffer:Y}=L.getBandView(I),W=U+2*Y,Q={data:new a.r({width:W,height:W},F),pixelRatio:2,sdf:!1,usvg:!1,version:0};y.set(T,Q)}return y}}const nd={vector:td,raster:xo,"raster-dem":class extends xo{constructor(g,o,u,y){super(g,o,u,y),this.type="raster-dem",this.maxzoom=22,this._options=a.h({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(b,T){b&&(g.state="errored",o(b)),T&&(g.dem=T,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=a.o(this.map._requestManager.transformRequest(u,a.R.Tile),(function(b,T,C,I){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(b)g.state="errored",o(b);else if(T){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:C,expires:I});const L=ImageBitmap&&T instanceof ImageBitmap&&a.t(),F=1-(T.width-a.aL(T.width))/2;F<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const U=L?T:a.q.getImageData(T,F),Y={uid:g.uid,tileID:g.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:U,encoding:this.encoding,padding:F};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadTile",Y,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,u=Math.pow(2,o.z),y=(o.x-1+u)%u,b=o.x===0?g.wrap-1:g.wrap,T=(o.x+1+u)%u,C=o.x+1===u?g.wrap+1:g.wrap,I={};return I[new a.aM(g.overscaledZ,b,o.z,y,o.y).key]={backfilled:!1},I[new a.aM(g.overscaledZ,C,o.z,T,o.y).key]={backfilled:!1},o.y>0&&(I[new a.aM(g.overscaledZ,b,o.z,y,o.y-1).key]={backfilled:!1},I[new a.aM(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},I[new a.aM(g.overscaledZ,C,o.z,T,o.y-1).key]={backfilled:!1}),o.y+1<u&&(I[new a.aM(g.overscaledZ,b,o.z,y,o.y+1).key]={backfilled:!1},I[new a.aM(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},I[new a.aM(g.overscaledZ,C,o.z,T,o.y+1).key]={backfilled:!1}),I}},"raster-array":Ro,geojson:class extends a.E{constructor(g,o,u,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(y),this._data=o.data,this._options=a.h({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const b=a.aj/this.tileSize;this.workerOptions=a.h({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*b,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*b,extent:a.aj,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.aj,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*b,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new a.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new a.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const u of this._data.features)o.set(u.id,u);for(const u of g.features)o.set(u.id,u);this._data.features=[...o.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterLeaves(g,o,u,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:o,offset:u},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.A("dataloading",{dataType:"source"})),this._loaded=!1;const o=a.h({append:g},this.workerOptions);o.scope=this.scope;const u=this._data;typeof u=="string"?(o.request=this.map._requestManager.transformRequest(a.q.resolveURL(u),a.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,((y,b)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new a.z(y));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(T.resourceTiming=b.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new a.A("data",T)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)}))}loaded(){return this._loaded}reload(){const g=a.C(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,o){const u=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,b=y?{image:y.image.clone()}:null,T=this._partialReload,C={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:b,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:g.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:T,worldview:this.map.getWorldview()};g.request=this.actor.send(u,C,((I,L)=>T&&!L?(g.state="loaded",o(null)):(delete g.request,g.destroy(),g.aborted?o(null):I?o(I):(g.loadVectorData(L,this.map.painter,u==="reloadTile"),o(null)))),void 0,u==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,o){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aP{constructor(g,o,u,y){super(g,o,u,y),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,a.R.Source).url);a.aQ(this.urls,((o,u)=>{this._loaded=!0,o?this.fire(new a.z(o)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new a.z(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(g,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aP,model:class extends a.E{constructor(g,o,u,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const g=[];for(const o in this._options.models){const u=this._options.models[o],y=a.aS(this.map._requestManager.transformRequest(u.uri,a.R.Model).url).then((b=>{if(!b)return;const T=a.aT(b),C=new a.aU(o,u.position,u.orientation,T);C.computeBoundsAndApplyParent(),this.models.push(C)})).catch((b=>{this.fire(new a.z(new Error(`Could not load model ${o} from ${u.uri}: ${b.message}`)))}));g.push(y)}Promise.allSettled(g).then((()=>{this._loaded=!0,this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((o=>{this._loaded=!0,this.fire(new a.z(new Error(`Could not load models: ${o.message}`)))}))}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,o){}serialize(){return this._options}},"batched-model":class extends a.E{constructor(g,o,u,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=a.C(this.id,this.scope);this.load((()=>this.map.style.clearSource(g)))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=Da(this._options,this.map._requestManager,o,u,((y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new a.z(y))):b&&(a.h(this,b),b.bounds&&(this.tileBounds=new uo(b.bounds,this.minzoom,this.maxzoom)),nt(b.tiles,this.map._requestManager._customAccessToken),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)}))}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,o){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(u,a.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:a.q.devicePixelRatio,promoteId:this.promoteId};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=o;else{if(g.buckets){const T=Object.values(g.buckets);for(const C of T)C.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,b.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,b.bind(this),void 0,!0);function b(T,C){return g.aborted?o(null):T&&T.status!==404?o(T):(this.map._refreshExpiredTiles&&C&&g.setExpiryData(C),g.loadModelData(C,this.map.painter),g.state="loaded",void o(null))}}serialize(){return a.h({},this._options)}},canvas:class extends a.aP{constructor(g,o,u,y){super(g,o,u,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((b=>!Array.isArray(b)||b.length!==2||b.some((T=>typeof T!="number"))))||this.fire(new a.z(new a.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.z(new a.V(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.z(new a.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new a.z(new a.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.z(new a.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof a.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends a.E{constructor(g,o,u,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=o,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new uo(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),a.h(this,a.aF(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:u,z:y}=g.canonical;return this._implementation.hasTile({x:o,y:u,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:u,y,z:b}=g.tileID.canonical,T=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:u,y,z:b},{signal:T.signal})).then((function(C){return delete g.request,g.aborted?(g.state="unloaded",o(null)):C===void 0?(g.state="errored",o(null)):C===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):(function(I){return I instanceof ImageData||I instanceof HTMLCanvasElement||I instanceof ImageBitmap||I instanceof HTMLImageElement})(C)?(this.loadTileData(g,C),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((C=>{C.name!=="AbortError"&&(g.state="errored",o(C))})),g.request.cancel=()=>T.abort()}loadTileData(g,o){g.setTexture(o,this.map.painter)}unloadTile(g,o){if(g.texture&&g.texture instanceof a.T?(g.destroy(!0),g.texture&&g.texture instanceof a.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:u,y,z:b}=g.tileID.canonical;this._implementation.unloadTile({x:u,y,z:b})}o&&o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z})))}_clearTiles(){const g=a.C(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}}},fu=function(g,o,u,y){const b=new nd[o.type](g,o,u,y);if(b.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${b.id}`);return a.aV(["load","abort","unload","serialize","prepare"],b),b};function Lc(g,o,u=""){return`${u}:${o.id||""}:${o.layer.id}:${(function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:b,importId:T}=y;return`featureset:${b}${T?`:import:${T}`:""}`}})(g.target)}`}function rd(g,o,u,y=""){if(g.uniqueFeatureID){const b=Lc(g,o,y);if(u.has(b))return!0;u.add(b)}return!1}function Nc(g,o,u,y,b=!1){const T=o.sourceCache.transform,C=o.sourceCache.tilesIn(g,o.has3DLayers,b);C.sort(sh);const I=[];for(const L of C){const F=L.tile.queryRenderedFeatures(o,L,u,y,T,b);Object.keys(F).length&&I.push({wrappedTileID:L.tile.tileID.wrapped().key,queryResults:F})}return I.length===0?{}:(function(L){const F={},U={};for(const Y of L){const W=Y.queryResults,Q=Y.wrappedTileID,le=U[Q]=U[Q]||{};for(const oe in W){const ue=W[oe],de=le[oe]=le[oe]||{},xe=F[oe]=F[oe]||[];for(const Te of ue)de[Te.featureIndex]||(de[Te.featureIndex]=!0,xe.push(Te))}}return F})(I)}function jl(g,o,u,y,b,T){const C={},I=y.queryRenderedSymbols(g),L=[];for(const F of Object.keys(I).map(Number))L.push(b[F]);L.sort(sh);for(const F of L){const U=F.featureIndex.lookupSymbolFeatures(I[F.bucketInstanceId],F.bucketIndex,F.sourceLayerIndex,o,u,T);for(const Y in U){const W=C[Y]=C[Y]||[],Q=U[Y];Q.sort(((le,oe)=>{const ue=F.featureSortOrder;if(ue){const de=ue.indexOf(le.featureIndex);return ue.indexOf(oe.featureIndex)-de}return oe.featureIndex-le.featureIndex}));for(const le of Q)W.push(le)}}return C}function bo(g,o){const u=g.getRenderableIds().map((T=>g.getTileByID(T))),y=[],b={};for(let T=0;T<u.length;T++){const C=u[T],I=C.tileID.canonical.key;b[I]||(b[I]=!0,C.querySourceFeatures(y,o))}return y}function sh(g,o){const u=g.tileID,y=o.tileID;return u.overscaledZ-y.overscaledZ||u.canonical.y-y.canonical.y||u.wrap-y.wrap||u.canonical.x-y.canonical.x}function ls(g,o){const u={};if(!o)return u;for(const y of g){const b=y.layerIds.map((T=>o.getLayer(T))).filter(Boolean);if(b.length!==0){y.layers=b,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map((T=>b.filter((C=>C.id===T))[0])));for(const T of b)u[T.fqid]=y}}return u}const ms=32,Xo=33,Bl=new Uint16Array(8184);for(let g=0;g<2046;g++){let o=g+2,u=0,y=0,b=0,T=0,C=0,I=0;for(1&o?b=T=C=ms:u=y=I=ms;(o>>=1)>1;){const F=u+b>>1,U=y+T>>1;1&o?(b=u,T=y,u=C,y=I):(u=b,y=T,b=C,T=I),C=F,I=U}const L=4*g;Bl[L+0]=u,Bl[L+1]=y,Bl[L+2]=b,Bl[L+3]=T}const cl=new Uint16Array(2178),Cs=new Uint8Array(1089),id=new Uint16Array(1089);function El(g){return g===0?-.03125:g===32?.03125:0}const zc={type:2,extent:a.aj,loadGeometry:()=>[[new a.P(0,0),new a.P(a.aj+1,0),new a.P(a.aj+1,a.aj+1),new a.P(0,a.aj+1),new a.P(0,0)]]};class gs{constructor(o,u,y,b,T,C){this.tileID=o,this.uid=a.a$(),this.uses=0,this.tileSize=u,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=T,b&&b.style&&(this._lastUpdatedBrightness=b.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",b&&b.transform&&(this.projection=b.transform.projection),this.worldview=C}registerFadeDuration(o){const u=o+this.timeAdded;u<a.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,u,y){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=ls(o.buckets,u.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const T=this.buckets[b];if(T instanceof a.b1){if(this.hasSymbolBuckets=!0,!y)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const T=this.buckets[b];if(T instanceof a.b1&&T.hasRTLText){this.hasRTLText=!0,a.b2();break}}this.queryPadding=0;for(const b in this.buckets){const T=this.buckets[b],C=u.style.getOwnLayer(b);if(!C)continue;const I=C.queryRadius(T);this.queryPadding=Math.max(this.queryPadding,I)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new a.b0}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,u,y){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,ls(o.buckets,u.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const b in this.buckets){const T=this.buckets[b];T.uploadPending()&&T.upload(o)}const u=o.gl,y=this.imageAtlas;y&&!y.uploaded&&(this.imageAtlasTexture=new a.T(o,y.image,u.RGBA8,{useMipmap:!!y.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(o,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(o,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(o,u,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,y),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const b=u.style.getBrightness();(this._lastUpdatedBrightness||b)&&(this._lastUpdatedBrightness&&b&&Math.abs(this._lastUpdatedBrightness-b)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==b),this._lastUpdatedBrightness=b))}queryRenderedFeatures(o,u,y,b,T,C){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const I=(function(L,F){const U=a.bn([],[.5*L.width,.5*-L.height,1]);return a.bo(U,U,[1,-1,0]),a.az(U,U,L.calculateProjMatrix(F.toUnwrapped())),Float32Array.from(U)})(T,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:u,pixelPosMatrix:I,transform:b,availableImages:y,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(o,u){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const b=y.loadVTLayers(),T=u?u.sourceLayer:"",C=b._geojsonTileLayer||b[T];if(!C)return;const I=a.b3(u&&u.filter),{z:L,x:F,y:U}=this.tileID.canonical,Y={z:L,x:F,y:U};for(let W=0;W<C.length;W++){const Q=C.feature(W);if(I.needGeometry){const ue=a.b4(Q,!0);if(!I.filter(new a.aa(this.tileID.overscaledZ,{worldview:this.worldview}),ue,this.tileID.canonical))continue}else if(!I.filter(new a.aa(this.tileID.overscaledZ,{worldview:this.worldview}),Q))continue;const le=y.getId(Q,T),oe=new a.b5(Q,L,F,U,le);oe.tile=Y,o.push(oe)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const y=a.b6(o.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const y=Date.now();let b=!1;if(this.expirationTime>y)b=!1;else if(u)if(this.expirationTime<u)b=!0;else{const T=this.expirationTime-u;T?this.expirationTime=y+Math.max(T,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,u){if(!this.latestFeatureIndex||!o.style)return;const y=this.latestFeatureIndex.loadVTLayers(),b=o.style.listImages(),T=o.style.getBrightness();for(const C in this.buckets){if(!o.style.hasLayer(C))continue;const I=this.buckets[C],L=I.layers[0],F=L.sourceLayer||"_geojsonTileLayer",U=y[F],Y=o.style.getLayerSourceCache(L);let W={};Y&&(W=Y._state.getState(F,void 0));const Q=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},le=Object.keys(W).length>0&&!u;le&&!I.stateDependentLayers.length&&!u||I.update(W,U,b,Q,le?I.stateDependentLayers:I.layers,u,T),(I instanceof a.b7||I instanceof a.b8)&&o._terrain&&o._terrain.enabled&&Y&&I.uploadPending()&&o._terrain._clearRenderCacheForTile(Y.id,this.tileID);const oe=o&&o.style&&o.style.getOwnLayer(C);oe&&(this.queryPadding=Math.max(this.queryPadding,oe.queryRadius(I)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=a.q.now()+o}setTexture(o,u){const y=u.context,b=y.gl;this.texture=this.texture||u.getTileTexture(o.width),this.texture&&this.texture instanceof a.T?this.texture.update(o):(this.texture=new a.T(y,o,b.RGBA8,{useMipmap:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE))}setDependencies(o,u){const y={};for(const b of u)y[b]=!0;this.dependencies[o]=y}hasDependency(o,u){for(const y of o){const b=this.dependencies[y];if(b){for(const T of u)if(b[T])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const y=a.b9(zc,this.tileID.canonical,this.tileTransform)[0],b=new a.ba,T=new a.bb;for(let C=0;C<y.length;C++){const{x:I,y:L}=y[C];b.emplaceBack(I,L),T.emplaceBack(C)}T.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(T),this._tileDebugBuffer=o.createVertexBuffer(b,a.bc.members),this._tileDebugSegments=a.bd.simpleSegment(0,0,b.length,T.length)}_makeTileBoundsBuffers(o,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const y=a.b9(zc,this.tileID.canonical,this.tileTransform)[0];let b,T;if(this.isRaster){const C=(function(I,L){const F=a.aW(I,L),U=Math.pow(2,I.z);for(let ue=0;ue<Xo;ue++)for(let de=0;de<Xo;de++){const xe=a.aX((I.x+(de+El(de))/ms)/U),Te=a.aY((I.y+(ue+El(ue))/ms)/U),Me=L.project(xe,Te),ke=ue*Xo+de;cl[2*ke+0]=Math.round((Me.x*F.scale-F.x)*a.aj),cl[2*ke+1]=Math.round((Me.y*F.scale-F.y)*a.aj)}Cs.fill(0),id.fill(0);for(let ue=2045;ue>=0;ue--){const de=4*ue,xe=Bl[de+0],Te=Bl[de+1],Me=Bl[de+2],ke=Bl[de+3],Fe=xe+Me>>1,Ve=Te+ke>>1,Le=Fe+Ve-Te,Ne=Ve+xe-Fe,je=Te*Xo+xe,dt=ke*Xo+Me,Ze=Ve*Xo+Fe,Pt=Math.hypot((cl[2*je+0]+cl[2*dt+0])/2-cl[2*Ze+0],(cl[2*je+1]+cl[2*dt+1])/2-cl[2*Ze+1])>=16;Cs[Ze]=Cs[Ze]||(Pt?1:0),ue<1022&&(Cs[Ze]=Cs[Ze]||Cs[(Te+Ne>>1)*Xo+(xe+Le>>1)]||Cs[(ke+Ne>>1)*Xo+(Me+Le>>1)])}const Y=new a.aZ,W=new a.a_;let Q=0;function le(ue,de){const xe=de*Xo+ue;return id[xe]===0&&(Y.emplaceBack(cl[2*xe+0],cl[2*xe+1],ue*a.aj/ms,de*a.aj/ms),id[xe]=++Q),id[xe]-1}function oe(ue,de,xe,Te,Me,ke){const Fe=ue+xe>>1,Ve=de+Te>>1;if(Math.abs(ue-Me)+Math.abs(de-ke)>1&&Cs[Ve*Xo+Fe])oe(Me,ke,ue,de,Fe,Ve),oe(xe,Te,Me,ke,Fe,Ve);else{const Le=le(ue,de),Ne=le(xe,Te),je=le(Me,ke);W.emplaceBack(Le,Ne,je)}}return oe(0,0,ms,ms,ms,0),oe(ms,ms,0,0,0,ms),{vertices:Y,indices:W}})(this.tileID.canonical,u);b=C.vertices,T=C.indices}else{b=new a.aZ,T=new a.a_;for(const{x:I,y:L}of y)b.emplaceBack(I,L,0,0);const C=a.be(b.int16.subarray(0,4*b.length),void 0,4);for(let I=0;I<C.length;I+=3)T.emplaceBack(C[I],C[I+1],C[I+2])}this._tileBoundsBuffer=o.createVertexBuffer(b,a.bf.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(T),this._tileBoundsSegments=a.bd.simpleSegment(0,0,b.length,T.length)}_makeGlobeTileDebugBuffers(o,u){const y=u.projection;if(!y||y.name!=="globe"||u.freezeTileCoverage)return;const b=this.tileID.canonical,T=a.bg(b,u),C=a.bh(T),I=a.ah(u.zoom);let L;I>0&&(L=a.bi(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,b,u,C,L,I),this._makeGlobeTileDebugTextBuffer(o,b,u,C,L,I)}_globePoint(o,u,y,b,T,C,I){let L=a.bj(o,u,y);if(C){const F=1<<y.z,U=a.aD(b.center.lng),Y=a.aH(b.center.lat),W=(y.x+.5)/F-U;let Q=0;W>.5?Q=-1:W<-.5&&(Q=1);let le=(o/a.aj+y.x)/F+Q,oe=(u/a.aj+y.y)/F;le=(le-U)*b._pixelsPerMercatorPixel+U,oe=(oe-Y)*b._pixelsPerMercatorPixel+Y;const ue=[le*b.worldSize,oe*b.worldSize,0];a.ad(ue,ue,C),L=a.bk(L,ue,I)}return a.ad(L,L,T)}_makeGlobeTileDebugBorderBuffer(o,u,y,b,T,C){const I=new a.ba,L=new a.bb,F=new a.bl,U=(W,Q,le,oe,ue)=>{const de=(le-W)/(ue-1),xe=(oe-Q)/(ue-1),Te=I.length;for(let Me=0;Me<ue;Me++){const ke=W+Me*de,Fe=Q+Me*xe;I.emplaceBack(ke,Fe);const Ve=this._globePoint(ke,Fe,u,y,b,T,C);F.emplaceBack(Ve[0],Ve[1],Ve[2]),L.emplaceBack(Te+Me)}},Y=a.aj;U(0,0,Y,0,16),U(Y,0,Y,Y,16),U(Y,Y,0,Y,16),U(0,Y,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(L),this._tileDebugBuffer=o.createVertexBuffer(I,a.bc.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(F,a.bm.members),this._tileDebugSegments=a.bd.simpleSegment(0,0,I.length,L.length)}_makeGlobeTileDebugTextBuffer(o,u,y,b,T,C){const I=a.aj/4,L=new a.ba,F=new a.a_,U=new a.bl,Y=25;F.reserve(32),L.reserve(Y),U.reserve(Y);const W=(Q,le)=>Y*Q+le;for(let Q=0;Q<Y;Q++){const le=Q*I;for(let oe=0;oe<Y;oe++){const ue=oe*I;L.emplaceBack(ue,le);const de=this._globePoint(ue,le,u,y,b,T,C);U.emplaceBack(de[0],de[1],de[2])}}for(let Q=0;Q<4;Q++)for(let le=0;le<4;le++){const oe=W(Q,le),ue=W(Q,le+1),de=W(Q+1,le),xe=W(Q+1,le+1);F.emplaceBack(oe,ue,de),F.emplaceBack(de,ue,xe)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(F),this._tileDebugTextBuffer=o.createVertexBuffer(L,a.bc.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(U,a.bm.members),this._tileDebugTextSegments=a.bd.simpleSegment(0,0,Y,32)}destroy(o=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.bp.setPbf(a.bq);class lh extends gs{constructor(o,u,y,b,T){super(o,u,y,b,T),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(o){return this._mrt&&this._mrt.getLayer(o)}setTexturePerLayer(o,u,y){const b=y.context,T=b.gl;let C=this.texturePerLayer.get(o)||y.getTileTexture(u.width);C&&C instanceof a.T?C.update(u,{premultiply:!1}):C=new a.T(b,u,T.RGBA8,{premultiply:!1}),this.texturePerLayer.has(o)||this.texturePerLayer.set(o,C)}flushQueues(o){const u=this._workQueuePerLayer.get(o)||[],y=this._fetchQueuePerLayer.get(o)||[];for(;u.length;)u.pop()();for(;y.length;)y.pop()()}flushAllQueues(){for(const o of this._workQueuePerLayer.keys()){const u=this._workQueuePerLayer.get(o)||[];for(;u.length;)u.pop()()}for(const o of this._fetchQueuePerLayer.keys()){const u=this._fetchQueuePerLayer.get(o)||[];for(;u.length;)u.pop()()}}fetchHeader(o=16384,u){const y=this._mrt=new a.bp(30),b=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=a.br(b,((T,C,I,L)=>{if(T)u(T);else try{const F=y.getHeaderLength(C);if(F>o)return void(this.request=this.fetchHeader(F,u));y.parseHeader(C),this._isHeaderLoaded=!0;let U=0;for(const Y of Object.values(y.layers))U=Math.max(U,Y.dataIndex[Y.dataIndex.length-1].lastByte);C.byteLength>=U&&(this.entireBuffer=C),u(null,this.entireBuffer||C,I,L)}catch(F){u(F)}})),this.request}fetchBand(o,u,y,b){const T=this._mrt;if(!this._isHeaderLoaded||!T)return void b(new Error("Tile header is not ready"));const C=this.actor;if(!C)return void b(new Error("Can't fetch tile band without an actor"));let I;const L=(W,Q)=>{if(I.complete(W,Q),W)return void b(W);this.updateTextureDescriptor(o,u,y);const le=this.textureDescriptorPerLayer.get(u);b(null,le&&le.img)},F=(W,Q)=>{if(W)return b(W);const le=C.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Q,task:I},L,void 0,!0),oe=this._workQueuePerLayer.get(u)||[];oe.push((()=>{le&&le.cancel(),I.cancel()})),this._workQueuePerLayer.has(u)||this._workQueuePerLayer.set(u,oe)},U=T.getLayer(o);if(!U)return void b(new Error(`Unknown sourceLayer "${o}"`));if(U.hasDataForBand(y)){this.updateTextureDescriptor(o,u,y);const W=this.textureDescriptorPerLayer.get(u);return void b(null,W?W.img:null)}const Y=U.getDataRange([y]);if(I=T.createDecodingTask(Y),!I||I.tasks.length)if(this.flushQueues(u),this.entireBuffer)F(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const W=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),Q=a.br(W,F),le=this._fetchQueuePerLayer.get(u)||[];le.push((()=>{Q.cancel(),I.cancel()})),this._fetchQueuePerLayer.has(u)||this._fetchQueuePerLayer.set(u,le)}else b(null)}updateNeeded(o,u){return(!this.textureDescriptorPerLayer.get(o)||this.textureDescriptorPerLayer.get(o).band!==u)&&this.state!=="errored"}updateTextureDescriptor(o,u,y){if(!this._mrt)return;const b=this._mrt.getLayer(o);if(!b||!b.hasBand(y)||!b.hasDataForBand(y))return;const{bytes:T,tileSize:C,buffer:I,offset:L,scale:F}=b.getBandView(y),U=C+2*I,Y=new a.r({width:U,height:U},T),W=this.texturePerLayer.get(u);W&&W instanceof a.T&&W.update(Y,{premultiply:!1}),this.textureDescriptorPerLayer.set(u,{layer:o,band:y,img:Y,buffer:I,offset:L,tileSize:C,format:b.pixelFormat,mix:[F,256*F,65536*F,16777216*F]})}destroy(o=!1){if(super.destroy(o),delete this._mrt,!o)for(const u of this.texturePerLayer.values())u&&u instanceof a.T&&u.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class Sp{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,y){const b=o.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const T={value:u,timeout:void 0};if(y!==void 0&&(T.timeout=setTimeout((()=>{this.remove(o,T)}),y)),this.data[b].push(T),this.order.push(b),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const y=o.wrapped().key,b=u===void 0?0:this.data[y].indexOf(u),T=this.data[y][b];return this.data[y].splice(b,1),T.timeout&&clearTimeout(T.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(T.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const y in this.data)for(const b of this.data[y])o(b.value)||u.push(b);for(const y of u)this.remove(y.value.tileID,y)}}class ch{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,y){const b=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][b]=this.stateChanges[o][b]||{},a.h(this.stateChanges[o][b],y),this.deletedStates[o]===null){this.deletedStates[o]={};for(const T in this.state[o])T!==b&&(this.deletedStates[o][T]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][b]===null){this.deletedStates[o][b]={};for(const T in this.state[o][b])y[T]||(this.deletedStates[o][b][T]=null)}else for(const T in y)this.deletedStates[o]&&this.deletedStates[o][b]&&this.deletedStates[o][b][T]===null&&delete this.deletedStates[o][b][T]}removeFeatureState(o,u,y){if(this.deletedStates[o]===null)return;const b=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},y&&u!==void 0)this.deletedStates[o][b]!==null&&(this.deletedStates[o][b]=this.deletedStates[o][b]||{},this.deletedStates[o][b][y]=null);else if(u!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][b])for(y in this.deletedStates[o][b]={},this.stateChanges[o][b])this.deletedStates[o][b][y]=null;else this.deletedStates[o][b]=null;else this.deletedStates[o]=null}getState(o,u){const y=this.state[o]||{},b=this.stateChanges[o]||{},T=this.deletedStates[o];if(T===null)return{};if(u!==void 0){const I=String(u),L=a.h({},y[I],b[I]);if(T){const F=T[u];if(F===null)return{};for(const U in F)delete L[U]}return L}const C=a.h({},y,b);if(T)for(const I in T)delete C[I];return C}initializeTileState(o,u){o.refreshFeatureState(u)}coalesceChanges(o,u){const y={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const T={};for(const C in this.stateChanges[b])this.state[b][C]||(this.state[b][C]={}),a.h(this.state[b][C],this.stateChanges[b][C]),T[C]=this.state[b][C];y[b]=T}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const T={};if(this.deletedStates[b]===null)for(const C in this.state[b])T[C]={},this.state[b][C]={};else for(const C in this.deletedStates[b]){if(this.deletedStates[b][C]===null)this.state[b][C]={};else if(this.state[b][C])for(const I of Object.keys(this.deletedStates[b][C]))delete this.state[b][C][I];T[C]=this.state[b][C]}y[b]=y[b]||{},a.h(y[b],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const b in o)o[b].refreshFeatureState(u)}}class Zo extends a.E{constructor(o,u,y){super(),this.id=o,this._onlySymbols=y,u.on("data",(b=>{b.dataType==="source"&&b.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&b.dataType==="source"&&b.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),u.on("error",(()=>{this._sourceErrored=!0})),this._source=u,this._tiles={},this._cache=new Sp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ch,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles)if(!this._tiles[o].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,u){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,u)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const y=this._tiles[u];y.upload(o),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map((o=>o.tileID)).sort(Fl).map((o=>o.key))}getRenderableIds(o,u){const y=[];for(const b in this._tiles)this._isIdRenderable(+b,o,u)&&y.push(this._tiles[b]);return o?y.sort(((b,T)=>{const C=b.tileID,I=T.tileID,L=new a.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),F=new a.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-I.overscaledZ||F.y-L.y||F.x-L.x})).map((b=>b.tileID.key)):y.map((b=>b.tileID)).sort(Fl).map((b=>b.key))}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u,y){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())&&(y||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,u){const y=this._tiles[o];y&&(y.state!=="loading"&&(y.state=u),this._loadTile(y,this._tileLoaded.bind(this,y,o,u)))}_tileLoaded(o,u,y,b){if(b)if(o.state="errored",b.status!==404)this._source.fire(new a.z(b,{tile:o}));else{if(this._source.fire(new a.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const T=this.map.painter.terrain;this.update(this.transform,T.getScaledDemTileSize(),!0),T.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=a.q.now(),y==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.A("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const u=this.getRenderableIds();for(let b=0;b<u.length;b++){const T=u[b];if(o.neighboringTiles&&o.neighboringTiles[T]){const C=this.getTileByID(T);y(o,C),y(C,o)}}function y(b,T){if(!b.dem||b.dem.borderReady)return;b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0;let C=T.tileID.canonical.x-b.tileID.canonical.x;const I=T.tileID.canonical.y-b.tileID.canonical.y,L=Math.pow(2,b.tileID.canonical.z),F=T.tileID.key;C===0&&I===0||Math.abs(I)>1||(Math.abs(C)>1&&(Math.abs(C+L)===1?C+=L:Math.abs(C-L)===1&&(C-=L)),T.dem&&b.dem&&(b.dem.backfillBorder(T.dem,C,I),b.neighboringTiles&&b.neighboringTiles[F]&&(b.neighboringTiles[F].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,y,b){for(const T in this._tiles){let C=this._tiles[T];if(b[T]||!C.hasData()||C.tileID.overscaledZ<=u||C.tileID.overscaledZ>y)continue;let I=C.tileID;for(;C&&C.tileID.overscaledZ>u+1;){const F=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[F.key],C&&C.hasData()&&(I=F)}let L=I;for(;L.overscaledZ>u;)if(L=L.scaledTo(L.overscaledZ-1),o[L.key]){b[I.key]=I;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=u?y:null}for(let y=o.overscaledZ-1;y>=u;y--){const b=o.scaledTo(y),T=this._getLoadedTile(b);if(T)return T}}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,u){u=u||this._source.tileSize;const y=Math.ceil(o.width/u)+1,b=Math.ceil(o.height/u)+1,T=Math.floor(y*b*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,T):T,I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(I)}handleWrapJump(o){const u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){const y={};for(const b in this._tiles){const T=this._tiles[b];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+u),y[T.tileID.key]=T}this._tiles=y;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(+b,this._tiles[b])}}update(o,u,y,b,T){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(o,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const C=this._source.type==="batched-model";let I,L=this._source.maxzoom;const F=this.map&&this.map.painter?this.map.painter._terrain:null;if(F&&F.sourceCache===this&&F.attenuationRange()){const W=F.attenuationRange()[0],Q=Math.floor(W)-Math.log2(F.getDemUpscale());L>Q&&(L=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)I=o.getVisibleUnwrappedCoordinates(this._source.tileID).map((W=>new a.aM(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y)));else if(this.tileCoverLift!==0){const W=o.clone();W.tileCoverLift=this.tileCoverLift,I=W.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:C}),this._source.minzoom<=1&&o.projection.name==="globe"&&(I.push(new a.aM(1,0,1,0,0)),I.push(new a.aM(1,0,1,1,0)),I.push(new a.aM(1,0,1,0,1)),I.push(new a.aM(1,0,1,1,1)))}else if(I=o.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:C}),this._source.hasTile){const W=this._source.hasTile.bind(this._source);I=I.filter((Q=>W(Q)))}}else I=[];if(I.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Vl(this._source.type)){const W=o.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),Q=Math.min(W,this._source.maxzoom);if(C){const le=o.extendTileCover(I,Q);for(const oe of le)I.push(oe)}else if(T){const le=o.extendTileCoverToNearPlane(I,this.transform.getFrustum(Q),Q);for(const oe of le)I.push(oe)}else if(this.castsShadows&&b){const le=o.extendTileCover(I,Q,b);for(const oe of le)this._shadowCasterTiles[oe.key]=!0,I.push(oe)}}const U=this._updateRetainedTiles(I);if(Vl(this._source.type)&&I.length!==0){const W={},Q={},le=Object.keys(U);for(const ue of le){const de=U[ue],xe=this._tiles[ue];if(!xe||xe.fadeEndTime&&xe.fadeEndTime<=a.q.now())continue;const Te=this.findLoadedParent(de,Math.max(de.overscaledZ-Zo.maxOverzooming,this._source.minzoom));Te&&(this._addTile(Te.tileID),W[Te.tileID.key]=Te.tileID),Q[ue]=de}const oe=I[I.length-1].overscaledZ;for(const ue in this._tiles){const de=this._tiles[ue];if(U[ue]||!de.hasData())continue;let xe=de.tileID;for(;xe.overscaledZ>oe;){xe=xe.scaledTo(xe.overscaledZ-1);const Te=this._tiles[xe.key];if(Te&&Te.hasData()&&Q[xe.key]){U[ue]=de.tileID;break}}}for(const ue in W)U[ue]||(this._coveredTiles[ue]=!0,U[ue]=W[ue])}for(const W in U)this._tiles[W].clearFadeHold();const Y=a.bs(this._tiles,U);for(const W of Y){const Q=this._tiles[W];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const u={};if(o.length===0)return u;const y={},b=o.reduce(((F,U)=>Math.min(F,U.overscaledZ)),1/0),T=o[0].overscaledZ,C=Math.max(T-Zo.maxOverzooming,this._source.minzoom),I=Math.max(T+Zo.maxUnderzooming,this._source.minzoom),L={};for(const F of o){const U=this._addTile(F);u[F.key]=F,U.hasData()||b<this._source.maxzoom&&(L[F.key]=F)}this._retainLoadedChildren(L,b,I,u);for(const F of o){let U=this._tiles[F.key];if(U.hasData())continue;if(F.canonical.z>=this._source.maxzoom){const W=F.children(this._source.maxzoom)[0],Q=this.getTile(W);if(Q&&Q.hasData()){u[W.key]=W;continue}}else{const W=F.children(this._source.maxzoom);if(u[W[0].key]&&u[W[1].key]&&u[W[2].key]&&u[W[3].key])continue}let Y=U.wasRequested();for(let W=F.overscaledZ-1;W>=C;--W){const Q=F.scaledTo(W);if(y[Q.key]||(y[Q.key]=!0,U=this.getTile(Q),!U&&Y&&(U=this._addTile(Q)),U&&(u[Q.key]=Q,Y=U.wasRequested(),U.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let y,b=this._tiles[o].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){y=this._loadedParentTiles[b.key];break}u.push(b.key);const T=b.scaledTo(b.overscaledZ-1);if(y=this._getLoadedTile(T),y)break;b=T}for(const T of u)this._loadedParentTiles[T]=y}}_addTile(o){let u=this._tiles[o.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const y=!!u;if(!y){const b=this.map?this.map.painter:null,T=this._source.tileSize*o.overscaleFactor();u=this._source.type==="raster-array"?new lh(o,T,this.transform.tileZoom,b,this._isRaster):new gs(o,T,this.transform.tileZoom,b,this._isRaster,this._source.worldview),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))}return u.uses++,this._tiles[o.key]=u,y||this._source.fire(new a.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const y=u.getExpiryTimeout();y&&(this._timers[o]=setTimeout((()=>{this._reloadTile(o,"expired"),delete this._timers[o]}),y))}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,u,y){const b=[],T=this.transform;if(!T)return b;const C=T.projection.name==="globe",I=a.aD(T.center.lng);for(const L in this._tiles){const F=this._tiles[L];if(y&&F.clearQueryDebugViz(),F.holdingForFade())continue;let U;if(C){const Y=F.tileID.canonical;if(Y.z===0){const W=[Math.abs(a.ay(I,...ul(Y,-1))-I),Math.abs(a.ay(I,...ul(Y,1))-I)];U=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(a.ay(I,...ul(Y,-1))-I),Math.abs(a.ay(I,...ul(Y,0))-I),Math.abs(a.ay(I,...ul(Y,1))-I)];U=[W.indexOf(Math.min(...W))-1]}}else U=[0];for(const Y of U){const W=o.containsTile(F,T,u,Y);W&&b.push(W)}}return b}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,u){const y=this.getRenderableIds(o,u).map((T=>this._tiles[T].tileID)),b=this.transform.projection.name==="globe";for(const T of y)T.projMatrix=this.transform.calculateProjMatrix(T.toUnwrapped()),T.expandedProjMatrix=b?this.transform.calculateProjMatrix(T.toUnwrapped(),!1,!0):T.projMatrix;return y}sortCoordinatesByDistance(o){const u=o.slice(),y=this.transform._camera.position,b=this.transform._camera.forward(),T={};for(const C of u){const I=1/(1<<C.canonical.z);T[C.key]=((C.canonical.x+.5)*I+C.wrap-y[0])*b[0]+((C.canonical.y+.5)*I-y[1])*b[1]-y[2]*b[2]}return u.sort(((C,I)=>T[C.key]-T[I.key])),u}hasTransition(){if(this._source.hasTransition())return!0;if(Vl(this._source.type))for(const o in this._tiles){const u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.q.now())return!0}return!1}setFeatureState(o,u,y){this._state.updateState(o=o||"_geojsonTileLayer",u,y)}removeFeatureState(o,u,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,y)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,y){const b=this._tiles[o];b&&b.setDependencies(u,y)}reloadTilesForDependencies(o,u){for(const y in this._tiles)this._tiles[y].hasDependency(o,u)&&this._reloadTile(+y,"reloading");this._cache.filter((y=>!y.hasDependency(o,u)))}_preloadTiles(o,u){if(!this._sourceLoaded){const L=()=>{this._sourceLoaded&&(this._source.off("data",L),this._preloadTiles(o,u))};return void this._source.on("data",L)}const y=new Map,b=Array.isArray(o)?o:[o],T=this.map.painter.terrain,C=this.usedForTerrain&&T?T.getScaledDemTileSize():this._source.tileSize;for(const L of b){const F=L.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const U of F)y.set(U.key,U);this.usedForTerrain&&L.updateElevation(!1)}const I=Array.from(y.values());a.bt(I,((L,F)=>{const U=new gs(L,this._source.tileSize*L.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(U,(Y=>{this._source.type==="raster-dem"&&U.dem&&this._backfillDEM(U),F(Y,U)}))}),u)}}function Fl(g,o){const u=Math.abs(2*g.wrap)-+(g.wrap<0),y=Math.abs(2*o.wrap)-+(o.wrap<0);return g.overscaledZ-o.overscaledZ||y-u||o.canonical.y-g.canonical.y||o.canonical.x-g.canonical.x}function Vl(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function ul(g,o){const u=1<<g.z;return[g.x/u+o,(g.x+1)/u+o]}Zo.maxOverzooming=10,Zo.maxUnderzooming=3;class Tp{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,u=!1;for(const y in this.style._mergedLayers){const b=this.style._mergedLayers[y];if(b.type==="fill-extrusion"||b.type==="building")this.layers.push({layer:b,visible:o,visibilityChanged:u});else if(b.type==="model"){const T=this.style.getLayerSource(b);T&&T.type==="batched-model"&&this.layers.push({layer:b,visible:o,visibilityChanged:u})}}}onNewFrame(o){this.layersGotHidden=!1;for(const u of this.layers){const y=u.layer;let b=!1;y.type==="fill-extrusion"?b=!y.isHidden(o)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="building"?b=!y.isHidden(o)&&y.paint.get("building-opacity")>0:y.type==="model"&&(b=!y.isHidden(o)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!b&&u.visible,u.visible=b}}updateZOffset(o,u){this.currentBuildingBuckets=[];for(const b of this.layers){const T=b.layer,C=this.style.getLayerSourceCache(T);let I=1;T.type==="fill-extrusion"?I=b.visible?T.paint.get("fill-extrusion-vertical-scale"):0:T.type==="building"&&(I=b.visible?T.paint.get("building-vertical-scale"):0);let L=C?C.getTile(u):null;if(!L&&C)for(const F in C._tiles){const U=C._tiles[F];if(u.canonical.isChildOf(U.tileID.canonical)){L=U;break}}this.currentBuildingBuckets.push({bucket:L?L.getBucket(T):null,tileID:L?L.tileID:u,verticalScale:I})}o.hasAnyZOffset=!1;let y=!1;for(let b=0;b<o.symbolInstances.length;b++){const T=o.symbolInstances.get(b),C=T.zOffset,I=this._getHeightAtTileOffset(u,T.tileAnchorX,T.tileAnchorY);T.zOffset=I!==Number.NEGATIVE_INFINITY?I:C,y||C===T.zOffset||(y=!0),o.hasAnyZOffset||T.zOffset===0||(o.hasAnyZOffset=!0)}y&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,u,y,b){let T=u,C=y;if(o.canonical.z!==b.canonical.z){const I=b.canonical,L=1/(1<<o.canonical.z-I.z);T=(u+o.canonical.x*a.aj)*L-I.x*a.aj|0,C=(y+o.canonical.y*a.aj)*L-I.y*a.aj|0}return{tileX:T,tileY:C}}_getHeightAtTileOffset(o,u,y){let b,T;for(let C=0;C<this.layers.length;++C){const I=this.layers[C].layer;if(I.type!=="fill-extrusion"&&I.type!=="building")continue;const{bucket:L,tileID:F,verticalScale:U}=this.currentBuildingBuckets[C];if(!L)continue;const{tileX:Y,tileY:W}=this._mapCoordToOverlappingTile(o,u,y,F),Q=L.getHeightAtTileCoord(Y,W);Q&&Q.height!==void 0&&(Q.hidden?b=Q.height:T=Math.max(Q.height*U,T||0))}if(T!==void 0)return T;for(let C=0;C<this.layers.length;++C){const I=this.layers[C];if(I.layer.type!=="model"||!I.visible)continue;const{bucket:L,tileID:F}=this.currentBuildingBuckets[C];if(!L)continue;const{tileX:U,tileY:Y}=this._mapCoordToOverlappingTile(o,u,y,F),W=L.getHeightAtTileCoord(U,Y);if(W&&!W.hidden)return W.height===void 0&&b!==void 0?Math.min(W.maxHeight,b)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function af(g,o){const u={};for(const y in g)y!=="ref"&&(u[y]=g[y]);return a.bu.forEach((y=>{y in o&&(u[y]=o[y])})),u}function uh(g){g=g.slice();const o=Object.create(null);for(let u=0;u<g.length;u++)o[g[u].id]=g[u];for(let u=0;u<g.length;u++)"ref"in g[u]&&(g[u]=af(g[u],o[g[u].ref]));return g}const Fr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function hl(g,o,u){u.push({command:Fr.addSource,args:[g,o[g]]})}function jc(g,o,u){o.push({command:Fr.removeSource,args:[g]}),u[g]=!0}function pc(g,o,u,y){jc(g,u,y),hl(g,o,u)}function Bc(g,o,u){let y;for(y in g[u])if(g[u].hasOwnProperty(y)&&y!=="data"&&!a.bv(g[u][y],o[u][y]))return!1;for(y in o[u])if(o[u].hasOwnProperty(y)&&y!=="data"&&!a.bv(g[u][y],o[u][y]))return!1;return!0}function pu(g,o,u,y,b,T){let C;for(C in o=o||{},g=g||{})g.hasOwnProperty(C)&&(a.bv(g[C],o[C])||u.push({command:T,args:[y,C,o[C],b]}));for(C in o)o.hasOwnProperty(C)&&!g.hasOwnProperty(C)&&(a.bv(g[C],o[C])||u.push({command:T,args:[y,C,o[C],b]}))}function Al(g){return g.id}function mc(g,o){return g[o.id]=o,g}function Fc(g,o,u){const y=o.createTileMatrix(g,g.worldSize,u.toUnwrapped());return a.az(new Float32Array(16),g.projMatrix,y)}function di(g,o,u){if(o.projection.name===u.projection.name)return g.projMatrix;const y=u.clone();return y.setProjection(o.projection),Fc(y,o.getProjection(),g)}function mu(g,o,u){return o.name===u.projection.name?g.projMatrix:Fc(u,o,g)}class jo{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.ay(o,0,1);let u=1,y=this._distances[u];const b=o*this.paddedLength+this.padding;for(;y<b&&u<this._distances.length;)y=this._distances[++u];const T=u-1,C=this._distances[T],I=y-C,L=I>0?(b-C)/I:0;return this.points[T].mult(1-L).add(this.points[u].mult(L))}}class dl{constructor(o,u,y){const b=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(o/y),this.yCellCount=Math.ceil(u/y);for(let C=0;C<this.xCellCount*this.yCellCount;C++)b.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,y,b,T){this._forEachCell(u,y,b,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(y),this.bboxes.push(b),this.bboxes.push(T)}insertCircle(o,u,y,b){this._forEachCell(u-b,y-b,u+b,y+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(y),this.circles.push(b)}_insertBoxCell(o,u,y,b,T,C){this.boxCells[T].push(C)}_insertCircleCell(o,u,y,b,T,C){this.circleCells[T].push(C)}_query(o,u,y,b,T,C){if(y<0||o>this.width||b<0||u>this.height)return!T&&[];const I=[];if(o<=0&&u<=0&&this.width<=y&&this.height<=b){if(T)return!0;for(let L=0;L<this.boxKeys.length;L++)I.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const F=this.circles[3*L],U=this.circles[3*L+1],Y=this.circles[3*L+2];I.push({key:this.circleKeys[L],x1:F-Y,y1:U-Y,x2:F+Y,y2:U+Y})}return C?I.filter(C):I}return this._forEachCell(o,u,y,b,this._queryCell,I,{hitTest:T,seenUids:{box:{},circle:{}}},C),T?I.length>0:I}_queryCircle(o,u,y,b,T){const C=o-y,I=o+y,L=u-y,F=u+y;if(I<0||C>this.width||F<0||L>this.height)return!b&&[];const U=[];return this._forEachCell(C,L,I,F,this._queryCellCircle,U,{hitTest:b,circle:{x:o,y:u,radius:y},seenUids:{box:{},circle:{}}},T),b?U.length>0:U}query(o,u,y,b,T){return this._query(o,u,y,b,!1,T)}hitTest(o,u,y,b,T){return this._query(o,u,y,b,!0,T)}hitTestCircle(o,u,y,b){return this._queryCircle(o,u,y,!0,b)}_queryCell(o,u,y,b,T,C,I,L){const F=I.seenUids,U=this.boxCells[T];if(U!==null){const W=this.bboxes;for(const Q of U)if(!F.box[Q]){F.box[Q]=!0;const le=4*Q;if(o<=W[le+2]&&u<=W[le+3]&&y>=W[le+0]&&b>=W[le+1]&&(!L||L(this.boxKeys[Q]))){if(I.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[Q],x1:W[le],y1:W[le+1],x2:W[le+2],y2:W[le+3]})}}}const Y=this.circleCells[T];if(Y!==null){const W=this.circles;for(const Q of Y)if(!F.circle[Q]){F.circle[Q]=!0;const le=3*Q;if(this._circleAndRectCollide(W[le],W[le+1],W[le+2],o,u,y,b)&&(!L||L(this.circleKeys[Q]))){if(I.hitTest)return C.push(!0),!0;{const oe=W[le],ue=W[le+1],de=W[le+2];C.push({key:this.circleKeys[Q],x1:oe-de,y1:ue-de,x2:oe+de,y2:ue+de})}}}}}_queryCellCircle(o,u,y,b,T,C,I,L){const F=I.circle,U=I.seenUids,Y=this.boxCells[T];if(Y!==null){const Q=this.bboxes;for(const le of Y)if(!U.box[le]){U.box[le]=!0;const oe=4*le;if(this._circleAndRectCollide(F.x,F.y,F.radius,Q[oe+0],Q[oe+1],Q[oe+2],Q[oe+3])&&(!L||L(this.boxKeys[le])))return C.push(!0),!0}}const W=this.circleCells[T];if(W!==null){const Q=this.circles;for(const le of W)if(!U.circle[le]){U.circle[le]=!0;const oe=3*le;if(this._circlesCollide(Q[oe],Q[oe+1],Q[oe+2],F.x,F.y,F.radius)&&(!L||L(this.circleKeys[le])))return C.push(!0),!0}}}_forEachCell(o,u,y,b,T,C,I,L){const F=this._convertToXCellCoord(o),U=this._convertToYCellCoord(u),Y=this._convertToXCellCoord(y),W=this._convertToYCellCoord(b);for(let Q=F;Q<=Y;Q++)for(let le=U;le<=W;le++)if(T.call(this,o,u,y,b,this.xCellCount*le+Q,C,I,L))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,y,b,T,C){const I=b-o,L=T-u,F=y+C;return F*F>I*I+L*L}_circleAndRectCollide(o,u,y,b,T,C,I){const L=(C-b)/2,F=Math.abs(o-(b+L));if(F>L+y)return!1;const U=(I-T)/2,Y=Math.abs(u-(T+U));if(Y>U+y)return!1;if(F<=L||Y<=U)return!0;const W=F-L,Q=Y-U;return W*W+Q*Q<=y*y}}const Ul={unknown:0,flipRequired:1,flipNotRequired:2},gu=Math.tan(85*Math.PI/180);function ad(g,o,u,y,b,T,C){const I=a.bz();if(u)if(T.name==="globe"){const L=a.bA(b,o);a.az(I,I,L)}else{const L=a.bB([],C);I[0]=L[0],I[1]=L[1],I[4]=L[2],I[5]=L[3],y||a.by(I,I,b.angle)}else a.az(I,b.labelPlaneMatrix,g);return I}function Vc(g,o,u,y,b,T,C){const I=ad(g,o,u,y,b,T,C);return T.name==="globe"&&u||(I[2]=I[6]=I[10]=I[14]=0),I}function Cl(g,o,u,y,b,T,C){if(u){if(T.name==="globe"){const I=ad(g,o,u,y,b,T,C);return a.bi(I,I),a.az(I,g,I),I}{const I=a.bw(g),L=a.bx([]);return L[0]=C[0],L[1]=C[1],L[4]=C[2],L[5]=C[3],a.az(I,I,L),y||a.by(I,I,-b.angle),I}}return b.glCoordMatrix}function Yo(g,o,u,y){const b=[g,o,u,1];u?a.aA(b,b,y):Jm(b,b,y);const T=b[3];return b[0]/=T,b[1]/=T,b[2]/=T,b}function hh(g,o){return Math.min(.5+g/o*.5,1.5)}function Ep(g,o){const u=g[0]/g[3],y=g[1]/g[3];return u>=-o[0]&&u<=o[0]&&y>=-o[1]&&y<=o[1]}function yu(g,o,u,y,b,T,C,I,L,F){const U=u.transform,Y=y?g.textSizeData:g.iconSizeData,W=a.bH(Y,u.transform.zoom),Q=U.projection.name==="globe",le=[256/u.width*2+1,256/u.height*2+1],oe=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;oe.clear();let ue=null;Q&&(ue=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const de=g.lineVertexArray,xe=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,Te=u.transform.width/u.transform.height;let Me,ke=!1;for(let Fe=0;Fe<xe.length;Fe++){const Ve=xe.get(Fe),{numGlyphs:Le,writingMode:Ne}=Ve;if(Ne!==a.bI.vertical||ke||Me===a.bI.horizontal||(ke=!0),Me=Ne,(Ve.hidden||Ne===a.bI.vertical)&&!ke){fh(Le,oe);continue}ke=!1;const je=new a.P(Ve.tileAnchorX,Ve.tileAnchorY);let{x:dt,y:Ze,z:Pt}=U.projection.projectTilePoint(je.x,je.y,F.canonical);if(L){const[gn,Dn,xn]=L(je);dt+=gn,Ze+=Dn,Pt+=xn}const _t=[dt,Ze,Pt,1];if(a.aA(_t,_t,o),!Ep(_t,le)){fh(Le,oe);continue}const Lt=_t[3],rn=hh(u.transform.getCameraToCenterDistance(U.projection),Lt),ft=a.bJ(Y,W,Ve),We=C?ft/rn:ft*rn,Tt=Yo(dt,Ze,Pt,b);if(Tt[3]<=0){fh(Le,oe);continue}let mt={};const It=a.al(g.layers[0].layout.get("text-max-angle")),Nt=Math.cos(It),Rt=C?null:L,Ft=dh(Ve,We,!1,I,o,b,T,g.glyphOffsetArray,de,oe,ue,Tt,je,mt,Te,Rt,U.projection,F,C,Nt);ke=Ft.useVertical,Rt&&Ft.needsFlipping&&(mt={}),(Ft.notEnoughRoom||ke||Ft.needsFlipping&&dh(Ve,We,!0,I,o,b,T,g.glyphOffsetArray,de,oe,ue,Tt,je,mt,Te,Rt,U.projection,F,C,Nt).notEnoughRoom)&&fh(Le,oe)}y?(g.text.dynamicLayoutVertexBuffer.updateData(oe),ue&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(ue)):(g.icon.dynamicLayoutVertexBuffer.updateData(oe),ue&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(ue))}function Ms(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue){const{lineStartIndex:de,glyphStartIndex:xe,segment:Te}=I,Me=xe+I.numGlyphs,ke=de+I.lineLength,Fe=o.getoffsetX(xe),Ve=o.getoffsetX(Me-1),Le=od(g*Fe,u,y,b,T,C,Te,de,ke,L,F,U,Y,W,!0,Q,le,oe,ue);if(!Le)return null;const Ne=od(g*Ve,u,y,b,T,C,Te,de,ke,L,F,U,Y,W,!0,Q,le,oe,ue);return Ne?{first:Le,last:Ne}:null}function Km(g,o,u,y){return g===a.bI.horizontal&&Math.abs(y)>Math.abs(u)?{useVertical:!0}:g===a.bI.vertical?y>0?{needsFlipping:!0}:null:o!==Ul.unknown&&(function(b,T){return b===0||Math.abs(T/b)>gu})(u,y)?o===Ul.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function dh(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de,xe,Te){const Me=o/24,ke=g.lineOffsetX*Me,Fe=g.lineOffsetY*Me,{lineStartIndex:Ve,glyphStartIndex:Le,numGlyphs:Ne,segment:je,writingMode:dt,flipState:Ze}=g,Pt=Ve+g.lineLength,_t=Lt=>{if(U){const[Tt,mt,It]=Lt.up,Nt=F.length;a.bK(U,Nt+0,Tt,mt,It),a.bK(U,Nt+1,Tt,mt,It),a.bK(U,Nt+2,Tt,mt,It),a.bK(U,Nt+3,Tt,mt,It)}const[rn,ft,We]=Lt.point;a.bL(F,rn,ft,We,Lt.angle)};if(Ne>1){const Lt=Ms(Me,I,ke,Fe,u,Y,W,g,L,T,Q,oe,!1,ue,de,xe,Te);if(!Lt)return{notEnoughRoom:!0};if(y&&!u){let[rn,ft,We]=Lt.first.point,[Tt,mt,It]=Lt.last.point;[rn,ft]=Yo(rn,ft,We,C),[Tt,mt]=Yo(Tt,mt,It,C);const Nt=Km(dt,Ze,(Tt-rn)*le,mt-ft);if(g.flipState=Nt&&Nt.needsFlipping?Ul.flipRequired:Ul.flipNotRequired,Nt)return Nt}_t(Lt.first);for(let rn=Le+1;rn<Le+Ne-1;rn++){const ft=od(Me*I.getoffsetX(rn),ke,Fe,u,Y,W,je,Ve,Pt,L,T,Q,oe,!1,!1,ue,de,xe,Te);if(!ft)return F.length-=4*(rn-Le),{notEnoughRoom:!0};_t(ft)}_t(Lt.last)}else{if(y&&!u){const rn=Yo(W.x,W.y,0,b),ft=Ve+je+1,We=new a.P(L.getx(ft),L.gety(ft)),Tt=Yo(We.x,We.y,0,b),mt=Tt[3]>0?Tt:pi(W,We,rn,1,b,void 0,ue,de.canonical),It=Km(dt,Ze,(mt[0]-rn[0])*le,mt[1]-rn[1]);if(g.flipState=It&&It.needsFlipping?Ul.flipRequired:Ul.flipNotRequired,It)return It}const Lt=od(Me*I.getoffsetX(Le),ke,Fe,u,Y,W,je,Ve,Pt,L,T,Q,oe,!1,!1,ue,de,xe,Te);if(!Lt)return{notEnoughRoom:!0};_t(Lt)}return{}}function Ap(g,o,u,y,b){const{x:T,y:C,z:I}=y.projectTilePoint(g.x,g.y,o);if(!b)return Yo(T,C,I,u);const[L,F,U]=b(g);return Yo(T+L,C+F,I+U,u)}function pi(g,o,u,y,b,T,C,I){const L=Ap(g.sub(o)._unit()._add(g),I,b,C,T);return a.at(L,u,L),a.au(L,L),a.bE(L,u,L,y)}function od(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de,xe){const Te=y?g-o:g+o;let Me=Te>0?1:-1,ke=0;y&&(Me*=-1,ke=Math.PI),Me<0&&(ke+=Math.PI);let Fe=I+C+(Me>0?0:1)|0,Ve=b,Le=b,Ne=0,je=0;const dt=Math.abs(Te),Ze=[],Pt=[];let _t=T,Lt=_t,rn=a.bC([]);const ft=()=>pi(Lt,_t,Le,dt-Ne+1,U,W,oe,ue.canonical);for(;Ne+je<=dt;){if(Fe+=Me,Fe<I||Fe>=L)return null;if(Le=Ve,Lt=_t,Ze.push(Le),Q&&Pt.push(Lt),_t=new a.P(F.getx(Fe),F.gety(Fe)),Ve=Y[Fe],!Ve){const xn=Ap(_t,ue.canonical,U,oe,W);Ve=xn[3]>0?Y[Fe]=xn:ft()}Ne+=je;const gn=a.at([],Ve,Le),Dn=a.bD(Le,Ve);if(u&&Dn>0&&je>0&&a.bG(rn,gn)/(je*Dn)<xe)return null;je=Dn,rn=gn}le&&W&&(Y[Fe]&&(Ve=ft(),je=a.bD(Le,Ve),rn=a.at([],Ve,Le)),Y[Fe]=Ve);const We=(dt-Ne)/je,Tt=_t.sub(Lt)._mult(We)._add(Lt),mt=a.bE([],Le,rn,We);let It=[0,0,1],Nt=rn[0],Rt=rn[1];if(de&&(It=oe.upVector(ue.canonical,Tt.x,Tt.y),It[0]!==0||It[1]!==0||It[2]!==1)){const gn=[It[2],0,-It[0]],Dn=a.bF([],It,gn);a.au(gn,gn),a.au(Dn,Dn),Nt=a.bG(rn,gn),Rt=a.bG(rn,Dn)}if(u){const gn=a.bF([],It,rn);a.au(gn,gn),a.bE(mt,mt,gn,u*Me)}const Ft=ke+Math.atan2(Rt,Nt);return Ze.push(mt),Q&&Pt.push(Tt),{point:mt,angle:Ft,path:Ze,tilePath:Pt,up:It}}function fh(g,o){const u=o.length,y=u+4*g;o.resize(y),o.float32.fill(-1/0,4*u,4*y)}function Jm(g,o,u){const y=o[0],b=o[1];return g[0]=u[0]*y+u[4]*b+u[12],g[1]=u[1]*y+u[5]*b+u[13],g[3]=u[3]*y+u[7]*b+u[15],g}const Gn=100;class Qm{constructor(o,u,y=new dl(o.width+200,o.height+200,25),b=new dl(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=b,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Gn,this.screenBottomBoundary=o.height+Gn,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=u}placeCollisionBox(o,u,y,b,T,C,I,L,F,U,Y){let W=y.projectedAnchorX,Q=y.projectedAnchorY,le=y.projectedAnchorZ;const oe=y.tileAnchorX,ue=y.tileAnchorY,de=y.elevation,xe=y.tileID,Te=o.getProjection();if(de&&xe){const[Pt,_t,Lt]=Te.upVector(xe.canonical,y.tileAnchorX,y.tileAnchorY),rn=Te.upVectorScale(xe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=Pt*de*rn,Q+=_t*de*rn,le+=Lt*de*rn}const Me=o.projection.name==="globe",ke=o.projection.name==="globe"?a.ah(this.transform.zoom):0;if(xe&&Me&&ke<1&&!C){const Pt=1<<xe.canonical.z,_t=a.bM(oe,ue);a.bN(_t,_t,1/a.aj),a.bO(_t,_t,a.bM(xe.canonical.x,xe.canonical.y)),a.bN(_t,_t,1/Pt),a.bP(_t,_t,a.bM(b[0],b[1])),_t[0]=a.bQ(_t[0],-.5,.5),a.bN(_t,_t,a.aj);const Lt=a.bR(_t[0],_t[1],a.aj/(2*Math.PI),1);a.aA(Lt,Lt,T),W=a.ai(W,Lt[0],ke),Q=a.ai(Q,Lt[1],ke),le=a.ai(le,Lt[2],ke)}const Fe=this.projectAndGetPerspectiveRatio(U,W,Q,le,y.tileID,Te.name==="globe"||!!de||this.transform.pitch>0,Te),Ve=F*Fe.perspectiveRatio,Le=(y.x1*u+I.x-y.padding)*Ve+Fe.point.x,Ne=(y.y1*u+I.y-y.padding)*Ve+Fe.point.y,je=(y.x2*u+I.x+y.padding)*Ve+Fe.point.x,dt=(y.y2*u+I.y+y.padding)*Ve+Fe.point.y,Ze=Fe.perspectiveRatio<=.55||Fe.occluded;return!this.isInsideGrid(Le,Ne,je,dt)||!L&&this.grid.hitTest(Le,Ne,je,dt,Y)||Ze?{box:[],offscreen:!1,occluded:Fe.occluded}:{box:[Le,Ne,je,dt],offscreen:this.isOffscreen(Le,Ne,je,dt),occluded:!1}}placeCollisionCircles(o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe){const ue=[],de=this.transform.elevation,xe=o.getProjection(),Te=de?de.getAtTileOffsetFunc(oe,this.transform.center.lat,this.transform.worldSize,xe):null,Me=new a.P(y.tileAnchorX,y.tileAnchorY);let{x:ke,y:Fe,z:Ve}=xe.projectTilePoint(Me.x,Me.y,oe.canonical);if(Te){const[It,Nt,Rt]=Te(Me);ke+=It,Fe+=Nt,Ve+=Rt}const Le=xe.name==="globe",Ne=this.projectAndGetPerspectiveRatio(I,ke,Fe,Ve,oe,Le||!!de||this.transform.pitch>0,xe),{perspectiveRatio:je}=Ne,dt=(Y?C/je:C*je)/a.bU,Ze=Yo(ke,Fe,Ve,L),Pt=y.lineOffsetX*dt,_t=y.lineOffsetY*dt,Lt=a.al(o.layers[0].layout.get("text-max-angle")),rn=Math.cos(Lt),ft=Ne.signedDistanceFromCamera>0?Ms(dt,T,Pt,_t,!1,Ze,Me,y,b,L,{},de&&!Y?Te:null,Y&&!!de,xe,oe,Y,rn):null;let We=!1,Tt=!1,mt=!0;if(ft&&!Ne.occluded){const It=.5*Q*je+le,Nt=new a.P(-100,-100),Rt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Ft=new jo,{first:gn,last:Dn}=ft,xn=gn.path.length;let zn=[];for(let Zn=xn-1;Zn>=1;Zn--)zn.push(gn.path[Zn]);for(let Zn=1;Zn<Dn.path.length;Zn++)zn.push(Dn.path[Zn]);const Bn=2.5*It;F&&(zn=zn.map((([Zn,pr,$r],sr)=>(Te&&!Le&&($r=Te(sr<xn-1?gn.tilePath[xn-1-sr]:Dn.tilePath[sr-xn+2])[2]),Yo(Zn,pr,$r,F)))),zn.some((Zn=>Zn[3]<=0))&&(zn=[]));let Kn=[];if(zn.length>0){let Zn=1/0,pr=-1/0,$r=1/0,sr=-1/0;for(const kr of zn)Zn=Math.min(Zn,kr[0]),$r=Math.min($r,kr[1]),pr=Math.max(pr,kr[0]),sr=Math.max(sr,kr[1]);pr>=Nt.x&&Zn<=Rt.x&&sr>=Nt.y&&$r<=Rt.y&&(Kn=[zn.map((kr=>new a.P(kr[0],kr[1])))],(Zn<Nt.x||pr>Rt.x||$r<Nt.y||sr>Rt.y)&&(Kn=a.bS(Kn,Nt.x,Nt.y,Rt.x,Rt.y)))}for(const Zn of Kn){Ft.reset(Zn,.25*It);let pr=0;pr=Ft.length<=.5*It?1:Math.ceil(Ft.paddedLength/Bn)+1;for(let $r=0;$r<pr;$r++){const sr=$r/Math.max(pr-1,1),kr=Ft.lerp(sr),Yr=kr.x+Gn,wi=kr.y+Gn;ue.push(Yr,wi,It,0);const lr=Yr-It,ei=wi-It,ri=Yr+It,ai=wi+It;if(mt=mt&&this.isOffscreen(lr,ei,ri,ai),Tt=Tt||this.isInsideGrid(lr,ei,ri,ai),!u&&this.grid.hitTestCircle(Yr,wi,It,W)&&(We=!0,!U))return{circles:[],offscreen:!1,collisionDetected:We,occluded:!1}}}}return{circles:!U&&We||!Tt?[]:ue,offscreen:mt,collisionDetected:We,occluded:Ne.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let y=1/0,b=1/0,T=-1/0,C=-1/0;for(const U of o){const Y=new a.P(U.x+Gn,U.y+Gn);y=Math.min(y,Y.x),b=Math.min(b,Y.y),T=Math.max(T,Y.x),C=Math.max(C,Y.y),u.push(Y)}const I=this.grid.query(y,b,T,C).concat(this.ignoredGrid.query(y,b,T,C)),L={},F={};for(const U of I){const Y=U.key;if(L[Y.bucketInstanceId]===void 0&&(L[Y.bucketInstanceId]={}),L[Y.bucketInstanceId][Y.featureIndex])continue;const W=[new a.P(U.x1,U.y1),new a.P(U.x2,U.y1),new a.P(U.x2,U.y2),new a.P(U.x1,U.y2)];a.bT(u,W)&&(L[Y.bucketInstanceId][Y.featureIndex]=!0,F[Y.bucketInstanceId]===void 0&&(F[Y.bucketInstanceId]=[]),F[Y.bucketInstanceId].push(Y.featureIndex))}return F}insertCollisionBox(o,u,y,b,T){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:T},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,y,b,T){const C=u?this.ignoredGrid:this.grid,I={bucketInstanceId:y,featureIndex:b,collisionGroupID:T};for(let L=0;L<o.length;L+=4)C.insertCircle(I,o[L],o[L+1],o[L+2])}projectAndGetPerspectiveRatio(o,u,y,b,T,C,I){const L=[u,y,b,1];let F=!1;b||this.transform.pitch>0?(a.aA(L,L,o),this.fogState&&T&&I.name!=="globe"&&(F=(function(W,Q,le,oe,ue,de){const xe=de.calculateFogTileMatrix(ue),Te=[Q,le,oe];return a.ad(Te,Te,xe),Fn(W,a.ae(Te),de.pitch,de._fov)})(this.fogState,u,y,b,T.toUnwrapped(),this.transform)>.9)):Jm(L,L,o);const U=L[3];return{point:new a.P((L[0]/U+1)/2*this.transform.width+Gn,(-L[1]/U+1)/2*this.transform.height+Gn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/U*.5,1.5),signedDistanceFromCamera:U,occluded:C&&L[2]>U||F}}isOffscreen(o,u,y,b){return y<Gn||o>=this.screenRightBoundary||b<Gn||u>this.screenBottomBoundary}isInsideGrid(o,u,y,b){return y>=0&&o<this.gridRightBoundary&&b>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=a.bx([]);return a.bo(o,o,[-100,-100,0]),o}}class sd{constructor(o,u,y,b){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):b&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class _u{constructor(o,u,y,b,T,C=!1){this.text=new sd(o?o.text:null,u,y,T),this.icon=new sd(o?o.icon:null,u,b,T),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gs{constructor(o,u,y,b=!1){this.text=o,this.icon=u,this.skipFade=y,this.clipped=b}}class ld{constructor(){this.invProjMatrix=a.bz(),this.viewportMatrix=a.bz(),this.circles=[]}}class ph{constructor(o,u,y,b,T){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=y,this.bucketIndex=b,this.tileID=T}}class Vn{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:y=>y.collisionGroupID===u}}return this.collisionGroups[o]}}function fi(g,o,u,y,b){const{horizontalAlign:T,verticalAlign:C}=a.bZ(g),I=-(T-.5)*o,L=-(C-.5)*u,F=a.b_(g,y);return new a.P(I+F[0]*b,L+F[1]*b)}function xr(g,o,u,y,b){const T=new a.P(g,o);return u&&T._rotate(y?b:-b),T}class cs{constructor(o,u,y,b,T,C){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Qm(this.transform,T),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Vn(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,u,y,b,T=1){const C=y.getBucket(u),I=y.latestFeatureIndex;if(!C||!I||u.fqid!==C.layerIds[0])return;const L=C.layers[0].layout,F=C.layers[0].paint,U=y.collisionBoxArray,Y=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),W=y.tileSize/a.aj,Q=y.tileID.toUnwrapped();this.transform.setProjection(C.projection);const le=(oe=y.tileID,ue=C.getProjection(),de=this.transform,ue.name===this.projection?de.calculateProjMatrix(oe.toUnwrapped()):Fc(de,ue,oe));var oe,ue,de;const xe=L.get("text-pitch-alignment")==="map",Te=L.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const Me=u.dynamicFilter(),ke=u.dynamicFilterNeedsFeature(),Fe=this.transform.calculatePixelsToTileUnitsMatrix(y),Ve=Vc(le,y.tileID.canonical,xe,Te,this.transform,C.getProjection(),Fe);let Le=null;const Ne=C.getProjection().createInversionMatrix(this.transform,y.tileID.canonical);if(xe){const We=Cl(le,y.tileID.canonical,xe,Te,this.transform,C.getProjection(),Fe);Le=a.az([],this.transform.labelPlaneMatrix,We)}let je=null;Me&&y.latestFeatureIndex&&(je={unwrappedTileID:Q,dynamicFilter:Me,dynamicFilterNeedsFeature:ke}),this.retainedQueryData[C.bucketInstanceId]=new ph(C.bucketInstanceId,I,C.sourceLayerIndex,C.index,y.tileID);const[dt,Ze]=C.layers[0].layout.get("text-size-scale-range"),Pt=a.ay(T,dt,Ze),[_t,Lt]=L.get("icon-size-scale-range"),rn=a.ay(T,_t,Lt),ft={bucket:C,layout:L,paint:F,posMatrix:le,invMatrix:Ne,mercatorCenter:[a.aD(this.transform.center.lng),a.aH(this.transform.center.lat)],textLabelPlaneMatrix:Ve,labelToScreenMatrix:Le,clippingData:je,scale:Y,textPixelRatio:W,holdingForFade:y.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:a.bH(C.textSizeData,this.transform.zoom,Pt),partiallyEvaluatedIconSize:a.bH(C.iconSizeData,this.transform.zoom,rn),collisionGroup:this.collisionGroups.get(C.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(b)for(const We of C.sortKeyRanges){const{sortKey:Tt,symbolInstanceStart:mt,symbolInstanceEnd:It}=We;o.push({sortKey:Tt,symbolInstanceStart:mt,symbolInstanceEnd:It,parameters:ft})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:ft})}attemptAnchorPlacement(o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de,xe,Te,Me,ke){const{textOffset0:Fe,textOffset1:Ve,crossTileID:Le}=oe,Ne=[Fe,Ve],je=fi(o,C,I,Ne,L),dt=this.collisionIndex.placeCollisionBox(de,L,u,y,b,T,xr(je.x,je.y,F,U,this.transform.angle),le,Y,W,Q.predicate);if(Te){const Ze=de.getSymbolInstanceIconSize(ke,this.transform.zoom,oe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(de,Ze,Te,y,b,T,xr(je.x,je.y,F,U,this.transform.angle),le,Y,W,Q.predicate).box.length===0)return}if(dt.box.length>0){let Ze;return this.prevPlacement&&this.prevPlacement.variableOffsets[Le]&&this.prevPlacement.placements[Le]&&this.prevPlacement.placements[Le].text&&(Ze=this.prevPlacement.variableOffsets[Le].anchor),this.variableOffsets[Le]={textOffset:Ne,width:C,height:I,anchor:o,textScale:L,prevAnchor:Ze},this.markUsedJustification(de,o,oe,xe),de.allowVerticalPlacement&&(this.markUsedOrientation(de,xe,oe),this.placedOrientations[Le]=xe),{shift:je,placedGlyphBoxes:dt}}}placeLayerBucketPart(o,u,y,b,T=1){const{bucket:C,layout:I,paint:L,posMatrix:F,textLabelPlaneMatrix:U,labelToScreenMatrix:Y,clippingData:W,textPixelRatio:Q,mercatorCenter:le,invMatrix:oe,holdingForFade:ue,collisionBoxArray:de,partiallyEvaluatedTextSize:xe,partiallyEvaluatedIconSize:Te,collisionGroup:Me,latestFeatureIndex:ke}=o.parameters,Fe=I.get("text-optional"),Ve=I.get("icon-optional"),Le=I.get("text-allow-overlap"),Ne=I.get("icon-allow-overlap"),je=I.get("text-rotation-alignment")==="map",dt=I.get("icon-rotation-alignment")==="map",Ze=I.get("text-pitch-alignment")==="map",Pt=L.get("symbol-z-offset"),_t=I.get("symbol-elevation-reference")==="sea",Lt=I.get("symbol-placement"),[rn,ft]=I.get("text-size-scale-range"),[We,Tt]=I.get("icon-size-scale-range"),mt=a.ay(T,rn,ft),It=a.ay(T,We,Tt),Nt=I.get("text-variable-anchor"),Rt=je&&Lt!=="point",Ft=dt&&Lt!=="point",gn=Nt&&C.hasTextData(),Dn=C.hasIconTextFit()&&gn&&C.hasIconData();this.transform.setProjection(C.projection);const xn=gn||Rt,zn=Ft||Dn;let Bn=Le&&(Ne||!C.hasIconData()||Ve),Kn=Ne&&(Le||!C.hasTextData()||Fe);const Zn=!Pt.isConstant();!C.collisionArrays&&de&&C.deserializeCollisionBoxes(de),y&&b&&C.updateCollisionDebugBuffers(this.transform.zoom,de,mt,It);const pr=(sr,kr,Yr)=>{const{crossTileID:wi,numVerticalGlyphVertices:lr}=sr;let ei=null;if(W&&W.dynamicFilterNeedsFeature||Zn){const ma=this.retainedQueryData[C.bucketInstanceId];ei=ke.loadFeature({featureIndex:sr.featureIndex,bucketIndex:ma.bucketIndex,sourceLayerIndex:ma.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},ei,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new a.P(sr.tileAnchorX,sr.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[wi]=new Gs(!1,!1,!1,!0),void u.add(wi);const ri=Pt.evaluate(ei,{});if(u.has(wi))return;if(ue)return void(this.placements[wi]=new Gs(!1,!1,!1));let ai=!1,br=!1,oi=!0,Tr=!1,Li=!1,qr=null,ti={box:null,offscreen:null,occluded:null},Ai={box:null},Ca=null,Ma=null,wa=null,Co=0,po=0,bs=0;Yr.textFeatureIndex?Co=Yr.textFeatureIndex:sr.useRuntimeCollisionCircles&&(Co=sr.featureIndex),Yr.verticalTextFeatureIndex&&(po=Yr.verticalTextFeatureIndex);const qa=ma=>{ma.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const ca=this.transform.elevation;ma.elevation=_t?ri:ri+(ca?ca.getAtTileOffset(ma.tileID,ma.tileAnchorX,ma.tileAnchorY):0),ma.elevation+=sr.zOffset},ts=Yr.textBox;if(ts){qa(ts);const ma=Si=>{let Ka=a.bI.horizontal;if(C.allowVerticalPlacement&&!Si&&this.prevPlacement){const Io=this.prevPlacement.placedOrientations[wi];Io&&(this.placedOrientations[wi]=Io,Ka=Io,this.markUsedOrientation(C,Ka,sr))}return Ka},ca=(Si,Ka)=>{if(C.allowVerticalPlacement&&lr>0&&Yr.verticalTextBox){for(const Io of C.writingModes)if(Io===a.bI.vertical?(ti=Ka(),Ai=ti):ti=Si(),ti&&ti.box&&ti.box.length)break}else ti=Si()};if(Nt){let Si=Nt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[wi]){const Sa=this.prevPlacement.variableOffsets[wi];Si.indexOf(Sa.anchor)>0&&(Si=Si.filter((Js=>Js!==Sa.anchor)),Si.unshift(Sa.anchor))}const Ka=(Sa,Js,Uu)=>{const zh=C.getSymbolInstanceTextSize(xe,sr,this.transform.zoom,kr),Bf=(Sa.x2-Sa.x1)*zh+2*Sa.padding,Ff=(Sa.y2-Sa.y1)*zh+2*Sa.padding,vl=sr.hasIconTextFit&&!Ne?Js:null;vl&&qa(vl);let Mc={box:[],offscreen:!1,occluded:!1};const Pa=Le?2*Si.length:Si.length;for(let ks=0;ks<Pa;++ks){const jh=this.attemptAnchorPlacement(Si[ks%Si.length],Sa,le,oe,xn,Bf,Ff,zh,je,Ze,Q,F,Me,ks>=Si.length,sr,kr,C,Uu,vl,xe,Te);if(jh&&(Mc=jh.placedGlyphBoxes,Mc&&Mc.box&&Mc.box.length)){ai=!0,qr=jh.shift;break}}return Mc};ca((()=>Ka(ts,Yr.iconBox,a.bI.horizontal)),(()=>{const Sa=Yr.verticalTextBox;return Sa&&qa(Sa),C.allowVerticalPlacement&&!(ti&&ti.box&&ti.box.length)&&lr>0&&Sa?Ka(Sa,Yr.verticalIconBox,a.bI.vertical):{box:null,offscreen:null,occluded:null}})),ti&&(ai=ti.box,oi=ti.offscreen,Tr=ti.occluded);const Io=ma(!(!ti||!ti.box));if(!ai&&this.prevPlacement){const Sa=this.prevPlacement.variableOffsets[wi];Sa&&(this.variableOffsets[wi]=Sa,this.markUsedJustification(C,Sa.anchor,sr,Io))}}else{const Si=(Ka,Io)=>{const Sa=C.getSymbolInstanceTextSize(xe,sr,this.transform.zoom,kr,T),Js=this.collisionIndex.placeCollisionBox(C,Sa,Ka,le,oe,xn,new a.P(0,0),Le,Q,F,Me.predicate);return Js&&Js.box&&Js.box.length&&(this.markUsedOrientation(C,Io,sr),this.placedOrientations[wi]=Io),Js};ca((()=>Si(ts,a.bI.horizontal)),(()=>{const Ka=Yr.verticalTextBox;return C.allowVerticalPlacement&&lr>0&&Ka?(qa(Ka),Si(Ka,a.bI.vertical)):{box:null,offscreen:null,occluded:null}})),ma(!!(ti&&ti.box&&ti.box.length))}}if(Ca=ti,ai=Ca&&Ca.box&&Ca.box.length>0,oi=Ca&&Ca.offscreen,Tr=Ca&&Ca.occluded,sr.useRuntimeCollisionCircles){const ma=C.text.placedSymbolArray.get(sr.centerJustifiedTextSymbolIndex>=0?sr.centerJustifiedTextSymbolIndex:sr.verticalPlacedTextSymbolIndex),ca=a.bJ(C.textSizeData,xe,ma),Si=I.get("text-padding");Ma=this.collisionIndex.placeCollisionCircles(C,Le,ma,C.lineVertexArray,C.glyphOffsetArray,ca,F,U,Y,y,Ze,Me.predicate,sr.collisionCircleDiameter*ca/a.bU,Si,this.retainedQueryData[C.bucketInstanceId].tileID),ai=Le||Ma.circles.length>0&&!Ma.collisionDetected,oi=oi&&Ma.offscreen,Tr=Ma.occluded}if(Yr.iconFeatureIndex&&(bs=Yr.iconFeatureIndex),Yr.iconBox){const ma=ca=>{qa(ca);const Si=sr.hasIconTextFit&&qr?xr(qr.x,qr.y,je,Ze,this.transform.angle):new a.P(0,0),Ka=C.getSymbolInstanceIconSize(Te,this.transform.zoom,sr.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Ka,ca,le,oe,zn,Si,Ne,Q,F,Me.predicate)};Ai&&Ai.box&&Ai.box.length&&Yr.verticalIconBox?(wa=ma(Yr.verticalIconBox),br=wa.box.length>0):(wa=ma(Yr.iconBox),br=wa.box.length>0),oi=oi&&wa.offscreen,Li=wa.occluded}const _l=Fe||sr.numHorizontalGlyphVertices===0&&lr===0,nc=Ve||sr.numIconVertices===0;if(_l||nc?nc?_l||(br=br&&ai):ai=br&&ai:br=ai=br&&ai,ai&&Ca&&Ca.box&&this.collisionIndex.insertCollisionBox(Ca.box,I.get("text-ignore-placement"),C.bucketInstanceId,Ai&&Ai.box&&po?po:Co,Me.ID),br&&wa&&this.collisionIndex.insertCollisionBox(wa.box,I.get("icon-ignore-placement"),C.bucketInstanceId,bs,Me.ID),Ma&&(ai&&this.collisionIndex.insertCollisionCircles(Ma.circles,I.get("text-ignore-placement"),C.bucketInstanceId,Co,Me.ID),y)){const ma=C.bucketInstanceId;let ca=this.collisionCircleArrays[ma];ca===void 0&&(ca=this.collisionCircleArrays[ma]=new ld);for(let Si=0;Si<Ma.circles.length;Si+=4)ca.circles.push(Ma.circles[Si+0]),ca.circles.push(Ma.circles[Si+1]),ca.circles.push(Ma.circles[Si+2]),ca.circles.push(Ma.collisionDetected?1:0)}const Ya=C.projection.name!=="globe";Bn=Bn&&(Ya||!Tr),Kn=Kn&&(Ya||!Li),this.placements[wi]=new Gs(ai||Bn,br||Kn,oi||C.justReloaded),u.add(wi)},$r=this.retainedQueryData[C.bucketInstanceId].tileID;if(C.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(C,$r),C.elevationType==="road"&&C.updateRoadElevation($r.canonical),C.updateZOffset(),C.sortFeaturesByY){const sr=C.getSortedSymbolIndexes(this.transform.angle);for(let kr=sr.length-1;kr>=0;--kr){const Yr=sr[kr];pr(C.symbolInstances.get(Yr),Yr,C.collisionArrays[Yr])}C.hasAnyZOffset&&a.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const sr=C.getSortedIndexesByZOffset();for(let kr=0;kr<sr.length;++kr){const Yr=sr[kr];pr(C.symbolInstances.get(Yr),Yr,C.collisionArrays[Yr])}}else for(let sr=o.symbolInstanceStart;sr<o.symbolInstanceEnd;sr++)pr(C.symbolInstances.get(sr),sr,C.collisionArrays[sr]);if(y&&C.bucketInstanceId in this.collisionCircleArrays){const sr=this.collisionCircleArrays[C.bucketInstanceId];a.bi(sr.invProjMatrix,F),sr.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(o,u,y,b){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:L,crossTileID:F}=y,U=a.b$(u),Y=b===a.bI.vertical?L:U==="left"?T:U==="center"?C:U==="right"?I:-1;T>=0&&(o.text.placedSymbolArray.get(T).crossTileID=Y>=0&&T!==Y?0:F),C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=Y>=0&&C!==Y?0:F),I>=0&&(o.text.placedSymbolArray.get(I).crossTileID=Y>=0&&I!==Y?0:F),L>=0&&(o.text.placedSymbolArray.get(L).crossTileID=Y>=0&&L!==Y?0:F)}markUsedOrientation(o,u,y){const b=u===a.bI.horizontal||u===a.bI.horizontalOnly?u:0,T=u===a.bI.vertical?u:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:F}=y,U=o.text.placedSymbolArray;C>=0&&(U.get(C).placedOrientation=b),I>=0&&(U.get(I).placedOrientation=b),L>=0&&(U.get(L).placedOrientation=b),F>=0&&(U.get(F).placedOrientation=T)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let y=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const b=u?u.symbolFadeChange(o):1,T=u?u.opacities:{},C=u?u.variableOffsets:{},I=u?u.placedOrientations:{};for(const L in this.placements){const F=this.placements[L],U=T[L];U?(this.opacities[L]=new _u(U,b,F.text,F.icon,null,F.clipped),y=y||F.text!==U.text.placed||F.icon!==U.icon.placed):(this.opacities[L]=new _u(null,b,F.text,F.icon,F.skipFade,F.clipped),y=y||F.text||F.icon)}for(const L in T){const F=T[L];if(!this.opacities[L]){const U=new _u(F,b,!1,!1);U.isHidden()||(this.opacities[L]=U,y=y||F.text.placed||F.icon.placed)}}for(const L in C)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=C[L]);for(const L in I)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=I[L]);y?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u,y,b){const T=new Set;for(const C of u){const I=C.getBucket(o);I&&C.latestFeatureIndex&&o.fqid===I.layerIds[0]&&(this.updateBucketOpacities(I,T,C,C.collisionBoxArray,y,b,C.tileID,o.scope),I.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(I,C.tileID),I.elevationType==="road"&&I.updateRoadElevation(C.tileID.canonical),I.updateZOffset())}}updateBucketOpacities(o,u,y,b,T,C,I,L){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const F=o.layers[0].layout,U=o.layers[0].paint,Y=!!o.layers[0].dynamicFilter(),W=new _u(null,0,!1,!1,!0),Q=F.get("text-allow-overlap"),le=F.get("icon-allow-overlap"),oe=F.get("text-variable-anchor"),ue=F.get("text-rotation-alignment")==="map",de=F.get("text-pitch-alignment")==="map",xe=U.get("symbol-z-offset"),Te=F.get("symbol-elevation-reference")==="sea",Me=!xe.isConstant(),ke=new _u(null,0,Q&&(le||!o.hasIconData()||F.get("icon-optional")),le&&(Q||!o.hasTextData()||F.get("text-optional")),!0);!o.collisionArrays&&b&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(b);const Fe=(Le,Ne,je)=>{for(let dt=0;dt<Ne/4;dt++)Le.opacityVertexArray.emplaceBack(je)};let Ve=0;C&&o.updateReplacement(I,C);for(let Le=0;Le<o.symbolInstances.length;Le++){const Ne=o.symbolInstances.get(Le),{numHorizontalGlyphVertices:je,numVerticalGlyphVertices:dt,crossTileID:Ze,numIconVertices:Pt,tileAnchorX:_t,tileAnchorY:Lt}=Ne;let rn=null;const ft=this.retainedQueryData[o.bucketInstanceId];Me&&Ne&&ft&&(rn=y.latestFeatureIndex.loadFeature({featureIndex:Ne.featureIndex,bucketIndex:ft.bucketIndex,sourceLayerIndex:ft.sourceLayerIndex,layoutVertexArrayOffset:0}));const We=xe.evaluate(rn,{}),Tt=u.has(Ze);let mt=this.opacities[Ze];Tt?mt=W:mt||(mt=ke,this.opacities[Ze]=mt),u.add(Ze);const It=je>0||dt>0,Nt=Pt>0,Rt=this.placedOrientations[Ze],Ft=Rt===a.bI.vertical,gn=Rt===a.bI.horizontal||Rt===a.bI.horizontalOnly;!It&&!Nt||mt.isHidden()||Ve++;let Dn=!1;if((It||Nt)&&C)for(const xn of o.activeReplacements){if(a.bV(xn,T,a.bW.Symbol,L)||xn.min.x>_t||_t>xn.max.x||xn.min.y>Lt||Lt>xn.max.y)continue;const zn=a.bX(_t,Lt,I.canonical,xn.footprintTileId.canonical);if(Dn=a.bY(zn,xn.footprint),Dn)break}if(It){const xn=Dn?Vr:fr(mt.text);Fe(o.text,je,Ft?Vr:xn),Fe(o.text,dt,gn?Vr:xn);const zn=mt.text.isHidden(),{leftJustifiedTextSymbolIndex:Bn,centerJustifiedTextSymbolIndex:Kn,rightJustifiedTextSymbolIndex:Zn,verticalPlacedTextSymbolIndex:pr}=Ne,$r=o.text.placedSymbolArray,sr=zn||Ft?1:0;Bn>=0&&($r.get(Bn).hidden=sr),Kn>=0&&($r.get(Kn).hidden=sr),Zn>=0&&($r.get(Zn).hidden=sr),pr>=0&&($r.get(pr).hidden=zn||gn?1:0);const kr=this.variableOffsets[Ze];kr&&this.markUsedJustification(o,kr.anchor,Ne,Rt);const Yr=this.placedOrientations[Ze];Yr&&(this.markUsedJustification(o,"left",Ne,Yr),this.markUsedOrientation(o,Yr,Ne))}if(Nt){const xn=Dn?Vr:fr(mt.icon),{placedIconSymbolIndex:zn,verticalPlacedIconSymbolIndex:Bn}=Ne,Kn=o.icon.placedSymbolArray,Zn=mt.icon.isHidden()?1:0;zn>=0&&(Fe(o.icon,Pt,Ft?Vr:xn),Kn.get(zn).hidden=Zn),Bn>=0&&(Fe(o.icon,Ne.numVerticalIconVertices,gn?Vr:xn),Kn.get(Bn).hidden=Zn)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const xn=o.collisionArrays[Le];if(xn){let zn=new a.P(0,0),Bn=!0;if(xn.textBox||xn.verticalTextBox){if(oe){const Zn=this.variableOffsets[Ze];Zn?(zn=fi(Zn.anchor,Zn.width,Zn.height,Zn.textOffset,Zn.textScale),ue&&zn._rotate(de?this.transform.angle:-this.transform.angle)):Bn=!1}Y&&(Bn=!mt.clipped),xn.textBox&&gc(o.textCollisionBox.collisionVertexArray,mt.text.placed,!Bn||Ft,We,Te,zn.x,zn.y),xn.verticalTextBox&&gc(o.textCollisionBox.collisionVertexArray,mt.text.placed,!Bn||gn,We,Te,zn.x,zn.y)}const Kn=Bn&&!!(!gn&&xn.verticalIconBox);xn.iconBox&&gc(o.iconCollisionBox.collisionVertexArray,mt.icon.placed,Kn,We,Te,Ne.hasIconTextFit?zn.x:0,Ne.hasIconTextFit?zn.y:0),xn.verticalIconBox&&gc(o.iconCollisionBox.collisionVertexArray,mt.icon.placed,!Kn,We,Te,Ne.hasIconTextFit?zn.x:0,Ne.hasIconTextFit?zn.y:0)}}}if(o.fullyClipped=Ve===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const Le=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Le.invProjMatrix,o.placementViewportMatrix=Le.viewportMatrix,o.collisionCircleArray=Le.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const y=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*y>o}setStale(){this.stale=!0}}function gc(g,o,u,y,b,T,C){g.emplaceBack(o?1:0,u?1:0,T||0,C||0,y,b?1:0),g.emplaceBack(o?1:0,u?1:0,T||0,C||0,y,b?1:0),g.emplaceBack(o?1:0,u?1:0,T||0,C||0,y,b?1:0),g.emplaceBack(o?1:0,u?1:0,T||0,C||0,y,b?1:0)}const ge=Math.pow(2,25),ie=Math.pow(2,24),_e=Math.pow(2,17),Xe=Math.pow(2,16),lt=Math.pow(2,9),fn=Math.pow(2,8),Qn=Math.pow(2,1);function fr(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,u=Math.floor(127*g.opacity);return u*ge+o*ie+u*_e+o*Xe+u*lt+o*fn+u*Qn+o}const Vr=0;class Bi{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,u,y,b,T,C){const I=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(I,b,o[this._currentTileIndex],this._sortAcrossTiles,C),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort(((L,F)=>L.sortKey-F.sortKey)));this._currentPartIndex<I.length;){const L=I[this._currentPartIndex];if(u.placeLayerBucketPart(L,this._seenCrossTileIDs,y,L.symbolInstanceStart===0,C),this._currentPartIndex++,T())return!0}return!1}}class Zi{constructor(o,u,y,b,T,C,I,L,F){this.placement=new cs(o,T,C,I,L,F),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(o,u,y,b,T){const C=a.q.now(),I=()=>{const L=a.q.now()-C;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=u[o[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=F)&&(!L.maxzoom||L.maxzoom>F)){const U=L,Y=U.layout.get("symbol-z-elevate"),W=U.layout.get("symbol-sort-key").constantOr(1)!==void 0,Q=U.layout.get("symbol-z-order"),le=Q==="viewport-y"||Q==="auto"&&!(Q!=="viewport-y"&&W),oe=U.layout.get("text-allow-overlap")||U.layout.get("icon-allow-overlap")||U.layout.get("text-ignore-placement")||U.layout.get("icon-ignore-placement"),ue=le&&oe,de=this._inProgressLayer=this._inProgressLayer||new Bi(U),xe=a.C(L.source,L.scope);if(de.continuePlacement(Y||ue?b[xe]:y[xe],this.placement,this._showCollisionBoxes,L,I,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const za=512/a.aj/2;class Uc{constructor(o,u,y){this.tileID=o,this.bucketInstanceId=y,this.index=new a.c0(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=o.canonical.x*a.aj,T=o.canonical.y*a.aj;for(let C=0;C<u.length;C++){const{key:I,crossTileID:L,tileAnchorX:F,tileAnchorY:U}=u.get(C),Y=Math.floor((b+F)*za),W=Math.floor((T+U)*za);this.index.add(Y,W),this.keys.push(I),this.crossTileIDs.push(L)}this.index.finish()}findMatches(o,u,y){const b=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),T=za/Math.pow(2,u.canonical.z-this.tileID.canonical.z),C=u.canonical.x*a.aj,I=u.canonical.y*a.aj;for(let L=0;L<o.length;L++){const F=o.get(L);if(F.crossTileID)continue;const{key:U,tileAnchorX:Y,tileAnchorY:W}=F,Q=Math.floor((C+Y)*T),le=Math.floor((I+W)*T),oe=this.index.range(Q-b,le-b,Q+b,le+b).sort(((ue,de)=>ue-de));for(const ue of oe){const de=this.crossTileIDs[ue];if(this.keys[ue]===U&&!y.has(de)){y.add(de),F.crossTileID=de;break}}}}}class Ko{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ml{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(u!==0)for(const y in this.indexes){const b=this.indexes[y],T={};for(const C in b){const I=b[C];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+u),T[I.tileID.key]=I}this.indexes[y]=T}this.lng=o}addBucket(o,u,y){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let T=0;T<u.symbolInstances.length;T++)u.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const b=this.usedCrossTileIDs[o.overscaledZ];for(const T in this.indexes){const C=this.indexes[T];if(Number(T)>o.overscaledZ)for(const I in C){const L=C[I];L.tileID.isChildOf(o)&&L.findMatches(u.symbolInstances,o,b)}else{const I=C[o.scaledTo(Number(T)).key];I&&I.findMatches(u.symbolInstances,o,b)}}for(let T=0;T<u.symbolInstances.length;T++){const C=u.symbolInstances.get(T);C.crossTileID||(C.crossTileID=y.generate(),b.add(C.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Uc(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const y of u.crossTileIDs)this.usedCrossTileIDs[o].delete(y)}removeStaleBuckets(o){let u=!1;for(const y in this.indexes){const b=this.indexes[y];for(const T in b)o[b[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,b[T]),delete b[T],u=!0)}return u}}class wo{constructor(){this.layerIndexes={},this.crossTileIDs=new Ko,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,y,b){let T=this.layerIndexes[o.fqid];T===void 0&&(T=this.layerIndexes[o.fqid]=new Ml);let C=!1;const I={};b.name!=="globe"&&T.handleWrapJump(y);for(const L of u){const F=L.getBucket(o);F&&o.fqid===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(L.tileID,F,this.crossTileIDs)&&(C=!0),I[F.bucketInstanceId]=!0)}return T.removeStaleBuckets(I)&&(C=!0),C}pruneUnusedLayers(o){const u={};o.forEach((y=>{u[y]=!0}));for(const y in this.layerIndexes)u[y]||delete this.layerIndexes[y]}}const $c=771;class yr{constructor(o,u,y,b){this.blendFunction=o,this.blendColor=u.toNonPremultipliedRenderColor(null),this.mask=y,this.blendEquation=b}}yr.Replace=[1,0,1,0],yr.disabled=new yr(yr.Replace,a.am.transparent,[!1,!1,!1,!1]),yr.unblended=new yr(yr.Replace,a.am.transparent,[!0,!0,!0,!0]),yr.alphaBlended=new yr([1,$c,1,$c],a.am.transparent,[!0,!0,!0,!0]),yr.alphaBlendedNonPremultiplied=new yr([770,$c,770,$c],a.am.transparent,[!0,!0,!0,!0]),yr.multiply=new yr([774,0,774,0],a.am.transparent,[!0,!0,!0,!0]);class Tn{constructor(o,u,y){this.func=o,this.mask=u,this.range=y}}Tn.ReadOnly=!1,Tn.ReadWrite=!0,Tn.disabled=new Tn(519,Tn.ReadOnly,[0,1]);const Ws=7680;class er{constructor(o,u,y,b,T,C){this.test=o,this.ref=u,this.mask=y,this.fail=b,this.depthFail=T,this.pass=C}}er.disabled=new er({func:519,mask:0},0,0,Ws,Ws,Ws);const fa=1029,$l=2305;class Wn{constructor(o,u,y){this.enable=o,this.mode=u,this.frontFace=y}}function Pl(g,o){const u=a.c6(g,3);a.c8(g,o),a.cc(g,3,u)}function yc(g,o){const u=a.c3([]);return a.c4(u,u,-o),a.c5(u,u,-g),u}function ql(g,o){const u=[g[0],g[1],0],y=[o[0],o[1],0];if(a.ae(u)>=1e-15){const C=a.au([],u);a.c1(y,C,a.bG(y,C)),o[0]=y[0],o[1]=y[1]}const b=a.bF([],o,g);if(a.c2(b)<1e-15)return null;const T=Math.atan2(-b[1],b[0]);return yc(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),T)}Wn.disabled=new Wn(!1,fa,$l),Wn.backCCW=new Wn(!0,fa,$l),Wn.backCW=new Wn(!0,fa,2304),Wn.frontCW=new Wn(!0,1028,2304),Wn.frontCCW=new Wn(!0,1028,$l);class of{constructor(o,u){this.position=o,this.orientation=u}get position(){return this._position}set position(o){if(o){const u=o instanceof a.ac?o:new a.ac(o[0],o[1],o[2]);this._renderWorldCopies&&(u.x=a.bQ(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(o,u){if(this.orientation=null,!this.position)return;const y=this.position,b=this._elevation?this._elevation.getAtPointOrZero(a.ac.fromLngLat(o)):0,T=a.ac.fromLngLat(o,b),C=[T.x-y.x,T.y-y.y,T.z-y.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=ql(C,u)}setPitchBearing(o,u){this.orientation=yc(a.al(o),a.al(-u))}}class Ps{constructor(o,u){this._transform=a.bx([]),this.orientation=u,this.position=o}get mercatorPosition(){const o=this.position;return new a.ac(o[0],o[1],o[2])}get position(){const o=a.c6(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var u;o&&a.cc(this._transform,3,[(u=o)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||a.c3([]),o&&Pl(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,u){this._orientation=yc(o,u),Pl(this._transform,this._orientation)}forward(){const o=a.c6(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=a.c6(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=a.c6(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,u){const y=new Float64Array(16);return a.bi(y,this.getWorldToCamera(o,u)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,u,y){const b=this.position;a.c1(b,b,-o);const T=new Float64Array(16);return a.bn(T,[y,y,y]),a.bo(T,T,b),T[10]*=u,T}getWorldToCamera(o,u){const y=new Float64Array(16),b=new Float64Array(4),T=this.position;return a.c7(b,this._orientation),a.c1(T,T,-o),a.c8(y,b),a.bo(y,y,T),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=u,y[9]*=u,y[10]*=u,y[11]*=u,y}getCameraToClipPerspective(o,u,y,b){const T=new Float64Array(16);return a.c9(T,o,u,y,b),T}getCameraToClipOrthographic(o,u,y,b,T,C){const I=new Float64Array(16);return a.ca(I,o,u,y,b,T,C),I}getDistanceToElevation(o,u=!1){const y=o===0?0:a.cb(o,u?a.aY(this.position[1]):this.position[1]),b=this.forward();return(y-this.position[2])/b[2]}clone(){return new Ps([...this.position],[...this.orientation])}}const Jo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class mh{constructor(o=0,u=0,y=0,b=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(y)||y<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=y,this.right=b}interpolate(o,u,y){return u.top!=null&&o.top!=null&&(this.top=a.ai(o.top,u.top,y)),u.bottom!=null&&o.bottom!=null&&(this.bottom=a.ai(o.bottom,u.bottom,y)),u.left!=null&&o.left!=null&&(this.left=a.ai(o.left,u.left,y)),u.right!=null&&o.right!=null&&(this.right=a.ai(o.right,u.right,y)),this}getCenter(o,u){const y=a.ay((this.left+o-this.right)/2,0,o),b=a.ay((this.top+u-this.bottom)/2,0,u);return new a.P(y,b)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new mh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const no=15;class Cy{constructor(o,u,y,b,T,C,I){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=o||0,this._maxZoom=u||22,this._minPitch=y??0,this._maxPitch=b??60,this.setProjection(C),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new a.ci(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new mh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Ps,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const o=new Cy(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o._allowWorldUnderZoom=this._allowWorldUnderZoom,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<no}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,u=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(o||y)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return a.aF(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=a.cj(this.projectionOptions);const y=this.getProjection(),b=!a.bv(u,y);return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.cj({name:"mercator"});const u=o!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.cb(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bQ(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const u=-o*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=a.ck(),a.cl(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const u=a.ay(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=a.al(o),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const u=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const o=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(o)}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let b=0,T=0;for(let C=0;C<u.length;C++){const I=new a.P(u[C][0]*this.width,y+u[C][1]*(this.height-y)),L=o.pointCoordinate(I);if(!L)continue;const F=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);b+=L[3]*F,T+=F}return T===0?NaN:b/T}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*u,b=this._mercatorZfromZoom(o),T=this._mercatorZfromZoom(this._maxZoom),C=Math.max(b-y,T);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let y;y=o.z<this._camera.position[2]?[u.x,u.y,u.z]:[o.x,o.y,o.z];const b=a.ae(a.at([],this._camera.position,y));return a.ay(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let u=!1;if(o.orientation&&!a.cm(o.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(o.orientation)),o.position){const y=[o.position.x,o.position.y,o.position.z];a.cn(y,this._camera.position)||(this._setCameraPosition(y),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,u=new of;return u.position=new a.ac(o[0],o[1],o[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(o){if(!a.co(o))return!1;a.cp(o,o);const u=a.cq([],[0,0,-1],o),y=a.cq([],[0,-1,0],o);if(y[2]<0)return!1;const b=ql(u,y);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(o){const u=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;o[2]=a.ay(o[2],b/y,b/u),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,y){this._unmodified=!1,this._edgeInsets.interpolate(o,u,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const u=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(o){const u=[new a.cr(0,o)];if(this.renderWorldCopies){const y=this.pointCoordinate(new a.P(0,0)),b=this.pointCoordinate(new a.P(this.width,0)),T=this.pointCoordinate(new a.P(this.width,this.height)),C=this.pointCoordinate(new a.P(0,this.height)),I=Math.floor(Math.min(y.x,b.x,T.x,C.x)),L=Math.floor(Math.max(y.x,b.x,T.x,C.x)),F=1;for(let U=I-F;U<=L+F;U++)U!==0&&u.push(new a.cr(U,o))}return u}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,u,y){let b=[];const T=y!=null,C=!T;if(C&&this.zoom<u||T&&y[0]===0&&y[1]===0)return b;const I=new Set,L=(U,Y,W,Q,le)=>{const oe=a.cV(Y,U,W,Q,le);I.has(oe)||(b.push(new a.aM(U,Y,W,Q,le)),I.add(oe))};for(let U=0;U<o.length;U++){const Y=o[U];if(C&&Y.canonical.z!==u)continue;const W=Y.canonical,Q=Y.overscaledZ,le=Y.wrap,oe=1<<W.z,ue=W.x+1<oe,de=W.x>0,xe=W.y+1<oe,Te=W.y>0,Me=Y.wrap-(de?0:1),ke=Y.wrap+(ue?0:1),Fe=de?W.x-1:oe-1,Ve=ue?W.x+1:0;if(T)y[0]<0?(L(Q,ke,W.z,Ve,W.y),y[1]<0&&xe&&(L(Q,le,W.z,W.x,W.y+1),L(Q,ke,W.z,Ve,W.y+1)),y[1]>0&&Te&&(L(Q,le,W.z,W.x,W.y-1),L(Q,ke,W.z,Ve,W.y-1))):y[0]>0?(L(Q,Me,W.z,Fe,W.y),y[1]<0&&xe&&(L(Q,le,W.z,W.x,W.y+1),L(Q,Me,W.z,Fe,W.y+1)),y[1]>0&&Te&&(L(Q,le,W.z,W.x,W.y-1),L(Q,Me,W.z,Fe,W.y-1))):y[1]<0&&xe?L(Q,le,W.z,W.x,W.y+1):Te&&L(Q,le,W.z,W.x,W.y-1);else{const Le=Y.visibleQuadrants;1&Le&&(L(Q,Me,W.z,Fe,W.y),Te&&(L(Q,le,W.z,W.x,W.y-1),L(Q,Me,W.z,Fe,W.y-1))),2&Le&&(L(Q,ke,W.z,Ve,W.y),Te&&(L(Q,le,W.z,W.x,W.y-1),L(Q,ke,W.z,Ve,W.y-1))),4&Le&&(L(Q,Me,W.z,Fe,W.y),xe&&(L(Q,le,W.z,W.x,W.y+1),L(Q,Me,W.z,Fe,W.y+1))),8&Le&&(L(Q,ke,W.z,Ve,W.y),xe&&(L(Q,le,W.z,W.x,W.y+1),L(Q,ke,W.z,Ve,W.y+1)))}}const F=[];for(const U of b)b.some((Y=>U.isChildOf(Y)))||F.push(U);if(b=F.filter((U=>!o.some((Y=>!!(U.overscaledZ<u&&Y.isChildOf(U))||U.equals(Y)||U.isChildOf(Y))))),C){const U=1<<u,Y=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[U*Y.x,U*Y.y],Q=4,le=Q*Q;b=b.filter((oe=>{const ue=oe.canonical.x+.5-W[0],de=oe.canonical.y+.5-W[1];return ue*ue+de*de<le}))}return b}extendTileCoverToNearPlane(o,u,y){const b=[],T=new Set;for(const xe of o)T.add(xe.key);const C=(xe,Te,Me,ke,Fe)=>{const Ve=a.cV(Te,xe,Me,ke,Fe);T.has(Ve)||(b.push(new a.aM(xe,Te,Me,ke,Fe)),T.add(Ve))},I=o.reduce(((xe,Te)=>Math.max(xe,Te.overscaledZ)),y),L=1<<y,F=[new a.P(0,0),new a.P(a.aj,0),new a.P(a.aj,a.aj),new a.P(0,a.aj)],U=new a.P(0,0),Y=new a.P(0,0),W=(xe,Te)=>{const Me=Math.floor(xe[0]),ke=Math.floor(xe[1]),Fe=(xe[0]-Me)*a.aj,Ve=(xe[1]-ke)*a.aj,Le=Math.floor(Te[0]),Ne=Math.floor(Te[1]),je=(Te[0]-Le)*a.aj,dt=(Te[1]-Ne)*a.aj;for(let Ze=-1;Ze<=1;Ze++){const Pt=Me+Ze;if(!(Pt<0||Pt>=L)){U.x=Fe-Ze*a.aj,Y.x=je-(Pt-Le)*a.aj;for(let _t=-1;_t<=1;_t++){const Lt=ke+_t;U.y=Ve-_t*a.aj,Y.y=dt-(Lt-Ne)*a.aj,a.cW(U,Y,F)&&C(I,0,y,Pt,Lt)}}}},Q=u.points,le=Q[a.cs],oe=Q[a.ct],ue=this._projectToGround(le,Q[a.cu]),de=this._projectToGround(oe,Q[a.cv]);return W(le,ue),W(oe,de),b}_projectToGround(o,u){return a.cw(a.cx(),o,u,o[2]/(o[2]-u[2]))}coveringTiles(o){let u=this.coveringZoomLevel(o);const y=u,b=this.elevation&&this.elevation.exaggeration(),T=b&&!o.isTerrainDEM,C=this.projection.name==="mercator";if(o.minzoom!==void 0&&u<o.minzoom)return[];o.maxzoom!==void 0&&u>o.maxzoom&&(u=o.maxzoom);const I=this.locationCoordinate(this.center),L=this.center.lat,F=1<<u,U=[F*I.x,F*I.y,0],Y=this.projection.name==="globe",W=!Y,Q=a.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,W),le=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),oe=F*a.cb(1,this.center.lat),ue=this._camera.position[2]/a.cb(1,this.center.lat),de=[F*le.x,F*le.y,ue*(W?1:oe)],xe=Y||b,Te=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Me=this.isLODDisabled(!0)?u:0;let ke;if(this._elevation&&o.isTerrainDEM)ke=1e4*this._elevation.exaggeration();else if(this._elevation){const We=this._elevation.getMinMaxForVisibleTiles();ke=We?We.max:this._centerAltitude}else ke=this._centerAltitude;const Fe=o.isTerrainDEM?-ke:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ve=this.projection.isReprojectedInTileSpace?a.cz(this):1,Le=We=>{const mt=new a.ac(We.x+25e-6,We.y,We.z),It=new a.ac(We.x,We.y+25e-6,We.z),Nt=We.toLngLat(),Rt=mt.toLngLat(),Ft=It.toLngLat(),gn=this.locationCoordinate(Nt),Dn=this.locationCoordinate(Rt),xn=this.locationCoordinate(Ft),zn=Math.hypot(Dn.x-gn.x,Dn.y-gn.y),Bn=Math.hypot(xn.x-gn.x,xn.y-gn.y);return Math.sqrt(zn*Bn)*Ve/25e-6},Ne=We=>{const Tt=ke,mt=Fe;return{aabb:a.cC(this,F,0,0,0,We,mt,Tt,this.projection),zoom:0,x:0,y:0,minZ:mt,maxZ:Tt,wrap:We,fullyVisible:!1}},je=[];let dt=[];const Ze=u,Pt=o.reparseOverscaled?y:u,_t=(ue-this._centerAltitude)*oe,Lt=We=>{if(!this._elevation||!We.tileID||!C)return;const Tt=this._elevation.getMinMaxForTile(We.tileID),mt=We.aabb;Tt?(mt.min[2]=Tt.min,mt.max[2]=Tt.max,mt.center[2]=(mt.min[2]+mt.max[2])/2):(We.shouldSplit=ft(We),We.shouldSplit||(mt.min[2]=mt.max[2]=mt.center[2]=this._centerAltitude))},rn=(We,Tt)=>{if(.707*Tt<We)return 1;const mt=Tt/We;return mt/(1.4144271570014144+(Math.pow(1.1,mt-1.4144271570014144+1)-1)/(1.1-1)-1)},ft=We=>{if(We.zoom<Me)return!0;if(We.zoom===Ze)return!1;if(We.shouldSplit!=null)return We.shouldSplit;const Tt=We.aabb.distanceX(de),mt=We.aabb.distanceY(de);let It=_t,Nt=1;if(Y){It=We.aabb.distanceZ(de);const Bn=Math.pow(2,We.zoom),Kn=a.aY((We.y+1)/Bn),Zn=a.aY(We.y/Bn),pr=Math.min(Math.max(L,Kn),Zn),$r=a.c_(pr)/a.c_(L);if(Nt=pr===L?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,$r/this._mercatorScaleRatio),this.zoom<=a.cX&&We.zoom===Ze-1&&$r>=.9)return!0}else if(T&&(It=We.aabb.distanceZ(de)*oe),this.projection.isReprojectedInTileSpace&&y<=5){const Bn=Math.pow(2,We.zoom),Kn=Le(new a.ac((We.x+.5)/Bn,(We.y+.5)/Bn));Nt=Kn>.85?1:Kn}if(!C){const Bn=Math.sqrt(Tt*Tt+mt*mt+It*It);let Kn=(1<<Ze-We.zoom)*Te*Nt;return Kn*=rn(Math.max(It,_t),Bn),Bn<Kn}let Rt=Number.MAX_VALUE,Ft=0;const gn=We.aabb.getCorners(),Dn=[];for(const Bn of gn){a.at(Dn,Bn,de),Y||(T?Dn[2]*=oe:Dn[2]=_t);const Kn=a.bG(Dn,this._camera.forward());Kn<Rt&&(Rt=Kn,Ft=Math.abs(Dn[2]))}let xn=(1<<Ze-We.zoom)*Te*Nt;if(xn*=rn(Math.max(Ft,_t),Rt),Rt<xn)return!0;const zn=We.aabb.closestPoint(U);return zn[0]===U[0]&&zn[1]===U[1]};if(this.renderWorldCopies)for(let We=1;We<=3;We++)je.push(Ne(-We)),je.push(Ne(We));for(je.push(Ne(0));je.length>0;){const We=je.pop(),Tt=We.x,mt=We.y;let It=We.fullyVisible;const Nt=()=>this.projection.name==="globe"&&(We.y===0||We.y===(1<<We.zoom)-1);if(!It){let Rt=xe?We.aabb.intersects(Q):We.aabb.intersectsFlat(Q);if(Rt===0&&Nt()){const Ft=new a.cA(We.zoom,Tt,mt);Rt=a.cB(this,F,Ft,!0).intersects(Q)}if(Rt===0)continue;It=Rt===2}if(We.zoom!==Ze&&ft(We))for(let Rt=0;Rt<4;Rt++){const Ft=(Tt<<1)+Rt%2,gn=(mt<<1)+(Rt>>1),Dn={aabb:C?We.aabb.quadrant(Rt):a.cC(this,F,We.zoom+1,Ft,gn,We.wrap,We.minZ,We.maxZ,this.projection),zoom:We.zoom+1,x:Ft,y:gn,wrap:We.wrap,fullyVisible:It,tileID:void 0,shouldSplit:void 0,minZ:We.minZ,maxZ:We.maxZ};T&&!Y&&(Dn.tileID=new a.aM(We.zoom+1===Ze?Pt:We.zoom+1,We.wrap,We.zoom+1,Ft,gn),Lt(Dn)),je.push(Dn)}else{const Rt=We.zoom===Ze?Pt:We.zoom;if(o.minzoom&&o.minzoom>Rt)continue;let Ft=0;if(!It){let zn=xe?We.aabb.intersectsPrecise(Q):We.aabb.intersectsPreciseFlat(Q);if(zn===0&&Nt()){const Bn=new a.cA(We.zoom,Tt,mt);zn=a.cB(this,F,Bn,!0).intersectsPrecise(Q)}if(zn===0)continue;if(o.calculateQuadrantVisibility)if(Q.containsPoint(We.aabb.center))Ft=15;else for(let Bn=0;Bn<4;Bn++)We.aabb.quadrant(Bn).intersects(Q)!==0&&(Ft|=1<<Bn)}const gn=U[0]-(.5+Tt+(We.wrap<<We.zoom))*(1<<u-We.zoom),Dn=U[1]-.5-mt,xn=We.tileID?We.tileID:new a.aM(Rt,We.wrap,We.zoom,Tt,mt);o.calculateQuadrantVisibility&&(xn.visibleQuadrants=Ft),dt.push({tileID:xn,distanceSq:gn*gn+Dn*Dn})}}if(this.fogCullDistSq){const We=this.fogCullDistSq,Tt=this.horizonLineFromTop();dt=dt.filter((mt=>{const It=[0,0,0,1],Nt=[a.aj,a.aj,0,1],Rt=this.calculateFogTileMatrix(mt.tileID.toUnwrapped());a.aA(It,It,Rt),a.aA(Nt,Nt,Rt);const Ft=a.cD([],It,Nt),gn=a.cE([],It,Nt),Dn=a.cY(Ft,gn);if(Dn===0)return!0;let xn=!1;const zn=this._elevation;if(zn&&Dn>We&&Tt!==0){const Bn=this.calculateProjMatrix(mt.tileID.toUnwrapped());let Kn;o.isTerrainDEM||(Kn=zn.getMinMaxForTile(mt.tileID)),Kn||(Kn={min:Fe,max:ke});const Zn=a.cF(this.rotation),pr=[Zn[0]*a.aj,Zn[1]*a.aj,Kn.max];a.ad(pr,pr,Bn),xn=(1-pr[1])*this.height*.5<Tt}return Dn<We||xn}))}return dt.sort(((We,Tt)=>We.distanceSq-Tt.distanceSq)).map((We=>We.tileID))}resize(o,u){this.width=o,this.height=u,this.pixelsToGLUnits=[2/o,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const u=a.ay(o.lat,-a.cG,a.cG),y=this.projection.project(o.lng,u);return new a.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.cb(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,u){let y,b;const T=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;y=(u.x-T.x)/I,b=(u.y-T.y)/I}else{const I=this.pointCoordinate(u),L=this.pointCoordinate(T);y=I.x-L.x,b=I.y-L.y}const C=this.locationCoordinate(o);this.setLocation(new a.ac(C.x-y,C.y-b))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o,u){return this.projection.locationPoint(this,o,u)}locationPoint3D(o,u){return this.projection.locationPoint(this,o,u,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o,u){return this.coordinateLocation(this.pointCoordinate3D(o,u))}locationCoordinate(o,u){const y=u?a.cb(u,o.lat):void 0,b=this.projection.project(o.lng,o.lat);return new a.ac(b.x,b.y,y)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,u){const y=u??this._centerAltitude,b=[o.x,o.y,0,1],T=[o.x,o.y,1,1];a.aA(b,b,this.pixelMatrixInverse),a.aA(T,T,this.pixelMatrixInverse);const C=T[3];a.cH(b,b,1/b[3]),a.cH(T,T,1/C);const I=b[2],L=T[2];return{p0:b,p1:T,t:I===L?0:(y-I)/(L-I)}}screenPointToMercatorRay(o){const u=[o.x,o.y,0,1],y=[o.x,o.y,1,1];return a.aA(u,u,this.pixelMatrixInverse),a.aA(y,y,this.pixelMatrixInverse),a.cH(u,u,1/u[3]),a.cH(y,y,1/y[3]),u[2]=a.cb(u[2],this._center.lat)*this.worldSize,y[2]=a.cb(y[2],this._center.lat)*this.worldSize,a.cH(u,u,1/this.worldSize),a.cH(y,y,1/this.worldSize),new a.av([u[0],u[1],u[2]],a.au([],a.at([],y,u)))}rayIntersectionCoordinate(o){const{p0:u,p1:y,t:b}=o,T=a.cb(u[2],this._center.lat),C=a.cb(y[2],this._center.lat);return new a.ac(a.ai(u[0],y[0],b)/this.worldSize,a.ai(u[1],y[1],b)/this.worldSize,a.ai(T,C,b))}pointCoordinate(o,u=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,u)}pointCoordinate3D(o,u){if(!this.elevation)return this.pointCoordinate(o,u);let y=this.projection.pointCoordinate3D(this,o.x,o.y);if(y)return new a.ac(y[0],y[1],y[2]);let b=0,T=this.horizonLineFromTop();if(o.y>T)return this.pointCoordinate(o,u);const C=.02*T,I=o.clone();for(let L=0;L<10&&T-b>C;L++){I.y=a.ai(b,T,.66);const F=this.projection.pointCoordinate3D(this,I.x,I.y);F?(T=I.y,y=F):b=I.y}return y?new a.ac(y[0],y[1],y[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=a.cI)return!this.isPointAboveHorizon(o);const u=this.pointCoordinate(o);return u.y>=0&&u.y<=1}_coordinatePoint(o,u){const y=u&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,b=[o.x*this.worldSize,o.y*this.worldSize,y+o.toAltitude(),1];return a.aA(b,b,this.pixelMatrix),b[3]>0?new a.P(b[0]/b[3],b[1]/b[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:u}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,T=this.pointLocation3D(new a.P(u,o)),C=this.pointLocation3D(new a.P(b,o)),I=this.pointLocation3D(new a.P(b,y)),L=this.pointLocation3D(new a.P(u,y));let F=Math.min(T.lng,C.lng,I.lng,L.lng),U=Math.max(T.lng,C.lng,I.lng,L.lng),Y=Math.min(T.lat,C.lat,I.lat,L.lat),W=Math.max(T.lat,C.lat,I.lat,L.lat);const Q=Math.pow(2,-this.zoom)/16*270,le=this.projection.name==="globe"?1:4,oe=(ue,de,xe,Te,Me)=>{const ke=(ue+xe)/2,Fe=(de+Te)/2,Ve=new a.P(ke,Fe),{lng:Le,lat:Ne}=this.pointLocation3D(Ve),je=Math.max(0,F-Le,Y-Ne,Le-U,Ne-W);F=Math.min(F,Le),U=Math.max(U,Le),Y=Math.min(Y,Ne),W=Math.max(W,Ne),(Me<le||je>Q)&&(oe(ue,de,ke,Fe,Me+1),oe(ke,Fe,xe,Te,Me+1))};if(oe(u,o,b,o,1),oe(b,o,b,y,1),oe(b,y,u,y,1),oe(u,y,u,o,1),this.projection.name==="globe"){const[ue,de]=a.cJ(this);ue?(W=90,U=180,F=-180):de&&(Y=-90,U=180,F=-180)}return new a.aG(new a.ci(F,Y),new a.ci(U,W))}_getBoundsRectangular(o,u){const{top:y,left:b}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,I=new a.P(b,y),L=new a.P(C,y),F=new a.P(C,T),U=new a.P(b,T);let Y=this.pointCoordinate(I,o),W=this.pointCoordinate(L,o);const Q=this.pointCoordinate(F,u),le=this.pointCoordinate(U,u),oe=(ue,de)=>(de.y-ue.y)/(de.x-ue.x);return Y.y>1&&W.y>=0?Y=new a.ac((1-le.y)/oe(le,Y)+le.x,1):Y.y<0&&W.y<=1&&(Y=new a.ac(-le.y/oe(le,Y)+le.x,0)),W.y>1&&Y.y>=0?W=new a.ac((1-Q.y)/oe(Q,W)+Q.x,1):W.y<0&&Y.y<=1&&(W=new a.ac(-Q.y/oe(Q,W)+Q.x,0)),new a.aG().extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=o.visibleDemTiles.reduce(((y,b)=>{if(b.dem){const T=b.dem.tree;y.min=Math.min(y.min,T.minimums[0]),y.max=Math.max(y.max,T.maximums[0])}return y}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*o.exaggeration(),u.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-u*(1-this._horizonShift);return o?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-a.cG,this.maxLat=a.cG,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.aD(this.minLng)*this.tileSize,this.worldMaxX=a.aD(this.maxLng)*this.tileSize,this.worldMinY=a.aH(this.maxLat)*this.tileSize,this.worldMaxY=a.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,u){return this.projection.createTileMatrix(this,u,o)}calculateDistanceTileData(o){const u=o.key,y=this._distanceTileDataCache;if(y[u])return y[u];const b=o.canonical,T=1/this.height,C=this.cameraWorldSize,I=C/this.zoomScale(b.z),L=(b.x+Math.pow(2,b.z)*o.wrap)*I,F=b.y*I,U=this.point;U.x*=C/this.worldSize,U.y*=C/this.worldSize;const Y=this.angle,W=Math.sin(-Y),Q=-Math.cos(-Y);return y[u]={bearing:[W,Q],center:[(U.x-L)*T,(U.y-F)*T],scale:I/a.aj*T},y[u]}calculateFogTileMatrix(o){const u=o.key,y=this._fogTileMatrixCache;if(y[u])return y[u];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return a.az(b,this.worldToFogMatrix,b),y[u]=new Float32Array(b),y[u]}calculateProjMatrix(o,u=!1,y=!1){const b=o.key;let T;if(T=y?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,T[b])return T[b];const C=this.calculatePosMatrix(o,this.worldSize);let I;return I=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,a.az(C,I,C),T[b]=new Float32Array(C),T[b]}calculatePixelsToTileUnitsMatrix(o){const u=o.tileID.key,y=this._pixelsToTileUnitsCache;if(y[u])return y[u];const b=a.cK(o,this);return y[u]=b,y[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,u=a.bn([],[o,o,o]);return a.az(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const u=a.cb(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(u),b=this._camera.forward(),T=a.cb(1,this._center.lat);y[2]/=T,b[2]/=T,a.au(b,b);const C=o.raycast(y,b,o.exaggeration());if(C){const I=a.bE([],y,b,C),L=new a.ac(I[0],I[1],a.cb(I[2],a.aY(I[1]))),F=(L.z+a.ae([L.x-y[0],L.y-y[1],L.z-y[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(F),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const u=this._elevation,y=a.cb(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(y),T=u.getAtPointOrZero(new a.ac(...b)),C=this.pixelsPerMeter/this.worldSize*T,I=this._minimumHeightOverTerrain(),L=b[2]-C;if(L<=I)if(L<0||o){const F=this.locationCoordinate(this._center,this._centerAltitude),U=[b[0],b[1],F.z-b[2]],Y=a.ae(U);U[2]-=(I-L)/this._pixelsPerMercatorPixel;const W=a.ae(U);if(W===0)return;a.c1(U,U,Y/W*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],F.z*this._pixelsPerMercatorPixel-U[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const W=this.center;return W.lat=a.ay(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(W.lng=a.ay(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const u=this._unmodified,{x:y,y:b}=this.point;let T=0,C=y,I=b;const L=this.width/2,F=this.height/2,U=this.worldMinY*this.scale,Y=this.worldMaxY*this.scale;if(b-F<U&&(I=U+F),b+F>Y&&(I=Y-F),Y-U<this.height&&(T=Math.max(T,this.height/(Y-U)),I=(Y+U)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,le=this.worldSize/2-(W+Q)/2;C=(y+le+this.worldSize)%this.worldSize-le,C-L<W&&(C=W+L),C+L>Q&&(C=Q-L),Q-W<this.width&&(T=Math.max(T,this.width/(Q-W)),C=(Q+W)/2)}C===y&&I===b||this._allowWorldUnderZoom||(this.center=this.unproject(new a.P(C,I))),T&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,u=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.cb(1,this.center.lat)/a.cb(1,a.c$));const b=a.cL(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?y:1,C=this._camera.getWorldToCamera(this.worldSize,T);let I;const L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(L[8]=2*-o.x/this.width,L[9]=2*o.y/this.height,this.isOrthographic){let Ne=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),je=Ne*this.aspect,dt=-je,Ze=-Ne;je-=o.x,dt-=o.x,Ne+=o.y,Ze+=o.y,I=this._camera.getCameraToClipOrthographic(dt,je,Ze,Ne,this._nearZ,this._farZ),((Pt,_t,Lt,rn)=>{for(let ft=0;ft<16;ft++)Pt[ft]=a.ai(_t[ft],Lt[ft],rn)})(I,I,L,a.cZ(this.pitch>=no?1:this.pitch/no))}else I=L;const F=a.cM([],L,C);let U=a.cM([],I,C);if(this.projection.isReprojectedInTileSpace){const Ne=this.locationCoordinate(this.center),je=a.bx([]);a.bo(je,je,[Ne.x*this.worldSize,Ne.y*this.worldSize,0]),a.az(je,je,a.cN(this)),a.bo(je,je,[-Ne.x*this.worldSize,-Ne.y*this.worldSize,0]),a.az(U,U,je),a.az(F,F,je),this.inverseAdjustmentMatrix=a.cO(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.cP([],U,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=U,this.invProjMatrix=a.bi(new Float64Array(16),this.projMatrix),u){const Ne=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ne[8]=2*-o.x/this.width,Ne[9]=2*o.y/this.height,this.expandedFarZProjMatrix=a.cM([],Ne,C)}else this.expandedFarZProjMatrix=this.projMatrix;const Y=a.bi([],I);this.frustumCorners=a.cQ.fromInvProjectionMatrix(Y,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const W=new Float32Array(16);a.bx(W),a.cP(W,W,[1,-1,1]),a.cR(W,W,this._pitch),a.by(W,W,this.angle);const Q=a.c9(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.bw(Q);const le=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Q[8]=2*-o.x/this.width,Q[9]=2*(o.y+le)/this.height,this.skyboxMatrix=a.az(W,Q,W);const oe=this.point,ue=oe.x,de=oe.y,xe=this.width%2/2,Te=this.height%2/2,Me=Math.cos(this.angle),ke=Math.sin(this.angle),Fe=ue-Math.round(ue)+Me*xe+ke*Te,Ve=de-Math.round(de)+Me*Te+ke*xe,Le=new Float64Array(U);if(a.bo(Le,Le,[Fe>.5?Fe-1:Fe,Ve>.5?Ve-1:Ve,0]),this.alignedProjMatrix=Le,U=a.bz(),a.cP(U,U,[this.width/2,-this.height/2,1]),a.bo(U,U,[1,-1,0]),this.labelPlaneMatrix=U,U=a.bz(),a.cP(U,U,[1,-1,1]),a.bo(U,U,[-1,-1,0]),a.cP(U,U,[2/this.width,2/this.height,1]),this.glCoordMatrix=U,this.pixelMatrix=a.az(new Float64Array(16),this.labelPlaneMatrix,F),this._calcFogMatrices(),this._distanceTileDataCache={},U=a.bi(new Float64Array(16),this.pixelMatrix),!U)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=U,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.cS(this);const Ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.ad(Ne,Ne,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=U;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,y=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,T=[o,o,u];a.c1(T,T,b),a.c1(y,y,-1),a.cT(y,y,T);const C=a.bz();a.bo(C,C,y),a.cP(C,C,T),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,u,b)}_computeCameraPosition(o){const u=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),b=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-o/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-y[0]*T,b.y/this.worldSize-y[1]*T,o/this.worldSize*this._centerAltitude-y[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],b=o[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(T=Math.min((u-y)/b,1)),this._camera.position=a.bE([],this._camera.position,o,T),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,u=this._camera.forward(),{pitch:y,bearing:b}=this._camera.getPitchBearing(),T=a.cb(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.al(this._maxPitch)),I=Math.max((o[2]-T)/Math.cos(y),C),L=this._zoomFromMercatorZ(I);a.bE(o,o,u,I),this._pitch=a.ay(y,a.al(this.minPitch),a.al(this.maxPitch)),this.angle=a.bQ(b,-Math.PI,Math.PI),this._setZoom(a.ay(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.ac(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,o)*this.tileSize))}zoomFromMercatorZAdjusted(o){let u=0,y=a.cI,b=0,T=1/0;for(;y-u>1e-6&&y>u;){const C=u+.5*(y-u),I=this.tileSize*Math.pow(2,C),L=this.getCameraToCenterDistance(this.projection,C,I),F=this.scaleZoom(L/(Math.max(0,o)*this.tileSize)),U=Math.abs(C-F);U<T&&(T=U,b=C),C<F?u=C:y=C}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,u){const y=Math.min(o.x,u.x),b=Math.max(o.x,u.x),T=Math.min(o.y,u.y),C=Math.max(o.y,u.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new a.P(y,T),new a.P(b,C),new a.P(y,C),new a.P(b,T)],L=this.renderWorldCopies?-3:0,F=this.renderWorldCopies?4:1;for(const U of I){const Y=this.pointRayIntersection(U);if(Y.t<0)return!0;const W=this.rayIntersectionCoordinate(Y);if(W.x<L||W.y<0||W.x>F||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.cU(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(o,u){const y=a.ae(a.at([],this._camera.position,o)),b=this._zoomFromMercatorZ(y)+u;return y-this._mercatorZfromZoom(b)}getCameraPoint(){if(this.projection.name==="globe"){const o=(function([u,y,b],T){const C=[u,y,b,1];a.aA(C,C,T);const I=C[3]=Math.max(C[3],1e-6);return C[0]/=I,C[1]/=I,C[2]/=I,C})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,o))}}getCameraToCenterDistance(o,u=this.zoom,y=this.worldSize){const b=a.cL(o,u,this.width,this.height,1024),T=o.pixelSpaceConversion(this.center.lat,y,b);let C=.5/Math.tan(.5*this._fov)*this.height*T;return this.isOrthographic&&(C=a.ai(1,C,a.cZ(this.pitch>=no?1:this.pitch/no))),C}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.az(o,o,this.globeMatrix),o}getFrustum(o){return a.cy.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const qc=(g,o)=>{if(o>0&&g.terrain&&a.w("Cutoff is currently disabled on terrain"),o<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=g.transform,y=Math.max(Math.abs(u._zoom-(g.minCutoffZoom-1)),1),b=u.isLODDisabled(!1)?a.af(60,45,u.pitch):a.af(30,15,u.pitch),T=u._farZ-u._nearZ,C=o*u.height,I=((1-(L=b))*u.cameraToCenterDistance+L*(u._farZ+C))*y;var L;return{shouldRenderCutoff:b<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(I-u._nearZ)/T,(I-C-u._nearZ)/T]}}},ys={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Cp{constructor(o,u){this.aabb=o,this.lastCascade=u}}class U0{add(o,u){const y=this.receivers[o.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],u.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],u.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],u.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],u.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],u.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],u.max[2])):this.receivers[o.key]=new Cp(u,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,u,y){const b=a.d6.fromPoints(o.points);let T=0;for(const C in this.receivers){const I=this.receivers[C];if(!I||!b.intersectsAabb(I.aabb))continue;I.aabb.min=b.closestPoint(I.aabb.min),I.aabb.max=b.closestPoint(I.aabb.max);const L=I.aabb.getCorners();for(let F=0;F<y.length;F++){let U=!0;for(const Y of L){const W=[Y[0]*u,Y[1]*u,Y[2]];if(a.ad(W,W,y[F].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){U=!1;break}}if(I.lastCascade=F,T=Math.max(T,F),U)break}}return T+1}}class Ol{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new U0,this._depthMode=new Tn(o.context.gl.LEQUAL,Tn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),o.tp.registerParameter(ys,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(ys,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(ys,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,u){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const b=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||b<=0||(this._shadowLayerCount=y.style.order.reduce(((le,oe)=>{const ue=y.style._mergedLayers[oe];return le+(ue.hasShadowPass()&&!ue.isHidden(o.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const T=y.context,C=ys.shadowMapResolution,I=ys.shadowMapResolution;if(this._cascades.length===0||ys.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let le=0;le<ys.cascadeCount;++le){const oe=y._shadowMapDebug,ue=T.gl,de=T.createFramebuffer(C,I,oe,"texture"),xe=new a.T(T,{width:C,height:I,data:null},ue.DEPTH_COMPONENT16);if(de.depthAttachment.set(xe.texture),oe){const Te=new a.T(T,{width:C,height:I,data:null},ue.RGBA8);de.colorAttachment.set(Te.texture)}this._cascades.push({framebuffer:de,texture:xe,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.cy,scale:0})}}this.shadowDirection=cd(u);let L=0;if(o.elevation){const le=o.elevation,oe=[1e4,-1e4];le.visibleDemTiles.filter((ue=>ue.dem)).forEach((ue=>{const de=ue.dem.tree;oe[0]=Math.min(oe[0],de.minimums[0]),oe[1]=Math.max(oe[1],de.maximums[0])})),oe[0]!==1e4&&(L=(oe[1]-oe[0])*le.exaggeration())}const F=1.5*o.cameraToCenterDistance,U=3*F,Y=new Float64Array(16);for(let le=0;le<this._cascades.length;++le){const oe=this._cascades[le];let ue=o.height/50,de=1;ys.cascadeCount===1?de=U:le===0?de=F:(ue=F,de=U);const[xe,Te]=ud(o,this.shadowDirection,ue,de,ys.shadowMapResolution,L);oe.scale=o.scale,oe.matrix=xe,oe.boundingSphereRadius=Te,a.bi(Y,oe.matrix),oe.frustum=a.cy.fromInvProjectionMatrix(Y,1,0,!0),oe.far=de}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=b,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ys.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ys.shadowMapResolution,this._uniformValues.u_shadowmap_0=Jo.ShadowMap0,this._uniformValues.u_shadowmap_1=Jo.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Q=y.transform.elevation;for(const le of this._groundShadowTiles){let oe={min:0,max:0};if(Q){const ue=Q.getMinMaxForTile(le);ue&&(oe=ue)}this.addShadowReceiver(le.toUnwrapped(),oe.min,oe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,u){if(!this.enabled)return;const y=this.painter,b=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),b.viewport.set([0,0,ys.shadowMapResolution,ys.shadowMapResolution]);for(let T=0;T<this._numCascadesToRender;++T){y.currentShadowCascade=T,b.bindFramebuffer.set(this._cascades[T].framebuffer.framebuffer),b.clear({color:a.am.white,depth:1});for(const C of o.order){const I=o._mergedLayers[C];if(!I.hasShadowPass()||I.isHidden(y.transform.zoom))continue;const L=o.getLayerSourceCache(I),F=L?u[L.id]:void 0;(I.type==="model"||F&&F.length)&&y.renderLayer(y,L,I,F)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,u=o.style,y=o.context,b=y.gl,T=u.directionalLight,C=u.ambientLight;if(!T||!C)return;const I=[],L=qc(o,o.longestCutoffRange);L.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),I.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&I.push("NORMAL_OFFSET");const F=gh(u,T,C),U=new Tn(b.LEQUAL,Tn.ReadOnly,o.depthRangeFor3D),Y=new er({func:b.EQUAL,mask:255},0,255,b.KEEP,b.KEEP,b.KEEP);for(const W of this._groundShadowTiles){const Q=W.toUnwrapped(),le=o.isTileAffectedByFog(W),oe=o.getOrCreateProgram("groundShadow",{defines:I,overrideFog:le});this.setupShadows(Q,oe),o.uploadCommonUniforms(y,oe,Q,null,L);const ue={u_matrix:o.transform.calculateProjMatrix(Q),u_ground_shadow_factor:F};oe.draw(o,b.TRIANGLES,U,Y,yr.multiply,Wn.disabled,ue,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,null,o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?yr.unblended:yr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const u=this.painter.transform,y=u.calculatePosMatrix(o,u.worldSize);return a.az(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(o){return a.az(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,u,y){if(!this.enabled)return;const b=this.painter.transform,T=this.painter.context,C=T.gl,I=this._uniformValues,L=new Float64Array(16),F=b.calculatePosMatrix(o,b.worldSize);for(let U=0;U<this._cascades.length;U++)a.az(L,this._cascades[U].matrix,F),I[U===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),T.activeTexture.set(C.TEXTURE0+Jo.ShadowMap0+U),this._cascades[U].texture.bindExtraParam(C.LINEAR,C.LINEAR,C.CLAMP_TO_EDGE,C.CLAMP_TO_EDGE,C.GREATER);if(this.useNormalOffset=!!y,this.useNormalOffset){const U=a.d4(o.canonical),Y=2/b.tileSize*a.aj/ys.shadowMapResolution,W=Y*this._cascades[0].boundingSphereRadius,Q=Y*this._cascades[this._cascades.length-1].boundingSphereRadius,le=(y==="vector-tile"?1:3)*(function(oe,ue,de,xe,Te){const Me=a.ay((oe-22)/-22,0,1);return .125*(1-Me)+4*Me})(b.zoom);I.u_shadow_normal_offset=[U,W*le,Q*le],I.u_shadow_bias=[1e-4,.0012,.012]}else I.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(T,I)}setupShadowsFromMatrix(o,u,y=!1){if(!this.enabled)return;const b=this.painter.context,T=b.gl,C=this._uniformValues,I=new Float64Array(16);for(let L=0;L<ys.cascadeCount;L++)a.az(I,this._cascades[L].matrix,o),C[L===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),b.activeTexture.set(T.TEXTURE0+Jo.ShadowMap0+L),this._cascades[L].texture.bindExtraParam(T.LINEAR,T.LINEAR,T.CLAMP_TO_EDGE,T.CLAMP_TO_EDGE,T.GREATER);if(this.useNormalOffset=y,y){const L=ys.normalOffset;C.u_shadow_normal_offset=[1,L,L],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(b,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,u,y,b){if(b[2]>=0)return{};const T=(function(L,F,U){const Y=U/(1<<L.canonical.z);return new a.d6([L.canonical.x*Y+L.wrap*U,L.canonical.y*Y+L.wrap*U,0],[(L.canonical.x+1)*Y+L.wrap*U,(L.canonical.y+1)*Y+L.wrap*U,F])})(o,u,y).getCorners(),C=u/-b[2];b[0]<0?(a.d5(T[0],T[0],[b[0]*C,0,0]),a.d5(T[3],T[3],[b[0]*C,0,0])):b[0]>0&&(a.d5(T[1],T[1],[b[0]*C,0,0]),a.d5(T[2],T[2],[b[0]*C,0,0])),b[1]<0?(a.d5(T[0],T[0],[0,b[1]*C,0]),a.d5(T[1],T[1],[0,b[1]*C,0])):b[1]>0&&(a.d5(T[2],T[2],[0,b[1]*C,0]),a.d5(T[3],T[3],[0,b[1]*C,0]));const I={};return I.vertices=T,I.planes=[Hl(T[1],T[0],T[4]),Hl(T[2],T[1],T[5]),Hl(T[3],T[2],T[6]),Hl(T[0],T[3],T[7])],I}addShadowReceiver(o,u,y){this._receivers.add(o,a.d6.fromTileIdAndHeight(o,u,y))}getMaxCascadeForTile(o){const u=this._receivers.get(o);return u&&u.lastCascade?u.lastCascade:0}}function Hl(g,o,u){const y=a.at([],u,o),b=a.at([],g,o),T=a.bF([],y,b),C=a.ae(T);return C===0?[0,0,1,0]:(a.c1(T,T,1/C),[T[0],T[1],T[2],-a.bG(T,o)])}function cd(g){const o=g.properties.get("direction"),u=a.d1(o.x,o.y,o.z);u[2]=a.ay(u[2],0,75);const y=a.d3([u[0],u[1],u[2]]);return a.d2(y.x,y.y,y.z)}function gh(g,o,u){const y=o.properties.get("color-use-theme")==="none",b=o.properties.get("color"),T=o.properties.get("intensity"),C=o.properties.get("direction"),I=[C.x,C.y,C.z],L=u.properties.get("color-use-theme")==="none",F=u.properties.get("color"),U=u.properties.get("intensity"),Y=Math.max(a.bG([0,0,1],I),0),W=[0,0,0];a.c1(W,F.toPremultipliedRenderColor(L?null:g.getLut(o.scope)).toArray01Linear().slice(0,3),U);const Q=[0,0,0];return a.c1(Q,b.toPremultipliedRenderColor(y?null:g.getLut(u.scope)).toArray01Linear().slice(0,3),Y*T),a.d8([W[0]>0?W[0]/(W[0]+Q[0]):0,W[1]>0?W[1]/(W[1]+Q[1]):0,W[2]>0?W[2]/(W[2]+Q[2]):0])}function ud(g,o,u,y,b,T){const C=g.zoom,I=g.scale,L=g.worldSize,F=1/L,U=g.aspect,Y=Math.sqrt(1+U*U)*Math.tan(.5*g.fovX),W=Y*Y,Q=y-u,le=y+u;let oe,ue;W>Q/le?(oe=y,ue=y*Y):(oe=.5*le*(1+W),ue=.5*Math.sqrt(Q*Q+2*(y*y+u*u)*W+le*le*W*W));const de=g.projection.pixelsPerMeter(g.center.lat,L),xe=g._camera.getCameraToWorldMercator(),Te=[0,0,-oe*F];a.ad(Te,Te,xe);let Me=ue*F;const ke=g._edgeInsets;if(!(ke.left===0&&ke.top===0&&ke.right===0&&ke.bottom===0||ke.left===ke.right&&ke.top===ke.bottom)){const It=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?de:1),Nt=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,u,y);Nt[8]=2*-g.centerOffset.x/g.width,Nt[9]=2*g.centerOffset.y/g.height;const Rt=new Float64Array(16);a.cM(Rt,Nt,It);const Ft=new Float64Array(16);a.bi(Ft,Rt);const gn=a.cy.fromInvProjectionMatrix(Ft,L,C,!0);for(const Dn of gn.points){const xn=((Fe=Dn)[0]/=I,Fe[1]/=I,Fe[2]=a.cb(Fe[2],g._center.lat),Fe);Me=Math.max(Me,a.c2(a.d7([],Te,xn)))}}var Fe;Me*=b/(b-1);const Ve=Math.acos(o[2]),Le=Math.atan2(-o[0],-o[1]),Ne=new Ps;Ne.position=Te,Ne.setPitchBearing(Ve,Le);const je=Ne.getWorldToCamera(L,de),dt=Me*L,Ze=Math.min(g._mercatorZfromZoom(17)*L*-2,-2*dt),Pt=Ne.getCameraToClipOrthographic(-dt,dt,-dt,dt,Ze,(dt+T*de)/o[2]),_t=new Float64Array(16);a.az(_t,Pt,je);const Lt=a.d2(Math.floor(1e6*Te[0])/1e6*L,Math.floor(1e6*Te[1])/1e6*L,0),rn=.5*b,ft=[0,0,0];a.ad(ft,Lt,_t),a.c1(ft,ft,rn);const We=[Math.floor(ft[0]),Math.floor(ft[1]),Math.floor(ft[2])],Tt=[0,0,0];a.at(Tt,ft,We),a.c1(Tt,Tt,-1/rn);const mt=new Float64Array(16);return a.bx(mt),a.bo(mt,mt,Tt),a.az(_t,mt,_t),[_t,dt]}class My extends a.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(o,u){return a.aS(this.requestManager.transformRequest(u,a.R.Model).url).then((y=>{if(!y)return;const b=a.aT(y),T=new a.aU(o,void 0,void 0,b);return T.computeBoundsAndApplyParent(),T})).catch((y=>{if(y&&y.status===404)return null;this.fire(new a.z(new Error(`Could not load model ${o} from ${u}: ${y.message}`)))}))}load(o,u,y={forceReload:!1}){this.models[u]||(this.models[u]={});const b=Object.keys(o),T=[],C=[];for(const I of b){const L=o[I];this.hasURLBeenRequested(L)&&!y.forceReload||(this.modelByURL[L]={modelId:I,scope:u},T.push(this.loadModel(I,L)),C.push(I)),this.models[u][I]||(this.models[u][I]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+C.length,Promise.allSettled(T).then((I=>{for(let L=0;L<I.length;L++){const{status:F}=I[L];if(F==="rejected")continue;const{value:U}=I[L];this.models[u][C[L]]||(this.models[u][C[L]]={model:null,numReferences:1}),this.models[u][C[L]].model=U}this.numModelsLoading[u]-=C.length,this.fire(new a.A("data",{dataType:"style"}))})).catch((I=>{this.fire(new a.z(new Error(`Could not load models: ${I.message}`)))}))}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,u,y={exactIdMatch:!1}){return!!(y.exactIdMatch?this.getModel(o,u):this.getModelByURL(this.modelUris[u][o]))}getModel(o,u){return this.models[u]||(this.models[u]={}),this.models[u][o]?this.models[u][o].model:void 0}getModelByURL(o){if(!o)return null;const u=this.modelByURL[o];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(o,u){return this.models[u]&&this.models[u][o]!==void 0}getModelURIs(o){return this.modelUris[o]||{}}addModel(o,u,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={});const b=this.requestManager.normalizeModelURL(u);if((this.hasModel(o,y,{exactIdMatch:!0})||this.hasModelBeenAdded(o,y))&&this.modelUris[y][o]===b)this.models[y][o].numReferences++;else if(this.hasURLBeenRequested(b)){const{scope:T,modelId:C}=this.modelByURL[b];this.models[T][C].numReferences++}else this.modelUris[y][o]=b,this.load({[o]:this.modelUris[y][o]},y)}addModelURLs(o,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const y=this.modelUris[u];for(const b in o)y[b]=this.requestManager.normalizeModelURL(o[b])}reloadModels(o){this.load(this.modelUris[o],o,{forceReload:!0})}addModelsFromBucket(o,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const y={};for(const b of o)this.hasModel(b,u,{exactIdMatch:!0})||this.hasURLBeenRequested(b)?this.models[u][b].numReferences++:this.modelUris[u][b]&&!this.hasURLBeenRequested(b)?y[b]=this.modelUris[u][b]:!this.hasURLBeenRequested(b)&&a.d9(b,!1)&&(this.modelUris[u][b]=this.requestManager.normalizeModelURL(b),y[b]=this.modelUris[u][b]);this.load(y,u)}hasURLBeenRequested(o){return this.modelByURL[o]!==void 0}removeModel(o,u,y=!1,b=!1){if(this.models[u]&&this.models[u][o]&&(this.models[u][o].numReferences--,this.models[u][o].numReferences===0||b)){const T=this.modelUris[u][o];y||delete this.modelUris[u][o],delete this.modelByURL[T];const C=this.models[u][o].model;if(!C)return;delete this.models[u][o],C.destroy()}}destroy(){for(const o of Object.keys(this.models))for(const u of Object.keys(this.models[o])){const y=this.models[o][u].model;delete this.models[o][u],y&&y.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,u){this.models[u]||(this.models[u]={});for(const y in this.models[u])this.models[u][y].model&&this.models[u][y].model.upload(o.context)}}const sf=new a.a7({data:new a.a8(a.a5.colorTheme.data)});class Py{constructor(o){this._scope=o,this._buildingQueryParams={target:{featuresetId:"building-outline",importId:this._scope}},this._floorQueryParams={target:{featuresetId:"floor-outline",importId:this._scope}}}execute(o){const u=this._makeBuildingsQueryArea(o),y=this._makeFloorsQueryArea(o),b=o.queryRenderedFeatures(u,this._buildingQueryParams).filter((I=>I.properties.shape_type==="building")).reduce(((I,L)=>{const F=L.properties.id;return L.properties.shape_type!=="building"||I.some((U=>U.properties.id===F))||I.push(L),I}),[]),T=o.queryRenderedFeatures(y,this._floorQueryParams).filter((I=>I.properties.shape_type==="floor")).reduce(((I,L)=>{const F=L.properties.id;return L.properties.shape_type!=="floor"||I.some((U=>U.properties.id===F))||I.push(L),I}),[]),C=[o.getCenter().lng,o.getCenter().lat];return{floors:T,building:this._findBuildingAtCenter(C,b)||(b.length>0?b[0]:null)}}_makeBuildingsQueryArea(o){const u=o.transform.width,y=o.transform.height,b=Math.min(u,y),T=b*(1/8),C=b*(1/8),I=.5*(u-T),L=.5*(y-C);return[new a.P(I,L),new a.P(I+T,L+C)]}_makeFloorsQueryArea(o){const u=o.transform.width,y=o.transform.height,b=u*(2/3),T=y*(2/3),C=.5*(u-b),I=.5*(y-T);return[new a.P(C,I),new a.P(C+b,I+T)]}_findBuildingAtCenter(o,u){for(const y of u)if(y.geometry.type==="Polygon"&&this._pointInPolygon(o,y.geometry.coordinates[0]))return y;return null}_pointInPolygon(o,u){let y=!1;for(let b=0,T=u.length-1;b<u.length;T=b++){const C=u[b][0],I=u[b][1],L=u[T][1];I>o[1]!=L>o[1]&&o[0]<(u[T][0]-C)*(o[1]-I)/(L-I)+C&&(y=!y)}return y}}class Rl{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._floors=[]}setBuildingId(o){this._selectedBuildingId=o}setFloors(o){if(this._floors=o.filter((u=>u.properties.building_id===this._selectedBuildingId)),!this._selectedFloorId||!this._floors.map((u=>u.properties.id)).includes(this._selectedFloorId)){const u=this._floors.map((y=>({id:y.properties.id,level:y.properties.floor_level}))).reduce(((y,b)=>{const T=Math.abs(y.level-1),C=Math.abs(b.level-1);return C<T||C===T&&b.level>y.level?b:y}));this._selectedFloorId=u.id}}setFloorId(o){this._selectedFloorId=o}getSelectedFloorId(){return this._selectedFloorId}getCurrentBuildingFloors(){return this._floors}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._floors=[]}}const Oy={"mbx-indoor-level-selected":{default:["literal",[]]}};function lf(g){return g=g||{},Object.assign(g,Oy)}class Ry extends a.E{constructor(o){super(),a.aV(["_onLoad","_onMove"],this),this._map=o,this._floorSelectionState=new Rl,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=null,this._floorSelectionState=null}_onLoad(){this._map.style.forEachFragmentStyle((o=>{o.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new a.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=o.scope,this._indoorDataQuery=new Py(this._scope)))})),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<16)return void this._clearIndoorData();const o=this._indoorDataQuery.execute(this._map);o&&o.floors.length!==0?(this._floorSelectionState.getSelectedFloorId()||this._map._addIndoorControl(),this._selectFloors(o)):this._clearIndoorData()}_selectFloors(o){if(o.building)this._floorSelectionState.setBuildingId(o.building.properties.id),this._floorSelectionState.setFloors(o.floors),this._updateUI();else{const u=this._floorSelectionState.getSelectedFloorId();if(u&&o.floors.some((y=>y.properties.id===u)))return;this._clearIndoorData()}}_clearIndoorData(){this._floorSelectionState.reset(),this._map._removeIndoorControl(),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",[]])}_updateUI(){const o=this._floorSelectionState.getCurrentBuildingFloors().map((y=>({id:y.properties.id,name:y.properties.name,shortName:y.properties.floor_level,levelOrder:y.properties.floor_level}))),u=this._floorSelectionState.getSelectedFloorId();u?(this._updateIndoorConfig(),this.fire(new a.A("indoorupdate",{selectedFloorId:u,floors:o}))):console.warn("IndoorManager: Selected floor is not set")}_updateIndoorConfig(){const o=this._floorSelectionState.getSelectedFloorId();o?this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",[o]]):console.warn("IndoorManager: Selected floor is not set")}selectFloor(o){this._floorSelectionState.setFloorId(o),this._updateIndoorConfig()}}function Iy(g){if(!g.metadata||!g.metadata.content_area)return;const o=a.q.devicePixelRatio,{left:u,top:y,width:b,height:T}=g.metadata.content_area,C=u*o,I=y*o;return[C,I,C+b*o,I+T*o]}function yh(g){if(g)return g.map((([o,u])=>[o*a.q.devicePixelRatio,u*a.q.devicePixelRatio]))}class _h{constructor(o,u,y){this.id=o,this.scope=u,this.sourceCache=y,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(o){this.missingRequests.has(o.name)||this.pendingRequests.has(o.name)||this.pendingRequests.add(o.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const o=new Map;if(!this.sourceCache.loaded())return o;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return o;const y=this.sourceCache.getSource();if(!(y instanceof Ro))return o;const b=u.map((C=>this.sourceCache.getTile(C))),T=y.getImages(b,Array.from(this.pendingRequests));for(const[C,I]of T)o.set(a.I.from({name:C,iconsetId:this.id}),I),this.pendingRequests.delete(C);for(const C of this.pendingRequests)this.missingRequests.add(C);return this.pendingRequests.clear(),o}}const Hc=(g,o)=>Pe(g,o&&o.filter((u=>u.identifier!=="source.canvas"))),Dy=a.aF(Fr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),vh=a.aF(Fr,["setCenter","setZoom","setBearing","setPitch"]),Mp=new Set(["background","sky","slot","custom"]),vu={version:8,layers:[],sources:{}},cf={duration:300,delay:0};class Gl extends a.E{constructor(o,u={}){super(),this.map=o,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=a.h({},cf),this._buildingIndex=new Tp(this),this.crossTileSymbolIndex=new wo,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new Jr,this.dispatcher=u.dispatcher?u.dispatcher:new a.D(a.db(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new Cr(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new a.dc(o._requestManager,u.localFontFamily?a.dd.all:u.localIdeographFontFamily?a.dd.ideographs:a.dd.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new My(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",a.de());const y=this;this._rtlTextPluginCallback=Gl.registerForPluginStateChange((b=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},((T,C)=>{if(a.df(T),C&&C.every((I=>I)))for(const I in y._sourceCaches){const L=y._sourceCaches[I],F=L.getSource().type;F!=="vector"&&F!=="geojson"||L.reload()}}))})),this.on("data",(b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const T=this.getOwnSource(b.sourceId);if(T&&T.vectorLayerIds)for(const C in this._layers){const I=this._layers[C];I.source===T.id&&this._validateLayer(I)}}))}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(a.j(o))return o;const u=a.dg(o);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${a.dh(JSON.stringify(o))}`}_diffStyle(o,u,y){this.globalId=this._getGlobalId(o);const b=(T,C)=>{try{C(null,this.setState(T,y))}catch(I){C(I,!1)}};if(typeof o=="string"){const T=this.map._requestManager.normalizeStyleURL(o),C=this.map._requestManager.transformRequest(T,a.R.Style);a.n(C,((I,L)=>{I?this.fire(new a.z(I)):L&&b(L,u)}))}else typeof o=="object"&&b(o,u)}loadURL(o,u={}){this.fire(new a.A("dataloading",{dataType:"style"}));const y=typeof u.validate=="boolean"?u.validate:!a.j(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,u.accessToken),this.resolvedImports.add(o);const b=this.importsCache.get(o);if(b)return this._load(b,y);const T=this.map._requestManager.transformRequest(o,a.R.Style);this._request=a.n(T,((C,I)=>{if(this._request=null,C)this.fire(new a.z(C));else if(I)return this.importsCache.set(o,I),this._load(I,y)}))}loadJSON(o,u={}){this.fire(new a.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=a.q.frame((()=>{this._request=null,this._load(o,u.validate!==!1)}))}loadEmpty(){this.fire(new a.A("dataloading",{dataType:"style"})),this._load(vu,!1)}_loadImports(o,u,y){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const b=[];for(const T of o){const C=this._createFragmentStyle(T),I=new Promise((U=>{C.once("style.import.load",U),C.once("error",U)})).then((()=>this.mergeAll()));if(b.push(I),this.resolvedImports.has(T.url)){C.loadEmpty();continue}const L=T.data||this.importsCache.get(T.url);L?(C.loadJSON(L,{validate:u}),this._isInternalStyle(L)&&(C.globalId=null)):T.url?C.loadURL(T.url,{validate:u}):C.loadEmpty();const F={style:C,id:T.id,config:T.config};if(y){const U=this.fragments.findIndex((({id:Y})=>Y===y));this.fragments=this.fragments.slice(0,U).concat(F).concat(this.fragments.slice(U))}else this.fragments.push(F)}return Promise.allSettled(b)}getImportGlobalIds(o=this,u=new Set){for(const y of o.fragments)y.style.globalId&&u.add(y.style.globalId),this.getImportGlobalIds(y.style,u);return[...u.values()]}_createFragmentStyle(o){const u=this.scope?a.C(o.id,this.scope):o.id;let y;const b=this._initialConfig&&this._initialConfig[u];(o.config||b)&&(y=a.h({},o.config,b));const T=new Gl(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return T.setEventedParent(this.map,{style:T}),T}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,u){const y=o.indoor?lf(o.schema):o.schema;if(this._isInternalStyle(o)){const C=a.h({},vu,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(C,u)}if(this.updateConfig(this._config,y),u&&Hc(this,Ra(o)))return;this._loaded=!0,this.stylesheet=a.di(o);const b=()=>{for(const F in o.sources)this.addSource(F,o.sources[F],{validate:!1,isInitialLoad:!0});if(o.iconsets)for(const F in o.iconsets)this.addIconset(F,o.iconsets[F]);o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&o.glyphs&&this.glyphManager.setURL(o.glyphs);const C=uh(this.stylesheet.layers);if(this._order=C.map((F=>F.id)),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const F=this.stylesheet.lights[0];this.light=new wt(F.properties,F.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new wt(this.stylesheet.light)),this._layers={};for(const F of C){const U=a.dn(F,this.scope,this._styleColorTheme.lut,this.options);U.configDependencies.size!==0&&this._configDependentLayers.add(U.fqid),U.setEventedParent(this,{layer:{id:U.id}}),this._layers[U.id]=U;const Y=this.getOwnLayerSourceCache(U),W=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Y&&U.canCastShadows()&&W&&(Y.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const I=this.stylesheet.terrain;I&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(I,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.A("data",{dataType:"style"}));const L=this.isRootStyle();o.imports?this._loadImports(o.imports,u).then((()=>{this._reloadImports(),this.fire(new a.A(L?"style.load":"style.import.load"))})).catch((F=>{this.fire(new a.z(new Error("Failed to load imports",F))),this.fire(new a.A(L?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new a.A(L?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const T=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(T){const C=this._evaluateColorThemeData(T);this._loadColorTheme(C).then((()=>{b()})).catch((I=>{a.w(`Couldn't load color theme from the stylesheet: ${I}`),b()}))}else this._styleColorTheme.lut=null,b()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,u,y,b,T,C,I,L,F,U;const Y={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((W=>{if(W.stylesheet){if(W.light!=null&&(o=W.light),W.stylesheet.lights)for(const Q of W.stylesheet.lights)Q.type==="ambient"&&W.ambientLight!=null&&(u=W.ambientLight),Q.type==="directional"&&W.directionalLight!=null&&(y=W.directionalLight);b=this._prioritizeTerrain(b,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(T=W.fog),W.stylesheet.snow&&W.snow!=null&&(C=W.snow),W.stylesheet.rain&&W.rain!=null&&(I=W.rain),W.stylesheet.camera!=null&&(U=W.stylesheet.camera),W.stylesheet.projection!=null&&(L=W.stylesheet.projection),W.stylesheet.transition!=null&&(F=W.stylesheet.transition),Y[W.scope]=W._styleColorTheme}})),this.light=o,this.ambientLight=u,this.directionalLight=y,this.fog=T,this.snow=C,this.rain=I,this._styleColorThemeForScope=Y,b===null?delete this.terrain:this.terrain=b,this.camera=U||{"camera-projection":"perspective"},this.projection=L||{name:"mercator"},this.transition=a.h({},cf,F),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const u=y=>{for(const b of y.fragments)u(b.style);o(y)};u(this)}_prioritizeTerrain(o,u,y){const b=o&&o.drapeRenderMode===0;return y===null?u&&u.drapeRenderMode===0?u:b?o:null:u!=null&&(!o||b||u&&u.drapeRenderMode===1)?u:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((u=>{o=this._prioritizeTerrain(o,u.terrain,u.stylesheet.terrain)})),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle((u=>{u.stylesheet.projection!=null&&(o=u.stylesheet.projection)})),this.projection=o||{name:"mercator"}}mergeSources(){const o={},u={},y={};this.forEachFragmentStyle((b=>{for(const T in b._sourceCaches){const C=a.C(T,b.scope);o[C]=b._sourceCaches[T]}for(const T in b._otherSourceCaches){const C=a.C(T,b.scope);u[C]=b._otherSourceCaches[T]}for(const T in b._symbolSourceCaches){const C=a.C(T,b.scope);y[C]=b._symbolSourceCaches[T]}})),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=y}mergeLayers(){const o={},u=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((T=>{for(const C of T._order){const I=T._layers[C];if(I.type==="slot"){const L=a.dj(C);if(o[L])continue;o[L]=[]}I.slot&&o[I.slot]?o[I.slot].push(I):u.push(I)}})),this._mergedOrder=[];const b=(T=[])=>{for(const C of T)if(C.type==="slot"){const I=a.dj(C.id);o[I]&&b(o[I]),this._mergedSlots.push(I)}else{const I=a.C(C.id,C.scope);this._mergedOrder.push(I),y[I]=C,C.is3D(!!this.terrain)&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&(this._clipLayerPresent=!0)}};b(u),this._mergedOrder.sort(((T,C)=>{const I=y[T],L=y[C];return I.hasInitialOcclusionOpacityProperties?L.is3D(!!this.terrain)?1:0:I.is3D(!!this.terrain)&&L.hasInitialOcclusionOpacityProperties?-1:0})),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=a.h({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?(function(u,y,b,T){const C=a.h({},y);for(const L of Object.keys(a.a5.colorTheme))C[L]===void 0&&(C[L]=a.a5.colorTheme[L].default);const I=new a.a6(sf,u,new Map(b));return I.setTransitionOrValue(C,b),I.untransitioned().possiblyEvaluate(new a.aa(0,{worldview:void 0}))})(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((y,b)=>{const T="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let C=o;C.startsWith(T)||(C=T+C);const I=a.I.from("mapbox-reserved-lut"),L=new Image;L.src=C,L.onerror=()=>{this._styleColorTheme.lutLoading=!1,b(new Error("Failed to load image data"))},L.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void y();this._styleColorTheme.lutLoading=!1;const{width:F,height:U,data:Y}=a.q.getImageData(L);if(U>32)return void b(new Error("The height of the image must be less than or equal to 32 pixels."));if(F!==U*U)return void b(new Error("The width of the image must be equal to the height squared."));this.getImage(I)&&this.removeImage(I),this.addImage(I,{data:new a.r({width:F,height:U},Y),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(I,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:o},y()):b(new Error("Missing LUT image."))}}))}getLut(o){const u=this._styleColorThemeForScope[o];return u?u.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=(function(u,y,b){let T,C,I;const L=a.q.devicePixelRatio>1?"@2x":"";let F=a.n(y.transformRequest(y.normalizeSpriteURL(u,L,".json"),a.R.SpriteJSON),((W,Q)=>{F=null,I||(I=W,T=Q,Y())})),U=a.o(y.transformRequest(y.normalizeSpriteURL(u,L,".png"),a.R.SpriteImage),((W,Q)=>{U=null,I||(I=W,C=Q,Y())}));function Y(){if(I)b(I);else if(T&&C){const W=a.q.getImageData(C),Q={};for(const le in T){const{width:oe,height:ue,x:de,y:xe,sdf:Te,pixelRatio:Me,stretchX:ke,stretchY:Fe,content:Ve}=T[le],Le=new a.r({width:oe,height:ue});a.r.copy(W,Le,{x:de,y:xe},{x:0,y:0},{width:oe,height:ue},null),Q[le]={data:Le,pixelRatio:Me,sdf:Te,stretchX:ke,stretchY:Fe,content:Ve,usvg:!1}}b(null,Q)}}return{cancel(){F&&(F.cancel(),F=null),U&&(U.cancel(),U=null)}}})(o,this.map._requestManager,((u,y)=>{if(this._spriteRequest=null,u)this.fire(new a.z(u));else if(y){const b=new Map;for(const T in y)b.set(a.I.from(T),y[T]);this.addImages(b)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.A("data",{dataType:"style"}))}))}addIconset(o,u){if(u.type==="sprite")return void this._loadSprite(u.url);const y=this.getOwnSourceCache(u.source);if(!y)return void this.fire(new a.z(new Error(`Source "${u.source}" as specified by iconset "${o}" does not exist and cannot be used as an iconset source`)));const b=y.getSource();if(b.type!=="raster-array")return void this.fire(new a.z(new Error(`Source "${u.source}" as specified by iconset "${o}" is not a "raster-array" source and cannot be used as an iconset source`)));b.partial=!1;const T=new _h(o,this.scope,y);this.imageManager.addImageProvider(T,this.scope)}removeIconset(o){this.imageManager.removeImageProvider(o,this.scope)}_loadIconset(o){if(!a.j(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const u=this.map._spriteFormat==="auto";var y,b;this._spriteRequest=(b=(T,C)=>{if(this._spriteRequest=null,T)u?this._loadSprite(o):this.fire(new a.z(T));else if(C){const I=new Map;for(const L in C)I.set(a.I.from(L),C[L]);this.addImages(I)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.A("data",{dataType:"style"}))},a.br((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(o),a.R.Iconset),((T,C)=>{if(T)return void b(T);const I={},L=a.da(new a.bq(C));for(const F of L.icons){const U={version:1,pixelRatio:a.q.devicePixelRatio,content:Iy(F),stretchX:F.metadata?yh(F.metadata.stretch_x_areas):void 0,stretchY:F.metadata?yh(F.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:F};I[F.name]=U}b(null,I)})))}_validateLayer(o){const u=this.getOwnSource(o.source);if(!u)return;const y=o.sourceLayer;y&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.z(new Error(`Source layer "${y}" does not exist on source "${u.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((o,u)=>{const y=this.fragments[u];return y&&y.style&&(o.data=y.style.serialize()),o}))}_serializeSources(){const o={};for(const u in this._sourceCaches){const y=this._sourceCaches[u].getSource();o[y.id]||(o[y.id]=y.serialize())}return o}_serializeLayers(o){const u=[];for(const y of o){const b=this._layers[y];b&&b.type!=="custom"&&u.push(b.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const u=this.getOwnLayer(o);if(u)return u;this.fire(new a.z(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const u=this.getOwnSource(o);if(u)return u;this.fire(new a.z(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,u){const y=this.map.painter;if(y)for(let b=o.minzoom||0;b<(o.maxzoom||25.5);b++){const T=o.getProgramIds();if(T)for(const C of T){const I=o.getDefaultProgramParams(C,u.zoom,this._styleColorTheme.lut);I&&(y.style=this,this.fog&&(y._fogVisible=!0,I.overrideFog=!0,y.getOrCreateProgram(C,I)),y._fogVisible=!1,I.overrideFog=!1,y.getOrCreateProgram(C,I),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(I.overrideRtt=!0,y.getOrCreateProgram(C,I)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const u=this.calculateLightsBrightness();o.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u)),o.worldview!==this._worldview&&(this._worldview=o.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const y=this._changes.isDirty();let b=!1;if(this._changes.isDirty()){const I=this._changes.getLayerUpdatesByScope();for(const L in I){const{updatedIds:F,removedIds:U}=I[L];(F||U)&&(this._updateWorkerLayers(L,F,U),b=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const T={};for(const I in this._mergedSourceCaches){const L=this._mergedSourceCaches[I];T[I]=L.used,L.used=!1,L.tileCoverLift=0}for(const I of this._mergedOrder){const L=this._mergedLayers[I];if(L.recalculate(o,this._availableImages),!L.isHidden(o.zoom)){const F=this.getLayerSourceCache(L);F&&(F.used=!0,F.tileCoverLift=Math.max(F.tileCoverLift,L.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(L,o)})):this.precompilePrograms(L,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&b&&this.mergeLayers();const C=this.imageManager.getPendingImageProviders();for(const I of C)I.sourceCache.used=!0;for(const I in T){const L=this._mergedSourceCaches[I];T[I]!==L.used&&L.getSource().fire(new a.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),y&&this.fire(new a.A("data",{dataType:"style"}))}updateImageProviders(){const o=this.imageManager.getPendingImageProviders();for(const u of o){const y=u.resolvePendingRequests(),b=this.getFragmentStyle(u.scope);b&&b.addImages(y)}}_updateTilesForChangedImages(){const o={};for(const u in this._mergedSourceCaches){const y=this._mergedSourceCaches[u].getSource().scope;o[y]=o[y]||this._changes.getUpdatedImages(y),o[y].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o[y])}for(const u in o)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(o,u,y){const b=this.getFragmentStyle(o);b&&this.dispatcher.broadcast("updateLayers",{layers:u?b._serializeLayers(u):[],scope:o,removedIds:y||[],options:b.options})}setState(o,u){if(this._checkLoaded(),Hc(this,Ra(o)))return!1;(o=a.di(o)).layers=uh(o.layers);const y=(function(C,I){if(!C)return[{command:Fr.setStyle,args:[I]}];let L=[];try{if(!a.bv(C.version,I.version))return[{command:Fr.setStyle,args:[I]}];if(a.bv(C.center,I.center)||L.push({command:Fr.setCenter,args:[I.center]}),a.bv(C.zoom,I.zoom)||L.push({command:Fr.setZoom,args:[I.zoom]}),a.bv(C.bearing,I.bearing)||L.push({command:Fr.setBearing,args:[I.bearing]}),a.bv(C.pitch,I.pitch)||L.push({command:Fr.setPitch,args:[I.pitch]}),a.bv(C.sprite,I.sprite)||L.push({command:Fr.setSprite,args:[I.sprite]}),a.bv(C.glyphs,I.glyphs)||L.push({command:Fr.setGlyphs,args:[I.glyphs]}),a.bv(C.imports,I.imports)||(function(Q=[],le=[],oe){le=le||[];const ue=(Q=Q||[]).map(Al),de=le.map(Al),xe=Q.reduce(mc,{}),Te=le.reduce(mc,{}),Me=ue.slice();let ke,Fe,Ve,Le;for(ke=0,Fe=0;ke<ue.length;ke++)Ve=ue[ke],Te.hasOwnProperty(Ve)?Fe++:(oe.push({command:Fr.removeImport,args:[Ve]}),Me.splice(Me.indexOf(Ve,Fe),1));for(ke=0,Fe=0;ke<de.length;ke++)Ve=de[de.length-1-ke],Me[Me.length-1-ke]!==Ve&&(xe.hasOwnProperty(Ve)?(oe.push({command:Fr.removeImport,args:[Ve]}),Me.splice(Me.lastIndexOf(Ve,Me.length-Fe),1)):Fe++,Le=Me[Me.length-ke],oe.push({command:Fr.addImport,args:[Te[Ve],Le]}),Me.splice(Me.length-ke,0,Ve));for(const Ne of le){const je=xe[Ne.id];je&&(delete je.data,a.bv(je,Ne)||oe.push({command:Fr.updateImport,args:[Ne.id,Ne]}))}})(C.imports,I.imports,L),a.bv(C.transition,I.transition)||L.push({command:Fr.setTransition,args:[I.transition]}),a.bv(C.light,I.light)||L.push({command:Fr.setLight,args:[I.light]}),a.bv(C.fog,I.fog)||L.push({command:Fr.setFog,args:[I.fog]}),a.bv(C.snow,I.snow)||L.push({command:Fr.setSnow,args:[I.snow]}),a.bv(C.rain,I.rain)||L.push({command:Fr.setRain,args:[I.rain]}),a.bv(C.projection,I.projection)||L.push({command:Fr.setProjection,args:[I.projection]}),a.bv(C.lights,I.lights)||L.push({command:Fr.setLights,args:[I.lights]}),a.bv(C.camera,I.camera)||L.push({command:Fr.setCamera,args:[I.camera]}),a.bv(C.iconsets,I.iconsets)||(function(Q,le,oe){let ue;for(ue in le=le||{},Q=Q||{})Q.hasOwnProperty(ue)&&(le.hasOwnProperty(ue)||oe.push({command:Fr.removeIconset,args:[ue]}));for(ue in le){if(!le.hasOwnProperty(ue))continue;const de=le[ue];Q.hasOwnProperty(ue)?a.bv(Q[ue],de)||(oe.push({command:Fr.removeIconset,args:[ue]}),oe.push({command:Fr.addIconset,args:[ue,de]})):oe.push({command:Fr.addIconset,args:[ue,de]})}})(C.iconsets,I.iconsets,L),!a.bv(C["color-theme"],I["color-theme"]))return[{command:Fr.setStyle,args:[I]}];const F={},U=[];(function(Q,le,oe,ue){let de;for(de in le=le||{},Q=Q||{})Q.hasOwnProperty(de)&&(le.hasOwnProperty(de)||jc(de,oe,ue));for(de in le){if(!le.hasOwnProperty(de))continue;const xe=le[de];Q.hasOwnProperty(de)?a.bv(Q[de],xe)||(Q[de].type==="geojson"&&xe.type==="geojson"&&Bc(Q,le,de)?oe.push({command:Fr.setGeoJSONSourceData,args:[de,xe.data]}):pc(de,le,oe,ue)):hl(de,le,oe)}})(C.sources,I.sources,U,F);const Y=[];C.layers&&C.layers.forEach((Q=>{Q.source&&F[Q.source]?L.push({command:Fr.removeLayer,args:[Q.id]}):Y.push(Q)}));let W=C.terrain;W&&F[W.source]&&(L.push({command:Fr.setTerrain,args:[void 0]}),W=void 0),L=L.concat(U),a.bv(W,I.terrain)||L.push({command:Fr.setTerrain,args:[I.terrain]}),(function(Q,le,oe){le=le||[];const ue=(Q=Q||[]).map(Al),de=le.map(Al),xe=Q.reduce(mc,{}),Te=le.reduce(mc,{}),Me=ue.slice(),ke=Object.create(null);let Fe,Ve,Le,Ne,je,dt,Ze;for(Fe=0,Ve=0;Fe<ue.length;Fe++)Le=ue[Fe],Te.hasOwnProperty(Le)?Ve++:(oe.push({command:Fr.removeLayer,args:[Le]}),Me.splice(Me.indexOf(Le,Ve),1));for(Fe=0,Ve=0;Fe<de.length;Fe++)Le=de[de.length-1-Fe],Me[Me.length-1-Fe]!==Le&&(xe.hasOwnProperty(Le)?(oe.push({command:Fr.removeLayer,args:[Le]}),Me.splice(Me.lastIndexOf(Le,Me.length-Ve),1)):Ve++,dt=Me[Me.length-Fe],oe.push({command:Fr.addLayer,args:[Te[Le],dt]}),Me.splice(Me.length-Fe,0,Le),ke[Le]=!0);for(Fe=0;Fe<de.length;Fe++)if(Le=de[Fe],Ne=xe[Le],je=Te[Le],!ke[Le]&&!a.bv(Ne,je))if(a.bv(Ne.source,je.source)&&a.bv(Ne["source-layer"],je["source-layer"])&&a.bv(Ne.type,je.type)){for(Ze in pu(Ne.layout,je.layout,oe,Le,null,Fr.setLayoutProperty),pu(Ne.paint,je.paint,oe,Le,null,Fr.setPaintProperty),a.bv(Ne.slot,je.slot)||oe.push({command:Fr.setSlot,args:[Le,je.slot]}),a.bv(Ne.filter,je.filter)||oe.push({command:Fr.setFilter,args:[Le,je.filter]}),a.bv(Ne.minzoom,je.minzoom)&&a.bv(Ne.maxzoom,je.maxzoom)||oe.push({command:Fr.setLayerZoomRange,args:[Le,je.minzoom,je.maxzoom]}),Ne)Ne.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&Ze!=="slot"&&(Ze.indexOf("paint.")===0?pu(Ne[Ze],je[Ze],oe,Le,Ze.slice(6),Fr.setPaintProperty):a.bv(Ne[Ze],je[Ze])||oe.push({command:Fr.setLayerProperty,args:[Le,Ze,je[Ze]]}));for(Ze in je)je.hasOwnProperty(Ze)&&!Ne.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&Ze!=="slot"&&(Ze.indexOf("paint.")===0?pu(Ne[Ze],je[Ze],oe,Le,Ze.slice(6),Fr.setPaintProperty):a.bv(Ne[Ze],je[Ze])||oe.push({command:Fr.setLayerProperty,args:[Le,Ze,je[Ze]]}))}else oe.push({command:Fr.removeLayer,args:[Le]}),dt=Me[Me.lastIndexOf(Le)+1],oe.push({command:Fr.addLayer,args:[je,dt]})})(Y,I.layers,L)}catch(F){console.warn("Unable to compute style diff:",F),L=[{command:Fr.setStyle,args:[I]}]}return L})(this.serialize(),o).filter((C=>!(C.command in vh)));if(y.length===0)return!1;const b=y.filter((C=>!(C.command in Dy)));if(b.length>0)throw new Error(`Unimplemented: ${b.map((C=>C.command)).join(", ")}.`);const T=[];return y.forEach((C=>{T.push(this[C.command](...C.args))})),u&&Promise.all(T).then(u).catch(u),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(o){if(o.size===0)return this;for(const[u,y]of o.entries()){if(this.getImage(u))return this.fire(new a.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,y),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this}addImage(o,u){return this.getImage(o)?this.fire(new a.z(new Error(`An image with the name "${o.name}" already exists.`))):(this.imageManager.addImage(o,this.scope,u),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this)}updateImage(o,u,y=!1){this.imageManager.updateImage(o,this.scope,u),y&&(this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})))}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this):this.fire(new a.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(o){return this.modelManager.addModelURLs(o,this.scope),this._updateWorkerModels(),this.fire(new a.A("data",{dataType:"style"})),this}addModel(o,u,y={}){return this._checkLoaded(),this._validate(Ae,`models.${o}`,u,null,y)||(this.modelManager.addModel(o,u,this.scope),this.fire(new a.A("data",{dataType:"style"}))),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope,!1,!0),this.fire(new a.A("data",{dataType:"style"})),this):this.fire(new a.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,u,y={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(ya,`sources.${o}`,u,null,y))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const b=fu(o,u,this.dispatcher,this);b.scope=this.scope,b.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(b.id),source:b.serialize(),sourceId:b.id})));const T=C=>{const I=(C?"symbol:":"other:")+b.id,L=a.C(I,this.scope),F=this._sourceCaches[I]=new Zo(L,b,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[b.id]=F,F.onAdd(this.map)};T(!1),u.type!=="vector"&&u.type!=="geojson"||T(!0),b.onAdd&&b.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const u=this.getOwnSource(o);if(!u)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===o)return this.fire(new a.z(new Error(`Source "${o}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new a.z(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const b=Object.entries(this.stylesheet.iconsets).find((([T,C])=>C.type==="source"&&C.source===o));if(b)return this.fire(new a.z(new Error(`Source "${o}" cannot be removed while iconset "${b[0]}" is using it.`)))}const y=this.getOwnSourceCaches(o);for(const b of y){const T=a.dj(b.id);delete this._sourceCaches[T],this._changes.discardSourceCacheUpdate(b.id),b.fire(new a.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,u){this._checkLoaded(),this.getOwnSource(o).setData(u),this._changes.setDirty()}getOwnSource(o){const u=this.getOwnSourceCache(o);return u&&u.getSource()}getOwnSources(){const o=[];for(const u in this._otherSourceCaches){const y=this.getOwnSourceCache(u);y&&o.push(y.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const u in o){const y=o[u]._tiles;for(const b in y){const T=y[b];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const T of o){if(this._validate(dr,"lights",T))return;switch(T.type){case"ambient":if(this.ambientLight){const C=this.ambientLight;C.set(T),C.updateTransitions(u)}else this.ambientLight=new yi(T,jr||(jr=new a.a7({color:new a.a8(a.a5.properties_light_ambient.color),"color-use-theme":new a.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.a8(a.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const C=this.directionalLight;C.set(T),C.updateTransitions(u)}else this.directionalLight=new yi(T,da||(da=new a.a7({direction:new a.an(a.a5.properties_light_directional.direction),color:new a.a8(a.a5.properties_light_directional.color),"color-use-theme":new a.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.a8(a.a5.properties_light_directional.intensity),"cast-shadows":new a.a8(a.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new a.a8(a.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new a.a8(a.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=Object.assign(u,{worldview:this.map.getWorldview()}),b=new a.aa(this.z||0,y);this.ambientLight&&this.ambientLight.recalculate(b),this.directionalLight&&this.directionalLight.recalculate(b),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,u=this.ambientLight;if(!o||!u)return;const y=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),b=o.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),T=o.properties.get("intensity"),C=o.properties.get("direction"),I=1-a.d1(C.x,C.y,C.z)[2]/90,L=y(b)*T*I,F=u.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),U=u.properties.get("intensity"),Y=y(F)*U;return Number(((L+Y)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(o==null||o===""&&this.isRootStyle())return this;if(a.dk(o)){const u=a.dl(o),y=this.fragments.find((({id:T})=>T===u));if(!y)return;const b=a.dj(o);return y.style.getFragmentStyle(b)}{const u=this.fragments.find((({id:y})=>y===o));return u?u.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const u={},y=(b,T="")=>`${b}::${T}`;this._featuresetSelectors={};for(const b in o){const T=this._featuresetSelectors[b]=[];for(const C of o[b].selectors){if(C.featureNamespace){const L=this.getOwnLayer(C.layer);if(!L){a.w(`Layer is undefined for selector: ${C.layer}`);continue}const F=y(L.source,L.sourceLayer);if(F in u&&u[F]!==C.featureNamespace){a.w(`"featureNamespace ${C.featureNamespace} of featureset ${b}'s selector is not associated to the same source, skip this selector`);continue}u[F]=C.featureNamespace}let I;if(C.properties)for(const L in C.properties){const F=a.X(C.properties[L]);F.result==="success"&&(I=I||{},I[L]=F.value)}T.push({layerId:C.layer,namespace:C.featureNamespace,properties:I,uniqueFeatureID:C._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const u=this.getFragmentStyle(o);if(!u||!u.stylesheet.featuresets)return[];const y=[];for(const b in u.stylesheet.featuresets)y.push({featuresetId:b,importId:u.scope?u.scope:void 0});return y}getFeaturesetLayers(o,u){const y=this.getFragmentStyle(u),b=y.stylesheet.featuresets;if(!b||!b[o])return this.fire(new a.z(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const T=[];for(const C of b[o].selectors){const I=y.getOwnLayer(C.layer);I&&T.push(I)}return T}getConfigProperty(o,u){const y=this.getFragmentStyle(o);if(!y)return null;const b=a.C(u,y.scope),T=y.options.get(b),C=T?T.value||T.default:null;return C?C.serialize():null}setConfigProperty(o,u,y){const b=this.getFragmentStyle(o);if(!b)return;const T=b.stylesheet.indoor?lf(b.stylesheet.schema):b.stylesheet.schema;if(!T||!T[u])return;const C=a.X(y);if(C.result!=="success")return void Hc(this,C.value);const I=C.value.expression,L=a.C(u,b.scope),F=b.options.get(L);if(!F)return;let U;const{minValue:Y,maxValue:W,stepValue:Q,type:le,values:oe}=T[u],ue=a.X(T[u].default);ue.result==="success"&&(U=ue.value.expression),U?(this.options.set(L,Object.assign({},F,{value:I,default:U,minValue:Y,maxValue:W,stepValue:Q,type:le,values:oe})),this.updateConfigDependencies(u)):this.fire(new a.z(new Error(`No schema defined for the config option "${u}" in the "${o}" fragment.`)))}getConfig(o){const u=this.getFragmentStyle(o);if(!u)return null;const y=u.stylesheet.schema;if(!y)return null;const b={};for(const T in y){const C=a.C(T,u.scope),I=u.options.get(C),L=I?I.value||I.default:null;b[T]=L?L.serialize():null}return b}setConfig(o,u){const y=this.getFragmentStyle(o);y&&(y.updateConfig(u,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const u=this.getFragmentStyle(o);return u?u.stylesheet.schema:null}setSchema(o,u){const y=this.getFragmentStyle(o);y&&(y.stylesheet.schema=u,y.updateConfig(y._config,u),this.updateConfigDependencies())}updateConfig(o,u){if(this._config=o,o||u)if(u)for(const y in u){let b,T;const C=a.X(u[y].default);if(C.result==="success"&&(b=C.value.expression),o&&o[y]!==void 0){const W=a.X(o[y]);W.result==="success"&&(T=W.value.expression)}const{minValue:I,maxValue:L,stepValue:F,type:U,values:Y}=u[y];if(b){const W=a.C(y,this.scope);this.options.set(W,{default:b,value:T,minValue:I,maxValue:L,stepValue:F,type:U,values:Y})}else this.fire(new a.z(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new a.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const u of this._configDependentLayers){const y=this.getLayer(u);if(y){if(o&&!y.configDependencies.has(o))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle((u=>{const y=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(y){const b=u._evaluateColorThemeData(y);(!u._styleColorTheme.lut&&b!==""||u._styleColorTheme.lut&&b!==u._styleColorTheme.lut.data)&&u.setColorTheme(y)}})),this._changes.setDirty()}addLayer(o,u,y={}){this._checkLoaded();const b=o.id;if(this._layers[b])return void this.fire(new a.z(new Error(`Layer with id "${b}" already exists on this map`)));let T;if(o.type==="custom"){if(Hc(this,a.dm(o)))return;T=a.dn(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(b,o.source),o=a.di(o),o=a.h(o,{source:b})),this._validate(hr,`layers.${b}`,o,{arrayIndex:-1},y))return;T=a.dn(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(T),T.setEventedParent(this,{layer:{id:b}})}T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid);let C=this._order.length;if(u){const U=this._order.indexOf(u);if(U===-1)return void this.fire(new a.z(new Error(`Layer with id "${u}" does not exist on this map.`)));T.slot===this._layers[u].slot?C=U:a.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,b),this._layerOrderChanged=!0,this._layers[b]=T;const I=this.getOwnLayerSourceCache(T),L=!!this.directionalLight&&this.directionalLight.shadowsEnabled();I&&T.canCastShadows()&&L&&(I.castsShadows=!0);const F=this._changes.getRemovedLayer(T);if(F&&T.source&&I&&T.type!=="custom"){this._changes.discardLayerRemoval(T);const U=a.C(T.source,T.scope);F.type!==T.type?this._changes.updateSourceCache(U,"clear"):(this._changes.updateSourceCache(U,"reload"),I.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),T.scope=this.scope,this.mergeLayers()}moveLayer(o,u){this._checkLoaded();const y=this._checkLayer(o);if(!y||o===u)return;const b=this._order.indexOf(o);this._order.splice(b,1);let T=this._order.length;if(u){const C=this._order.indexOf(u);if(C===-1)return void this.fire(new a.z(new Error(`Layer with id "${u}" does not exist on this map.`)));y.slot===this._layers[u].slot?T=C:a.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(T,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const u=this._checkLayer(o);if(!u)return;u.setEventedParent(null);const y=this._order.indexOf(o);this._order.splice(y,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const b=this.getOwnLayerSourceCache(u);if(b&&b.castsShadows){let T=!1;for(const C in this._layers)if(this._layers[C].source===u.source&&this._layers[C].canCastShadows()){T=!0;break}b.castsShadows=T}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const u in this._layers)if(this._layers[u].type===o)return!0;return!1}setLayerZoomRange(o,u,y){this._checkLoaded();const b=this._checkLayer(o);b&&(b.minzoom===u&&b.maxzoom===y||(u!=null&&(b.minzoom=u),y!=null&&(b.maxzoom=y),this._updateLayer(b)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,u){this._checkLoaded();const y=this._checkLayer(o);y&&y.slot!==u&&(y.slot=u,this._updateLayer(y))}setFilter(o,u,y={}){this._checkLoaded();const b=this._checkLayer(o);if(b&&!a.bv(b.filter,u))return u==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(ot,`layers.${b.id}.filter`,u,{layerType:b.type},y)||(b.filter=a.di(u),this._updateLayer(b)))}getFilter(o){const u=this._checkLayer(o);if(u)return a.di(u.filter)}setLayoutProperty(o,u,y,b={}){this._checkLoaded();const T=this._checkLayer(o);if(T&&!a.bv(T.getLayoutProperty(u),y)){if(y!=null&&(!b||b.validate!==!1)&&Hc(T,ye.call(Ra,{key:`layers.${o}.layout.${u}`,layerType:T.type,objectKey:u,value:y,styleSpec:a.a5,style:{glyphs:!0,sprite:!0}})))return;T.setLayoutProperty(u,y),T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),this._updateLayer(T)}}getLayoutProperty(o,u){const y=this._checkLayer(o);if(y)return y.getLayoutProperty(u)}setPaintProperty(o,u,y,b={}){this._checkLoaded();const T=this._checkLayer(o);if(!T||a.bv(T.getPaintProperty(u),y)||y!=null&&(!b||b.validate!==!1)&&Hc(T,he.call(Ra,{key:`layers.${o}.paint.${u}`,layerType:T.type,objectKey:u,value:y,styleSpec:a.a5})))return;const C=T.setPaintProperty(u,y);T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),C&&this._updateLayer(T),this._changes.updatePaintProperties(T)}getPaintProperty(o,u){const y=this._checkLayer(o);if(y)return y.getPaintProperty(u)}setFeatureState(o,u){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:L,importId:F}=o.target,U=this.getFragmentStyle(F),Y=U.getFeaturesetLayers(L);for(const{source:W,sourceLayer:Q}of Y)U.setFeatureState({id:o.id,source:W,sourceLayer:Q},u)}else if("layerId"in o.target){const{layerId:L}=o.target,F=this.getLayer(L);this.setFeatureState({id:o.id,source:F.source,sourceLayer:F.sourceLayer},u)}return}const y=o.source,b=o.sourceLayer,T=this._checkSource(y);if(!T)return;const C=T.type;if(C==="geojson"&&b)return void this.fire(new a.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!b)return void this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new a.z(new Error("The feature id parameter must be provided.")));const I=this.getOwnSourceCaches(y);for(const L of I)L.setFeatureState(b,o.id,u)}removeFeatureState(o,u){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:L,importId:F}=o.target,U=this.getFragmentStyle(F),Y=U.getFeaturesetLayers(L);for(const{source:W,sourceLayer:Q}of Y)U.removeFeatureState({id:o.id,source:W,sourceLayer:Q},u)}else if("layerId"in o.target){const{layerId:L}=o.target,F=this.getLayer(L);this.removeFeatureState({id:o.id,source:F.source,sourceLayer:F.sourceLayer},u)}return}const y=o.source,b=this._checkSource(y);if(!b)return;const T=b.type,C=T==="vector"?o.sourceLayer:void 0;if(T==="vector"&&!C)return void this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new a.z(new Error("A feature id is required to remove its specific state property.")));const I=this.getOwnSourceCaches(y);for(const L of I)L.removeFeatureState(C,o.id,u)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let T;if("featuresetId"in o.target){const{featuresetId:C,importId:I}=o.target,L=this.getFragmentStyle(I),F=L.getFeaturesetLayers(C);for(const{source:U,sourceLayer:Y}of F){const W=L.getFeatureState({id:o.id,source:U,sourceLayer:Y});if(W&&!T)T=W;else if(!a.bv(T,W))return void this.fire(new a.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:C}=o.target,I=this.getLayer(C);T=this.getFeatureState({id:o.id,source:I.source,sourceLayer:I.sourceLayer})}return T}const u=o.source,y=o.sourceLayer,b=this._checkSource(u);if(b){if(b.type!=="vector"||y)return o.id===void 0&&this.fire(new a.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(y,o.id);this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=a.h({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return a.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),u=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return a.dp({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(y=>y!==void 0))}_updateFilteredLayers(o){for(const u of Object.values(this._mergedLayers))o(u)&&this._updateLayer(u)}_updateLayer(o){this._changes.updateLayer(o);const u=this.getLayerSourceCache(o),y=a.C(o.source,o.scope),b=this._changes.getUpdatedSourceCaches();o.source&&!b[y]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),u.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const u=I=>this._mergedLayers[I].is3D(!!this.terrain),y=this.order,b={},T=[];for(let I=y.length-1;I>=0;I--){const L=y[I];if(u(L)){b[L]=I;for(const F of o){const U=F[L];if(U)for(const Y of U)T.push(Y)}}}T.sort(((I,L)=>L.intersectionZ-I.intersectionZ));const C=[];for(let I=y.length-1;I>=0;I--){const L=y[I];if(u(L))for(let F=T.length-1;F>=0;F--){const U=T[F].feature;if(U.layer&&b[U.layer.id]<I)break;C.push(U),T.pop()}else for(const F of o){const U=F[L];if(U)for(const Y of U)C.push(Y.feature)}}return C}queryRenderedFeatures(o,u,y){let b;u&&!Array.isArray(u)&&u.filter&&(this._validate(ot,"queryRenderedFeatures.filter",u.filter,null,u),b=a.b3(u.filter));const T={},C=U=>{if(Mp.has(U.type))return;const Y=this.getOwnLayerSourceCache(U),W=T[Y.id]=T[Y.id]||{sourceCache:Y,layers:{},has3DLayers:!1};U.is3D(!!this.terrain)&&(W.has3DLayers=!0),W.layers[U.fqid]=W.layers[U.fqid]||{styleLayer:U,targets:[]},W.layers[U.fqid].targets.push({filter:b})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.z(new Error("parameters.layers must be an Array."))),[];for(const U of u.layers){const Y=this._layers[U];if(!Y)return this.fire(new a.z(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];C(Y)}}else for(const U in this._layers)C(this._layers[U]);const I=this._queryRenderedFeatures(o,T,y),L=this._flattenAndSortRenderedFeatures(I),F=[];for(const U of L)a.dq(U.layer.id)===this.scope&&F.push(U);return F}queryRenderedFeatureset(o,u,y){let b;u&&!Array.isArray(u)&&u.filter&&(this._validate(ot,"queryRenderedFeatures.filter",u.filter,null,u),b=a.b3(u.filter));const T="mock",C=[];if(u&&u.target)C.push(Object.assign({},u,{targetId:T,filter:b}));else{const U=this.getFeaturesetDescriptors();for(const Y of U)C.push({targetId:T,filter:b,target:Y});for(const{style:Y}of this.fragments){const W=Y.getFeaturesetDescriptors();for(const Q of W)C.push({targetId:T,filter:b,target:Q})}}const I=this.queryRenderedTargets(o,C,y),L=[],F=new Set;for(const U of I)for(const Y of U.variants[T])rd(Y,U,F)||L.push(new a.dr(U,Y));return L}queryRenderedTargets(o,u,y){const b={},T=(I,L,F,U)=>{const Y=b[L.id]=b[L.id]||{sourceCache:L,layers:{},has3DLayers:!1};if(Y.layers[I.fqid]=Y.layers[I.fqid]||{styleLayer:I,targets:[]},I.is3D(!!this.terrain)&&(Y.has3DLayers=!0),!U)return F.uniqueFeatureID=!1,void Y.layers[I.fqid].targets.push(F);Y.layers[I.fqid].targets.push(Object.assign({},F,{namespace:U.namespace,properties:U.properties,uniqueFeatureID:U.uniqueFeatureID}))};for(const I of u)if("featuresetId"in I.target){const{featuresetId:L,importId:F}=I.target,U=this.getFragmentStyle(F);if(!U||!U._featuresetSelectors)continue;const Y=U._featuresetSelectors[L];if(!Y){this.fire(new a.z(new Error(`The featureset '${L}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of Y){const Q=U.getOwnLayer(W.layerId);Q&&!Mp.has(Q.type)&&T(Q,U.getOwnLayerSourceCache(Q),I,W)}}else if("layerId"in I.target){const{layerId:L}=I.target,F=this.getLayer(L);if(!F||Mp.has(F.type))continue;T(F,this.getLayerSourceCache(F),I)}const C=this._queryRenderedFeatures(o,b,y);return this._flattenAndSortRenderedFeatures(C)}_queryRenderedFeatures(o,u,y){const b=[],T=!!this.map._showQueryGeometry,C=Qr.createFromScreenPoints(o,y);for(const I in u){const L=Nc(C,u[I],this._availableImages,y,T);Object.keys(L).length&&b.push(L)}if(this.placement)for(const I in u){if(!u[I].sourceCache._onlySymbols)continue;const L=jl(C.screenGeometry,u[I],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(L).length&&b.push(L)}return b}querySourceFeatures(o,u){const y=u&&u.filter;y&&this._validate(ot,"querySourceFeatures.filter",y,null,u);let b=[];const T=this.getOwnSourceCaches(o);for(const C of T)b=b.concat(bo(C,u));return b}addSourceType(o,u,y){return Gl.getSourceType(o)?y(new Error(`A source type called "${o}" already exists.`)):(Gl.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,u,y={}){this._checkLoaded();const b=this.light.getLight();let T=!1;for(const I in o)if(!a.bv(o[I],b[I])){T=!0;break}if(!T)return;const C=this._getTransitionParameters();this.light.setLight(o,u,y),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,u=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=o;const b=o.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const I="terrain-dem-src";this.addSource(I,y.source),y=a.di(y),y=a.h(y,{source:I})}const T=a.h({},y),C={};if(this.terrain&&b){T.source=this.terrain.get().source;const I=this.terrain?this.getFragmentStyle(this.terrain.scope):null;I&&(C.style=I.serialize())}if(this._validate(kt,"terrain",T,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!b||this.terrain&&u!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,u),this.fire(new a.A("data",{dataType:"style"}))}else{const T=this.terrain,C=T.get();for(const I of Object.keys(a.a5.terrain))!y.hasOwnProperty(I)&&a.a5.terrain[I].default&&(y[I]=a.a5.terrain[I].default);for(const I in o)if(!a.bv(o[I],C[I])){T.set(o,this.options),this.stylesheet.terrain=o;const L=this._getTransitionParameters({duration:0});T.updateTransitions(L),this.fire(new a.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const u=this.fog=new gr(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_createSnow(o){const u=this.snow=new Ia(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_createRain(o){const u=this.rain=new $a(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const o of this.map._markers)o._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!a.bv(u.get(),o)){u.set(o,this.options),this.stylesheet.fog=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!a.bv(u.get(),o)){u.set(o,this.options),this.stylesheet.snow=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!a.bv(u.get(),o)){u.set(o,this.options),this.stylesheet.rain=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const b in this._layers)this._layers[b].lut=this._styleColorTheme.lut;for(const b in this._sourceCaches)this._sourceCaches[b].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void o();const y=this._evaluateColorThemeData(u);this._loadColorTheme(y).then((()=>{this.fire(new a.A("colorthemeset")),o()})).catch((b=>{a.w(`Couldn't set color theme: ${b}`)}))}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&a.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,u){const y=this.getFragmentStyle(o);y&&(y._styleColorTheme.colorThemeOverride=u,y._reloadColorTheme())}_getTransitionParameters(o){return{now:a.q.now(),transition:a.h(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],u=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?o.push(y):u.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...u)}_createTerrain(o,u){const y=this.terrain=new et(o,u,this.scope,this.options,this.map.getWorldview());u===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const b=this._getTransitionParameters({duration:0});y.updateTransitions(b)}_force3DLayerUpdate(){for(const o in this._layers){const u=this._layers[o];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const u=this._layers[o];u.type==="symbol"&&this._updateLayer(u)}}_validate(o,u,y,b,T={}){if(T&&T.validate===!1)return!1;const C=a.h({},this.serialize());return Hc(this,o.call(Ra,a.h({key:u,style:C,value:y,styleSpec:a.a5},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.ds.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(o){const u=this.getSourceCaches(o);for(const y of u)y.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}clearLayers(){for(const o in this._mergedLayers){const u=this._mergedLayers[o];u._clear&&u._clear()}}reloadSource(o){const u=this.getSourceCaches(o);for(const y of u)y.resume(),y.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle((o=>{o.modelManager.reloadModels(o.scope)}))}updateSources(o){let u;this.directionalLight&&(u=cd(this.directionalLight));const y=new Set;for(const b in this._mergedLayers){const T=this._mergedLayers[b];T.hasElevation()&&!y.has(T.source)&&y.add(T.source)}for(const b in this._mergedSourceCaches){const T=this._mergedSourceCaches[b],C=y.has(T._source.id);T.update(o,void 0,void 0,u,C)}}_generateCollisionBoxes(){for(const o in this._sourceCaches){const u=this._sourceCaches[o];u.resume(),u.reload()}}_updatePlacement(o,u,y,b,T,C,I=!1){let L=!1,F=!1;const U={},Y={};for(const W of this._mergedOrder){const Q=this._mergedLayers[W];if(Q.type!=="symbol")continue;const le=a.C(Q.source,Q.scope);let oe=U[le];if(!oe){const de=this.getLayerSourceCache(Q);if(!de)continue;const xe=de.getRenderableIds(!0).map((Te=>de.getTileByID(Te)));Y[le]=xe.slice(),oe=U[le]=xe.sort(((Te,Me)=>Me.tileID.overscaledZ-Te.tileID.overscaledZ||(Te.tileID.isLessThan(Me.tileID)?-1:1)))}const ue=this.crossTileSymbolIndex.addLayer(Q,oe,u.center.lng,u.projection);L=L||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),I=I||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new a.A("neworder")),(I||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.q.now(),u.zoom))&&(this.pauseablePlacement=new Zi(u,this._mergedOrder,I,y,b,T,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,U,Y,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.q.now()),F=!0),L&&this.pauseablePlacement.placement.setStale()),F||L){this._buildingIndex.onNewFrame(u.zoom);for(let W=0;W<this._mergedOrder.length;W++){const Q=this._mergedLayers[this._mergedOrder[W]];if(Q.type!=="symbol")continue;const le=this.isLayerClipped(Q);this.placement.updateLayerOpacities(Q,U[a.C(Q.source,Q.scope)],W,le?C:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,u){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex((({id:T})=>T===o.id))!==-1)return void this.fire(new a.z(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!u)return y.push(o),this._loadImports([o],!0);const b=y.findIndex((({id:T})=>T===u));return b===-1&&this.fire(new a.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,b).concat(o).concat(y.slice(b)),this._loadImports([o],!0,u)}updateImport(o,u){this._checkLoaded();const y=this.stylesheet.imports||[],b=this.getImportIndex(o);return b===-1?this:typeof u=="string"?(this.setImportUrl(o,u),this):(u.url&&u.url!==y[b].url&&this.setImportUrl(o,u.url),a.bv(u.config,y[b].config)||this.setImportConfig(o,u.config,u.data.schema),a.bv(u.data,y[b].data)||this.setImportData(o,u.data),this)}moveImport(o,u){this._checkLoaded();let y=this.stylesheet.imports||[];const b=this.getImportIndex(o);if(b===-1)return this;const T=this.getImportIndex(u);if(T===-1)return this;const C=y[b],I=this.fragments[b];return y=y.filter((({id:L})=>L!==o)),this.fragments=this.fragments.filter((({id:L})=>L!==o)),this.stylesheet.imports=y.slice(0,T).concat(C).concat(y.slice(T)),this.fragments=this.fragments.slice(0,T).concat(I).concat(this.fragments.slice(T)),this.mergeLayers(),this}setImportUrl(o,u){this._checkLoaded();const y=this.stylesheet.imports||[],b=this.getImportIndex(o);if(b===-1)return this;y[b].url=u;const T=this.fragments[b];return T.style=this._createFragmentStyle(y[b]),T.style.on("style.import.load",(()=>this.mergeAll())),T.style.loadURL(u),this}setImportData(o,u){this._checkLoaded();const y=this.getImportIndex(o),b=this.stylesheet.imports||[];return y===-1?this:u?(this.fragments[y].style.setState(u),this._reloadImports(),this):(delete b[y].data,this.setImportUrl(o,b[y].url))}setImportConfig(o,u,y){this._checkLoaded();const b=this.getImportIndex(o),T=this.stylesheet.imports||[];if(b===-1)return this;u?T[b].config=u:delete T[b].config;const C=this.fragments[b];y&&C.style.stylesheet&&(C.style.stylesheet.schema=y);const I=C.style.stylesheet&&C.style.stylesheet.schema;return C.config=u,C.style.updateConfig(u,I),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const u=this.stylesheet.imports||[],y=this.getImportIndex(o);y!==-1&&(u.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(o){const u=(this.stylesheet.imports||[]).findIndex((y=>y.id===o));return u===-1&&this.fire(new a.z(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),u}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const u in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[u];y&&o.push(y.getSource())}return o}getSource(o,u){const y=this.getSourceCache(o,u);return y&&y.getSource()}getLayerSource(o){const u=this.getLayerSourceCache(o);return u&&u.getSource()}getSourceCache(o,u){const y=a.C(o,u);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(o){const u=a.C(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[o]&&u.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&u.push(this._mergedSymbolSourceCaches[o]),u}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const u in o){const y=o[u];y==="reload"?this.reloadSource(u):y==="clear"&&this.clearSource(u)}}updateLayers(o){const u=this._changes.getUpdatedPaintProperties();for(const y of u){const b=this.getLayer(y);b&&b.updateTransitions(o)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(o){this.stylesheet.glyphs=o,this.glyphManager.setURL(o)}getImages(o,u,y){this.imageManager.getImages(u.images,u.scope,y),this._updateTilesForChangedImages();const b=C=>{if(C){const I=u.images.map((L=>a.I.toString(L)));C.setDependencies(u.tileID.key,u.type,I)}},T=a.C(u.source,u.scope);b(this._mergedOtherSourceCaches[T]),b(this._mergedSymbolSourceCaches[T]),u.images.some((C=>C.iconsetId))&&this.fire(new a.A("data",{dataType:"style"}))}rasterizeImages(o,u,y){this.imageManager.rasterizeImages(u,y)}getGlyphs(o,u,y){this.glyphManager.getGlyphs(u.stacks,y)}getResource(o,u,y){return a.dt(u,y)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const u=[];return this._otherSourceCaches[o]&&u.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&u.push(this._symbolSourceCaches[o]),u}_isSourceCacheLoaded(o){const u=this.getOwnSourceCaches(o);return u.length===0?(this.fire(new a.z(new Error(`There is no source with ID '${o}'`))),!1):u.every((y=>y.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,u){if(!this._clipLayerPresent&&o.type!=="fill-extrusion"&&o.type!=="building")return!1;const y=o.type==="fill-extrusion"&&(o.sourceLayer==="building"||o.sourceLayer==="procedural_buildings"),b=o.type==="building";if(o.is3D(!!this.terrain)){if(y||b||u&&u.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((o=>{o.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Gl.getSourceType=function(g){return nd[g]},Gl.setSourceType=function(g,o){nd[g]=o},Gl.registerForPluginStateChange=a.du;var ky=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,uf=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,hd=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,eg="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",hf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,ho=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Pp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,nn=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,fl=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,xu=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,df=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const xh=[];Os(ky,xh),Os(hd,xh),Os(uf,xh);const Gc={"_prelude_fog.vertex.glsl":ho,"_prelude_terrain.vertex.glsl":hf,"_prelude_shadow.vertex.glsl":xu,"_prelude_fog.fragment.glsl":Pp,"_prelude_shadow.fragment.glsl":df,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":nn,"_prelude_raster_particle.glsl":fl},pl={};Wr("",hf),Wr(Pp,ho),Wr(df,xu),Wr(nn,""),Wr(fl,"");const bu=Wr(uf,hd),wu=ky;var bh={background:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:Wr(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:Wr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:Wr(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:Wr(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Wr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Wr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Wr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Wr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Wr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Wr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Wr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Wr(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Wr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Wr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,eg),skyboxGradient:Wr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,eg),skyboxCapture:Wr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Wr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Wr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Wr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Wr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Wr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Wr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Wr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Os(g,o){const u=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of u)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=y.split(" ");for(const T of b)o.includes(T)||o.push(T)}}function Wr(g,o){const u=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let b=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);b&&(b=b.map((F=>{const U=F.split(" ");return U[U.length-1]})),b=[...new Set(b)]);const T={},C=[],I=[];if(g=g.replace(u,((F,U)=>(I.push(U),""))),(o=o.replace(u,((F,U)=>(C.push(U),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let L=[...xh];Os(g,L),Os(o,L);for(const F of[...C,...I])Gc[F]||console.error(`Undefined include: ${F}`),pl[F]||(pl[F]=[],Os(Gc[F],pl[F])),L=[...L,...pl[F]];return{fragmentSource:g=g.replace(y,((F,U,Y,W,Q)=>(T[Q]=!0,U==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
in ${Y} ${W} ${Q};
#else
uniform ${Y} ${W} u_${Q};
#endif
`:U==="initialize"?`
#ifdef HAS_UNIFORM_u_${Q}
    ${Y} ${W} ${Q} = u_${Q};
#endif
`:U==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${Y} ${W} ${Q};
#endif
`:U==="initialize-attribute"?"":void 0))),vertexSource:o=o.replace(y,((F,U,Y,W,Q)=>{const le=W==="float"?"vec2":W,oe=Q.match(/color/)?"color":le;return U==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
in ${Y} ${W} a_${Q};
#endif
`:T[Q]?U==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${Y} ${le} a_${Q};
out ${Y} ${W} ${Q};
#else
uniform ${Y} ${W} u_${Q};
#endif
`:U==="initialize"?oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${Y} ${W} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${oe}(a_${Q}, u_${Q}_t);
#else
    ${Y} ${W} ${Q} = u_${Q};
#endif
`:U==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${Y} ${W} a_${Q};
    out ${Y} ${W} ${Q};
#endif
`:U==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${Q} = a_${Q};
#endif
`:void 0:U==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${Y} ${le} a_${Q};
#else
uniform ${Y} ${W} u_${Q};
#endif
`:U==="define-instanced"?oe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Q}0;
in vec4 a_${Q}1;
in vec4 a_${Q}2;
in vec4 a_${Q}3;
#else
uniform ${Y} ${W} u_${Q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Y} ${le} a_${Q};
#else
uniform ${Y} ${W} u_${Q};
#endif
`:U==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${Y} ${W} ${Q} = a_${Q};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Y} ${W} ${Q} = a_${Q};
#else
    ${Y} ${W} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Y} ${W} ${Q} = unpack_mix_${oe}(a_${Q}, u_${Q}_t);
#else
    ${Y} ${W} ${Q} = u_${Q};
#endif
`})),staticAttributes:b,usedDefines:L,vertexIncludes:C,fragmentIncludes:I}}class Il{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,u,y,b,T,C,I,L){this.context=o;let F=this.boundPaintVertexBuffers.length!==b.length;for(let Y=0;!F&&Y<b.length;Y++)this.boundPaintVertexBuffers[Y]!==b[Y]&&(F=!0);let U=this.boundDynamicVertexBuffers.length!==I.length;for(let Y=0;!U&&Y<I.length;Y++)this.boundDynamicVertexBuffers[Y]!==I[Y]&&(U=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==y||F||U||this.boundIndexBuffer!==T||this.boundVertexOffset!==C)this.freshBind(u,y,b,T,C,I,L);else{o.bindVertexArrayOES.set(this.vao);for(const Y of I)Y&&(Y.bind(),L&&Y.instanceCount&&Y.setVertexAttribDivisor(o.gl,u,L));T&&T.dynamicDraw&&T.bind()}}freshBind(o,u,y,b,T,C,I){const L=o.numAttributes,F=this.context,U=F.gl;this.vao&&this.destroy(),this.vao=F.gl.createVertexArray(),F.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=b,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=C,u.enableAttributes(U,o),u.bind(),u.setVertexAttribPointers(U,o,T);for(const Y of y)Y.enableAttributes(U,o),Y.bind(),Y.setVertexAttribPointers(U,o,T);for(const Y of C)Y&&(Y.enableAttributes(U,o),Y.bind(),Y.setVertexAttribPointers(U,o,T),I&&Y.instanceCount&&Y.setVertexAttribDivisor(U,o,I));b&&b.bind(),F.currentNumAttributes=L}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Op(g,o){const u=Math.pow(2,o.canonical.z),y=o.canonical.y;return[new a.ac(0,y/u).toLngLat().lat,new a.ac(0,(y+1)/u).toLngLat().lat]}function Su(g,o,u,y,b,T,C){const I=g.context,L=I.gl,F=u.hillshadeFBO;if(!F)return;g.prepareDrawTile();const U=g.isTileAffectedByFog(o),Y=g.getOrCreateProgram("hillshade",{overrideFog:U});I.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,F.colorAttachment.get());const W=((ue,de,xe,Te)=>{const Me=xe.paint.get("hillshade-shadow-color"),ke=xe.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Fe=xe.paint.get("hillshade-highlight-color"),Ve=xe.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Le=xe.paint.get("hillshade-accent-color"),Ne=xe.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",je=xe.paint.get("hillshade-emissive-strength");let dt=a.al(xe.paint.get("hillshade-illumination-direction"));if(xe.paint.get("hillshade-illumination-anchor")==="viewport")dt-=ue.transform.angle;else if(ue.style&&ue.style.enable3dLights()&&ue.style.directionalLight){const Pt=ue.style.directionalLight.properties.get("direction"),_t=a.d1(Pt.x,Pt.y,Pt.z);dt=a.al(_t[1])}const Ze=!ue.options.moving;return{u_matrix:Te||ue.transform.calculateProjMatrix(de.tileID.toUnwrapped(),Ze),u_image:0,u_latrange:Op(0,de.tileID),u_light:[xe.paint.get("hillshade-exaggeration"),dt],u_shadow:Me.toPremultipliedRenderColor(ke?null:xe.lut),u_highlight:Fe.toPremultipliedRenderColor(Ve?null:xe.lut),u_emissive_strength:je,u_accent:Le.toPremultipliedRenderColor(Ne?null:xe.lut)}})(g,u,y,g.terrain?o.projMatrix:null);g.uploadCommonUniforms(I,Y,o.toUnwrapped());const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:le,tileBoundsSegments:oe}=g.getTileBoundsBuffers(u);Y.draw(g,L.TRIANGLES,b,T,C,Wn.disabled,W,y.id,Q,le,oe)}function tg(g,o,u){if(!o.needsDEMTextureUpload)return;const y=g.context,b=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(u.stride);const T=u.getPixels();o.demTexture?o.demTexture.update(T,{premultiply:!1}):o.demTexture=new a.T(y,T,b.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Rp(g,o,u){const y=g.context,b=y.gl;if(!o.dem)return;const T=o.dem;if(y.activeTexture.set(b.TEXTURE1),tg(g,o,T),!o.demTexture)return;o.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);const C=T.dim;y.activeTexture.set(b.TEXTURE0);let I=o.hillshadeFBO;if(!I){const W=new a.T(y,{width:C,height:C,data:null},b.RGBA8);W.bind(b.LINEAR,b.CLAMP_TO_EDGE),I=o.hillshadeFBO=y.createFramebuffer(C,C,!0,"renderbuffer"),I.colorAttachment.set(W.texture)}y.bindFramebuffer.set(I.framebuffer),y.viewport.set([0,0,C,C]);const{tileBoundsBuffer:L,tileBoundsIndexBuffer:F,tileBoundsSegments:U}=g.getMercatorTileBoundsBuffers(),Y=[];g.linearFloatFilteringSupported()&&Y.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:Y}).draw(g,b.TRIANGLES,Tn.disabled,er.disabled,yr.unblended,Wn.disabled,((W,Q)=>{const le=Q.stride,oe=a.bz();return a.ca(oe,0,a.aj,-a.aj,0,0,1),a.bo(oe,oe,[0,-a.aj,0]),{u_matrix:oe,u_image:1,u_dimension:[le,le],u_zoom:W.overscaledZ}})(o.tileID,T),u.id,L,F,U),o.needsHillshadePrepare=!1}class Ii{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ly extends Ii{getDefault(){return a.am.transparent.toNonPremultipliedRenderColor(null)}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ny extends Ii{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ff extends Ii{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class pf extends Ii{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ip extends Ii{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class ng extends Ii{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Xs extends Ii{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Wl extends Ii{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class wh extends Ii{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class _c extends Ii{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Xl extends Ii{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class Tu extends Ii{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Sh extends Ii{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class Th extends Ii{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class mf extends Ii{getDefault(){return a.am.transparent.toNonPremultipliedRenderColor(null)}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class us extends Ii{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class ja extends Ii{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class pa extends Ii{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Eu extends Ii{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let vc=class extends Ii{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Eh extends Ii{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Wc extends Ii{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Dp extends Ii{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class rg extends Ii{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ah extends Ii{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Au extends Ii{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class zy extends Ii{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class gf extends Ii{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class ig extends Ii{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Zl extends Ii{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Xc extends Ii{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Zc extends Ii{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class Cu extends Zc{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class ag extends Zc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class kp extends Zc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class dd extends ag{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const yf=(g,o,u)=>({u_matrix:g,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:u}),Yc=(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:u,u_zoom_transition:b,u_merc_center:T,u_image0:0,u_frustum_tl:C,u_frustum_tr:I,u_frustum_br:L,u_frustum_bl:F,u_globe_pos:U,u_globe_radius:Y,u_viewport:W,u_grid_matrix:oe?Float32Array.from(oe):new Float32Array(9),u_skirt_height:Q,u_far_z_cutoff:le});function hs(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const Kc=new class{constructor(){this.operations={}}newMorphing(g,o,u,y,b){if(g in this.operations){const T=this.operations[g];T.to.tileID.key!==u.tileID.key&&(T.queued=u)}else this.operations[g]={startTime:y,phase:0,duration:b,from:o,to:u,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const u=this.operations[o];for(u.phase=(g-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},jy={0:null,1:"TERRAIN_VERTEX_MORPHING"};function _f(g,o,u){if(o===0)return 0;const y=o<1&&u===514?.25/o:1;return 6*Math.pow(1.5,22-g)*Math.max(o,1)*y}function Lp(g,o){const u=1<<g.z;return!o&&(g.x===0||g.x===u-1)||g.y===0||g.y===u-1}const og=g=>({u_matrix:g});function sa(g,o,u,y,b){if(b>0){const T=a.q.now(),C=(T-g.timeAdded)/b,I=o?(T-o.timeAdded)/b:-1,L=u.getSource(),F=y.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),U=!o||Math.abs(o.tileID.overscaledZ-F)>Math.abs(g.tileID.overscaledZ-F),Y=U&&g.refreshedUponExpiration?1:a.ay(U?C:1-I,0,1);return g.refreshedUponExpiration&&C>=1&&(g.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}class Np extends Zo{constructor(o){const u=fu("mock-dem",{type:"raster-dem",maxzoom:o.transform.maxZoom},o.style.dispatcher,o.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,u){o.state="loaded",u(null)}}class Ch extends Zo{constructor(o){const u=fu("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},o.style.dispatcher,o.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,u,y){if(o.freezeTileCoverage)return;this.transform=o;const b=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((T,C)=>{if(T[C.key]="",!this._tiles[C.key]){const I=new gs(C,this._source.tileSize*C.overscaleFactor(),o.tileZoom,void 0,void 0,this._source.worldview);I.state="loaded",this._tiles[C.key]=I}return T}),{});for(const T in this._tiles)T in b||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(o){const u=this.proxyCachedFBO[o];if(u!==void 0){const y=Object.values(u);this.renderCachePool.push(...y),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach((o=>o.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mu extends a.aM{constructor(o,u,y){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=u,this.projMatrix=y}}class vf extends a.dF{constructor(o,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,b,T]=(function(L){const F=new a.ba,U=new a.a_,Y=131;F.reserve(17161),U.reserve(33800);const W=a.aj/128,Q=a.aj+W/2,le=Q+W;for(let ue=-W;ue<le;ue+=W)for(let de=-W;de<le;de+=W){const xe=de<0||de>Q||ue<0||ue>Q?24575:0,Te=a.ay(Math.round(de),0,a.aj),Me=a.ay(Math.round(ue),0,a.aj);F.emplaceBack(Te+xe,Me)}const oe=(ue,de)=>{const xe=de*Y+ue;U.emplaceBack(xe+1,xe,xe+Y),U.emplaceBack(xe+Y,xe+Y+1,xe+1)};for(let ue=1;ue<129;ue++)for(let de=1;de<129;de++)oe(de,ue);return[0,129].forEach((ue=>{for(let de=0;de<130;de++)oe(de,ue),oe(ue,de)})),[F,U,32768]})(),C=o.context;this.gridBuffer=C.createVertexBuffer(y,a.bc.members),this.gridIndexBuffer=C.createIndexBuffer(b),this.gridSegments=a.bd.simpleSegment(0,0,y.length,b.length),this.gridNoSkirtSegments=a.bd.simpleSegment(0,0,y.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ch(u.map),this.orthoMatrix=a.bz(),a.ca(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.aj,0,a.aj,0,1);const I=C.gl;this._overlapStencilMode=new er({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Np(u.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(o,u,y){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const b=o.terrain.properties,T=o.terrain.drapeRenderMode===0,C=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.q.now();const I=o.terrain&&o.terrain.scope,L=b.get("source"),F=T?this._mockSourceCache:o.getSourceCache(L,I);if(!F)return void a.w(`Couldn't find terrain source "${L}".`);if(this.sourceCache=F,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=C?this.calculateExaggeration(u):b.get("exaggeration"),!u.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const U=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Y=this.getScaledDemTileSize();this.sourceCache.update(u,Y,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,U(),this._initializing=!0),U(),u.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const u=this._previousCameraAltitude,y=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=y;const b=u!=null?y-u:Number.MAX_VALUE;if(Math.abs(b)<2)return this._exaggeration;const T=o.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(T);let I=T-this._previousZoom;const L=this._previousUpdateTimestamp;let F=T;this._evaluationZoom!=null&&(F=this._evaluationZoom,Math.abs(T-F)>.5&&(I=.5*(T-F+I)),I*b<0&&(F+=I)),this._evaluationZoom=F;const U=C.getExaggeration(F),Y=U===C.getExaggeration(Math.max(0,F-.1));if(Y&&Math.abs(U-this._exaggeration)<.01)return U;let W=Math.min(.1,.00375*(this._updateTimestamp-L));return(Y||U<.1||Math.abs(I)<1e-4)&&(W=Math.min(.2,4*W)),a.ai(this._exaggeration,U,W)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((o=>o.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(a.ac.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=u.getIds().map((L=>{const F=u.getTileByID(L).tileID;return F.projMatrix=y.calculateProjMatrix(F.toUnwrapped()),F}));(function(L,F){const U=F.transform.pointCoordinate(F.transform.getCameraPoint()),Y=new a.P(U.x,U.y);L.sort(((W,Q)=>{if(Q.overscaledZ-W.overscaledZ)return Q.overscaledZ-W.overscaledZ;const le=new a.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),oe=new a.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),ue=Y.mult(1<<W.canonical.z);return ue.x-=.5,ue.y-=.5,ue.distSqr(le)-ue.distSqr(oe)}))})(b,this.painter);const T=this.proxyToSource||{};this.proxyToSource={},b.forEach((L=>{this.proxyToSource[L.key]={}})),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const L in C){const F=C[L];if(!F.used||(F!==this.sourceCache&&this.resetTileLookupCache(F.id),this._setupProxiedCoordsForOrtho(F,o[L],T),F.usedForTerrain))continue;const U=o[L];F.getSource().reparseOverscaled&&this._assignTerrainTiles(U)}this.proxiedCoords[u.id]=b.map((L=>new Mu(L,L.key,this.orthoMatrix))),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1;const I={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const F=this.terrainTileForTile[L.key];if(!F)continue;const U=F.tileID.key;U in I||(this._visibleDemTiles.push(F),I[U]=U)}}_assignTerrainTiles(o){this._initializing||o.forEach((u=>{if(this.terrainTileForTile[u.key])return;const y=this._findTileCoveringTileID(u,this.sourceCache);y&&(this.terrainTileForTile[u.key]=y)}))}_prepareDEMTextures(){const o=this.painter.context,u=o.gl;for(const y in this.terrainTileForTile){const b=this.terrainTileForTile[y],T=b.dem;!T||b.demTexture&&!b.needsDEMTextureUpload||(o.activeTexture.set(u.TEXTURE1),tg(this.painter,b,T))}}_prepareDemTileUniforms(o,u,y,b){if(!u||u.demTexture==null)return!1;const T=o.tileID.canonical,C=Math.pow(2,u.tileID.canonical.z-T.z),I=b||"";return y[`u_dem_tl${I}`]=[T.x*C%1,T.y*C%1],y[`u_dem_scale${I}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const u=this._visibleDemTiles.reduce(((y,b)=>{if(!b.dem)return y;const T=b.dem.tree.minimums[0];return T>0&&o++,y+T}),0);return o?u/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,u=o.gl;o.activeTexture.set(u.TEXTURE2);const y=this._getLoadedAreaMinimum(),b=new a.dG({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(b,{premultiply:!1}):T=this._emptyDEMTexture=new a.T(o,b,u.R32F,{premultiply:!1}),T}setupElevationDraw(o,u,y){const b=this.painter.context,T=b.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};C.u_exaggeration=this.exaggeration();let I=null,L=null,F=1;if(y&&y.morphing&&this._useVertexMorphing){const Q=y.morphing.srcDemTile,le=y.morphing.dstDemTile;F=y.morphing.phase,Q&&le&&(this._prepareDemTileUniforms(o,Q,C,"_prev")&&(L=Q),this._prepareDemTileUniforms(o,le,C)&&(I=le))}const U=Q=>Q&&Q.demTexture&&this.painter.linearFloatFilteringSupported()?T.LINEAR:T.NEAREST;let Y=null;var W;if(this.enabled?L&&I?(Y=I.demTexture,b.activeTexture.set(T.TEXTURE4),L.demTexture.bind(U(L),T.CLAMP_TO_EDGE),C.u_dem_lerp=F):(I=this.terrainTileForTile[o.tileID.key],Y=this._prepareDemTileUniforms(o,I,C)?I.demTexture:this.emptyDEMTexture):Y=this.emptyDEMTexture,b.activeTexture.set(T.TEXTURE2),Y&&(C.u_dem_size=(W=Y).size[0]===1?1:W.size[0]-2,Y.bind(U(I),T.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,u,C),y&&y.useMeterToDem&&I){const Q=(1<<I.tileID.canonical.z)*a.cb(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=Q}if(y&&y.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),u.setTerrainUniformValues(b,C),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,o.tileID.canonical,y&&y.useDenormalizedUpVectorScale);u.setGlobeUniformValues(b,Q)}}globeUniformValues(o,u,y){const b=o.projection;return{u_tile_tl_up:b.upVector(u,0,0),u_tile_tr_up:b.upVector(u,a.aj,0),u_tile_br_up:b.upVector(u,a.aj,a.aj),u_tile_bl_up:b.upVector(u,0,a.aj),u_tile_up_scale:y?a.dH(1):b.upVectorScale(u,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const u=this.painter,y=this.painter.context;o.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(b,T,C,I,L){if(b.transform.projection.name==="globe")(function(F,U,Y,W,Q){const le=F.context,oe=le.gl;let ue,de;const xe=F.transform,Te=a.dy(F,le,xe),Me=(Pt,_t)=>{if(de===_t)return;const Lt=[jy[_t],"PROJECTION_GLOBE_VIEW"];Te&&Lt.push("CUSTOM_ANTIALIASING");const rn=F.isTileAffectedByFog(Pt);ue=F.getOrCreateProgram("globeRaster",{defines:Lt,overrideFog:rn}),de=_t},ke=F.colorModeForRenderPass(),Fe=new Tn(oe.LEQUAL,Tn.ReadWrite,F.depthRangeFor3D);Kc.update(Q);const Ve=a.dz(xe),Le=[a.aD(xe.center.lng),a.aH(xe.center.lat)],Ne=F.globeSharedBuffers,je=[xe.width*a.q.devicePixelRatio,xe.height*a.q.devicePixelRatio],dt=Float32Array.from(xe.globeMatrix),Ze={useDenormalizedUpVectorScale:!0};{const Pt=F.transform,_t=_f(Pt.zoom,U.exaggeration(),U.sourceCache._source.tileSize);de=-1;const Lt=oe.TRIANGLES;for(const rn of W){const ft=Y.getTile(rn),We=er.disabled,Tt=U.prevTerrainTileForTile[rn.key],mt=U.terrainTileForTile[rn.key];hs(Tt,mt)&&Kc.newMorphing(rn.key,Tt,mt,Q,250),le.activeTexture.set(oe.TEXTURE0),ft.texture&&ft.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const It=Kc.getMorphValuesForProxy(rn.key),Nt=It?1:0;It&&a.L(Ze,{morphing:{srcDemTile:It.from,dstDemTile:It.to,phase:a.dx(It.phase)}});const Rt=a.dA(rn.canonical),Ft=a.dB(Rt.getCenter().lat),gn=a.dC(rn.canonical,Rt,Ft,Pt.worldSize/Pt._pixelsPerMercatorPixel),Dn=a.bh(a.dD(rn.canonical)),xn=Yc(Pt.expandedFarZProjMatrix,dt,Ve,Dn,a.ah(Pt.zoom),Le,Pt.frustumCorners.TL,Pt.frustumCorners.TR,Pt.frustumCorners.BR,Pt.frustumCorners.BL,Pt.globeCenterInViewSpace,Pt.globeRadius,je,_t,Pt._farZ,gn);if(Me(rn,Nt),ue&&(U.setupElevationDraw(ft,ue,Ze),F.uploadCommonUniforms(le,ue,rn.toUnwrapped()),Ne)){const[zn,Bn,Kn]=Ne.getGridBuffers(Ft,_t!==0);ue.draw(F,Lt,Fe,We,ke,Wn.backCCW,xn,"globe_raster",zn,Bn,Kn)}}}if(Ne&&(F.renderDefaultNorthPole||F.renderDefaultSouthPole)){const Pt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Te&&Pt.push("CUSTOM_ANTIALIASING"),ue=F.getOrCreateProgram("globeRaster",{defines:Pt});for(const _t of W){const{x:Lt,y:rn,z:ft}=_t.canonical,We=rn===0,Tt=rn===(1<<ft)-1,[mt,It,Nt,Rt]=Ne.getPoleBuffers(ft,!1);if(Rt&&(We||Tt)){const Ft=Y.getTile(_t);le.activeTexture.set(oe.TEXTURE0),Ft.texture&&Ft.texture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);let gn=a.dE(ft,Lt,xe);const Dn=a.bh(a.dD(_t.canonical)),xn=(zn,Bn)=>zn.draw(F,oe.TRIANGLES,Fe,er.disabled,ke,Wn.disabled,Yc(xe.expandedFarZProjMatrix,gn,gn,Dn,0,Le,xe.frustumCorners.TL,xe.frustumCorners.TR,xe.frustumCorners.BR,xe.frustumCorners.BL,xe.globeCenterInViewSpace,xe.globeRadius,je,0,xe._farZ),"globe_pole_raster",Bn,Nt,Rt);U.setupElevationDraw(Ft,ue,Ze),F.uploadCommonUniforms(le,ue,_t.toUnwrapped()),We&&F.renderDefaultNorthPole&&xn(ue,mt),Tt&&F.renderDefaultSouthPole&&(gn=a.cP(a.bz(),gn,[1,-1,1]),xn(ue,It))}}}})(b,T,C,I,L);else{const F=b.context,U=F.gl;let Y,W;const Q=b.shadowRenderer,le=qc(b,b.longestCutoffRange),oe=ke=>{if(W===ke)return;const Fe=[];Fe.push(jy[ke]),le.shouldRenderCutoff&&Fe.push("RENDER_CUTOFF"),Q&&(Fe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Q.useNormalOffset&&Fe.push("NORMAL_OFFSET")),Y=b.getOrCreateProgram("terrainRaster",{defines:Fe}),W=ke},ue=b.colorModeForRenderPass(),de=new Tn(U.LEQUAL,Tn.ReadWrite,b.depthRangeFor3D);Kc.update(L);const xe=b.transform,Te=_f(xe.zoom,T.exaggeration(),T.sourceCache._source.tileSize);let Me=[0,0,0];if(Q){const ke=b.style.directionalLight,Fe=b.style.ambientLight;ke&&Fe&&(Me=gh(b.style,ke,Fe))}{W=-1;const ke=U.TRIANGLES,[Fe,Ve]=[T.gridIndexBuffer,T.gridSegments];for(const Le of I){const Ne=C.getTile(Le),je=er.disabled,dt=T.prevTerrainTileForTile[Le.key],Ze=T.terrainTileForTile[Le.key];hs(dt,Ze)&&Kc.newMorphing(Le.key,dt,Ze,L,250),F.activeTexture.set(U.TEXTURE0),Ne.texture&&Ne.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const Pt=Kc.getMorphValuesForProxy(Le.key),_t=Pt?1:0;let Lt;Pt&&(Lt={morphing:{srcDemTile:Pt.from,dstDemTile:Pt.to,phase:a.dx(Pt.phase)}});const rn=yf(Le.projMatrix,Lp(Le.canonical,xe.renderWorldCopies)?Te/10:Te,Me);if(oe(_t),!Y)continue;T.setupElevationDraw(Ne,Y,Lt);const ft=Le.toUnwrapped();Q&&Q.setupShadows(ft,Y),b.uploadCommonUniforms(F,Y,ft,null,le),Y.draw(b,ke,de,je,ue,Wn.backCCW,rn,"terrain_raster",T.gridBuffer,Fe,Ve)}}}})(u,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const u=this.painter,y=this.painter.context,b=this.proxySourceCache,T=this.proxiedCoords[b.id],C=this._drapedRenderBatches.shift(),I=u.style.order,L=[];let F=0;for(const U of T){const Y=b.getTileByID(U.proxyTileKey),W=b.proxyCachedFBO[U.key]?b.proxyCachedFBO[U.key][o]:void 0,Q=W!==void 0?b.renderCache[W]:this.pool[F++],le=W!==void 0;if(Y.texture=Q.tex,le&&!Q.dirty){L.push(Y.tileID);continue}let oe;y.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(y.clear({color:a.am.transparent,stencil:0}),Q.dirty=!1);for(let ue=C.start;ue<=C.end;++ue){const de=u.style._mergedLayers[I[ue]];if(de.isHidden(u.transform.zoom))continue;const xe=u.style.getLayerSourceCache(de),Te=xe?this.proxyToSource[U.key][xe.id]:[U];if(!Te)continue;const Me=Te;y.viewport.set([0,0,Q.fb.width,Q.fb.height]),oe!==(xe?xe.id:null)&&(this._setupStencil(Q,Te,de,xe),oe=xe?xe.id:null),u.renderLayer(u,xe,de,Me)}if(this._drapedRenderBatches.length===0)for(const ue of this._pendingGroundEffectLayers){const de=u.style._mergedLayers[I[ue]];if(de.isHidden(u.transform.zoom))continue;const xe=u.style.getLayerSourceCache(de),Te=xe?this.proxyToSource[U.key][xe.id]:[U];if(!Te)continue;const Me=Te;y.viewport.set([0,0,Q.fb.width,Q.fb.height]),oe!==(xe?xe.id:null)&&(this._setupStencil(Q,Te,de,xe),oe=xe?xe.id:null),u.renderLayer(u,xe,de,Me)}this.renderedToTile?(Q.dirty=!0,L.push(Y.tileID)):le||--F,F===5&&(F=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,u.width,u.height]),C.end+1}postRender(){}isLayerOrderingCorrect(o){const u=o.order.length;let y=-1,b=u;for(let T=0;T<u;++T)this._style.isLayerDraped(o._mergedLayers[o.order[T]])?y=Math.max(y,T):b=Math.min(b,T);return b>y}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter((u=>u.dem)).forEach((u=>{o=Math.min(o,u.dem.tree.minimums[0])})),o===0?o:(o-30)*this._exaggeration}raycast(o,u,y){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter((T=>T.dem)).map((T=>{const C=T.tileID,I=1<<C.overscaledZ,{x:L,y:F}=C.canonical,U=L/I,Y=(L+1)/I,W=F/I,Q=(F+1)/I;return{minx:U,miny:W,maxx:Y,maxy:Q,t:T.dem.tree.raycastRoot(U,W,Y,Q,o,u,y),tile:T}}));b.sort(((T,C)=>(T.t!==null?T.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE)));for(const T of b){if(T.t==null)return null;const C=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,o,u,y);if(C!=null)return C}return null}_createFBO(){const o=this.painter.context,u=o.gl,y=this.drapeBufferSize;o.activeTexture.set(u.TEXTURE0);const b=new a.T(o,{width:y[0],height:y[1],data:null},u.RGBA8);b.bind(u.LINEAR,u.CLAMP_TO_EDGE);const T=o.createFramebuffer(y[0],y[1],!0,null);return T.colorAttachment.set(b.texture),T.depthAttachment=new dd(o,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:T,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some((o=>{const u=this._style._mergedLayers[o],y=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!y&&u.shouldRedrape():!y&&u.hasTransition()}))}_clearLineLayersFromRenderCache(){let o=!1;for(const y of this._style.getSources())if(y instanceof td){o=!0;break}if(!o)return;const u={};for(let y=0;y<this._style.order.length;++y){const b=this._style._mergedLayers[this._style.order[y]],T=this._style.getLayerSourceCache(b);if(T&&!u[T.id]&&!b.isHidden(this.painter.transform.zoom)&&b.type==="line"&&b.widthExpression()instanceof a.ab){u[T.id]=!0;for(const C of this.proxyCoords){const I=this.proxyToSource[C.key][T.id];if(I)for(const L of I)this._clearRenderCacheForTile(T.id,L)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof xo){o=!0;break}if(!o)return;const u={};for(let y=0;y<this._style.order.length;++y){const b=this._style._mergedLayers[this._style.order[y]],T=this._style.getLayerSourceCache(b);if(!T||u[T.id]||b.isHidden(this.painter.transform.zoom)||b.type!=="raster")continue;const C=b.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const L=this.proxyToSource[I.key][T.id];if(L)for(const F of L){const U=sa(T.getTile(F),T.findLoadedParent(F,0),T,this.painter.transform,C);(U.opacity!==1||U.mix!==0)&&this._clearRenderCacheForTile(T.id,F)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,u=o.length;if(u===0)return;const y=[];this._pendingGroundEffectLayers=[];let b,T=0,C=this._style._mergedLayers[o[T]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++T<u;)C=this._style._mergedLayers[o[T]];for(;T<u;++T){const I=this._style._mergedLayers[o[T]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?b===void 0&&(b=T):(I.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(T),b!==void 0&&(y.push({start:b,end:T-1}),b=void 0)))}if(b!==void 0&&y.push({start:b,end:T-1}),y.length!==0){const I=y[y.length-1];this._pendingGroundEffectLayers.every((L=>L>I.end))||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(o){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const C=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let I=0;I<C.length;++I){const L=Object.values(C[I]);u.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,b=this._tilesDirty;for(let C=y.length-1;C>=0;C--){const I=y[C];if(u.getTileByID(I.key),u.proxyCachedFBO[I.key]!==void 0){const L=o[I.key],F=this.proxyToSource[I.key];let U=0;for(const Y in F){const W=F[Y],Q=L[Y];if(!Q||Q.length!==W.length||W.some(((le,oe)=>le!==Q[oe]||b[Y]&&b[Y].hasOwnProperty(le.key)))){U=-1;break}++U}for(const Y in u.proxyCachedFBO[I.key])u.renderCache[u.proxyCachedFBO[I.key][Y]].dirty=U<0||U!==Object.values(L).length}}const T=[...this._drapedRenderBatches];T.sort(((C,I)=>I.end-I.start-(C.end-C.start)));for(const C of T)for(const I of y){if(u.proxyCachedFBO[I.key])continue;let L=u.renderCachePool.pop();L===void 0&&u.renderCache.length<50&&(L=u.renderCache.length,u.renderCache.push(this._createFBO())),L!==void 0&&(u.proxyCachedFBO[I.key]={},u.proxyCachedFBO[I.key][C.start]=L,u.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(o,u,y,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,C=T.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let I;if(y.isTileClipped())I=u.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):er.disabled}_renderTileClippingMasks(o,u){const y=this.painter,b=this.painter.context,T=b.gl;y._tileClippingMaskIDs={},b.setColorMode(yr.disabled),b.setDepthMode(Tn.disabled);const C=y.getOrCreateProgram("clippingMask");for(const I of o){const L=y._tileClippingMaskIDs[I.key]=--u;C.draw(y,T.TRIANGLES,Tn.disabled,new er({func:T.ALWAYS,mask:0},L,255,T.KEEP,T.KEEP,T.REPLACE),yr.disabled,Wn.disabled,og(I.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(o){const u=this.painter.transform;if(o.x<0||o.x>u.width||o.y<0||o.y>u.height)return null;const y=[o.x,o.y,1,1];a.aA(y,y,u.pixelMatrixInverse),a.cH(y,y,1/y[3]),y[0]/=u.worldSize,y[1]/=u.worldSize;const b=u._camera.position,T=a.cb(1,u.center.lat),C=[b[0],b[1],b[2]/T,0],I=a.d7([],y.slice(0,3),C);a.au(I,I);const L=this.raycast(C,I,this._exaggeration);return L!==null&&L?(a.bE(C,C,I,L),C[3]=C[2],C[2]*=T,C):null}_setupProxiedCoordsForOrtho(o,u,y){if(o.getSource()instanceof a.aP)return this._setupProxiedCoordsForImageSource(o,u,y);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const b=this.proxiedCoords[o.id]=[],T=this.proxyCoords;for(let L=0;L<T.length;L++){const F=T[L],U=this._findTileCoveringTileID(F,o);if(U){const Y=this._createProxiedId(F,U,y[F.key]&&y[F.key][o.id]);b.push(Y),this.proxyToSource[F.key][o.id]=[Y]}}let C=!1;const I=new Set;for(let L=0;L<u.length;L++){const F=o.getTile(u[L]);if(!F||!F.hasData())continue;const U=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(U&&U.tileID.canonical.z!==F.tileID.canonical.z){const Y=this.proxyToSource[U.tileID.key][o.id],W=this._createProxiedId(U.tileID,F,y[U.tileID.key]&&y[U.tileID.key][o.id]);Y?Y.splice(Y.length-1,0,W):this.proxyToSource[U.tileID.key][o.id]=[W];const Q=this.proxyToSource[U.tileID.key][o.id];I.has(Q)||I.add(Q),b.push(W),C=!0}}if(this._sourceTilesOverlap[o.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const L of I)L.sort(((F,U)=>U.overscaledZ-F.overscaledZ))}_setupProxiedCoordsForImageSource(o,u,y){if(!o.getSource().loaded())return;const b=this.proxiedCoords[o.id]=[],T=this.proxyCoords,C=o.getSource(),I=C.tileID;if(!I)return;const L=new a.P(I.x,I.y)._div(1<<I.z),F=C.coordinates.map(a.ac.fromLngLat).reduce(((Y,W)=>(Y.min.x=Math.min(Y.min.x,W.x-L.x),Y.min.y=Math.min(Y.min.y,W.y-L.y),Y.max.x=Math.max(Y.max.x,W.x-L.x),Y.max.y=Math.max(Y.max.y,W.y-L.y),Y)),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),U=(Y,W)=>{const Q=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),le=Y.canonical.y/(1<<Y.canonical.z),oe=a.aj/(1<<Y.canonical.z),ue=W.wrap+W.canonical.x/(1<<W.canonical.z),de=W.canonical.y/(1<<W.canonical.z);return Q+oe<ue+F.min.x||Q>ue+F.max.x||le+oe<de+F.min.y||le>de+F.max.y};for(let Y=0;Y<T.length;Y++){const W=T[Y];for(let Q=0;Q<u.length;Q++){const le=o.getTile(u[Q]);if(!le||!le.hasData()||U(W,le.tileID))continue;const oe=this._createProxiedId(W,le,y[W.key]&&y[W.key][o.id]),ue=this.proxyToSource[W.key][o.id];ue?ue.push(oe):this.proxyToSource[W.key][o.id]=[oe],b.push(oe)}}}_createProxiedId(o,u,y){let b=this.orthoMatrix;if(y){const T=y.find((C=>C.key===u.tileID.key));if(T)return T}if(u.tileID.key!==o.key){const T=o.canonical.z-u.tileID.canonical.z;let C,I,L;b=a.bz();const F=u.tileID.wrap-o.wrap<<o.overscaledZ;T>0?(C=a.aj>>T,I=C*((u.tileID.canonical.x<<T)-o.canonical.x+F),L=C*((u.tileID.canonical.y<<T)-o.canonical.y)):(C=a.aj<<-T,I=a.aj*(u.tileID.canonical.x-(o.canonical.x+F<<-T)),L=a.aj*(u.tileID.canonical.y-(o.canonical.y<<-T))),a.ca(b,0,C,0,C,0,1),a.bo(b,b,[I,L,0])}return new Mu(u.tileID,o.key,b)}_findTileCoveringTileID(o,u){let y=u.getTile(o);if(y&&y.hasData())return y;const b=this._findCoveringTileCache[u.id],T=b[o.key];if(y=T?u.getTileByID(T):null,y&&y.hasData()||T===null)return y;let C=y?y.tileID:o,I=C.overscaledZ;const L=u.getSource().minzoom,F=[];if(!T){const Y=u.getSource().maxzoom;if(o.canonical.z>=Y){const W=o.canonical.z-Y;u.getSource().reparseOverscaled?(I=Math.max(o.canonical.z+2,u.transform.tileZoom),C=new a.aM(I,o.wrap,Y,o.canonical.x>>W,o.canonical.y>>W)):W!==0&&(I=Y,C=new a.aM(I,o.wrap,Y,o.canonical.x>>W,o.canonical.y>>W))}C.key!==o.key&&(F.push(C.key),y=u.getTile(C))}const U=Y=>{F.forEach((W=>{b[W]=Y})),F.length=0};for(I-=1;I>=L&&(!y||!y.hasData());I--){y&&U(y.tileID.key);const Y=C.calculateScaledKey(I);if(y=u.getTileByID(Y),y&&y.hasData())break;const W=b[Y];if(W===null)break;W===void 0?F.push(Y):y=u.getTileByID(W)}return U(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,u){let y=this._tilesDirty[o];y||(y=this._tilesDirty[o]={}),y[u.key]=!0}}function Mh(g,o,u){const y=(function(I,L,F){const U=a.bG(L,I),Y=a.bG(F,[.2126,.7152,.0722]),W=(le,oe,ue)=>(1-ue)*le+ue*oe,Q=W(1-.3*Math.min(Y,1),1,Math.min(U+1,1));return W(.92,1,Math.asin(a.ay(L[2],-1,1))/Math.PI+.5)*Q})(g,[0,0,1],o),b=[0,0,0];a.c1(b,u.slice(0,3),y);const T=[0,0,0];a.c1(T,o.slice(0,3),g[2]);const C=[0,0,0];return a.d5(C,b,T),a.d8(C)}const Ph=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],sg=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class zp{static cacheKey(o,u,y,b){let T=`${u}${b?b.cacheKey:""}`;for(const C of y)o.usedDefines.includes(C)&&(T+=`/${C}`);return T}constructor(o,u,y,b,T,C){const I=o.gl;this.program=I.createProgram(),this.configuration=b,this.name=u,this.fixedDefines=[...C];const L=b?b.getBinderAttributes():[],F=(y.staticAttributes||[]).concat(L);let U=b?b.defines():[];U=U.concat(C.map((ue=>`#define ${ue}`)));const Y=`#version 300 es
`;let W=Y+U.concat("precision mediump float;",wu,bu.fragmentSource).join(`
`);for(const ue of y.fragmentIncludes)W+=`
${Gc[ue]}`;W+=`
${y.fragmentSource}`;let Q=Y+U.concat("precision highp float;",wu,bu.vertexSource).join(`
`);for(const ue of y.vertexIncludes)Q+=`
${Gc[ue]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(Q+=`
uniform int u_instanceID;
`),Q+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(Q=Q.replaceAll("gl_InstanceID","u_instanceID"));const le=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(le,W),I.compileShader(le),I.attachShader(this.program,le);const oe=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(oe,Q),I.compileShader(oe),I.attachShader(this.program,oe),this.attributes={},this.numAttributes=F.length;for(let ue=0;ue<this.numAttributes;ue++)if(F[ue]){const de=F[ue].startsWith("a_")?F[ue]:`a_${F[ue]}`;I.bindAttribLocation(this.program,ue,de),this.attributes[de]=ue}I.linkProgram(this.program),I.deleteShader(oe),I.deleteShader(le),this.fixedUniforms=T(o),this.binderUniforms=b?b.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ue=>({u_instanceID:new a.cd(ue)}))(o)),(C.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(ue=>({u_dem:new a.cd(ue),u_dem_prev:new a.cd(ue),u_dem_tl:new a.cg(ue),u_dem_scale:new a.cf(ue),u_dem_tl_prev:new a.cg(ue),u_dem_scale_prev:new a.cf(ue),u_dem_size:new a.cf(ue),u_dem_lerp:new a.cf(ue),u_exaggeration:new a.cf(ue),u_depth:new a.cd(ue),u_depth_size_inv:new a.cg(ue),u_depth_range_unpack:new a.cg(ue),u_occluder_half_size:new a.cf(ue),u_occlusion_depth_offset:new a.cf(ue),u_meter_to_dem:new a.cf(ue),u_label_plane_matrix_inv:new a.ch(ue)}))(o)),C.includes("GLOBE")&&(this.globeUniforms=(ue=>({u_tile_tl_up:new a.ce(ue),u_tile_tr_up:new a.ce(ue),u_tile_br_up:new a.ce(ue),u_tile_bl_up:new a.ce(ue),u_tile_up_scale:new a.cf(ue)}))(o)),C.includes("FOG")&&(this.fogUniforms=(ue=>({u_fog_matrix:new a.ch(ue),u_fog_range:new a.cg(ue),u_fog_color:new a.d0(ue),u_fog_horizon_blend:new a.cf(ue),u_fog_vertical_limit:new a.cg(ue),u_fog_temporal_offset:new a.cf(ue),u_frustum_tl:new a.ce(ue),u_frustum_tr:new a.ce(ue),u_frustum_br:new a.ce(ue),u_frustum_bl:new a.ce(ue),u_globe_pos:new a.ce(ue),u_globe_radius:new a.cf(ue),u_globe_transition:new a.cf(ue),u_is_globe:new a.cd(ue),u_viewport:new a.cg(ue)}))(o)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ue=>({u_cutoff_params:new a.d0(ue)}))(o)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ue=>({u_lighting_ambient_color:new a.ce(ue),u_lighting_directional_dir:new a.ce(ue),u_lighting_directional_color:new a.ce(ue),u_ground_radiance:new a.ce(ue)}))(o)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ue=>({u_light_matrix_0:new a.ch(ue),u_light_matrix_1:new a.ch(ue),u_fade_range:new a.cg(ue),u_shadow_normal_offset:new a.ce(ue),u_shadow_intensity:new a.cf(ue),u_shadow_texel_size:new a.cf(ue),u_shadow_map_resolution:new a.cf(ue),u_shadow_direction:new a.ce(ue),u_shadow_bias:new a.ce(ue),u_shadowmap_0:new a.cd(ue),u_shadowmap_1:new a.cd(ue)}))(o))}}setTerrainUniformValues(o,u){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in u)y[b]&&y[b].set(this.program,b,u[b])}}setGlobeUniformValues(o,u){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in u)y[b]&&y[b].set(this.program,b,u[b])}}setFogUniformValues(o,u){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in u)y[b].set(this.program,b,u[b])}}setCutoffUniformValues(o,u){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in u)y[b].set(this.program,b,u[b])}}setLightsUniformValues(o,u){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in u)y[b].set(this.program,b,u[b])}}setShadowUniformValues(o,u){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;o.program.set(this.program);for(const b in u)y[b].set(this.program,b,u[b])}_drawDebugWireframe(o,u,y,b,T,C,I,L,F,U){const Y=o.options.wireframe;if(Y.terrain===!1&&Y.layers2D===!1&&Y.layers3D===!1)return;const W=o.context;if(!(!(!Y.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Y.layers2D||o._terrain&&o._terrain.renderingToTexture||!Ph.includes(this.name))||!(!Y.layers3D||!sg.includes(this.name))))return;const Q=W.gl,le=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,T,W);if(!le)return;const oe=[...this.fixedDefines];oe.push("DEBUG_WIREFRAME");const ue=o.getOrCreateProgram(this.name,{config:this.configuration,defines:oe});W.program.set(ue.program);const de=(Me,ke,Fe)=>{if(ke[Me]&&Fe[Me])for(const Ve in ke[Me])Fe[Me][Ve]&&Fe[Me][Ve].set(Fe.program,Ve,ke[Me][Ve].current)};F&&F.setUniforms(ue.program,W,ue.binderUniforms,I,{zoom:L}),de("fixedUniforms",this,ue),de("terrainUniforms",this,ue),de("globeUniforms",this,ue),de("fogUniforms",this,ue),de("lightsUniforms",this,ue),de("shadowUniforms",this,ue),le.bind(),W.setColorMode(new yr([Q.ONE,Q.ONE_MINUS_SRC_ALPHA,Q.ZERO,Q.ONE],a.am.transparent,[!0,!0,!0,!1])),W.setDepthMode(new Tn(u.func===Q.LESS?Q.LEQUAL:u.func,Tn.ReadOnly,u.range)),W.setStencilMode(er.disabled);const xe=3*C.primitiveLength*2,Te=3*C.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Me=U||1;for(let ke=0;ke<Me;++ke)ue.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ke),Q.drawElements(Q.LINES,xe,Q.UNSIGNED_SHORT,Te)}else U&&U>1?Q.drawElementsInstanced(Q.LINES,xe,Q.UNSIGNED_SHORT,Te,U):Q.drawElements(Q.LINES,xe,Q.UNSIGNED_SHORT,Te);T.bind(),W.program.set(this.program),W.setDepthMode(u),W.setStencilMode(y),W.setColorMode(b)}checkUniforms(o,u,y){if(this.fixedDefines.includes(u)){for(const b of Object.keys(y))if(!y[b].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${b} not set but required by ${u} being defined`)}}draw(o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue){const de=o.context,xe=de.gl;if(this.failedToCreate)return;de.program.set(this.program),de.setDepthMode(y),de.setStencilMode(b),de.setColorMode(T),de.setCullFace(C);for(const ke of Object.keys(this.fixedUniforms))this.fixedUniforms[ke].set(this.program,ke,I[ke]);le&&le.setUniforms(this.program,de,this.binderUniforms,W,{zoom:Q});const Te={[xe.POINTS]:1,[xe.LINES]:2,[xe.TRIANGLES]:3,[xe.LINE_STRIP]:1}[u];this.checkUniforms(L,"RENDER_SHADOWS",this.shadowUniforms);const Me=ue&&ue>0?1:void 0;for(const ke of Y.get()){const Fe=ke.vaos||(ke.vaos={});if((Fe[L]||(Fe[L]=new Il)).bind(de,this,F,le?le.getPaintVertexBuffers():[],U,ke.vertexOffset,oe||[],Me),this.forceManualRenderingForInstanceIDShaders){const Ve=ue||1;for(let Le=0;Le<Ve;++Le)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Le),U?xe.drawElements(u,ke.primitiveLength*Te,xe.UNSIGNED_SHORT,ke.primitiveOffset*Te*2):xe.drawArrays(u,ke.vertexOffset,ke.vertexLength)}else ue&&ue>1?xe.drawElementsInstanced(u,ke.primitiveLength*Te,xe.UNSIGNED_SHORT,ke.primitiveOffset*Te*2,ue):U?xe.drawElements(u,ke.primitiveLength*Te,xe.UNSIGNED_SHORT,ke.primitiveOffset*Te*2):xe.drawArrays(u,ke.vertexOffset,ke.vertexLength);u===xe.TRIANGLES&&U&&this._drawDebugWireframe(o,y,b,T,U,ke,W,Q,le,ue)}}}function lg(g,o,u=0){const y=Math.pow(2,o.tileID.overscaledZ),b=o.tileSize*Math.pow(2,g.transform.tileZoom)/y,T=b*(o.tileID.canonical.x+o.tileID.wrap*y),C=b*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.aw(o,1,g.transform.tileZoom),u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C],u_pattern_transition:u}}const Oh={terrain:0,flat:1},Pu=a.bz(),jp=(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de)=>{const xe=o.style.light,Te=xe.properties.get("position"),Me=[Te.x,Te.y,Te.z],ke=a.dJ();xe.properties.get("anchor")==="viewport"&&(a.dK(ke,-o.transform.angle),a.dL(Me,Me,ke));const Fe=xe.properties.get("color").toPremultipliedRenderColor(null),Ve=o.transform,Le={u_matrix:g,u_lightpos:Me,u_lightintensity:xe.properties.get("intensity"),u_lightcolor:[Fe.r,Fe.g,Fe.b],u_vertical_gradient:+u,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Pu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Oh[F],u_base_type:Oh[U],u_ao:b,u_edge_radius:T,u_width_scale:C,u_flood_light_color:le,u_vertical_scale:oe,u_flood_light_intensity:ue,u_ground_shadow_factor:de};return Ve.projection.name==="globe"&&(Le.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],Le.u_zoom_transition=Y,Le.u_inv_rot_matrix=Q,Le.u_merc_center=W,Le.u_up_dir=Ve.projection.upVector(new a.cA(0,0,0),W[0]*a.aj,W[1]*a.aj),Le.u_height_lift=L),Le},Bp=(g,o,u,y,b,T)=>({u_matrix:g,u_edge_radius:o,u_width_scale:u,u_vertical_scale:y,u_height_type:Oh[b],u_base_type:Oh[T]}),fd=(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de)=>{const xe=jp(g,o,u,y,b,T,C,I,F,U,Y,W,Q,le,oe,ue,1,[0,0,0]),Te={u_height_factor:-Math.pow(2,I.overscaledZ)/L.tileSize/8};return a.h(xe,lg(o,L,de),Te)},xf=(g,o,u)=>({u_matrix:g,u_emissive_strength:o,u_ground_shadow_factor:u}),By=(g,o,u,y,b,T=0)=>a.h(xf(g,o,b),lg(u,y,T)),cg=(g,o,u,y)=>({u_matrix:g,u_world:u,u_emissive_strength:o,u_ground_shadow_factor:y}),Fy=(g,o,u,y,b,T,C=0)=>a.h(By(g,o,u,y,T,C),{u_world:b}),pv=(g,o)=>({u_matrix:g,u_ground_shadow_factor:o}),pd=(g,o,u,y,b)=>({u_matrix:g,u_camera_pos:[o[0],o[1],o[2]],u_depth_bias:u,u_height_scale:y,u_reset_depth:b}),ug=(g,o)=>({u_matrix:g,u_normal_matrix:o,u_opacity:1}),md=g=>({u_matrix:g}),Vy=g=>({u_matrix:g}),gd=(g,o,u,y,b,T,C,I)=>{const L=a.aj/T.tileSize;return{u_matrix:g,u_inv_rot_matrix:o,u_camera_to_center_distance:u.getCameraToCenterDistance(I),u_extrude_scale:[u.pixelsToGLUnits[0]/L,u.pixelsToGLUnits[1]/L],u_zoom_transition:y,u_tile_id:C,u_merc_center:b}},Jc=(g,o,u=1)=>({u_matrix:g,u_color:o,u_overlay:0,u_overlay_scale:u}),hg=a.bz(),dg=(g,o,u,y,b,T,C)=>{const I=g.transform,L=I.projection.name==="globe",F=L?a.dM(I.zoom,o.canonical)*I._pixelsPerMercatorPixel:a.aw(u,1,T),U={u_matrix:o.projMatrix,u_extrude_scale:F,u_intensity:C,u_inv_rot_matrix:hg,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){U.u_inv_rot_matrix=y,U.u_merc_center=b,U.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],U.u_zoom_transition=a.ah(I.zoom);const Y=b[0]*a.aj,W=b[1]*a.aj;U.u_up_dir=I.projection.upVector(new a.cA(0,0,0),Y,W)}return U};function xc(g,[o,u,y,b],[T,C]){if(T===C)return[0,0,0,0];const I=255*(g-1)/(g*(C-T));return[o*I,u*I,y*I,b*I]}function Zs(g,o,[u,y]){return u===y?0:.5/g+(o-u)*(g-1)/(g*(y-u))}const yd=(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de,xe,Te,Me)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:u,u_merc_matrix:y,u_grid_matrix:b,u_tl_parent:T,u_scale_parent:F,u_fade_t:U.mix,u_opacity:U.opacity*Y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Y.paint.get("raster-brightness-min"),u_brightness_high:Y.paint.get("raster-brightness-max"),u_saturation_factor:a.dO(Y.paint.get("raster-saturation")),u_contrast_factor:a.dN(Y.paint.get("raster-contrast")),u_spin_weights:Qc(Y.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:Q,u_zoom_transition:C,u_merc_center:I,u_cutoff_params:L,u_colorization_mix:xc(a.dP,oe,de),u_colorization_offset:Zs(a.dP,ue,de),u_color_ramp:le,u_texture_offset:[Te/(xe+2*Te),xe/(xe+2*Te)],u_texture_res:[xe+2*Te,xe+2*Te],u_emissive_strength:Me});function Qc(g){g*=Math.PI/180;const o=Math.sin(g),u=Math.cos(g);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const eu=.05,Rh=(g,o,u,y,b,T,C,I,L,F,U,Y)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:u,u_merc_matrix:y,u_grid_matrix:b,u_tl_parent:T,u_scale_parent:F,u_fade_t:U.mix,u_opacity:U.opacity,u_image0:0,u_image1:1,u_raster_elevation:Y,u_zoom_transition:C,u_merc_center:I,u_cutoff_params:L}),bf=(g,o,u,y,b,T,C,I,L,F)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_tile_offset:u,u_velocity:y,u_color_ramp:T,u_velocity_res:b,u_max_speed:C,u_uv_offset:I,u_data_scale:[255*L[0],255*L[1]],u_data_offset:F,u_particle_pos_scale:1.1,u_particle_pos_offset:[eu,eu]}),Uy=(g,o,u,y,b,T,C,I,L,F)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_velocity:u,u_velocity_res:y,u_max_speed:b,u_speed_factor:T,u_reset_rate:C,u_rand_seed:Math.random(),u_uv_offset:I,u_data_scale:[255*L[0],255*L[1]],u_data_offset:F,u_particle_pos_scale:1.1,u_particle_pos_offset:[eu,eu]}),Fp=a.bz(),Ou=(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de,xe,Te,Me,ke,Fe,Ve)=>{const Le=b.transform,Ne={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:Le.getCameraToCenterDistance(xe),u_rotate_symbol:+u,u_aspect_ratio:Le.width/Le.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:C,u_coord_matrix:I,u_is_text:+F,u_elevation_from_sea:L?1:0,u_pitch_with_map:+y,u_texsize:U,u_texsize_icon:Y,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Fp,u_up_vector:[0,-1,0],u_color_adj_mat:ke,u_icon_transition:Fe||0,u_gamma_scale:y?b.transform.getCameraToCenterDistance(xe)*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:a.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Ve||1,u_ground_shadow_factor:Te,u_inv_matrix:a.bi(a.bz(),C),u_normal_scale:Me};return xe.name==="globe"&&(Ne.u_tile_id=[Q.canonical.x,Q.canonical.y,1<<Q.canonical.z],Ne.u_zoom_transition=le,Ne.u_inv_rot_matrix=ue,Ne.u_merc_center=oe,Ne.u_camera_forward=Le._camera.forward(),Ne.u_ecef_origin=a.dQ(Le.globeMatrix,Q.toUnwrapped()),Ne.u_tile_matrix=Float32Array.from(Le.globeMatrix),Ne.u_up_vector=de),Ne},Vp=(g,o,u,y)=>({u_matrix:g,u_emissive_strength:o,u_opacity:u,u_color:y}),fg=(g,o,u,y,b,T,C,I,L)=>a.h((function(F,U,Y,W,Q,le){const{width:oe,height:ue}=W.imageManager.getPixelSize(U),de=Math.pow(2,le.tileID.overscaledZ),xe=le.tileSize*Math.pow(2,W.transform.tileZoom)/de,Te=xe*(le.tileID.canonical.x+le.tileID.wrap*de),Me=xe*le.tileID.canonical.y;return{u_image:0,u_pattern_tl:Y.tl,u_pattern_br:Y.br,u_texsize:[oe,ue],u_pattern_size:Y.displaySize,u_pattern_units_to_pixels:Q?[W.transform.width,-1*W.transform.height]:[1/a.aw(le,1,W.transform.tileZoom),1/a.aw(le,1,W.transform.tileZoom)],u_pixel_coord_upper:[Te>>16,Me>>16],u_pixel_coord_lower:[65535&Te,65535&Me]}})(0,T,C,y,I,L),{u_matrix:g,u_emissive_strength:o,u_opacity:u}),Ru=new Float32Array(a.bx([])),Up=(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q=[0,0,0],le)=>{const oe=b.style.light,ue=oe.properties.get("position"),de=[-ue.x,-ue.y,ue.z],xe=a.dJ();oe.properties.get("anchor")==="viewport"&&(a.dK(xe,-b.transform.angle),a.dL(de,de,xe));const Te=U.alphaMode==="MASK",Me=oe.properties.get("color").toNonPremultipliedRenderColor(null),ke=W.paint.get("model-ambient-occlusion-intensity"),Fe=W.paint.get("model-color").constantOr(a.am.white).toNonPremultipliedRenderColor(null);return Fe.a=W.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:g,u_lighting_matrix:o,u_normal_matrix:u,u_node_matrix:y||Ru,u_lightpos:de,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_camera_pos:Q,u_opacity:T,u_baseTextureIsAlpha:0,u_alphaMask:+Te,u_alphaCutoff:U.alphaCutoff,u_baseColorFactor:C.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:I.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:L,u_roughnessFactor:F,u_baseColorTexture:Jo.BaseColor,u_metallicRoughnessTexture:Jo.MetallicRoughness,u_normalTexture:Jo.Normal,u_occlusionTexture:Jo.Occlusion,u_emissionTexture:Jo.Emission,u_lutTexture:Jo.LUT,u_color_mix:Fe.toArray01(),u_aoIntensity:ke,u_emissive_strength:Y,u_occlusionTextureTransform:le||[0,0,0,0]}},Iu=(g,o=Ru,u=Ru)=>({u_matrix:g,u_instance:o,u_node_matrix:u}),Di={fillExtrusion:g=>({u_matrix:new a.ch(g),u_lightpos:new a.ce(g),u_lightintensity:new a.cf(g),u_lightcolor:new a.ce(g),u_vertical_gradient:new a.cf(g),u_opacity:new a.cf(g),u_edge_radius:new a.cf(g),u_width_scale:new a.cf(g),u_ao:new a.cg(g),u_height_type:new a.cd(g),u_base_type:new a.cd(g),u_tile_id:new a.ce(g),u_zoom_transition:new a.cf(g),u_inv_rot_matrix:new a.ch(g),u_merc_center:new a.cg(g),u_up_dir:new a.ce(g),u_height_lift:new a.cf(g),u_flood_light_color:new a.ce(g),u_vertical_scale:new a.cf(g),u_flood_light_intensity:new a.cf(g),u_ground_shadow_factor:new a.ce(g)}),fillExtrusionDepth:g=>({u_matrix:new a.ch(g),u_edge_radius:new a.cf(g),u_width_scale:new a.cf(g),u_vertical_scale:new a.cf(g),u_height_type:new a.cd(g),u_base_type:new a.cd(g)}),fillExtrusionPattern:g=>({u_matrix:new a.ch(g),u_lightpos:new a.ce(g),u_lightintensity:new a.cf(g),u_lightcolor:new a.ce(g),u_vertical_gradient:new a.cf(g),u_height_factor:new a.cf(g),u_edge_radius:new a.cf(g),u_width_scale:new a.cf(g),u_ao:new a.cg(g),u_height_type:new a.cd(g),u_base_type:new a.cd(g),u_tile_id:new a.ce(g),u_zoom_transition:new a.cf(g),u_inv_rot_matrix:new a.ch(g),u_merc_center:new a.cg(g),u_up_dir:new a.ce(g),u_height_lift:new a.cf(g),u_image:new a.cd(g),u_texsize:new a.cg(g),u_pixel_coord_upper:new a.cg(g),u_pixel_coord_lower:new a.cg(g),u_tile_units_to_pixels:new a.cf(g),u_opacity:new a.cf(g),u_pattern_transition:new a.cf(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new a.ch(g),u_opacity:new a.cf(g),u_ao_pass:new a.cf(g),u_meter_to_tile:new a.cf(g),u_ao:new a.cg(g),u_flood_light_intensity:new a.cf(g),u_flood_light_color:new a.ce(g),u_attenuation:new a.cf(g),u_edge_radius:new a.cf(g),u_fb:new a.cd(g),u_fb_size:new a.cf(g),u_dynamic_offset:new a.cf(g)}),fill:g=>({u_matrix:new a.ch(g),u_emissive_strength:new a.cf(g),u_ground_shadow_factor:new a.ce(g)}),fillPattern:g=>({u_matrix:new a.ch(g),u_emissive_strength:new a.cf(g),u_image:new a.cd(g),u_texsize:new a.cg(g),u_pixel_coord_upper:new a.cg(g),u_pixel_coord_lower:new a.cg(g),u_tile_units_to_pixels:new a.cf(g),u_ground_shadow_factor:new a.ce(g),u_pattern_transition:new a.cf(g)}),fillOutline:g=>({u_matrix:new a.ch(g),u_emissive_strength:new a.cf(g),u_world:new a.cg(g),u_ground_shadow_factor:new a.ce(g)}),fillOutlinePattern:g=>({u_matrix:new a.ch(g),u_emissive_strength:new a.cf(g),u_world:new a.cg(g),u_image:new a.cd(g),u_texsize:new a.cg(g),u_pixel_coord_upper:new a.cg(g),u_pixel_coord_lower:new a.cg(g),u_tile_units_to_pixels:new a.cf(g),u_ground_shadow_factor:new a.ce(g),u_pattern_transition:new a.cf(g)}),building:g=>({u_matrix:new a.ch(g),u_normal_matrix:new a.ch(g),u_opacity:new a.cf(g)}),buildingBloom:g=>({u_matrix:new a.ch(g)}),buildingDepth:g=>({u_matrix:new a.ch(g)}),elevatedStructuresDepth:g=>({u_matrix:new a.ch(g),u_depth_bias:new a.cf(g)}),elevatedStructures:g=>({u_matrix:new a.ch(g),u_ground_shadow_factor:new a.ce(g)}),elevatedStructuresDepthReconstruct:g=>({u_matrix:new a.ch(g),u_camera_pos:new a.ce(g),u_depth_bias:new a.cf(g),u_height_scale:new a.cf(g),u_reset_depth:new a.cf(g)}),circle:a.dT,collisionBox:g=>({u_matrix:new a.ch(g),u_inv_rot_matrix:new a.ch(g),u_camera_to_center_distance:new a.cf(g),u_extrude_scale:new a.cg(g),u_zoom_transition:new a.cf(g),u_merc_center:new a.cg(g),u_tile_id:new a.ce(g)}),collisionCircle:g=>({u_matrix:new a.ch(g),u_inv_matrix:new a.ch(g),u_camera_to_center_distance:new a.cf(g),u_viewport_size:new a.cg(g)}),debug:g=>({u_color:new a.dv(g),u_matrix:new a.ch(g),u_overlay:new a.cd(g),u_overlay_scale:new a.cf(g)}),clippingMask:g=>({u_matrix:new a.ch(g)}),heatmap:g=>({u_extrude_scale:new a.cf(g),u_intensity:new a.cf(g),u_matrix:new a.ch(g),u_inv_rot_matrix:new a.ch(g),u_merc_center:new a.cg(g),u_tile_id:new a.ce(g),u_zoom_transition:new a.cf(g),u_up_dir:new a.ce(g)}),heatmapTexture:g=>({u_image:new a.cd(g),u_color_ramp:new a.cd(g),u_opacity:new a.cf(g)}),hillshade:g=>({u_matrix:new a.ch(g),u_image:new a.cd(g),u_latrange:new a.cg(g),u_light:new a.cg(g),u_shadow:new a.dv(g),u_highlight:new a.dv(g),u_emissive_strength:new a.cf(g),u_accent:new a.dv(g)}),hillshadePrepare:g=>({u_matrix:new a.ch(g),u_image:new a.cd(g),u_dimension:new a.cg(g),u_zoom:new a.cf(g)}),line:a.dS,linePattern:a.dR,raster:g=>({u_matrix:new a.ch(g),u_normalize_matrix:new a.ch(g),u_globe_matrix:new a.ch(g),u_merc_matrix:new a.ch(g),u_grid_matrix:new a.dw(g),u_tl_parent:new a.cg(g),u_scale_parent:new a.cf(g),u_fade_t:new a.cf(g),u_opacity:new a.cf(g),u_image0:new a.cd(g),u_image1:new a.cd(g),u_brightness_low:new a.cf(g),u_brightness_high:new a.cf(g),u_saturation_factor:new a.cf(g),u_contrast_factor:new a.cf(g),u_spin_weights:new a.ce(g),u_perspective_transform:new a.cg(g),u_raster_elevation:new a.cf(g),u_zoom_transition:new a.cf(g),u_merc_center:new a.cg(g),u_cutoff_params:new a.d0(g),u_colorization_mix:new a.d0(g),u_colorization_offset:new a.cf(g),u_color_ramp:new a.cd(g),u_texture_offset:new a.cg(g),u_texture_res:new a.cg(g),u_emissive_strength:new a.cf(g)}),rasterParticle:g=>({u_matrix:new a.ch(g),u_normalize_matrix:new a.ch(g),u_globe_matrix:new a.ch(g),u_merc_matrix:new a.ch(g),u_grid_matrix:new a.dw(g),u_tl_parent:new a.cg(g),u_scale_parent:new a.cf(g),u_fade_t:new a.cf(g),u_opacity:new a.cf(g),u_image0:new a.cd(g),u_image1:new a.cd(g),u_raster_elevation:new a.cf(g),u_zoom_transition:new a.cf(g),u_merc_center:new a.cg(g),u_cutoff_params:new a.d0(g)}),rasterParticleTexture:g=>({u_texture:new a.cd(g),u_opacity:new a.cf(g)}),rasterParticleDraw:g=>({u_particle_texture:new a.cd(g),u_particle_texture_side_len:new a.cf(g),u_tile_offset:new a.cg(g),u_velocity:new a.cd(g),u_color_ramp:new a.cd(g),u_velocity_res:new a.cg(g),u_max_speed:new a.cf(g),u_uv_offset:new a.cg(g),u_data_scale:new a.cg(g),u_data_offset:new a.cf(g),u_particle_pos_scale:new a.cf(g),u_particle_pos_offset:new a.cg(g)}),rasterParticleUpdate:g=>({u_particle_texture:new a.cd(g),u_particle_texture_side_len:new a.cf(g),u_velocity:new a.cd(g),u_velocity_res:new a.cg(g),u_max_speed:new a.cf(g),u_speed_factor:new a.cf(g),u_reset_rate:new a.cf(g),u_rand_seed:new a.cf(g),u_uv_offset:new a.cg(g),u_data_scale:new a.cg(g),u_data_offset:new a.cf(g),u_particle_pos_scale:new a.cf(g),u_particle_pos_offset:new a.cg(g)}),symbol:g=>({u_is_size_zoom_constant:new a.cd(g),u_is_size_feature_constant:new a.cd(g),u_size_t:new a.cf(g),u_size:new a.cf(g),u_camera_to_center_distance:new a.cf(g),u_rotate_symbol:new a.cd(g),u_aspect_ratio:new a.cf(g),u_fade_change:new a.cf(g),u_matrix:new a.ch(g),u_label_plane_matrix:new a.ch(g),u_coord_matrix:new a.ch(g),u_is_text:new a.cd(g),u_elevation_from_sea:new a.cd(g),u_pitch_with_map:new a.cd(g),u_texsize:new a.cg(g),u_texsize_icon:new a.cg(g),u_texture:new a.cd(g),u_texture_icon:new a.cd(g),u_gamma_scale:new a.cf(g),u_device_pixel_ratio:new a.cf(g),u_tile_id:new a.ce(g),u_zoom_transition:new a.cf(g),u_inv_rot_matrix:new a.ch(g),u_merc_center:new a.cg(g),u_camera_forward:new a.ce(g),u_tile_matrix:new a.ch(g),u_up_vector:new a.ce(g),u_ecef_origin:new a.ce(g),u_is_halo:new a.cd(g),u_icon_transition:new a.cf(g),u_color_adj_mat:new a.ch(g),u_scale_factor:new a.cf(g),u_ground_shadow_factor:new a.ce(g),u_inv_matrix:new a.ch(g),u_normal_scale:new a.cf(g)}),background:g=>({u_matrix:new a.ch(g),u_emissive_strength:new a.cf(g),u_opacity:new a.cf(g),u_color:new a.dv(g)}),backgroundPattern:g=>({u_matrix:new a.ch(g),u_emissive_strength:new a.cf(g),u_opacity:new a.cf(g),u_image:new a.cd(g),u_pattern_tl:new a.cg(g),u_pattern_br:new a.cg(g),u_texsize:new a.cg(g),u_pattern_size:new a.cg(g),u_pixel_coord_upper:new a.cg(g),u_pixel_coord_lower:new a.cg(g),u_pattern_units_to_pixels:new a.cg(g)}),terrainRaster:g=>({u_matrix:new a.ch(g),u_image0:new a.cd(g),u_skirt_height:new a.cf(g),u_ground_shadow_factor:new a.ce(g)}),skybox:g=>({u_matrix:new a.ch(g),u_sun_direction:new a.ce(g),u_cubemap:new a.cd(g),u_opacity:new a.cf(g),u_temporal_offset:new a.cf(g)}),skyboxGradient:g=>({u_matrix:new a.ch(g),u_color_ramp:new a.cd(g),u_center_direction:new a.ce(g),u_radius:new a.cf(g),u_opacity:new a.cf(g),u_temporal_offset:new a.cf(g)}),skyboxCapture:g=>({u_matrix_3f:new a.dw(g),u_sun_direction:new a.ce(g),u_sun_intensity:new a.cf(g),u_color_tint_r:new a.d0(g),u_color_tint_m:new a.d0(g),u_luminance:new a.cf(g)}),globeRaster:g=>({u_proj_matrix:new a.ch(g),u_globe_matrix:new a.ch(g),u_normalize_matrix:new a.ch(g),u_merc_matrix:new a.ch(g),u_zoom_transition:new a.cf(g),u_merc_center:new a.cg(g),u_image0:new a.cd(g),u_grid_matrix:new a.dw(g),u_skirt_height:new a.cf(g),u_far_z_cutoff:new a.cf(g),u_frustum_tl:new a.ce(g),u_frustum_tr:new a.ce(g),u_frustum_br:new a.ce(g),u_frustum_bl:new a.ce(g),u_globe_pos:new a.ce(g),u_globe_radius:new a.cf(g),u_viewport:new a.cg(g)}),globeAtmosphere:g=>({u_frustum_tl:new a.ce(g),u_frustum_tr:new a.ce(g),u_frustum_br:new a.ce(g),u_frustum_bl:new a.ce(g),u_horizon:new a.cf(g),u_transition:new a.cf(g),u_fadeout_range:new a.cf(g),u_color:new a.d0(g),u_high_color:new a.d0(g),u_space_color:new a.d0(g),u_temporal_offset:new a.cf(g),u_horizon_angle:new a.cf(g)}),model:g=>({u_matrix:new a.ch(g),u_lighting_matrix:new a.ch(g),u_normal_matrix:new a.ch(g),u_node_matrix:new a.ch(g),u_lightpos:new a.ce(g),u_lightintensity:new a.cf(g),u_lightcolor:new a.ce(g),u_camera_pos:new a.ce(g),u_opacity:new a.cf(g),u_baseColorFactor:new a.d0(g),u_emissiveFactor:new a.d0(g),u_metallicFactor:new a.cf(g),u_roughnessFactor:new a.cf(g),u_baseTextureIsAlpha:new a.cd(g),u_alphaMask:new a.cd(g),u_alphaCutoff:new a.cf(g),u_baseColorTexture:new a.cd(g),u_metallicRoughnessTexture:new a.cd(g),u_normalTexture:new a.cd(g),u_occlusionTexture:new a.cd(g),u_emissionTexture:new a.cd(g),u_lutTexture:new a.cd(g),u_color_mix:new a.d0(g),u_aoIntensity:new a.cf(g),u_emissive_strength:new a.cf(g),u_occlusionTextureTransform:new a.d0(g)}),modelDepth:g=>({u_matrix:new a.ch(g),u_instance:new a.ch(g),u_node_matrix:new a.ch(g)}),groundShadow:g=>({u_matrix:new a.ch(g),u_ground_shadow_factor:new a.ce(g)}),stars:g=>({u_matrix:new a.ch(g),u_up:new a.ce(g),u_right:new a.ce(g),u_intensity_multiplier:new a.cf(g)}),snowParticle:g=>({u_modelview:new a.ch(g),u_projection:new a.ch(g),u_time:new a.cf(g),u_cam_pos:new a.ce(g),u_velocityConeAperture:new a.cf(g),u_velocity:new a.cf(g),u_horizontalOscillationRadius:new a.cf(g),u_horizontalOscillationRate:new a.cf(g),u_boxSize:new a.cf(g),u_billboardSize:new a.cf(g),u_simpleShapeParameters:new a.cg(g),u_screenSize:new a.cg(g),u_thinningCenterPos:new a.cg(g),u_thinningShape:new a.ce(g),u_thinningAffectedRatio:new a.cf(g),u_thinningParticleOffset:new a.cf(g),u_particleColor:new a.d0(g),u_direction:new a.ce(g)}),rainParticle:g=>({u_modelview:new a.ch(g),u_projection:new a.ch(g),u_time:new a.cf(g),u_cam_pos:new a.ce(g),u_texScreen:new a.cd(g),u_velocityConeAperture:new a.cf(g),u_velocity:new a.cf(g),u_boxSize:new a.cf(g),u_rainDropletSize:new a.cg(g),u_distortionStrength:new a.cf(g),u_rainDirection:new a.ce(g),u_color:new a.d0(g),u_screenSize:new a.cg(g),u_thinningCenterPos:new a.cg(g),u_thinningShape:new a.ce(g),u_thinningAffectedRatio:new a.cf(g),u_thinningParticleOffset:new a.cf(g),u_shapeDirectionalPower:new a.cf(g),u_shapeNormalPower:new a.cf(g),u_mode:new a.cf(g)}),vignette:g=>({u_vignetteShape:new a.ce(g),u_vignetteColor:new a.d0(g)}),occlusion:g=>({u_matrix:new a.ch(g),u_anchorPos:new a.ce(g),u_screenSizePx:new a.cg(g),u_occluderSizePx:new a.cg(g),u_color:new a.d0(g)})};class Yi{constructor(o,u,y,b){this.id=Yi.uniqueIdxCounter,Yi.uniqueIdxCounter++,this.context=o;const T=o.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||b||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=Yi.uniqueIdxCounter,Yi.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Yi.uniqueIdxCounter=0;const So={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wf{constructor(o,u,y,b,T,C){this.length=u.length,this.attributes=y,this.itemSize=u.bytesPerElement,this.dynamicDraw=b,this.instanceCount=C,this.context=o;const I=o.gl;this.buffer=I.createBuffer(),o.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||T||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let y=0;y<this.attributes.length;y++){const b=u.attributes[this.attributes[y].name];b!==void 0&&o.enableVertexAttribArray(b)}}setVertexAttribPointers(o,u,y){for(let b=0;b<this.attributes.length;b++){const T=this.attributes[b],C=u.attributes[T.name];C!==void 0&&o.vertexAttribPointer(C,T.components,o[So[T.type]],!1,this.itemSize,T.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(o,u,y){for(let b=0;b<this.attributes.length;b++){const T=u.attributes[this.attributes[b].name];T!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(T,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yl{constructor(o,u,y,b,T){this.context=o,this.width=u,this.height=y;const C=this.framebuffer=o.gl.createFramebuffer();b&&(this.colorAttachment=new Cu(o,C)),T&&(this.depthAttachmentType=T,this.depthAttachment=T==="renderbuffer"?new ag(o,C):new kp(o,C))}destroy(){const o=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&o.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&o.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&o.deleteTexture(u)}o.deleteFramebuffer(this.framebuffer)}}class tu{constructor(o,u){this.gl=o,this.clearColor=new Ly(this),this.clearDepth=new Ny(this),this.clearStencil=new ff(this),this.colorMask=new pf(this),this.depthMask=new Ip(this),this.stencilMask=new ng(this),this.stencilFunc=new Xs(this),this.stencilOp=new Wl(this),this.stencilTest=new wh(this),this.depthRange=new _c(this),this.depthTest=new Xl(this),this.depthFunc=new Tu(this),this.blend=new Sh(this),this.blendFunc=new Th(this),this.blendColor=new mf(this),this.blendEquation=new us(this),this.cullFace=new ja(this),this.cullFaceSide=new pa(this),this.frontFace=new Eu(this),this.program=new vc(this),this.activeTexture=new Eh(this),this.viewport=new Wc(this),this.bindFramebuffer=new Dp(this),this.bindRenderbuffer=new rg(this),this.bindTexture=new Ah(this),this.bindVertexBuffer=new Au(this),this.bindElementBuffer=new zy(this),this.bindVertexArrayOES=new gf(this),this.pixelStoreUnpack=new ig(this),this.pixelStoreUnpackPremultiplyAlpha=new Zl(this),this.pixelStoreUnpackFlipY=new Xc(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u,y){return new Yi(this,o,u,y)}createVertexBuffer(o,u,y,b,T){return new wf(this,o,u,y,b,T)}createRenderbuffer(o,u,y){const b=this.gl,T=b.createRenderbuffer();return this.bindRenderbuffer.set(T),b.renderbufferStorage(b.RENDERBUFFER,o,u,y),this.bindRenderbuffer.set(null),T}createFramebuffer(o,u,y,b){return new Yl(this,o,u,y,b)}clear({color:o,depth:u,stencil:y,colorMask:b}){const T=this.gl;let C=0;o&&(C|=T.COLOR_BUFFER_BIT,this.clearColor.set(o.toNonPremultipliedRenderColor(null)),this.colorMask.set(b||[!0,!0,!0,!0])),u!==void 0&&(C|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),y!==void 0&&(C|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),T.clear(C)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){a.bv(o.blendFunction,yr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let bc;function _d(g,o,u,y,b,T,C){const I=g.context,L=I.gl,F=g.transform,U=[a.aD(F.center.lng),a.aH(F.center.lat)],Y=u.layout.get("symbol-placement"),W=u.layout.get("text-variable-anchor"),Q=u.layout.get("icon-rotation-alignment")==="map",le=u.layout.get("text-rotation-alignment")==="map",oe=Y!=="point",ue=[];let de=0,xe=0;for(let Ne=0;Ne<y.length;Ne++){const je=y[Ne],dt=o.getTile(je),Ze=dt.getBucket(u);if(!Ze)continue;const Pt=Ze.getProjection().createInversionMatrix(F,je.canonical),_t=[],Lt=di(je,Ze,F),rn=!C&&Q&&oe,ft=C&&le&&oe,We=W&&Ze.hasTextData(),Tt=Ze.hasIconTextFit()&&We&&Ze.hasIconData(),mt=rn||ft||C&&We||Tt,It=Ze.projection.name==="globe",Nt=It?a.ah(F.zoom):0;It&&(_t.push("PROJECTION_GLOBE_VIEW"),mt&&_t.push("PROJECTED_POS_ON_VIEWPORT"));const Rt=g.getOrCreateProgram("collisionBox",{defines:_t});let Ft=Lt;b[0]===0&&b[1]===0||(Ft=g.translatePosMatrix(Lt,dt,b,T));const gn=C?Ze.textCollisionBox:Ze.iconCollisionBox,Dn=Ze.collisionCircleArray;if(Dn.length>0){const zn=a.bz(),Bn=Ft;a.cM(zn,Ze.placementInvProjMatrix,F.glCoordMatrix),a.cM(zn,zn,Ze.placementViewportMatrix),ue.push({circleArray:Dn,circleOffset:xe,transform:Bn,invTransform:zn,projection:Ze.getProjection()}),de+=Dn.length/4,xe=de}if(!gn)continue;g.terrain&&g.terrain.setupElevationDraw(dt,Rt);const xn=It?[je.canonical.x,je.canonical.y,1<<je.canonical.z]:[0,0,0];Rt.draw(g,L.LINES,Tn.disabled,er.disabled,g.colorModeForRenderPass(),Wn.disabled,gd(Ft,Pt,F,Nt,U,dt,xn,Ze.getProjection()),u.id,gn.layoutVertexBuffer,gn.indexBuffer,gn.segments,null,F.zoom,null,[gn.collisionVertexBuffer,gn.collisionVertexBufferExt])}if(!C||!ue.length)return;const Te=g.getOrCreateProgram("collisionCircle"),Me=new a.dU;Me.resize(4*de),Me._trim();let ke=0;for(const Ne of ue)for(let je=0;je<Ne.circleArray.length/4;je++){const dt=4*je,Ze=Ne.circleArray[dt+0],Pt=Ne.circleArray[dt+1],_t=Ne.circleArray[dt+2],Lt=Ne.circleArray[dt+3];Me.emplace(ke++,Ze,Pt,_t,Lt,0),Me.emplace(ke++,Ze,Pt,_t,Lt,1),Me.emplace(ke++,Ze,Pt,_t,Lt,2),Me.emplace(ke++,Ze,Pt,_t,Lt,3)}(!bc||bc.length<2*de)&&(bc=(function(Ne){const je=2*Ne,dt=new a.a_;dt.resize(je),dt._trim();for(let Ze=0;Ze<je;Ze++){const Pt=6*Ze;dt.uint16[Pt+0]=4*Ze+0,dt.uint16[Pt+1]=4*Ze+1,dt.uint16[Pt+2]=4*Ze+2,dt.uint16[Pt+3]=4*Ze+2,dt.uint16[Pt+4]=4*Ze+3,dt.uint16[Pt+5]=4*Ze+0}return dt})(de));const Fe=I.createIndexBuffer(bc,!0),Ve=I.createVertexBuffer(Me,a.dV.members,!0);for(const Ne of ue){const je={u_matrix:Ne.transform,u_inv_matrix:Ne.invTransform,u_camera_to_center_distance:(Le=F).getCameraToCenterDistance(Ne.projection),u_viewport_size:[Le.width,Le.height]};Te.draw(g,L.TRIANGLES,Tn.disabled,er.disabled,g.colorModeForRenderPass(),Wn.disabled,je,u.id,Ve,Fe,a.bd.simpleSegment(0,2*Ne.circleOffset,Ne.circleArray.length,Ne.circleArray.length/2),null,F.zoom)}var Le;Ve.destroy(),Fe.destroy()}const Kl=a.bz();function $p(g){const o=g._camera.getWorldToCamera(g.worldSize,1),u=a.az([],o,g.globeMatrix);a.bi(u,u);const y=[0,0,0],b=[0,1,0,0];return a.aA(b,b,u),y[0]=b[0],y[1]=b[1],y[2]=b[2],a.au(y,y),y}function fo({width:g,height:o,anchor:u,textOffset:y,textScale:b},T){const{horizontalAlign:C,verticalAlign:I}=a.bZ(u),L=-(C-.5)*g,F=-(I-.5)*o,U=a.b_(u,y);return new a.P((L/b+U[0])*T,(F/b+U[1])*T)}function pg(g,o,u,y,b,T,C,I,L,F){const U=g.text.placedSymbolArray,Y=g.text.dynamicLayoutVertexArray,W=g.icon.dynamicLayoutVertexArray,Q={},le=g.getProjection(),oe=mu(C,le,b),ue=b.elevation,de=le.upVectorScale(C.canonical,b.center.lat,b.worldSize).metersToTile;Y.clear();for(let xe=0;xe<U.length;xe++){const Te=U.get(xe),{tileAnchorX:Me,tileAnchorY:ke,numGlyphs:Fe}=Te,Ve=Te.hidden||!Te.crossTileID||g.allowVerticalPlacement&&!Te.placedOrientation?null:y[Te.crossTileID];if(Ve){let Le=0,Ne=0,je=0;if(ue){const Tt=ue?ue.getAtTileOffset(C,Me,ke):0,[mt,It,Nt]=le.upVector(C.canonical,Me,ke);Le=Tt*mt*de,Ne=Tt*It*de,je=Tt*Nt*de}let[dt,Ze,Pt,_t]=Yo(Te.projectedAnchorX+Le,Te.projectedAnchorY+Ne,Te.projectedAnchorZ+je,u?oe:T);const Lt=hh(b.getCameraToCenterDistance(le),_t);let rn=a.bJ(g.textSizeData,L,Te)*Lt/a.bU;u&&(rn*=g.tilePixelRatio/I);const ft=fo(Ve,rn);u?({x:dt,y:Ze,z:Pt}=le.projectTilePoint(Me+ft.x,ke+ft.y,C.canonical),[dt,Ze,Pt]=Yo(dt+Le,Ze+Ne,Pt+je,T)):(o&&ft._rotate(-b.angle),dt+=ft.x,Ze+=ft.y,Pt=0);const We=g.allowVerticalPlacement&&Te.placedOrientation===a.bI.vertical?Math.PI/2:0;for(let Tt=0;Tt<Fe;Tt++)a.bL(Y,dt,Ze,Pt,We);F&&Te.associatedIconIndex>=0&&(Q[Te.associatedIconIndex]={x:dt,y:Ze,z:Pt,angle:We})}else fh(Fe,Y)}if(F){W.clear();const xe=g.icon.placedSymbolArray;for(let Te=0;Te<xe.length;Te++){const Me=xe.get(Te),{numGlyphs:ke}=Me,Fe=Q[Te];if(Me.hidden||!Fe)fh(ke,W);else{const{x:Ve,y:Le,z:Ne,angle:je}=Fe;for(let dt=0;dt<ke;dt++)a.bL(W,Ve,Le,Ne,je)}}g.icon.dynamicLayoutVertexBuffer.updateData(W)}g.text.dynamicLayoutVertexBuffer.updateData(Y)}function qp(g,o,u,y,b,T,C={}){const I=u.paint.get("icon-translate"),L=u.paint.get("text-translate"),F=u.paint.get("icon-translate-anchor"),U=u.paint.get("text-translate-anchor"),Y=u.layout.get("icon-rotation-alignment"),W=u.layout.get("text-rotation-alignment"),Q=u.layout.get("icon-pitch-alignment"),le=u.layout.get("text-pitch-alignment"),oe=u.layout.get("icon-keep-upright"),ue=u.layout.get("text-keep-upright"),de=u.paint.get("icon-color-saturation"),xe=u.paint.get("icon-color-contrast"),Te=u.paint.get("icon-color-brightness-min"),Me=u.paint.get("icon-color-brightness-max"),ke=u.layout.get("symbol-elevation-reference")==="sea",Fe=g.context,Ve=Fe.gl,Le=g.transform,Ne=Y==="map",je=W==="map",dt=Q==="map",Ze=le==="map",Pt=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let _t=!1;const Lt=g.depthModeForSublayer(0,Tn.ReadOnly),rn=new Tn(g.context.gl.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D),ft=[a.aD(Le.center.lng),a.aH(Le.center.lat)],We=u.layout.get("text-variable-anchor"),Tt=Le.projection.name==="globe",mt=[],It=[0,-1,0];for(const Nt of y){const Rt=o.getTile(Nt),Ft=Rt.getBucket(u);if(!Ft||Ft.projection.name==="mercator"&&Tt||Ft.fullyClipped)continue;const gn=Ft.projection.name==="globe",Dn=gn?a.ah(Le.zoom):0,xn=mu(Nt,Ft.getProjection(),Le),zn=Le.calculatePixelsToTileUnitsMatrix(Rt),Bn=We&&Ft.hasTextData(),Kn=Ft.hasIconTextFit()&&Bn&&Ft.hasIconData(),Zn=Ft.getProjection().createInversionMatrix(Le,Nt.canonical),pr=(1<<Rt.tileID.canonical.z)*a.aj/g.transform.worldSize,$r=oi=>{let Tr=[0,0,0];if(oi){const Li=g.style.directionalLight,qr=g.style.ambientLight;Li&&qr&&(Tr=gh(g.style,Li,qr))}return Tr},sr=oi=>{Le.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||g.terrain)&&(oi.push("DEPTH_D24"),oi.push("DEPTH_OCCLUSION"))},kr=()=>{const oi=Ne&&u.layout.get("symbol-placement")!=="point",Tr=[];sr(Tr);const Li=oi||Kn,qr=Ft.elevationType==="road",ti=g.shadowRenderer,Ai=qr&&dt&&!!ti&&ti.enabled,Ca=$r(Ai),Ma=qr&&dt&&!g.terrain?rn:Lt,wa=u.paint.get("icon-image-cross-fade");g.terrainRenderModeElevated()&&dt&&Tr.push("PITCH_WITH_MAP_TERRAIN"),gn&&(Tr.push("PROJECTION_GLOBE_VIEW"),Li&&Tr.push("PROJECTED_POS_ON_VIEWPORT")),wa>0&&Ft.hasAnySecondaryIcon&&Tr.push("ICON_TRANSITION"),!Ft.icon.zOffsetVertexBuffer||qr&&g.terrain||Tr.push("Z_OFFSET"),de===0&&xe===0&&Te===0&&Me===1||Tr.push("COLOR_ADJUSTMENT"),Ft.sdfIcons&&Tr.push("RENDER_SDF"),Ai&&Tr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),qr&&dt&&!g.terrain&&Ft.icon.orientationVertexBuffer&&Tr.push("ELEVATED_ROADS");const Co=Ft.icon.programConfigurations.get(u.id),po=g.getOrCreateProgram("symbol",{config:Co,defines:Tr}),bs=Rt.imageAtlasTexture?Rt.imageAtlasTexture.size:[0,0],qa=Ft.iconSizeData,ts=a.bH(qa,Le.zoom),_l=dt||!Le.isOrthographic,nc=ad(xn,Rt.tileID.canonical,dt,Ne,Le,Ft.getProjection(),zn),Ya=Cl(xn,Rt.tileID.canonical,dt,Ne,Le,Ft.getProjection(),zn),ma=g.translatePosMatrix(Ya,Rt,I,F,!0),ca=g.translatePosMatrix(xn,Rt,I,F),Si=Li?Kl:nc,Ka=Ne&&!dt&&!oi;let Io=It;!Tt&&!Le.mercatorFromTransition||Ne||(Io=$p(Le));const Sa=gn?Io:It,Js=u.getColorAdjustmentMatrix(de,xe,Te,Me),Uu=Ou(qa.kind,ts,Ka,dt,g,ca,Si,ma,ke,!1,bs,[0,0],0,Nt,Dn,ft,Zn,Sa,Ft.getProjection(),Ca,pr,Js,wa,null),zh=Rt.imageAtlasTexture?Rt.imageAtlasTexture:null,Bf=u.layout.get("icon-size").constantOr(0)!==1||Ft.iconsNeedLinear,Ff=Ft.sdfIcons||g.options.rotating||g.options.zooming||Bf||_l?Ve.LINEAR:Ve.NEAREST,vl=Ft.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,Mc=g.terrain&&dt&&oi?a.bi(a.bz(),nc):Kl;if(oi&&Ft.icon){const Pa=Le.elevation,ks=Pa?Pa.getAtTileOffsetFunc(Nt,Le.center.lat,Le.worldSize,Ft.getProjection()):null,jh=Vc(xn,Rt.tileID.canonical,dt,Ne,Le,Ft.getProjection(),zn);yu(Ft,xn,g,!1,jh,Ya,dt,oe,ks,Nt)}return{program:po,buffers:Ft.icon,uniformValues:Uu,atlasTexture:zh,atlasTextureIcon:null,atlasInterpolation:Ff,atlasInterpolationIcon:null,isSDF:Ft.sdfIcons,hasHalo:vl,depthMode:Ma,tile:Rt,renderWithShadows:Ai,labelPlaneMatrixInv:Mc}},Yr=()=>{const oi=je&&u.layout.get("symbol-placement")!=="point",Tr=[],Li=oi||We||Kn,qr=Ft.elevationType==="road",ti=g.shadowRenderer,Ai=qr&&Ze&&!!ti&&ti.enabled,Ca=$r(Ai),Ma=qr&&Ze&&!g.terrain?rn:Lt;g.terrainRenderModeElevated()&&Ze&&Tr.push("PITCH_WITH_MAP_TERRAIN"),gn&&(Tr.push("PROJECTION_GLOBE_VIEW"),Li&&Tr.push("PROJECTED_POS_ON_VIEWPORT")),!Ft.text.zOffsetVertexBuffer||qr&&g.terrain||Tr.push("Z_OFFSET"),Ft.iconsInText&&Tr.push("RENDER_TEXT_AND_SYMBOL"),Tr.push("RENDER_SDF"),Ai&&Tr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),qr&&Ze&&!g.terrain&&Ft.text.orientationVertexBuffer&&Tr.push("ELEVATED_ROADS"),sr(Tr);const wa=Ft.text.programConfigurations.get(u.id),Co=g.getOrCreateProgram("symbol",{config:wa,defines:Tr});let po,bs=[0,0],qa=null;const ts=Ft.textSizeData;Ft.iconsInText&&(bs=Rt.imageAtlasTexture?Rt.imageAtlasTexture.size:[0,0],qa=Rt.imageAtlasTexture?Rt.imageAtlasTexture:null,po=Ze||!Le.isOrthographic||g.options.rotating||g.options.zooming||ts.kind==="composite"||ts.kind==="camera"?Ve.LINEAR:Ve.NEAREST);const _l=Rt.glyphAtlasTexture?Rt.glyphAtlasTexture.size:[0,0],nc=u.layout.get("text-size-scale-range"),Ya=a.ay(g.scaleFactor,nc[0],nc[1]),ma=a.bH(ts,Le.zoom,Ya),ca=ad(xn,Rt.tileID.canonical,Ze,je,Le,Ft.getProjection(),zn),Si=Cl(xn,Rt.tileID.canonical,Ze,je,Le,Ft.getProjection(),zn),Ka=g.translatePosMatrix(Si,Rt,L,U,!0),Io=g.translatePosMatrix(xn,Rt,L,U),Sa=Li?Kl:ca,Js=je&&!Ze&&!oi;let Uu=It;!Tt&&!Le.mercatorFromTransition||je||(Uu=$p(Le));const zh=Ou(ts.kind,ma,Js,Ze,g,Io,Sa,Ka,ke,!0,_l,bs,0,Nt,Dn,ft,Zn,gn?Uu:It,Ft.getProjection(),Ca,pr,null,null,Ya),Bf=Rt.glyphAtlasTexture?Rt.glyphAtlasTexture:null,Ff=Ve.LINEAR,vl=u.paint.get("text-halo-width").constantOr(1)!==0,Mc=g.terrain&&Ze&&oi?a.bi(a.bz(),ca):Kl;if(oi&&Ft.text){const Pa=Le.elevation,ks=Pa?Pa.getAtTileOffsetFunc(Nt,Le.center.lat,Le.worldSize,Ft.getProjection()):null,jh=Vc(xn,Rt.tileID.canonical,Ze,je,Le,Ft.getProjection(),zn);yu(Ft,xn,g,!0,jh,Si,Ze,ue,ks,Nt)}return{program:Co,buffers:Ft.text,uniformValues:zh,atlasTexture:Bf,atlasTextureIcon:qa,atlasInterpolation:Ff,atlasInterpolationIcon:po,isSDF:!0,hasHalo:vl,depthMode:Ma,tile:Rt,renderWithShadows:Ai,labelPlaneMatrixInv:Mc}},wi=Ft.icon.segments.get().length,lr=Ft.text.segments.get().length,ei=wi&&!C.onlyText?kr():null,ri=lr&&!C.onlyIcons?Yr():null,ai=u.paint.get("icon-opacity").constantOr(1),br=u.paint.get("text-opacity").constantOr(1);if(Pt&&Ft.canOverlap){_t=!0;const oi=ai&&!C.onlyText?Ft.icon.segments.get():[],Tr=br&&!C.onlyIcons?Ft.text.segments.get():[];for(const Li of oi)mt.push({segments:new a.bd([Li]),sortKey:Li.sortKey,state:ei});for(const Li of Tr)mt.push({segments:new a.bd([Li]),sortKey:Li.sortKey,state:ri})}else C.onlyText||mt.push({segments:ai?Ft.icon.segments:new a.bd([]),sortKey:0,state:ei}),C.onlyIcons||mt.push({segments:br?Ft.text.segments:new a.bd([]),sortKey:0,state:ri})}_t&&mt.sort(((Nt,Rt)=>Nt.sortKey-Rt.sortKey));for(const Nt of mt){const Rt=Nt.state;if(Rt)if(g.terrain?g.terrain.setupElevationDraw(Rt.tile,Rt.program,{useDepthForOcclusion:Le.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Rt.labelPlaneMatrixInv}):g.setupDepthForOcclusion(Le.depthOcclusionForSymbolsAndCircles,Rt.program),Fe.activeTexture.set(Ve.TEXTURE0),Rt.atlasTexture&&Rt.atlasTexture.bind(Rt.atlasInterpolation,Ve.CLAMP_TO_EDGE,!0),Rt.atlasTextureIcon&&(Fe.activeTexture.set(Ve.TEXTURE1),Rt.atlasTextureIcon&&Rt.atlasTextureIcon.bind(Rt.atlasInterpolationIcon,Ve.CLAMP_TO_EDGE,!0)),Rt.renderWithShadows&&g.shadowRenderer.setupShadows(Rt.tile.tileID.toUnwrapped(),Rt.program,"vector-tile"),g.uploadCommonLightUniforms(g.context,Rt.program),Rt.hasHalo){const Ft=Rt.uniformValues;Ft.u_is_halo=1,Du(Rt.buffers,Nt.segments,u,g,Rt.program,Rt.depthMode,b,T,Ft,2),Ft.u_is_halo=0}else{if(Rt.isSDF){const Ft=Rt.uniformValues;Rt.hasHalo&&(Ft.u_is_halo=1,Du(Rt.buffers,Nt.segments,u,g,Rt.program,Rt.depthMode,b,T,Ft,1)),Ft.u_is_halo=0}Du(Rt.buffers,Nt.segments,u,g,Rt.program,Rt.depthMode,b,T,Rt.uniformValues,1)}}}function Du(g,o,u,y,b,T,C,I,L,F){const U=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer,g.orientationVertexBuffer];b.draw(y,y.context.gl.TRIANGLES,T,C,I,Wn.disabled,L,u.id,g.layoutVertexBuffer,g.indexBuffer,o,u.paint,y.transform.zoom,g.programConfigurations.get(u.id),U,F)}function Sf(g,o){const u=1<<g.canonical.z,y=(o.x*u-g.canonical.x-g.wrap*u)*a.aj,b=(o.y*u-g.canonical.y)*a.aj,T=a.e2(o.z,o.y);return a.d2(y,b,T)}function Rn(g,o,u,y,b){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const T=g.context.gl,C=new Tn(g.context.gl.LEQUAL,Tn.ReadWrite,g.depthRangeFor3D),I=new Tn(g.context.gl.GREATER,Tn.ReadWrite,g.depthRangeFor3D),L=(function(Q){const le=a.cU(Q.pitch);let oe=.01;return Q.isOrthographic&&(oe=a.ai(1e-4,oe,a.cZ(le>=no?1:le/no))),2*oe})(g.transform),F=g.transform.getFreeCameraOptions().position,U="elevatedStructuresDepthReconstruct",Y=g.getOrCreateProgram(U,{defines:["DEPTH_RECONSTRUCTION"]}),W=g.getOrCreateProgram(U);for(const Q of y){const le=o.getTile(Q),oe=le.getBucket(u);if(!oe)continue;const ue=oe.elevatedStructures;if(!ue)continue;const de=oe.elevationBufferData.heightRange,xe=Sf(Q.toUnwrapped(),F),Te=g.translatePosMatrix(Q.projMatrix,le,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let Me,ke,Fe,Ve;if(b==="initialize"){if(!de||de.min>=1||ue.depthSegments.segments[0].primitiveLength===0)continue;Me=pd(Te,xe,L,1,0),ke=C,Fe=ue.depthSegments,Ve=Y}else if(b==="reset"){if(!de||de.min>=0||ue.maskSegments.segments[0].primitiveLength===0)continue;Me=pd(Te,xe,0,0,1),ke=I,Fe=ue.maskSegments,Ve=Y}else if(b==="geometry"){if(ue.depthSegments.segments[0].primitiveLength===0)continue;Me=pd(Te,xe,L,1,0),ke=C,Fe=ue.depthSegments,Ve=W}Ve.draw(g,T.TRIANGLES,ke,er.disabled,yr.disabled,Wn.disabled,Me,u.id,ue.vertexBuffer,ue.indexBuffer,Fe,u.paint,g.transform.zoom)}}function Tf(g,o,u){const{painter:y,sourceCache:b,layer:T,coords:C,colorMode:I,elevationType:L,terrainEnabled:F,pass:U}=g,Y=y.context.gl,W=T.paint.get("fill-pattern"),Q=T.paint.get("fill-pattern-cross-fade"),le=W.constantOr(null);let oe=L;L!=="road"||o&&!F||(oe="none");const ue=oe==="road",de=g.painter.shadowRenderer,xe=ue&&!!de&&de.enabled,Te=new Tn(y.context.gl.LEQUAL,Tn.ReadOnly,y.depthRangeFor3D);let Me=[0,0,0];if(xe){const Ve=y.style.directionalLight,Le=y.style.ambientLight;Ve&&Le&&(Me=gh(y.style,Ve,Le))}const ke=W&&W.constantOr(1),Fe=(Ve,Le)=>{let Ne,je,dt,Ze,Pt;Le?(Ne=ke&&!T.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",dt=Y.LINES):(Ne=ke?"fillPattern":"fill",dt=Y.TRIANGLES);for(const _t of C){const Lt=b.getTile(_t);if(ke&&!Lt.patternsLoaded())continue;const rn=Lt.getBucket(T);if(!rn)continue;const ft=o?rn.elevationBufferData:rn.bufferData;if(ft.isEmpty())continue;y.prepareDrawTile();const We=ft.programConfigurations.get(T.id),Tt=y.isTileAffectedByFog(_t),mt=[],It=[];ue&&(mt.push("ELEVATED_ROADS"),It.push(ft.elevatedLayoutVertexBuffer)),xe&&mt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ke&&(y.context.activeTexture.set(Y.TEXTURE0),Lt.imageAtlasTexture&&Lt.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),We.updatePaintBuffers());let Nt=!1;if(le&&Lt.imageAtlas){const xn=Lt.imageAtlas,zn=a.dZ.from(le),Bn=zn.getPrimary().scaleSelf(a.q.devicePixelRatio).toString(),Kn=zn.getSecondary(),Zn=xn.patternPositions.get(Bn),pr=Kn?xn.patternPositions.get(Kn.scaleSelf(a.q.devicePixelRatio).toString()):null;Nt=!!Zn&&!!pr,Zn&&We.setConstantPatternPositions(Zn,pr)}Q>0&&(Nt||We.getPatternTransitionVertexBuffer("fill-pattern"))&&mt.push("FILL_PATTERN_TRANSITION");const Rt=y.getOrCreateProgram(Ne,{config:We,overrideFog:Tt,defines:mt}),Ft=y.translatePosMatrix(_t.projMatrix,Lt,T.paint.get("fill-translate"),T.paint.get("fill-translate-anchor"));xe&&de.setupShadows(Lt.tileID.toUnwrapped(),Rt,"vector-tile");const gn=T.paint.get("fill-emissive-strength");if(Le){Ze=ft.lineIndexBuffer,Pt=ft.lineSegments;const xn=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[Y.drawingBufferWidth,Y.drawingBufferHeight];je=Ne==="fillOutlinePattern"&&ke?Fy(Ft,gn,y,Lt,xn,Me,Q):cg(Ft,gn,xn,Me)}else Ze=ft.indexBuffer,Pt=ft.triangleSegments,je=ke?By(Ft,gn,y,Lt,Me,Q):xf(Ft,gn,Me);y.uploadCommonUniforms(y.context,Rt,_t.toUnwrapped());let Dn=Ve;(L==="road"&&!F||L==="offset")&&(Dn=Te),Rt.draw(y,dt,Dn,u||y.stencilModeForClipping(_t),I,Wn.disabled,je,T.id,ft.layoutVertexBuffer,Ze,Pt,T.paint,y.transform.zoom,We,It)}};y.renderPass===U&&Fe(y.depthModeForSublayer(1,y.renderPass==="opaque"?Tn.ReadWrite:Tn.ReadOnly),!1),oe==="none"&&y.renderPass==="translucent"&&T.paint.get("fill-antialias")&&Fe(y.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,Tn.ReadOnly),!0)}function vd(g,o,u,y,b,T,C,I){u.resetLayerRenderingStats(g);const L=g.context,F=L.gl,U=g.transform,Y=u.paint.get("fill-extrusion-pattern"),W=u.paint.get("fill-extrusion-pattern-cross-fade"),Q=Y.constantOr(null),le=Y.constantOr(1),oe=u.paint.get("fill-extrusion-opacity"),ue=g.style.enable3dLights(),de=u.paint.get(ue&&!le?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),xe=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),de],Te=u.layout.get("fill-extrusion-edge-radius"),Me=Te>0&&!u.paint.get("fill-extrusion-rounded-roof"),ke=Me?0:Te,Fe=U.projection.name==="globe"?a.e5():0,Ve=U.projection.name==="globe",Le=Ve?a.ah(U.zoom):0,Ne=[a.aD(U.center.lng),a.aH(U.center.lat)],je=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",dt=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(je?null:u.lut).toArray01().slice(0,3),Ze=u.paint.get("fill-extrusion-flood-light-intensity"),Pt=u.paint.get("fill-extrusion-vertical-scale"),_t=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Lt=u.paint.get("fill-extrusion-height-alignment"),rn=u.paint.get("fill-extrusion-base-alignment"),ft=qc(g,u.paint.get("fill-extrusion-cutoff-fade-range")),We=[];let Tt;Ve&&We.push("PROJECTION_GLOBE_VIEW"),xe[0]>0&&We.push("FAUX_AO"),Me&&We.push("ZERO_ROOF_RADIUS"),I&&We.push("HAS_CENTROID"),Ze>0&&We.push("FLOOD_LIGHT"),ft.shouldRenderCutoff&&We.push("RENDER_CUTOFF"),_t&&We.push("RENDER_WALL_MODE");const mt=g.renderPass==="shadow",It=g.shadowRenderer,Nt=mt&&!!It,Rt=mt?Wn.disabled:Wn.backCCW;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Ft=[0,0,0];if(It){const xn=g.style.directionalLight,zn=g.style.ambientLight;xn&&zn&&(Ft=gh(g.style,xn,zn)),mt||(We.push("RENDER_SHADOWS","DEPTH_TEXTURE"),It.useNormalOffset&&We.push("NORMAL_OFFSET")),Tt=We.concat(["SHADOWS_SINGLE_CASCADE"])}const gn=Nt?"fillExtrusionDepth":le?"fillExtrusionPattern":"fillExtrusion",Dn=u.getLayerRenderingStats();for(const xn of y){const zn=o.getTile(xn),Bn=zn.getBucket(u);if(!Bn||Bn.projection.name!==U.projection.name)continue;let Kn=!1;It&&(Kn=It.getMaxCascadeForTile(xn.toUnwrapped())===0);const Zn=g.isTileAffectedByFog(xn),pr=Bn.programConfigurations.get(u.id);let $r=!1;if(Q&&zn.imageAtlas){const ri=zn.imageAtlas,ai=a.dZ.from(Q),br=ai.getPrimary().scaleSelf(a.q.devicePixelRatio).toString(),oi=ai.getSecondary(),Tr=ri.patternPositions.get(br),Li=oi?ri.patternPositions.get(oi.scaleSelf(a.q.devicePixelRatio).toString()):null;$r=!!Tr&&!!Li,Tr&&pr.setConstantPatternPositions(Tr,Li)}W>0&&($r||pr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&We.push("FILL_EXTRUSION_PATTERN_TRANSITION");const sr=g.getOrCreateProgram(gn,{config:pr,defines:Kn?Tt:We,overrideFog:Zn});if(g.terrain&&g.terrain.setupElevationDraw(zn,sr,{useMeterToDem:!0}),!Bn.centroidVertexBuffer){const ri=sr.attributes.a_centroid_pos;ri!==void 0&&F.vertexAttrib2f(ri,0,0)}!mt&&It&&It.setupShadows(zn.tileID.toUnwrapped(),sr,"vector-tile"),le&&(g.context.activeTexture.set(F.TEXTURE0),zn.imageAtlasTexture&&zn.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),pr.updatePaintBuffers());const kr=u.paint.get("fill-extrusion-vertical-gradient"),Yr=1/Bn.tileToMeter;let wi;if(mt&&It){if(Ef(zn.tileID,Bn.maxHeight,g))continue;const ri=It.calculateShadowPassMatrixFromTile(zn.tileID.toUnwrapped());wi=Bp(ri,ke,Yr,Pt,Lt,rn)}else{const ri=g.translatePosMatrix(xn.expandedProjMatrix,zn,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ai=U.projection.createInversionMatrix(U,xn.canonical);wi=le?fd(ri,g,kr,oe,xe,ke,Yr,xn,zn,Fe,Lt,rn,Le,Ne,ai,dt,Pt,W):jp(ri,g,kr,oe,xe,ke,Yr,xn,Fe,Lt,rn,Le,Ne,ai,dt,Pt,Ze,Ft)}g.uploadCommonUniforms(L,sr,xn.toUnwrapped(),null,ft);let lr=Bn.segments;if(U.projection.name==="mercator"&&!mt&&(lr=Bn.getVisibleSegments(zn.tileID,g.terrain,g.transform.getFrustum(0)),!lr.get().length))continue;if(Dn)if(mt)for(const ri of lr.get())Dn.numRenderedVerticesInShadowPass+=ri.primitiveLength;else for(const ri of lr.get())Dn.numRenderedVerticesInTransparentPass+=ri.primitiveLength;const ei=[];(g.terrain||I)&&ei.push(Bn.centroidVertexBuffer),Ve&&ei.push(Bn.layoutVertexExtBuffer),_t&&ei.push(Bn.wallVertexBuffer),sr.draw(g,L.gl.TRIANGLES,b,T,C,Rt,wi,u.id,Bn.layoutVertexBuffer,Bn.indexBuffer,lr,u.paint,g.transform.zoom,pr,ei)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}class wc{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function ka(g,o,u,y,b,T,C,I,L,F,U,Y,W,Q,le,oe,ue,de,xe,Te){const Me=o.context,ke=Me.gl,Fe=o.transform,Ve=o.transform.zoom,Le=[],Ne=g.translate,je=g.translateAnchor,dt=g.edgeRadius,Ze=qc(o,g.cutoffFadeRange);U==="clear"?(Le.push("CLEAR_SUBPASS"),Te&&(Le.push("CLEAR_FROM_TEXTURE"),Me.activeTexture.set(ke.TEXTURE0),Te.bind(ke.LINEAR,ke.CLAMP_TO_EDGE))):U==="sdf"&&Le.push("SDF_SUBPASS"),de&&Le.push("HAS_CENTROID"),Ze.shouldRenderCutoff&&Le.push("RENDER_CUTOFF");const Pt=(_t,Lt,rn,ft,We)=>{const Tt=Lt.programConfigurations.get(y.id),mt=o.isTileAffectedByFog(_t),It=o.getOrCreateProgram("fillExtrusionGroundEffect",{config:Tt,defines:Le,overrideFog:mt}),Nt=((Ft,gn,Dn,xn,zn,Bn,Kn,Zn,pr,$r,sr)=>({u_matrix:gn,u_opacity:Dn,u_ao_pass:xn?1:0,u_meter_to_tile:zn,u_ao:Bn,u_flood_light_intensity:Kn,u_flood_light_color:Zn,u_attenuation:pr,u_edge_radius:$r,u_fb:0,u_fb_size:sr,u_dynamic_offset:1}))(0,ft,Y,F,We,[W,Q*We],le,oe,ue,Ve>=17?0:dt*We,Te?Te.size[0]:0),Rt=[];de&&Rt.push(Lt.hiddenByLandmarkVertexBuffer),o.uploadCommonUniforms(Me,It,_t.toUnwrapped(),null,Ze),It.draw(o,Me.gl.TRIANGLES,T,C,I,L,Nt,y.id,Lt.vertexBuffer,Lt.indexBuffer,rn,y.paint,Ve,Tt,Rt)};for(const _t of b){const Lt=u.getTile(_t),rn=Lt.getBucket(y);if(!rn||rn.projection.name!==Fe.projection.name||!rn.groundEffect||rn.groundEffect&&!rn.groundEffect.hasData())continue;const ft=rn.groundEffect,We=1/rn.tileToMeter;{const Tt=o.translatePosMatrix(_t.projMatrix,Lt,Ne,je),mt=ft.getDefaultSegment();Pt(_t,ft,mt,Tt,We)}if(xe)for(let Tt=0;Tt<4;Tt++){const mt=a.e3[Tt](_t),It=u.getTile(mt);if(!It)continue;const Nt=It.getBucket(y);if(!Nt||Nt.projection.name!==Fe.projection.name||!Nt.groundEffect||Nt.groundEffect&&!Nt.groundEffect.hasData())continue;const Rt=Nt.groundEffect;let Ft,gn;Tt===0?(Ft=[-a.aj,0,0],gn=1):Tt===1?(Ft=[a.aj,0,0],gn=0):Tt===2?(Ft=[0,-a.aj,0],gn=3):(Ft=[0,a.aj,0],gn=2);const Dn=Rt.regionSegments[gn];if(!Dn)continue;const xn=new Float32Array(16);a.bo(xn,_t.projMatrix,Ft),Pt(_t,Rt,Dn,o.translatePosMatrix(xn,Lt,Ne,je),We)}}}function jn(g,o,u,y,b,T,C){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const I=T?T.findDEMTileFor(u):null;if(!(I&&I.dem||C))return;T&&I&&I.dem&&y.selfDEMTileTimestamp!==I.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=I.dem._timestamp);const L=de=>new a.P(Math.ceil((de+a.e7)*a.e8),0),F=de=>{const xe=o.getSource().minzoom,Te=ke=>{const Fe=o.getTileByID(ke);if(Fe&&Fe.hasData())return Fe.getBucket(b)},Me=[0,-1,1];for(const ke of Me){if(de.overscaledZ+ke<xe)continue;const Fe=Te(de.calculateScaledKey(de.overscaledZ+ke));if(Fe)return Fe}},U=[0,0,0],Y=(de,xe)=>(U[0]=Math.min(de.min.y,xe.min.y),U[1]=Math.max(de.max.y,xe.max.y),U[2]=a.aj-xe.min.x>de.max.x?xe.min.x-a.aj:de.max.x,U),W=(de,xe)=>(U[0]=Math.min(de.min.x,xe.min.x),U[1]=Math.max(de.max.x,xe.max.x),U[2]=a.aj-xe.min.y>de.max.y?xe.min.y-a.aj:de.max.y,U),Q=[(de,xe)=>Y(de,xe),(de,xe)=>Y(xe,de),(de,xe)=>W(de,xe),(de,xe)=>W(xe,de)],le=(de,xe,Te,Me,ke,Fe,Ve)=>{if(!T)return 0;const Le=[[Fe?Te:de,Fe?de:Te,0],[Fe?Te:xe,Fe?xe:Te,0]],Ne=Ve<0?a.aj+Ve:Ve,je=[Fe?Ne:(de+xe)/2,Fe?(de+xe)/2:Ne,0];return Te===0&&Ve<0||Te!==0&&Ve>0?T.getForTilePoints(ke,[je],!0,Me):Le.push(je),T.getForTilePoints(u,Le,!0,I),Math.max(Le[0][2],Le[1][2],je[2])/T.exaggeration()};for(let de=0;de<4;de++){const xe=y.borderFeatureIndices[de];if(xe.length===0)continue;const Te=a.e3[de](u),Me=F(Te);if(!(Me&&Me instanceof a.e4))continue;const ke=T?T.findDEMTileFor(Te):null;if(!(ke&&ke.dem||C)||(T&&ke&&ke.dem&&y.borderDEMTileTimestamp[de]!==ke.dem._timestamp&&(y.borderDoneWithNeighborZ[de]=-1,y.borderDEMTileTimestamp[de]=ke.dem._timestamp),y.borderDoneWithNeighborZ[de]===Me.canonical.z))continue;Me.centroidVertexArray.length===0&&Me.createCentroidsBuffer();const Fe=(de<2?1:5)-de,Ve=Me.borderDoneWithNeighborZ[Fe]!==y.canonical.z,Le=Me.borderFeatureIndices[Fe];let Ne=0;if(y.canonical.z!==Me.canonical.z){for(const je of xe)y.showCentroid(y.featuresOnBorder[je]);if(Ve)for(const je of Le)Me.showCentroid(Me.featuresOnBorder[je]);y.borderDoneWithNeighborZ[de]=Me.canonical.z,Me.borderDoneWithNeighborZ[Fe]=y.canonical.z}for(const je of xe){const dt=y.featuresOnBorder[je],Ze=y.centroidData[dt.centroidDataIndex],Pt=dt.borders[de];let _t;for(;Ne<Le.length;){_t=Me.featuresOnBorder[Le[Ne]];const Lt=_t.borders[Fe];if(Lt[1]>Pt[0]+3||Lt[0]>Pt[0]-3)break;Me.showCentroid(_t),Ne++}if(_t&&Ne<Le.length){const Lt=Ne;let rn=0;for(;!(_t.borders[Fe][0]>Pt[1]-3)&&(rn++,++Ne!==Le.length);)_t=Me.featuresOnBorder[Le[Ne]];_t=Me.featuresOnBorder[Le[Lt]];let ft=!1;if(rn>=1){const mt=_t.borders[Fe];Math.abs(Pt[0]-mt[0])<3&&Math.abs(Pt[1]-mt[1])<3&&(rn=1,ft=!0,Ne=Lt+1)}else if(rn===0){y.showCentroid(dt);continue}const We=Me.centroidData[_t.centroidDataIndex];C&&ft&&(((oe=Ze).flags|(ue=We).flags)&a.e6?(oe.flags|=a.e6,ue.flags|=a.e6):(oe.flags&=~a.e6,ue.flags&=~a.e6));const Tt=dt.intersectsCount()>1||_t.intersectsCount()>1;if(rn>1)Ne=Lt,Ze.centroidXY=We.centroidXY=new a.P(0,0);else if(ke&&ke.dem&&!Tt){const mt=Q[de](Ze,We),It=de%2?a.aj-1:0,Nt=le(mt[0],Math.min(a.aj-1,mt[1]),It,ke,Te,de<2,mt[2]);Ze.centroidXY=We.centroidXY=L(Nt)}else Tt?Ze.centroidXY=We.centroidXY=new a.P(0,0):(Ze.centroidXY=y.encodeBorderCentroid(dt),We.centroidXY=Me.encodeBorderCentroid(_t));y.writeCentroidToBuffer(Ze),Me.writeCentroidToBuffer(We)}else y.showCentroid(dt)}y.borderDoneWithNeighborZ[de]=Me.canonical.z,Me.borderDoneWithNeighborZ[Fe]=y.canonical.z}var oe,ue;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const Hp=[1,0,0],Gp=[0,1,0],mg=[0,0,1];function Ef(g,o,u){const y=u.transform,b=u.shadowRenderer;if(!b)return!0;const T=g.toUnwrapped(),C=y.tileSize*b._cascades[u.currentShadowCascade].scale;let I=o;if(y.elevation){const oe=y.elevation.getMinMaxForTile(g);oe&&(I+=oe.max)}const L=[...b.shadowDirection];L[2]=-L[2];const F=b.computeSimplifiedTileShadowVolume(T,I,C,L);if(!F)return!1;const U=[Hp,Gp,mg,L,[L[0],0,L[2]],[0,L[1],L[2]]],Y=y.projection.name==="globe",W=y.scaleZoom(C),Q=a.cy.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,W,!Y),le=b.getCurrentCascadeFrustum();return Q.intersectsPrecise(F.vertices,F.planes,U)===0||le.intersectsPrecise(F.vertices,F.planes,U)===0}function Jl(g){const{painter:o,source:u,layer:y,coords:b}=g,T=g.defines,C=o.context,I=o.renderPass==="shadow",L=o.renderPass==="light-beam",F=o.shadowRenderer;let U;F&&(U=T.concat(["SHADOWS_SINGLE_CASCADE"]));const Y=a.e9(o.transform.center.lat,o.transform.zoom);for(const W of b){const Q=u.getTile(W),le=Q.getBucket(y);if(!le)continue;let oe=!1;F&&(oe=F.getMaxCascadeForTile(W.toUnwrapped())===0);const ue=le.programConfigurations.get(y.id);let de,xe,Te=o.translatePosMatrix(W.expandedProjMatrix,Q,[0,0],"map");if(Te=a.cP(a.bz(),Te,[1,1,g.verticalScale]),I&&F){if(Ef(Q.tileID,le.maxHeight*Y,o))continue;let Me=F.calculateShadowPassMatrixFromTile(Q.tileID.toUnwrapped());Me=a.cP(a.bz(),Me,[1,1,g.verticalScale]),xe=Vy(Me),de=o.getOrCreateProgram("buildingDepth",{config:ue,defines:oe?U:T,overrideFog:!1})}else if(L)de=o.getOrCreateProgram("buildingBloom",{config:ue,defines:oe?U:T,overrideFog:!1}),xe=md(Te);else{const Me=o.transform.calculatePosMatrix(W.toUnwrapped(),o.transform.worldSize);a.cP(Me,Me,[1,1,g.verticalScale]);const ke=a.bz();a.cP(ke,Me,[1,-1,1/Y]),a.bi(ke,ke),a.ea(ke,ke),xe=ug(Te,ke),de=o.getOrCreateProgram("building",{config:ue,defines:oe?U:T,overrideFog:!1}),F&&F.setupShadowsFromMatrix(Me,de,!0)}if(o.uploadCommonUniforms(C,de,W.toUnwrapped(),null,null),L){const Me=le.bloomGeometry;de.draw(o,C.gl.TRIANGLES,g.depthMode,er.disabled,g.blendMode,Wn.disabled,xe,y.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segmentsBucket,y.paint,o.transform.zoom,ue,[Me.layoutAttenuationBuffer,Me.layoutColorBuffer])}else de.draw(o,C.gl.TRIANGLES,g.depthMode,er.disabled,g.blendMode,I?Wn.disabled:Wn.backCW,xe,y.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,y.paint,o.transform.zoom,ue,[le.layoutNormalBuffer,le.layoutColorBuffer])}}function Wp(g){return[g[0]*a.eb,g[1]*a.eb,g[2]*a.eb,0]}function Af(g,o,u,y,b,T,C,I,L){const F=y.getSource(),U=u.globeSharedBuffers;if(!U)return;let Y,W,Q;if(o&&(Y=y.getTile(o)),F instanceof a.aP?(W=F.texture,Q=a.dE(0,0,u.transform)):Y&&o&&(W=Y.texture,Q=a.dE(o.canonical.z,o.canonical.x,u.transform)),!W||!Q)return;g||(Q=a.cP(a.bz(),Q,[1,-1,1]));const le=u.context,oe=le.gl,ue=b.paint.get("raster-resampling")==="nearest"?oe.NEAREST:oe.LINEAR,de=u.colorModeForDrapableLayerRenderPass(T),xe=C.defines;xe.push("GLOBE_POLES");const Te=new Tn(oe.LEQUAL,Tn.ReadWrite,u.depthRangeFor3D),Me=Float32Array.from(u.transform.expandedFarZProjMatrix),ke=Float32Array.from(a.bh(a.dD(new a.cA(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),le.activeTexture.set(oe.TEXTURE0),W.bind(ue,oe.CLAMP_TO_EDGE),le.activeTexture.set(oe.TEXTURE1),W.bind(ue,oe.CLAMP_TO_EDGE),"useMipmap"in W&&le.extTextureFilterAnisotropic&&u.transform.pitch>20&&oe.texParameterf(oe.TEXTURE_2D,le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,le.extTextureFilterAnisotropicMax);const[Fe,Ve,Le,Ne]=o?U.getPoleBuffers(o.canonical.z,!1):U.getPoleBuffers(0,!0),je=b.paint.get("raster-elevation");let dt;g?(dt=Fe,u.renderDefaultNorthPole=je!==0):(dt=Ve,u.renderDefaultSouthPole=je!==0);const Ze=Wp(C.mix),Pt=((Lt,rn,ft,We,Tt,mt,It,Nt,Rt,Ft,gn,Dn,xn)=>yd(Lt,rn,ft,new Float32Array(16),new Float32Array(9),[0,0],We,[0,0],[0,0,0,0],1,{opacity:1,mix:0},mt,[0,0],Nt,2,Ft,gn,Dn,1,0,xn))(Me,ke,Q,a.ah(u.transform.zoom),0,b,0,je,0,Ze,C.offset,C.range,T),_t=u.getOrCreateProgram("raster",{defines:xe});u.uploadCommonUniforms(le,_t,null),_t.draw(u,oe.TRIANGLES,Te,L,de,I,Pt,b.id,dt,Le,Ne)}function $y(g){const o=g._nearZ,u=g.projection.farthestPixelDistance(g),y=u-o,b=.2*g.height,T=o+b;return[o,u,(T-b-o)/y,(T-o)/y]}function mv(g,o,u,y){if(g)return o instanceof Ro&&g instanceof lh?o.getTextureDescriptor(g,u,!0):{texture:g.texture,mix:Wp(y.mix),offset:y.offset,buffer:0,tileSize:1}}var Ys=a.ec([{name:"a_index",type:"Int16",components:1}]);class gg{constructor(o,u,y,b){const T={width:y[0],height:y[1],data:null},C=o.gl;this.targetColorTexture=new a.T(o,T,C.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(o,T,C.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(u,b),this.lastInvalidatedAt=0}updateParticleTexture(o,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,b=u.width*u.height;this.particleTexture0=new a.T(this.context,u,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,u,y.RGBA8,{premultiply:!1,useMipmap:!1});const T=new a.ed;T.reserve(b);for(let C=0;C<b;C++)T.emplaceBack(C);this.particleIndexBuffer=this.context.createVertexBuffer(T,Ys.members,!0),this.particleSegment=a.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=a.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function _s(g,o,u){if(!g)return null;const y=o.getTextureDescriptor(g,u,!0);if(!y)return null;let{texture:b,mix:T,offset:C,tileSize:I,buffer:L,format:F}=y;if(!b||!F)return null;let U=!1;return F==="uint32"&&(U=!0,T[3]=0,T=xc(a.ee,T,[0,u.paint.get("raster-particle-max-speed")]),C=Zs(a.ee,C,[0,u.paint.get("raster-particle-max-speed")])),{texture:b,textureOffset:[L/(I+2*L),I/(I+2*L)],tileSize:I,scalarData:U,scale:T,offset:C,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[F]]}}function ku(g){const o=g._nearZ,u=g.projection.farthestPixelDistance(g),y=u-o,b=.2*g.height,T=o+b;return[o,u,(T-b-o)/y,(T-o)/y]}const qy=new a.am(1,0,0,1),Xp=new a.am(0,1,0,1),yg=new a.am(0,0,1,1),Hy=new a.am(1,0,1,1),Gy=new a.am(0,1,1,1);function Sc(g,o,u,y,b,T){for(let C=0;C<u.length;C++)if(b){const F=new a.am(y.r*.8,y.g*.8,y.b*.8,1);Ei(g,o,u[C],y,-1,-1,T),Ei(g,o,u[C],y,-1,1,T),Ei(g,o,u[C],y,1,1,T),Ei(g,o,u[C],y,1,-1,T),Ei(g,o,u[C],F,0,0,T)}else Ei(g,o,u[C],y,0,0,T)}function Ei(g,o,u,y,b,T,C){const I=g.context,L=g.transform,F=I.gl,U=L.projection.name==="globe",Y=U?["PROJECTION_GLOBE_VIEW"]:[];let W=a.bw(u.projMatrix);if(U&&a.ah(L.zoom)>0){const Ze=a.bg(u.canonical,L),Pt=a.ef(Ze);W=a.az(new Float32Array(16),L.globeMatrix,Pt),a.az(W,L.projMatrix,W)}const Q=a.bz();Q[12]+=2*b/(a.q.devicePixelRatio*L.width),Q[13]+=2*T/(a.q.devicePixelRatio*L.height),a.az(W,Q,W);const le=g.getOrCreateProgram("debug",{defines:Y}),oe=o.getTileByID(u.key);g.terrain&&g.terrain.setupElevationDraw(oe,le);const ue=Tn.disabled,de=er.disabled,xe=g.colorModeForRenderPass(),Te="$debug";I.activeTexture.set(F.TEXTURE0),g.emptyTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),U?oe._makeGlobeTileDebugBuffers(g.context,L):oe._makeDebugTileBoundsBuffers(g.context,L.projection);const Me=oe._tileDebugBuffer||g.debugBuffer,ke=oe._tileDebugIndexBuffer||g.debugIndexBuffer,Fe=oe._tileDebugSegments||g.debugSegments;if(le.draw(g,F.LINE_STRIP,ue,de,xe,Wn.disabled,Jc(W,y.toPremultipliedRenderColor(null)),Te,Me,ke,Fe,null,null,null,[oe._globeTileDebugBorderBuffer]),C){const Ze=oe.latestRawTileData,Pt=Math.floor((Ze&&Ze.byteLength||0)/1024);let _t=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(_t+=` => ${u.overscaledZ}`),_t+=` ${oe.state}`,_t+=` ${Pt}kb`,(function(Lt,rn){Lt.initDebugOverlayCanvas();const ft=Lt.debugOverlayCanvas,We=Lt.context.gl,Tt=Lt.debugOverlayCanvas.getContext("2d");Tt.clearRect(0,0,ft.width,ft.height),Tt.shadowColor="white",Tt.shadowBlur=2,Tt.lineWidth=1.5,Tt.strokeStyle="white",Tt.textBaseline="top",Tt.font="bold 36px Open Sans, sans-serif",Tt.fillText(rn,5,5),Tt.strokeText(rn,5,5),Lt.debugOverlayTexture.update(ft),Lt.debugOverlayTexture.bind(We.LINEAR,We.CLAMP_TO_EDGE)})(g,_t)}const Ve=o.getTile(u).tileSize,Le=512/Math.min(Ve,512)*(u.overscaledZ/L.zoom)*.5,Ne=oe._tileDebugTextBuffer||g.debugBuffer,je=oe._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,dt=oe._tileDebugTextSegments||g.debugSegments;le.draw(g,F.TRIANGLES,ue,de,yr.alphaBlended,Wn.disabled,Jc(W,a.am.transparent.toPremultipliedRenderColor(null),Le),Te,Ne,je,dt,null,null,null,[oe._globeTileDebugTextBuffer])}function xd(g,o,u,y){Cf(g,0,o+u/2,g.transform.width,u,y)}function Zp(g,o,u,y){Cf(g,o-u/2,0,u,g.transform.height,y)}function Cf(g,o,u,y,b,T){const C=g.context,I=C.gl;I.enable(I.SCISSOR_TEST),I.scissor(o*a.q.devicePixelRatio,u*a.q.devicePixelRatio,y*a.q.devicePixelRatio,b*a.q.devicePixelRatio),C.clear({color:T}),I.disable(I.SCISSOR_TEST)}const Wy=a.ec([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Xy}=Wy;function Lu(g,o,u,y){g.emplaceBack(o,u,y)}class bd{constructor(o){this.vertexArray=new a.eg,this.indices=new a.a_,Lu(this.vertexArray,-1,-1,1),Lu(this.vertexArray,1,-1,1),Lu(this.vertexArray,-1,1,1),Lu(this.vertexArray,1,1,1),Lu(this.vertexArray,-1,-1,-1),Lu(this.vertexArray,1,-1,-1),Lu(this.vertexArray,-1,1,-1),Lu(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Xy),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=a.bd.simpleSegment(0,0,36,12)}}function Ql(g,o,u,y,b,T){const C=g.context.gl,I=o.paint.get("sky-atmosphere-color"),L=o.paint.get("sky-atmosphere-halo-color"),F=o.paint.get("sky-atmosphere-sun-intensity"),U=((Y,W,Q,le,oe)=>({u_matrix_3f:Y,u_sun_direction:W,u_sun_intensity:Q,u_color_tint_r:[le.r,le.g,le.b,le.a],u_color_tint_m:[oe.r,oe.g,oe.b,oe.a],u_luminance:5e-5}))(a.ei(a.dJ(),y),b,F,I.toPremultipliedRenderColor(null),L.toPremultipliedRenderColor(null));C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+T,o.skyboxTexture,0),u.draw(g,C.TRIANGLES,Tn.disabled,er.disabled,yr.unblended,Wn.frontCW,U,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const Jt=a.ec([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class wn{constructor(o){const u=new a.ej;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const y=new a.a_;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(u,Jt.members),this.indexBuffer=o.createIndexBuffer(y),this.segments=a.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const wd=a.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class la{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class st{constructor(o){this.colorModeAlphaBlendedWriteRGB=new yr([1,$c,1,$c],a.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new yr([1,0,1,0],a.am.transparent,[!1,!1,!1,!0]),this.params=new la,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(o){const u=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new wn(u);const y=this.params.sizeRange,b=this.params.intensityRange,T=(function(U){const Y=a.el(30),W=[];for(let Q=0;Q<U;++Q){const le=2*Math.PI*Y(),oe=Math.acos(1-2*Y())-.5*Math.PI;W.push(a.d2(Math.cos(oe)*Math.cos(le),Math.cos(oe)*Math.sin(le),Math.sin(oe)))}return W})(this.params.starsCount),C=a.el(300),I=new a.ek,L=new a.a_;let F=0;for(let U=0;U<T.length;++U){const Y=a.c1([],T[U],200),W=Math.max(0,1+.01*y*(1*C()-.5)),Q=Math.max(0,1+.01*b*(1*C()-.5));I.emplaceBack(Y[0],Y[1],Y[2],-1,-1,W,Q),I.emplaceBack(Y[0],Y[1],Y[2],1,-1,W,Q),I.emplaceBack(Y[0],Y[1],Y[2],1,1,W,Q),I.emplaceBack(Y[0],Y[1],Y[2],-1,1,W,Q),L.emplaceBack(F+0,F+1,F+2),L.emplaceBack(F+0,F+2,F+3),F+=4}this.starsVx=u.createVertexBuffer(I,wd.members),this.starsIdx=u.createIndexBuffer(L),this.starsSegments=a.bd.simpleSegment(0,0,I.length,L.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,u){const y=o.context,b=y.gl,T=o.transform,C=new Tn(b.LEQUAL,Tn.ReadOnly,[0,1]),I=a.ah(T.zoom),L=o.style.getLut(u.scope),F=u.properties.get("color-use-theme")==="none",U=u.properties.get("color").toNonPremultipliedRenderColor(F?null:L).toArray01(),Y=u.properties.get("high-color-use-theme")==="none",W=u.properties.get("high-color").toNonPremultipliedRenderColor(Y?null:L).toArray01(),Q=u.properties.get("space-color-use-theme")==="none",le=u.properties.get("space-color").toNonPremultipliedRenderColor(Q?null:L).toArray01(),oe=5e-4,ue=a.em(u.properties.get("horizon-blend"),0,1,oe,.25),de=a.dy(o,y,T)&&ue===oe?T.worldSize/(2*Math.PI*1.025)-1:T.globeRadius,xe=o.frameCounter/1e3%1,Te=a.ae(T.globeCenterInViewSpace),Me=Math.sqrt(Math.pow(Te,2)-Math.pow(de,2)),ke=Math.acos(Me/Te),Fe=Ve=>{const Le=T.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ve&&Le.push("ALPHA_PASS");const Ne=o.getOrCreateProgram("globeAtmosphere",{defines:Le}),je=((Ze,Pt,_t,Lt,rn,ft,We,Tt,mt,It,Nt,Rt)=>({u_frustum_tl:Ze,u_frustum_tr:Pt,u_frustum_br:_t,u_frustum_bl:Lt,u_horizon:rn,u_transition:ft,u_fadeout_range:We,u_color:Tt,u_high_color:mt,u_space_color:It,u_temporal_offset:Nt,u_horizon_angle:Rt}))(T.frustumCorners.TL,T.frustumCorners.TR,T.frustumCorners.BR,T.frustumCorners.BL,T.frustumCorners.horizon,I,ue,U,W,le,xe,ke);o.uploadCommonUniforms(y,Ne);const dt=this.atmosphereBuffer;dt&&Ne.draw(o,b.TRIANGLES,C,er.disabled,Ve?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Wn.backCW,je,Ve?"atmosphere_glow_alpha":"atmosphere_glow",dt.vertexBuffer,dt.indexBuffer,dt.segments)};Fe(!1),Fe(!0)}drawStars(o,u){const y=a.ay(u.properties.get("star-intensity"),0,1);if(y===0)return;const b=o.context,T=b.gl,C=o.transform,I=o.getOrCreateProgram("stars"),L=a.c3([]);a.c5(L,L,-C._pitch),a.c4(L,L,-C.angle),a.c5(L,L,a.al(C._center.lat)),a.en(L,L,-a.al(C._center.lng));const F=a.c8(new Float32Array(16),L),U=a.az([],C.starsProjMatrix,F),Y=a.ei([],F),W=a.eo([],Y),Q=[0,1,0];a.dL(Q,Q,W),a.c1(Q,Q,this.params.sizeMultiplier);const le=[1,0,0];a.dL(le,le,W),a.c1(le,le,this.params.sizeMultiplier);const oe=(ue=Q,de=le,xe=y,{u_matrix:Float32Array.from(U),u_up:ue,u_right:de,u_intensity_multiplier:xe});var ue,de,xe;o.uploadCommonUniforms(b,I),this.starsVx&&this.starsIdx&&I.draw(o,T.TRIANGLES,Tn.disabled,er.disabled,this.colorModeAlphaBlendedWriteRGB,Wn.disabled,oe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Zy{constructor(){this.visibleTiles=[]}updateBorders(o,u){const y=[],b=[],T=o._getRenderableCoordinates(!1,!0);for(const L of T){const F=o.getTile(L);if(!F.hasData())continue;const U=F.getBucket(u);U&&(U.isEmpty()||(y.push(L.key),b.push({bucket:U,tileID:L.canonical})))}let C=y.length!==this.visibleTiles.length;if(!C){y.sort();for(let L=0;L<y.length;L++)if(y[L]!==this.visibleTiles[L]){C=!0;break}}if(!C)return;const I=new Set;this.visibleTiles=y,b.sort(((L,F)=>L.tileID.z-F.tileID.z||L.tileID.x-F.tileID.x||L.tileID.y-F.tileID.y));for(const L of b){const F=new Array,U=new Array,Y=L.bucket;for(const W of Y.featuresOnBorder)I.has(W.featureId)?U.push(W.footprintIndex):(I.add(W.featureId),F.push(W.footprintIndex));Y.updateFootprintHiddenFlags(F,a.ep,!1),Y.updateFootprintHiddenFlags(U,a.ep,!0)}}}function Mf(g,o){const u=[...g],y=o.cameraWorldSizeForFog/o.worldSize,b=a.bx([]);return a.cP(b,b,[y,y,1]),a.az(u,b,u),a.az(u,o.worldToFogMatrix,u),u}function Pf(g,o,u,y,b){const T=u.material,C=y.context,{baseColorTexture:I,metallicRoughnessTexture:L}=T.pbrMetallicRoughness,{normalTexture:F,occlusionTexture:U,emissionTexture:Y}=T;function W(le,oe,ue){if(le&&(g.push(oe),C.activeTexture.set(C.gl.TEXTURE0+ue),le.gfxTexture)){const{minFilter:de,magFilter:xe,wrapS:Te,wrapT:Me}=le.sampler;le.gfxTexture.bindExtraParam(de,xe,Te,Me)}}W(I,"HAS_TEXTURE_u_baseColorTexture",Jo.BaseColor),W(L,"HAS_TEXTURE_u_metallicRoughnessTexture",Jo.MetallicRoughness),W(F,"HAS_TEXTURE_u_normalTexture",Jo.Normal),W(U,"HAS_TEXTURE_u_occlusionTexture",Jo.Occlusion),W(Y,"HAS_TEXTURE_u_emissionTexture",Jo.Emission),b&&(b.texture||(b.texture=new a.et(y.context,b.image,[b.image.height,b.image.height,b.image.height],C.gl.RGBA8)),C.activeTexture.set(C.gl.TEXTURE0+Jo.LUT),b.texture&&b.texture.bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(u.texcoordBuffer)),u.colorBuffer&&(g.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(u.colorBuffer)),u.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(u.normalBuffer)),u.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(u.pbrBuffer)),T.alphaMode!=="OPAQUE"&&T.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),T.defined||g.push("DIFFUSE_SHADED");const Q=y.shadowRenderer;Q&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Q.useNormalOffset&&g.push("NORMAL_OFFSET"))}function Sd(g,o,u,y,b,T){const C=u.paint.get("model-opacity").constantOr(1),I=o.context,L=new Tn(o.context.gl.LEQUAL,Tn.ReadWrite,o.depthRangeFor3D),F=o.transform,U=g.mesh,Y=U.material,W=Y.pbrMetallicRoughness,Q=o.style.fog;let le;le=o.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:a.az([],y.zScaleMatrix,g.nodeModelMatrix),a.az(le,y.negCameraPosMatrix,le);const oe=a.bi([],le);a.ea(oe,oe);const ue=u.paint.get("model-color-use-theme").constantOr("default")==="none",de=u.paint.get("model-emissive-strength").constantOr(0),xe=Up(new Float32Array(g.worldViewProjection),new Float32Array(le),new Float32Array(oe),null,o,C,W.baseColorFactor,Y.emissiveFactor,W.metallicFactor,W.roughnessFactor,Y,de,u),Te={defines:[]},Me=[],ke=o.shadowRenderer;ke&&(ke.useNormalOffset=!1),Pf(Te.defines,Me,U,o,ue?null:u.lut);let Fe=null;if(Q){const Ne=Mf(g.nodeModelMatrix,o.transform);if(Fe=new Float32Array(Ne),F.projection.name!=="globe"){const je=U.aabb.min,dt=U.aabb.max,[Ze,Pt]=Q.getOpacityForBounds(Ne,je[0],je[1],dt[0],dt[1]);Te.overrideFog=Ze>=zt||Pt>=zt}}const Ve=qc(o,u.paint.get("model-cutoff-fade-range"));Ve.shouldRenderCutoff&&Te.defines.push("RENDER_CUTOFF");const Le=o.getOrCreateProgram("model",Te);o.uploadCommonUniforms(I,Le,null,Fe,Ve),o.renderPass!=="shadow"&&ke&&ke.setupShadowsFromMatrix(g.nodeModelMatrix,Le),Le.draw(o,I.gl.TRIANGLES,L,b,T,U.material.doubleSided?Wn.disabled:Wn.backCCW,xe,u.id,U.vertexBuffer,U.indexBuffer,U.segments,u.paint,o.transform.zoom,void 0,Me)}function _g(g,o,u,y,b,T,C){let I;I=g.projection.name==="globe"?a.er(u,g):[...u],a.az(I,I,o.matrix);const L=a.az([],y,I);if(o.meshes)for(const F of o.meshes){if(F.material.alphaMode!=="BLEND"){C.push({mesh:F,depth:0,modelIndex:b,worldViewProjection:L,nodeModelMatrix:I});continue}const U=a.ad([],F.centroid,L);!g.isOrthographic&&U[2]<=0||T.push({mesh:F,depth:U[2],modelIndex:b,worldViewProjection:L,nodeModelMatrix:I})}if(o.children)for(const F of o.children)_g(g,F,u,y,b,T,C)}function Yp(g,o,u,y){const b=u.shadowRenderer;if(!b)return;const T=b.getShadowPassDepthMode(),C=b.getShadowPassColorMode(),I=b.calculateShadowPassMatrixFromMatrix(o),L=Iu(I);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,T,er.disabled,C,Wn.backCCW,L,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,u.transform.zoom,void 0,void 0)}function Ih(g,o,u){const y=o.updateZoomBasedPaintProperties(),b=(function(T,C,I){let L,F,U,Y=T.terrain?T.terrain.exaggeration():0;if(T.terrain&&Y>0){const W=T.terrain,Q=W.findDEMTileFor(I);Q&&Q.dem?L=a.eu.create(W,I,Q):Y=0}if(Y===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),Y===C.validForExaggeration&&(Y===0||L&&L._demTile&&L._demTile.tileID===C.validForDEMTile.id&&L._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const W in C.instancesPerModel){const Q=C.instancesPerModel[W];for(let le=0;le<Q.instancedDataArray.length;++le){const oe=(L?Y*L.getElevationAt(0|Q.instancedDataArray.float32[16*le],0|Q.instancedDataArray.float32[16*le+1],!0,!0):0)+Q.instancesEvaluatedElevation[le];Q.instancedDataArray.float32[16*le+6]=oe,F=F?Math.min(C.terrainElevationMin,oe):oe,U=U?Math.max(C.terrainElevationMax,oe):oe}}return C.terrainElevationMin=F||0,C.terrainElevationMax=U||0,C.validForExaggeration=Y,C.validForDEMTile=L&&L._demTile?{id:L._demTile.tileID,timestamp:L._dem._timestamp}:{id:void 0,timestamp:0},!0})(g,o,u);(y||b)&&(o.uploaded=!1,o.upload(g.context))}const Tc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.d6([0,0,0],[a.aj,a.aj,0])};function gv(g,o){const u=1<<g.canonical.z,y=o.getFreeCameraOptions().position,b=o.elevation,T=g.canonical.x/u,C=(g.canonical.x+1)/u,I=g.canonical.y/u,L=(g.canonical.y+1)/u;let F=o._centerAltitude;if(b){const Q=b.getMinMaxForTile(g);Q&&Q.max>F&&(F=Q.max)}const U=a.ay(y.x,T,C)-y.x,Y=a.ay(y.y,I,L)-y.y,W=a.cb(F,o.center.lat)-y.z;return o._zoomFromMercatorZ(Math.sqrt(U*U+Y*Y+W*W))}function Kp(g,o,u,y,b,T,C){const I=g.context,L=g.renderPass==="shadow",F=g.shadowRenderer,U=L&&F?F.getShadowPassDepthMode():new Tn(I.gl.LEQUAL,Tn.ReadWrite,g.depthRangeFor3D),Y=g.isTileAffectedByFog(T);if(u.meshes)for(const W of u.meshes){const Q=["MODEL_POSITION_ON_GPU"],le=[];let oe,ue,de;y.instancedDataArray.length>20&&Q.push("INSTANCED_ARRAYS");const xe=qc(g,o.paint.get("model-cutoff-fade-range"));if(xe.shouldRenderCutoff&&Q.push("RENDER_CUTOFF"),L&&F)oe=g.getOrCreateProgram("modelDepth",{defines:Q}),ue=Iu(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(u.matrix)),de=F.getShadowPassColorMode();else{Pf(Q,le,W,g,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),oe=g.getOrCreateProgram("model",{defines:Q,overrideFog:Y});const Me=W.material,ke=Me.pbrMetallicRoughness,Fe=o.paint.get("model-opacity").constantOr(1),Ve=o.paint.get("model-emissive-strength").constantOr(0);ue=Up(T.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,g,Fe,ke.baseColorFactor,Me.emissiveFactor,ke.metallicFactor,ke.roughnessFactor,Me,Ve,o,b),F&&(C.shadowUniformsInitialized?oe.setShadowUniformValues(I,F.getShadowUniformValues()):(F.setupShadows(T.toUnwrapped(),oe,"model-tile"),C.shadowUniformsInitialized=!0)),de=xe.shouldRenderCutoff||Fe<1||Me.alphaMode!=="OPAQUE"?yr.alphaBlended:yr.unblended}g.uploadCommonUniforms(I,oe,T.toUnwrapped(),null,xe);const Te=W.material.doubleSided?Wn.disabled:Wn.backCCW;if(y.instancedDataArray.length>20)le.push(y.instancedDataBuffer),oe.draw(g,I.gl.TRIANGLES,U,er.disabled,de,Te,ue,o.id,W.vertexBuffer,W.indexBuffer,W.segments,o.paint,g.transform.zoom,void 0,le,y.instancedDataArray.length);else{const Me=L?"u_instance":"u_normal_matrix";for(let ke=0;ke<y.instancedDataArray.length;++ke)ue[Me]=new Float32Array(y.instancedDataArray.arrayBuffer,64*ke,16),oe.draw(g,I.gl.TRIANGLES,U,er.disabled,de,Te,ue,o.id,W.vertexBuffer,W.indexBuffer,W.segments,o.paint,g.transform.zoom,void 0,le)}}if(u.children)for(const W of u.children)Kp(g,o,W,y,b,T,C)}const Jp=[1,-1,1];function vg(g,o,u,y){if(!u.modelManager)return!0;const b=u.modelManager;if(!u.shadowRenderer)return!0;const T=u.shadowRenderer,C=o.aabb;let I=!0,L=g.maxHeight;if(L===0){let U=0;for(const Y in g.instancesPerModel){const W=b.getModel(Y,y);W?U=Math.max(U,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):I=!1}L=g.maxScale*U*1.41+g.maxVerticalOffset,I&&(g.maxHeight=L)}C.max[2]=L,C.min[2]+=g.terrainElevationMin,C.max[2]+=g.terrainElevationMax,a.ad(C.min,C.min,o.tileMatrix),a.ad(C.max,C.max,o.tileMatrix);const F=C.intersects(T.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=F===2),F===0}function yv(g,o){const u=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],b=g.uniformValues.u_cutoff_params[2],T=g.uniformValues.u_cutoff_params[3];return y===u||T===b?1:a.ay(((o-u)/(y-u)-b)/(T-b),0,1)}function xg(g,o,u,y){if(o.pitch<20)return 1;const b=o.getWorldToCameraMatrix();a.az(b,b,g);const T=a.bR(u.min[0],u.min[1],u.min[2],1);let C=a.aA(a.ev(),T,b),I=C,L=C;T[1]=u.max[1],C=a.aA(a.ev(),T,b),I=C[1]<I[1]?C:I,L=C[1]>L[1]?C:L,T[0]=u.max[0],C=a.aA(a.ev(),T,b),I=C[1]<I[1]?C:I,L=C[1]>L[1]?C:L,T[1]=u.min[1],C=a.aA(a.ev(),T,b),I=C[1]<I[1]?C:I,L=C[1]>L[1]?C:L;const F=a.ay(y[0],0,1),U=100*o.pixelsPerMeter*a.ay(y[1],0,1),Y=a.ay(y[2],0,1),W=a.ew(a.ev(),I,L,F),Q=Math.tan(.5*o.fovX),le=-W[2]*Q;if(U===0)return W[1]<-Math.abs(le)?Y:1;const oe=(-Math.abs(le)-W[1])/U,ue=(xe,Te,Me)=>(1-Me)*xe+Me*Te,de=a.ay(ue(1,Y,oe),Y,1);return ue(1,de,a.ay((o.pitch-20)/20,0,1))}class Qp{}class Of{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,u,y){{const Y=this._storage.get(u.id);if(Y)return Y.lastUsedFrameIdx=o,Y.buf}const b=y.gl,T=b.getBufferParameter(b.ELEMENT_ARRAY_BUFFER,b.BUFFER_SIZE),C=new ArrayBuffer(T),I=new Int16Array(C);b.getBufferSubData(b.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const L=new a.ey;for(let Y=0;Y<T/2;Y+=3){const W=I[Y],Q=I[Y+1],le=I[Y+2];L.emplaceBack(W,Q),L.emplaceBack(Q,le),L.emplaceBack(le,W)}const F=y.bindVertexArrayOES.current,U=new Qp;return U.buf=new Yi(y,L),U.lastUsedFrameIdx=o,this._storage.set(u.id,U),y.bindVertexArrayOES.set(F),U.buf}update(o){for(const[u,y]of this._storage)o-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(u))}destroy(){for(const[o,u]of this._storage)u.buf.destroy(),this._storage.delete(o)}}class Dh{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Yy=a.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class _v{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class vs{constructor(o,u){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const $0=a.ec([{type:"Float32",name:"a_pos_2f",components:2}]);class Rf{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,u){const y=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const C=new a.ez,I=new a.a_;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(1,1),C.emplaceBack(-1,1),I.emplaceBack(0,1,2),I.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(C,$0.members),this.vignetteIdx=o.context.createIndexBuffer(I)}const b=a.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,y);const C={u_vignetteShape:(T={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:T.vignetteColor};y.draw(o,o.context.gl.TRIANGLES,Tn.disabled,er.disabled,yr.alphaBlended,Wn.disabled,C,"vignette",this.vignetteVx,this.vignetteIdx,b)}var T}}class ki{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,u){const y=o.getFreeCameraOptions().position,b=y.toAltitude(),T=y.toLngLat(),C=a.al(T.lng),I=a.al(T.lat),L=o.pixelsPerMeter/u,F=C*a.eB,U=a.eB*Math.log(Math.tan(Math.PI/4+I/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Y=-this._offsetYPrev+U,W=-this._elevationPrev+b;this._accumulatedOffsetX+=(-this._offsetXPrev+F)*L,this._accumulatedOffsetY+=Y*L,this._accumulatedElevation+=W*L,this._offsetXPrev=F,this._offsetYPrev=U,this._elevationPrev=b}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Ur(g,o){return[-(g[0]-Math.floor(g[0]/o)*o),-(g[1]-Math.floor(g[1]/o)*o),-(g[2]-Math.floor(g[2]/o)*o)]}function If(g){const o=a.el(1323123451230),u=[];for(let y=0;y<g;++y){const b=2*o()-1,T=2*o()-1,C=2*o()-1;u.push(a.d2(b,T,C))}return u}function Rs(g,o,u,y,b){const T=a.ay((b-u)/(y-u),0,1);return(1-T)*g+T*o}class Td{constructor(o){this._movement=new ki,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Rf,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,u){const y=o.transform;this._movement.update(y,this._ppmScaleFactor);const b=y.starsProjMatrix,T=a.c3([]);a.c5(T,T,a.al(90)-y._pitch),a.c4(T,T,-y.angle);const C=a.c8(new Float32Array(16),T),I=a.eA(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),L=a.ea([],I),F=a.az([],L,C),U=Date.now()/1e3;return this._accumulatedTimeFromStart+=(U-this._prevTime)*u,this._prevTime=U,{projectionMatrix:b,modelviewMatrix:F}}}class Nu extends Td{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new vs(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const u=o.context;if(!this.particlesVx){const y=If(this.particlesCount),b=new a.eC,T=new a.a_;let C=0;const I=a.el(1323123451230);for(let L=0;L<y.length;++L){const F=y[L],U=[2*I()-1,I(),I(),I()];b.emplaceBack(F[0],F[1],F[2],-1,-1,...U),b.emplaceBack(F[0],F[1],F[2],1,-1,...U),b.emplaceBack(F[0],F[1],F[2],1,1,...U),b.emplaceBack(F[0],F[1],F[2],-1,1,...U),T.emplaceBack(C+0,C+1,C+2),T.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=u.createVertexBuffer(b,Yy.members),this.particlesIdx=u.createIndexBuffer(T)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=o.transform.zoom;if(u.revealStart>y)return;const b=Rs(0,1,u.revealStart,u.revealStart+u.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const T=structuredClone(this._params);let C=[-T.direction.x,T.direction.y,-100];a.au(C,C);const I=structuredClone(this._vignetteParams);I.strength*=b,T.overrideStyleParameters||(T.intensity=o.style.rain.state.density,T.timeFactor=o.style.rain.state.intensity,T.color=structuredClone(o.style.rain.state.color),C=structuredClone(o.style.rain.state.direction),T.screenThinning.intensity=o.style.rain.state.centerThinning,T.dropletSizeX=o.style.rain.state.dropletSize[0],T.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],T.distortionStrength=100*o.style.rain.state.distortionStrength,I.strength=1,I.color=structuredClone(o.style.rain.state.vignetteColor));const L=this.updateOnRender(o,T.timeFactor),F=o.context,U=F.gl,Y=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new a.T(F,{width:o.width,height:o.height,data:null},U.RGBA8)),T.distortionStrength>0&&(F.activeTexture.set(U.TEXTURE0),this.screenTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),U.copyTexSubImage2D(U.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const W=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(F,W),F.activeTexture.set(U.TEXTURE0),this.screenTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const Q=[T.color.r,T.color.g,T.color.b,T.color.a],le=(oe,ue)=>{const de=Ur(this._movement.getPosition(),oe),xe=T.dropletSizeX,Te=T.dropletSizeX*T.dropletSizeYScale,Me=o.width/2,ke=o.height/2,Fe=Rs(0,T.screenThinning.start,0,1,T.screenThinning.intensity),Ve=Rs(.001,T.screenThinning.range,0,1,T.screenThinning.intensity),Le=Rs(0,T.screenThinning.particleOffset,0,1,T.screenThinning.intensity),Ne=(je={modelview:L.modelviewMatrix,projection:L.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:de,velocityConeAperture:T.velocityConeAperture,velocity:T.velocity,boxSize:oe,rainDropletSize:[xe,Te],distortionStrength:T.distortionStrength,rainDirection:C,color:Q,screenSize:[Y.width,Y.height],thinningCenterPos:[Me,ke],thinningShape:[Fe,Ve,Math.pow(10,T.screenThinning.fadePower)],thinningAffectedRatio:T.screenThinning.affectedRatio,thinningParticleOffset:Le,shapeDirectionalPower:T.shapeDirPower,shapeNormalPower:T.shapeNormalPower,mode:ue?0:1},{u_modelview:Float32Array.from(je.modelview),u_projection:Float32Array.from(je.projection),u_time:je.time,u_cam_pos:je.camPos,u_texScreen:0,u_velocityConeAperture:je.velocityConeAperture,u_velocity:je.velocity,u_boxSize:je.boxSize,u_rainDropletSize:je.rainDropletSize,u_distortionStrength:je.distortionStrength,u_rainDirection:je.rainDirection,u_color:je.color,u_screenSize:je.screenSize,u_thinningCenterPos:je.thinningCenterPos,u_thinningShape:je.thinningShape,u_thinningAffectedRatio:je.thinningAffectedRatio,u_thinningParticleOffset:je.thinningParticleOffset,u_shapeDirectionalPower:je.shapeDirectionalPower,u_shapeNormalPower:je.shapeNormalPower,u_mode:je.mode});var je;const dt=Math.round(T.intensity*this.particlesCount),Ze=a.bd.simpleSegment(0,0,4*dt,2*dt);W.draw(o,U.TRIANGLES,Tn.disabled,er.disabled,yr.alphaBlended,Wn.disabled,Ne,"rain_particles",this.particlesVx,this.particlesIdx,Ze)};T.distortionStrength>0&&le(T.boxSize,!0),le(T.boxSize,!1),this._vignette.draw(o,I)}}const kh=a.ec([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class bg extends Td{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new vs(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const u=o.context;if(!this.particlesVx){const y=If(this.particlesCount),b=new a.eD,T=new a.a_;let C=0;const I=a.el(1323123451230);for(let L=0;L<y.length;++L){const F=y[L],U=I(),Y=I(),W=I(),Q=[L/y.length,U,Y,W],le=[I(),I()];b.emplaceBack(F[0],F[1],F[2],-1,-1,...Q,...le),b.emplaceBack(F[0],F[1],F[2],1,-1,...Q,...le),b.emplaceBack(F[0],F[1],F[2],1,1,...Q,...le),b.emplaceBack(F[0],F[1],F[2],-1,1,...Q,...le),T.emplaceBack(C+0,C+1,C+2),T.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=u.createVertexBuffer(b,kh.members),this.particlesIdx=u.createIndexBuffer(T)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const u=structuredClone(this._params);let y=[-u.direction.x,u.direction.y,-100];a.au(y,y);const b=structuredClone(this._vignetteParams),T=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},C=o.transform.zoom;if(T.revealStart>C)return;const I=Rs(0,1,T.revealStart,T.revealStart+T.revealRange,C);b.strength*=I,u.overrideStyleParameters||(u.intensity=o.style.snow.state.density,u.timeFactor=o.style.snow.state.intensity,u.color=structuredClone(o.style.snow.state.color),y=structuredClone(o.style.snow.state.direction),u.screenThinning.intensity=o.style.snow.state.centerThinning,u.billboardSize=2.79*o.style.snow.state.flakeSize,b.strength=1,b.color=structuredClone(o.style.snow.state.vignetteColor));const L=this.updateOnRender(o,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const F=o.context,U=F.gl,Y=o.transform,W=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(F,W),((Q,le,oe)=>{const ue=Ur(this._movement.getPosition(),Q),de=Y.width/2,xe=Y.height/2,Te=Rs(0,oe.screenThinning.start,0,1,oe.screenThinning.intensity),Me=Rs(.001,oe.screenThinning.range,0,1,oe.screenThinning.intensity),ke=Rs(0,oe.screenThinning.particleOffset,0,1,oe.screenThinning.intensity),Fe=(Ve={modelview:L.modelviewMatrix,projection:L.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ue,velocityConeAperture:oe.velocityConeAperture,velocity:oe.velocity,horizontalOscillationRadius:oe.horizontalOscillationRadius,horizontalOscillationRate:oe.horizontalOscillationRate,boxSize:Q,billboardSize:1*oe.billboardSize,simpleShapeParameters:[oe.shapeFadeStart,oe.shapeFadePower],screenSize:[Y.width,Y.height],thinningCenterPos:[de,xe],thinningShape:[Te,Me,Math.pow(10,oe.screenThinning.fadePower)],thinningAffectedRatio:oe.screenThinning.affectedRatio,thinningParticleOffset:ke,color:[oe.color.r,oe.color.g,oe.color.b,oe.color.a],direction:y},{u_modelview:Float32Array.from(Ve.modelview),u_projection:Float32Array.from(Ve.projection),u_time:Ve.time,u_cam_pos:Ve.camPos,u_velocityConeAperture:Ve.velocityConeAperture,u_velocity:Ve.velocity,u_horizontalOscillationRadius:Ve.horizontalOscillationRadius,u_horizontalOscillationRate:Ve.horizontalOscillationRate,u_boxSize:Ve.boxSize,u_billboardSize:Ve.billboardSize,u_simpleShapeParameters:Ve.simpleShapeParameters,u_screenSize:Ve.screenSize,u_thinningCenterPos:Ve.thinningCenterPos,u_thinningShape:Ve.thinningShape,u_thinningAffectedRatio:Ve.thinningAffectedRatio,u_thinningParticleOffset:Ve.thinningParticleOffset,u_particleColor:Ve.color,u_direction:Ve.direction});var Ve;const Le=Math.round(oe.intensity*this.particlesCount),Ne=a.bd.simpleSegment(0,0,4*Le,2*Le);this.particlesVx&&this.particlesIdx&&W.draw(o,U.TRIANGLES,Tn.disabled,er.disabled,yr.alphaBlended,Wn.disabled,Fe,"snow_particles",this.particlesVx,this.particlesIdx,Ne)})(u.boxSize,0,u),this._vignette.draw(o,b)}}const Ky={symbol:function(g,o,u,y,b){if(g.renderPass!=="translucent")return;const T=er.disabled,C=g.colorModeForRenderPass(),I=u.layout.get("text-variable-anchor"),L=u.layout.get("text-size-scale-range"),F=a.ay(g.scaleFactor,L[0],L[1]);I&&(function(W,Q,le,oe,ue,de,xe,Te){const Me=Q.transform,ke=ue==="map",Fe=de==="map";for(const Ve of W){const Le=oe.getTile(Ve),Ne=Le.getBucket(le);if(!Ne||!Ne.text||!Ne.text.segments.get().length)continue;const je=a.bH(Ne.textSizeData,Me.zoom,Te),dt=mu(Ve,Ne.getProjection(),Me),Ze=Me.calculatePixelsToTileUnitsMatrix(Le),Pt=ad(dt,Le.tileID.canonical,Fe,ke,Me,Ne.getProjection(),Ze),_t=Ne.hasIconTextFit()&&Ne.hasIconData();je&&pg(Ne,ke,Fe,xe,Me,Pt,Ve,Math.pow(2,Me.zoom-Le.tileID.overscaledZ),je,_t)}})(y,g,u,o,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),b,F);const U=u.paint.get("icon-opacity").constantOr(1)!==0,Y=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(U||Y)?qp(g,o,u,y,T,C):(U&&qp(g,o,u,y,T,C,{onlyIcons:!0}),Y&&qp(g,o,u,y,T,C,{onlyText:!0})),o.map.showCollisionBoxes&&(_d(g,o,u,y,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),_d(g,o,u,y,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,u,y){if(g.renderPass!=="translucent")return;const b=u.paint.get("circle-opacity"),T=u.paint.get("circle-stroke-width"),C=u.paint.get("circle-stroke-opacity"),I=u.layout.get("circle-sort-key").constantOr(1)!==void 0,L=u.paint.get("circle-emissive-strength");if(b.constantOr(1)===0&&(T.constantOr(1)===0||C.constantOr(1)===0))return;const F=g.context,U=F.gl,Y=g.transform,W=!(!g.terrain||!g.terrain.enabled),Q=u.layout.get("circle-elevation-reference"),le=g.depthModeForSublayer(0,Tn.ReadOnly),oe=new Tn(g.context.gl.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D),ue=Q==="none"||W?le:oe,de=er.disabled,xe=g.colorModeForDrapableLayerRenderPass(L),Te=Y.projection.name==="globe",Me=[a.aD(Y.center.lng),a.aH(Y.center.lat)],ke=[];for(let Ve=0;Ve<y.length;Ve++){const Le=y[Ve],Ne=o.getTile(Le),je=Ne.getBucket(u);if(!je||je.projection.name!==Y.projection.name)continue;const dt=je.programConfigurations.get(u.id),Ze=je.layoutVertexBuffer,Pt=je.globeExtVertexBuffer,_t=je.indexBuffer,Lt=a.dW(u),rn=[Pt],ft=g.isTileAffectedByFog(Le);Te&&Lt.push("PROJECTION_GLOBE_VIEW"),Lt.push("DEPTH_D24"),g.terrain&&Y.depthOcclusionForSymbolsAndCircles&&Lt.push("DEPTH_OCCLUSION"),je.hasElevation&&!g.terrain&&(Lt.push("ELEVATED_ROADS"),rn.push(je.elevatedLayoutVertexBuffer));const We=g.getOrCreateProgram("circle",{config:dt,defines:Lt,overrideFog:ft}),Tt=Y.projection.createInversionMatrix(Y,Le.canonical),mt={programConfiguration:dt,program:We,layoutVertexBuffer:Ze,dynamicBuffers:rn,indexBuffer:_t,uniformValues:a.dX(g,Le,Ne,Tt,Me,u),tile:Ne};if(I){const It=je.segments.get();for(const Nt of It)ke.push({segments:new a.bd([Nt]),sortKey:Nt.sortKey,state:mt})}else ke.push({segments:je.segments,sortKey:0,state:mt})}I&&ke.sort(((Ve,Le)=>Ve.sortKey-Le.sortKey));const Fe={useDepthForOcclusion:Y.depthOcclusionForSymbolsAndCircles};for(const Ve of ke){const{programConfiguration:Le,program:Ne,layoutVertexBuffer:je,dynamicBuffers:dt,indexBuffer:Ze,uniformValues:Pt,tile:_t}=Ve.state,Lt=Ve.segments;g.terrain&&g.terrain.setupElevationDraw(_t,Ne,Fe),g.uploadCommonUniforms(F,Ne,_t.tileID.toUnwrapped()),Ne.draw(g,U.TRIANGLES,ue,de,xe,Wn.disabled,Pt,u.id,je,Ze,Lt,u.paint,Y.zoom,Le,dt)}},heatmap:function(g,o,u,y){if(u.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const b=g.context,T=b.gl,C=er.disabled,I=new yr([T.ONE,T.ONE,T.ONE,T.ONE],a.am.transparent,[!0,!0,!0,!0]);(function(Q,le,oe,ue){const de=Q.gl,xe=le.width*ue,Te=le.height*ue;Q.activeTexture.set(de.TEXTURE1),Q.viewport.set([0,0,xe,Te]);let Me=oe.heatmapFbo;if(!Me||Me&&(Me.width!==xe||Me.height!==Te)){Me&&Me.destroy();const ke=de.createTexture();de.bindTexture(de.TEXTURE_2D,ke),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_2D,de.TEXTURE_MAG_FILTER,de.LINEAR),Me=oe.heatmapFbo=Q.createFramebuffer(xe,Te,!0,null),(function(Fe,Ve,Le,Ne,je,dt){const Ze=Fe.gl;Ze.texImage2D(Ze.TEXTURE_2D,0,Fe.extRenderToTextureHalfFloat?Ze.RGBA16F:Ze.RGBA,je,dt,0,Ze.RGBA,Fe.extRenderToTextureHalfFloat?Ze.HALF_FLOAT:Ze.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Le)})(Q,0,ke,Me,xe,Te)}else de.bindTexture(de.TEXTURE_2D,Me.colorAttachment.get()),Q.bindFramebuffer.set(Me.framebuffer)})(b,g,u,g.transform.projection.name==="globe"?.5:.25),b.clear({color:a.am.transparent});const L=g.transform,F=L.projection.name==="globe",U=F?["PROJECTION_GLOBE_VIEW"]:[],Y=F?Wn.frontCCW:Wn.disabled,W=[a.aD(L.center.lng),a.aH(L.center.lat)];for(let Q=0;Q<y.length;Q++){const le=y[Q];if(o.hasRenderableParent(le))continue;const oe=o.getTile(le),ue=oe.getBucket(u);if(!ue||ue.projection.name!==L.projection.name)continue;const de=g.isTileAffectedByFog(le),xe=ue.programConfigurations.get(u.id),Te=g.getOrCreateProgram("heatmap",{config:xe,defines:U,overrideFog:de}),{zoom:Me}=g.transform;g.terrain&&g.terrain.setupElevationDraw(oe,Te),g.uploadCommonUniforms(b,Te,le.toUnwrapped());const ke=L.projection.createInversionMatrix(L,le.canonical);Te.draw(g,T.TRIANGLES,Tn.disabled,C,I,Y,dg(g,le,oe,ke,W,Me,u.paint.get("heatmap-intensity")),u.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,u.paint,g.transform.zoom,xe,F?[ue.globeExtVertexBuffer]:null)}b.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),(function(b,T){const C=b.context,I=C.gl,L=T.heatmapFbo;if(!L)return;C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,L.colorAttachment.get()),C.activeTexture.set(I.TEXTURE1);let F=T.colorRampTexture;F||(F=T.colorRampTexture=new a.T(C,T.colorRamp,I.RGBA8)),F.bind(I.LINEAR,I.CLAMP_TO_EDGE),b.getOrCreateProgram("heatmapTexture").draw(b,I.TRIANGLES,Tn.disabled,er.disabled,b.colorModeForRenderPass(),Wn.disabled,((U,Y,W,Q)=>({u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}))(0,T),T.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,T.paint,b.transform.zoom)})(g,u))},line:function(g,o,u,y){if(g.renderPass!=="translucent")return;const b=u.paint.get("line-opacity"),T=u.paint.get("line-width");if(b.constantOr(1)===0||T.constantOr(1)===0)return;const C=u.paint.get("line-emissive-strength"),I=u.paint.get("line-occlusion-opacity"),L=u.layout.get("line-elevation-reference"),F=u.layout.get("line-width-unit")==="meters",U=L==="sea",Y=!(!g.terrain||!g.terrain.enabled),W=g.context,Q=W.gl;if(u.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const le=u.layout.get("line-cross-slope"),oe=le!==void 0,ue=le<1,de=g.colorModeForDrapableLayerRenderPass(C),xe=g.terrain&&g.terrain.renderingToTexture,Te=xe?1:a.q.devicePixelRatio,Me=u.paint.get("line-dasharray"),ke=Me.constantOr(1),Fe=u.layout.get("line-cap"),Ve=Me.constantOr(null),Le=Fe.constantOr(null),Ne=u.paint.get("line-pattern"),je=Ne.constantOr(1),dt=u.paint.get("line-pattern-cross-fade"),Ze=Ne.constantOr(null),Pt=u.paint.get("line-opacity").constantOr(1);let _t=!je&&Pt!==1||g.depthOcclusion&&I>0&&I<1;const Lt=u.paint.get("line-gradient"),rn=je?"linePattern":"line",ft=a.dY(u);let We;if(xe&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(_t=!1),I!==0&&g.depthOcclusion){const Nt=u.paint._values["line-opacity"];Nt&&Nt.value&&Nt.value.kind==="constant"?We=Nt.value:a.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}T.value.kind!=="constant"&&T.value.isLineProgressConstant===!1&&ft.push("VARIABLE_LINE_WIDTH");const Tt=(Nt,Rt,Ft,gn,Dn,xn)=>{for(const zn of Nt){const Bn=o.getTile(zn);if(je&&!Bn.patternsLoaded())continue;const Kn=Bn.getBucket(u);if(!Kn||Kn.elevationType!=="none"&&!Dn||Kn.elevationType==="none"&&Dn)continue;g.prepareDrawTile();const Zn=[...Rt],pr=g.shadowRenderer,$r=Kn.elevationType==="road"&&!!pr&&pr.enabled;let sr=[0,0,0];if($r){const qr=g.style.directionalLight,ti=g.style.ambientLight;qr&&ti&&(sr=gh(g.style,qr,ti)),Zn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const kr=Kn.programConfigurations.get(u.id);let Yr=!1;if(Ze&&Bn.imageAtlas){const qr=a.dZ.from(Ze),ti=qr.getPrimary().scaleSelf(Te).toString(),Ai=Bn.imageAtlas.patternPositions.get(ti),Ca=qr.getSecondary(),Ma=Ca?Bn.imageAtlas.patternPositions.get(Ca.scaleSelf(Te).toString()):null;Yr=!!Ai&&!!Ma,Ai&&kr.setConstantPatternPositions(Ai,Ma)}dt>0&&(Yr||kr.getPatternTransitionVertexBuffer("line-pattern"))&&Zn.push("LINE_PATTERN_TRANSITION");const wi=g.isTileAffectedByFog(zn),lr=g.getOrCreateProgram(rn,{config:kr,defines:Zn,overrideFog:wi});if(!je&&Ve&&Le&&Bn.lineAtlas){const qr=Bn.lineAtlas.getDash(Ve,Le);qr&&kr.setConstantPatternPositions(qr)}$r&&pr.setupShadows(Bn.tileID.toUnwrapped(),lr,"vector-tile");let[ei,ri]=u.paint.get("line-trim-offset");(Le==="round"||Le==="square")&&ei!==ri&&(ei===0&&(ei-=1),ri===1&&(ri+=1));const ai=xe?zn.projMatrix:null,br=F?1/Kn.tileToMeter/a.aw(Bn,1,g.transform.zoom):1,oi=F?1/Kn.tileToMeter/a.aw(Bn,1,Math.floor(g.transform.zoom)):1,Tr=je?a.d_(g,Bn,u,ai,Te,br,oi,[ei,ri],sr,dt):a.d$(g,Bn,u,ai,Kn.lineClipsArray.length,Te,br,oi,[ei,ri],sr);if(Lt){const qr=Kn.gradients[u.id];let ti=qr.texture;if(u.gradientVersion!==qr.version){let Ai=256;if(u.stepInterpolant){const Ca=o.getSource().maxzoom,Ma=zn.canonical.z===Ca?Math.ceil(1<<g.transform.maxZoom-zn.canonical.z):1;Ai=a.ay(a.e0(Kn.maxLineLength/a.aj*1024*Ma),256,W.maxTextureSize)}qr.gradient=a.e1({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Ai,image:qr.gradient||void 0,clips:Kn.lineClipsArray}),qr.texture?qr.texture.update(qr.gradient):qr.texture=new a.T(W,qr.gradient,Q.RGBA8),qr.version=u.gradientVersion,ti=qr.texture}W.activeTexture.set(Q.TEXTURE1),ti.bind(u.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}ke&&(W.activeTexture.set(Q.TEXTURE0),Bn.lineAtlasTexture&&Bn.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),kr.updatePaintBuffers()),je&&(W.activeTexture.set(Q.TEXTURE0),Bn.imageAtlasTexture&&Bn.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),kr.updatePaintBuffers()),Dn&&!U&&g.terrain.setupElevationDraw(Bn,lr),g.uploadCommonUniforms(W,lr,zn.toUnwrapped());const Li=qr=>{We!=null&&(We.value=Pt*I),lr.draw(g,Q.TRIANGLES,Ft,qr,de,Wn.disabled,Tr,u.id,Kn.layoutVertexBuffer,Kn.indexBuffer,Kn.segments,u.paint,g.transform.zoom,kr,[Kn.layoutVertexBuffer2,Kn.patternVertexBuffer,Kn.zOffsetVertexBuffer]),We!=null&&(We.value=Pt)};if(_t&&!Dn){const qr=g.stencilModeForClipping(zn).ref;qr===0&&xe&&W.clear({stencil:0});const ti={func:Q.EQUAL,mask:255};Tr.u_alpha_discard_threshold=.8,Li(new er(ti,qr,255,Q.KEEP,Q.KEEP,Q.INVERT)),Tr.u_alpha_discard_threshold=0,Li(new er(ti,qr,255,Q.KEEP,Q.KEEP,Q.KEEP))}else Tr.u_alpha_discard_threshold=_t&&Dn&&xn?.8:0,Li(Dn?gn:g.stencilModeForClipping(zn))}};let mt=g.depthModeForSublayer(0,Tn.ReadOnly);const It=new Tn(g.depthOcclusion?Q.GREATER:Q.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D);if(u.hasNonElevatedBuckets){const Nt=!xe&&g.terrain;I!==0&&Nt?a.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):Nt?a.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):Tt(y,ft,mt,er.disabled,!1,!0)}if(u.hasElevatedBuckets){L==="hd-road-markup"?Y||(mt=It,ft.push("ELEVATED_ROADS")):(ft.push("ELEVATED"),mt=It,oe&&ft.push(ue?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),U&&ft.push("ELEVATION_REFERENCE_SEA"));const Nt=_t?g.stencilModeFor3D():er.disabled;g.forceTerrainMode=!0,Tt(y,ft,mt,Nt,!0,!0),_t&&Tt(y,ft,mt,Nt,!0,!1),g.forceTerrainMode=!1}_t&&(g.resetStencilClippingMasks(),xe&&W.clear({stencil:0})),I===0||g.depthOcclusion||xe||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,o,u,y){const b=u.paint.get("fill-color"),T=u.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const C=u.paint.get("fill-emissive-strength"),I=g.colorModeForDrapableLayerRenderPass(C),L=u.paint.get("fill-pattern"),F=g.opaquePassEnabledForLayer()&&!L.constantOr(1)&&b.constantOr(a.am.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";let U="none";u.layout.get("fill-elevation-reference")!=="none"?U="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(U="offset");const Y=!(!g.terrain||!g.terrain.enabled),W={painter:g,sourceCache:o,layer:u,coords:y,colorMode:I,elevationType:U,terrainEnabled:Y,pass:F};if(g.renderPass!=="shadow")if(U!=="offset"){if(Tf(W,!1),U==="road"){const Q=!Y&&g.renderPass==="translucent";Q&&Rn(g,o,u,y,"geometry"),Tf(W,!0,er.disabled),Q&&(function(le){const{painter:oe,sourceCache:ue,layer:de,coords:xe,colorMode:Te}=le,Me=oe.context.gl,ke=le.painter.shadowRenderer,Fe=!!ke&&ke.enabled,Ve=new Tn(oe.context.gl.LEQUAL,Tn.ReadOnly,oe.depthRangeFor3D);let Le=[0,0,0];if(Fe){const je=oe.style.directionalLight,dt=oe.style.ambientLight;je&&dt&&(Le=gh(oe.style,je,dt))}const Ne=je=>{for(const dt of xe){const Ze=ue.getTile(dt),Pt=Ze.getBucket(de);if(!Pt)continue;const _t=Pt.elevatedStructures;if(!_t)continue;let Lt,rn;if(je?(Lt=_t.renderableBridgeSegments,rn=_t.bridgeProgramConfigurations.get(de.id)):(Lt=_t.renderableTunnelSegments,rn=_t.tunnelProgramConfigurations.get(de.id)),!Lt||Lt.segments[0].primitiveLength===0)continue;rn.updatePaintBuffers(),oe.prepareDrawTile();const ft=oe.isTileAffectedByFog(dt),We=[];Fe&&We.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Tt=oe.getOrCreateProgram("elevatedStructures",{config:rn,overrideFog:ft,defines:We}),mt=oe.translatePosMatrix(dt.projMatrix,Ze,de.paint.get("fill-translate"),de.paint.get("fill-translate-anchor"));Fe&&ke.setupShadows(Ze.tileID.toUnwrapped(),Tt,"vector-tile");const It=pv(mt,Le);oe.uploadCommonUniforms(oe.context,Tt,dt.toUnwrapped()),Tt.draw(oe,Me.TRIANGLES,Ve,er.disabled,Te,Wn.backCCW,It,de.id,_t.vertexBuffer,_t.indexBuffer,Lt,de.paint,oe.transform.zoom,rn,[_t.vertexBufferNormal])}};Ne(!0),Ne(!1)})(W)}}else Tf(W,!1,g.stencilModeFor3D());else g.shadowRenderer&&U==="road"&&!Y&&(function(Q){const{painter:le,sourceCache:oe,layer:ue,coords:de}=Q,xe=le.context.gl,Te=Q.painter.shadowRenderer;for(const Me of de){const ke=oe.getTile(Me),Fe=ke.getBucket(ue);if(!Fe)continue;const Ve=Fe.elevatedStructures;if(!Ve||!Ve.shadowCasterSegments||Ve.shadowCasterSegments.segments[0].primitiveLength===0)continue;le.prepareDrawTile();const Le=Fe.bufferData.programConfigurations.get(ue.id),Ne=le.isTileAffectedByFog(Me),je=le.getOrCreateProgram("elevatedStructuresDepth",{config:Le,overrideFog:Ne}),dt=Te.calculateShadowPassMatrixFromTile(ke.tileID.toUnwrapped());le.uploadCommonUniforms(le.context,je,Me.toUnwrapped());const Ze={u_matrix:dt,u_depth_bias:0};je.draw(le,xe.TRIANGLES,Te.getShadowPassDepthMode(),er.disabled,Te.getShadowPassColorMode(),Wn.disabled,Ze,ue.id,Ve.vertexBuffer,Ve.indexBuffer,Ve.shadowCasterSegments,ue.paint,le.transform.zoom,Le)}})(W)},"fill-extrusion":function(g,o,u,y){const b=u.paint.get("fill-extrusion-opacity"),T=g.context,C=T.gl,I=g.terrain,L=I&&I.renderingToTexture;if(b===0)return;const F=g.conflationActive&&g.style.isLayerClipped(u,o.getSource()),U=g.style.order.indexOf(u.fqid);if(F&&(function(Y,W,Q,le,oe){for(const ue of le){const de=W.getTile(ue).getBucket(Q);de&&(de.updateReplacement(ue,Y.replacementSource,oe),de.uploadCentroid(Y.context))}})(g,o,u,y,U),I||F)for(const Y of y){const W=o.getTile(Y).getBucket(u);W&&jn(g.context,o,Y,W,u,I,F)}if(g.renderPass==="shadow"&&g.shadowRenderer){const Y=g.shadowRenderer;if(I&&b<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.ab)return;const W=Y.getShadowPassDepthMode(),Q=Y.getShadowPassColorMode();vd(g,o,u,y,W,er.disabled,Q,F)}else if(g.renderPass==="translucent"){const Y=!u.paint.get("fill-extrusion-pattern").constantOr(1),W=u.paint.get("fill-extrusion-color").constantOr(a.am.white);if(!L&&W.a!==0){const Q=new Tn(g.context.gl.LEQUAL,Tn.ReadWrite,g.depthRangeFor3D);b===1&&Y?vd(g,o,u,y,Q,er.disabled,yr.unblended,F):(vd(g,o,u,y,Q,er.disabled,yr.disabled,F),vd(g,o,u,y,Q,g.stencilModeFor3D(),g.colorModeForRenderPass(),F),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&Y&&(!I&&g.transform.projection.name!=="globe"||L)){const Q=u.paint.get("fill-extrusion-opacity"),le=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),oe=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ue=u.paint.get("fill-extrusion-flood-light-intensity"),de=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",xe=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(de?null:u.lut).toArray01().slice(0,3),Te=le>0&&oe>0,Me=ue>0,ke=(Le,Ne,je)=>(1-je)*Le+je*Ne,Fe=new wc;Fe.translate=u.paint.get("fill-extrusion-translate"),Fe.translateAnchor=u.paint.get("fill-extrusion-translate-anchor"),Fe.edgeRadius=u.layout.get("fill-extrusion-edge-radius"),Fe.cutoffFadeRange=u.paint.get("fill-extrusion-cutoff-fade-range");const Ve=Le=>{const Ne=g.depthModeForSublayer(1,Tn.ReadOnly,C.LEQUAL,!0),je=u.paint.get(Le?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),dt=ke(.1,3,je),Ze=g._showOverdrawInspector;if(!Ze){const Pt=new er({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),_t=new yr([C.ONE,C.ONE,C.ONE,C.ONE],a.am.transparent,[!1,!1,!1,!0],C.MIN);ka(Fe,g,o,u,y,Ne,Pt,_t,Wn.disabled,Le,"sdf",Q,le,oe,ue,xe,dt,F,!1)}{const Pt=Ze?er.disabled:new er({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),_t=Ze?g.colorModeForRenderPass():new yr([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],a.am.transparent,[!0,!0,!0,!0]);ka(Fe,g,o,u,y,Ne,Pt,_t,Wn.disabled,Le,"color",Q,le,oe,ue,xe,dt,F,!1)}};if(L){const Le=(Ne,je,dt)=>{const Ze=g.depthModeForSublayer(1,Tn.ReadOnly,C.LEQUAL,!1),Pt=u.paint.get(Ne?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),_t=ke(.1,3,Pt);{const Lt=new yr([C.ONE,C.ONE,C.ONE,C.ONE],a.am.transparent,[!1,!1,!1,!0]);ka(Fe,g,o,u,y,Ze,er.disabled,Lt,Wn.disabled,Ne,"clear",Q,le,oe,ue,xe,_t,F,je)}{const Lt=new er({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),rn=new yr([C.ONE,C.ONE,C.ONE,C.ONE],a.am.transparent,[!1,!1,!1,!0],C.MIN);ka(Fe,g,o,u,y,Ze,Lt,rn,Wn.disabled,Ne,"sdf",Q,le,oe,ue,xe,_t,F,je)}{const Lt=Ne?C.ZERO:C.ONE_MINUS_DST_ALPHA,rn=new er({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),ft=new yr([Lt,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],a.am.transparent,[!0,!0,!0,!0]);ka(Fe,g,o,u,y,Ze,rn,ft,Wn.disabled,Ne,"color",Q,le,oe,ue,xe,_t,F,je)}{const Lt=new yr([C.ONE,C.ONE,C.ONE,Ne?C.ZERO:C.ONE],a.am.transparent,[!1,!1,!1,!0],Ne?C.FUNC_ADD:C.MAX);ka(Fe,g,o,u,y,Ze,er.disabled,Lt,Wn.disabled,Ne,"clear",Q,le,oe,ue,xe,_t,F,je,dt)}};if(Te||Me){let Ne;if(g.prepareDrawTile(),I){const je=I.drapeBufferSize[0],dt=I.drapeBufferSize[1];Ne=I.framebufferCopyTexture,Ne&&(!Ne||Ne.size[0]===je&&Ne.size[1]===dt)||(Ne&&Ne.destroy(),Ne=I.framebufferCopyTexture=new a.T(T,new a.r({width:je,height:dt}),C.RGBA8)),Ne.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,je,dt)}Te&&Le(!0,!1,Ne),Me&&Le(!1,!0,Ne)}}else Te&&Ve(!0),Me&&Ve(!1),(Te||Me)&&g.resetStencilClippingMasks()}}},building:function(g,o,u,y){g.currentLayer<g.firstLightBeamLayer&&(g.firstLightBeamLayer=g.currentLayer);const b=u.paint.get("building-ambient-occlusion-ground-intensity"),T=u.paint.get("building-ambient-occlusion-ground-radius"),C=u.paint.get("building-ambient-occlusion-ground-attenuation");let I=b>0&&T>0,L=!0;const F=u.paint.get("building-vertical-scale");F<1&&(L=!1);const U=g.conflationActive&&g.style.isLayerClipped(u,o.getSource()),Y=g.style.order.indexOf(u.fqid);if((function(W,Q,le,oe,ue,de){for(const xe of de){const Te=Q.getTile(xe).getBucket(le);Te&&(ue&&Te.updateReplacement(xe,W.replacementSource,oe),Te.uploadUpdatedIndexBuffer(W.context))}})(g,o,u,Y,U,y),(function(W,Q,le,oe){for(const ue of oe){const de=Q.getTile(ue).getBucket(le);de&&de.needsEvaluation(W,le)&&(de.evaluate(le),de.uploadUpdatedColorBuffer(W.context))}})(g,o,u,y),u.resetLayerRenderingStats(g),g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0),g.renderPass==="shadow"&&g.shadowRenderer){const W=g.shadowRenderer,Q=[],le=W.getShadowPassDepthMode();Jl({painter:g,source:o,layer:u,coords:y,defines:Q,blendMode:W.getShadowPassColorMode(),depthMode:le,verticalScale:F})}else if(g.renderPass==="translucent"){I&&(function(oe,ue,de,xe,Te,Me,ke,Fe,Ve,Le,Ne,je,dt){const Ze=oe.context.gl,Pt=oe.depthModeForSublayer(1,Tn.ReadOnly,Ze.LEQUAL,!0),_t=.1*(1-(Lt=Ne))+3*Lt;var Lt;const rn=oe._showOverdrawInspector,ft=je,We=new wc;rn||ka(We,oe,ue,de,xe,Pt,new er({func:Ze.ALWAYS,mask:255},255,255,Ze.KEEP,Ze.KEEP,Ze.REPLACE),new yr([Ze.ONE,Ze.ONE,Ze.ONE,Ze.ONE],a.am.transparent,[!1,!1,!1,!0],Ze.MIN),Wn.disabled,Te,"sdf",1,ke,Fe,0,Le,_t,ft,!1);{const Tt=rn?er.disabled:new er({func:Ze.EQUAL,mask:255},255,255,Ze.KEEP,Ze.DECR,Ze.DECR),mt=rn?oe.colorModeForRenderPass():new yr([Ze.ONE_MINUS_DST_ALPHA,Ze.DST_ALPHA,Ze.ONE,Ze.ONE],a.am.transparent,[!0,!0,!0,!0]);ka(We,oe,ue,de,xe,Pt,Tt,mt,Wn.disabled,Te,"color",1,ke,Fe,0,Le,_t,ft,!1)}})(g,o,u,y,!0,0,b,T,0,[0,0,0],C,U);let W=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];L&&(W=W.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),g.shadowRenderer.useNormalOffset&&(W=W.concat("NORMAL_OFFSET"));const Q=new Tn(g.context.gl.LEQUAL,Tn.ReadWrite,g.depthRangeFor3D),le=g.colorModeForRenderPass();Jl({painter:g,source:o,layer:u,coords:y,defines:W,blendMode:le,depthMode:Q,verticalScale:F})}else if(g.renderPass==="light-beam"){const W=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],Q=new Tn(g.context.gl.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D);Jl({painter:g,source:o,layer:u,coords:y,defines:W,blendMode:yr.alphaBlended,depthMode:Q,verticalScale:F})}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1),g.resetStencilClippingMasks()},hillshade:function(g,o,u,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const b=g.context,T=g.terrain&&g.terrain.renderingToTexture,[C,I]=g.renderPass!=="translucent"||T?[{},y]:g.stencilConfigForOverlap(y);for(const L of I){const F=o.getTile(L);if(F.needsHillshadePrepare&&g.renderPass==="offscreen")Rp(g,F,u);else if(g.renderPass==="translucent"){const U=g.depthModeForSublayer(0,Tn.ReadOnly),Y=u.paint.get("hillshade-emissive-strength"),W=g.colorModeForDrapableLayerRenderPass(Y),Q=T&&g.terrain?g.terrain.stencilModeForRTTOverlap(L):C[L.overscaledZ];Su(g,L,F,u,U,Q,W)}}b.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,u,y,b,T){if(g.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const C=g.transform.projection.name==="globe",I=u.paint.get("raster-elevation")!==0,L=I&&C;if(g.renderElevatedRasterBackface&&!L)return;const F=g.context,U=F.gl,Y=o.getSource(),W=(function(Fe,Ve,Le,Ne){const je=Ve.paint.get("raster-color"),dt=Fe.type==="raster-array",Ze=[],Pt=Ve.paint.get("raster-resampling"),_t=Ve.paint.get("raster-color-mix");let Lt=Ve.paint.get("raster-color-range");const rn=[_t[0],_t[1],_t[2],0],ft=_t[3];let We=Pt==="nearest"?Ne.NEAREST:Ne.LINEAR;if(dt&&(Ze.push("RASTER_ARRAY"),je||Ze.push("RASTER_COLOR"),Pt==="linear"&&Ze.push("RASTER_ARRAY_LINEAR"),We=Ne.NEAREST,!Lt&&Fe.rasterLayers)){const Tt=Fe.rasterLayers.find((({id:mt})=>mt===Ve.sourceLayer));Tt&&Tt.fields&&Tt.fields.range&&(Lt=Tt.fields.range)}if(Lt=Lt||[0,1],je){Ze.push("RASTER_COLOR"),Le.activeTexture.set(Ne.TEXTURE2),Ve.updateColorRamp(Lt);let Tt=Ve.colorRampTexture;Tt||(Tt=Ve.colorRampTexture=new a.T(Le,Ve.colorRamp,Ne.RGBA8)),Tt.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}return{mix:rn,range:Lt,offset:ft,defines:Ze,resampling:We}})(Y,u,F,U);if(Y instanceof a.aP&&!y.length&&!C)return;const Q=u.paint.get("raster-emissive-strength"),le=g.colorModeForDrapableLayerRenderPass(Q),oe=g.terrain&&g.terrain.renderingToTexture,ue=!g.options.moving,de=u.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;if(Y instanceof a.aP&&!y.length&&(Y.onNorthPole||Y.onSouthPole)){const Fe=I?g.stencilModeFor3D():er.disabled;return void Af(!!Y.onNorthPole,null,g,o,u,Q,W,Wn.disabled,Fe)}if(!y.length)return;const[xe,Te]=Y instanceof a.aP||oe?[{},y]:g.stencilConfigForOverlap(y),Me=Te[Te.length-1].overscaledZ;L&&W.defines.push("PROJECTION_GLOBE_VIEW"),I&&W.defines.push("RENDER_CUTOFF");const ke=(Fe,Ve,Le)=>{for(const Ne of Fe){const je=Ne.toUnwrapped(),dt=o.getTile(Ne);if(oe&&(!dt||!dt.hasData()))continue;F.activeTexture.set(U.TEXTURE0);const Ze=mv(dt,Y,u,W);if(!Ze||!Ze.texture)continue;const{texture:Pt,mix:_t,offset:Lt,tileSize:rn,buffer:ft}=Ze;let We,Tt;oe?(We=Tn.disabled,Tt=Ne.projMatrix):I?(We=new Tn(U.LEQUAL,Tn.ReadWrite,g.depthRangeFor3D),Tt=C?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(je,ue)):(We=g.depthModeForSublayer(Ne.overscaledZ-Me,u.paint.get("raster-opacity")===1?Tn.ReadWrite:Tn.ReadOnly,U.LESS),Tt=g.transform.calculateProjMatrix(je,ue));const mt=g.terrain&&oe?g.terrain.stencilModeForRTTOverlap(Ne):xe[Ne.overscaledZ],It=T?0:u.paint.get("raster-fade-duration");dt.registerFadeDuration(It);const Nt=o.findLoadedParent(Ne,0),Rt=sa(dt,Nt,o,g.transform,It);let Ft,gn;g.terrain&&g.terrain.prepareDrawTile(),F.activeTexture.set(U.TEXTURE0),Pt.bind(de,U.CLAMP_TO_EDGE),F.activeTexture.set(U.TEXTURE1),Nt?(Nt.texture&&Nt.texture.bind(de,U.CLAMP_TO_EDGE),Ft=Math.pow(2,Nt.tileID.overscaledZ-dt.tileID.overscaledZ),gn=[dt.tileID.canonical.x*Ft%1,dt.tileID.canonical.y*Ft%1]):Pt.bind(de,U.CLAMP_TO_EDGE),"useMipmap"in Pt&&F.extTextureFilterAnisotropic&&g.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const Dn=g.transform;let xn;const zn=I?$y(Dn):[0,0,0,0];let Bn,Kn,Zn,pr,$r,sr=0;if(L&&Y instanceof a.aP&&Y.coordinates.length>3)Bn=Float32Array.from(a.bh(a.dD(new a.cA(0,0,0)))),Kn=Float32Array.from(Dn.globeMatrix),Zn=Float32Array.from(a.dz(Dn)),pr=[a.aD(Dn.center.lng),a.aH(Dn.center.lat)],xn=Y.elevatedGlobePerspectiveTransform,$r=Y.elevatedGlobeGridMatrix||new Float32Array(9);else if(L){const lr=a.dA(Ne.canonical);sr=a.dB(lr.getCenter().lat),Bn=Float32Array.from(a.bh(a.dD(Ne.canonical))),Kn=Float32Array.from(Dn.globeMatrix),Zn=Float32Array.from(a.dz(Dn)),pr=[a.aD(Dn.center.lng),a.aH(Dn.center.lat)],xn=[0,0],$r=Float32Array.from(a.dC(Ne.canonical,lr,sr,Dn.worldSize/Dn._pixelsPerMercatorPixel))}else xn=Y instanceof a.aP?Y.perspectiveTransform:[0,0],Bn=new Float32Array(16),Kn=new Float32Array(9),Zn=new Float32Array(16),pr=[0,0],$r=new Float32Array(9);const kr=yd(Tt,Bn,Kn,Zn,$r,gn||[0,0],a.ah(g.transform.zoom),pr,zn,Ft||1,Rt,u,xn,I?u.paint.get("raster-elevation"):0,2,_t,Lt,W.range,rn,ft,Q),Yr=g.isTileAffectedByFog(Ne),wi=g.getOrCreateProgram("raster",{defines:W.defines,overrideFog:Yr});if(g.uploadCommonUniforms(F,wi,je),Y instanceof a.aP){const lr=Y.elevatedGlobeVertexBuffer,ei=Y.elevatedGlobeIndexBuffer;if(oe||!C)Y.boundsBuffer&&Y.boundsSegments&&wi.draw(g,U.TRIANGLES,We,er.disabled,le,Wn.disabled,kr,u.id,Y.boundsBuffer,g.quadTriangleIndexBuffer,Y.boundsSegments);else if(lr&&ei){const ri=Dn.zoom<=a.cX?Y.elevatedGlobeSegments:Y.getSegmentsForLongitude(Dn.center.lng);ri&&wi.draw(g,U.TRIANGLES,We,er.disabled,le,Ve,kr,u.id,lr,ei,ri)}}else if(L){We=new Tn(U.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D);const lr=g.globeSharedBuffers;if(lr){const[ei,ri,ai]=lr.getGridBuffers(sr,!1);wi.draw(g,U.TRIANGLES,We,Le||mt,g.colorModeForRenderPass(),Ve,kr,u.id,ei,ri,ai)}}else{const{tileBoundsBuffer:lr,tileBoundsIndexBuffer:ei,tileBoundsSegments:ri}=g.getTileBoundsBuffers(dt);wi.draw(g,U.TRIANGLES,We,mt,le,Wn.disabled,kr,u.id,lr,ei,ri)}}if(!(Y instanceof a.aP)&&L)for(const Ne of Fe){const je=Ne.canonical.y===(1<<Ne.canonical.z)-1;Ne.canonical.y===0&&Af(!0,Ne,g,o,u,Q,W,Ve,Le||er.disabled),je&&Af(!1,Ne,g,o,u,Q,W,Ve===Wn.frontCW?Wn.backCW:Wn.frontCW,Le||er.disabled)}};L?ke(Te,g.renderElevatedRasterBackface?Wn.backCW:Wn.frontCW,g.stencilModeFor3D()):ke(Te,Wn.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,o,u,y,b,T){g.renderPass==="offscreen"&&(function(C,I,L,F){if(!F.length)return;const U=C.context,Y=U.gl,W=I.getSource();if(!(W instanceof Ro))return;const Q=Math.ceil(Math.sqrt(L.paint.get("raster-particle-count")));let le=L.particlePositionRGBAImage;if(!le||le.width!==Q){const Te=(function(Me){const ke=Me*Me,Fe=new Uint8Array(4*ke),Ve=function(Ne){return Ne|=0,Ne=Math.imul(2747636419^Ne,2654435769),Ne=Math.imul(Ne^Ne>>>16,2654435769),((Ne=Math.imul(Ne^Ne>>>16,2654435769))>>>0)/4294967296},Le=1/1.1;for(let Ne=0;Ne<ke;Ne++){const je=Le*(Ve(2*Ne+0)+eu),dt=Le*(Ve(2*Ne+1)+eu),Ze=255*je%1,Pt=255*dt%1,_t=Ze,Lt=dt-Pt/255,rn=Pt;Fe[4*Ne+0]=255*(je-Ze/255),Fe[4*Ne+1]=255*_t,Fe[4*Ne+2]=255*Lt,Fe[4*Ne+3]=255*rn}return Fe})(Q);le=L.particlePositionRGBAImage=new a.r({width:Q,height:Q},Te)}let oe=L.particleFramebuffer;oe?oe.width!==Q&&(oe.destroy(),oe=L.particleFramebuffer=U.createFramebuffer(Q,Q,!0,null)):oe=L.particleFramebuffer=U.createFramebuffer(Q,Q,!0,null);const ue=[];for(const Te of F){const Me=I.getTile(Te);if(!(Me instanceof lh))continue;const ke=_s(Me,W,L);if(!ke)continue;const Fe=[Me.tileSize,Me.tileSize];let Ve=L.tileFramebuffer;Ve||(Ve=L.tileFramebuffer=U.createFramebuffer(Fe[0],Fe[1],!0,null));let Le=Me.rasterParticleState;Le||(Le=Me.rasterParticleState=new gg(U,Te,Fe,le));const Ne=Le.update(L.lastInvalidatedAt);Le.particleTextureDimension!==Q&&Le.updateParticleTexture(Te,le);const je=Le.targetColorTexture;Le.targetColorTexture=Le.backgroundColorTexture,Le.backgroundColorTexture=je;const dt=Le.particleTexture0;Le.particleTexture0=Le.particleTexture1,Le.particleTexture1=dt,ue.push([Te,ke,Le,Ne])}if(ue.length===0)return;const de=a.q.now(),xe=L.previousDrawTimestamp?.001*(de-L.previousDrawTimestamp):.0167;if(L.previousDrawTimestamp=de,L.hasColorMap()){U.activeTexture.set(Y.TEXTURE0+2);let Te=L.colorRampTexture;Te||(Te=L.colorRampTexture=new a.T(U,L.colorRamp,Y.RGBA8)),Te.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}U.bindFramebuffer.set(L.tileFramebuffer.framebuffer),(function(Te,Me,ke){const Fe=Te.context,Ve=Fe.gl,Le=Me.tileFramebuffer;Fe.activeTexture.set(Ve.TEXTURE0);const Ne={u_texture:0,u_opacity:1.05*(dt=Me.paint.get("raster-particle-fade-opacity-factor"))/(dt+.05)},je=Te.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var dt;for(const Ze of ke){const[,,Pt,_t]=Ze;Le.colorAttachment.set(Pt.targetColorTexture.texture),Fe.viewport.set([0,0,Le.width,Le.height]),Fe.clear({color:a.am.transparent}),_t&&(Pt.backgroundColorTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE),je.draw(Te,Ve.TRIANGLES,Tn.disabled,er.disabled,yr.alphaBlended,Wn.disabled,Ne,Me.id,Te.viewportBuffer,Te.quadTriangleIndexBuffer,Te.viewportSegments))}})(C,L,ue),(function(Te,Me,ke,Fe){const Ve=Te.context,Le=Ve.gl,Ne=ke.tileFramebuffer,je=Te.transform.projection.name==="globe",dt=ke.paint.get("raster-particle-max-speed");for(const Ze of Fe){const[Pt,_t,Lt]=Ze;Ve.activeTexture.set(Le.TEXTURE0+0),_t.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),Ne.colorAttachment.set(Lt.targetColorTexture.texture);const rn=Te.getOrCreateProgram("rasterParticleDraw",{defines:_t.defines,overrideFog:!1});Ve.activeTexture.set(Le.TEXTURE0+1);const ft=_t.scalarData?[]:[0,1,2,3].map((mt=>a.e3[mt](Pt)));ft.push(Pt);const We=Pt.canonical.x,Tt=Pt.canonical.y;for(const mt of ft){const It=Me.getTile(je?mt.wrapped():mt);if(!It)continue;const Nt=It.rasterParticleState;if(!Nt)continue;const Rt=mt.canonical.x+(1<<mt.canonical.z)*(mt.wrap-Pt.wrap),Ft=mt.canonical.y;Nt.particleTexture0.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);const gn=bf(1,Nt.particleTexture0.size[0],[Rt-We,Ft-Tt],0,_t.texture.size,2,dt,_t.textureOffset,_t.scale,_t.offset);rn.draw(Te,Le.POINTS,Tn.disabled,er.disabled,yr.alphaBlended,Wn.disabled,gn,ke.id,Nt.particleIndexBuffer,void 0,Nt.particleSegment)}}})(C,I,L,ue),U.bindFramebuffer.set(L.particleFramebuffer.framebuffer),(function(Te,Me,ke,Fe){const Ve=Te.context,Le=Ve.gl,Ne=Me.paint.get("raster-particle-max-speed"),je=Fe*Me.paint.get("raster-particle-speed-factor")*.15,dt=(function(Pt){return Math.pow(Pt,6)})(.01+1*Me.paint.get("raster-particle-reset-rate-factor")),Ze=Me.particleFramebuffer;Ve.viewport.set([0,0,Ze.width,Ze.height]);for(const Pt of ke){const[,_t,Lt]=Pt;Ve.activeTexture.set(Le.TEXTURE0+0),_t.texture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),Ve.activeTexture.set(Le.TEXTURE0+1);const rn=Lt.particleTexture0;rn.bind(Le.NEAREST,Le.CLAMP_TO_EDGE);const ft=Uy(1,rn.size[0],0,_t.texture.size,Ne,je,dt,_t.textureOffset,_t.scale,_t.offset);Ze.colorAttachment.set(Lt.particleTexture1.texture),Ve.clear({color:a.am.transparent}),Te.getOrCreateProgram("rasterParticleUpdate",{defines:_t.defines}).draw(Te,Le.TRIANGLES,Tn.disabled,er.disabled,yr.unblended,Wn.disabled,ft,Me.id,Te.viewportBuffer,Te.quadTriangleIndexBuffer,Te.viewportSegments)}})(C,L,ue,xe)})(g,o,u,y),g.renderPass==="translucent"&&((function(C,I,L,F,U){const Y=C.context,W=Y.gl,Q=I.getSource().tileSize,le=5*(1-a.af(a.cI,a.cI+1,C.transform.zoom))*Q+L.paint.get("raster-particle-elevation"),oe=!C.options.moving,ue=C.transform.projection.name==="globe";if(!F.length)return;const[de,xe]=C.stencilConfigForOverlap(F),Te=[];ue&&Te.push("PROJECTION_GLOBE_VIEW");const Me=C.stencilModeFor3D();for(const ke of xe){const Fe=ke.toUnwrapped(),Ve=I.getTile(ke);if(!Ve.rasterParticleState)continue;const Le=Ve.rasterParticleState,Ne=100;Ve.registerFadeDuration(Ne);const je=I.findLoadedParent(ke,0),dt=sa(Ve,je,I,C.transform,Ne);let Ze,Pt;C.terrain&&C.terrain.prepareDrawTile(),Y.activeTexture.set(W.TEXTURE0),Le.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Y.activeTexture.set(W.TEXTURE1),je&&je.rasterParticleState?(je.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Ze=Math.pow(2,je.tileID.overscaledZ-Ve.tileID.overscaledZ),Pt=[Ve.tileID.canonical.x*Ze%1,Ve.tileID.canonical.y*Ze%1]):Le.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const _t=ue?Float32Array.from(C.transform.expandedFarZProjMatrix):C.transform.calculateProjMatrix(Fe,oe),Lt=C.transform,rn=ku(Lt),ft=a.dA(ke.canonical),We=a.dB(ft.getCenter().lat);let Tt,mt,It,Nt,Rt;ue?(Tt=Float32Array.from(a.bh(a.dD(ke.canonical))),mt=Float32Array.from(Lt.globeMatrix),It=Float32Array.from(a.dz(Lt)),Nt=[a.aD(Lt.center.lng),a.aH(Lt.center.lat)],Rt=Float32Array.from(a.dC(ke.canonical,ft,We,Lt.worldSize/Lt._pixelsPerMercatorPixel))):(Tt=new Float32Array(16),mt=new Float32Array(9),It=new Float32Array(16),Nt=[0,0],Rt=new Float32Array(9));const Ft=Rh(_t,Tt,mt,It,Rt,Pt||[0,0],a.ah(C.transform.zoom),Nt,rn,Ze||1,dt,le),gn=C.isTileAffectedByFog(ke),Dn=C.getOrCreateProgram("rasterParticle",{defines:Te,overrideFog:gn});if(C.uploadCommonUniforms(Y,Dn,Fe),ue){const xn=new Tn(W.LEQUAL,Tn.ReadOnly,C.depthRangeFor3D),zn=0,Bn=C.globeSharedBuffers;if(Bn){const[Kn,Zn,pr]=Bn.getGridBuffers(We,zn!==0);Dn.draw(C,W.TRIANGLES,xn,Me,yr.alphaBlended,C.renderElevatedRasterBackface?Wn.frontCCW:Wn.backCCW,Ft,L.id,Kn,Zn,pr)}}else{const xn=C.depthModeForSublayer(0,Tn.ReadOnly),zn=de[ke.overscaledZ],{tileBoundsBuffer:Bn,tileBoundsIndexBuffer:Kn,tileBoundsSegments:Zn}=C.getTileBoundsBuffers(Ve);Dn.draw(C,W.TRIANGLES,xn,zn,yr.alphaBlended,Wn.disabled,Ft,L.id,Bn,Kn,Zn)}}C.resetStencilClippingMasks()})(g,o,u,y),g.style.map.triggerRepaint())},background:function(g,o,u,y){const b=u.paint.get("background-color"),T=u.paint.get("background-color-use-theme").constantOr("default")==="none",C=u.paint.get("background-opacity"),I=u.paint.get("background-emissive-strength"),L=u.paint.get("background-pitch-alignment")==="viewport";if(C===0)return;const F=g.context,U=F.gl,Y=g.transform,W=Y.tileSize,Q=u.paint.get("background-pattern");let le;if(Q!==void 0&&(Q===null||(le=g.imageManager.getPattern(a.I.from(Q.toString()),u.scope,g.style.getLut(u.scope)),!le)))return;const oe=!Q&&b.a===1&&C===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==oe)return;const ue=er.disabled,de=g.depthModeForSublayer(0,oe==="opaque"?Tn.ReadWrite:Tn.ReadOnly),xe=g.colorModeForDrapableLayerRenderPass(I),Te=Q?"backgroundPattern":"background";let Me,ke=y;if(ke||(Me=g.getBackgroundTiles(),ke=Object.values(Me).map((Fe=>Fe.tileID))),Q&&(F.activeTexture.set(U.TEXTURE0),g.imageManager.bind(g.context,u.scope)),L){const Fe=g.getOrCreateProgram(Te,{overrideFog:!1,overrideRtt:!0}),Ve=new Float32Array(a.bx([])),Le=new a.aM(0,0,0,0,0),Ne=Q?fg(Ve,I,C,g,0,u.scope,le,L,{tileID:Le,tileSize:W}):Vp(Ve,I,C,b.toPremultipliedRenderColor(T?null:u.lut));Fe.draw(g,U.TRIANGLES,de,ue,xe,Wn.disabled,Ne,u.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const Fe of ke){const Ve=g.isTileAffectedByFog(Fe),Le=g.getOrCreateProgram(Te,{overrideFog:Ve}),Ne=Fe.toUnwrapped(),je=y?Fe.projMatrix:g.transform.calculateProjMatrix(Ne);g.prepareDrawTile();const dt=o?o.getTile(Fe):Me?Me[Fe.key]:new gs(Fe,W,Y.zoom,g),Ze=Q?fg(je,I,C,g,0,u.scope,le,L,{tileID:Fe,tileSize:W}):Vp(je,I,C,b.toPremultipliedRenderColor(T?null:u.lut));g.uploadCommonUniforms(F,Le,Ne);const{tileBoundsBuffer:Pt,tileBoundsIndexBuffer:_t,tileBoundsSegments:Lt}=g.getTileBoundsBuffers(dt);Le.draw(g,U.TRIANGLES,de,ue,xe,Wn.disabled,Ze,u.id,Pt,_t,Lt)}},sky:function(g,o,u){const y=g._atmosphere?a.ah(g.transform.zoom):1,b=u.paint.get("sky-opacity")*y;if(b===0)return;const T=g.context,C=u.paint.get("sky-type"),I=new Tn(T.gl.LEQUAL,Tn.ReadOnly,[0,1]),L=g.frameCounter/1e3%1;C==="atmosphere"?g.renderPass==="offscreen"?u.needsSkyboxCapture(g)&&((function(F,U,Y,W){const Q=F.context,le=Q.gl;let oe=U.skyboxFbo;if(!oe){oe=U.skyboxFbo=Q.createFramebuffer(32,32,!0,null),U.skyboxGeometry=new bd(Q),U.skyboxTexture=Q.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,U.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let Te=0;Te<6;++Te)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}Q.bindFramebuffer.set(oe.framebuffer),Q.viewport.set([0,0,32,32]);const ue=U.getCenter(F,!0),de=F.getOrCreateProgram("skyboxCapture"),xe=new Float64Array(16);a.bx(xe),a.eh(xe,xe,.5*-Math.PI),Ql(F,U,de,xe,ue,0),a.bx(xe),a.eh(xe,xe,.5*Math.PI),Ql(F,U,de,xe,ue,1),a.bx(xe),a.cR(xe,xe,.5*-Math.PI),Ql(F,U,de,xe,ue,2),a.bx(xe),a.cR(xe,xe,.5*Math.PI),Ql(F,U,de,xe,ue,3),a.bx(xe),Ql(F,U,de,xe,ue,4),a.bx(xe),a.eh(xe,xe,Math.PI),Ql(F,U,de,xe,ue,5),Q.viewport.set([0,0,F.width,F.height])})(g,u),u.markSkyboxValid(g)):g.renderPass==="sky"&&(function(F,U,Y,W,Q){const le=F.context,oe=le.gl,ue=F.transform,de=F.getOrCreateProgram("skybox");le.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_CUBE_MAP,U.skyboxTexture);const xe=((Te,Me,ke,Fe,Ve)=>({u_matrix:Te,u_sun_direction:Me,u_cubemap:0,u_opacity:Fe,u_temporal_offset:Ve}))(ue.skyboxMatrix,U.getCenter(F,!1),0,W,Q);F.uploadCommonUniforms(le,de),de.draw(F,oe.TRIANGLES,Y,er.disabled,F.colorModeForRenderPass(),Wn.backCW,xe,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)})(g,u,I,b,L):C==="gradient"&&g.renderPass==="sky"&&(function(F,U,Y,W,Q){const le=F.context,oe=le.gl,ue=F.transform,de=F.getOrCreateProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new bd(le)),le.activeTexture.set(oe.TEXTURE0);let xe=U.colorRampTexture;xe||(xe=U.colorRampTexture=new a.T(le,U.colorRamp,oe.RGBA8)),xe.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Te=((Me,ke,Fe,Ve,Le)=>({u_matrix:Me,u_color_ramp:0,u_center_direction:ke,u_radius:a.al(Fe),u_opacity:Ve,u_temporal_offset:Le}))(ue.skyboxMatrix,U.getCenter(F,!1),U.paint.get("sky-gradient-radius"),W,Q);F.uploadCommonUniforms(le,de),de.draw(F,oe.TRIANGLES,Y,er.disabled,F.colorModeForRenderPass(),Wn.backCW,Te,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)})(g,u,I,b,L)},custom:function(g,o,u,y){const b=g.context,T=u.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&u.isDraped(o)){if(g.renderPass==="offscreen"){const C=T.prerender;if(C){if(g.setCustomLayerDefaults(),b.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const I=g.transform.pointMerc;C.call(T,b.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.ah(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else C.call(T,b.gl,g.transform.customLayerMatrix());b.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const I=T.renderToTile;if(I){const L=y[0].canonical,F={x:L.x+y[0].wrap*(T.wrapTileId?0:1<<L.z),y:L.y,z:L.z};b.setDepthMode(Tn.disabled),b.setStencilMode(er.disabled),b.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),I.call(T,b.gl,F),b.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),b.setColorMode(g.colorModeForRenderPass()),b.setStencilMode(er.disabled);const C=T.renderingMode==="3d"?new Tn(g.context.gl.LEQUAL,Tn.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,Tn.ReadOnly);if(b.setDepthMode(C),g.transform.projection.name==="globe"){const I=g.transform.pointMerc;T.render(b.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.ah(g.transform.zoom),[I.x,I.y],g.transform.pixelsPerMeterRatio)}else T.render(b.gl,g.transform.customLayerMatrix());b.setDirty(),g.setBaseState(),b.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,o,u,y){if(g.renderPass==="opaque")return;const b=u.paint.get("model-opacity").constantOr(1);if(b===0)return;const T=u.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!T||g.terrain&&b<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof a.ab))return;const C=g.shadowRenderer,I=u.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,I||(C.enabled=!1));const L=()=>{C&&(C.useNormalOffset=!0,I||(C.enabled=!0))},F=o.getSource();if(g.renderPass==="light-beam"&&F.type!=="batched-model")return;if(F.type==="vector"||F.type==="geojson")return(function(de,xe,Te,Me,ke){const Fe=de.transform;if(Fe.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${Fe.projection.name} projection is not yet implemented`);const Ve=Fe.getFreeCameraOptions().position;if(!de.modelManager)return;const Le=de.modelManager;Te.modelManager=Le;const Ne=de.shadowRenderer;if(!Te._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const je=Te._unevaluatedLayout._values["model-id"],dt=Object.assign({},Te.layout.get("model-id").parameters),Ze=de.style.order.indexOf(Te.fqid);for(const Pt of Me){const _t=xe.getTile(Pt).getBucket(Te);if(!_t||_t.projection.name!==Fe.projection.name)continue;const Lt=_t.getModelUris();Lt&&!_t.modelsRequested&&(Le.addModelsFromBucket(Lt,ke),_t.modelsRequested=!0);const rn=gv(Pt,Fe);dt.zoom=rn;const ft=je.possiblyEvaluate(dt);if(Ih(de,_t,Pt),Tc.shadowUniformsInitialized=!1,Tc.useSingleShadowCascade=!!Ne&&Ne.getMaxCascadeForTile(Pt.toUnwrapped())===0,de.renderPass==="shadow"&&Ne){if(de.currentShadowCascade===1&&_t.isInsideFirstShadowMapFrustum)continue;const mt=Fe.calculatePosMatrix(Pt.toUnwrapped(),Fe.worldSize);if(Tc.tileMatrix.set(mt),Tc.shadowTileMatrix=Float32Array.from(Ne.calculateShadowPassMatrixFromMatrix(mt)),Tc.aabb.min.fill(0),Tc.aabb.max[0]=Tc.aabb.max[1]=a.aj,Tc.aabb.max[2]=0,vg(_t,Tc,de,Te.scope))continue}const We=1<<Pt.canonical.z,Tt=[((Ve.x-Pt.wrap)*We-Pt.canonical.x)*a.aj,(Ve.y*We-Pt.canonical.y)*a.aj,Ve.z*We*a.aj];de.conflationActive&&Object.keys(_t.instancesPerModel).length>0&&de.style.isLayerClipped(Te,xe.getSource())&&_t.updateReplacement(Pt,de.replacementSource,Ze,ke)&&(_t.uploaded=!1,_t.upload(de.context));for(let mt in _t.instancesPerModel){const It=_t.instancesPerModel[mt];It.features.length>0&&(mt=ft.evaluate(It.features[0].feature,{}));const Nt=Le.getModel(mt,ke);if(Nt||Le.hasURLBeenRequested(mt)||_t.modelUris.includes(mt)||(_t.modelUris.push(mt),_t.modelsRequested=!1),Nt&&Nt.uploaded)for(const Rt of Nt.nodes)Kp(de,Te,Rt,It,Tt,Pt,Tc)}}})(g,o,u,y,F.type==="vector"?u.scope:""),void L();if(!F.loaded())return;if(F.type==="batched-model")return(function(de,xe,Te,Me){Te.resetLayerRenderingStats(de);const ke=de.context,Fe=de.transform,Ve=de.style.fog,Le=de.shadowRenderer;if(Fe.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${Fe.projection.name} projection is not yet implemented`);const Ne=de.transform.getFreeCameraOptions().position,je=a.c1([],[Ne.x,Ne.y,Ne.z],de.transform.worldSize),dt=a.eq([],je),Ze=a.bx([]),Pt=a.e9(Fe.center.lat,Fe.zoom),_t=a.bn([],[1,1,1/Pt]);a.bo(Ze,Ze,dt);const Lt=Te.paint.get("model-opacity").constantOr(1),rn=new Tn(ke.gl.LEQUAL,Tn.ReadWrite,de.depthRangeFor3D),ft=new Tn(ke.gl.LEQUAL,Tn.ReadOnly,de.depthRangeFor3D),We=new a.d6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Tt=de.renderPass==="shadow",mt=Tt&&Le?Le.getCurrentCascadeFrustum():Fe.getFrustum(Fe.scaleZoom(Fe.worldSize)),It=Te.paint.get("model-front-cutoff"),Nt=It[2]<1,Rt=qc(de,Te.paint.get("model-cutoff-fade-range")),Ft=Te.getLayerRenderingStats();(function(gn,Dn,xn,zn){const Bn=gn.terrain?gn.terrain.exaggeration():0,Kn=gn.transform.zoom;for(const Zn of zn){const pr=Dn.getTile(Zn).getBucket(xn);pr&&(pr.setFilter(xn.filter),gn.conflationActive&&pr.updateReplacement(Zn,gn.replacementSource),pr.evaluateTransform(gn,xn),gn.terrain&&Bn>0&&pr.elevationUpdate(gn.terrain,Bn,Zn,xn.source),pr.needsReEvaluation(gn,Kn,xn)&&pr.evaluate(xn))}})(de,xe,Te,Me),(function(){let gn,Dn,xn;Nt?(gn=Me.length-1,Dn=-1,xn=-1):(gn=0,Dn=Me.length,xn=1);const zn=new Float64Array(16),Bn=a.cx(),Kn=new a.P(0,0);for(let Zn=gn;Zn!==Dn;Zn+=xn){const pr=Me[Zn],$r=xe.getTile(pr).getBucket(Te);if(!$r||!$r.uploaded)continue;let sr=!1;Le&&(sr=Le.getMaxCascadeForTile(pr.toUnwrapped())===0);const kr=Fe.calculatePosMatrix(pr.toUnwrapped(),Fe.worldSize),Yr=$r.modelTraits;!Tt&&Nt&&(a.bi(zn,kr),a.ad(Bn,je,zn),Kn.x=Bn[0],Kn.y=Bn[1]);const wi=[];$r.setFilter(Te.filter);for(const lr of $r.getNodesInfo()){if(lr.hiddenByReplacement||!lr.node.meshes)continue;const ei=lr.node;let ri=0;de.terrain&&ei.elevation&&(ri=ei.elevation*de.terrain.exaggeration());const ai=(()=>{const Co=lr.aabb;return We.min=[...Co.min],We.max=[...Co.max],We.min[2]+=ri,We.max[2]+=ri,a.ad(We.min,We.min,kr),a.ad(We.max,We.max,kr),We})(),br=lr.evaluatedScale;if(br[0]<=1&&br[1]<=1&&br[2]<=1&&ai.intersects(mt)===0)continue;if(!Tt&&Nt){const Co=.16666666666666666;lr.cameraCollisionOpacity=je[0]>ai.min[0]&&je[0]<ai.max[0]&&je[1]>ai.min[1]&&je[1]<ai.max[1]&&je[2]*Pt<ai.max[2]&&ei.footprint&&a.bY(Kn,ei.footprint)?Math.max(lr.cameraCollisionOpacity-Co,0):Math.min(1,lr.cameraCollisionOpacity+Co)}const oi=[...kr],Tr=1/a.d4(pr.canonical),Li=ei.anchor?ei.anchor[0]:0,qr=ei.anchor?ei.anchor[1]:0;a.bo(oi,oi,[Li*(br[0]-1)+lr.evaluatedTranslation[0]*Tr,qr*(br[1]-1)+lr.evaluatedTranslation[1]*Tr,ri+lr.evaluatedTranslation[2]]),a.cn(br,a.es)||a.cP(oi,oi,br);const ti=a.az([],oi,ei.matrix),Ai=a.az([],Fe.expandedFarZProjMatrix,ti),Ca=a.az([],Fe.expandedFarZProjMatrix,oi),Ma=a.aA([],[Li,qr,ri,1],Ai)[2];ei.hidden=!1;let wa=Lt;Tt||(Nt&&(wa*=lr.cameraCollisionOpacity,wa*=xg(oi,Fe,lr.aabb,It)),wa*=yv(Rt,Ma)),wa!==0?wi.push({nodeInfo:lr,depth:Ma,opacity:wa,wvpForNode:Ai,wvpForTile:Ca,nodeModelMatrix:ti,tileModelMatrix:oi}):ei.hidden=!0}Tt||wi.sort(((lr,ei)=>!Nt||lr.opacity===1&&ei.opacity===1?lr.depth<ei.depth?-1:1:lr.opacity===1?-1:ei.opacity===1?1:lr.depth>ei.depth?-1:1));for(const lr of wi){const ei=lr.nodeInfo,ri=ei.node;let ai=a.az([],_t,lr.tileModelMatrix);a.az(ai,Ze,ai);const br=a.bi([],ai);a.ea(br,br),a.cP(br,br,Jp),ai=a.az(ai,ai,ri.matrix);const oi=de.renderPass==="light-beam",Tr=Te.paint.get("model-color-use-theme").constantOr("default")==="none",Li=Yr&a.ex.HasMapboxMeshFeatures,qr=Li?0:ei.evaluatedRMEA[0][2];for(let ti=0;ti<ri.meshes.length;++ti){const Ai=ri.meshes[ti],Ca=ti===ri.lightMeshIndex;let Ma=lr.wvpForNode;if(Ca){if(!oi&&!de.terrain&&de.shadowRenderer){de.currentLayer<de.firstLightBeamLayer&&(de.firstLightBeamLayer=de.currentLayer);continue}Ma=lr.wvpForTile}else if(oi)continue;const wa={defines:[]},Co=[];if(!Tt&&Le&&(Le.useNormalOffset=!!Ai.normalBuffer),Pf(wa.defines,Co,Ai,de,Tr?null:Te.lut),Li||wa.defines.push("DIFFUSE_SHADED"),sr&&wa.defines.push("SHADOWS_SINGLE_CASCADE"),Ft&&(Tt?Ft.numRenderedVerticesInShadowPass+=Ai.vertexArray.length:Ft.numRenderedVerticesInTransparentPass+=Ai.vertexArray.length),Tt){Yp(Ai,lr.nodeModelMatrix,de,Te);continue}let po=null;if(Ve){const Ya=Mf(lr.nodeModelMatrix,de.transform);if(po=new Float32Array(Ya),Fe.projection.name!=="globe"){const ma=Ai.aabb.min,ca=Ai.aabb.max,[Si,Ka]=Ve.getOpacityForBounds(Ya,ma[0],ma[1],ca[0],ca[1]);wa.overrideFog=Si>=zt||Ka>=zt}}const bs=Ai.material;let qa;bs.occlusionTexture&&bs.occlusionTexture.offsetScale&&(qa=bs.occlusionTexture.offsetScale,wa.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ts=de.getOrCreateProgram("model",wa);!Tt&&Le&&Le.setupShadowsFromMatrix(lr.tileModelMatrix,ts,Le.useNormalOffset),de.uploadCommonUniforms(ke,ts,null,po);const _l=bs.pbrMetallicRoughness;_l.metallicFactor=.9,_l.roughnessFactor=.5;const nc=Up(new Float32Array(Ma),new Float32Array(ai),new Float32Array(br),new Float32Array(ri.matrix),de,lr.opacity,_l.baseColorFactor,bs.emissiveFactor,_l.metallicFactor,_l.roughnessFactor,bs,qr,Te,[0,0,0],qa);!Ca&&(ei.hasTranslucentParts||lr.opacity<1)&&ts.draw(de,ke.gl.TRIANGLES,rn,er.disabled,yr.disabled,Wn.backCCW,nc,Te.id,Ai.vertexBuffer,Ai.indexBuffer,Ai.segments,Te.paint,de.transform.zoom,void 0,Co),ts.draw(de,ke.gl.TRIANGLES,Ca?ft:rn,er.disabled,Ca||lr.opacity<1||ei.hasTranslucentParts?yr.alphaBlended:yr.unblended,Wn.backCCW,nc,Te.id,Ai.vertexBuffer,Ai.indexBuffer,Ai.segments,Te.paint,de.transform.zoom,void 0,Co)}}}})()})(g,o,u,y),void L();if(F.type!=="model")return;const U=F.getModels(),Y=[],W=g.transform.getFreeCameraOptions().position,Q=a.c1([],[W.x,W.y,W.z],g.transform.worldSize);a.eq(Q,Q);const le=[],oe=[];let ue=0;for(const de of U){const xe=u.paint.get("model-rotation").constantOr(null),Te=u.paint.get("model-scale").constantOr(null),Me=u.paint.get("model-translation").constantOr(null);de.computeModelMatrix(g,xe,Te,Me,!0,!0,!1);const ke=a.bx([]),Fe=a.e9(de.position.lat,g.transform.zoom),Ve=a.bn([],[1,1,1/Fe]);a.bo(ke,ke,Q),Y.push({zScaleMatrix:Ve,negCameraPosMatrix:ke});for(const Le of de.nodes)_g(g.transform,Le,de.matrix,g.transform.expandedFarZProjMatrix,ue,le,oe);ue++}if(le.sort(((de,xe)=>xe.depth-de.depth)),g.renderPass!=="shadow"){if(b===1)for(const de of oe)Sd(de,g,u,Y[de.modelIndex],er.disabled,g.colorModeForRenderPass());else{for(const de of oe)Sd(de,g,u,Y[de.modelIndex],er.disabled,yr.disabled);for(const de of oe)Sd(de,g,u,Y[de.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const de of le)Sd(de,g,u,Y[de.modelIndex],er.disabled,g.colorModeForRenderPass());L()}else{for(const de of oe)Yp(de.mesh,de.nodeModelMatrix,g,u);for(const de of le)Yp(de.mesh,de.nodeModelMatrix,g,u);L()}}},zu={line:function(g,o,u){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const y=o.getVisibleCoordinates();for(const b of y){const T=o.getTile(b).getBucket(g);if(T&&(T.elevationType!=="none"?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,o,u){const y=o.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,y.type==="vector"?g.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const b=y.getModels();for(const T of b)T.upload(u.context)},raster:function(g,o,u){const y=o.getSource();if(!(y instanceof Ro&&y.loaded()))return;const b=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!b)return;const T=g.paint.get("raster-array-band")||y.getInitialBand(b);if(T==null)return;const C=o.getIds().map((I=>o.getTileByID(I)));for(const I of C)I.updateNeeded(g.id,T)&&y.prepareTile(I,b,g.id,T)},"raster-particle":function(g,o,u){const y=o.getSource();if(!(y instanceof Ro&&y.loaded()))return;const b=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!b)return;const T=g.paint.get("raster-particle-array-band")||y.getInitialBand(b);if(T==null)return;const C=o.getIds().map((I=>o.getTileByID(I)));for(const I of C)I.updateNeeded(g.id,T)&&y.prepareTile(I,b,g.id,T)}},Lh={fill:Rn},Is={fill:function(g,o,u,y){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const b=g.context.gl,T=new Tn(b.LEQUAL,Tn.ReadOnly,g.depthRangeFor3D),C=new er({func:b.ALWAYS,mask:255},255,255,b.KEEP,b.KEEP,b.REPLACE),I=g.transform.getFreeCameraOptions().position,L=g.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const F of y){const U=o.getTile(F),Y=U.getBucket(u);if(!Y)continue;const W=Y.elevatedStructures;if(!W||W.depthSegments.segments[0].primitiveLength===0)continue;const Q=Sf(F.toUnwrapped(),I),le=g.translatePosMatrix(F.projMatrix,U,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),oe=pd(le,Q,0,1,0);L.draw(g,b.TRIANGLES,T,C,yr.disabled,Wn.disabled,oe,u.id,W.vertexBuffer,W.indexBuffer,W.depthSegments,u.paint,g.transform.zoom)}}};class ec{constructor(o,u,y,b,T,C){this.context=new tu(o,u),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=T,this._timeStamp=a.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const I=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const F of I)this._debugParams.enabledLayers[F]=!0;T.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),T.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),T.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),T.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),T.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),T.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const F of I)T.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],F);this.occlusionParams=new Dh(T),this.setup(),this.numSublayers=Zo.maxUnderzooming+Zo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.eE,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Ol(this),this._wireframeDebugCache=new Of,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const L=new a.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,L,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=b,this.worldview=C}updateTerrain(o,u){const y=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new vf(this,o));const b=this._terrain;this.transform.elevation=y?b:null,b.update(o,this.transform,u),this.transform.elevation&&!b.enabled&&(this.transform.elevation=null)}_updateFog(o){const u=o.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,b]=u.getFovAdjustedRange(this.transform._fov);if(y>b)return void(this.transform.fogCullDistSq=null);const T=y+.78*(b-y);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new vf(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,u){if(this.width=o*a.q.devicePixelRatio,this.height=u*a.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const o=this.context,u=new a.ba;u.emplaceBack(0,0),u.emplaceBack(a.aj,0),u.emplaceBack(0,a.aj),u.emplaceBack(a.aj,a.aj),this.tileExtentBuffer=o.createVertexBuffer(u,a.bc.members),this.tileExtentSegments=a.bd.simpleSegment(0,0,4,2);const y=new a.ba;y.emplaceBack(0,0),y.emplaceBack(a.aj,0),y.emplaceBack(0,a.aj),y.emplaceBack(a.aj,a.aj),this.debugBuffer=o.createVertexBuffer(y,a.bc.members),this.debugSegments=a.bd.simpleSegment(0,0,4,5);const b=new a.ba;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(b,a.bc.members),this.viewportSegments=a.bd.simpleSegment(0,0,4,2);const T=new a.aZ;T.emplaceBack(0,0,0,0),T.emplaceBack(a.aj,0,a.aj,0),T.emplaceBack(0,a.aj,0,a.aj),T.emplaceBack(a.aj,a.aj,a.aj,a.aj),this.mercatorBoundsBuffer=o.createVertexBuffer(T,a.bf.members),this.mercatorBoundsSegments=a.bd.simpleSegment(0,0,4,2);const C=new a.a_;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const I=new a.bb;for(const F of[0,1,3,2,0])I.emplaceBack(F);this.debugIndexBuffer=o.createIndexBuffer(I),this.emptyTexture=new a.T(o,new a.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=a.bz();const L=this.context.gl;this.stencilClearMode=new er({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,Tn.disabled,this.stencilClearMode,yr.disabled,Wn.disabled,og(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,u,y){if(!u||this.currentStencilSource===u.id||!o.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const L of y)if(this._tileClippingMaskIDs[L.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=u.id;const b=this.context,T=b.gl;this.nextStencilID+y.length>256&&this.clearStencil(),b.setColorMode(yr.disabled),b.setDepthMode(Tn.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of y){const L=u.getTile(I),F=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:U,tileBoundsIndexBuffer:Y,tileBoundsSegments:W}=this.getTileBoundsBuffers(L);C.draw(this,T.TRIANGLES,Tn.disabled,new er({func:T.ALWAYS,mask:0},F,255,T.KEEP,T.KEEP,T.REPLACE),yr.disabled,Wn.disabled,og(I.projMatrix),"$clipping",U,Y,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new er({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const u=this.context.gl;return new er({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(o){const u=this.context.gl,y=o.sort(((C,I)=>I.overscaledZ-C.overscaledZ)),b=y[y.length-1].overscaledZ,T=y[0].overscaledZ-b+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const C={};for(let I=0;I<T;I++)C[I+b]=new er({func:u.GEQUAL,mask:255},I+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=T,[C,y]}return[{[b]:er.disabled},y]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new yr([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new a.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?yr.unblended:yr.alphaBlended}colorModeForDrapableLayerRenderPass(o){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new yr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new a.am(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,u,y,b=!1){if(this.depthOcclusion)return new Tn(this.context.gl.GREATER,Tn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!b)return Tn.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Tn(y||this.context.gl.LEQUAL,u,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,u=Math.ceil(this.width),y=Math.ceil(this.height),b=this.context.bindFramebuffer.get(),T=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&y!==0&&(this.depthFBO=new Yl(this.context,u,y,!1,"texture"),this.depthTexture=new a.T(this.context,{width:u,height:y,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(b),o.bindTexture(o.TEXTURE_2D,T),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,u,y,0,0,u,y,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((o,u)=>o+u/this._fpsHistory.length),0))}render(o,u){const y=a.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=u;const b=this.style._mergedLayers,T=!(!this.terrain||!this.terrain.enabled),C=()=>this.style._getOrder(T).filter((ft=>{const We=b[ft];return!(We.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[We.type]}));let I=C(),L=!1,F=!1,U=null;for(const ft of I){const We=b[ft];We.type==="circle"?L=!0:We.type==="building"?U=We:We.type==="symbol"&&(We.hasInitialOcclusionOpacityProperties?F=!0:L=!0)}let Y=I.map((ft=>b[ft]));const W=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(a.q.now()),this.imageManager.beginFrame();let Q=0,le=!1;for(const ft in W){const We=W[ft];We.used&&(We.prepare(this.context),We.getSource().usedInConflation&&++Q)}let oe=!1;for(const ft of Y)ft.isHidden(this.transform.zoom)||(ft.type==="clip"&&(oe=!0),this.prepareLayer(ft));const ue={},de={},xe={},Te={},Me={};for(const ft in W){const We=W[ft];ue[ft]=We.getVisibleCoordinates(),de[ft]=ue[ft].slice().reverse(),xe[ft]=We.getVisibleCoordinates(!0).reverse(),Te[ft]=We.getShadowCasterCoordinates(),Me[ft]=We.sortCoordinatesByDistance(ue[ft])}const ke=ft=>{const We=this.style.getLayerSourceCache(ft);return We&&We.used?We.getSource():null};if(Q||oe||this._clippingActiveLastFrame){const ft=[],We=[];let Tt=0;for(const mt of Y)this.isSourceForClippingOrConflation(mt,ke(mt))&&(ft.push(mt),We.push(Tt)),Tt++;if(ft&&(oe||ft.length>1)||this._clippingActiveLastFrame){oe=!1;const mt=[];for(let It=0;It<ft.length;It++){const Nt=ft[It],Rt=We[It],Ft=this.style.getLayerSourceCache(Nt);if(!Ft||!Ft.used||!Ft.getSource().usedInConflation&&Nt.type!=="clip"&&Nt.type!=="building")continue;let gn=a.eF,Dn=a.bW.None;const xn=[];let zn=!0;if(Nt.type==="building")gn=a.eH;else if(Nt.type==="clip"){gn=Rt;for(const Bn of Nt.layout.get("clip-layer-types"))Dn|=Bn==="model"?a.bW.Model:Bn==="symbol"?a.bW.Symbol:a.bW.FillExtrusion;for(const Bn of Nt.layout.get("clip-layer-scope"))xn.push(Bn);Nt.isHidden(this.transform.zoom)?zn=!1:oe=!0}zn&&mt.push({layer:Nt.fqid,cache:Ft,order:gn,clipMask:Dn,clipScope:xn})}this.replacementSource.setSources(mt),le=!0}}this._clippingActiveLastFrame=oe,le||this.replacementSource.clear(),this.conflationActive=le,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ft=0;ft<Y.length;ft++){const We=Y[ft],Tt=We.cutoffRange();if(this.longestCutoffRange=Math.max(Tt,this.longestCutoffRange),Tt>0){const mt=ke(We);mt&&(this.minCutoffZoom=Math.max(mt.minzoom,this.minCutoffZoom)),We.minzoom&&(this.minCutoffZoom=Math.max(We.minzoom,this.minCutoffZoom))}We.is3D(T)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ft),this._lastOcclusionLayer=ft)}const Fe=this.style&&this.style.fog;Fe?(this._fogVisible=Fe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Fe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(xe),this.opaquePassCutoff=0,I=C(),Y=I.map((ft=>b[ft])));const Ve=this._shadowRenderer;if(Ve){Ve.updateShadowParameters(this.transform,this.style.directionalLight);for(const ft in W)for(const We of ue[ft]){let Tt={min:0,max:0};this.terrain&&(Tt=this.terrain.getMinMaxForTile(We)||Tt),Ve.addShadowReceiver(We.toUnwrapped(),Tt.min,Tt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.eG(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new st(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Le=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ne=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Le&&!this._snow&&(this._snow=new bg(this)),!Le&&this._snow&&(this._snow.destroy(),delete this._snow),Ne&&!this._rain&&(this._rain=new Nu(this)),!Ne&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),U){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Zy);const ft=this.style.getLayerSourceCache(U);this.buildingTileBorderManager.updateBorders(ft,U)}if(!Xn.has(this.context.gl))return;this.renderPass="offscreen";for(const ft of Y){const We=o.getLayerSourceCache(ft);if(!ft.hasOffscreenPass()||ft.isHidden(this.transform.zoom))continue;const Tt=We?de[We.id]:void 0;(ft.type==="custom"||ft.type==="raster"||ft.type==="raster-particle"||ft.isSky()||Tt&&Tt.length)&&this.renderLayer(this,We,ft,Tt)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const je=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),dt=(()=>{if(u.showOverdrawInspector)return a.am.black;const ft=this.style.fog;if(ft&&this.transform.projection.supportsFog){const We=this.style.getLut(ft.scope);if(!je){const Tt=ft.properties.get("color-use-theme")==="none",mt=ft.properties.get("color").toNonPremultipliedRenderColor(Tt?null:We).toArray01();return new a.am(...mt)}if(je){const Tt=ft.properties.get("space-color-use-theme")==="none",mt=ft.properties.get("space-color").toNonPremultipliedRenderColor(Tt?null:We).toArray01();return new a.am(...mt)}}return a.am.transparent})();if(this.context.clear({color:dt,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&je&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){const ft=Y[this.currentLayer],We=o.getLayerSourceCache(ft);if(ft.isSky())continue;const Tt=We?(ft.is3D(T)?Me:de)[We.id]:void 0;this._renderTileClippingMasks(ft,We,Tt),this.renderLayer(this,We,ft,Tt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&je&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){const ft=Y[this.currentLayer],We=o.getLayerSourceCache(ft);ft.isSky()&&this.renderLayer(this,We,ft,We?de[We.id]:void 0)}function Ze(ft,We){let Tt;return We&&(Tt=(ft.type==="symbol"?xe:ft.is3D(T)?Me:de)[We.id]),Tt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<I.length;){const ft=Y[this.currentLayer];if(ft.type==="raster"||ft.type==="raster-particle"){const We=o.getLayerSourceCache(ft);this.renderLayer(this,We,ft,Ze(ft,We))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Pt=0;Ve&&(Pt=Ve.getShadowCastingLayerCount());let _t=!1,Lt=-1;for(let ft=0;ft<I.length;++ft){const We=Y[ft];We.isHidden(this.transform.zoom)||We.is3D(T)&&(Lt=ft)}F&&Lt===-1&&(L=!0);let rn=!1;for(;this.currentLayer<I.length;){const ft=Y[this.currentLayer],We=o.getLayerSourceCache(ft);if(ft.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ft)){if(ft.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!rn&&ft.is3D(T)&&!T){const Tt=this.currentLayer,mt=It=>{for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const Nt=Y[this.currentLayer];if(Lh[Nt.type]){const Rt=this.style.getLayerSourceCache(Nt);Lh[Nt.type](this,Rt,Nt,Ze(Nt,Rt),It)}}};mt("initialize"),mt("reset"),this.currentLayer=Tt,rn=!0}if(L&&!_t&&this.terrain&&!this.transform.isOrthographic&&(_t=!0,this.blitDepth()),F&&Lt!==-1&&this.currentLayer===Lt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(ft,We,We?ue[We.id]:void 0),this.renderLayer(this,We,ft,Ze(ft,We)),!this.terrain&&Ve&&Pt>0&&ft.hasShadowPass()&&--Pt==0){{this.clearStencil(),this.resetStencilClippingMasks();const Tt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<Y.length;this.currentLayer++){const mt=Y[this.currentLayer];if(Is[mt.type]){const It=this.style.getLayerSourceCache(mt);Is[mt.type](this,It,mt,Ze(mt,It))}}this.currentLayer=Tt}if(Ve.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const Tt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Tt;this.currentLayer++){const mt=Y[this.currentLayer];if(!mt.hasLightBeamPass())continue;const It=o.getLayerSourceCache(mt);this.renderLayer(this,It,mt,It?de[It.id]:void 0)}this.currentLayer=Tt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Tt=this.currentLayer;this.depthOcclusion=!0;for(const mt of this.layersWithOcclusionOpacity){this.currentLayer=mt;const It=Y[this.currentLayer],Nt=o.getLayerSourceCache(It),Rt=Nt?de[Nt.id]:void 0;this.terrain||this._renderTileClippingMasks(It,Nt,Nt?ue[Nt.id]:void 0),this.renderLayer(this,Nt,It,Rt)}this.depthOcclusion=!1,this.currentLayer=Tt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ft=null;Y.forEach((We=>{const Tt=o.getLayerSourceCache(We);Tt&&!We.isHidden(this.transform.zoom)&&Tt.getVisibleCoordinates().length&&(!ft||ft.getSource().maxzoom<Tt.getSource().maxzoom)&&(ft=Tt)})),ft&&this.options.showTileBoundaries&&Sc(this,ft,ft.getVisibleCoordinates(),a.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Sc(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&(function(ft){const We=ft.transform.padding;xd(ft,ft.transform.height-(We.top||0),3,qy),xd(ft,We.bottom||0,3,Xp),Zp(ft,We.left||0,3,yg),Zp(ft,ft.transform.width-(We.right||0),3,Hy);const Tt=ft.transform.centerPoint;(function(mt,It,Nt,Rt){Cf(mt,It-1,Nt-10,2,20,Rt),Cf(mt,It-10,Nt-1,20,2,Rt)})(ft,Tt.x,ft.transform.height-Tt.y,Gy)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),le||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:u}=this.transform.projection,y=!u||!u.includes(o.type);if(zu[o.type]&&(y||this.terrain&&o.type==="custom")){const b=this.style.getLayerSourceCache(o);zu[o.type](o,b,this)}this.gpuTimingEnd()}renderLayer(o,u,y,b){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||b&&b.length)&&(this.id=y.id,this.gpuTimingStart(y),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(y.type)&&(!o.terrain||y.type!=="custom")||y.type==="clip"||Ky[y.type](o,u,y,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,y=this.context.gl;let b=this.gpuTimers[o.id];b||(b=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:y.createQuery()}),b.calls++,y.beginQuery(u.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,u=this.context.gl,y=u.createQuery();this.deferredRenderGpuTimeQueries.push(y),u.beginQuery(o.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const u={};for(const y in o){const b=o[y],T=this.context.extTimerQuery,C=T.getQueryParameter(b.query,this.context.gl.QUERY_RESULT)/1e6;T.deleteQueryEXT(b.query),u[y]=C}return u}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let y=0;for(const b of o)y+=u.getQueryParameter(b,u.QUERY_RESULT)/1e6,u.deleteQuery(b);return y}translatePosMatrix(o,u,y,b,T){if(!y[0]&&!y[1])return o;const C=T?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(C){const F=Math.sin(C),U=Math.cos(C);y=[y[0]*U-y[1]*F,y[0]*F+y[1]*U]}const I=[T?y[0]:a.aw(u,y[0],this.transform.zoom),T?y[1]:a.aw(u,y[1],this.transform.zoom),0],L=new Float32Array(16);return a.bo(L,o,I),L}saveTileTexture(o){if(o.context!==this.context)return;const u=o.size[0],y=this._tileTextures[u];y?y.push(o):this._tileTextures[u]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,u,y){const b=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,T=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(T.push("LIGHTING_3D_MODE"),T.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):b||T.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||T.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(T.push("TERRAIN"),this.linearFloatFilteringSupported()&&T.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&T.push("GLOBE"),!this._fogVisible||b||u!==void 0&&!u||T.push("FOG","FOG_DITHERING"),b&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}getOrCreateProgram(o,u){this.cache=this.cache||{};const y=u&&u.defines||[],b=u&&u.config,T=this.currentGlobalDefines(o,u&&u.overrideFog,u&&u.overrideRtt).concat(y),C=zp.cacheKey(bh[o],o,T,b);return this.cache[C]||(this.cache[C]=new zp(this.context,o,bh[o],b,Di[o],T)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,u){if(this.style.enable3dLights()){const y=this.style.directionalLight,b=this.style.ambientLight;if(y&&b){const T=((C,I,L)=>{const F=C.properties.get("direction"),U=C.properties.get("color-use-theme")==="none",Y=C.properties.get("color").toNonPremultipliedRenderColor(U?null:L.getLut(C.scope)).toArray01(),W=C.properties.get("intensity"),Q=I.properties.get("color-use-theme")==="none",le=I.properties.get("color").toNonPremultipliedRenderColor(Q?null:L.getLut(I.scope)).toArray01(),oe=I.properties.get("intensity"),ue=[F.x,F.y,F.z],de=a.dI(le,oe),xe=a.dI(Y,W);return{u_lighting_ambient_color:de,u_lighting_directional_dir:ue,u_lighting_directional_color:xe,u_ground_radiance:Mh(ue,xe,de)}})(y,b,this.style);u.setLightsUniformValues(o,T)}}}uploadCommonUniforms(o,u,y,b,T){if(this.uploadCommonLightUniforms(o,u),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const I=C.getOpacity(this.transform.pitch),L=((F,U,Y,W,Q,le,oe,ue,de,xe,Te,Me)=>{const ke=F.transform,Fe=U.properties.get("color-use-theme")==="none",Ve=U.properties.get("color").toNonPremultipliedRenderColor(Fe?null:F.style.getLut(U.scope)).toArray01();Ve[3]=W;const Le=F.frameCounter/1e3%1,[Ne,je]=U.properties.get("vertical-range");return{u_fog_matrix:Y?ke.calculateFogTileMatrix(Y):Me||F.identityMat,u_fog_range:U.getFovAdjustedRange(ke._fov),u_fog_color:Ve,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ne,je),je],u_fog_temporal_offset:Le,u_frustum_tl:Q,u_frustum_tr:le,u_frustum_br:oe,u_frustum_bl:ue,u_globe_pos:de,u_globe_radius:xe,u_viewport:Te,u_globe_transition:a.ah(ke.zoom),u_is_globe:+(ke.projection.name==="globe")}})(this,C,y,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.q.devicePixelRatio,this.transform.height*a.q.devicePixelRatio],b);u.setFogUniformValues(o,L)}T&&u.setCutoffUniformValues(o,T.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,u=o.createTexture();return o.bindTexture(o.TEXTURE_2D,u),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,u=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const b of y)u[b.key]=o[b.key]||new gs(b,512,this.transform.tileZoom,this,void 0,this.worldview);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,u){return!(!o.is3D(!(!this.terrain||!this.terrain.enabled))||o.type!=="clip"&&o.type!=="building"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building"&&o.sourceLayer!=="procedural_buildings")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[o.key];return u||(this._cachedTileFogOpacities[o.key]=u=this.style.fog.getOpacityForTile(o)),u[0]>=zt||u[1]>=zt}setupDepthForOcclusion(o,u,y){const b=this.context,T=b.gl,C=!!y;var I;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),b.activeTexture.set(T.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((I=this.depthRangeFor3D)[1]-I[0]),-1-2*I[0]/(I[1]-I[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),b.activeTexture.set(T.TEXTURE0),C||u.setTerrainUniformValues(b,y)}}function ju(g,o){let u=!1,y=null;const b=()=>{y=null,u&&(g(),y=setTimeout(b,o),u=!1)};return()=>(u=!0,y||b(),y)}class em{constructor(o){this._hashName=o&&encodeURIComponent(o),a.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ju(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const u=tm(o);if(this._hashName){const y=this._hashName;let b=!1;const T=location.hash.slice(1).split("&").map((C=>{const I=C.split("=")[0];return I===y?(b=!0,`${I}=${u}`):C})).filter((C=>C));return b||T.push(`${y}=${u}`),`#${T.join("&")}`}return`#${u}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let u;return o.split("&").map((y=>y.split("="))).forEach((y=>{y[0]===this._hashName&&(u=y)})),(u&&u[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some((y=>isNaN(Number(y))))){const y=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(u[3]||0):o.getBearing();return o.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:y,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function tm(g,o){const u=g.getCenter(),y=Math.round(100*g.getZoom())/100,b=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,b),C=Math.round(u.lng*T)/T,I=Math.round(u.lat*T)/T,L=g.getBearing(),F=g.getPitch();let U=o?`/${C}/${I}/${y}`:`${y}/${I}/${C}`;return(L||F)&&(U+="/"+Math.round(10*L)/10),F&&(U+=`/${Math.round(F)}`),U}const Ec={linearity:.3,easing:a.eI(0,0,.3,1)},Bu=a.h({deceleration:2500,maxSpeed:1400},Ec),ml=a.h({deceleration:20,maxSpeed:1400},Ec),Qo=a.h({deceleration:1e3,maxSpeed:360},Ec),nu=a.h({deceleration:1e3,maxSpeed:90},Ec);class nm{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=a.q.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)u.zoom+=T.zoomDelta||0,u.bearing+=T.bearingDelta||0,u.pitch+=T.pitchDelta||0,T.panDelta&&u.pan._add(T.panDelta),T.around&&(u.around=T.around),T.pinchAround&&(u.pinchAround=T.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(u.pan.mag()){const T=gl(u.pan.mag(),y,a.h({},Bu,o||{}));b.offset=u.pan.mult(T.amount/u.pan.mag()),b.center=this._map.transform.center,Dl(b,T)}if(u.zoom){const T=gl(u.zoom,y,ml);b.zoom=this._map.transform.zoom+T.amount,Dl(b,T)}if(u.bearing){const T=gl(u.bearing,y,Qo);b.bearing=this._map.transform.bearing+a.ay(T.amount,-179,179),Dl(b,T)}if(u.pitch){const T=gl(u.pitch,y,nu);b.pitch=this._map.transform.pitch+T.amount,Dl(b,T)}if(b.zoom||b.bearing){const T=u.pinchAround===void 0?u.around:u.pinchAround;b.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function Dl(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function gl(g,o,u){const{maxSpeed:y,linearity:b,deceleration:T}=u,C=a.ay(g*b/(o/1e3),-y,y),I=Math.abs(C)/(T*b);return{easing:u.easing,duration:1e3*I,amount:C*(I/2)}}class Zr extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,y,b={}){const T=ve(u.getCanvasContainer(),y),C=u.unproject(T);super(o,a.h({point:T,lngLat:C,originalEvent:y},b)),this._defaultPrevented=!1,this.target=u}}class Fu extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,y){const b=o==="touchend"?y.changedTouches:y.touches,T=De(u.getCanvasContainer(),b),C=T.map((L=>u.unproject(L))),I=T.reduce(((L,F,U,Y)=>L.add(F.div(Y.length))),new a.P(0,0));super(o,{points:T,point:I,lngLats:C,lngLat:u.unproject(I),originalEvent:y}),this._defaultPrevented=!1}}class rm extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class im{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new rm(this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new Zr(o.type,this._map,o))}mouseup(o){this._map.fire(new Zr(o.type,this._map,o))}preclick(o){const u=a.h({},o);u.type="preclick",this._map.fire(new Zr(u.type,this._map,u))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Zr(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Zr(o.type,this._map,o))}mouseover(o){this._map.fire(new Zr(o.type,this._map,o))}mouseout(o){this._map.fire(new Zr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Fu(o.type,this._map,o))}touchmove(o){this._map.fire(new Fu(o.type,this._map,o))}touchend(o){this._map.fire(new Fu(o.type,this._map,o))}touchcancel(o){this._map.fire(new Fu(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nh{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Zr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Zr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Zr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wg{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&o.button===0&&(fe(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const y=u,b=this._startPos,T=this._lastPos;if(!b||!T||T.equals(y)||!this._box&&y.dist(b)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=q("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const C=Math.min(b.x,y.x),I=Math.max(b.x,y.x),L=Math.min(b.y,y.y),F=Math.max(b.y,y.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${C}px,${L}px)`,this._box.style.width=I-C+"px",this._box.style.height=F-L+"px")}))}mouseupWindow(o,u){if(!this._active)return;const y=this._startPos,b=u;if(y&&o.button===0){if(this.reset(),me(),y.x!==b.x||y.y!==b.y)return this._map.fire(new a.A("boxzoomend",{originalEvent:o})),{cameraAnimation:T=>T.fitScreenCoordinates(y,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ne(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new a.A(o,{originalEvent:u}))}}function Ac(g,o){const u={};for(let y=0;y<g.length;y++)u[g[y].identifier]=o[y];return u}class Df{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,u,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),y.length===this.numTouches&&(this.centroid=(function(b){const T=new a.P(0,0);for(const C of b)T._add(C);return T.div(b.length)})(u),this.touches=Ac(y,u)))}touchmove(o,u,y){if(this.aborted||!this.centroid)return;const b=Ac(y,u);for(const T in this.touches){const C=b[T];(!C||C.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(o,u,y){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Vu{constructor(o){this.singleTap=new Df(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,u,y){this.singleTap.touchstart(o,u,y)}touchmove(o,u,y){this.singleTap.touchmove(o,u,y)}touchend(o,u,y){const b=this.singleTap.touchend(o,u,y);if(b){const T=o.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(b)<30;if(T&&C||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Sg{constructor(){this._zoomIn=new Vu({numTouches:1,numTaps:2}),this._zoomOut=new Vu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,y){this._zoomIn.touchstart(o,u,y),this._zoomOut.touchstart(o,u,y)}touchmove(o,u,y){this._zoomIn.touchmove(o,u,y),this._zoomOut.touchmove(o,u,y)}touchend(o,u,y){const b=this._zoomIn.touchend(o,u,y),T=this._zoomOut.touchend(o,u,y);return b?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(b)},{originalEvent:o})}):T?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(T)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Tg={0:1,2:2},Ed={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Ad{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,u){return!1}_move(o,u){return{}}mousedown(o,u){if(this._lastPoint)return;const y=Ye(o);this._correctButton(o,y)&&(this._lastPoint=u,this._eventButton=y)}mousemoveWindow(o,u){const y=this._lastPoint;if(y){if(o.preventDefault(),this._eventButton!=null&&(function(b,T){const C=Tg[T];return b.buttons===void 0||(b.buttons&C)!==C})(o,this._eventButton))this.reset();else if(this._moved||!(u.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(y,u)}}mouseupWindow(o){this._lastPoint&&Ye(o)===this._eventButton&&(this._moved&&me(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class am extends Ad{mousedown(o,u){super.mousedown(o,u),this._lastPoint&&(this._active=!0)}_correctButton(o,u){return u===0&&!o.ctrlKey}_move(o,u){return{around:u,panDelta:u.sub(o)}}}class om extends Ad{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?Ed[o.pitchRotateKey]:void 0}_correctButton(o,u){return this._pitchRotateKey?u===0&&o[this._pitchRotateKey]:u===0&&o.ctrlKey||u===2}_move(o,u){const y=.8*(u.x-o.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class Eg extends Ad{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?Ed[o.pitchRotateKey]:void 0}_correctButton(o,u){return this._pitchRotateKey?u===0&&o[this._pitchRotateKey]:u===0&&o.ctrlKey||u===2}_move(o,u){const y=-.5*(u.y-o.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class vv{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(o,u,y){return this._calculateTransform(o,u,y)}touchmove(o,u,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!a.eJ())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,u,y)}}touchend(o,u,y){this._calculateTransform(o,u,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,y){y.length>0&&(this._active=!0);const b=Ac(y,u),T=new a.P(0,0),C=new a.P(0,0);let I=0;for(const F in b){const U=b[F],Y=this._touches[F];Y&&(T._add(U),C._add(U.sub(Y)),I++,b[F]=U)}if(this._touches=b,I<this._minTouches||!C.mag())return;const L=C.div(I);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(I),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=q("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class sm{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,u,y){return{}}touchstart(o,u,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,y){const b=this._firstTwoTouches;if(!b)return;o.preventDefault();const[T,C]=b,I=To(y,u,T),L=To(y,u,C);if(!I||!L)return;const F=this._aroundCenter?null:I.add(L).div(2);return this._move([I,L],F,o)}touchend(o,u,y){if(!this._firstTwoTouches)return;const[b,T]=this._firstTwoTouches,C=To(y,u,b),I=To(y,u,T);C&&I||(this._active&&me(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function To(g,o,u){for(let y=0;y<g.length;y++)if(g[y].identifier===u)return o[y]}function es(g,o){return Math.log(g/o)/Math.LN2}class Jy extends sm{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(es(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:es(this._distance,y),pinchAround:u}}}function Ag(g,o){return 180*g.angleWith(o)/Math.PI}class Qy extends sm{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u){const y=this._vector;if(this._vector=o[0].sub(o[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ag(this._vector,y),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const b=Ag(o,y);return Math.abs(b)<u}}function lm(g){return Math.abs(g.y)>Math.abs(g.x)}class e_ extends sm{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,lm(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,y){const b=this._lastPoints;if(!b)return;const T=o[0].sub(b[0]),C=o[1].sub(b[1]);return this._map._cooperativeGestures&&!a.eJ()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(T,C,y.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(T.y+C.y)/2*-.5})}gestureBeginsVertically(o,u,y){if(this._valid!==void 0)return this._valid;const b=o.mag()>=2,T=u.mag()>=2;if(!b&&!T)return;if(!b||!T)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const C=o.y>0==u.y>0;return lm(o)&&lm(u)&&C}}const cm={panStep:100,bearingStep:15,pitchStep:10};class Cg{constructor(){const o=cm;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,y=0,b=0,T=0,C=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?y=-1:(o.preventDefault(),T=-1);break;case 39:o.shiftKey?y=1:(o.preventDefault(),T=1);break;case 38:o.shiftKey?b=1:(o.preventDefault(),C=-1);break;case 40:o.shiftKey?b=-1:(o.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(y=0,b=0),{cameraAnimation:I=>{const L=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:t_,zoom:u?Math.round(L)+u*(o.shiftKey?2:1):L,bearing:I.getBearing()+y*this._bearingStep,pitch:I.getPitch()+b*this._pitchStep,offset:[-T*this._panStep,-C*this._panStep],center:I.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function t_(g){return g*(2-g)}const n_=4.000244140625,xv=1/450;class r_{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=xv,a.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||a.eJ()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const y=a.q.now(),b=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,u!==0&&u%n_==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(b*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=ve(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>n_?this._wheelZoomRate:this._defaultZoomRate;let U=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&U!==0&&(U=1/U);const Y=u(),W=Math.pow(2,Y),Q=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(Q*U))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:u(),b=this._startZoom,T=this._easing;let C,I=!1;if(this._type==="wheel"&&b&&T){const F=Math.min((a.q.now()-this._lastWheelEventTime)/200,1),U=T(F);C=a.ai(b,y,U),F<1?this._frameId||(this._frameId=!0):I=!0}else C=y,I=!0;this._active=!0,I&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let L=C-u();return L*this._lastDelta<0&&(L=0),{noInertia:!0,needsRenderFrame:!I,zoomDelta:L,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=a.eK;if(this._prevEase){const y=this._prevEase,b=(a.q.now()-y.start)/y.duration,T=y.easing(b+.01)-y.easing(b),C=.27/Math.sqrt(T*T+1e-4)*.01,I=Math.sqrt(.0729-C*C);u=a.eI(C,I,.25,1)}return this._prevEase={start:a.q.now(),duration:o,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=q("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class Ki{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Mg{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,u){return o.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(o.shiftKey?-1:1),around:y.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bv{constructor(){this._tap=new Vu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,u,y){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=u[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(o,u,y))}touchmove(o,u,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const b=u[0],T=b.y-this._swipePoint.y;return this._swipePoint=b,o.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(o,u,y)}touchend(o,u,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(o,u,y)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class um{constructor(o,u,y){this._el=o,this._mousePan=u,this._touchPan=y}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Pg{constructor(o,u,y){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=u,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Cd{constructor(o,u,y,b){this._el=o,this._touchZoom=u,this._touchRotate=y,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const kf=g=>g.zoom||g.drag||g.pitch||g.rotate;class hm extends a.A{}class dm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,u){const y=a.at([],u,o);this.radius=a.ae(y[2]<0?a.eM([],y,this.constants):[y[0],y[1],0])}projectRay(o){a.eM(o,o,this.constants),a.au(o,o),a.eN(o,o,this.constants);const u=a.c1([],o,this.radius);if(u[2]>0){const y=a.c1([],[0,0,1],a.bG(u,[0,0,1])),b=a.c1([],a.au([],[u[0],u[1],0]),this.radius),T=a.d5([],u,a.c1([],a.at([],a.d5([],b,y),u),2));u[0]=T[0],u[1]=T[1]}return u}}function Bo(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Lf{constructor(o,u){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new nm(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new dm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.aV(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,T,C]of this._listeners){const I=b===document?this.handleWindowEvent:this.handleEvent;b.addEventListener(T,I,C)}}destroy(){for(const[o,u,y]of this._listeners){const b=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(u,b,y)}}_addDefaultHandlers(o){const u=this._map,y=u.getCanvasContainer();this._add("mapEvent",new im(u,o));const b=u.boxZoom=new wg(u,o);this._add("boxZoom",b);const T=new Sg,C=new Mg;u.doubleClickZoom=new Ki(C,T),this._add("tapZoom",T),this._add("clickZoom",C);const I=new bv;this._add("tapDragZoom",I);const L=u.touchPitch=new e_(u);this._add("touchPitch",L);const F=new om(o),U=new Eg(o);u.dragRotate=new Pg(o,F,U),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]);const Y=new am(o),W=new vv(u,o);u.dragPan=new um(y,Y,W),this._add("mousePan",Y),this._add("touchPan",W,["touchZoom","touchRotate"]);const Q=new Qy,le=new Jy;u.touchZoomRotate=new Cd(y,le,Q,I),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Nh(u));const oe=u.scrollZoom=new r_(u,this);this._add("scrollZoom",oe,["mousePan"]);const ue=u.keyboard=new Cg;this._add("keyboard",ue);for(const de of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[de]&&u[de].enable(o[de])}_add(o,u,y){this._handlers.push({handlerName:o,handler:u,allowed:y}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!kf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,u,y){for(const b in o)if(b!==y&&(!u||u.indexOf(b)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const u=[];for(const y of o)this._el.contains(y.target)&&u.push(y);return u}handleEvent(o,u){this._updatingCamera=!0;const y=o.type==="renderFrame",b=y?void 0:o,T={needsRenderFrame:!1},C={},I={},L=o.touches?this._getMapTouches(o.touches):void 0,F=L?De(this._el,L):y?void 0:ve(this._el,o);for(const{handlerName:W,handler:Q,allowed:le}of this._handlers){if(!Q.isEnabled())continue;let oe;this._blockedByActive(I,le,W)?Q.reset():Q[u||o.type]&&(oe=Q[u||o.type](o,F,L),this.mergeHandlerResult(T,C,oe,W,b),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||Q.isActive())&&(I[W]=Q)}const U={};for(const W in this._previousActiveHandlers)I[W]||(U[W]=b);this._previousActiveHandlers=I,(Object.keys(U).length||Bo(T))&&(this._changes.push([T,C,U]),this._triggerRenderFrame()),(Object.keys(I).length||Bo(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=T;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))}mergeHandlerResult(o,u,y,b,T){if(!y)return;a.h(o,y);const C={handlerName:b,originalEvent:y.originalEvent||T};y.zoomDelta!==void 0&&(u.zoom=C),y.panDelta!==void 0&&(u.drag=C),y.pitchDelta!==void 0&&(u.pitch=C),y.bearingDelta!==void 0&&(u.rotate=C)}_applyChanges(){const o={},u={},y={};for(const[b,T,C]of this._changes)b.panDelta&&(o.panDelta=(o.panDelta||new a.P(0,0))._add(b.panDelta)),b.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(o.around=b.around),b.aroundCoord!==void 0&&(o.aroundCoord=b.aroundCoord),b.pinchAround!==void 0&&(o.pinchAround=b.pinchAround),b.noInertia&&(o.noInertia=b.noInertia),a.h(u,T),a.h(y,C);this._updateMapTransform(o,u,y),this._changes=[]}_updateMapTransform(o,u,y){const b=this._map,T=b.transform,C=xe=>[xe.x,xe.y,xe.z];if((xe=>{const Te=this._eventsInProgress.drag;return Te&&!this._handlersById[Te.handlerName].isActive()})()&&!Bo(o)){const xe=T.zoom;T.cameraElevationReference="sea",this._originalZoom!=null&&T._orthographicProjectionAtLowPitch&&T.projection.name!=="globe"&&T.pitch===0?(T.cameraElevationReference="ground",T.zoom=this._originalZoom):(T.recenterOnTerrain(),T.cameraElevationReference="ground"),xe!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&b._stop(!0),!Bo(o))return void this._fireEvents(u,y,!0);let{panDelta:I,zoomDelta:L,bearingDelta:F,pitchDelta:U,around:Y,aroundCoord:W,pinchAround:Q}=o;T._isCameraConstrained&&(L>0&&(L=0),T._isCameraConstrained=!1),Q!==void 0&&(Y=Q),(L||(xe=>u[xe]&&!this._eventsInProgress[xe])("drag"))&&Y&&(this._dragOrigin=C(T.pointCoordinate3D(Y)),this._originalZoom=T.zoom,this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",b._stop(!0),Y=Y||b.transform.centerPoint,F&&(T.bearing+=F),U&&(T.pitch+=U),T._updateCameraState();const le=[0,0,0];if(I)if(T.projection.name==="mercator"){const xe=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(Y).dir),Te=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(Y.sub(I)).dir);le[0]=Te[0]-xe[0],le[1]=Te[1]-xe[1]}else{const xe=T.pointCoordinate(Y);if(T.projection.name==="globe"){I=I.rotate(-T.angle);const Te=T._pixelsPerMercatorPixel/T.worldSize;le[0]=-I.x*a.eL(a.aY(xe.y))*Te,le[1]=-I.y*a.eL(T.center.lat)*Te}else{const Te=T.pointCoordinate(Y.sub(I));xe&&Te&&(le[0]=Te.x-xe.x,le[1]=Te.y-xe.y)}}const oe=T.zoom,ue=[0,0,0];if(L){const xe=C(W||T.pointCoordinate3D(Y)),Te={dir:a.au([],a.at([],xe,T._camera.position))};if(Te.dir[2]<0){const Me=T.zoomDeltaToMovement(xe,L);a.c1(ue,Te.dir,Me)}}const de=a.d5(le,le,ue);T._translateCameraConstrained(de),L&&Math.abs(T.zoom-oe)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,y,!0)}_fireEvents(o,u,y){const b=kf(this._eventsInProgress),T=kf(o),C={};for(const U in o){const{originalEvent:Y}=o[U];this._eventsInProgress[U]||(C[`${U}start`]=Y),this._eventsInProgress[U]=o[U]}!b&&T&&this._fireEvent("movestart",T.originalEvent);for(const U in C)this._fireEvent(U,C[U]);T&&this._fireEvent("move",T.originalEvent);for(const U in o){const{originalEvent:Y}=o[U];this._fireEvent(U,Y)}const I={};let L;for(const U in this._eventsInProgress){const{handlerName:Y,originalEvent:W}=this._eventsInProgress[U];this._handlersById[Y].isActive()||(delete this._eventsInProgress[U],L=u[Y]||W,I[`${U}end`]=L)}for(const U in I)this._fireEvent(U,I[U]);const F=kf(this._eventsInProgress);if(y&&(b||T)&&!F){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;U?(Y(U.bearing||this._map.getBearing())&&(U.bearing=0),this._map.easeTo(U,{originalEvent:L})):(this._map.fire(new a.A("moveend",{originalEvent:L})),Y(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new a.A(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((o=>{this._frameId=void 0,this.handleEvent(new hm("renderFrame",{timeStamp:o})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ba="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Cc extends a.E{constructor(o,u){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,a.aV(["_renderFrameCallback"],this)}getCenter(){return new a.ci(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}panBy(o,u,y){return o=a.P.convert(o).mult(-1),this.panTo(this.transform.center,a.h({offset:o},u),y)}panTo(o,u,y){return this.easeTo(a.h({center:o},u),y)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,y){return this.easeTo(a.h({zoom:o},u),y)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,y){return this.easeTo(a.h({bearing:o},u),y)}resetNorth(o,u){return this.rotateTo(0,a.h({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(a.h({bearing:0,pitch:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}cameraForBounds(o,u){o=a.aG.convert(o);const y=u&&u.bearing||0,b=u&&u.pitch||0,T=o.getNorthWest(),C=o.getSouthEast();return this._cameraForBounds(this.transform,T,C,y,b,u)}_extendPadding(o){const u={top:0,right:0,bottom:0,left:0};return o==null?a.h({},u,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:a.h({},u,o)}_extendCameraOptions(o){return(o=a.h({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,u){const y=u.max[0]-u.min[0],b=u.max[1]-u.min[1];return y/b>o.aspect?y/(2*Math.tan(.5*o.fovX)*o.aspect):b/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,u,y,b,T,C){const I=o.clone(),L=this._extendCameraOptions(C);I.bearing=b,I.pitch=T;const F=a.ci.convert(u),U=a.ci.convert(y),Y=.5*(F.lat+U.lat),W=.5*(F.lng+U.lng),Q=a.eO(Y,W),le=a.au([],Q),oe=a.au([],a.bF([],le,[0,1,0])),ue=a.bF([],oe,le),de=[oe[0],oe[1],oe[2],0,ue[0],ue[1],ue[2],0,le[0],le[1],le[2],0,0,0,0,1],xe=[Q,a.eO(F.lat,F.lng),a.eO(U.lat,F.lng),a.eO(U.lat,U.lng),a.eO(F.lat,U.lng),a.eO(Y,F.lng),a.eO(Y,U.lng),a.eO(F.lat,W),a.eO(U.lat,W)];let Te=a.d6.fromPoints(xe.map((mt=>[a.bG(oe,mt),a.bG(ue,mt),a.bG(le,mt)])));const Me=a.ad([],Te.center,de);a.eP(Me)===0&&a.eQ(Me,0,0,1),a.au(Me,Me),a.c1(Me,Me,a.aB),I.center=a.eR(Me);const ke=I.getWorldToCameraMatrix(),Fe=a.bi(new Float64Array(16),ke);Te=a.d6.applyTransform(Te,a.az([],ke,de));const Ve=this._extendAABB(Te,I,L,b);if(!Ve)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Ve,a.ad(Me,Me,ke);const Le=.5*(Te.max[2]-Te.min[2]),Ne=this._minimumAABBFrustumDistance(I,Te),je=a.c1([],[0,0,1],Le),dt=a.d5(je,Me,je),Ze=Ne+(I.pitch===0?0:a.bD(Me,dt)),Pt=I.globeCenterInViewSpace,_t=a.at([],Me,[Pt[0],Pt[1],Pt[2]]);a.au(_t,_t),a.c1(_t,_t,Ze);const Lt=a.d5([],Me,_t);a.ad(Lt,Lt,Fe);const rn=a.eB/a.aB,ft=a.ae(Lt),We=a.cb(Math.max(ft*rn-a.eB,Number.EPSILON),0),Tt=Math.min(I.zoomFromMercatorZAdjusted(We),L.maxZoom);return Tt>.5*(a.cX+a.cI)?(I.setProjection({name:"mercator"}),I.zoom=Tt,this._cameraForBounds(I,u,y,b,T,C)):{center:I.center,zoom:Tt,bearing:b,pitch:T}}_extendAABB(o,u,y,b){const T=.5*((y.padding.left||0)+(y.padding.right||0)),C=.5*((y.padding.top||0)+(y.padding.bottom||0)),I=C,L=T,F=T,U=C,Y=u.width-(L+F),W=u.height-(I+U),Q=a.at([],o.max,o.min),le=Math.min(Y/Q[0],W/Q[1]),oe=Math.min(u.scaleZoom(u.scale*le),y.maxZoom);if(isNaN(oe))return null;const ue=u.scale/u.zoomScale(oe),de=new a.d6([o.min[0]-L*ue,o.min[1]-U*ue,o.min[2]],[o.max[0]+F*ue,o.max[1]+I*ue,o.max[2]]),xe=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new a.P(y.offset.x,y.offset.y):a.P.convert(y.offset)).rotate(-a.al(b));return de.center[0]-=xe.x*ue,de.center[1]+=xe.y*ue,de}queryTerrainElevation(o,u){const y=this.transform.elevation;return y?(u=a.h({},{exaggerated:!0},u),y.getAtPoint(a.ac.fromLngLat(o),null,u.exaggerated)):null}_cameraForBounds(o,u,y,b,T,C){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,u,y,b,T,C);const I=o.clone(),L=this._extendCameraOptions(C);I.bearing=b,I.pitch=T;const F=a.ci.convert(u),U=a.ci.convert(y),Y=new a.ci(F.lng,U.lat),W=new a.ci(U.lng,F.lat),Q=I.project(F),le=I.project(U),oe=this.queryTerrainElevation(F),ue=this.queryTerrainElevation(U),de=this.queryTerrainElevation(Y),xe=this.queryTerrainElevation(W),Te=[[Q.x,Q.y,Math.min(oe||0,ue||0,de||0,xe||0)],[le.x,le.y,Math.max(oe||0,ue||0,de||0,xe||0)]];let Me=a.d6.fromPoints(Te);const ke=I.getWorldToCameraMatrix(),Fe=a.bi(new Float64Array(16),ke);Me=a.d6.applyTransform(Me,ke);const Ve=this._extendAABB(Me,I,L,b);if(!Ve)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Me=Ve;const Le=.5*a.at([],Me.max,Me.min)[2],Ne=this._minimumAABBFrustumDistance(I,Me),je=[0,0,1,0];a.aA(je,je,ke),a.eS(je,je);const dt=a.c1([],je,Ne+Le),Ze=a.d5([],Me.center,dt);a.ad(Me.center,Me.center,Fe),a.ad(Ze,Ze,Fe);const Pt=I.unproject(new a.P(Me.center[0],Me.center[1])),_t=a.eT(I.projection,Pt),Lt=Math.pow(2,_t),rn=Math.min(I._zoomFromMercatorZ(Ze[2]*I.pixelsPerMeter*Lt/I.worldSize),L.maxZoom);return I.mercatorFromTransition&&rn<.5*(a.cX+a.cI)?(I.setProjection({name:"globe"}),I.zoom=rn,this._cameraForBounds(I,u,y,b,T,C)):{center:Pt,zoom:rn,bearing:b,pitch:T}}fitBounds(o,u,y){const b=this.cameraForBounds(o,u);return this._fitInternal(b,u,y)}fitScreenCoordinates(o,u,y,b,T){const C=a.P.convert(o),I=a.P.convert(u),L=new a.P(Math.min(C.x,I.x),Math.min(C.y,I.y)),F=new a.P(Math.max(C.x,I.x),Math.max(C.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,I))return this;const U=this.transform.pointLocation3D(L),Y=this.transform.pointLocation3D(F),W=this.transform.pointLocation3D(new a.P(L.x,F.y)),Q=this.transform.pointLocation3D(new a.P(F.x,L.y)),le=[Math.min(U.lng,Y.lng,W.lng,Q.lng),Math.min(U.lat,Y.lat,W.lat,Q.lat)],oe=[Math.max(U.lng,Y.lng,W.lng,Q.lng),Math.max(U.lat,Y.lat,W.lat,Q.lat)],ue=b&&b.pitch?b.pitch:this.getPitch(),de=this._cameraForBounds(this.transform,le,oe,y,ue,b);return this._fitInternal(de,b,T)}_fitInternal(o,u,y){return o?(u=a.h(o,u)).linear?this.easeTo(u,y):this.flyTo(u,y):this}jumpTo(o,u){this.stop();const y=o.preloadOnly?this.transform.clone():this.transform;let b=!1,T=!1,C=!1;"zoom"in o&&y.zoom!==+o.zoom&&(b=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=a.ci.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(T=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(C=!0,y.pitch=+o.pitch);const I=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!y.isPaddingEqual(I))if(o.retainPadding===!1){const L=y.clone();L.padding=I,y.setLocationAtPoint(y.center,L.centerPoint)}else y.padding=I;return o.preloadOnly?(this._preloadTiles(y),this):(this.fire(new a.A("movestart",u)).fire(new a.A("move",u)),b&&this.fire(new a.A("zoomstart",u)).fire(new a.A("zoom",u)).fire(new a.A("zoomend",u)),T&&this.fire(new a.A("rotatestart",u)).fire(new a.A("rotate",u)).fire(new a.A("rotateend",u)),C&&this.fire(new a.A("pitchstart",u)).fire(new a.A("pitch",u)).fire(new a.A("pitchend",u)),this.fire(new a.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(Ba),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,u){const y=this.transform;if(!y.projection.supportsFreeCamera)return a.w(Ba),this;this.stop();const b=y.zoom,T=y.pitch,C=y.bearing;y.setFreeCameraOptions(o);const I=b!==y.zoom,L=T!==y.pitch,F=C!==y.bearing;return this.fire(new a.A("movestart",u)).fire(new a.A("move",u)),I&&this.fire(new a.A("zoomstart",u)).fire(new a.A("zoom",u)).fire(new a.A("zoomend",u)),F&&this.fire(new a.A("rotatestart",u)).fire(new a.A("rotate",u)).fire(new a.A("rotateend",u)),L&&this.fire(new a.A("pitchstart",u)).fire(new a.A("pitch",u)).fire(new a.A("pitchend",u)),this.fire(new a.A("moveend",u)),this}easeTo(o,u){this._stop(!1,o.easeId),((o=a.h({offset:[0,0],duration:500,easing:a.eK},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const y=this.transform,b=this.getZoom(),T=this.getBearing(),C=this.getPitch(),I=this.getPadding(),L="zoom"in o?+o.zoom:b,F="bearing"in o?this._normalizeBearing(o.bearing,T):T,U="pitch"in o?+o.pitch:C,Y=this._extendPadding(o.padding),W=a.P.convert(o.offset);let Q,le,oe;if(y.projection.name==="globe"){const je=a.ac.fromLngLat(y.center),dt=W.rotate(-y.angle);je.x+=dt.x/y.worldSize,je.y+=dt.y/y.worldSize;const Ze=je.toLngLat(),Pt=a.ci.convert(o.center||Ze);this._normalizeCenter(Pt),Q=y.centerPoint.add(dt),le=new a.P(je.x,je.y).mult(y.worldSize),oe=new a.P(a.aD(Pt.lng),a.aH(Pt.lat)).mult(y.worldSize).sub(le)}else{Q=y.centerPoint.add(W);const je=y.pointLocation(Q),dt=a.ci.convert(o.center||je);this._normalizeCenter(dt),le=y.project(je),oe=y.project(dt).sub(le)}const ue=y.zoomScale(L-b);let de,xe;o.around&&(de=a.ci.convert(o.around),xe=y.locationPoint(de));const Te=this._zooming||L!==b,Me=this._rotating||T!==F,ke=this._pitching||U!==C,Fe=!y.isPaddingEqual(Y),Ve=o.retainPadding===!1?y.clone():y,Le=je=>dt=>{if(Te&&(je.zoom=a.ai(b,L,dt)),Me&&(je.bearing=a.ai(T,F,dt)),ke&&(je.pitch=a.ai(C,U,dt)),Fe&&(Ve.interpolatePadding(I,Y,dt),Q=Ve.centerPoint.add(W)),de)je.setLocationAtPoint(de,xe);else{const Ze=je.zoomScale(je.zoom-b),Pt=L>b?Math.min(2,ue):Math.max(.5,ue),_t=Math.pow(Pt,1-dt),Lt=je.unproject(le.add(oe.mult(dt*_t)).mult(Ze));je.setLocationAtPoint(je.renderWorldCopies?Lt.wrap():Lt,Q)}return o.preloadOnly||this._fireMoveEvents(u),je};if(o.preloadOnly){const je=this._emulate(Le,o.duration,y);return this._preloadTiles(je),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Te,this._rotating=Me,this._pitching=ke,this._padding=Fe,this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Ne),this._ease(Le(y),(je=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(u,je)}),o),this}_prepareEase(o,u,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||y.moving||this.fire(new a.A("movestart",o)),this._zooming&&!y.zooming&&this.fire(new a.A("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new a.A("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new a.A("pitchstart",o))}_fireMoveEvents(o){this.fire(new a.A("move",o)),this._zooming&&this.fire(new a.A("zoom",o)),this._rotating&&this.fire(new a.A("rotate",o)),this._pitching&&this.fire(new a.A("pitch",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,b=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.A("zoomend",o)),b&&this.fire(new a.A("rotateend",o)),T&&this.fire(new a.A("pitchend",o)),this.fire(new a.A("moveend",o))}flyTo(o,u){if(this._prefersReducedMotion(o)){const mt=a.aF(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(mt,u)}this.stop(),o=a.h({offset:[0,0],speed:1.2,curve:1.42,easing:a.eK},o);const y=this.transform,b=this.getZoom(),T=this.getBearing(),C=this.getPitch(),I=this.getPadding(),L="zoom"in o?a.ay(+o.zoom,y.minZoom,y.maxZoom):b,F="bearing"in o?this._normalizeBearing(o.bearing,T):T,U="pitch"in o?+o.pitch:C,Y=this._extendPadding(o.padding),W=y.zoomScale(L-b),Q=a.P.convert(o.offset);let le=y.centerPoint.add(Q);const oe=y.pointLocation(le),ue=a.ci.convert(o.center||oe);this._normalizeCenter(ue);const de=y.project(oe),xe=y.project(ue).sub(de);let Te=o.curve;const Me=Math.max(y.width,y.height),ke=Me/W,Fe=xe.mag();if("minZoom"in o){const mt=a.ay(Math.min(o.minZoom,b,L),y.minZoom,y.maxZoom),It=Me/y.zoomScale(mt-b);Te=Math.sqrt(It/Fe*2)}const Ve=Te*Te;function Le(mt){const It=(ke*ke-Me*Me+(mt?-1:1)*Ve*Ve*Fe*Fe)/(2*(mt?ke:Me)*Ve*Fe);return Math.log(Math.sqrt(It*It+1)-It)}function Ne(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function je(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const dt=Le(0);let Ze=function(mt){return je(dt)/je(dt+Te*mt)},Pt=function(mt){return Me*((je(dt)*(Ne(It=dt+Te*mt)/je(It))-Ne(dt))/Ve)/Fe;var It},_t=(Le(1)-dt)/Te;if(Math.abs(Fe)<1e-6||!isFinite(_t)){if(Math.abs(Me-ke)<1e-6)return this.easeTo(o,u);const mt=ke<Me?-1:1;_t=Math.abs(Math.log(ke/Me))/Te,Pt=function(){return 0},Ze=function(It){return Math.exp(mt*Te*It)}}o.duration="duration"in o?+o.duration:1e3*_t/("screenSpeed"in o?+o.screenSpeed/Te:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Lt=T!==F,rn=U!==C,ft=!y.isPaddingEqual(Y),We=o.retainPadding===!1?y.clone():y,Tt=mt=>It=>{const Nt=It*_t,Rt=1/Ze(Nt);mt.zoom=It===1?L:b+mt.scaleZoom(Rt),Lt&&(mt.bearing=a.ai(T,F,It)),rn&&(mt.pitch=a.ai(C,U,It)),ft&&(We.interpolatePadding(I,Y,It),le=We.centerPoint.add(Q));const Ft=It===1?ue:mt.unproject(de.add(xe.mult(Pt(Nt))).mult(Rt));return mt.setLocationAtPoint(mt.renderWorldCopies?Ft.wrap():Ft,le),mt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(u),mt};if(o.preloadOnly){const mt=this._emulate(Tt,o.duration,y);return this._preloadTiles(mt),this}return this._zooming=!0,this._rotating=Lt,this._pitching=rn,this._padding=ft,this._prepareEase(u,!1),this._ease(Tt(y),(()=>this._afterEase(u)),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,u)}if(!o){const y=this.handlers;y&&y.stop(!1)}return this}_ease(o,u,y){y.animate===!1||y.duration===0?(o(1),u()):(this._easeStart=a.q.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((a.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,u){o=a.bQ(o,-180,180);const y=Math.abs(o-u);return Math.abs(o-360-u)<y&&(o-=360),Math.abs(o+360-u)<y&&(o+=360),o}_normalizeCenter(o){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const y=o.lng-u.center.lng;o.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&a.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,u,y){const b=Math.ceil(15*u/1e3),T=[],C=o(y.clone());for(let I=0;I<=b;I++){const L=C(I/b);T.push(L.clone())}return T}_preloadTiles(o,u){}}class yl{constructor(o={}){this.options=o,a.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const u=this.options&&this.options.compact,y=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=q("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const b=q("span","mapboxgl-ctrl-icon",this._compactButton);return b.setAttribute("aria-hidden","true"),b.setAttribute("title",y),this._innerContainer=q("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(o){const y=u.reduce(((b,T,C)=>(T.value&&(b+=`${T.key}=${T.value}${C<u.length-1?"&":""}`),b)),"?");o.href=`${a.e.FEEDBACK_URL}/${y}#${tm(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const u=this._map.style._mergedSourceCaches;for(const b in u){const T=u[b];if(T.used){const C=T.getSource();C.attribution&&o.indexOf(C.attribution)<0&&o.push(C.attribution)}}o.sort(((b,T)=>b.length-T.length)),o=o.filter(((b,T)=>{for(let C=T+1;C<o.length;C++)if(o[C].indexOf(b)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const y=o.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,o.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Nf{constructor(){a.aV(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=q("div","mapboxgl-ctrl");const u=q("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const u in o){const y=o[u].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const u=o[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class zf{constructor(){a.aV(["_onIndoorUpdate"],this)}onAdd(o){return this._map=o,this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",(u=>this._onIndoorUpdate({selectedFloorId:u.selectedFloorId,floors:u.floors}))),this._container}_createButton(o,u){const y=q("button",o,this._container);return y.type="button",y.addEventListener("click",u),y}_setButtonTitle(o,u){this._map&&(o.setAttribute("aria-label",u),o.innerHTML=`<strong>${u}</strong>`,o.firstElementChild&&o.firstElementChild.setAttribute("title",u))}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(o){if(!o||!o.floors)return void(this._container.style.display="none");const u=this._model;this._model=o,this._container.style.display="inline-block";const y=o.floors.sort(((b,T)=>b.levelOrder-T.levelOrder));u?(Array.from(this._container.children).forEach((b=>b.remove())),this.addCurrentFloors(y)):this.addCurrentFloors(y)}addCurrentFloors(o){for(const u of o){const y=this._createButton("mapboxgl-ctrl-level-button",(()=>{this._map._selectIndoorFloor(u.id),Array.from(this._container.children).forEach((b=>{b.classList.remove("mapboxgl-ctrl-level-button-selected")})),y.classList.add("mapboxgl-ctrl-level-button-selected")}));this._setButtonTitle(y,u.shortName),this._model&&u.id===this._model.selectedFloorId&&(this._map._selectIndoorFloor(u.id),y.classList.add("mapboxgl-ctrl-level-button-selected")),this._container.append(y)}}}class jf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,y=u?this._queue.concat(u):this._queue;for(const b of y)if(b.id===o)return void(b.cancelled=!0)}run(o=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const y of u)if(!y.cancelled&&(y.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Fa{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const u=a.dx((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,u,y){this._start=this.getValue(u),this._end=o,this._startTime=u,this._endTime=u+y}}const q0={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class wv extends a.A{constructor(o,u,y,b){const{point:T,lngLat:C,originalEvent:I,target:L}=o;super(o.type,{point:T,lngLat:C,originalEvent:I,target:L}),this.preventDefault=()=>{o.preventDefault()},this.id=u,this.interaction=y,this.feature=b}}class Og{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,u){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const y=u.filter;let b=u.type;y&&this.filters.set(o,a.b3(y)),b==="mouseover"&&(b="mouseenter"),b==="mouseout"&&(b="mouseleave");const T=this.interactionsByType.get(b)||new Map;b==="mouseenter"||b==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,u)):T.size===0&&this.map.on(b,this.handleType),T.size===0&&this.interactionsByType.set(b,T),T.set(o,u),this.typeById.set(o,b)}get(o){const u=this.typeById.get(o);if(!u)return;const y=this.interactionsByType.get(u);return y?y.get(o):void 0}remove(o){const u=this.typeById.get(o);if(!u)return;this.typeById.delete(o),this.filters.delete(o);const y=this.interactionsByType.get(u);y&&(y.delete(o),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(u,this.handleType))}queryTargets(o,u){const y=[];for(const[b,T]of u)T.target&&y.push({targetId:b,target:T.target,filter:this.filters.get(b)});return this.map.style.queryRenderedTargets(o,y,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());u.length&&(o.type="mouseenter",this.handleType(o,u));const y=new Map;for(const[b,{feature:T}]of this.prevHoveredFeatures)this.hoveredFeatures.has(b)||y.set(T.id,T);y.size&&(o.type="mouseleave",this.handleType(o,Array.from(y.values())))}handleOut(o){const u=Array.from(this.hoveredFeatures.values()).map((({feature:y})=>y));u.length&&(o.type="mouseleave",this.handleType(o,u)),this.hoveredFeatures.clear()}handleType(o,u){const y=o.type==="mouseenter";if(y&&!this.interactionsByType.has(o.type))return void a.w("mouseenter interaction required for mouseleave to work.");const b=Array.from(this.interactionsByType.get(o.type)).reverse(),T=!!u;u=u||this.queryTargets(o.point,b);let C=!1;const I=new Set;for(const L of u){for(const[F,U]of b){if(!U.target)continue;const Y=L.variants?L.variants[F]:null;if(Y){for(const W of Y){if(rd(W,L,I,F))continue;const Q=new a.dr(L,W),le=Lc(W,L,F);T&&(Q.state=this.map.getFeatureState(Q));const oe=y?this.prevHoveredFeatures.get(le):null,ue=new wv(o,F,U,Q),de=oe?oe.stop:U.handler(ue);if(y&&this.hoveredFeatures.set(le,{feature:L,stop:de}),de!==!1){C=!0;break}}if(C)break}}if(C)break}if(!C)for(const[L,F]of b){const{handler:U,target:Y}=F;if(!Y&&U(new wv(o,L,F,null))!==!1)break}}}function Md(g,o){if(Array.isArray(g)&&Array.isArray(o)){const u=new Set(g),y=new Set(o);return u.size===y.size&&g.every((b=>y.has(b)))}return a.bv(g,o)}const tc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Pd={showCompass:!0,showZoom:!0,visualizePitch:!1};class ru{constructor(o,u,y=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new om({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,y&&(this.mousePitch=new Eg({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),a.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(o,u){this.mouseRotate.mousedown(o,u),this.mousePitch&&this.mousePitch.mousedown(o,u),fe()}move(o,u){const y=this.map,b=this.mouseRotate.mousemoveWindow(o,u),T=b&&b.bearingDelta;if(T&&y.setBearing(y.getBearing()+T),this.mousePitch){const C=this.mousePitch.mousemoveWindow(o,u),I=C&&C.pitchDelta;I&&y.setPitch(y.getPitch()+I)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ne(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(a.h({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),ve(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,ve(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=De(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=De(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ds(g,o,u){if(g=new a.ci(g.lng,g.lat),o){const y=new a.ci(g.lng-360,g.lat),b=new a.ci(g.lng+360,g.lat),T=360*Math.ceil(Math.abs(g.lng-u.center.lng)/360),C=u.locationPoint3D(g).distSqr(o),I=o.x<0||o.y<0||o.x>u.width||o.y>u.height;u.locationPoint3D(y).distSqr(o)<C&&(I||Math.abs(y.lng-u.center.lng)<T)?g=y:u.locationPoint3D(b).distSqr(o)<C&&(I||Math.abs(b.lng-u.center.lng)<T)&&(g=b)}for(;Math.abs(g.lng-u.center.lng)>180;){const y=u.locationPoint3D(g);if(y.x>=0&&y.y>=0&&y.x<=u.width&&y.y<=u.height)break;g.lng>u.center.lng?g.lng-=360:g.lng+=360}return g}const Eo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},xs={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Ks extends a.E{constructor(o,u){super(),(o instanceof HTMLElement||u)&&(o=a.h({element:o},u)),a.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:y="center",color:b="#3FB1CE",scale:T=1,draggable:C=!1,clickTolerance:I=0,rotation:L=xs.rotation,rotationAlignment:F=xs.rotationAlignment,pitchAlignment:U=xs.pitchAlignment,occludedOpacity:Y=xs.occludedOpacity,altitude:W=xs.altitude}=o||{};this._anchor=y,this._color=b,this._scale=T,this._draggable=C,this._clickTolerance=I,this._rotation=L,this._rotationAlignment=F,this._pitchAlignment=U,this._occludedOpacity=Y,this._altitude=W,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),o&&o.element?(this._element=o.element,this._offset=a.P.convert(o&&o.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=a.P.convert(o&&o.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(oe=>{oe.preventDefault()})),this._element.addEventListener("mousedown",(oe=>{oe.preventDefault()}));const Q=this._element.classList;for(const oe in Eo)Q.remove(`mapboxgl-marker-anchor-${oe}`);Q.add(`mapboxgl-marker-anchor-${this._anchor}`);const le=o&&o.className?o.className.trim().split(/\s+/):[];Q.add(...le),this._popup=null}_createDefaultMarker(){const o=q("div"),u=V("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},o);if(this._altitude===0){const y=V("radialGradient",{id:"shadowGradient"},V("defs",{},u));V("stop",{offset:"10%","stop-opacity":.4},y),V("stop",{offset:"100%","stop-opacity":.05},y),V("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return V("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),V("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),V("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),o}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.ci.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(o){return o===this._altitude||(this._defaultMarker&&(this._altitude===0&&o!==0||this._altitude!==0&&o===0)&&(this._element=this._createDefaultMarker()),this._altitude=o||xs.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,o._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const u=o.code,y=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(o){const u=o.originalEvent.target,y=this._element;this._popup&&(u===y||y.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,u=this._pos;if(!o||!u)return!1;const y=o.unproject(u,this._altitude),b=o.getFreeCameraOptions();if(!b.position)return!1;const T=b.position.toLngLat();return T.distanceTo(y)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const u=this._pos;if(!u||u.x<0||u.x>o.transform.width||u.y<0||u.y>o.transform.height)return void this._clearFadeTimer();const y=o.unproject(u,this._altitude);let b;o._showingGlobe()&&a.eW(o.transform,this._lngLat)?b=0:(b=1-o._queryFogOpacity(y),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Eo[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const o=this._pos,u=this._map,y=this.getPitchAlignment();if(!u||!o||y!=="map")return"";if(!u._showingGlobe()){const L=u.getPitch();return L?`rotateX(${L}deg)`:""}const b=a.cU(a.eX(u.transform,this._lngLat)),T=o.sub(a.eY(u.transform)),C=Math.abs(T.x)+Math.abs(T.y);if(C===0)return"";const I=b/C;return`rotateX(${-T.y*I}deg) rotateY(${T.x*I}deg)`}_calculateZTransform(){const o=this._pos,u=this._map;if(!u||!o)return"";let y=0;const b=this.getRotationAlignment();if(b==="map")if(u._showingGlobe()){const T=u.project(new a.ci(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),C=u.project(new a.ci(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(T);y=a.cU(Math.atan2(C.y,C.x))-90}else y=-u.getBearing();else if(b==="horizon"){const T=a.af(4,6,u.getZoom()),C=a.eY(u.transform);C.y+=T*u.transform.height;const I=o.sub(C),L=a.cU(Math.atan2(I.y,I.x));y=(L>90?L-270:L+90)*(1-T)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Ds(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),o===!0?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),u._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(o){return this._offset=a.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const u=this._map;if(!u)return;const y=this._pointerdownPos,b=this._positionDelta;if(y&&b){if(!this._isDragging){const T=this._clickTolerance||u._clickTolerance;if(o.point.dist(y)<T)return;this._isDragging=!0}this._pos=o.point.sub(b),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.A("dragstart"))),this.fire(new a.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.A("dragend")),this._state="inactive"}_addDragHandler(o){const u=this._map,y=this._pos;u&&y&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(y),this._pointerdownPos=o.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const u=this._map;return u&&(o?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||xs.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||xs.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||xs.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||xs.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Sv={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},i_={maxWidth:100,unit:"metric"},a_={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Rg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},o_=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Za(g=new a.P(0,0),o="bottom"){if(typeof g=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new a.P(0,g);case"top-left":return new a.P(u,u);case"top-right":return new a.P(-u,u);case"bottom":return new a.P(0,-g);case"bottom-left":return new a.P(u,-u);case"bottom-right":return new a.P(-u,-u);case"left":return new a.P(g,0);case"right":return new a.P(-g,0)}return new a.P(0,0)}return g instanceof a.P||Array.isArray(g)?a.P.convert(g):a.P.convert(g[o]||[0,0])}return{version:w,supported:G.supported,setRTLTextPlugin:a.f0,getRTLTextPluginStatus:a.e$,Map:class extends Cc{constructor(g){M.mark(S.create);const o=g;if((g=a.h({},tc,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&a.eU(window)&&(g.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Cy(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies,null,null),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new jf,this._domRenderTaskQueue=new jf,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.a$(),this._locale=a.h({},q0,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Fa(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new ct(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const u=document.getElementById(g.container);if(!u)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=u}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,a.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new _v),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Lf(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||a.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new Ry(this),g.hash&&(this._hash=new em(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const u=g.bounds;u&&(this.resize(),this.fitBounds(u,a.h({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new yl({customAttribution:g.customAttribution})),this._logoControl=new Nf,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(u=>{this._update(u.dataType==="style"),this.fire(new a.A(`${u.dataType}data`,u))})),this.on("dataloading",(u=>{this.fire(new a.A(`${u.dataType}dataloading`,u))})),this._interactions=new Og(this)}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[o];return o.indexOf("bottom")!==-1?y.insertBefore(u,y.firstChild):y.appendChild(u),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new a.A("movestart",g)).fire(new a.A("move",g)),this.fire(new a.A("resize",g)),o&&this.fire(new a.A("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(a.aG.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new a.A("zoomstart")).fire(new a.A("zoom")).fire(new a.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new a.A("zoomstart")).fire(new a.A("zoom")).fire(new a.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new a.A("pitchstart")).fire(new a.A("pitch")).fire(new a.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new a.A("pitchstart")).fire(new a.A("pitch")).fire(new a.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((o=>o.type==="symbol")),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map((o=>o==="auto"?navigator.language:o)):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let u;o==="globe"&&g.zoom>=a.cI?(g.setMercatorFromTransition(),u=!0):o==="mercator"&&g.zoom<a.cI&&(g.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;return o=g.name==="globe"&&this.transform.zoom>=a.cI?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g,o){return this.transform.locationPoint3D(a.ci.convert(g),o)}unproject(g,o){return this.transform.pointLocation3D(a.P.convert(g),o)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,u){const y=b=>{let T=[];if(Array.isArray(o)){const C=o.filter((I=>this.getLayer(I)));T=C.length?this.queryRenderedFeatures(b,{layers:C}):[]}else T=this.queryRenderedFeatures(b,{target:o});return T};if(g==="mouseenter"||g==="mouseover"){let b=!1;return{listener:u,targets:o,delegates:{mousemove:C=>{const I=y(C.point);I.length?b||(b=!0,u.call(this,new Zr(g,this,C.originalEvent,{features:I}))):b=!1},mouseout:()=>{b=!1}}}}if(g==="mouseleave"||g==="mouseout"){let b=!1;return{listener:u,targets:o,delegates:{mousemove:I=>{y(I.point).length?b=!0:b&&(b=!1,u.call(this,new Zr(g,this,I.originalEvent)))},mouseout:I=>{b&&(b=!1,u.call(this,new Zr(g,this,I.originalEvent)))}}}}{const b=T=>{const C=y(T.point);C.length&&(T.features=C,u.call(this,T),delete T.features)};return{listener:u,targets:o,delegates:{[g]:b}}}}on(g,o,u){if(typeof o=="function"||u===void 0)return super.on(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(g,o,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const b in y.delegates)this.on(b,y.delegates[b]);return this}once(g,o,u){if(typeof o=="function"||u===void 0)return super.once(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(g,o,u);for(const b in y.delegates)this.once(b,y.delegates[b]);return this}off(g,o,u){if(typeof o=="function"||u===void 0)return super.off(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._delegatedListeners?this._delegatedListeners[g]:void 0;return y&&(b=>{for(let T=0;T<b.length;T++){const C=b[T];if(C.listener===u&&Md(C.targets,o)){for(const I in C.delegates)this.off(I,C.delegates[I]);return b.splice(T,1),this}}})(y),this}queryRenderedFeatures(g,o){if(!this.style)return[];if(g===void 0||g instanceof a.P||Array.isArray(g)||o!==void 0||(o=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!o){const T=this.style.queryRenderedFeatures(g,void 0,this.transform),C=this.style.queryRenderedFeatureset(g,void 0,this.transform);return T.concat(C)}let u=!0;if(o.target&&(u=this._isTargetValid(o.target),u&&!o.layers))return this.style.queryRenderedFeatureset(g,o,this.transform);let y=!0;if(o.layers&&Array.isArray(o.layers)){for(const T of o.layers)if(!this._isValidId(T)){y=!1;break}if(y&&!o.target)return this.style.queryRenderedFeatures(g,o,this.transform)}let b=[];return y&&(b=b.concat(this.style.queryRenderedFeatures(g,o,this.transform))),u&&(b=b.concat(this.style.queryRenderedFeatureset(g,o,this.transform))),b}querySourceFeatures(g,o){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,o)}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&a.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(g))}addInteraction(g,o){return this._interactions.add(g,o),this}removeInteraction(g){return this._interactions.remove(g),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(g){return this._cooperativeGestures=g,this}setStyle(g,o){return o=a.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&g&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(g,((u,y)=>{if(u){const b=typeof u=="string"?u:u instanceof Error?u.message:u.error;a.w(`Unable to perform style diff: ${b}. Rebuilding the style from scratch.`),this._updateStyle(g,o)}else y&&this._update(!0)}),(()=>this._postStyleLoadEvent())),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const u=a.h({},o);o&&o.config&&(u.initialConfig=o.config,delete u.config),this.style=new Gl(this,u).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Gl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new a.z(new Error("IDs can't be empty."))),!1):!a.dk(g)||(this.fire(new a.z(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const o of g)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(g)}addSource(g,o){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,o,u){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,u)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,o,{pixelRatio:u=1,sdf:y=!1,stretchX:b,stretchY:T,content:C}={}){this._lazyInitEmptyStyle();const I=a.I.from(g);if(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:L,height:F,data:U}=a.q.getImageData(o);this.style.addImage(I,{data:new a.r({width:L,height:F},U),pixelRatio:u,stretchX:b,stretchY:T,content:C,sdf:y,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new a.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:L,height:F}=o,U=o;this.style.addImage(I,{data:new a.r({width:L,height:F},new Uint8Array(U.data)),pixelRatio:u,stretchX:b,stretchY:T,content:C,sdf:y,usvg:!1,version:0,userImage:U}),U.onAdd&&U.onAdd(this,g)}}updateImage(g,o){this._lazyInitEmptyStyle();const u=a.I.from(g),y=this.style.getImage(u);if(!y)return void this.fire(new a.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?a.q.getImageData(o):o,{width:T,height:C,data:I}=b;if(T===void 0||C===void 0)return void this.fire(new a.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(T!==(y.usvg?y.icon.usvg_tree.width:y.data.width)||C!==(y.usvg?y.icon.usvg_tree.height:y.data.height))return void this.fire(new a.z(new Error(`The width and height of the updated image (${T}, ${C})
                must be that same as the previous version of the image
                (${y.data.width}, ${y.data.height})`)));const L=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let F=!1;y.usvg?(y.data=new a.r({width:T,height:C},new Uint8Array(I)),y.usvg=!1,y.icon=void 0,F=!0):y.data.replace(I,L),this.style.updateImage(u,y,F)}hasImage(g){return g?!!this.style&&!!this.style.getImage(a.I.from(g)):(this.fire(new a.z(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(a.I.from(g))}loadImage(g,o){a.o(this._requestManager.transformRequest(g,a.R.Image),((u,y)=>{o(u,y instanceof HTMLImageElement?a.q.getImageData(y):y)}))}listImages(){return this.style.listImages().map((g=>g.name))}addModel(g,o){this._lazyInitEmptyStyle(),this.style.addModel(g,o)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new a.z(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,o){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)):this}getSlot(g){const o=this.getLayer(g);return o&&o.slot||null}setSlot(g,o){return this.style.setSlot(g,o),this.style.mergeLayers(),this._update(!0)}addImport(g,o){return this.style.addImport(g,o).catch((u=>this.fire(new a.z(new Error("Failed to add import",u))))),this}updateImport(g,o){return typeof o!="string"&&o.id!==g?(this.removeImport(g),this.addImport(o)):(this.style.updateImport(g,o),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,o){return this.style.moveImport(g,o),this._update(!0)}moveLayer(g,o){return this._isValidId(g)?(this.style.moveLayer(g,o),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const o=this.style.getOwnLayer(g);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,o,u){return this._isValidId(g)?(this.style.setLayerZoomRange(g,o,u),this._update(!0)):this}setFilter(g,o,u={}){return this._isValidId(g)?(this.style.setFilter(g,o,u),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,o,u,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,o,u,y),this._update(!0)):this}getPaintProperty(g,o){return this._isValidId(g)?this.style.getPaintProperty(g,o):null}setLayoutProperty(g,o,u,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,o,u,y),this._update(!0)):this}getLayoutProperty(g,o){return this._isValidId(g)?this.style.getLayoutProperty(g,o):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(g){return this.style.setGlyphsUrl(g),this._update(!0)}getSchema(g){return this.style.getSchema(g)}setSchema(g,o){return this.style.setSchema(g,o),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,o){return this.style.setConfig(g,o),this._update(!0)}getConfigProperty(g,o){return this.style.getConfigProperty(g,o)}setConfigProperty(g,o,u){return this.style.setConfigProperty(g,o,u),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const o=g[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,o),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.ci.convert(g),this.transform):0}setFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,o),this._update())}removeFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,o),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_selectIndoorFloor(g){this.indoor.selectFloor(g)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new zf),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let u,y,b,T=this._container;for(;T&&(!y||!b);){const C=window.getComputedStyle(T).transform;C&&C!=="none"&&(u=C.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(y=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(b=u[3])),T=T.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=b?Math.abs(o/b):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=q("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=q("div","mapboxgl-canvas-container",g);this._canvas=q("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=q("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((b=>{y[b]=q("div",`mapboxgl-ctrl-${b}`,u)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const u=a.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(g),this._canvas.height=u*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=a.h({},G.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",g);o?(cn(o,!0),this.painter=new ec(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",(u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),a.l.testSupport(o)):this.fire(new a.z(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.A("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new a.A("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;this.fire(new a.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,y=a.q.now(),b=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=b.createQuery(),b.beginQuery(u.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,U=this.transform.pitch,Y=a.q.now(),W=new a.aa(F,{now:Y,fadeDuration:T,pitch:U,transition:this.style.transition,worldview:this._worldview});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(y),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(y);const I=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),I&&(this._placementDirty=I.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,M.mark(S.load),this.fire(new a.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const F=a.q.now()-y;b.endQuery(u.TIME_ELAPSED_EXT),setTimeout((()=>{const U=b.getQueryParameter(o,b.QUERY_RESULT)/1e6;b.deleteQuery(o),this.fire(new a.A("gpu-timing-frame",{cpuTime:F,gpuTime:U}))}),50)}if(this.listens("gpu-timing-layer")){const F=this.painter.collectGpuTimers();setTimeout((()=>{const U=this.painter.queryGpuTimers(F);this.fire(new a.A("gpu-timing-layer",{layerTimes:U}))}),50)}if(this.listens("gpu-timing-deferred-render")){const F=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const U=this.painter.queryGpuTimeDeferredRender(F);this.fire(new a.A("gpu-timing-deferred-render",{gpuTime:U}))}),50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(L||this._repaint)this.triggerRepaint();else{const F=this.idle();if(F&&(C=this._updateAverageElevation(y,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),F&&(this.fire(new a.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new a.A("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,M.mark(S.fullLoad),this._performanceMetricsCollection&&mn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const u=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const b=this.transform.averageElevation;let T=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=g;const C=Math.abs(b-T);if(C>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(T),u(T);this._averageElevation.easeTo(T,g,300)}else if(C>1e-4)return this._averageElevation.jumpTo(T),u(T)}return!!this._averageElevation.isEasing(g)&&u(this._averageElevation.getValue(g))}_authenticate(){En(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(g=>{if(g&&(g.message===at||g.status===401)){const o=this.painter.context.gl;cn(o,!1),this._logoControl instanceof Nf&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),Ut(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&qt(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const u=this.painter.context.gl,y=u.createFramebuffer();function b(T){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,T,0);const C=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,C),C}return u.bindFramebuffer(u.FRAMEBUFFER,y),this._canvasPixelComparison(b(g),o.canvasCopies.map(b),o.timeStamps)}_canvasPixelComparison(g,o,u){let y=u[1]-u[0];const b=g.length/4;for(let T=0;T<o.length;T++){const C=o[T];let I=0;for(let L=0;L<C.length;L+=4)C[L]===g[L]&&C[L+1]===g[L+1]&&C[L+2]===g[L+2]&&C[L+3]===g[L+3]&&(I+=1);y+=(u[T+2]-u[T+1])*(1-I/b)}return y}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Xn.delete(this.painter.context.gl),en.remove(),gt.remove(),this._removed=!0,this.fire(new a.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=a.q.frame((o=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(o)})))}_preloadTiles(g){const o=this.style?this.style.getSourceCaches():[];return a.bt(o,((u,y)=>u._preloadTiles(g,y)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,o){a.eV(g,o)}get version(){return w}},NavigationControl:class{constructor(g={}){this.options=a.h({},Pd,g),this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this.options.showZoom&&(a.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(o=>{this._map&&this._map.zoomIn({},{originalEvent:o})})),q("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(o=>{this._map&&this._map.zoomOut({},{originalEvent:o})})),q("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(o=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:o}):u.resetNorth({},{originalEvent:o}))})),this._compassIcon=q("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),u=o===g.getMaxZoom(),y=o===g.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=o)}))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ru(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const u=q("button",g,this._container);return u.type="button",u.addEventListener("click",o),u}_setButtonTitle(g,o){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",u),g.firstElementChild&&g.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.E{constructor(g={}){super();const o=navigator.geolocation;this.options=a.h({geolocation:o},Sv,g),a.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ju(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,g(u)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then((u=>o(u.state!=="denied"))).catch((()=>o())):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),u=g.coords;return!!o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new a.A("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.A("geolocate",g)),this._finish()}}_updateCamera(g){const o=new a.ci(g.coords.longitude,g.coords.latitude),u=g.coords.accuracy,y=this._map.getBearing(),b=a.h({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(u),b,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new a.ci(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=a.cb(1,g._center.lat)*g.worldSize,u=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.A("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this._geolocateButton=q("button","mapboxgl-ctrl-geolocate",this._container),q("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q("div","mapboxgl-user-location"),this._dotElement.appendChild(q("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(q("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ks({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=q("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ks({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.A("trackuserlocationend")))}))}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((o=>{o==="granted"&&g()})).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:yl,ScaleControl:class{constructor(g={}){this.options=a.h({},i_,g),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),a.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,u=o._containerHeight/2,y=o._containerWidth/2-g/2,b=o.unproject([y,u]),T=o.unproject([y+g,u]),C=b.distanceTo(T);if(this.options.unit==="imperial"){const I=3.2808*C;I>5280?this._setScale(g,I/5280,"mile"):this._setScale(g,I,"foot")}else this.options.unit==="nautical"?this._setScale(g,C/1852,"nautical-mile"):C>=1e3?this._setScale(g,C/1e3,"kilometer"):this._setScale(g,C,"meter")}_setScale(g,o,u){this._map._requestDomTask((()=>{const y=(function(T){const C=Math.pow(10,`${Math.floor(T)}`.length-1);let I=T/C;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:(function(L){const F=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*F)/F})(I),C*I})(o),b=y/o;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(y):`${y}&nbsp;${a_[u]}`,this._container.style.width=g*b+"px"}))}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=q("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:a.w("Full screen control 'container' must be a DOM element.")),a.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=q("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=q("button","mapboxgl-ctrl-fullscreen",this._controlContainer);q("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:zf,Popup:class extends a.E{constructor(g){super(),this.options=a.h(Object.create(Rg),g),this._altitude=this.options.altitude,a.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new a.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new a.A("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=a.ci.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(g){return this._altitude=g,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const o=document.createDocumentFragment(),u=document.createElement("body");let y;for(u.innerHTML=g;y=u.firstChild,y;)o.appendChild(y);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=q("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const u=this._closeButton=q("button","mapboxgl-popup-close-button",o);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,u=this._container,y=this._pos;if(!o||!u||!y)return"bottom";const b=u.offsetWidth,T=u.offsetHeight,C=y.x<b/2,I=y.x>o.transform.width-b/2;if(y.y+g<T)return C?"top-left":I?"top-right":"top";if(y.y>o.transform.height-T){if(C)return"bottom-left";if(I)return"bottom-right"}return C?"left":I?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,u=this._content;if(!o||!this._lngLat&&!this._trackPointer||!u)return;let y=this._container;if(y||(y=this._container=q("div","mapboxgl-popup",o.getContainer()),this._tip=q("div","mapboxgl-popup-tip",y),y.appendChild(u)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ds(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const b=this._pos=this._trackPointer&&g instanceof a.P?g:o.project(this._lngLat,this._altitude),T=Za(this.options.offset),C=this._anchor=this._getAnchor(T.y),I=Za(this.options.offset,C),L=b.add(I).round();o._requestDomTask((()=>{this._container&&C&&(this._container.style.transform=`${Eo[C]} translate(${L.x}px,${L.y}px)`)}))}if(!this._marker&&o._showingGlobe()){const b=a.eW(o.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(o_);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Ks,Style:Gl,LngLat:a.ci,LngLatBounds:a.aG,Point:a.P,MercatorCoordinate:a.ac,FreeCameraOptions:of,Evented:a.E,config:a.e,prewarm:a.e_,clearPrewarmedResources:a.eZ,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(g){a.e.ACCESS_TOKEN=g},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(g){a.e.API_URL=g},get workerCount(){return a.f7.workerCount},set workerCount(g){a.f7.workerCount=g},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){a.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){a.f6(g)},get workerUrl(){return a.f5.workerUrl},set workerUrl(g){a.f5.workerUrl=g},get workerClass(){return a.f5.workerClass},set workerClass(g){a.f5.workerClass=g},get workerParams(){return a.f5.workerParams},set workerParams(g){a.f5.workerParams=g},get dracoUrl(){return a.f4()},set dracoUrl(g){a.f3(g)},get meshoptUrl(){return a.f2()},set meshoptUrl(g){a.f1(g)},setNow:a.q.setNow,restoreNow:a.q.restoreNow}}));var m=c;return m}))})(fE)),fE.exports}var J3e=K3e();const _x=Wa(J3e);_x.accessToken="pk.eyJ1IjoiY2hyaXN0aWFubWFwYm94Y29tIiwiYSI6ImNtZXJ1bTcweTBhYjcya3EwZjloOG5vMjIifQ.KPbfNzCPPimuiUecFEZxCA";function Q3e({data:e,className:t}){const n=K.useRef(null),i=K.useRef(null),c=K.useRef([]),d=e?.filter(m=>m.latitude&&m.longitude).map(m=>[parseFloat(m.longitude),parseFloat(m.latitude)])||[];return K.useEffect(()=>{if(!(!n.current||d.length<2))return i.current&&(i.current.remove(),i.current=null),i.current=new _x.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v12",center:d[0],zoom:16}),i.current.on("load",async()=>{d.forEach((a,w)=>{const S=new _x.Popup({offset:25,closeButton:!1,closeOnClick:!1}).setHTML(`<div style="border-radius:0.375rem;padding:0.5rem;color:#000;background:#fff;">${e[w].full_address}</div>`),M=new _x.Marker().setLngLat(a).setPopup(S).addTo(i.current);c.current.push(M)});const m=d.map(a=>a.join(",")).join(";");try{const w=await(await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${m}?geometries=geojson&access_token=${_x.accessToken}`)).json();if(w.routes&&w.routes.length){const S=w.routes[0].geometry;i.current.addSource("route",{type:"geojson",data:{type:"Feature",geometry:S}}),i.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#007bff","line-width":4}});const M=new _x.LngLatBounds;S.coordinates.forEach(P=>M.extend(P)),i.current.fitBounds(M,{padding:50})}}catch(a){console.error("Failed to fetch route from Mapbox Directions API",a)}}),()=>{c.current.forEach(m=>m.remove()),c.current=[],i.current&&(i.current.remove(),i.current=null)}},[d,e]),D.jsx("div",{ref:n,className:t})}const eBe=Ce.memo(Q3e,(e,t)=>JSON.stringify(e.data)===JSON.stringify(t.data));Qa.broadcast.config();function tBe(){const{batch_number:e}=WA(),[t,n]=K.useState(),[i,c]=K.useState(!1),[d,m]=K.useState([]),[a,w]=K.useState(0),[S,M]=K.useState(0),[P,N]=K.useState(0),{setMapComponent:$}=rie(),G=K.useCallback(()=>{c(!0),Qa.reservations.details({batch_number:e}).then(ee=>{const re=ee.data?.reservation;if(!re)return ua.error("Reservation not found");n(re),re.metrics?.totals&&w(re.metrics.totals.totalFuelCost??0),re.metrics?.trip_metrics?.length&&(M(re.metrics.trip_metrics.reduce((fe,ne)=>fe+(ne.distance??0),0)),N(re.metrics.trip_metrics.reduce((fe,ne)=>fe+(ne.duration??0),0)))}).catch(()=>ua.error("Failed to fetch reservation")).finally(()=>c(!1))},[e]);K.useEffect(()=>{e&&G()},[G,e]);const q=(ee,re)=>{m(fe=>fe.find(ce=>ce.vehicle_id===ee)?fe.map(ce=>ce.vehicle_id===ee?{...ce,driver_uuid:re}:ce):[...fe,{vehicle_id:ee,driver_uuid:re}])},V=ee=>{const re=t?.assignments.length;if(!d.length||d.some(fe=>!fe.driver_uuid||d.length!==re)){ua.error("Please assign drivers before saving.");return}ee(!0),Qa.reservations.approve({batch_number:e,assignments:d}).then(()=>ua.success("Reservation approved, budget request sent")).catch(fe=>ua.error(`Failed to update reservation ${fe.response?.data?.message}`)).finally(()=>ee(!1))},J=ee=>{t?.id&&(ee(!0),Qa.reservations.reject({batch_number:e}).then(()=>ua.success("Reservation rejected, resources freed")).catch(re=>ua.error(`Failed to update reservation ${re.response?.data?.message}`)).finally(()=>ee(!1)))};return j0("reservation_channel","ReservationEvents",ee=>{ee.batch_number===e&&G()}),K.useEffect(()=>{const ee=t?.trip_routes?.length>=2?D.jsx(eBe,{data:t.trip_routes,className:"w-full h-full"}):null;return $(ee),()=>$(null)},[t,$]),D.jsx(oh.div,{className:"flex flex-col h-full w-full px-4 pb-4",children:i?D.jsx("div",{className:"w-full h-full px-4",children:D.jsx(Oi,{})}):D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"h-[70vh]"}),D.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[D.jsx(Z3e,{totalCost:a,totalDistance:S,totalDuration:P}),D.jsx(W3e,{record:t,onApprove:V,onReject:J,isSubmitting:i,setIsSubmitting:c}),D.jsx("div",{className:"flex rounded-md backdrop-blur-md w-full justify-center items-center",children:D.jsx(X3e,{record:t,assignments:d,onAssign:q})})]})]})})}function nBe(){return D.jsx(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"w-full h-full flex flex-col items-center justify-center",children:D.jsxs("div",{className:"flex flex-col items-center justify-center",children:[D.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[D.jsx("circle",{cx:"40",cy:"40",r:"40",fill:"#4BB543"}),D.jsx("path",{d:"M24 42L36 54L56 34",stroke:"white",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round"})]}),D.jsx("h2",{className:"mt-6 text-2xl font-bold text-gray-800",children:"Success!"}),D.jsx("p",{className:"mt-2 text-gray-600 text-center",children:"Your operation was completed successfully. Please wait for approval."})]})})}Qa.broadcast.config();const rBe=[{title:"Name",accessor:"name",cellClassName:"font-medium"},{title:"Status",accessor:"status"},{render:e=>D.jsx(fc,{to:`${e.uuid}`,children:D.jsx(na,{variant:"",size:"sm",children:D.jsx(v0,{})})})}];function iBe(){const[e,t]=K.useState([]),[n,i]=K.useState(1),[c,d]=K.useState(1),[m,a]=K.useState(""),[w,S]=K.useState(!1),M=K.useCallback(()=>{Qa.drivers.list({page:n,q:m||void 0}).then(N=>{let $=N.data.drivers;t($.data||[]),d($.last_page||1)}).catch(()=>ua.error("Error fetching drivers"))},[n,m]);K.useEffect(()=>{const N=setTimeout(M,300);return()=>clearTimeout(N)},[M]);const P=()=>{S(!0),Qa.drivers.getDrivers().then(()=>ua.success("Successfully fetched drivers from HR")).catch(()=>ua.error("Failed to fetch drivers from HR")).finally(()=>S(!1))};return j0("driver_channel","DriverEvent",N=>{let $=N.record;const G=prev.findIndex(q=>q.uuid===$.uuid);if(G!==-1){const q=[...prev];return q[G]={...q[G],...$},q}return[$,...prev]}),D.jsx(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"h-full",children:D.jsxs("div",{className:"flex flex-col flex-2 h-full gap-2",children:[D.jsxs("div",{className:"flex-4/5",children:[D.jsxs("div",{className:"flex mb-3 gap-2",children:[D.jsx(io,{placeholder:"Search Drivers",value:m,onChange:N=>a(N.target.value)}),D.jsx(na,{disabled:w,onClick:P,children:w?"Fetching...":"Fetch Drivers"})]}),D.jsx("div",{className:"min-h-96 max-h-full",children:D.jsx(Nee,{list:e,recordName:"driver",columns:rBe})})]}),D.jsx(_C,{totalPage:c,page:n,setPage:i,className:"flex-2/12"})]})})}function aBe({driverInfo:e,loading:t}){return D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Driver Information"})}),D.jsx(Us,{}),D.jsx("div",{className:"py-3 px-8",children:D.jsx("div",{className:"grid gap-3 mb-3",children:D.jsx("div",{className:"flex flex-col gap-1",children:t?D.jsxs(D.Fragment,{children:[D.jsx(Oi,{className:"w-24 h-7"}),D.jsx(Oi,{className:"w-full h-7"}),D.jsx(Oi,{className:"w-full h-7"})]}):D.jsxs(D.Fragment,{children:[D.jsx("h3",{className:"font-medium",children:"Name"}),D.jsx("h4",{className:"px-4",children:e?.name})]})})})})]})}function oBe({dispatches:e,loading:t}){return D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Dispatch History"})}),D.jsx(Us,{}),D.jsx("div",{className:"py-3 px-8 min-h-24",children:D.jsx("div",{className:"grid gap-3 mb-3",children:D.jsx("div",{className:"flex flex-col gap-1",children:t?D.jsxs(D.Fragment,{children:[D.jsx(Oi,{className:"w-24 h-7"}),D.jsx(Oi,{className:"w-full h-7"}),D.jsx(Oi,{className:"w-full h-7"})]}):e?.length>0?D.jsxs(Lj,{children:[D.jsx(Nj,{children:D.jsxs(P1,{children:[D.jsx(oy,{children:"Dispatch"}),D.jsx(oy,{children:"Batch Number"}),D.jsx(oy,{children:"Status"})]})}),D.jsx(zj,{children:e?.map((n,i)=>D.jsxs(P1,{children:[D.jsx(Rm,{children:D.jsx("h4",{className:"px-4",children:n?.uuid})}),D.jsx(Rm,{children:D.jsx("h4",{className:"px-4",children:n?.batch_number})}),D.jsx(Rm,{children:D.jsx(_p,{variant:n?.status==="Completed"?"default":"destructive",className:"min-w-30",children:D.jsx("h4",{className:"px-4 font-medium",children:n?.status})})}),D.jsx(Rm,{children:D.jsx(fc,{to:`/logisticsII/dispatch/${n?.batch_number}`,children:D.jsx(na,{children:D.jsx(v0,{})})})})]},`${n.id}-`+i))})]}):D.jsx("div",{className:"w-full",children:D.jsx("h3",{className:"text-center font-medium text-muted-foreground",children:"No dispatches found"})})})})})]})}function sBe({reports:e,loading:t}){return D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Reports History"})}),D.jsx(Us,{}),D.jsx("div",{className:"py-3 px-8 min-h-24",children:D.jsx("div",{className:"grid gap-3 mb-3",children:D.jsx("div",{className:"flex flex-col gap-1",children:t?D.jsxs(D.Fragment,{children:[D.jsx(Oi,{className:"w-24 h-7"}),D.jsx(Oi,{className:"w-full h-7"}),D.jsx(Oi,{className:"w-full h-7"})]}):e?.length>0?D.jsxs(Lj,{className:"table-fixed w-full",children:[D.jsx(Nj,{children:D.jsxs(P1,{children:[D.jsx(oy,{className:"w-1/3",children:"Report"}),D.jsx(oy,{className:"w-1/4",children:"Batch Number"}),D.jsx(oy,{className:"w-1/4",children:"Date"}),D.jsx(oy,{className:"w-[60px]"})]})}),D.jsx(zj,{children:e?.map((n,i)=>D.jsxs(P1,{className:"group",children:[D.jsx(Rm,{children:D.jsx("h4",{className:"px-4 truncate",children:n?.uuid})}),D.jsx(Rm,{children:D.jsx("h4",{className:"px-4 truncate",children:n?.batch_number})}),D.jsx(Rm,{children:D.jsx("h4",{className:"px-4",children:n?.created_at})}),D.jsx(Rm,{className:"text-center",children:D.jsxs(oC,{children:[D.jsx(sC,{className:"opacity-0 group-hover:opacity-100 transition-opacity",children:D.jsx(na,{size:"sm",children:D.jsx(kse,{})})}),D.jsxs(lC,{children:[D.jsxs(cC,{children:[D.jsxs(uC,{children:["Report ",n?.uuid]}),D.jsxs(hC,{children:["Created at ",n?.created_at]})]}),D.jsx("div",{className:"w-full",children:D.jsx("p",{children:n?.message})})]})]})})]},`${n.id}-${i}`))})]}):D.jsx("div",{className:"w-full",children:D.jsx("h3",{className:"text-center font-medium text-muted-foreground",children:"No reports found"})})})})})]})}function lBe({tDispatch:e,avgSpeed:t,reports:n,comRate:i,loading:c}){return D.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-2",children:[D.jsxs(Uo,{className:"rounded-md flex flex-col h-full",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Dispatches"}),D.jsx(hc,{children:"Total driver dispatches"})]}),D.jsxs(qo,{children:[D.jsx("p",{className:"font-medium text-gray-500 text-md",children:"Counts"}),D.jsx("h1",{className:"font-semibold text-3xl",children:e??"N/A"})]})]}),D.jsxs(Uo,{className:"rounded-md flex flex-col h-full",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Average Speed"}),D.jsx(hc,{children:"Average driving speed"})]}),D.jsxs(qo,{children:[D.jsx("p",{className:"text-gray-500 text-lg",children:"Mph"}),D.jsx("p",{className:"font-medium text-3xl",children:t??"N/A"})]})]}),D.jsxs(Uo,{className:"rounded-md flex flex-col h-full",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Accident Reports"}),D.jsx(hc,{children:"Total accident report involving this driver"})]}),D.jsxs(qo,{children:[D.jsx("p",{className:"font-medium text-gray-500 text-md",children:"Counts"}),D.jsx("h1",{className:"font-medium text-3xl",children:n??"N/A"})]})]}),D.jsxs(Uo,{className:"rounded-md flex flex-col h-full",children:[D.jsxs($o,{className:"flex-grow",children:[D.jsx(il,{children:"Completion Rate"}),D.jsx(hc,{children:"Percentage of which driver can accomplish the dispatch order"})]}),D.jsxs(qo,{children:[D.jsx("p",{className:"font-medium text-gray-500 text-md",children:"Percentage"}),D.jsx("h1",{className:"font-medium text-3xl",children:i??"N/A"})]})]})]})}function cBe({id:e,main_message:t,message:n,buttonTitle:i,type:c,status:d,loading:m}){const{handleSubmit:a,formState:{isSubmitting:w}}=fv(),[S,M]=K.useState(!1),P=async()=>{};return D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"w-full py-2 px-6 flex justify-between",children:D.jsx("h2",{className:"text-2xl mb-0 font-medium",children:"Danger Zone"})}),D.jsx(Us,{}),D.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-4",children:[D.jsx("p",{className:"text-sm leading-relaxed max-w-[70%]",children:t}),D.jsxs(zA,{open:S,onOpenChange:M,children:[D.jsx(jA,{asChild:!0,children:D.jsx(na,{className:(c==="danger"?"bg-destructive ":"")+"ml-6 shrink-0 px-4 py-2",children:i})}),D.jsx(BA,{children:D.jsxs("form",{onSubmit:a(P),children:[D.jsxs(FA,{children:[D.jsx(UA,{children:"Are you absolutely sure?"}),D.jsx($A,{children:"This action cannot be reverted."})]}),D.jsx("div",{className:"my-3",children:n}),D.jsxs(VA,{children:[D.jsx(qA,{type:"button",children:"Cancel"}),D.jsx(na,{type:"submit",variant:"destructive",disabled:w,children:w?"Processing...":"Continue"})]})]})})]})]})]})}function uBe(){const{uuid:e}=WA(),t="Deactivate driver. This will prevent the system from assigning the driver in future orders.",n="This will prevent the system from assigning the driver in future orders.",[i,c]=K.useState(),[d,m]=K.useState(!1),[a,w]=K.useState(!1),S=K.useCallback(()=>{e&&(w(!0),Qa.drivers.driverDetails({driver_uuid:e}).then(M=>{console.log(M.data),c(M.data)}).catch(M=>{console.log(M),d||(ua.error("Unable to get driver details"),m(!0))}).finally(()=>{w(!1)}))},[e]);return K.useEffect(()=>{S()},[S]),D.jsx(oh.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col w-full mb-16 space-x-3",children:D.jsx("div",{className:"w-full",children:a?D.jsx(Oi,{className:"w-full h-full"}):D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"flex-1 max-h-dvh mb-5",children:D.jsx(lBe,{tDispatch:i?.dispatchTotalCount,avgSpeed:i?.averageSpeed,reports:i?.accidentReportsCount,comRate:i?.dispatchCompletionPrt,loading:a})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:D.jsx(aBe,{driverInfo:i?.driverInfo,loading:a})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:D.jsx(oBe,{dispatches:i?.dispatches,loading:a})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:D.jsx(sBe,{reports:i?.accidentReports,loading:a})}),D.jsx("div",{className:"flex-1 border rounded-md shadow max-h-dvh mb-5 bg-primary-foreground",children:D.jsx(cBe,{id:2,main_message:t,message:n,buttonTitle:"Deactivate",type:"danger",status:"",loading:a})})]})})})}Cre.createRoot(document.getElementById("root")).render(D.jsx(Uie,{basename:"/",children:D.jsx(ase,{children:D.jsxs(ose,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:[D.jsx(Pae,{richColors:!0}),D.jsxs(vie,{children:[D.jsxs(Bs,{path:"/",children:[D.jsxs(Bs,{element:D.jsx(Dpe,{allowedRoles:["Fleet Manager"]}),children:[D.jsx(Bs,{index:!0,element:D.jsx(kDe,{})}),D.jsxs(Bs,{path:"vehicles",children:[D.jsx(Bs,{index:!0,element:D.jsx(Xke,{})}),D.jsx(Bs,{path:":uuid",element:D.jsx(M3e,{})})]}),D.jsxs(Bs,{path:"drivers",children:[D.jsx(Bs,{index:!0,element:D.jsx(iBe,{})}),D.jsx(Bs,{path:":uuid",element:D.jsx(uBe,{})})]})]}),D.jsxs(Bs,{element:D.jsx(Lpe,{allowedRoles:["Fleet Manager"]}),children:[D.jsxs(Bs,{path:"dispatch",children:[D.jsx(Bs,{index:!0,element:D.jsx(I3e,{})}),D.jsx(Bs,{path:":batch_number",element:D.jsx(z3e,{})})]}),D.jsxs(Bs,{path:"reservation",children:[D.jsx(Bs,{index:!0,element:D.jsx(R3e,{})}),D.jsx(Bs,{path:"make",element:D.jsx(G3e,{})}),D.jsx(Bs,{path:":batch_number",element:D.jsx(tBe,{})})]}),D.jsx(Bs,{path:"success",element:D.jsx(nBe,{})})]})]}),D.jsx(Bs,{path:"*",element:D.jsx(gve,{})})]})]})})}));
